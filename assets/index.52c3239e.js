var F6=(r,n)=>()=>(n||r((n={exports:{}}).exports,n),n.exports);var Loe=F6(Eo=>{(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&o(u)}).observe(document,{childList:!0,subtree:!0});function i(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=i(l);fetch(l.href,a)}})();var ks=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function B6(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function MA(r){var n=r.default;if(typeof n=="function"){var i=function(){return n.apply(this,arguments)};i.prototype=n.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(r).forEach(function(o){var l=Object.getOwnPropertyDescriptor(r,o);Object.defineProperty(i,o,l.get?l:{enumerable:!0,get:function(){return r[o]}})}),i}var ar={exports:{}},Bi={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rm=Symbol.for("react.element"),U6=Symbol.for("react.portal"),z6=Symbol.for("react.fragment"),H6=Symbol.for("react.strict_mode"),G6=Symbol.for("react.profiler"),V6=Symbol.for("react.provider"),W6=Symbol.for("react.context"),j6=Symbol.for("react.forward_ref"),$6=Symbol.for("react.suspense"),X6=Symbol.for("react.memo"),q6=Symbol.for("react.lazy"),c2=Symbol.iterator;function Y6(r){return r===null||typeof r!="object"?null:(r=c2&&r[c2]||r["@@iterator"],typeof r=="function"?r:null)}var zL={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},HL=Object.assign,GL={};function af(r,n,i){this.props=r,this.context=n,this.refs=GL,this.updater=i||zL}af.prototype.isReactComponent={};af.prototype.setState=function(r,n){if(typeof r!="object"&&typeof r!="function"&&r!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,r,n,"setState")};af.prototype.forceUpdate=function(r){this.updater.enqueueForceUpdate(this,r,"forceUpdate")};function VL(){}VL.prototype=af.prototype;function SA(r,n,i){this.props=r,this.context=n,this.refs=GL,this.updater=i||zL}var TA=SA.prototype=new VL;TA.constructor=SA;HL(TA,af.prototype);TA.isPureReactComponent=!0;var u2=Array.isArray,WL=Object.prototype.hasOwnProperty,CA={current:null},jL={key:!0,ref:!0,__self:!0,__source:!0};function $L(r,n,i){var o,l={},a=null,u=null;if(n!=null)for(o in n.ref!==void 0&&(u=n.ref),n.key!==void 0&&(a=""+n.key),n)WL.call(n,o)&&!jL.hasOwnProperty(o)&&(l[o]=n[o]);var h=arguments.length-2;if(h===1)l.children=i;else if(1<h){for(var f=Array(h),d=0;d<h;d++)f[d]=arguments[d+2];l.children=f}if(r&&r.defaultProps)for(o in h=r.defaultProps,h)l[o]===void 0&&(l[o]=h[o]);return{$$typeof:Rm,type:r,key:a,ref:u,props:l,_owner:CA.current}}function K6(r,n){return{$$typeof:Rm,type:r.type,key:n,ref:r.ref,props:r.props,_owner:r._owner}}function RA(r){return typeof r=="object"&&r!==null&&r.$$typeof===Rm}function Q6(r){var n={"=":"=0",":":"=2"};return"$"+r.replace(/[=:]/g,function(i){return n[i]})}var h2=/\/+/g;function H_(r,n){return typeof r=="object"&&r!==null&&r.key!=null?Q6(""+r.key):n.toString(36)}function y0(r,n,i,o,l){var a=typeof r;(a==="undefined"||a==="boolean")&&(r=null);var u=!1;if(r===null)u=!0;else switch(a){case"string":case"number":u=!0;break;case"object":switch(r.$$typeof){case Rm:case U6:u=!0}}if(u)return u=r,l=l(u),r=o===""?"."+H_(u,0):o,u2(l)?(i="",r!=null&&(i=r.replace(h2,"$&/")+"/"),y0(l,n,i,"",function(d){return d})):l!=null&&(RA(l)&&(l=K6(l,i+(!l.key||u&&u.key===l.key?"":(""+l.key).replace(h2,"$&/")+"/")+r)),n.push(l)),1;if(u=0,o=o===""?".":o+":",u2(r))for(var h=0;h<r.length;h++){a=r[h];var f=o+H_(a,h);u+=y0(a,n,i,f,l)}else if(f=Y6(r),typeof f=="function")for(r=f.call(r),h=0;!(a=r.next()).done;)a=a.value,f=o+H_(a,h++),u+=y0(a,n,i,f,l);else if(a==="object")throw n=String(r),Error("Objects are not valid as a React child (found: "+(n==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":n)+"). If you meant to render a collection of children, use an array instead.");return u}function uv(r,n,i){if(r==null)return r;var o=[],l=0;return y0(r,o,"","",function(a){return n.call(i,a,l++)}),o}function Z6(r){if(r._status===-1){var n=r._result;n=n(),n.then(function(i){(r._status===0||r._status===-1)&&(r._status=1,r._result=i)},function(i){(r._status===0||r._status===-1)&&(r._status=2,r._result=i)}),r._status===-1&&(r._status=0,r._result=n)}if(r._status===1)return r._result.default;throw r._result}var Ps={current:null},x0={transition:null},J6={ReactCurrentDispatcher:Ps,ReactCurrentBatchConfig:x0,ReactCurrentOwner:CA};Bi.Children={map:uv,forEach:function(r,n,i){uv(r,function(){n.apply(this,arguments)},i)},count:function(r){var n=0;return uv(r,function(){n++}),n},toArray:function(r){return uv(r,function(n){return n})||[]},only:function(r){if(!RA(r))throw Error("React.Children.only expected to receive a single React element child.");return r}};Bi.Component=af;Bi.Fragment=z6;Bi.Profiler=G6;Bi.PureComponent=SA;Bi.StrictMode=H6;Bi.Suspense=$6;Bi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J6;Bi.cloneElement=function(r,n,i){if(r==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+r+".");var o=HL({},r.props),l=r.key,a=r.ref,u=r._owner;if(n!=null){if(n.ref!==void 0&&(a=n.ref,u=CA.current),n.key!==void 0&&(l=""+n.key),r.type&&r.type.defaultProps)var h=r.type.defaultProps;for(f in n)WL.call(n,f)&&!jL.hasOwnProperty(f)&&(o[f]=n[f]===void 0&&h!==void 0?h[f]:n[f])}var f=arguments.length-2;if(f===1)o.children=i;else if(1<f){h=Array(f);for(var d=0;d<f;d++)h[d]=arguments[d+2];o.children=h}return{$$typeof:Rm,type:r.type,key:l,ref:a,props:o,_owner:u}};Bi.createContext=function(r){return r={$$typeof:W6,_currentValue:r,_currentValue2:r,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},r.Provider={$$typeof:V6,_context:r},r.Consumer=r};Bi.createElement=$L;Bi.createFactory=function(r){var n=$L.bind(null,r);return n.type=r,n};Bi.createRef=function(){return{current:null}};Bi.forwardRef=function(r){return{$$typeof:j6,render:r}};Bi.isValidElement=RA;Bi.lazy=function(r){return{$$typeof:q6,_payload:{_status:-1,_result:r},_init:Z6}};Bi.memo=function(r,n){return{$$typeof:X6,type:r,compare:n===void 0?null:n}};Bi.startTransition=function(r){var n=x0.transition;x0.transition={};try{r()}finally{x0.transition=n}};Bi.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Bi.useCallback=function(r,n){return Ps.current.useCallback(r,n)};Bi.useContext=function(r){return Ps.current.useContext(r)};Bi.useDebugValue=function(){};Bi.useDeferredValue=function(r){return Ps.current.useDeferredValue(r)};Bi.useEffect=function(r,n){return Ps.current.useEffect(r,n)};Bi.useId=function(){return Ps.current.useId()};Bi.useImperativeHandle=function(r,n,i){return Ps.current.useImperativeHandle(r,n,i)};Bi.useInsertionEffect=function(r,n){return Ps.current.useInsertionEffect(r,n)};Bi.useLayoutEffect=function(r,n){return Ps.current.useLayoutEffect(r,n)};Bi.useMemo=function(r,n){return Ps.current.useMemo(r,n)};Bi.useReducer=function(r,n,i){return Ps.current.useReducer(r,n,i)};Bi.useRef=function(r){return Ps.current.useRef(r)};Bi.useState=function(r){return Ps.current.useState(r)};Bi.useSyncExternalStore=function(r,n,i){return Ps.current.useSyncExternalStore(r,n,i)};Bi.useTransition=function(){return Ps.current.useTransition()};Bi.version="18.2.0";(function(r){r.exports=Bi})(ar);const XL=B6(ar.exports);var F1={},qL={exports:{}},co={},YL={exports:{}},KL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(r){function n(Z,ie){var se=Z.length;Z.push(ie);e:for(;0<se;){var ue=se-1>>>1,ye=Z[ue];if(0<l(ye,ie))Z[ue]=ie,Z[se]=ye,se=ue;else break e}}function i(Z){return Z.length===0?null:Z[0]}function o(Z){if(Z.length===0)return null;var ie=Z[0],se=Z.pop();if(se!==ie){Z[0]=se;e:for(var ue=0,ye=Z.length,Ce=ye>>>1;ue<Ce;){var ke=2*(ue+1)-1,Oe=Z[ke],Ne=ke+1,He=Z[Ne];if(0>l(Oe,se))Ne<ye&&0>l(He,Oe)?(Z[ue]=He,Z[Ne]=se,ue=Ne):(Z[ue]=Oe,Z[ke]=se,ue=ke);else if(Ne<ye&&0>l(He,se))Z[ue]=He,Z[Ne]=se,ue=Ne;else break e}}return ie}function l(Z,ie){var se=Z.sortIndex-ie.sortIndex;return se!==0?se:Z.id-ie.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;r.unstable_now=function(){return a.now()}}else{var u=Date,h=u.now();r.unstable_now=function(){return u.now()-h}}var f=[],d=[],m=1,g=null,x=3,v=!1,A=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(Z){for(var ie=i(d);ie!==null;){if(ie.callback===null)o(d);else if(ie.startTime<=Z)o(d),ie.sortIndex=ie.expirationTime,n(f,ie);else break;ie=i(d)}}function R(Z){if(_=!1,T(Z),!A)if(i(f)!==null)A=!0,z(L);else{var ie=i(d);ie!==null&&X(R,ie.startTime-Z)}}function L(Z,ie){A=!1,_&&(_=!1,w(B),B=-1),v=!0;var se=x;try{for(T(ie),g=i(f);g!==null&&(!(g.expirationTime>ie)||Z&&!le());){var ue=g.callback;if(typeof ue=="function"){g.callback=null,x=g.priorityLevel;var ye=ue(g.expirationTime<=ie);ie=r.unstable_now(),typeof ye=="function"?g.callback=ye:g===i(f)&&o(f),T(ie)}else o(f);g=i(f)}if(g!==null)var Ce=!0;else{var ke=i(d);ke!==null&&X(R,ke.startTime-ie),Ce=!1}return Ce}finally{g=null,x=se,v=!1}}var I=!1,N=null,B=-1,H=5,q=-1;function le(){return!(r.unstable_now()-q<H)}function ne(){if(N!==null){var Z=r.unstable_now();q=Z;var ie=!0;try{ie=N(!0,Z)}finally{ie?D():(I=!1,N=null)}}else I=!1}var D;if(typeof S=="function")D=function(){S(ne)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,k=O.port2;O.port1.onmessage=ne,D=function(){k.postMessage(null)}}else D=function(){E(ne,0)};function z(Z){N=Z,I||(I=!0,D())}function X(Z,ie){B=E(function(){Z(r.unstable_now())},ie)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(Z){Z.callback=null},r.unstable_continueExecution=function(){A||v||(A=!0,z(L))},r.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):H=0<Z?Math.floor(1e3/Z):5},r.unstable_getCurrentPriorityLevel=function(){return x},r.unstable_getFirstCallbackNode=function(){return i(f)},r.unstable_next=function(Z){switch(x){case 1:case 2:case 3:var ie=3;break;default:ie=x}var se=x;x=ie;try{return Z()}finally{x=se}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(Z,ie){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var se=x;x=Z;try{return ie()}finally{x=se}},r.unstable_scheduleCallback=function(Z,ie,se){var ue=r.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ue+se:ue):se=ue,Z){case 1:var ye=-1;break;case 2:ye=250;break;case 5:ye=1073741823;break;case 4:ye=1e4;break;default:ye=5e3}return ye=se+ye,Z={id:m++,callback:ie,priorityLevel:Z,startTime:se,expirationTime:ye,sortIndex:-1},se>ue?(Z.sortIndex=se,n(d,Z),i(f)===null&&Z===i(d)&&(_?(w(B),B=-1):_=!0,X(R,se-ue))):(Z.sortIndex=ye,n(f,Z),A||v||(A=!0,z(L))),Z},r.unstable_shouldYield=le,r.unstable_wrapCallback=function(Z){var ie=x;return function(){var se=x;x=ie;try{return Z.apply(this,arguments)}finally{x=se}}}})(KL);(function(r){r.exports=KL})(YL);/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QL=ar.exports,so=YL.exports;function an(r){for(var n="https://reactjs.org/docs/error-decoder.html?invariant="+r,i=1;i<arguments.length;i++)n+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+r+"; visit "+n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ZL=new Set,em={};function $u(r,n){zd(r,n),zd(r+"Capture",n)}function zd(r,n){for(em[r]=n,r=0;r<n.length;r++)ZL.add(n[r])}var bl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),B1=Object.prototype.hasOwnProperty,e8=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d2={},f2={};function t8(r){return B1.call(f2,r)?!0:B1.call(d2,r)?!1:e8.test(r)?f2[r]=!0:(d2[r]=!0,!1)}function n8(r,n,i,o){if(i!==null&&i.type===0)return!1;switch(typeof n){case"function":case"symbol":return!0;case"boolean":return o?!1:i!==null?!i.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function i8(r,n,i,o){if(n===null||typeof n>"u"||n8(r,n,i,o))return!0;if(o)return!1;if(i!==null)switch(i.type){case 3:return!n;case 4:return n===!1;case 5:return isNaN(n);case 6:return isNaN(n)||1>n}return!1}function Ds(r,n,i,o,l,a,u){this.acceptsBooleans=n===2||n===3||n===4,this.attributeName=o,this.attributeNamespace=l,this.mustUseProperty=i,this.propertyName=r,this.type=n,this.sanitizeURL=a,this.removeEmptyString=u}var cs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){cs[r]=new Ds(r,0,!1,r,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var n=r[0];cs[n]=new Ds(n,1,!1,r[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(r){cs[r]=new Ds(r,2,!1,r.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){cs[r]=new Ds(r,2,!1,r,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){cs[r]=new Ds(r,3,!1,r.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(r){cs[r]=new Ds(r,3,!0,r,null,!1,!1)});["capture","download"].forEach(function(r){cs[r]=new Ds(r,4,!1,r,null,!1,!1)});["cols","rows","size","span"].forEach(function(r){cs[r]=new Ds(r,6,!1,r,null,!1,!1)});["rowSpan","start"].forEach(function(r){cs[r]=new Ds(r,5,!1,r.toLowerCase(),null,!1,!1)});var LA=/[\-:]([a-z])/g;function PA(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var n=r.replace(LA,PA);cs[n]=new Ds(n,1,!1,r,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var n=r.replace(LA,PA);cs[n]=new Ds(n,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(r){var n=r.replace(LA,PA);cs[n]=new Ds(n,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(r){cs[r]=new Ds(r,1,!1,r.toLowerCase(),null,!1,!1)});cs.xlinkHref=new Ds("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(r){cs[r]=new Ds(r,1,!1,r.toLowerCase(),null,!0,!0)});function DA(r,n,i,o){var l=cs.hasOwnProperty(n)?cs[n]:null;(l!==null?l.type!==0:o||!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(i8(n,i,l,o)&&(i=null),o||l===null?t8(n)&&(i===null?r.removeAttribute(n):r.setAttribute(n,""+i)):l.mustUseProperty?r[l.propertyName]=i===null?l.type===3?!1:"":i:(n=l.attributeName,o=l.attributeNamespace,i===null?r.removeAttribute(n):(l=l.type,i=l===3||l===4&&i===!0?"":""+i,o?r.setAttributeNS(o,n,i):r.setAttribute(n,i))))}var Cl=QL.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,hv=Symbol.for("react.element"),fd=Symbol.for("react.portal"),pd=Symbol.for("react.fragment"),OA=Symbol.for("react.strict_mode"),U1=Symbol.for("react.profiler"),JL=Symbol.for("react.provider"),eP=Symbol.for("react.context"),IA=Symbol.for("react.forward_ref"),z1=Symbol.for("react.suspense"),H1=Symbol.for("react.suspense_list"),kA=Symbol.for("react.memo"),ac=Symbol.for("react.lazy"),tP=Symbol.for("react.offscreen"),p2=Symbol.iterator;function Kf(r){return r===null||typeof r!="object"?null:(r=p2&&r[p2]||r["@@iterator"],typeof r=="function"?r:null)}var Ar=Object.assign,G_;function Tp(r){if(G_===void 0)try{throw Error()}catch(i){var n=i.stack.trim().match(/\n( *(at )?)/);G_=n&&n[1]||""}return`
`+G_+r}var V_=!1;function W_(r,n){if(!r||V_)return"";V_=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(n)if(n=function(){throw Error()},Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(n,[])}catch(d){var o=d}Reflect.construct(r,[],n)}else{try{n.call()}catch(d){o=d}r.call(n.prototype)}else{try{throw Error()}catch(d){o=d}r()}}catch(d){if(d&&o&&typeof d.stack=="string"){for(var l=d.stack.split(`
`),a=o.stack.split(`
`),u=l.length-1,h=a.length-1;1<=u&&0<=h&&l[u]!==a[h];)h--;for(;1<=u&&0<=h;u--,h--)if(l[u]!==a[h]){if(u!==1||h!==1)do if(u--,h--,0>h||l[u]!==a[h]){var f=`
`+l[u].replace(" at new "," at ");return r.displayName&&f.includes("<anonymous>")&&(f=f.replace("<anonymous>",r.displayName)),f}while(1<=u&&0<=h);break}}}finally{V_=!1,Error.prepareStackTrace=i}return(r=r?r.displayName||r.name:"")?Tp(r):""}function r8(r){switch(r.tag){case 5:return Tp(r.type);case 16:return Tp("Lazy");case 13:return Tp("Suspense");case 19:return Tp("SuspenseList");case 0:case 2:case 15:return r=W_(r.type,!1),r;case 11:return r=W_(r.type.render,!1),r;case 1:return r=W_(r.type,!0),r;default:return""}}function G1(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case pd:return"Fragment";case fd:return"Portal";case U1:return"Profiler";case OA:return"StrictMode";case z1:return"Suspense";case H1:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case eP:return(r.displayName||"Context")+".Consumer";case JL:return(r._context.displayName||"Context")+".Provider";case IA:var n=r.render;return r=r.displayName,r||(r=n.displayName||n.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case kA:return n=r.displayName||null,n!==null?n:G1(r.type)||"Memo";case ac:n=r._payload,r=r._init;try{return G1(r(n))}catch{}}return null}function s8(r){var n=r.type;switch(r.tag){case 24:return"Cache";case 9:return(n.displayName||"Context")+".Consumer";case 10:return(n._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=n.render,r=r.displayName||r.name||"",n.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return n;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G1(n);case 8:return n===OA?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n}return null}function Mc(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function nP(r){var n=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(n==="checkbox"||n==="radio")}function o8(r){var n=nP(r)?"checked":"value",i=Object.getOwnPropertyDescriptor(r.constructor.prototype,n),o=""+r[n];if(!r.hasOwnProperty(n)&&typeof i<"u"&&typeof i.get=="function"&&typeof i.set=="function"){var l=i.get,a=i.set;return Object.defineProperty(r,n,{configurable:!0,get:function(){return l.call(this)},set:function(u){o=""+u,a.call(this,u)}}),Object.defineProperty(r,n,{enumerable:i.enumerable}),{getValue:function(){return o},setValue:function(u){o=""+u},stopTracking:function(){r._valueTracker=null,delete r[n]}}}}function dv(r){r._valueTracker||(r._valueTracker=o8(r))}function iP(r){if(!r)return!1;var n=r._valueTracker;if(!n)return!0;var i=n.getValue(),o="";return r&&(o=nP(r)?r.checked?"true":"false":r.value),r=o,r!==i?(n.setValue(r),!0):!1}function V0(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function V1(r,n){var i=n.checked;return Ar({},n,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:i!=null?i:r._wrapperState.initialChecked})}function m2(r,n){var i=n.defaultValue==null?"":n.defaultValue,o=n.checked!=null?n.checked:n.defaultChecked;i=Mc(n.value!=null?n.value:i),r._wrapperState={initialChecked:o,initialValue:i,controlled:n.type==="checkbox"||n.type==="radio"?n.checked!=null:n.value!=null}}function rP(r,n){n=n.checked,n!=null&&DA(r,"checked",n,!1)}function W1(r,n){rP(r,n);var i=Mc(n.value),o=n.type;if(i!=null)o==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+i):r.value!==""+i&&(r.value=""+i);else if(o==="submit"||o==="reset"){r.removeAttribute("value");return}n.hasOwnProperty("value")?j1(r,n.type,i):n.hasOwnProperty("defaultValue")&&j1(r,n.type,Mc(n.defaultValue)),n.checked==null&&n.defaultChecked!=null&&(r.defaultChecked=!!n.defaultChecked)}function g2(r,n,i){if(n.hasOwnProperty("value")||n.hasOwnProperty("defaultValue")){var o=n.type;if(!(o!=="submit"&&o!=="reset"||n.value!==void 0&&n.value!==null))return;n=""+r._wrapperState.initialValue,i||n===r.value||(r.value=n),r.defaultValue=n}i=r.name,i!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,i!==""&&(r.name=i)}function j1(r,n,i){(n!=="number"||V0(r.ownerDocument)!==r)&&(i==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+i&&(r.defaultValue=""+i))}var Cp=Array.isArray;function Ld(r,n,i,o){if(r=r.options,n){n={};for(var l=0;l<i.length;l++)n["$"+i[l]]=!0;for(i=0;i<r.length;i++)l=n.hasOwnProperty("$"+r[i].value),r[i].selected!==l&&(r[i].selected=l),l&&o&&(r[i].defaultSelected=!0)}else{for(i=""+Mc(i),n=null,l=0;l<r.length;l++){if(r[l].value===i){r[l].selected=!0,o&&(r[l].defaultSelected=!0);return}n!==null||r[l].disabled||(n=r[l])}n!==null&&(n.selected=!0)}}function $1(r,n){if(n.dangerouslySetInnerHTML!=null)throw Error(an(91));return Ar({},n,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function v2(r,n){var i=n.value;if(i==null){if(i=n.children,n=n.defaultValue,i!=null){if(n!=null)throw Error(an(92));if(Cp(i)){if(1<i.length)throw Error(an(93));i=i[0]}n=i}n==null&&(n=""),i=n}r._wrapperState={initialValue:Mc(i)}}function sP(r,n){var i=Mc(n.value),o=Mc(n.defaultValue);i!=null&&(i=""+i,i!==r.value&&(r.value=i),n.defaultValue==null&&r.defaultValue!==i&&(r.defaultValue=i)),o!=null&&(r.defaultValue=""+o)}function y2(r){var n=r.textContent;n===r._wrapperState.initialValue&&n!==""&&n!==null&&(r.value=n)}function oP(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function X1(r,n){return r==null||r==="http://www.w3.org/1999/xhtml"?oP(n):r==="http://www.w3.org/2000/svg"&&n==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var fv,aP=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(n,i,o,l){MSApp.execUnsafeLocalFunction(function(){return r(n,i,o,l)})}:r}(function(r,n){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=n;else{for(fv=fv||document.createElement("div"),fv.innerHTML="<svg>"+n.valueOf().toString()+"</svg>",n=fv.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;n.firstChild;)r.appendChild(n.firstChild)}});function tm(r,n){if(n){var i=r.firstChild;if(i&&i===r.lastChild&&i.nodeType===3){i.nodeValue=n;return}}r.textContent=n}var Fp={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},a8=["Webkit","ms","Moz","O"];Object.keys(Fp).forEach(function(r){a8.forEach(function(n){n=n+r.charAt(0).toUpperCase()+r.substring(1),Fp[n]=Fp[r]})});function lP(r,n,i){return n==null||typeof n=="boolean"||n===""?"":i||typeof n!="number"||n===0||Fp.hasOwnProperty(r)&&Fp[r]?(""+n).trim():n+"px"}function cP(r,n){r=r.style;for(var i in n)if(n.hasOwnProperty(i)){var o=i.indexOf("--")===0,l=lP(i,n[i],o);i==="float"&&(i="cssFloat"),o?r.setProperty(i,l):r[i]=l}}var l8=Ar({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function q1(r,n){if(n){if(l8[r]&&(n.children!=null||n.dangerouslySetInnerHTML!=null))throw Error(an(137,r));if(n.dangerouslySetInnerHTML!=null){if(n.children!=null)throw Error(an(60));if(typeof n.dangerouslySetInnerHTML!="object"||!("__html"in n.dangerouslySetInnerHTML))throw Error(an(61))}if(n.style!=null&&typeof n.style!="object")throw Error(an(62))}}function Y1(r,n){if(r.indexOf("-")===-1)return typeof n.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var K1=null;function NA(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Q1=null,Pd=null,Dd=null;function x2(r){if(r=Dm(r)){if(typeof Q1!="function")throw Error(an(280));var n=r.stateNode;n&&(n=Dy(n),Q1(r.stateNode,r.type,n))}}function uP(r){Pd?Dd?Dd.push(r):Dd=[r]:Pd=r}function hP(){if(Pd){var r=Pd,n=Dd;if(Dd=Pd=null,x2(r),n)for(r=0;r<n.length;r++)x2(n[r])}}function dP(r,n){return r(n)}function fP(){}var j_=!1;function pP(r,n,i){if(j_)return r(n,i);j_=!0;try{return dP(r,n,i)}finally{j_=!1,(Pd!==null||Dd!==null)&&(fP(),hP())}}function nm(r,n){var i=r.stateNode;if(i===null)return null;var o=Dy(i);if(o===null)return null;i=o[n];e:switch(n){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(o=!o.disabled)||(r=r.type,o=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!o;break e;default:r=!1}if(r)return null;if(i&&typeof i!="function")throw Error(an(231,n,typeof i));return i}var Z1=!1;if(bl)try{var Qf={};Object.defineProperty(Qf,"passive",{get:function(){Z1=!0}}),window.addEventListener("test",Qf,Qf),window.removeEventListener("test",Qf,Qf)}catch{Z1=!1}function c8(r,n,i,o,l,a,u,h,f){var d=Array.prototype.slice.call(arguments,3);try{n.apply(i,d)}catch(m){this.onError(m)}}var Bp=!1,W0=null,j0=!1,J1=null,u8={onError:function(r){Bp=!0,W0=r}};function h8(r,n,i,o,l,a,u,h,f){Bp=!1,W0=null,c8.apply(u8,arguments)}function d8(r,n,i,o,l,a,u,h,f){if(h8.apply(this,arguments),Bp){if(Bp){var d=W0;Bp=!1,W0=null}else throw Error(an(198));j0||(j0=!0,J1=d)}}function Xu(r){var n=r,i=r;if(r.alternate)for(;n.return;)n=n.return;else{r=n;do n=r,(n.flags&4098)!==0&&(i=n.return),r=n.return;while(r)}return n.tag===3?i:null}function mP(r){if(r.tag===13){var n=r.memoizedState;if(n===null&&(r=r.alternate,r!==null&&(n=r.memoizedState)),n!==null)return n.dehydrated}return null}function _2(r){if(Xu(r)!==r)throw Error(an(188))}function f8(r){var n=r.alternate;if(!n){if(n=Xu(r),n===null)throw Error(an(188));return n!==r?null:r}for(var i=r,o=n;;){var l=i.return;if(l===null)break;var a=l.alternate;if(a===null){if(o=l.return,o!==null){i=o;continue}break}if(l.child===a.child){for(a=l.child;a;){if(a===i)return _2(l),r;if(a===o)return _2(l),n;a=a.sibling}throw Error(an(188))}if(i.return!==o.return)i=l,o=a;else{for(var u=!1,h=l.child;h;){if(h===i){u=!0,i=l,o=a;break}if(h===o){u=!0,o=l,i=a;break}h=h.sibling}if(!u){for(h=a.child;h;){if(h===i){u=!0,i=a,o=l;break}if(h===o){u=!0,o=a,i=l;break}h=h.sibling}if(!u)throw Error(an(189))}}if(i.alternate!==o)throw Error(an(190))}if(i.tag!==3)throw Error(an(188));return i.stateNode.current===i?r:n}function gP(r){return r=f8(r),r!==null?vP(r):null}function vP(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var n=vP(r);if(n!==null)return n;r=r.sibling}return null}var yP=so.unstable_scheduleCallback,b2=so.unstable_cancelCallback,p8=so.unstable_shouldYield,m8=so.unstable_requestPaint,kr=so.unstable_now,g8=so.unstable_getCurrentPriorityLevel,FA=so.unstable_ImmediatePriority,xP=so.unstable_UserBlockingPriority,$0=so.unstable_NormalPriority,v8=so.unstable_LowPriority,_P=so.unstable_IdlePriority,Cy=null,Sa=null;function y8(r){if(Sa&&typeof Sa.onCommitFiberRoot=="function")try{Sa.onCommitFiberRoot(Cy,r,void 0,(r.current.flags&128)===128)}catch{}}var Jo=Math.clz32?Math.clz32:b8,x8=Math.log,_8=Math.LN2;function b8(r){return r>>>=0,r===0?32:31-(x8(r)/_8|0)|0}var pv=64,mv=4194304;function Rp(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function X0(r,n){var i=r.pendingLanes;if(i===0)return 0;var o=0,l=r.suspendedLanes,a=r.pingedLanes,u=i&268435455;if(u!==0){var h=u&~l;h!==0?o=Rp(h):(a&=u,a!==0&&(o=Rp(a)))}else u=i&~l,u!==0?o=Rp(u):a!==0&&(o=Rp(a));if(o===0)return 0;if(n!==0&&n!==o&&(n&l)===0&&(l=o&-o,a=n&-n,l>=a||l===16&&(a&4194240)!==0))return n;if((o&4)!==0&&(o|=i&16),n=r.entangledLanes,n!==0)for(r=r.entanglements,n&=o;0<n;)i=31-Jo(n),l=1<<i,o|=r[i],n&=~l;return o}function E8(r,n){switch(r){case 1:case 2:case 4:return n+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A8(r,n){for(var i=r.suspendedLanes,o=r.pingedLanes,l=r.expirationTimes,a=r.pendingLanes;0<a;){var u=31-Jo(a),h=1<<u,f=l[u];f===-1?((h&i)===0||(h&o)!==0)&&(l[u]=E8(h,n)):f<=n&&(r.expiredLanes|=h),a&=~h}}function eE(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function bP(){var r=pv;return pv<<=1,(pv&4194240)===0&&(pv=64),r}function $_(r){for(var n=[],i=0;31>i;i++)n.push(r);return n}function Lm(r,n,i){r.pendingLanes|=n,n!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,n=31-Jo(n),r[n]=i}function w8(r,n){var i=r.pendingLanes&~n;r.pendingLanes=n,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=n,r.mutableReadLanes&=n,r.entangledLanes&=n,n=r.entanglements;var o=r.eventTimes;for(r=r.expirationTimes;0<i;){var l=31-Jo(i),a=1<<l;n[l]=0,o[l]=-1,r[l]=-1,i&=~a}}function BA(r,n){var i=r.entangledLanes|=n;for(r=r.entanglements;i;){var o=31-Jo(i),l=1<<o;l&n|r[o]&n&&(r[o]|=n),i&=~l}}var nr=0;function EP(r){return r&=-r,1<r?4<r?(r&268435455)!==0?16:536870912:4:1}var AP,UA,wP,MP,SP,tE=!1,gv=[],gc=null,vc=null,yc=null,im=new Map,rm=new Map,hc=[],M8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function E2(r,n){switch(r){case"focusin":case"focusout":gc=null;break;case"dragenter":case"dragleave":vc=null;break;case"mouseover":case"mouseout":yc=null;break;case"pointerover":case"pointerout":im.delete(n.pointerId);break;case"gotpointercapture":case"lostpointercapture":rm.delete(n.pointerId)}}function Zf(r,n,i,o,l,a){return r===null||r.nativeEvent!==a?(r={blockedOn:n,domEventName:i,eventSystemFlags:o,nativeEvent:a,targetContainers:[l]},n!==null&&(n=Dm(n),n!==null&&UA(n)),r):(r.eventSystemFlags|=o,n=r.targetContainers,l!==null&&n.indexOf(l)===-1&&n.push(l),r)}function S8(r,n,i,o,l){switch(n){case"focusin":return gc=Zf(gc,r,n,i,o,l),!0;case"dragenter":return vc=Zf(vc,r,n,i,o,l),!0;case"mouseover":return yc=Zf(yc,r,n,i,o,l),!0;case"pointerover":var a=l.pointerId;return im.set(a,Zf(im.get(a)||null,r,n,i,o,l)),!0;case"gotpointercapture":return a=l.pointerId,rm.set(a,Zf(rm.get(a)||null,r,n,i,o,l)),!0}return!1}function TP(r){var n=_u(r.target);if(n!==null){var i=Xu(n);if(i!==null){if(n=i.tag,n===13){if(n=mP(i),n!==null){r.blockedOn=n,SP(r.priority,function(){wP(i)});return}}else if(n===3&&i.stateNode.current.memoizedState.isDehydrated){r.blockedOn=i.tag===3?i.stateNode.containerInfo:null;return}}}r.blockedOn=null}function _0(r){if(r.blockedOn!==null)return!1;for(var n=r.targetContainers;0<n.length;){var i=nE(r.domEventName,r.eventSystemFlags,n[0],r.nativeEvent);if(i===null){i=r.nativeEvent;var o=new i.constructor(i.type,i);K1=o,i.target.dispatchEvent(o),K1=null}else return n=Dm(i),n!==null&&UA(n),r.blockedOn=i,!1;n.shift()}return!0}function A2(r,n,i){_0(r)&&i.delete(n)}function T8(){tE=!1,gc!==null&&_0(gc)&&(gc=null),vc!==null&&_0(vc)&&(vc=null),yc!==null&&_0(yc)&&(yc=null),im.forEach(A2),rm.forEach(A2)}function Jf(r,n){r.blockedOn===n&&(r.blockedOn=null,tE||(tE=!0,so.unstable_scheduleCallback(so.unstable_NormalPriority,T8)))}function sm(r){function n(l){return Jf(l,r)}if(0<gv.length){Jf(gv[0],r);for(var i=1;i<gv.length;i++){var o=gv[i];o.blockedOn===r&&(o.blockedOn=null)}}for(gc!==null&&Jf(gc,r),vc!==null&&Jf(vc,r),yc!==null&&Jf(yc,r),im.forEach(n),rm.forEach(n),i=0;i<hc.length;i++)o=hc[i],o.blockedOn===r&&(o.blockedOn=null);for(;0<hc.length&&(i=hc[0],i.blockedOn===null);)TP(i),i.blockedOn===null&&hc.shift()}var Od=Cl.ReactCurrentBatchConfig,q0=!0;function C8(r,n,i,o){var l=nr,a=Od.transition;Od.transition=null;try{nr=1,zA(r,n,i,o)}finally{nr=l,Od.transition=a}}function R8(r,n,i,o){var l=nr,a=Od.transition;Od.transition=null;try{nr=4,zA(r,n,i,o)}finally{nr=l,Od.transition=a}}function zA(r,n,i,o){if(q0){var l=nE(r,n,i,o);if(l===null)nb(r,n,o,Y0,i),E2(r,o);else if(S8(l,r,n,i,o))o.stopPropagation();else if(E2(r,o),n&4&&-1<M8.indexOf(r)){for(;l!==null;){var a=Dm(l);if(a!==null&&AP(a),a=nE(r,n,i,o),a===null&&nb(r,n,o,Y0,i),a===l)break;l=a}l!==null&&o.stopPropagation()}else nb(r,n,o,null,i)}}var Y0=null;function nE(r,n,i,o){if(Y0=null,r=NA(o),r=_u(r),r!==null)if(n=Xu(r),n===null)r=null;else if(i=n.tag,i===13){if(r=mP(n),r!==null)return r;r=null}else if(i===3){if(n.stateNode.current.memoizedState.isDehydrated)return n.tag===3?n.stateNode.containerInfo:null;r=null}else n!==r&&(r=null);return Y0=r,null}function CP(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(g8()){case FA:return 1;case xP:return 4;case $0:case v8:return 16;case _P:return 536870912;default:return 16}default:return 16}}var fc=null,HA=null,b0=null;function RP(){if(b0)return b0;var r,n=HA,i=n.length,o,l="value"in fc?fc.value:fc.textContent,a=l.length;for(r=0;r<i&&n[r]===l[r];r++);var u=i-r;for(o=1;o<=u&&n[i-o]===l[a-o];o++);return b0=l.slice(r,1<o?1-o:void 0)}function E0(r){var n=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&n===13&&(r=13)):r=n,r===10&&(r=13),32<=r||r===13?r:0}function vv(){return!0}function w2(){return!1}function uo(r){function n(i,o,l,a,u){this._reactName=i,this._targetInst=l,this.type=o,this.nativeEvent=a,this.target=u,this.currentTarget=null;for(var h in r)r.hasOwnProperty(h)&&(i=r[h],this[h]=i?i(a):a[h]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?vv:w2,this.isPropagationStopped=w2,this}return Ar(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var i=this.nativeEvent;i&&(i.preventDefault?i.preventDefault():typeof i.returnValue!="unknown"&&(i.returnValue=!1),this.isDefaultPrevented=vv)},stopPropagation:function(){var i=this.nativeEvent;i&&(i.stopPropagation?i.stopPropagation():typeof i.cancelBubble!="unknown"&&(i.cancelBubble=!0),this.isPropagationStopped=vv)},persist:function(){},isPersistent:vv}),n}var lf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},GA=uo(lf),Pm=Ar({},lf,{view:0,detail:0}),L8=uo(Pm),X_,q_,ep,Ry=Ar({},Pm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:VA,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==ep&&(ep&&r.type==="mousemove"?(X_=r.screenX-ep.screenX,q_=r.screenY-ep.screenY):q_=X_=0,ep=r),X_)},movementY:function(r){return"movementY"in r?r.movementY:q_}}),M2=uo(Ry),P8=Ar({},Ry,{dataTransfer:0}),D8=uo(P8),O8=Ar({},Pm,{relatedTarget:0}),Y_=uo(O8),I8=Ar({},lf,{animationName:0,elapsedTime:0,pseudoElement:0}),k8=uo(I8),N8=Ar({},lf,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),F8=uo(N8),B8=Ar({},lf,{data:0}),S2=uo(B8),U8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},z8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},H8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function G8(r){var n=this.nativeEvent;return n.getModifierState?n.getModifierState(r):(r=H8[r])?!!n[r]:!1}function VA(){return G8}var V8=Ar({},Pm,{key:function(r){if(r.key){var n=U8[r.key]||r.key;if(n!=="Unidentified")return n}return r.type==="keypress"?(r=E0(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?z8[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:VA,charCode:function(r){return r.type==="keypress"?E0(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?E0(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),W8=uo(V8),j8=Ar({},Ry,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T2=uo(j8),$8=Ar({},Pm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:VA}),X8=uo($8),q8=Ar({},lf,{propertyName:0,elapsedTime:0,pseudoElement:0}),Y8=uo(q8),K8=Ar({},Ry,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Q8=uo(K8),Z8=[9,13,27,32],WA=bl&&"CompositionEvent"in window,Up=null;bl&&"documentMode"in document&&(Up=document.documentMode);var J8=bl&&"TextEvent"in window&&!Up,LP=bl&&(!WA||Up&&8<Up&&11>=Up),C2=String.fromCharCode(32),R2=!1;function PP(r,n){switch(r){case"keyup":return Z8.indexOf(n.keyCode)!==-1;case"keydown":return n.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DP(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var md=!1;function ez(r,n){switch(r){case"compositionend":return DP(n);case"keypress":return n.which!==32?null:(R2=!0,C2);case"textInput":return r=n.data,r===C2&&R2?null:r;default:return null}}function tz(r,n){if(md)return r==="compositionend"||!WA&&PP(r,n)?(r=RP(),b0=HA=fc=null,md=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(n.ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(n.char&&1<n.char.length)return n.char;if(n.which)return String.fromCharCode(n.which)}return null;case"compositionend":return LP&&n.locale!=="ko"?null:n.data;default:return null}}var nz={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function L2(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n==="input"?!!nz[r.type]:n==="textarea"}function OP(r,n,i,o){uP(o),n=K0(n,"onChange"),0<n.length&&(i=new GA("onChange","change",null,i,o),r.push({event:i,listeners:n}))}var zp=null,om=null;function iz(r){WP(r,0)}function Ly(r){var n=yd(r);if(iP(n))return r}function rz(r,n){if(r==="change")return n}var IP=!1;if(bl){var K_;if(bl){var Q_="oninput"in document;if(!Q_){var P2=document.createElement("div");P2.setAttribute("oninput","return;"),Q_=typeof P2.oninput=="function"}K_=Q_}else K_=!1;IP=K_&&(!document.documentMode||9<document.documentMode)}function D2(){zp&&(zp.detachEvent("onpropertychange",kP),om=zp=null)}function kP(r){if(r.propertyName==="value"&&Ly(om)){var n=[];OP(n,om,r,NA(r)),pP(iz,n)}}function sz(r,n,i){r==="focusin"?(D2(),zp=n,om=i,zp.attachEvent("onpropertychange",kP)):r==="focusout"&&D2()}function oz(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ly(om)}function az(r,n){if(r==="click")return Ly(n)}function lz(r,n){if(r==="input"||r==="change")return Ly(n)}function cz(r,n){return r===n&&(r!==0||1/r===1/n)||r!==r&&n!==n}var na=typeof Object.is=="function"?Object.is:cz;function am(r,n){if(na(r,n))return!0;if(typeof r!="object"||r===null||typeof n!="object"||n===null)return!1;var i=Object.keys(r),o=Object.keys(n);if(i.length!==o.length)return!1;for(o=0;o<i.length;o++){var l=i[o];if(!B1.call(n,l)||!na(r[l],n[l]))return!1}return!0}function O2(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function I2(r,n){var i=O2(r);r=0;for(var o;i;){if(i.nodeType===3){if(o=r+i.textContent.length,r<=n&&o>=n)return{node:i,offset:n-r};r=o}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=O2(i)}}function NP(r,n){return r&&n?r===n?!0:r&&r.nodeType===3?!1:n&&n.nodeType===3?NP(r,n.parentNode):"contains"in r?r.contains(n):r.compareDocumentPosition?!!(r.compareDocumentPosition(n)&16):!1:!1}function FP(){for(var r=window,n=V0();n instanceof r.HTMLIFrameElement;){try{var i=typeof n.contentWindow.location.href=="string"}catch{i=!1}if(i)r=n.contentWindow;else break;n=V0(r.document)}return n}function jA(r){var n=r&&r.nodeName&&r.nodeName.toLowerCase();return n&&(n==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||n==="textarea"||r.contentEditable==="true")}function uz(r){var n=FP(),i=r.focusedElem,o=r.selectionRange;if(n!==i&&i&&i.ownerDocument&&NP(i.ownerDocument.documentElement,i)){if(o!==null&&jA(i)){if(n=o.start,r=o.end,r===void 0&&(r=n),"selectionStart"in i)i.selectionStart=n,i.selectionEnd=Math.min(r,i.value.length);else if(r=(n=i.ownerDocument||document)&&n.defaultView||window,r.getSelection){r=r.getSelection();var l=i.textContent.length,a=Math.min(o.start,l);o=o.end===void 0?a:Math.min(o.end,l),!r.extend&&a>o&&(l=o,o=a,a=l),l=I2(i,a);var u=I2(i,o);l&&u&&(r.rangeCount!==1||r.anchorNode!==l.node||r.anchorOffset!==l.offset||r.focusNode!==u.node||r.focusOffset!==u.offset)&&(n=n.createRange(),n.setStart(l.node,l.offset),r.removeAllRanges(),a>o?(r.addRange(n),r.extend(u.node,u.offset)):(n.setEnd(u.node,u.offset),r.addRange(n)))}}for(n=[],r=i;r=r.parentNode;)r.nodeType===1&&n.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof i.focus=="function"&&i.focus(),i=0;i<n.length;i++)r=n[i],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var hz=bl&&"documentMode"in document&&11>=document.documentMode,gd=null,iE=null,Hp=null,rE=!1;function k2(r,n,i){var o=i.window===i?i.document:i.nodeType===9?i:i.ownerDocument;rE||gd==null||gd!==V0(o)||(o=gd,"selectionStart"in o&&jA(o)?o={start:o.selectionStart,end:o.selectionEnd}:(o=(o.ownerDocument&&o.ownerDocument.defaultView||window).getSelection(),o={anchorNode:o.anchorNode,anchorOffset:o.anchorOffset,focusNode:o.focusNode,focusOffset:o.focusOffset}),Hp&&am(Hp,o)||(Hp=o,o=K0(iE,"onSelect"),0<o.length&&(n=new GA("onSelect","select",null,n,i),r.push({event:n,listeners:o}),n.target=gd)))}function yv(r,n){var i={};return i[r.toLowerCase()]=n.toLowerCase(),i["Webkit"+r]="webkit"+n,i["Moz"+r]="moz"+n,i}var vd={animationend:yv("Animation","AnimationEnd"),animationiteration:yv("Animation","AnimationIteration"),animationstart:yv("Animation","AnimationStart"),transitionend:yv("Transition","TransitionEnd")},Z_={},BP={};bl&&(BP=document.createElement("div").style,"AnimationEvent"in window||(delete vd.animationend.animation,delete vd.animationiteration.animation,delete vd.animationstart.animation),"TransitionEvent"in window||delete vd.transitionend.transition);function Py(r){if(Z_[r])return Z_[r];if(!vd[r])return r;var n=vd[r],i;for(i in n)if(n.hasOwnProperty(i)&&i in BP)return Z_[r]=n[i];return r}var UP=Py("animationend"),zP=Py("animationiteration"),HP=Py("animationstart"),GP=Py("transitionend"),VP=new Map,N2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Pc(r,n){VP.set(r,n),$u(n,[r])}for(var J_=0;J_<N2.length;J_++){var eb=N2[J_],dz=eb.toLowerCase(),fz=eb[0].toUpperCase()+eb.slice(1);Pc(dz,"on"+fz)}Pc(UP,"onAnimationEnd");Pc(zP,"onAnimationIteration");Pc(HP,"onAnimationStart");Pc("dblclick","onDoubleClick");Pc("focusin","onFocus");Pc("focusout","onBlur");Pc(GP,"onTransitionEnd");zd("onMouseEnter",["mouseout","mouseover"]);zd("onMouseLeave",["mouseout","mouseover"]);zd("onPointerEnter",["pointerout","pointerover"]);zd("onPointerLeave",["pointerout","pointerover"]);$u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$u("onBeforeInput",["compositionend","keypress","textInput","paste"]);$u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),pz=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lp));function F2(r,n,i){var o=r.type||"unknown-event";r.currentTarget=i,d8(o,n,void 0,r),r.currentTarget=null}function WP(r,n){n=(n&4)!==0;for(var i=0;i<r.length;i++){var o=r[i],l=o.event;o=o.listeners;e:{var a=void 0;if(n)for(var u=o.length-1;0<=u;u--){var h=o[u],f=h.instance,d=h.currentTarget;if(h=h.listener,f!==a&&l.isPropagationStopped())break e;F2(l,h,d),a=f}else for(u=0;u<o.length;u++){if(h=o[u],f=h.instance,d=h.currentTarget,h=h.listener,f!==a&&l.isPropagationStopped())break e;F2(l,h,d),a=f}}}if(j0)throw r=J1,j0=!1,J1=null,r}function dr(r,n){var i=n[cE];i===void 0&&(i=n[cE]=new Set);var o=r+"__bubble";i.has(o)||(jP(n,r,2,!1),i.add(o))}function tb(r,n,i){var o=0;n&&(o|=4),jP(i,r,o,n)}var xv="_reactListening"+Math.random().toString(36).slice(2);function lm(r){if(!r[xv]){r[xv]=!0,ZL.forEach(function(i){i!=="selectionchange"&&(pz.has(i)||tb(i,!1,r),tb(i,!0,r))});var n=r.nodeType===9?r:r.ownerDocument;n===null||n[xv]||(n[xv]=!0,tb("selectionchange",!1,n))}}function jP(r,n,i,o){switch(CP(n)){case 1:var l=C8;break;case 4:l=R8;break;default:l=zA}i=l.bind(null,n,i,r),l=void 0,!Z1||n!=="touchstart"&&n!=="touchmove"&&n!=="wheel"||(l=!0),o?l!==void 0?r.addEventListener(n,i,{capture:!0,passive:l}):r.addEventListener(n,i,!0):l!==void 0?r.addEventListener(n,i,{passive:l}):r.addEventListener(n,i,!1)}function nb(r,n,i,o,l){var a=o;if((n&1)===0&&(n&2)===0&&o!==null)e:for(;;){if(o===null)return;var u=o.tag;if(u===3||u===4){var h=o.stateNode.containerInfo;if(h===l||h.nodeType===8&&h.parentNode===l)break;if(u===4)for(u=o.return;u!==null;){var f=u.tag;if((f===3||f===4)&&(f=u.stateNode.containerInfo,f===l||f.nodeType===8&&f.parentNode===l))return;u=u.return}for(;h!==null;){if(u=_u(h),u===null)return;if(f=u.tag,f===5||f===6){o=a=u;continue e}h=h.parentNode}}o=o.return}pP(function(){var d=a,m=NA(i),g=[];e:{var x=VP.get(r);if(x!==void 0){var v=GA,A=r;switch(r){case"keypress":if(E0(i)===0)break e;case"keydown":case"keyup":v=W8;break;case"focusin":A="focus",v=Y_;break;case"focusout":A="blur",v=Y_;break;case"beforeblur":case"afterblur":v=Y_;break;case"click":if(i.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=M2;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=D8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=X8;break;case UP:case zP:case HP:v=k8;break;case GP:v=Y8;break;case"scroll":v=L8;break;case"wheel":v=Q8;break;case"copy":case"cut":case"paste":v=F8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=T2}var _=(n&4)!==0,E=!_&&r==="scroll",w=_?x!==null?x+"Capture":null:x;_=[];for(var S=d,T;S!==null;){T=S;var R=T.stateNode;if(T.tag===5&&R!==null&&(T=R,w!==null&&(R=nm(S,w),R!=null&&_.push(cm(S,R,T)))),E)break;S=S.return}0<_.length&&(x=new v(x,A,null,i,m),g.push({event:x,listeners:_}))}}if((n&7)===0){e:{if(x=r==="mouseover"||r==="pointerover",v=r==="mouseout"||r==="pointerout",x&&i!==K1&&(A=i.relatedTarget||i.fromElement)&&(_u(A)||A[El]))break e;if((v||x)&&(x=m.window===m?m:(x=m.ownerDocument)?x.defaultView||x.parentWindow:window,v?(A=i.relatedTarget||i.toElement,v=d,A=A?_u(A):null,A!==null&&(E=Xu(A),A!==E||A.tag!==5&&A.tag!==6)&&(A=null)):(v=null,A=d),v!==A)){if(_=M2,R="onMouseLeave",w="onMouseEnter",S="mouse",(r==="pointerout"||r==="pointerover")&&(_=T2,R="onPointerLeave",w="onPointerEnter",S="pointer"),E=v==null?x:yd(v),T=A==null?x:yd(A),x=new _(R,S+"leave",v,i,m),x.target=E,x.relatedTarget=T,R=null,_u(m)===d&&(_=new _(w,S+"enter",A,i,m),_.target=T,_.relatedTarget=E,R=_),E=R,v&&A)t:{for(_=v,w=A,S=0,T=_;T;T=zh(T))S++;for(T=0,R=w;R;R=zh(R))T++;for(;0<S-T;)_=zh(_),S--;for(;0<T-S;)w=zh(w),T--;for(;S--;){if(_===w||w!==null&&_===w.alternate)break t;_=zh(_),w=zh(w)}_=null}else _=null;v!==null&&B2(g,x,v,_,!1),A!==null&&E!==null&&B2(g,E,A,_,!0)}}e:{if(x=d?yd(d):window,v=x.nodeName&&x.nodeName.toLowerCase(),v==="select"||v==="input"&&x.type==="file")var L=rz;else if(L2(x))if(IP)L=lz;else{L=oz;var I=sz}else(v=x.nodeName)&&v.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(L=az);if(L&&(L=L(r,d))){OP(g,L,i,m);break e}I&&I(r,x,d),r==="focusout"&&(I=x._wrapperState)&&I.controlled&&x.type==="number"&&j1(x,"number",x.value)}switch(I=d?yd(d):window,r){case"focusin":(L2(I)||I.contentEditable==="true")&&(gd=I,iE=d,Hp=null);break;case"focusout":Hp=iE=gd=null;break;case"mousedown":rE=!0;break;case"contextmenu":case"mouseup":case"dragend":rE=!1,k2(g,i,m);break;case"selectionchange":if(hz)break;case"keydown":case"keyup":k2(g,i,m)}var N;if(WA)e:{switch(r){case"compositionstart":var B="onCompositionStart";break e;case"compositionend":B="onCompositionEnd";break e;case"compositionupdate":B="onCompositionUpdate";break e}B=void 0}else md?PP(r,i)&&(B="onCompositionEnd"):r==="keydown"&&i.keyCode===229&&(B="onCompositionStart");B&&(LP&&i.locale!=="ko"&&(md||B!=="onCompositionStart"?B==="onCompositionEnd"&&md&&(N=RP()):(fc=m,HA="value"in fc?fc.value:fc.textContent,md=!0)),I=K0(d,B),0<I.length&&(B=new S2(B,r,null,i,m),g.push({event:B,listeners:I}),N?B.data=N:(N=DP(i),N!==null&&(B.data=N)))),(N=J8?ez(r,i):tz(r,i))&&(d=K0(d,"onBeforeInput"),0<d.length&&(m=new S2("onBeforeInput","beforeinput",null,i,m),g.push({event:m,listeners:d}),m.data=N))}WP(g,n)})}function cm(r,n,i){return{instance:r,listener:n,currentTarget:i}}function K0(r,n){for(var i=n+"Capture",o=[];r!==null;){var l=r,a=l.stateNode;l.tag===5&&a!==null&&(l=a,a=nm(r,i),a!=null&&o.unshift(cm(r,a,l)),a=nm(r,n),a!=null&&o.push(cm(r,a,l))),r=r.return}return o}function zh(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function B2(r,n,i,o,l){for(var a=n._reactName,u=[];i!==null&&i!==o;){var h=i,f=h.alternate,d=h.stateNode;if(f!==null&&f===o)break;h.tag===5&&d!==null&&(h=d,l?(f=nm(i,a),f!=null&&u.unshift(cm(i,f,h))):l||(f=nm(i,a),f!=null&&u.push(cm(i,f,h)))),i=i.return}u.length!==0&&r.push({event:n,listeners:u})}var mz=/\r\n?/g,gz=/\u0000|\uFFFD/g;function U2(r){return(typeof r=="string"?r:""+r).replace(mz,`
`).replace(gz,"")}function _v(r,n,i){if(n=U2(n),U2(r)!==n&&i)throw Error(an(425))}function Q0(){}var sE=null,oE=null;function aE(r,n){return r==="textarea"||r==="noscript"||typeof n.children=="string"||typeof n.children=="number"||typeof n.dangerouslySetInnerHTML=="object"&&n.dangerouslySetInnerHTML!==null&&n.dangerouslySetInnerHTML.__html!=null}var lE=typeof setTimeout=="function"?setTimeout:void 0,vz=typeof clearTimeout=="function"?clearTimeout:void 0,z2=typeof Promise=="function"?Promise:void 0,yz=typeof queueMicrotask=="function"?queueMicrotask:typeof z2<"u"?function(r){return z2.resolve(null).then(r).catch(xz)}:lE;function xz(r){setTimeout(function(){throw r})}function ib(r,n){var i=n,o=0;do{var l=i.nextSibling;if(r.removeChild(i),l&&l.nodeType===8)if(i=l.data,i==="/$"){if(o===0){r.removeChild(l),sm(n);return}o--}else i!=="$"&&i!=="$?"&&i!=="$!"||o++;i=l}while(i);sm(n)}function xc(r){for(;r!=null;r=r.nextSibling){var n=r.nodeType;if(n===1||n===3)break;if(n===8){if(n=r.data,n==="$"||n==="$!"||n==="$?")break;if(n==="/$")return null}}return r}function H2(r){r=r.previousSibling;for(var n=0;r;){if(r.nodeType===8){var i=r.data;if(i==="$"||i==="$!"||i==="$?"){if(n===0)return r;n--}else i==="/$"&&n++}r=r.previousSibling}return null}var cf=Math.random().toString(36).slice(2),Ma="__reactFiber$"+cf,um="__reactProps$"+cf,El="__reactContainer$"+cf,cE="__reactEvents$"+cf,_z="__reactListeners$"+cf,bz="__reactHandles$"+cf;function _u(r){var n=r[Ma];if(n)return n;for(var i=r.parentNode;i;){if(n=i[El]||i[Ma]){if(i=n.alternate,n.child!==null||i!==null&&i.child!==null)for(r=H2(r);r!==null;){if(i=r[Ma])return i;r=H2(r)}return n}r=i,i=r.parentNode}return null}function Dm(r){return r=r[Ma]||r[El],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function yd(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(an(33))}function Dy(r){return r[um]||null}var uE=[],xd=-1;function Dc(r){return{current:r}}function mr(r){0>xd||(r.current=uE[xd],uE[xd]=null,xd--)}function ur(r,n){xd++,uE[xd]=r.current,r.current=n}var Sc={},xs=Dc(Sc),Us=Dc(!1),ku=Sc;function Hd(r,n){var i=r.type.contextTypes;if(!i)return Sc;var o=r.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===n)return o.__reactInternalMemoizedMaskedChildContext;var l={},a;for(a in i)l[a]=n[a];return o&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=n,r.__reactInternalMemoizedMaskedChildContext=l),l}function zs(r){return r=r.childContextTypes,r!=null}function Z0(){mr(Us),mr(xs)}function G2(r,n,i){if(xs.current!==Sc)throw Error(an(168));ur(xs,n),ur(Us,i)}function $P(r,n,i){var o=r.stateNode;if(n=n.childContextTypes,typeof o.getChildContext!="function")return i;o=o.getChildContext();for(var l in o)if(!(l in n))throw Error(an(108,s8(r)||"Unknown",l));return Ar({},i,o)}function J0(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Sc,ku=xs.current,ur(xs,r),ur(Us,Us.current),!0}function V2(r,n,i){var o=r.stateNode;if(!o)throw Error(an(169));i?(r=$P(r,n,ku),o.__reactInternalMemoizedMergedChildContext=r,mr(Us),mr(xs),ur(xs,r)):mr(Us),ur(Us,i)}var al=null,Oy=!1,rb=!1;function XP(r){al===null?al=[r]:al.push(r)}function Ez(r){Oy=!0,XP(r)}function Oc(){if(!rb&&al!==null){rb=!0;var r=0,n=nr;try{var i=al;for(nr=1;r<i.length;r++){var o=i[r];do o=o(!0);while(o!==null)}al=null,Oy=!1}catch(l){throw al!==null&&(al=al.slice(r+1)),yP(FA,Oc),l}finally{nr=n,rb=!1}}return null}var _d=[],bd=0,ey=null,ty=0,vo=[],yo=0,Nu=null,hl=1,dl="";function fu(r,n){_d[bd++]=ty,_d[bd++]=ey,ey=r,ty=n}function qP(r,n,i){vo[yo++]=hl,vo[yo++]=dl,vo[yo++]=Nu,Nu=r;var o=hl;r=dl;var l=32-Jo(o)-1;o&=~(1<<l),i+=1;var a=32-Jo(n)+l;if(30<a){var u=l-l%5;a=(o&(1<<u)-1).toString(32),o>>=u,l-=u,hl=1<<32-Jo(n)+l|i<<l|o,dl=a+r}else hl=1<<a|i<<l|o,dl=r}function $A(r){r.return!==null&&(fu(r,1),qP(r,1,0))}function XA(r){for(;r===ey;)ey=_d[--bd],_d[bd]=null,ty=_d[--bd],_d[bd]=null;for(;r===Nu;)Nu=vo[--yo],vo[yo]=null,dl=vo[--yo],vo[yo]=null,hl=vo[--yo],vo[yo]=null}var io=null,to=null,gr=!1,Xo=null;function YP(r,n){var i=Ao(5,null,null,0);i.elementType="DELETED",i.stateNode=n,i.return=r,n=r.deletions,n===null?(r.deletions=[i],r.flags|=16):n.push(i)}function W2(r,n){switch(r.tag){case 5:var i=r.type;return n=n.nodeType!==1||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n,n!==null?(r.stateNode=n,io=r,to=xc(n.firstChild),!0):!1;case 6:return n=r.pendingProps===""||n.nodeType!==3?null:n,n!==null?(r.stateNode=n,io=r,to=null,!0):!1;case 13:return n=n.nodeType!==8?null:n,n!==null?(i=Nu!==null?{id:hl,overflow:dl}:null,r.memoizedState={dehydrated:n,treeContext:i,retryLane:1073741824},i=Ao(18,null,null,0),i.stateNode=n,i.return=r,r.child=i,io=r,to=null,!0):!1;default:return!1}}function hE(r){return(r.mode&1)!==0&&(r.flags&128)===0}function dE(r){if(gr){var n=to;if(n){var i=n;if(!W2(r,n)){if(hE(r))throw Error(an(418));n=xc(i.nextSibling);var o=io;n&&W2(r,n)?YP(o,i):(r.flags=r.flags&-4097|2,gr=!1,io=r)}}else{if(hE(r))throw Error(an(418));r.flags=r.flags&-4097|2,gr=!1,io=r}}}function j2(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;io=r}function bv(r){if(r!==io)return!1;if(!gr)return j2(r),gr=!0,!1;var n;if((n=r.tag!==3)&&!(n=r.tag!==5)&&(n=r.type,n=n!=="head"&&n!=="body"&&!aE(r.type,r.memoizedProps)),n&&(n=to)){if(hE(r))throw KP(),Error(an(418));for(;n;)YP(r,n),n=xc(n.nextSibling)}if(j2(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(an(317));e:{for(r=r.nextSibling,n=0;r;){if(r.nodeType===8){var i=r.data;if(i==="/$"){if(n===0){to=xc(r.nextSibling);break e}n--}else i!=="$"&&i!=="$!"&&i!=="$?"||n++}r=r.nextSibling}to=null}}else to=io?xc(r.stateNode.nextSibling):null;return!0}function KP(){for(var r=to;r;)r=xc(r.nextSibling)}function Gd(){to=io=null,gr=!1}function qA(r){Xo===null?Xo=[r]:Xo.push(r)}var Az=Cl.ReactCurrentBatchConfig;function Wo(r,n){if(r&&r.defaultProps){n=Ar({},n),r=r.defaultProps;for(var i in r)n[i]===void 0&&(n[i]=r[i]);return n}return n}var ny=Dc(null),iy=null,Ed=null,YA=null;function KA(){YA=Ed=iy=null}function QA(r){var n=ny.current;mr(ny),r._currentValue=n}function fE(r,n,i){for(;r!==null;){var o=r.alternate;if((r.childLanes&n)!==n?(r.childLanes|=n,o!==null&&(o.childLanes|=n)):o!==null&&(o.childLanes&n)!==n&&(o.childLanes|=n),r===i)break;r=r.return}}function Id(r,n){iy=r,YA=Ed=null,r=r.dependencies,r!==null&&r.firstContext!==null&&((r.lanes&n)!==0&&(Fs=!0),r.firstContext=null)}function So(r){var n=r._currentValue;if(YA!==r)if(r={context:r,memoizedValue:n,next:null},Ed===null){if(iy===null)throw Error(an(308));Ed=r,iy.dependencies={lanes:0,firstContext:r}}else Ed=Ed.next=r;return n}var bu=null;function ZA(r){bu===null?bu=[r]:bu.push(r)}function QP(r,n,i,o){var l=n.interleaved;return l===null?(i.next=i,ZA(n)):(i.next=l.next,l.next=i),n.interleaved=i,Al(r,o)}function Al(r,n){r.lanes|=n;var i=r.alternate;for(i!==null&&(i.lanes|=n),i=r,r=r.return;r!==null;)r.childLanes|=n,i=r.alternate,i!==null&&(i.childLanes|=n),i=r,r=r.return;return i.tag===3?i.stateNode:null}var lc=!1;function JA(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ZP(r,n){r=r.updateQueue,n.updateQueue===r&&(n.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ml(r,n){return{eventTime:r,lane:n,tag:0,payload:null,callback:null,next:null}}function _c(r,n,i){var o=r.updateQueue;if(o===null)return null;if(o=o.shared,(Xi&2)!==0){var l=o.pending;return l===null?n.next=n:(n.next=l.next,l.next=n),o.pending=n,Al(r,i)}return l=o.interleaved,l===null?(n.next=n,ZA(o)):(n.next=l.next,l.next=n),o.interleaved=n,Al(r,i)}function A0(r,n,i){if(n=n.updateQueue,n!==null&&(n=n.shared,(i&4194240)!==0)){var o=n.lanes;o&=r.pendingLanes,i|=o,n.lanes=i,BA(r,i)}}function $2(r,n){var i=r.updateQueue,o=r.alternate;if(o!==null&&(o=o.updateQueue,i===o)){var l=null,a=null;if(i=i.firstBaseUpdate,i!==null){do{var u={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};a===null?l=a=u:a=a.next=u,i=i.next}while(i!==null);a===null?l=a=n:a=a.next=n}else l=a=n;i={baseState:o.baseState,firstBaseUpdate:l,lastBaseUpdate:a,shared:o.shared,effects:o.effects},r.updateQueue=i;return}r=i.lastBaseUpdate,r===null?i.firstBaseUpdate=n:r.next=n,i.lastBaseUpdate=n}function ry(r,n,i,o){var l=r.updateQueue;lc=!1;var a=l.firstBaseUpdate,u=l.lastBaseUpdate,h=l.shared.pending;if(h!==null){l.shared.pending=null;var f=h,d=f.next;f.next=null,u===null?a=d:u.next=d,u=f;var m=r.alternate;m!==null&&(m=m.updateQueue,h=m.lastBaseUpdate,h!==u&&(h===null?m.firstBaseUpdate=d:h.next=d,m.lastBaseUpdate=f))}if(a!==null){var g=l.baseState;u=0,m=d=f=null,h=a;do{var x=h.lane,v=h.eventTime;if((o&x)===x){m!==null&&(m=m.next={eventTime:v,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var A=r,_=h;switch(x=n,v=i,_.tag){case 1:if(A=_.payload,typeof A=="function"){g=A.call(v,g,x);break e}g=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=_.payload,x=typeof A=="function"?A.call(v,g,x):A,x==null)break e;g=Ar({},g,x);break e;case 2:lc=!0}}h.callback!==null&&h.lane!==0&&(r.flags|=64,x=l.effects,x===null?l.effects=[h]:x.push(h))}else v={eventTime:v,lane:x,tag:h.tag,payload:h.payload,callback:h.callback,next:null},m===null?(d=m=v,f=g):m=m.next=v,u|=x;if(h=h.next,h===null){if(h=l.shared.pending,h===null)break;x=h,h=x.next,x.next=null,l.lastBaseUpdate=x,l.shared.pending=null}}while(1);if(m===null&&(f=g),l.baseState=f,l.firstBaseUpdate=d,l.lastBaseUpdate=m,n=l.shared.interleaved,n!==null){l=n;do u|=l.lane,l=l.next;while(l!==n)}else a===null&&(l.shared.lanes=0);Bu|=u,r.lanes=u,r.memoizedState=g}}function X2(r,n,i){if(r=n.effects,n.effects=null,r!==null)for(n=0;n<r.length;n++){var o=r[n],l=o.callback;if(l!==null){if(o.callback=null,o=i,typeof l!="function")throw Error(an(191,l));l.call(o)}}}var JP=new QL.Component().refs;function pE(r,n,i,o){n=r.memoizedState,i=i(o,n),i=i==null?n:Ar({},n,i),r.memoizedState=i,r.lanes===0&&(r.updateQueue.baseState=i)}var Iy={isMounted:function(r){return(r=r._reactInternals)?Xu(r)===r:!1},enqueueSetState:function(r,n,i){r=r._reactInternals;var o=Cs(),l=Ec(r),a=ml(o,l);a.payload=n,i!=null&&(a.callback=i),n=_c(r,a,l),n!==null&&(ea(n,r,l,o),A0(n,r,l))},enqueueReplaceState:function(r,n,i){r=r._reactInternals;var o=Cs(),l=Ec(r),a=ml(o,l);a.tag=1,a.payload=n,i!=null&&(a.callback=i),n=_c(r,a,l),n!==null&&(ea(n,r,l,o),A0(n,r,l))},enqueueForceUpdate:function(r,n){r=r._reactInternals;var i=Cs(),o=Ec(r),l=ml(i,o);l.tag=2,n!=null&&(l.callback=n),n=_c(r,l,o),n!==null&&(ea(n,r,o,i),A0(n,r,o))}};function q2(r,n,i,o,l,a,u){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(o,a,u):n.prototype&&n.prototype.isPureReactComponent?!am(i,o)||!am(l,a):!0}function eD(r,n,i){var o=!1,l=Sc,a=n.contextType;return typeof a=="object"&&a!==null?a=So(a):(l=zs(n)?ku:xs.current,o=n.contextTypes,a=(o=o!=null)?Hd(r,l):Sc),n=new n(i,a),r.memoizedState=n.state!==null&&n.state!==void 0?n.state:null,n.updater=Iy,r.stateNode=n,n._reactInternals=r,o&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=l,r.__reactInternalMemoizedMaskedChildContext=a),n}function Y2(r,n,i,o){r=n.state,typeof n.componentWillReceiveProps=="function"&&n.componentWillReceiveProps(i,o),typeof n.UNSAFE_componentWillReceiveProps=="function"&&n.UNSAFE_componentWillReceiveProps(i,o),n.state!==r&&Iy.enqueueReplaceState(n,n.state,null)}function mE(r,n,i,o){var l=r.stateNode;l.props=i,l.state=r.memoizedState,l.refs=JP,JA(r);var a=n.contextType;typeof a=="object"&&a!==null?l.context=So(a):(a=zs(n)?ku:xs.current,l.context=Hd(r,a)),l.state=r.memoizedState,a=n.getDerivedStateFromProps,typeof a=="function"&&(pE(r,n,a,i),l.state=r.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(n=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),n!==l.state&&Iy.enqueueReplaceState(l,l.state,null),ry(r,i,l,o),l.state=r.memoizedState),typeof l.componentDidMount=="function"&&(r.flags|=4194308)}function tp(r,n,i){if(r=i.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(i._owner){if(i=i._owner,i){if(i.tag!==1)throw Error(an(309));var o=i.stateNode}if(!o)throw Error(an(147,r));var l=o,a=""+r;return n!==null&&n.ref!==null&&typeof n.ref=="function"&&n.ref._stringRef===a?n.ref:(n=function(u){var h=l.refs;h===JP&&(h=l.refs={}),u===null?delete h[a]:h[a]=u},n._stringRef=a,n)}if(typeof r!="string")throw Error(an(284));if(!i._owner)throw Error(an(290,r))}return r}function Ev(r,n){throw r=Object.prototype.toString.call(n),Error(an(31,r==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":r))}function K2(r){var n=r._init;return n(r._payload)}function tD(r){function n(w,S){if(r){var T=w.deletions;T===null?(w.deletions=[S],w.flags|=16):T.push(S)}}function i(w,S){if(!r)return null;for(;S!==null;)n(w,S),S=S.sibling;return null}function o(w,S){for(w=new Map;S!==null;)S.key!==null?w.set(S.key,S):w.set(S.index,S),S=S.sibling;return w}function l(w,S){return w=Ac(w,S),w.index=0,w.sibling=null,w}function a(w,S,T){return w.index=T,r?(T=w.alternate,T!==null?(T=T.index,T<S?(w.flags|=2,S):T):(w.flags|=2,S)):(w.flags|=1048576,S)}function u(w){return r&&w.alternate===null&&(w.flags|=2),w}function h(w,S,T,R){return S===null||S.tag!==6?(S=hb(T,w.mode,R),S.return=w,S):(S=l(S,T),S.return=w,S)}function f(w,S,T,R){var L=T.type;return L===pd?m(w,S,T.props.children,R,T.key):S!==null&&(S.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ac&&K2(L)===S.type)?(R=l(S,T.props),R.ref=tp(w,S,T),R.return=w,R):(R=R0(T.type,T.key,T.props,null,w.mode,R),R.ref=tp(w,S,T),R.return=w,R)}function d(w,S,T,R){return S===null||S.tag!==4||S.stateNode.containerInfo!==T.containerInfo||S.stateNode.implementation!==T.implementation?(S=db(T,w.mode,R),S.return=w,S):(S=l(S,T.children||[]),S.return=w,S)}function m(w,S,T,R,L){return S===null||S.tag!==7?(S=Lu(T,w.mode,R,L),S.return=w,S):(S=l(S,T),S.return=w,S)}function g(w,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return S=hb(""+S,w.mode,T),S.return=w,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case hv:return T=R0(S.type,S.key,S.props,null,w.mode,T),T.ref=tp(w,null,S),T.return=w,T;case fd:return S=db(S,w.mode,T),S.return=w,S;case ac:var R=S._init;return g(w,R(S._payload),T)}if(Cp(S)||Kf(S))return S=Lu(S,w.mode,T,null),S.return=w,S;Ev(w,S)}return null}function x(w,S,T,R){var L=S!==null?S.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return L!==null?null:h(w,S,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case hv:return T.key===L?f(w,S,T,R):null;case fd:return T.key===L?d(w,S,T,R):null;case ac:return L=T._init,x(w,S,L(T._payload),R)}if(Cp(T)||Kf(T))return L!==null?null:m(w,S,T,R,null);Ev(w,T)}return null}function v(w,S,T,R,L){if(typeof R=="string"&&R!==""||typeof R=="number")return w=w.get(T)||null,h(S,w,""+R,L);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case hv:return w=w.get(R.key===null?T:R.key)||null,f(S,w,R,L);case fd:return w=w.get(R.key===null?T:R.key)||null,d(S,w,R,L);case ac:var I=R._init;return v(w,S,T,I(R._payload),L)}if(Cp(R)||Kf(R))return w=w.get(T)||null,m(S,w,R,L,null);Ev(S,R)}return null}function A(w,S,T,R){for(var L=null,I=null,N=S,B=S=0,H=null;N!==null&&B<T.length;B++){N.index>B?(H=N,N=null):H=N.sibling;var q=x(w,N,T[B],R);if(q===null){N===null&&(N=H);break}r&&N&&q.alternate===null&&n(w,N),S=a(q,S,B),I===null?L=q:I.sibling=q,I=q,N=H}if(B===T.length)return i(w,N),gr&&fu(w,B),L;if(N===null){for(;B<T.length;B++)N=g(w,T[B],R),N!==null&&(S=a(N,S,B),I===null?L=N:I.sibling=N,I=N);return gr&&fu(w,B),L}for(N=o(w,N);B<T.length;B++)H=v(N,w,B,T[B],R),H!==null&&(r&&H.alternate!==null&&N.delete(H.key===null?B:H.key),S=a(H,S,B),I===null?L=H:I.sibling=H,I=H);return r&&N.forEach(function(le){return n(w,le)}),gr&&fu(w,B),L}function _(w,S,T,R){var L=Kf(T);if(typeof L!="function")throw Error(an(150));if(T=L.call(T),T==null)throw Error(an(151));for(var I=L=null,N=S,B=S=0,H=null,q=T.next();N!==null&&!q.done;B++,q=T.next()){N.index>B?(H=N,N=null):H=N.sibling;var le=x(w,N,q.value,R);if(le===null){N===null&&(N=H);break}r&&N&&le.alternate===null&&n(w,N),S=a(le,S,B),I===null?L=le:I.sibling=le,I=le,N=H}if(q.done)return i(w,N),gr&&fu(w,B),L;if(N===null){for(;!q.done;B++,q=T.next())q=g(w,q.value,R),q!==null&&(S=a(q,S,B),I===null?L=q:I.sibling=q,I=q);return gr&&fu(w,B),L}for(N=o(w,N);!q.done;B++,q=T.next())q=v(N,w,B,q.value,R),q!==null&&(r&&q.alternate!==null&&N.delete(q.key===null?B:q.key),S=a(q,S,B),I===null?L=q:I.sibling=q,I=q);return r&&N.forEach(function(ne){return n(w,ne)}),gr&&fu(w,B),L}function E(w,S,T,R){if(typeof T=="object"&&T!==null&&T.type===pd&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case hv:e:{for(var L=T.key,I=S;I!==null;){if(I.key===L){if(L=T.type,L===pd){if(I.tag===7){i(w,I.sibling),S=l(I,T.props.children),S.return=w,w=S;break e}}else if(I.elementType===L||typeof L=="object"&&L!==null&&L.$$typeof===ac&&K2(L)===I.type){i(w,I.sibling),S=l(I,T.props),S.ref=tp(w,I,T),S.return=w,w=S;break e}i(w,I);break}else n(w,I);I=I.sibling}T.type===pd?(S=Lu(T.props.children,w.mode,R,T.key),S.return=w,w=S):(R=R0(T.type,T.key,T.props,null,w.mode,R),R.ref=tp(w,S,T),R.return=w,w=R)}return u(w);case fd:e:{for(I=T.key;S!==null;){if(S.key===I)if(S.tag===4&&S.stateNode.containerInfo===T.containerInfo&&S.stateNode.implementation===T.implementation){i(w,S.sibling),S=l(S,T.children||[]),S.return=w,w=S;break e}else{i(w,S);break}else n(w,S);S=S.sibling}S=db(T,w.mode,R),S.return=w,w=S}return u(w);case ac:return I=T._init,E(w,S,I(T._payload),R)}if(Cp(T))return A(w,S,T,R);if(Kf(T))return _(w,S,T,R);Ev(w,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,S!==null&&S.tag===6?(i(w,S.sibling),S=l(S,T),S.return=w,w=S):(i(w,S),S=hb(T,w.mode,R),S.return=w,w=S),u(w)):i(w,S)}return E}var Vd=tD(!0),nD=tD(!1),Om={},Ta=Dc(Om),hm=Dc(Om),dm=Dc(Om);function Eu(r){if(r===Om)throw Error(an(174));return r}function ew(r,n){switch(ur(dm,n),ur(hm,r),ur(Ta,Om),r=n.nodeType,r){case 9:case 11:n=(n=n.documentElement)?n.namespaceURI:X1(null,"");break;default:r=r===8?n.parentNode:n,n=r.namespaceURI||null,r=r.tagName,n=X1(n,r)}mr(Ta),ur(Ta,n)}function Wd(){mr(Ta),mr(hm),mr(dm)}function iD(r){Eu(dm.current);var n=Eu(Ta.current),i=X1(n,r.type);n!==i&&(ur(hm,r),ur(Ta,i))}function tw(r){hm.current===r&&(mr(Ta),mr(hm))}var _r=Dc(0);function sy(r){for(var n=r;n!==null;){if(n.tag===13){var i=n.memoizedState;if(i!==null&&(i=i.dehydrated,i===null||i.data==="$?"||i.data==="$!"))return n}else if(n.tag===19&&n.memoizedProps.revealOrder!==void 0){if((n.flags&128)!==0)return n}else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return null;n=n.return}n.sibling.return=n.return,n=n.sibling}return null}var sb=[];function nw(){for(var r=0;r<sb.length;r++)sb[r]._workInProgressVersionPrimary=null;sb.length=0}var w0=Cl.ReactCurrentDispatcher,ob=Cl.ReactCurrentBatchConfig,Fu=0,br=null,Wr=null,es=null,oy=!1,Gp=!1,fm=0,wz=0;function fs(){throw Error(an(321))}function iw(r,n){if(n===null)return!1;for(var i=0;i<n.length&&i<r.length;i++)if(!na(r[i],n[i]))return!1;return!0}function rw(r,n,i,o,l,a){if(Fu=a,br=n,n.memoizedState=null,n.updateQueue=null,n.lanes=0,w0.current=r===null||r.memoizedState===null?Cz:Rz,r=i(o,l),Gp){a=0;do{if(Gp=!1,fm=0,25<=a)throw Error(an(301));a+=1,es=Wr=null,n.updateQueue=null,w0.current=Lz,r=i(o,l)}while(Gp)}if(w0.current=ay,n=Wr!==null&&Wr.next!==null,Fu=0,es=Wr=br=null,oy=!1,n)throw Error(an(300));return r}function sw(){var r=fm!==0;return fm=0,r}function _a(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return es===null?br.memoizedState=es=r:es=es.next=r,es}function To(){if(Wr===null){var r=br.alternate;r=r!==null?r.memoizedState:null}else r=Wr.next;var n=es===null?br.memoizedState:es.next;if(n!==null)es=n,Wr=r;else{if(r===null)throw Error(an(310));Wr=r,r={memoizedState:Wr.memoizedState,baseState:Wr.baseState,baseQueue:Wr.baseQueue,queue:Wr.queue,next:null},es===null?br.memoizedState=es=r:es=es.next=r}return es}function pm(r,n){return typeof n=="function"?n(r):n}function ab(r){var n=To(),i=n.queue;if(i===null)throw Error(an(311));i.lastRenderedReducer=r;var o=Wr,l=o.baseQueue,a=i.pending;if(a!==null){if(l!==null){var u=l.next;l.next=a.next,a.next=u}o.baseQueue=l=a,i.pending=null}if(l!==null){a=l.next,o=o.baseState;var h=u=null,f=null,d=a;do{var m=d.lane;if((Fu&m)===m)f!==null&&(f=f.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),o=d.hasEagerState?d.eagerState:r(o,d.action);else{var g={lane:m,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};f===null?(h=f=g,u=o):f=f.next=g,br.lanes|=m,Bu|=m}d=d.next}while(d!==null&&d!==a);f===null?u=o:f.next=h,na(o,n.memoizedState)||(Fs=!0),n.memoizedState=o,n.baseState=u,n.baseQueue=f,i.lastRenderedState=o}if(r=i.interleaved,r!==null){l=r;do a=l.lane,br.lanes|=a,Bu|=a,l=l.next;while(l!==r)}else l===null&&(i.lanes=0);return[n.memoizedState,i.dispatch]}function lb(r){var n=To(),i=n.queue;if(i===null)throw Error(an(311));i.lastRenderedReducer=r;var o=i.dispatch,l=i.pending,a=n.memoizedState;if(l!==null){i.pending=null;var u=l=l.next;do a=r(a,u.action),u=u.next;while(u!==l);na(a,n.memoizedState)||(Fs=!0),n.memoizedState=a,n.baseQueue===null&&(n.baseState=a),i.lastRenderedState=a}return[a,o]}function rD(){}function sD(r,n){var i=br,o=To(),l=n(),a=!na(o.memoizedState,l);if(a&&(o.memoizedState=l,Fs=!0),o=o.queue,ow(lD.bind(null,i,o,r),[r]),o.getSnapshot!==n||a||es!==null&&es.memoizedState.tag&1){if(i.flags|=2048,mm(9,aD.bind(null,i,o,l,n),void 0,null),ns===null)throw Error(an(349));(Fu&30)!==0||oD(i,n,l)}return l}function oD(r,n,i){r.flags|=16384,r={getSnapshot:n,value:i},n=br.updateQueue,n===null?(n={lastEffect:null,stores:null},br.updateQueue=n,n.stores=[r]):(i=n.stores,i===null?n.stores=[r]:i.push(r))}function aD(r,n,i,o){n.value=i,n.getSnapshot=o,cD(n)&&uD(r)}function lD(r,n,i){return i(function(){cD(n)&&uD(r)})}function cD(r){var n=r.getSnapshot;r=r.value;try{var i=n();return!na(r,i)}catch{return!0}}function uD(r){var n=Al(r,1);n!==null&&ea(n,r,1,-1)}function Q2(r){var n=_a();return typeof r=="function"&&(r=r()),n.memoizedState=n.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pm,lastRenderedState:r},n.queue=r,r=r.dispatch=Tz.bind(null,br,r),[n.memoizedState,r]}function mm(r,n,i,o){return r={tag:r,create:n,destroy:i,deps:o,next:null},n=br.updateQueue,n===null?(n={lastEffect:null,stores:null},br.updateQueue=n,n.lastEffect=r.next=r):(i=n.lastEffect,i===null?n.lastEffect=r.next=r:(o=i.next,i.next=r,r.next=o,n.lastEffect=r)),r}function hD(){return To().memoizedState}function M0(r,n,i,o){var l=_a();br.flags|=r,l.memoizedState=mm(1|n,i,void 0,o===void 0?null:o)}function ky(r,n,i,o){var l=To();o=o===void 0?null:o;var a=void 0;if(Wr!==null){var u=Wr.memoizedState;if(a=u.destroy,o!==null&&iw(o,u.deps)){l.memoizedState=mm(n,i,a,o);return}}br.flags|=r,l.memoizedState=mm(1|n,i,a,o)}function Z2(r,n){return M0(8390656,8,r,n)}function ow(r,n){return ky(2048,8,r,n)}function dD(r,n){return ky(4,2,r,n)}function fD(r,n){return ky(4,4,r,n)}function pD(r,n){if(typeof n=="function")return r=r(),n(r),function(){n(null)};if(n!=null)return r=r(),n.current=r,function(){n.current=null}}function mD(r,n,i){return i=i!=null?i.concat([r]):null,ky(4,4,pD.bind(null,n,r),i)}function aw(){}function gD(r,n){var i=To();n=n===void 0?null:n;var o=i.memoizedState;return o!==null&&n!==null&&iw(n,o[1])?o[0]:(i.memoizedState=[r,n],r)}function vD(r,n){var i=To();n=n===void 0?null:n;var o=i.memoizedState;return o!==null&&n!==null&&iw(n,o[1])?o[0]:(r=r(),i.memoizedState=[r,n],r)}function yD(r,n,i){return(Fu&21)===0?(r.baseState&&(r.baseState=!1,Fs=!0),r.memoizedState=i):(na(i,n)||(i=bP(),br.lanes|=i,Bu|=i,r.baseState=!0),n)}function Mz(r,n){var i=nr;nr=i!==0&&4>i?i:4,r(!0);var o=ob.transition;ob.transition={};try{r(!1),n()}finally{nr=i,ob.transition=o}}function xD(){return To().memoizedState}function Sz(r,n,i){var o=Ec(r);if(i={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null},_D(r))bD(n,i);else if(i=QP(r,n,i,o),i!==null){var l=Cs();ea(i,r,o,l),ED(i,n,o)}}function Tz(r,n,i){var o=Ec(r),l={lane:o,action:i,hasEagerState:!1,eagerState:null,next:null};if(_D(r))bD(n,l);else{var a=r.alternate;if(r.lanes===0&&(a===null||a.lanes===0)&&(a=n.lastRenderedReducer,a!==null))try{var u=n.lastRenderedState,h=a(u,i);if(l.hasEagerState=!0,l.eagerState=h,na(h,u)){var f=n.interleaved;f===null?(l.next=l,ZA(n)):(l.next=f.next,f.next=l),n.interleaved=l;return}}catch{}finally{}i=QP(r,n,l,o),i!==null&&(l=Cs(),ea(i,r,o,l),ED(i,n,o))}}function _D(r){var n=r.alternate;return r===br||n!==null&&n===br}function bD(r,n){Gp=oy=!0;var i=r.pending;i===null?n.next=n:(n.next=i.next,i.next=n),r.pending=n}function ED(r,n,i){if((i&4194240)!==0){var o=n.lanes;o&=r.pendingLanes,i|=o,n.lanes=i,BA(r,i)}}var ay={readContext:So,useCallback:fs,useContext:fs,useEffect:fs,useImperativeHandle:fs,useInsertionEffect:fs,useLayoutEffect:fs,useMemo:fs,useReducer:fs,useRef:fs,useState:fs,useDebugValue:fs,useDeferredValue:fs,useTransition:fs,useMutableSource:fs,useSyncExternalStore:fs,useId:fs,unstable_isNewReconciler:!1},Cz={readContext:So,useCallback:function(r,n){return _a().memoizedState=[r,n===void 0?null:n],r},useContext:So,useEffect:Z2,useImperativeHandle:function(r,n,i){return i=i!=null?i.concat([r]):null,M0(4194308,4,pD.bind(null,n,r),i)},useLayoutEffect:function(r,n){return M0(4194308,4,r,n)},useInsertionEffect:function(r,n){return M0(4,2,r,n)},useMemo:function(r,n){var i=_a();return n=n===void 0?null:n,r=r(),i.memoizedState=[r,n],r},useReducer:function(r,n,i){var o=_a();return n=i!==void 0?i(n):n,o.memoizedState=o.baseState=n,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:n},o.queue=r,r=r.dispatch=Sz.bind(null,br,r),[o.memoizedState,r]},useRef:function(r){var n=_a();return r={current:r},n.memoizedState=r},useState:Q2,useDebugValue:aw,useDeferredValue:function(r){return _a().memoizedState=r},useTransition:function(){var r=Q2(!1),n=r[0];return r=Mz.bind(null,r[1]),_a().memoizedState=r,[n,r]},useMutableSource:function(){},useSyncExternalStore:function(r,n,i){var o=br,l=_a();if(gr){if(i===void 0)throw Error(an(407));i=i()}else{if(i=n(),ns===null)throw Error(an(349));(Fu&30)!==0||oD(o,n,i)}l.memoizedState=i;var a={value:i,getSnapshot:n};return l.queue=a,Z2(lD.bind(null,o,a,r),[r]),o.flags|=2048,mm(9,aD.bind(null,o,a,i,n),void 0,null),i},useId:function(){var r=_a(),n=ns.identifierPrefix;if(gr){var i=dl,o=hl;i=(o&~(1<<32-Jo(o)-1)).toString(32)+i,n=":"+n+"R"+i,i=fm++,0<i&&(n+="H"+i.toString(32)),n+=":"}else i=wz++,n=":"+n+"r"+i.toString(32)+":";return r.memoizedState=n},unstable_isNewReconciler:!1},Rz={readContext:So,useCallback:gD,useContext:So,useEffect:ow,useImperativeHandle:mD,useInsertionEffect:dD,useLayoutEffect:fD,useMemo:vD,useReducer:ab,useRef:hD,useState:function(){return ab(pm)},useDebugValue:aw,useDeferredValue:function(r){var n=To();return yD(n,Wr.memoizedState,r)},useTransition:function(){var r=ab(pm)[0],n=To().memoizedState;return[r,n]},useMutableSource:rD,useSyncExternalStore:sD,useId:xD,unstable_isNewReconciler:!1},Lz={readContext:So,useCallback:gD,useContext:So,useEffect:ow,useImperativeHandle:mD,useInsertionEffect:dD,useLayoutEffect:fD,useMemo:vD,useReducer:lb,useRef:hD,useState:function(){return lb(pm)},useDebugValue:aw,useDeferredValue:function(r){var n=To();return Wr===null?n.memoizedState=r:yD(n,Wr.memoizedState,r)},useTransition:function(){var r=lb(pm)[0],n=To().memoizedState;return[r,n]},useMutableSource:rD,useSyncExternalStore:sD,useId:xD,unstable_isNewReconciler:!1};function jd(r,n){try{var i="",o=n;do i+=r8(o),o=o.return;while(o);var l=i}catch(a){l=`
Error generating stack: `+a.message+`
`+a.stack}return{value:r,source:n,stack:l,digest:null}}function cb(r,n,i){return{value:r,source:null,stack:i!=null?i:null,digest:n!=null?n:null}}function gE(r,n){try{console.error(n.value)}catch(i){setTimeout(function(){throw i})}}var Pz=typeof WeakMap=="function"?WeakMap:Map;function AD(r,n,i){i=ml(-1,i),i.tag=3,i.payload={element:null};var o=n.value;return i.callback=function(){cy||(cy=!0,SE=o),gE(r,n)},i}function wD(r,n,i){i=ml(-1,i),i.tag=3;var o=r.type.getDerivedStateFromError;if(typeof o=="function"){var l=n.value;i.payload=function(){return o(l)},i.callback=function(){gE(r,n)}}var a=r.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(i.callback=function(){gE(r,n),typeof o!="function"&&(bc===null?bc=new Set([this]):bc.add(this));var u=n.stack;this.componentDidCatch(n.value,{componentStack:u!==null?u:""})}),i}function J2(r,n,i){var o=r.pingCache;if(o===null){o=r.pingCache=new Pz;var l=new Set;o.set(n,l)}else l=o.get(n),l===void 0&&(l=new Set,o.set(n,l));l.has(i)||(l.add(i),r=jz.bind(null,r,n,i),n.then(r,r))}function eC(r){do{var n;if((n=r.tag===13)&&(n=r.memoizedState,n=n!==null?n.dehydrated!==null:!0),n)return r;r=r.return}while(r!==null);return null}function tC(r,n,i,o,l){return(r.mode&1)===0?(r===n?r.flags|=65536:(r.flags|=128,i.flags|=131072,i.flags&=-52805,i.tag===1&&(i.alternate===null?i.tag=17:(n=ml(-1,1),n.tag=2,_c(i,n,1))),i.lanes|=1),r):(r.flags|=65536,r.lanes=l,r)}var Dz=Cl.ReactCurrentOwner,Fs=!1;function Ms(r,n,i,o){n.child=r===null?nD(n,null,i,o):Vd(n,r.child,i,o)}function nC(r,n,i,o,l){i=i.render;var a=n.ref;return Id(n,l),o=rw(r,n,i,o,a,l),i=sw(),r!==null&&!Fs?(n.updateQueue=r.updateQueue,n.flags&=-2053,r.lanes&=~l,wl(r,n,l)):(gr&&i&&$A(n),n.flags|=1,Ms(r,n,o,l),n.child)}function iC(r,n,i,o,l){if(r===null){var a=i.type;return typeof a=="function"&&!mw(a)&&a.defaultProps===void 0&&i.compare===null&&i.defaultProps===void 0?(n.tag=15,n.type=a,MD(r,n,a,o,l)):(r=R0(i.type,null,o,n,n.mode,l),r.ref=n.ref,r.return=n,n.child=r)}if(a=r.child,(r.lanes&l)===0){var u=a.memoizedProps;if(i=i.compare,i=i!==null?i:am,i(u,o)&&r.ref===n.ref)return wl(r,n,l)}return n.flags|=1,r=Ac(a,o),r.ref=n.ref,r.return=n,n.child=r}function MD(r,n,i,o,l){if(r!==null){var a=r.memoizedProps;if(am(a,o)&&r.ref===n.ref)if(Fs=!1,n.pendingProps=o=a,(r.lanes&l)!==0)(r.flags&131072)!==0&&(Fs=!0);else return n.lanes=r.lanes,wl(r,n,l)}return vE(r,n,i,o,l)}function SD(r,n,i){var o=n.pendingProps,l=o.children,a=r!==null?r.memoizedState:null;if(o.mode==="hidden")if((n.mode&1)===0)n.memoizedState={baseLanes:0,cachePool:null,transitions:null},ur(wd,eo),eo|=i;else{if((i&1073741824)===0)return r=a!==null?a.baseLanes|i:i,n.lanes=n.childLanes=1073741824,n.memoizedState={baseLanes:r,cachePool:null,transitions:null},n.updateQueue=null,ur(wd,eo),eo|=r,null;n.memoizedState={baseLanes:0,cachePool:null,transitions:null},o=a!==null?a.baseLanes:i,ur(wd,eo),eo|=o}else a!==null?(o=a.baseLanes|i,n.memoizedState=null):o=i,ur(wd,eo),eo|=o;return Ms(r,n,l,i),n.child}function TD(r,n){var i=n.ref;(r===null&&i!==null||r!==null&&r.ref!==i)&&(n.flags|=512,n.flags|=2097152)}function vE(r,n,i,o,l){var a=zs(i)?ku:xs.current;return a=Hd(n,a),Id(n,l),i=rw(r,n,i,o,a,l),o=sw(),r!==null&&!Fs?(n.updateQueue=r.updateQueue,n.flags&=-2053,r.lanes&=~l,wl(r,n,l)):(gr&&o&&$A(n),n.flags|=1,Ms(r,n,i,l),n.child)}function rC(r,n,i,o,l){if(zs(i)){var a=!0;J0(n)}else a=!1;if(Id(n,l),n.stateNode===null)S0(r,n),eD(n,i,o),mE(n,i,o,l),o=!0;else if(r===null){var u=n.stateNode,h=n.memoizedProps;u.props=h;var f=u.context,d=i.contextType;typeof d=="object"&&d!==null?d=So(d):(d=zs(i)?ku:xs.current,d=Hd(n,d));var m=i.getDerivedStateFromProps,g=typeof m=="function"||typeof u.getSnapshotBeforeUpdate=="function";g||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(h!==o||f!==d)&&Y2(n,u,o,d),lc=!1;var x=n.memoizedState;u.state=x,ry(n,o,u,l),f=n.memoizedState,h!==o||x!==f||Us.current||lc?(typeof m=="function"&&(pE(n,i,m,o),f=n.memoizedState),(h=lc||q2(n,i,h,o,x,f,d))?(g||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount()),typeof u.componentDidMount=="function"&&(n.flags|=4194308)):(typeof u.componentDidMount=="function"&&(n.flags|=4194308),n.memoizedProps=o,n.memoizedState=f),u.props=o,u.state=f,u.context=d,o=h):(typeof u.componentDidMount=="function"&&(n.flags|=4194308),o=!1)}else{u=n.stateNode,ZP(r,n),h=n.memoizedProps,d=n.type===n.elementType?h:Wo(n.type,h),u.props=d,g=n.pendingProps,x=u.context,f=i.contextType,typeof f=="object"&&f!==null?f=So(f):(f=zs(i)?ku:xs.current,f=Hd(n,f));var v=i.getDerivedStateFromProps;(m=typeof v=="function"||typeof u.getSnapshotBeforeUpdate=="function")||typeof u.UNSAFE_componentWillReceiveProps!="function"&&typeof u.componentWillReceiveProps!="function"||(h!==g||x!==f)&&Y2(n,u,o,f),lc=!1,x=n.memoizedState,u.state=x,ry(n,o,u,l);var A=n.memoizedState;h!==g||x!==A||Us.current||lc?(typeof v=="function"&&(pE(n,i,v,o),A=n.memoizedState),(d=lc||q2(n,i,d,o,x,A,f)||!1)?(m||typeof u.UNSAFE_componentWillUpdate!="function"&&typeof u.componentWillUpdate!="function"||(typeof u.componentWillUpdate=="function"&&u.componentWillUpdate(o,A,f),typeof u.UNSAFE_componentWillUpdate=="function"&&u.UNSAFE_componentWillUpdate(o,A,f)),typeof u.componentDidUpdate=="function"&&(n.flags|=4),typeof u.getSnapshotBeforeUpdate=="function"&&(n.flags|=1024)):(typeof u.componentDidUpdate!="function"||h===r.memoizedProps&&x===r.memoizedState||(n.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||h===r.memoizedProps&&x===r.memoizedState||(n.flags|=1024),n.memoizedProps=o,n.memoizedState=A),u.props=o,u.state=A,u.context=f,o=d):(typeof u.componentDidUpdate!="function"||h===r.memoizedProps&&x===r.memoizedState||(n.flags|=4),typeof u.getSnapshotBeforeUpdate!="function"||h===r.memoizedProps&&x===r.memoizedState||(n.flags|=1024),o=!1)}return yE(r,n,i,o,a,l)}function yE(r,n,i,o,l,a){TD(r,n);var u=(n.flags&128)!==0;if(!o&&!u)return l&&V2(n,i,!1),wl(r,n,a);o=n.stateNode,Dz.current=n;var h=u&&typeof i.getDerivedStateFromError!="function"?null:o.render();return n.flags|=1,r!==null&&u?(n.child=Vd(n,r.child,null,a),n.child=Vd(n,null,h,a)):Ms(r,n,h,a),n.memoizedState=o.state,l&&V2(n,i,!0),n.child}function CD(r){var n=r.stateNode;n.pendingContext?G2(r,n.pendingContext,n.pendingContext!==n.context):n.context&&G2(r,n.context,!1),ew(r,n.containerInfo)}function sC(r,n,i,o,l){return Gd(),qA(l),n.flags|=256,Ms(r,n,i,o),n.child}var xE={dehydrated:null,treeContext:null,retryLane:0};function _E(r){return{baseLanes:r,cachePool:null,transitions:null}}function RD(r,n,i){var o=n.pendingProps,l=_r.current,a=!1,u=(n.flags&128)!==0,h;if((h=u)||(h=r!==null&&r.memoizedState===null?!1:(l&2)!==0),h?(a=!0,n.flags&=-129):(r===null||r.memoizedState!==null)&&(l|=1),ur(_r,l&1),r===null)return dE(n),r=n.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?((n.mode&1)===0?n.lanes=1:r.data==="$!"?n.lanes=8:n.lanes=1073741824,null):(u=o.children,r=o.fallback,a?(o=n.mode,a=n.child,u={mode:"hidden",children:u},(o&1)===0&&a!==null?(a.childLanes=0,a.pendingProps=u):a=By(u,o,0,null),r=Lu(r,o,i,null),a.return=n,r.return=n,a.sibling=r,n.child=a,n.child.memoizedState=_E(i),n.memoizedState=xE,r):lw(n,u));if(l=r.memoizedState,l!==null&&(h=l.dehydrated,h!==null))return Oz(r,n,u,o,h,l,i);if(a){a=o.fallback,u=n.mode,l=r.child,h=l.sibling;var f={mode:"hidden",children:o.children};return(u&1)===0&&n.child!==l?(o=n.child,o.childLanes=0,o.pendingProps=f,n.deletions=null):(o=Ac(l,f),o.subtreeFlags=l.subtreeFlags&14680064),h!==null?a=Ac(h,a):(a=Lu(a,u,i,null),a.flags|=2),a.return=n,o.return=n,o.sibling=a,n.child=o,o=a,a=n.child,u=r.child.memoizedState,u=u===null?_E(i):{baseLanes:u.baseLanes|i,cachePool:null,transitions:u.transitions},a.memoizedState=u,a.childLanes=r.childLanes&~i,n.memoizedState=xE,o}return a=r.child,r=a.sibling,o=Ac(a,{mode:"visible",children:o.children}),(n.mode&1)===0&&(o.lanes=i),o.return=n,o.sibling=null,r!==null&&(i=n.deletions,i===null?(n.deletions=[r],n.flags|=16):i.push(r)),n.child=o,n.memoizedState=null,o}function lw(r,n){return n=By({mode:"visible",children:n},r.mode,0,null),n.return=r,r.child=n}function Av(r,n,i,o){return o!==null&&qA(o),Vd(n,r.child,null,i),r=lw(n,n.pendingProps.children),r.flags|=2,n.memoizedState=null,r}function Oz(r,n,i,o,l,a,u){if(i)return n.flags&256?(n.flags&=-257,o=cb(Error(an(422))),Av(r,n,u,o)):n.memoizedState!==null?(n.child=r.child,n.flags|=128,null):(a=o.fallback,l=n.mode,o=By({mode:"visible",children:o.children},l,0,null),a=Lu(a,l,u,null),a.flags|=2,o.return=n,a.return=n,o.sibling=a,n.child=o,(n.mode&1)!==0&&Vd(n,r.child,null,u),n.child.memoizedState=_E(u),n.memoizedState=xE,a);if((n.mode&1)===0)return Av(r,n,u,null);if(l.data==="$!"){if(o=l.nextSibling&&l.nextSibling.dataset,o)var h=o.dgst;return o=h,a=Error(an(419)),o=cb(a,o,void 0),Av(r,n,u,o)}if(h=(u&r.childLanes)!==0,Fs||h){if(o=ns,o!==null){switch(u&-u){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=(l&(o.suspendedLanes|u))!==0?0:l,l!==0&&l!==a.retryLane&&(a.retryLane=l,Al(r,l),ea(o,r,l,-1))}return pw(),o=cb(Error(an(421))),Av(r,n,u,o)}return l.data==="$?"?(n.flags|=128,n.child=r.child,n=$z.bind(null,r),l._reactRetry=n,null):(r=a.treeContext,to=xc(l.nextSibling),io=n,gr=!0,Xo=null,r!==null&&(vo[yo++]=hl,vo[yo++]=dl,vo[yo++]=Nu,hl=r.id,dl=r.overflow,Nu=n),n=lw(n,o.children),n.flags|=4096,n)}function oC(r,n,i){r.lanes|=n;var o=r.alternate;o!==null&&(o.lanes|=n),fE(r.return,n,i)}function ub(r,n,i,o,l){var a=r.memoizedState;a===null?r.memoizedState={isBackwards:n,rendering:null,renderingStartTime:0,last:o,tail:i,tailMode:l}:(a.isBackwards=n,a.rendering=null,a.renderingStartTime=0,a.last=o,a.tail=i,a.tailMode=l)}function LD(r,n,i){var o=n.pendingProps,l=o.revealOrder,a=o.tail;if(Ms(r,n,o.children,i),o=_r.current,(o&2)!==0)o=o&1|2,n.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=n.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&oC(r,i,n);else if(r.tag===19)oC(r,i,n);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===n)break e;for(;r.sibling===null;){if(r.return===null||r.return===n)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}o&=1}if(ur(_r,o),(n.mode&1)===0)n.memoizedState=null;else switch(l){case"forwards":for(i=n.child,l=null;i!==null;)r=i.alternate,r!==null&&sy(r)===null&&(l=i),i=i.sibling;i=l,i===null?(l=n.child,n.child=null):(l=i.sibling,i.sibling=null),ub(n,!1,l,i,a);break;case"backwards":for(i=null,l=n.child,n.child=null;l!==null;){if(r=l.alternate,r!==null&&sy(r)===null){n.child=l;break}r=l.sibling,l.sibling=i,i=l,l=r}ub(n,!0,i,null,a);break;case"together":ub(n,!1,null,null,void 0);break;default:n.memoizedState=null}return n.child}function S0(r,n){(n.mode&1)===0&&r!==null&&(r.alternate=null,n.alternate=null,n.flags|=2)}function wl(r,n,i){if(r!==null&&(n.dependencies=r.dependencies),Bu|=n.lanes,(i&n.childLanes)===0)return null;if(r!==null&&n.child!==r.child)throw Error(an(153));if(n.child!==null){for(r=n.child,i=Ac(r,r.pendingProps),n.child=i,i.return=n;r.sibling!==null;)r=r.sibling,i=i.sibling=Ac(r,r.pendingProps),i.return=n;i.sibling=null}return n.child}function Iz(r,n,i){switch(n.tag){case 3:CD(n),Gd();break;case 5:iD(n);break;case 1:zs(n.type)&&J0(n);break;case 4:ew(n,n.stateNode.containerInfo);break;case 10:var o=n.type._context,l=n.memoizedProps.value;ur(ny,o._currentValue),o._currentValue=l;break;case 13:if(o=n.memoizedState,o!==null)return o.dehydrated!==null?(ur(_r,_r.current&1),n.flags|=128,null):(i&n.child.childLanes)!==0?RD(r,n,i):(ur(_r,_r.current&1),r=wl(r,n,i),r!==null?r.sibling:null);ur(_r,_r.current&1);break;case 19:if(o=(i&n.childLanes)!==0,(r.flags&128)!==0){if(o)return LD(r,n,i);n.flags|=128}if(l=n.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),ur(_r,_r.current),o)break;return null;case 22:case 23:return n.lanes=0,SD(r,n,i)}return wl(r,n,i)}var PD,bE,DD,OD;PD=function(r,n){for(var i=n.child;i!==null;){if(i.tag===5||i.tag===6)r.appendChild(i.stateNode);else if(i.tag!==4&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};bE=function(){};DD=function(r,n,i,o){var l=r.memoizedProps;if(l!==o){r=n.stateNode,Eu(Ta.current);var a=null;switch(i){case"input":l=V1(r,l),o=V1(r,o),a=[];break;case"select":l=Ar({},l,{value:void 0}),o=Ar({},o,{value:void 0}),a=[];break;case"textarea":l=$1(r,l),o=$1(r,o),a=[];break;default:typeof l.onClick!="function"&&typeof o.onClick=="function"&&(r.onclick=Q0)}q1(i,o);var u;i=null;for(d in l)if(!o.hasOwnProperty(d)&&l.hasOwnProperty(d)&&l[d]!=null)if(d==="style"){var h=l[d];for(u in h)h.hasOwnProperty(u)&&(i||(i={}),i[u]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(em.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in o){var f=o[d];if(h=l!=null?l[d]:void 0,o.hasOwnProperty(d)&&f!==h&&(f!=null||h!=null))if(d==="style")if(h){for(u in h)!h.hasOwnProperty(u)||f&&f.hasOwnProperty(u)||(i||(i={}),i[u]="");for(u in f)f.hasOwnProperty(u)&&h[u]!==f[u]&&(i||(i={}),i[u]=f[u])}else i||(a||(a=[]),a.push(d,i)),i=f;else d==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,h=h?h.__html:void 0,f!=null&&h!==f&&(a=a||[]).push(d,f)):d==="children"?typeof f!="string"&&typeof f!="number"||(a=a||[]).push(d,""+f):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(em.hasOwnProperty(d)?(f!=null&&d==="onScroll"&&dr("scroll",r),a||h===f||(a=[])):(a=a||[]).push(d,f))}i&&(a=a||[]).push("style",i);var d=a;(n.updateQueue=d)&&(n.flags|=4)}};OD=function(r,n,i,o){i!==o&&(n.flags|=4)};function np(r,n){if(!gr)switch(r.tailMode){case"hidden":n=r.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?r.tail=null:i.sibling=null;break;case"collapsed":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?n||r.tail===null?r.tail=null:r.tail.sibling=null:o.sibling=null}}function ps(r){var n=r.alternate!==null&&r.alternate.child===r.child,i=0,o=0;if(n)for(var l=r.child;l!==null;)i|=l.lanes|l.childLanes,o|=l.subtreeFlags&14680064,o|=l.flags&14680064,l.return=r,l=l.sibling;else for(l=r.child;l!==null;)i|=l.lanes|l.childLanes,o|=l.subtreeFlags,o|=l.flags,l.return=r,l=l.sibling;return r.subtreeFlags|=o,r.childLanes=i,n}function kz(r,n,i){var o=n.pendingProps;switch(XA(n),n.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ps(n),null;case 1:return zs(n.type)&&Z0(),ps(n),null;case 3:return o=n.stateNode,Wd(),mr(Us),mr(xs),nw(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(bv(n)?n.flags|=4:r===null||r.memoizedState.isDehydrated&&(n.flags&256)===0||(n.flags|=1024,Xo!==null&&(RE(Xo),Xo=null))),bE(r,n),ps(n),null;case 5:tw(n);var l=Eu(dm.current);if(i=n.type,r!==null&&n.stateNode!=null)DD(r,n,i,o,l),r.ref!==n.ref&&(n.flags|=512,n.flags|=2097152);else{if(!o){if(n.stateNode===null)throw Error(an(166));return ps(n),null}if(r=Eu(Ta.current),bv(n)){o=n.stateNode,i=n.type;var a=n.memoizedProps;switch(o[Ma]=n,o[um]=a,r=(n.mode&1)!==0,i){case"dialog":dr("cancel",o),dr("close",o);break;case"iframe":case"object":case"embed":dr("load",o);break;case"video":case"audio":for(l=0;l<Lp.length;l++)dr(Lp[l],o);break;case"source":dr("error",o);break;case"img":case"image":case"link":dr("error",o),dr("load",o);break;case"details":dr("toggle",o);break;case"input":m2(o,a),dr("invalid",o);break;case"select":o._wrapperState={wasMultiple:!!a.multiple},dr("invalid",o);break;case"textarea":v2(o,a),dr("invalid",o)}q1(i,a),l=null;for(var u in a)if(a.hasOwnProperty(u)){var h=a[u];u==="children"?typeof h=="string"?o.textContent!==h&&(a.suppressHydrationWarning!==!0&&_v(o.textContent,h,r),l=["children",h]):typeof h=="number"&&o.textContent!==""+h&&(a.suppressHydrationWarning!==!0&&_v(o.textContent,h,r),l=["children",""+h]):em.hasOwnProperty(u)&&h!=null&&u==="onScroll"&&dr("scroll",o)}switch(i){case"input":dv(o),g2(o,a,!0);break;case"textarea":dv(o),y2(o);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(o.onclick=Q0)}o=l,n.updateQueue=o,o!==null&&(n.flags|=4)}else{u=l.nodeType===9?l:l.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=oP(i)),r==="http://www.w3.org/1999/xhtml"?i==="script"?(r=u.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof o.is=="string"?r=u.createElement(i,{is:o.is}):(r=u.createElement(i),i==="select"&&(u=r,o.multiple?u.multiple=!0:o.size&&(u.size=o.size))):r=u.createElementNS(r,i),r[Ma]=n,r[um]=o,PD(r,n,!1,!1),n.stateNode=r;e:{switch(u=Y1(i,o),i){case"dialog":dr("cancel",r),dr("close",r),l=o;break;case"iframe":case"object":case"embed":dr("load",r),l=o;break;case"video":case"audio":for(l=0;l<Lp.length;l++)dr(Lp[l],r);l=o;break;case"source":dr("error",r),l=o;break;case"img":case"image":case"link":dr("error",r),dr("load",r),l=o;break;case"details":dr("toggle",r),l=o;break;case"input":m2(r,o),l=V1(r,o),dr("invalid",r);break;case"option":l=o;break;case"select":r._wrapperState={wasMultiple:!!o.multiple},l=Ar({},o,{value:void 0}),dr("invalid",r);break;case"textarea":v2(r,o),l=$1(r,o),dr("invalid",r);break;default:l=o}q1(i,l),h=l;for(a in h)if(h.hasOwnProperty(a)){var f=h[a];a==="style"?cP(r,f):a==="dangerouslySetInnerHTML"?(f=f?f.__html:void 0,f!=null&&aP(r,f)):a==="children"?typeof f=="string"?(i!=="textarea"||f!=="")&&tm(r,f):typeof f=="number"&&tm(r,""+f):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(em.hasOwnProperty(a)?f!=null&&a==="onScroll"&&dr("scroll",r):f!=null&&DA(r,a,f,u))}switch(i){case"input":dv(r),g2(r,o,!1);break;case"textarea":dv(r),y2(r);break;case"option":o.value!=null&&r.setAttribute("value",""+Mc(o.value));break;case"select":r.multiple=!!o.multiple,a=o.value,a!=null?Ld(r,!!o.multiple,a,!1):o.defaultValue!=null&&Ld(r,!!o.multiple,o.defaultValue,!0);break;default:typeof l.onClick=="function"&&(r.onclick=Q0)}switch(i){case"button":case"input":case"select":case"textarea":o=!!o.autoFocus;break e;case"img":o=!0;break e;default:o=!1}}o&&(n.flags|=4)}n.ref!==null&&(n.flags|=512,n.flags|=2097152)}return ps(n),null;case 6:if(r&&n.stateNode!=null)OD(r,n,r.memoizedProps,o);else{if(typeof o!="string"&&n.stateNode===null)throw Error(an(166));if(i=Eu(dm.current),Eu(Ta.current),bv(n)){if(o=n.stateNode,i=n.memoizedProps,o[Ma]=n,(a=o.nodeValue!==i)&&(r=io,r!==null))switch(r.tag){case 3:_v(o.nodeValue,i,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&_v(o.nodeValue,i,(r.mode&1)!==0)}a&&(n.flags|=4)}else o=(i.nodeType===9?i:i.ownerDocument).createTextNode(o),o[Ma]=n,n.stateNode=o}return ps(n),null;case 13:if(mr(_r),o=n.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(gr&&to!==null&&(n.mode&1)!==0&&(n.flags&128)===0)KP(),Gd(),n.flags|=98560,a=!1;else if(a=bv(n),o!==null&&o.dehydrated!==null){if(r===null){if(!a)throw Error(an(318));if(a=n.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(an(317));a[Ma]=n}else Gd(),(n.flags&128)===0&&(n.memoizedState=null),n.flags|=4;ps(n),a=!1}else Xo!==null&&(RE(Xo),Xo=null),a=!0;if(!a)return n.flags&65536?n:null}return(n.flags&128)!==0?(n.lanes=i,n):(o=o!==null,o!==(r!==null&&r.memoizedState!==null)&&o&&(n.child.flags|=8192,(n.mode&1)!==0&&(r===null||(_r.current&1)!==0?jr===0&&(jr=3):pw())),n.updateQueue!==null&&(n.flags|=4),ps(n),null);case 4:return Wd(),bE(r,n),r===null&&lm(n.stateNode.containerInfo),ps(n),null;case 10:return QA(n.type._context),ps(n),null;case 17:return zs(n.type)&&Z0(),ps(n),null;case 19:if(mr(_r),a=n.memoizedState,a===null)return ps(n),null;if(o=(n.flags&128)!==0,u=a.rendering,u===null)if(o)np(a,!1);else{if(jr!==0||r!==null&&(r.flags&128)!==0)for(r=n.child;r!==null;){if(u=sy(r),u!==null){for(n.flags|=128,np(a,!1),o=u.updateQueue,o!==null&&(n.updateQueue=o,n.flags|=4),n.subtreeFlags=0,o=i,i=n.child;i!==null;)a=i,r=o,a.flags&=14680066,u=a.alternate,u===null?(a.childLanes=0,a.lanes=r,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,r=u.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),i=i.sibling;return ur(_r,_r.current&1|2),n.child}r=r.sibling}a.tail!==null&&kr()>$d&&(n.flags|=128,o=!0,np(a,!1),n.lanes=4194304)}else{if(!o)if(r=sy(u),r!==null){if(n.flags|=128,o=!0,i=r.updateQueue,i!==null&&(n.updateQueue=i,n.flags|=4),np(a,!0),a.tail===null&&a.tailMode==="hidden"&&!u.alternate&&!gr)return ps(n),null}else 2*kr()-a.renderingStartTime>$d&&i!==1073741824&&(n.flags|=128,o=!0,np(a,!1),n.lanes=4194304);a.isBackwards?(u.sibling=n.child,n.child=u):(i=a.last,i!==null?i.sibling=u:n.child=u,a.last=u)}return a.tail!==null?(n=a.tail,a.rendering=n,a.tail=n.sibling,a.renderingStartTime=kr(),n.sibling=null,i=_r.current,ur(_r,o?i&1|2:i&1),n):(ps(n),null);case 22:case 23:return fw(),o=n.memoizedState!==null,r!==null&&r.memoizedState!==null!==o&&(n.flags|=8192),o&&(n.mode&1)!==0?(eo&1073741824)!==0&&(ps(n),n.subtreeFlags&6&&(n.flags|=8192)):ps(n),null;case 24:return null;case 25:return null}throw Error(an(156,n.tag))}function Nz(r,n){switch(XA(n),n.tag){case 1:return zs(n.type)&&Z0(),r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 3:return Wd(),mr(Us),mr(xs),nw(),r=n.flags,(r&65536)!==0&&(r&128)===0?(n.flags=r&-65537|128,n):null;case 5:return tw(n),null;case 13:if(mr(_r),r=n.memoizedState,r!==null&&r.dehydrated!==null){if(n.alternate===null)throw Error(an(340));Gd()}return r=n.flags,r&65536?(n.flags=r&-65537|128,n):null;case 19:return mr(_r),null;case 4:return Wd(),null;case 10:return QA(n.type._context),null;case 22:case 23:return fw(),null;case 24:return null;default:return null}}var wv=!1,vs=!1,Fz=typeof WeakSet=="function"?WeakSet:Set,kn=null;function Ad(r,n){var i=r.ref;if(i!==null)if(typeof i=="function")try{i(null)}catch(o){Lr(r,n,o)}else i.current=null}function EE(r,n,i){try{i()}catch(o){Lr(r,n,o)}}var aC=!1;function Bz(r,n){if(sE=q0,r=FP(),jA(r)){if("selectionStart"in r)var i={start:r.selectionStart,end:r.selectionEnd};else e:{i=(i=r.ownerDocument)&&i.defaultView||window;var o=i.getSelection&&i.getSelection();if(o&&o.rangeCount!==0){i=o.anchorNode;var l=o.anchorOffset,a=o.focusNode;o=o.focusOffset;try{i.nodeType,a.nodeType}catch{i=null;break e}var u=0,h=-1,f=-1,d=0,m=0,g=r,x=null;t:for(;;){for(var v;g!==i||l!==0&&g.nodeType!==3||(h=u+l),g!==a||o!==0&&g.nodeType!==3||(f=u+o),g.nodeType===3&&(u+=g.nodeValue.length),(v=g.firstChild)!==null;)x=g,g=v;for(;;){if(g===r)break t;if(x===i&&++d===l&&(h=u),x===a&&++m===o&&(f=u),(v=g.nextSibling)!==null)break;g=x,x=g.parentNode}g=v}i=h===-1||f===-1?null:{start:h,end:f}}else i=null}i=i||{start:0,end:0}}else i=null;for(oE={focusedElem:r,selectionRange:i},q0=!1,kn=n;kn!==null;)if(n=kn,r=n.child,(n.subtreeFlags&1028)!==0&&r!==null)r.return=n,kn=r;else for(;kn!==null;){n=kn;try{var A=n.alternate;if((n.flags&1024)!==0)switch(n.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var _=A.memoizedProps,E=A.memoizedState,w=n.stateNode,S=w.getSnapshotBeforeUpdate(n.elementType===n.type?_:Wo(n.type,_),E);w.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var T=n.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(an(163))}}catch(R){Lr(n,n.return,R)}if(r=n.sibling,r!==null){r.return=n.return,kn=r;break}kn=n.return}return A=aC,aC=!1,A}function Vp(r,n,i){var o=n.updateQueue;if(o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&r)===r){var a=l.destroy;l.destroy=void 0,a!==void 0&&EE(n,i,a)}l=l.next}while(l!==o)}}function Ny(r,n){if(n=n.updateQueue,n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&r)===r){var o=i.create;i.destroy=o()}i=i.next}while(i!==n)}}function AE(r){var n=r.ref;if(n!==null){var i=r.stateNode;switch(r.tag){case 5:r=i;break;default:r=i}typeof n=="function"?n(r):n.current=r}}function ID(r){var n=r.alternate;n!==null&&(r.alternate=null,ID(n)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(n=r.stateNode,n!==null&&(delete n[Ma],delete n[um],delete n[cE],delete n[_z],delete n[bz])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function kD(r){return r.tag===5||r.tag===3||r.tag===4}function lC(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||kD(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function wE(r,n,i){var o=r.tag;if(o===5||o===6)r=r.stateNode,n?i.nodeType===8?i.parentNode.insertBefore(r,n):i.insertBefore(r,n):(i.nodeType===8?(n=i.parentNode,n.insertBefore(r,i)):(n=i,n.appendChild(r)),i=i._reactRootContainer,i!=null||n.onclick!==null||(n.onclick=Q0));else if(o!==4&&(r=r.child,r!==null))for(wE(r,n,i),r=r.sibling;r!==null;)wE(r,n,i),r=r.sibling}function ME(r,n,i){var o=r.tag;if(o===5||o===6)r=r.stateNode,n?i.insertBefore(r,n):i.appendChild(r);else if(o!==4&&(r=r.child,r!==null))for(ME(r,n,i),r=r.sibling;r!==null;)ME(r,n,i),r=r.sibling}var os=null,jo=!1;function ql(r,n,i){for(i=i.child;i!==null;)ND(r,n,i),i=i.sibling}function ND(r,n,i){if(Sa&&typeof Sa.onCommitFiberUnmount=="function")try{Sa.onCommitFiberUnmount(Cy,i)}catch{}switch(i.tag){case 5:vs||Ad(i,n);case 6:var o=os,l=jo;os=null,ql(r,n,i),os=o,jo=l,os!==null&&(jo?(r=os,i=i.stateNode,r.nodeType===8?r.parentNode.removeChild(i):r.removeChild(i)):os.removeChild(i.stateNode));break;case 18:os!==null&&(jo?(r=os,i=i.stateNode,r.nodeType===8?ib(r.parentNode,i):r.nodeType===1&&ib(r,i),sm(r)):ib(os,i.stateNode));break;case 4:o=os,l=jo,os=i.stateNode.containerInfo,jo=!0,ql(r,n,i),os=o,jo=l;break;case 0:case 11:case 14:case 15:if(!vs&&(o=i.updateQueue,o!==null&&(o=o.lastEffect,o!==null))){l=o=o.next;do{var a=l,u=a.destroy;a=a.tag,u!==void 0&&((a&2)!==0||(a&4)!==0)&&EE(i,n,u),l=l.next}while(l!==o)}ql(r,n,i);break;case 1:if(!vs&&(Ad(i,n),o=i.stateNode,typeof o.componentWillUnmount=="function"))try{o.props=i.memoizedProps,o.state=i.memoizedState,o.componentWillUnmount()}catch(h){Lr(i,n,h)}ql(r,n,i);break;case 21:ql(r,n,i);break;case 22:i.mode&1?(vs=(o=vs)||i.memoizedState!==null,ql(r,n,i),vs=o):ql(r,n,i);break;default:ql(r,n,i)}}function cC(r){var n=r.updateQueue;if(n!==null){r.updateQueue=null;var i=r.stateNode;i===null&&(i=r.stateNode=new Fz),n.forEach(function(o){var l=Xz.bind(null,r,o);i.has(o)||(i.add(o),o.then(l,l))})}}function Uo(r,n){var i=n.deletions;if(i!==null)for(var o=0;o<i.length;o++){var l=i[o];try{var a=r,u=n,h=u;e:for(;h!==null;){switch(h.tag){case 5:os=h.stateNode,jo=!1;break e;case 3:os=h.stateNode.containerInfo,jo=!0;break e;case 4:os=h.stateNode.containerInfo,jo=!0;break e}h=h.return}if(os===null)throw Error(an(160));ND(a,u,l),os=null,jo=!1;var f=l.alternate;f!==null&&(f.return=null),l.return=null}catch(d){Lr(l,n,d)}}if(n.subtreeFlags&12854)for(n=n.child;n!==null;)FD(n,r),n=n.sibling}function FD(r,n){var i=r.alternate,o=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(Uo(n,r),xa(r),o&4){try{Vp(3,r,r.return),Ny(3,r)}catch(_){Lr(r,r.return,_)}try{Vp(5,r,r.return)}catch(_){Lr(r,r.return,_)}}break;case 1:Uo(n,r),xa(r),o&512&&i!==null&&Ad(i,i.return);break;case 5:if(Uo(n,r),xa(r),o&512&&i!==null&&Ad(i,i.return),r.flags&32){var l=r.stateNode;try{tm(l,"")}catch(_){Lr(r,r.return,_)}}if(o&4&&(l=r.stateNode,l!=null)){var a=r.memoizedProps,u=i!==null?i.memoizedProps:a,h=r.type,f=r.updateQueue;if(r.updateQueue=null,f!==null)try{h==="input"&&a.type==="radio"&&a.name!=null&&rP(l,a),Y1(h,u);var d=Y1(h,a);for(u=0;u<f.length;u+=2){var m=f[u],g=f[u+1];m==="style"?cP(l,g):m==="dangerouslySetInnerHTML"?aP(l,g):m==="children"?tm(l,g):DA(l,m,g,d)}switch(h){case"input":W1(l,a);break;case"textarea":sP(l,a);break;case"select":var x=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!a.multiple;var v=a.value;v!=null?Ld(l,!!a.multiple,v,!1):x!==!!a.multiple&&(a.defaultValue!=null?Ld(l,!!a.multiple,a.defaultValue,!0):Ld(l,!!a.multiple,a.multiple?[]:"",!1))}l[um]=a}catch(_){Lr(r,r.return,_)}}break;case 6:if(Uo(n,r),xa(r),o&4){if(r.stateNode===null)throw Error(an(162));l=r.stateNode,a=r.memoizedProps;try{l.nodeValue=a}catch(_){Lr(r,r.return,_)}}break;case 3:if(Uo(n,r),xa(r),o&4&&i!==null&&i.memoizedState.isDehydrated)try{sm(n.containerInfo)}catch(_){Lr(r,r.return,_)}break;case 4:Uo(n,r),xa(r);break;case 13:Uo(n,r),xa(r),l=r.child,l.flags&8192&&(a=l.memoizedState!==null,l.stateNode.isHidden=a,!a||l.alternate!==null&&l.alternate.memoizedState!==null||(hw=kr())),o&4&&cC(r);break;case 22:if(m=i!==null&&i.memoizedState!==null,r.mode&1?(vs=(d=vs)||m,Uo(n,r),vs=d):Uo(n,r),xa(r),o&8192){if(d=r.memoizedState!==null,(r.stateNode.isHidden=d)&&!m&&(r.mode&1)!==0)for(kn=r,m=r.child;m!==null;){for(g=kn=m;kn!==null;){switch(x=kn,v=x.child,x.tag){case 0:case 11:case 14:case 15:Vp(4,x,x.return);break;case 1:Ad(x,x.return);var A=x.stateNode;if(typeof A.componentWillUnmount=="function"){o=x,i=x.return;try{n=o,A.props=n.memoizedProps,A.state=n.memoizedState,A.componentWillUnmount()}catch(_){Lr(o,i,_)}}break;case 5:Ad(x,x.return);break;case 22:if(x.memoizedState!==null){hC(g);continue}}v!==null?(v.return=x,kn=v):hC(g)}m=m.sibling}e:for(m=null,g=r;;){if(g.tag===5){if(m===null){m=g;try{l=g.stateNode,d?(a=l.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(h=g.stateNode,f=g.memoizedProps.style,u=f!=null&&f.hasOwnProperty("display")?f.display:null,h.style.display=lP("display",u))}catch(_){Lr(r,r.return,_)}}}else if(g.tag===6){if(m===null)try{g.stateNode.nodeValue=d?"":g.memoizedProps}catch(_){Lr(r,r.return,_)}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===r)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===r)break e;for(;g.sibling===null;){if(g.return===null||g.return===r)break e;m===g&&(m=null),g=g.return}m===g&&(m=null),g.sibling.return=g.return,g=g.sibling}}break;case 19:Uo(n,r),xa(r),o&4&&cC(r);break;case 21:break;default:Uo(n,r),xa(r)}}function xa(r){var n=r.flags;if(n&2){try{e:{for(var i=r.return;i!==null;){if(kD(i)){var o=i;break e}i=i.return}throw Error(an(160))}switch(o.tag){case 5:var l=o.stateNode;o.flags&32&&(tm(l,""),o.flags&=-33);var a=lC(r);ME(r,a,l);break;case 3:case 4:var u=o.stateNode.containerInfo,h=lC(r);wE(r,h,u);break;default:throw Error(an(161))}}catch(f){Lr(r,r.return,f)}r.flags&=-3}n&4096&&(r.flags&=-4097)}function Uz(r,n,i){kn=r,BD(r)}function BD(r,n,i){for(var o=(r.mode&1)!==0;kn!==null;){var l=kn,a=l.child;if(l.tag===22&&o){var u=l.memoizedState!==null||wv;if(!u){var h=l.alternate,f=h!==null&&h.memoizedState!==null||vs;h=wv;var d=vs;if(wv=u,(vs=f)&&!d)for(kn=l;kn!==null;)u=kn,f=u.child,u.tag===22&&u.memoizedState!==null?dC(l):f!==null?(f.return=u,kn=f):dC(l);for(;a!==null;)kn=a,BD(a),a=a.sibling;kn=l,wv=h,vs=d}uC(r)}else(l.subtreeFlags&8772)!==0&&a!==null?(a.return=l,kn=a):uC(r)}}function uC(r){for(;kn!==null;){var n=kn;if((n.flags&8772)!==0){var i=n.alternate;try{if((n.flags&8772)!==0)switch(n.tag){case 0:case 11:case 15:vs||Ny(5,n);break;case 1:var o=n.stateNode;if(n.flags&4&&!vs)if(i===null)o.componentDidMount();else{var l=n.elementType===n.type?i.memoizedProps:Wo(n.type,i.memoizedProps);o.componentDidUpdate(l,i.memoizedState,o.__reactInternalSnapshotBeforeUpdate)}var a=n.updateQueue;a!==null&&X2(n,a,o);break;case 3:var u=n.updateQueue;if(u!==null){if(i=null,n.child!==null)switch(n.child.tag){case 5:i=n.child.stateNode;break;case 1:i=n.child.stateNode}X2(n,u,i)}break;case 5:var h=n.stateNode;if(i===null&&n.flags&4){i=h;var f=n.memoizedProps;switch(n.type){case"button":case"input":case"select":case"textarea":f.autoFocus&&i.focus();break;case"img":f.src&&(i.src=f.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(n.memoizedState===null){var d=n.alternate;if(d!==null){var m=d.memoizedState;if(m!==null){var g=m.dehydrated;g!==null&&sm(g)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(an(163))}vs||n.flags&512&&AE(n)}catch(x){Lr(n,n.return,x)}}if(n===r){kn=null;break}if(i=n.sibling,i!==null){i.return=n.return,kn=i;break}kn=n.return}}function hC(r){for(;kn!==null;){var n=kn;if(n===r){kn=null;break}var i=n.sibling;if(i!==null){i.return=n.return,kn=i;break}kn=n.return}}function dC(r){for(;kn!==null;){var n=kn;try{switch(n.tag){case 0:case 11:case 15:var i=n.return;try{Ny(4,n)}catch(f){Lr(n,i,f)}break;case 1:var o=n.stateNode;if(typeof o.componentDidMount=="function"){var l=n.return;try{o.componentDidMount()}catch(f){Lr(n,l,f)}}var a=n.return;try{AE(n)}catch(f){Lr(n,a,f)}break;case 5:var u=n.return;try{AE(n)}catch(f){Lr(n,u,f)}}}catch(f){Lr(n,n.return,f)}if(n===r){kn=null;break}var h=n.sibling;if(h!==null){h.return=n.return,kn=h;break}kn=n.return}}var zz=Math.ceil,ly=Cl.ReactCurrentDispatcher,cw=Cl.ReactCurrentOwner,wo=Cl.ReactCurrentBatchConfig,Xi=0,ns=null,zr=null,as=0,eo=0,wd=Dc(0),jr=0,gm=null,Bu=0,Fy=0,uw=0,Wp=null,Ns=null,hw=0,$d=1/0,sl=null,cy=!1,SE=null,bc=null,Mv=!1,pc=null,uy=0,jp=0,TE=null,T0=-1,C0=0;function Cs(){return(Xi&6)!==0?kr():T0!==-1?T0:T0=kr()}function Ec(r){return(r.mode&1)===0?1:(Xi&2)!==0&&as!==0?as&-as:Az.transition!==null?(C0===0&&(C0=bP()),C0):(r=nr,r!==0||(r=window.event,r=r===void 0?16:CP(r.type)),r)}function ea(r,n,i,o){if(50<jp)throw jp=0,TE=null,Error(an(185));Lm(r,i,o),((Xi&2)===0||r!==ns)&&(r===ns&&((Xi&2)===0&&(Fy|=i),jr===4&&dc(r,as)),Hs(r,o),i===1&&Xi===0&&(n.mode&1)===0&&($d=kr()+500,Oy&&Oc()))}function Hs(r,n){var i=r.callbackNode;A8(r,n);var o=X0(r,r===ns?as:0);if(o===0)i!==null&&b2(i),r.callbackNode=null,r.callbackPriority=0;else if(n=o&-o,r.callbackPriority!==n){if(i!=null&&b2(i),n===1)r.tag===0?Ez(fC.bind(null,r)):XP(fC.bind(null,r)),yz(function(){(Xi&6)===0&&Oc()}),i=null;else{switch(EP(o)){case 1:i=FA;break;case 4:i=xP;break;case 16:i=$0;break;case 536870912:i=_P;break;default:i=$0}i=$D(i,UD.bind(null,r))}r.callbackPriority=n,r.callbackNode=i}}function UD(r,n){if(T0=-1,C0=0,(Xi&6)!==0)throw Error(an(327));var i=r.callbackNode;if(kd()&&r.callbackNode!==i)return null;var o=X0(r,r===ns?as:0);if(o===0)return null;if((o&30)!==0||(o&r.expiredLanes)!==0||n)n=hy(r,o);else{n=o;var l=Xi;Xi|=2;var a=HD();(ns!==r||as!==n)&&(sl=null,$d=kr()+500,Ru(r,n));do try{Vz();break}catch(h){zD(r,h)}while(1);KA(),ly.current=a,Xi=l,zr!==null?n=0:(ns=null,as=0,n=jr)}if(n!==0){if(n===2&&(l=eE(r),l!==0&&(o=l,n=CE(r,l))),n===1)throw i=gm,Ru(r,0),dc(r,o),Hs(r,kr()),i;if(n===6)dc(r,o);else{if(l=r.current.alternate,(o&30)===0&&!Hz(l)&&(n=hy(r,o),n===2&&(a=eE(r),a!==0&&(o=a,n=CE(r,a))),n===1))throw i=gm,Ru(r,0),dc(r,o),Hs(r,kr()),i;switch(r.finishedWork=l,r.finishedLanes=o,n){case 0:case 1:throw Error(an(345));case 2:pu(r,Ns,sl);break;case 3:if(dc(r,o),(o&130023424)===o&&(n=hw+500-kr(),10<n)){if(X0(r,0)!==0)break;if(l=r.suspendedLanes,(l&o)!==o){Cs(),r.pingedLanes|=r.suspendedLanes&l;break}r.timeoutHandle=lE(pu.bind(null,r,Ns,sl),n);break}pu(r,Ns,sl);break;case 4:if(dc(r,o),(o&4194240)===o)break;for(n=r.eventTimes,l=-1;0<o;){var u=31-Jo(o);a=1<<u,u=n[u],u>l&&(l=u),o&=~a}if(o=l,o=kr()-o,o=(120>o?120:480>o?480:1080>o?1080:1920>o?1920:3e3>o?3e3:4320>o?4320:1960*zz(o/1960))-o,10<o){r.timeoutHandle=lE(pu.bind(null,r,Ns,sl),o);break}pu(r,Ns,sl);break;case 5:pu(r,Ns,sl);break;default:throw Error(an(329))}}}return Hs(r,kr()),r.callbackNode===i?UD.bind(null,r):null}function CE(r,n){var i=Wp;return r.current.memoizedState.isDehydrated&&(Ru(r,n).flags|=256),r=hy(r,n),r!==2&&(n=Ns,Ns=i,n!==null&&RE(n)),r}function RE(r){Ns===null?Ns=r:Ns.push.apply(Ns,r)}function Hz(r){for(var n=r;;){if(n.flags&16384){var i=n.updateQueue;if(i!==null&&(i=i.stores,i!==null))for(var o=0;o<i.length;o++){var l=i[o],a=l.getSnapshot;l=l.value;try{if(!na(a(),l))return!1}catch{return!1}}}if(i=n.child,n.subtreeFlags&16384&&i!==null)i.return=n,n=i;else{if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return!0;n=n.return}n.sibling.return=n.return,n=n.sibling}}return!0}function dc(r,n){for(n&=~uw,n&=~Fy,r.suspendedLanes|=n,r.pingedLanes&=~n,r=r.expirationTimes;0<n;){var i=31-Jo(n),o=1<<i;r[i]=-1,n&=~o}}function fC(r){if((Xi&6)!==0)throw Error(an(327));kd();var n=X0(r,0);if((n&1)===0)return Hs(r,kr()),null;var i=hy(r,n);if(r.tag!==0&&i===2){var o=eE(r);o!==0&&(n=o,i=CE(r,o))}if(i===1)throw i=gm,Ru(r,0),dc(r,n),Hs(r,kr()),i;if(i===6)throw Error(an(345));return r.finishedWork=r.current.alternate,r.finishedLanes=n,pu(r,Ns,sl),Hs(r,kr()),null}function dw(r,n){var i=Xi;Xi|=1;try{return r(n)}finally{Xi=i,Xi===0&&($d=kr()+500,Oy&&Oc())}}function Uu(r){pc!==null&&pc.tag===0&&(Xi&6)===0&&kd();var n=Xi;Xi|=1;var i=wo.transition,o=nr;try{if(wo.transition=null,nr=1,r)return r()}finally{nr=o,wo.transition=i,Xi=n,(Xi&6)===0&&Oc()}}function fw(){eo=wd.current,mr(wd)}function Ru(r,n){r.finishedWork=null,r.finishedLanes=0;var i=r.timeoutHandle;if(i!==-1&&(r.timeoutHandle=-1,vz(i)),zr!==null)for(i=zr.return;i!==null;){var o=i;switch(XA(o),o.tag){case 1:o=o.type.childContextTypes,o!=null&&Z0();break;case 3:Wd(),mr(Us),mr(xs),nw();break;case 5:tw(o);break;case 4:Wd();break;case 13:mr(_r);break;case 19:mr(_r);break;case 10:QA(o.type._context);break;case 22:case 23:fw()}i=i.return}if(ns=r,zr=r=Ac(r.current,null),as=eo=n,jr=0,gm=null,uw=Fy=Bu=0,Ns=Wp=null,bu!==null){for(n=0;n<bu.length;n++)if(i=bu[n],o=i.interleaved,o!==null){i.interleaved=null;var l=o.next,a=i.pending;if(a!==null){var u=a.next;a.next=l,o.next=u}i.pending=o}bu=null}return r}function zD(r,n){do{var i=zr;try{if(KA(),w0.current=ay,oy){for(var o=br.memoizedState;o!==null;){var l=o.queue;l!==null&&(l.pending=null),o=o.next}oy=!1}if(Fu=0,es=Wr=br=null,Gp=!1,fm=0,cw.current=null,i===null||i.return===null){jr=1,gm=n,zr=null;break}e:{var a=r,u=i.return,h=i,f=n;if(n=as,h.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){var d=f,m=h,g=m.tag;if((m.mode&1)===0&&(g===0||g===11||g===15)){var x=m.alternate;x?(m.updateQueue=x.updateQueue,m.memoizedState=x.memoizedState,m.lanes=x.lanes):(m.updateQueue=null,m.memoizedState=null)}var v=eC(u);if(v!==null){v.flags&=-257,tC(v,u,h,a,n),v.mode&1&&J2(a,d,n),n=v,f=d;var A=n.updateQueue;if(A===null){var _=new Set;_.add(f),n.updateQueue=_}else A.add(f);break e}else{if((n&1)===0){J2(a,d,n),pw();break e}f=Error(an(426))}}else if(gr&&h.mode&1){var E=eC(u);if(E!==null){(E.flags&65536)===0&&(E.flags|=256),tC(E,u,h,a,n),qA(jd(f,h));break e}}a=f=jd(f,h),jr!==4&&(jr=2),Wp===null?Wp=[a]:Wp.push(a),a=u;do{switch(a.tag){case 3:a.flags|=65536,n&=-n,a.lanes|=n;var w=AD(a,f,n);$2(a,w);break e;case 1:h=f;var S=a.type,T=a.stateNode;if((a.flags&128)===0&&(typeof S.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(bc===null||!bc.has(T)))){a.flags|=65536,n&=-n,a.lanes|=n;var R=wD(a,h,n);$2(a,R);break e}}a=a.return}while(a!==null)}VD(i)}catch(L){n=L,zr===i&&i!==null&&(zr=i=i.return);continue}break}while(1)}function HD(){var r=ly.current;return ly.current=ay,r===null?ay:r}function pw(){(jr===0||jr===3||jr===2)&&(jr=4),ns===null||(Bu&268435455)===0&&(Fy&268435455)===0||dc(ns,as)}function hy(r,n){var i=Xi;Xi|=2;var o=HD();(ns!==r||as!==n)&&(sl=null,Ru(r,n));do try{Gz();break}catch(l){zD(r,l)}while(1);if(KA(),Xi=i,ly.current=o,zr!==null)throw Error(an(261));return ns=null,as=0,jr}function Gz(){for(;zr!==null;)GD(zr)}function Vz(){for(;zr!==null&&!p8();)GD(zr)}function GD(r){var n=jD(r.alternate,r,eo);r.memoizedProps=r.pendingProps,n===null?VD(r):zr=n,cw.current=null}function VD(r){var n=r;do{var i=n.alternate;if(r=n.return,(n.flags&32768)===0){if(i=kz(i,n,eo),i!==null){zr=i;return}}else{if(i=Nz(i,n),i!==null){i.flags&=32767,zr=i;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{jr=6,zr=null;return}}if(n=n.sibling,n!==null){zr=n;return}zr=n=r}while(n!==null);jr===0&&(jr=5)}function pu(r,n,i){var o=nr,l=wo.transition;try{wo.transition=null,nr=1,Wz(r,n,i,o)}finally{wo.transition=l,nr=o}return null}function Wz(r,n,i,o){do kd();while(pc!==null);if((Xi&6)!==0)throw Error(an(327));i=r.finishedWork;var l=r.finishedLanes;if(i===null)return null;if(r.finishedWork=null,r.finishedLanes=0,i===r.current)throw Error(an(177));r.callbackNode=null,r.callbackPriority=0;var a=i.lanes|i.childLanes;if(w8(r,a),r===ns&&(zr=ns=null,as=0),(i.subtreeFlags&2064)===0&&(i.flags&2064)===0||Mv||(Mv=!0,$D($0,function(){return kd(),null})),a=(i.flags&15990)!==0,(i.subtreeFlags&15990)!==0||a){a=wo.transition,wo.transition=null;var u=nr;nr=1;var h=Xi;Xi|=4,cw.current=null,Bz(r,i),FD(i,r),uz(oE),q0=!!sE,oE=sE=null,r.current=i,Uz(i),m8(),Xi=h,nr=u,wo.transition=a}else r.current=i;if(Mv&&(Mv=!1,pc=r,uy=l),a=r.pendingLanes,a===0&&(bc=null),y8(i.stateNode),Hs(r,kr()),n!==null)for(o=r.onRecoverableError,i=0;i<n.length;i++)l=n[i],o(l.value,{componentStack:l.stack,digest:l.digest});if(cy)throw cy=!1,r=SE,SE=null,r;return(uy&1)!==0&&r.tag!==0&&kd(),a=r.pendingLanes,(a&1)!==0?r===TE?jp++:(jp=0,TE=r):jp=0,Oc(),null}function kd(){if(pc!==null){var r=EP(uy),n=wo.transition,i=nr;try{if(wo.transition=null,nr=16>r?16:r,pc===null)var o=!1;else{if(r=pc,pc=null,uy=0,(Xi&6)!==0)throw Error(an(331));var l=Xi;for(Xi|=4,kn=r.current;kn!==null;){var a=kn,u=a.child;if((kn.flags&16)!==0){var h=a.deletions;if(h!==null){for(var f=0;f<h.length;f++){var d=h[f];for(kn=d;kn!==null;){var m=kn;switch(m.tag){case 0:case 11:case 15:Vp(8,m,a)}var g=m.child;if(g!==null)g.return=m,kn=g;else for(;kn!==null;){m=kn;var x=m.sibling,v=m.return;if(ID(m),m===d){kn=null;break}if(x!==null){x.return=v,kn=x;break}kn=v}}}var A=a.alternate;if(A!==null){var _=A.child;if(_!==null){A.child=null;do{var E=_.sibling;_.sibling=null,_=E}while(_!==null)}}kn=a}}if((a.subtreeFlags&2064)!==0&&u!==null)u.return=a,kn=u;else e:for(;kn!==null;){if(a=kn,(a.flags&2048)!==0)switch(a.tag){case 0:case 11:case 15:Vp(9,a,a.return)}var w=a.sibling;if(w!==null){w.return=a.return,kn=w;break e}kn=a.return}}var S=r.current;for(kn=S;kn!==null;){u=kn;var T=u.child;if((u.subtreeFlags&2064)!==0&&T!==null)T.return=u,kn=T;else e:for(u=S;kn!==null;){if(h=kn,(h.flags&2048)!==0)try{switch(h.tag){case 0:case 11:case 15:Ny(9,h)}}catch(L){Lr(h,h.return,L)}if(h===u){kn=null;break e}var R=h.sibling;if(R!==null){R.return=h.return,kn=R;break e}kn=h.return}}if(Xi=l,Oc(),Sa&&typeof Sa.onPostCommitFiberRoot=="function")try{Sa.onPostCommitFiberRoot(Cy,r)}catch{}o=!0}return o}finally{nr=i,wo.transition=n}}return!1}function pC(r,n,i){n=jd(i,n),n=AD(r,n,1),r=_c(r,n,1),n=Cs(),r!==null&&(Lm(r,1,n),Hs(r,n))}function Lr(r,n,i){if(r.tag===3)pC(r,r,i);else for(;n!==null;){if(n.tag===3){pC(n,r,i);break}else if(n.tag===1){var o=n.stateNode;if(typeof n.type.getDerivedStateFromError=="function"||typeof o.componentDidCatch=="function"&&(bc===null||!bc.has(o))){r=jd(i,r),r=wD(n,r,1),n=_c(n,r,1),r=Cs(),n!==null&&(Lm(n,1,r),Hs(n,r));break}}n=n.return}}function jz(r,n,i){var o=r.pingCache;o!==null&&o.delete(n),n=Cs(),r.pingedLanes|=r.suspendedLanes&i,ns===r&&(as&i)===i&&(jr===4||jr===3&&(as&130023424)===as&&500>kr()-hw?Ru(r,0):uw|=i),Hs(r,n)}function WD(r,n){n===0&&((r.mode&1)===0?n=1:(n=mv,mv<<=1,(mv&130023424)===0&&(mv=4194304)));var i=Cs();r=Al(r,n),r!==null&&(Lm(r,n,i),Hs(r,i))}function $z(r){var n=r.memoizedState,i=0;n!==null&&(i=n.retryLane),WD(r,i)}function Xz(r,n){var i=0;switch(r.tag){case 13:var o=r.stateNode,l=r.memoizedState;l!==null&&(i=l.retryLane);break;case 19:o=r.stateNode;break;default:throw Error(an(314))}o!==null&&o.delete(n),WD(r,i)}var jD;jD=function(r,n,i){if(r!==null)if(r.memoizedProps!==n.pendingProps||Us.current)Fs=!0;else{if((r.lanes&i)===0&&(n.flags&128)===0)return Fs=!1,Iz(r,n,i);Fs=(r.flags&131072)!==0}else Fs=!1,gr&&(n.flags&1048576)!==0&&qP(n,ty,n.index);switch(n.lanes=0,n.tag){case 2:var o=n.type;S0(r,n),r=n.pendingProps;var l=Hd(n,xs.current);Id(n,i),l=rw(null,n,o,r,l,i);var a=sw();return n.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(n.tag=1,n.memoizedState=null,n.updateQueue=null,zs(o)?(a=!0,J0(n)):a=!1,n.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,JA(n),l.updater=Iy,n.stateNode=l,l._reactInternals=n,mE(n,o,r,i),n=yE(null,n,o,!0,a,i)):(n.tag=0,gr&&a&&$A(n),Ms(null,n,l,i),n=n.child),n;case 16:o=n.elementType;e:{switch(S0(r,n),r=n.pendingProps,l=o._init,o=l(o._payload),n.type=o,l=n.tag=Yz(o),r=Wo(o,r),l){case 0:n=vE(null,n,o,r,i);break e;case 1:n=rC(null,n,o,r,i);break e;case 11:n=nC(null,n,o,r,i);break e;case 14:n=iC(null,n,o,Wo(o.type,r),i);break e}throw Error(an(306,o,""))}return n;case 0:return o=n.type,l=n.pendingProps,l=n.elementType===o?l:Wo(o,l),vE(r,n,o,l,i);case 1:return o=n.type,l=n.pendingProps,l=n.elementType===o?l:Wo(o,l),rC(r,n,o,l,i);case 3:e:{if(CD(n),r===null)throw Error(an(387));o=n.pendingProps,a=n.memoizedState,l=a.element,ZP(r,n),ry(n,o,null,i);var u=n.memoizedState;if(o=u.element,a.isDehydrated)if(a={element:o,isDehydrated:!1,cache:u.cache,pendingSuspenseBoundaries:u.pendingSuspenseBoundaries,transitions:u.transitions},n.updateQueue.baseState=a,n.memoizedState=a,n.flags&256){l=jd(Error(an(423)),n),n=sC(r,n,o,i,l);break e}else if(o!==l){l=jd(Error(an(424)),n),n=sC(r,n,o,i,l);break e}else for(to=xc(n.stateNode.containerInfo.firstChild),io=n,gr=!0,Xo=null,i=nD(n,null,o,i),n.child=i;i;)i.flags=i.flags&-3|4096,i=i.sibling;else{if(Gd(),o===l){n=wl(r,n,i);break e}Ms(r,n,o,i)}n=n.child}return n;case 5:return iD(n),r===null&&dE(n),o=n.type,l=n.pendingProps,a=r!==null?r.memoizedProps:null,u=l.children,aE(o,l)?u=null:a!==null&&aE(o,a)&&(n.flags|=32),TD(r,n),Ms(r,n,u,i),n.child;case 6:return r===null&&dE(n),null;case 13:return RD(r,n,i);case 4:return ew(n,n.stateNode.containerInfo),o=n.pendingProps,r===null?n.child=Vd(n,null,o,i):Ms(r,n,o,i),n.child;case 11:return o=n.type,l=n.pendingProps,l=n.elementType===o?l:Wo(o,l),nC(r,n,o,l,i);case 7:return Ms(r,n,n.pendingProps,i),n.child;case 8:return Ms(r,n,n.pendingProps.children,i),n.child;case 12:return Ms(r,n,n.pendingProps.children,i),n.child;case 10:e:{if(o=n.type._context,l=n.pendingProps,a=n.memoizedProps,u=l.value,ur(ny,o._currentValue),o._currentValue=u,a!==null)if(na(a.value,u)){if(a.children===l.children&&!Us.current){n=wl(r,n,i);break e}}else for(a=n.child,a!==null&&(a.return=n);a!==null;){var h=a.dependencies;if(h!==null){u=a.child;for(var f=h.firstContext;f!==null;){if(f.context===o){if(a.tag===1){f=ml(-1,i&-i),f.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var m=d.pending;m===null?f.next=f:(f.next=m.next,m.next=f),d.pending=f}}a.lanes|=i,f=a.alternate,f!==null&&(f.lanes|=i),fE(a.return,i,n),h.lanes|=i;break}f=f.next}}else if(a.tag===10)u=a.type===n.type?null:a.child;else if(a.tag===18){if(u=a.return,u===null)throw Error(an(341));u.lanes|=i,h=u.alternate,h!==null&&(h.lanes|=i),fE(u,i,n),u=a.sibling}else u=a.child;if(u!==null)u.return=a;else for(u=a;u!==null;){if(u===n){u=null;break}if(a=u.sibling,a!==null){a.return=u.return,u=a;break}u=u.return}a=u}Ms(r,n,l.children,i),n=n.child}return n;case 9:return l=n.type,o=n.pendingProps.children,Id(n,i),l=So(l),o=o(l),n.flags|=1,Ms(r,n,o,i),n.child;case 14:return o=n.type,l=Wo(o,n.pendingProps),l=Wo(o.type,l),iC(r,n,o,l,i);case 15:return MD(r,n,n.type,n.pendingProps,i);case 17:return o=n.type,l=n.pendingProps,l=n.elementType===o?l:Wo(o,l),S0(r,n),n.tag=1,zs(o)?(r=!0,J0(n)):r=!1,Id(n,i),eD(n,o,l),mE(n,o,l,i),yE(null,n,o,!0,r,i);case 19:return LD(r,n,i);case 22:return SD(r,n,i)}throw Error(an(156,n.tag))};function $D(r,n){return yP(r,n)}function qz(r,n,i,o){this.tag=r,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=n,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=o,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ao(r,n,i,o){return new qz(r,n,i,o)}function mw(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Yz(r){if(typeof r=="function")return mw(r)?1:0;if(r!=null){if(r=r.$$typeof,r===IA)return 11;if(r===kA)return 14}return 2}function Ac(r,n){var i=r.alternate;return i===null?(i=Ao(r.tag,n,r.key,r.mode),i.elementType=r.elementType,i.type=r.type,i.stateNode=r.stateNode,i.alternate=r,r.alternate=i):(i.pendingProps=n,i.type=r.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=r.flags&14680064,i.childLanes=r.childLanes,i.lanes=r.lanes,i.child=r.child,i.memoizedProps=r.memoizedProps,i.memoizedState=r.memoizedState,i.updateQueue=r.updateQueue,n=r.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext},i.sibling=r.sibling,i.index=r.index,i.ref=r.ref,i}function R0(r,n,i,o,l,a){var u=2;if(o=r,typeof r=="function")mw(r)&&(u=1);else if(typeof r=="string")u=5;else e:switch(r){case pd:return Lu(i.children,l,a,n);case OA:u=8,l|=8;break;case U1:return r=Ao(12,i,n,l|2),r.elementType=U1,r.lanes=a,r;case z1:return r=Ao(13,i,n,l),r.elementType=z1,r.lanes=a,r;case H1:return r=Ao(19,i,n,l),r.elementType=H1,r.lanes=a,r;case tP:return By(i,l,a,n);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case JL:u=10;break e;case eP:u=9;break e;case IA:u=11;break e;case kA:u=14;break e;case ac:u=16,o=null;break e}throw Error(an(130,r==null?r:typeof r,""))}return n=Ao(u,i,n,l),n.elementType=r,n.type=o,n.lanes=a,n}function Lu(r,n,i,o){return r=Ao(7,r,o,n),r.lanes=i,r}function By(r,n,i,o){return r=Ao(22,r,o,n),r.elementType=tP,r.lanes=i,r.stateNode={isHidden:!1},r}function hb(r,n,i){return r=Ao(6,r,null,n),r.lanes=i,r}function db(r,n,i){return n=Ao(4,r.children!==null?r.children:[],r.key,n),n.lanes=i,n.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},n}function Kz(r,n,i,o,l){this.tag=n,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$_(0),this.expirationTimes=$_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$_(0),this.identifierPrefix=o,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function gw(r,n,i,o,l,a,u,h,f){return r=new Kz(r,n,i,h,f),n===1?(n=1,a===!0&&(n|=8)):n=0,a=Ao(3,null,null,n),r.current=a,a.stateNode=r,a.memoizedState={element:o,isDehydrated:i,cache:null,transitions:null,pendingSuspenseBoundaries:null},JA(a),r}function Qz(r,n,i){var o=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fd,key:o==null?null:""+o,children:r,containerInfo:n,implementation:i}}function XD(r){if(!r)return Sc;r=r._reactInternals;e:{if(Xu(r)!==r||r.tag!==1)throw Error(an(170));var n=r;do{switch(n.tag){case 3:n=n.stateNode.context;break e;case 1:if(zs(n.type)){n=n.stateNode.__reactInternalMemoizedMergedChildContext;break e}}n=n.return}while(n!==null);throw Error(an(171))}if(r.tag===1){var i=r.type;if(zs(i))return $P(r,i,n)}return n}function qD(r,n,i,o,l,a,u,h,f){return r=gw(i,o,!0,r,l,a,u,h,f),r.context=XD(null),i=r.current,o=Cs(),l=Ec(i),a=ml(o,l),a.callback=n!=null?n:null,_c(i,a,l),r.current.lanes=l,Lm(r,l,o),Hs(r,o),r}function Uy(r,n,i,o){var l=n.current,a=Cs(),u=Ec(l);return i=XD(i),n.context===null?n.context=i:n.pendingContext=i,n=ml(a,u),n.payload={element:r},o=o===void 0?null:o,o!==null&&(n.callback=o),r=_c(l,n,u),r!==null&&(ea(r,l,u,a),A0(r,l,u)),u}function dy(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function mC(r,n){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var i=r.retryLane;r.retryLane=i!==0&&i<n?i:n}}function vw(r,n){mC(r,n),(r=r.alternate)&&mC(r,n)}function Zz(){return null}var YD=typeof reportError=="function"?reportError:function(r){console.error(r)};function yw(r){this._internalRoot=r}zy.prototype.render=yw.prototype.render=function(r){var n=this._internalRoot;if(n===null)throw Error(an(409));Uy(r,n,null,null)};zy.prototype.unmount=yw.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var n=r.containerInfo;Uu(function(){Uy(null,r,null,null)}),n[El]=null}};function zy(r){this._internalRoot=r}zy.prototype.unstable_scheduleHydration=function(r){if(r){var n=MP();r={blockedOn:null,target:r,priority:n};for(var i=0;i<hc.length&&n!==0&&n<hc[i].priority;i++);hc.splice(i,0,r),i===0&&TP(r)}};function xw(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Hy(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function gC(){}function Jz(r,n,i,o,l){if(l){if(typeof o=="function"){var a=o;o=function(){var d=dy(u);a.call(d)}}var u=qD(n,o,r,0,null,!1,!1,"",gC);return r._reactRootContainer=u,r[El]=u.current,lm(r.nodeType===8?r.parentNode:r),Uu(),u}for(;l=r.lastChild;)r.removeChild(l);if(typeof o=="function"){var h=o;o=function(){var d=dy(f);h.call(d)}}var f=gw(r,0,!1,null,null,!1,!1,"",gC);return r._reactRootContainer=f,r[El]=f.current,lm(r.nodeType===8?r.parentNode:r),Uu(function(){Uy(n,f,i,o)}),f}function Gy(r,n,i,o,l){var a=i._reactRootContainer;if(a){var u=a;if(typeof l=="function"){var h=l;l=function(){var f=dy(u);h.call(f)}}Uy(n,u,r,l)}else u=Jz(i,n,r,l,o);return dy(u)}AP=function(r){switch(r.tag){case 3:var n=r.stateNode;if(n.current.memoizedState.isDehydrated){var i=Rp(n.pendingLanes);i!==0&&(BA(n,i|1),Hs(n,kr()),(Xi&6)===0&&($d=kr()+500,Oc()))}break;case 13:Uu(function(){var o=Al(r,1);if(o!==null){var l=Cs();ea(o,r,1,l)}}),vw(r,1)}};UA=function(r){if(r.tag===13){var n=Al(r,134217728);if(n!==null){var i=Cs();ea(n,r,134217728,i)}vw(r,134217728)}};wP=function(r){if(r.tag===13){var n=Ec(r),i=Al(r,n);if(i!==null){var o=Cs();ea(i,r,n,o)}vw(r,n)}};MP=function(){return nr};SP=function(r,n){var i=nr;try{return nr=r,n()}finally{nr=i}};Q1=function(r,n,i){switch(n){case"input":if(W1(r,i),n=i.name,i.type==="radio"&&n!=null){for(i=r;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+n)+'][type="radio"]'),n=0;n<i.length;n++){var o=i[n];if(o!==r&&o.form===r.form){var l=Dy(o);if(!l)throw Error(an(90));iP(o),W1(o,l)}}}break;case"textarea":sP(r,i);break;case"select":n=i.value,n!=null&&Ld(r,!!i.multiple,n,!1)}};dP=dw;fP=Uu;var eH={usingClientEntryPoint:!1,Events:[Dm,yd,Dy,uP,hP,dw]},ip={findFiberByHostInstance:_u,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},tH={bundleType:ip.bundleType,version:ip.version,rendererPackageName:ip.rendererPackageName,rendererConfig:ip.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Cl.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=gP(r),r===null?null:r.stateNode},findFiberByHostInstance:ip.findFiberByHostInstance||Zz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sv.isDisabled&&Sv.supportsFiber)try{Cy=Sv.inject(tH),Sa=Sv}catch{}}co.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eH;co.createPortal=function(r,n){var i=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xw(n))throw Error(an(200));return Qz(r,n,null,i)};co.createRoot=function(r,n){if(!xw(r))throw Error(an(299));var i=!1,o="",l=YD;return n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),n=gw(r,1,!1,null,null,i,!1,o,l),r[El]=n.current,lm(r.nodeType===8?r.parentNode:r),new yw(n)};co.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var n=r._reactInternals;if(n===void 0)throw typeof r.render=="function"?Error(an(188)):(r=Object.keys(r).join(","),Error(an(268,r)));return r=gP(n),r=r===null?null:r.stateNode,r};co.flushSync=function(r){return Uu(r)};co.hydrate=function(r,n,i){if(!Hy(n))throw Error(an(200));return Gy(null,r,n,!0,i)};co.hydrateRoot=function(r,n,i){if(!xw(r))throw Error(an(405));var o=i!=null&&i.hydratedSources||null,l=!1,a="",u=YD;if(i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(a=i.identifierPrefix),i.onRecoverableError!==void 0&&(u=i.onRecoverableError)),n=qD(n,null,r,1,i!=null?i:null,l,!1,a,u),r[El]=n.current,lm(r),o)for(r=0;r<o.length;r++)i=o[r],l=i._getVersion,l=l(i._source),n.mutableSourceEagerHydrationData==null?n.mutableSourceEagerHydrationData=[i,l]:n.mutableSourceEagerHydrationData.push(i,l);return new zy(n)};co.render=function(r,n,i){if(!Hy(n))throw Error(an(200));return Gy(null,r,n,!1,i)};co.unmountComponentAtNode=function(r){if(!Hy(r))throw Error(an(40));return r._reactRootContainer?(Uu(function(){Gy(null,null,r,!1,function(){r._reactRootContainer=null,r[El]=null})}),!0):!1};co.unstable_batchedUpdates=dw;co.unstable_renderSubtreeIntoContainer=function(r,n,i,o){if(!Hy(i))throw Error(an(200));if(r==null||r._reactInternals===void 0)throw Error(an(38));return Gy(r,n,i,!1,o)};co.version="18.2.0-next-9e3b772b8-20220608";(function(r){function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(i){console.error(i)}}n(),r.exports=co})(qL);var vC=qL.exports;F1.createRoot=vC.createRoot,F1.hydrateRoot=vC.hydrateRoot;const nH=async r=>{const n=Date.now(),i=await fetch(`/data/${r}.json`),{nodes:o,links:l}=await i.json(),a=Date.now()-n;return console.log(`\u2705 Loaded ${o.length} nodes and ${l.length} edges in ${a}ms`),{nodes:o,links:l}};function iH(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function yC(r,n){return oH(r)||lH(r,n)||KD(r,n)||uH()}function rH(r){return sH(r)||aH(r)||KD(r)||cH()}function sH(r){if(Array.isArray(r))return LE(r)}function oH(r){if(Array.isArray(r))return r}function aH(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function lH(r,n){var i=r&&(typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"]);if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function KD(r,n){if(!!r){if(typeof r=="string")return LE(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return LE(r,n)}}function LE(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function cH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hH=function(n,i){var o=new Set(i);return Object.assign.apply(Object,[{}].concat(rH(Object.entries(n).filter(function(l){var a=yC(l,1),u=a[0];return!o.has(u)}).map(function(l){var a=yC(l,2),u=a[0],h=a[1];return iH({},u,h)}))))};/*! fromentries. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */var xC=function(n){return[...n].reduce((i,[o,l])=>(i[o]=l,i),{})};function PE(r){return PE=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},PE(r)}function dH(r,n){return pH(r)||gH(r,n)||QD(r,n)||yH()}function _C(r){return fH(r)||mH(r)||QD(r)||vH()}function fH(r){if(Array.isArray(r))return DE(r)}function pH(r){if(Array.isArray(r))return r}function mH(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function gH(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function QD(r,n){if(!!r){if(typeof r=="string")return DE(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return DE(r,n)}}function DE(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function vH(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yH(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vy(r,n){var i=PE(n)==="object"?n:{wrapperElementType:n,methodNames:(arguments.length<=2?void 0:arguments[2])||void 0,initPropNames:(arguments.length<=3?void 0:arguments[3])||void 0},o=i.wrapperElementType,l=o===void 0?"div":o,a=i.nodeMapper,u=a===void 0?function(g){return g}:a,h=i.methodNames,f=h===void 0?[]:h,d=i.initPropNames,m=d===void 0?[]:d;return ar.exports.forwardRef(function(g,x){var v=ar.exports.useRef(),A=ar.exports.useState({}),_=dH(A,2),E=_[0],w=_[1];ar.exports.useEffect(function(){return w(g)});var S=ar.exports.useMemo(function(){var L=xC(m.filter(function(I){return g.hasOwnProperty(I)}).map(function(I){return[I,g[I]]}));return r(L)},[]);ar.exports.useLayoutEffect(function(){S(u(v.current))},[]),xH(function(){return S._destructor instanceof Function?S._destructor:void 0},[]);var T=ar.exports.useCallback(function(L){for(var I=arguments.length,N=new Array(I>1?I-1:0),B=1;B<I;B++)N[B-1]=arguments[B];return S[L]instanceof Function?S[L].apply(S,N):void 0},[S]),R=hH(g,[].concat(_C(f),_C(m)));return Object.keys(R).filter(function(L){return E[L]!==g[L]}).forEach(function(L){return T(L,g[L])}),ar.exports.useImperativeHandle(x,function(){return xC(f.map(function(L){return[L,function(){for(var I=arguments.length,N=new Array(I),B=0;B<I;B++)N[B]=arguments[B];return T.apply(void 0,[L].concat(N))}]}))}),XL.createElement(l,{ref:v})})}function xH(r,n){var i=ar.exports.useRef();ar.exports.useEffect(function(){clearTimeout(i.current);var o=r();if(o)return function(){return i.current=setTimeout(o)}},n)}function Tv(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var _H={exports:{}};(function(r,n){(function(i){r.exports=i()})(function(){return function(){function i(o,l,a){function u(d,m){if(!l[d]){if(!o[d]){var g=typeof Tv=="function"&&Tv;if(!m&&g)return g(d,!0);if(h)return h(d,!0);var x=new Error("Cannot find module '"+d+"'");throw x.code="MODULE_NOT_FOUND",x}var v=l[d]={exports:{}};o[d][0].call(v.exports,function(A){var _=o[d][1][A];return u(_||A)},v,v.exports,i,o,l,a)}return l[d].exports}for(var h=typeof Tv=="function"&&Tv,f=0;f<a.length;f++)u(a[f]);return u}return i}()({1:[function(i,o,l){var a=Object.prototype.toString;o.exports=u;function u(h){return h.BYTES_PER_ELEMENT&&a.call(h.buffer)==="[object ArrayBuffer]"||Array.isArray(h)}},{}],2:[function(i,o,l){o.exports=function(u,h){return typeof u=="number"?u:typeof h=="number"?h:0}},{}],3:[function(i,o,l){l.byteLength=x,l.toByteArray=A,l.fromByteArray=w;for(var a=[],u=[],h=typeof Uint8Array<"u"?Uint8Array:Array,f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,m=f.length;d<m;++d)a[d]=f[d],u[f.charCodeAt(d)]=d;u["-".charCodeAt(0)]=62,u["_".charCodeAt(0)]=63;function g(S){var T=S.length;if(T%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var R=S.indexOf("=");R===-1&&(R=T);var L=R===T?0:4-R%4;return[R,L]}function x(S){var T=g(S),R=T[0],L=T[1];return(R+L)*3/4-L}function v(S,T,R){return(T+R)*3/4-R}function A(S){for(var T,R=g(S),L=R[0],I=R[1],N=new h(v(S,L,I)),B=0,H=I>0?L-4:L,q=0;q<H;q+=4)T=u[S.charCodeAt(q)]<<18|u[S.charCodeAt(q+1)]<<12|u[S.charCodeAt(q+2)]<<6|u[S.charCodeAt(q+3)],N[B++]=T>>16&255,N[B++]=T>>8&255,N[B++]=T&255;return I===2&&(T=u[S.charCodeAt(q)]<<2|u[S.charCodeAt(q+1)]>>4,N[B++]=T&255),I===1&&(T=u[S.charCodeAt(q)]<<10|u[S.charCodeAt(q+1)]<<4|u[S.charCodeAt(q+2)]>>2,N[B++]=T>>8&255,N[B++]=T&255),N}function _(S){return a[S>>18&63]+a[S>>12&63]+a[S>>6&63]+a[S&63]}function E(S,T,R){for(var L,I=[],N=T;N<R;N+=3)L=(S[N]<<16&16711680)+(S[N+1]<<8&65280)+(S[N+2]&255),I.push(_(L));return I.join("")}function w(S){for(var T,R=S.length,L=R%3,I=[],N=16383,B=0,H=R-L;B<H;B+=N)I.push(E(S,B,B+N>H?H:B+N));return L===1?(T=S[R-1],I.push(a[T>>2]+a[T<<4&63]+"==")):L===2&&(T=(S[R-2]<<8)+S[R-1],I.push(a[T>>10]+a[T>>4&63]+a[T<<2&63]+"=")),I.join("")}},{}],4:[function(i,o,l){o.exports={createLink:function(a,u){var h=document.head||document.getElementsByTagName("head")[0],f=document.createElement("link");f.href=a,f.rel="stylesheet";for(var d in u)if(!!u.hasOwnProperty(d)){var m=u[d];f.setAttribute("data-"+d,m)}h.appendChild(f)},createStyle:function(a,u){var h=document.head||document.getElementsByTagName("head")[0],f=document.createElement("style");f.type="text/css";for(var d in u)if(!!u.hasOwnProperty(d)){var m=u[d];f.setAttribute("data-"+d,m)}f.sheet?(f.innerHTML=a,f.sheet.cssText=a,h.appendChild(f)):f.styleSheet?(h.appendChild(f),f.styleSheet.cssText=a):(f.appendChild(document.createTextNode(a)),h.appendChild(f))}}},{}],5:[function(i,o,l){var a=i("buffer").Buffer;o.exports=function(u,h){if(!!a.isBuffer(u)&&!!a.isBuffer(h)){if(typeof u.equals=="function")return u.equals(h);if(u.length!==h.length)return!1;for(var f=0;f<u.length;f++)if(u[f]!==h[f])return!1;return!0}}},{buffer:6}],6:[function(i,o,l){(function(a,v){var h=i("base64-js"),f=i("ieee754"),d=i("isarray");l.Buffer=v,l.SlowBuffer=N,l.INSPECT_MAX_BYTES=50,v.TYPED_ARRAY_SUPPORT=a.TYPED_ARRAY_SUPPORT!==void 0?a.TYPED_ARRAY_SUPPORT:m(),l.kMaxLength=g();function m(){try{var J=new Uint8Array(1);return J.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},J.foo()===42&&typeof J.subarray=="function"&&J.subarray(1,1).byteLength===0}catch{return!1}}function g(){return v.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function x(J,G){if(g()<G)throw new RangeError("Invalid typed array length");return v.TYPED_ARRAY_SUPPORT?(J=new Uint8Array(G),J.__proto__=v.prototype):(J===null&&(J=new v(G)),J.length=G),J}function v(J,G,$){if(!v.TYPED_ARRAY_SUPPORT&&!(this instanceof v))return new v(J,G,$);if(typeof J=="number"){if(typeof G=="string")throw new Error("If encoding is specified then the first argument must be a string");return w(this,J)}return A(this,J,G,$)}v.poolSize=8192,v._augment=function(J){return J.__proto__=v.prototype,J};function A(J,G,$,me){if(typeof G=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer<"u"&&G instanceof ArrayBuffer?R(J,G,$,me):typeof G=="string"?S(J,G,$):L(J,G)}v.from=function(J,G,$){return A(null,J,G,$)},v.TYPED_ARRAY_SUPPORT&&(v.prototype.__proto__=Uint8Array.prototype,v.__proto__=Uint8Array,typeof Symbol<"u"&&Symbol.species&&v[Symbol.species]===v&&Object.defineProperty(v,Symbol.species,{value:null,configurable:!0}));function _(J){if(typeof J!="number")throw new TypeError('"size" argument must be a number');if(J<0)throw new RangeError('"size" argument must not be negative')}function E(J,G,$,me){return _(G),G<=0?x(J,G):$!==void 0?typeof me=="string"?x(J,G).fill($,me):x(J,G).fill($):x(J,G)}v.alloc=function(J,G,$){return E(null,J,G,$)};function w(J,G){if(_(G),J=x(J,G<0?0:I(G)|0),!v.TYPED_ARRAY_SUPPORT)for(var $=0;$<G;++$)J[$]=0;return J}v.allocUnsafe=function(J){return w(null,J)},v.allocUnsafeSlow=function(J){return w(null,J)};function S(J,G,$){if((typeof $!="string"||$==="")&&($="utf8"),!v.isEncoding($))throw new TypeError('"encoding" must be a valid string encoding');var me=B(G,$)|0;J=x(J,me);var Pe=J.write(G,$);return Pe!==me&&(J=J.slice(0,Pe)),J}function T(J,G){var $=G.length<0?0:I(G.length)|0;J=x(J,$);for(var me=0;me<$;me+=1)J[me]=G[me]&255;return J}function R(J,G,$,me){if(G.byteLength,$<0||G.byteLength<$)throw new RangeError("'offset' is out of bounds");if(G.byteLength<$+(me||0))throw new RangeError("'length' is out of bounds");return $===void 0&&me===void 0?G=new Uint8Array(G):me===void 0?G=new Uint8Array(G,$):G=new Uint8Array(G,$,me),v.TYPED_ARRAY_SUPPORT?(J=G,J.__proto__=v.prototype):J=T(J,G),J}function L(J,G){if(v.isBuffer(G)){var $=I(G.length)|0;return J=x(J,$),J.length===0||G.copy(J,0,0,$),J}if(G){if(typeof ArrayBuffer<"u"&&G.buffer instanceof ArrayBuffer||"length"in G)return typeof G.length!="number"||ae(G.length)?x(J,0):T(J,G);if(G.type==="Buffer"&&d(G.data))return T(J,G.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function I(J){if(J>=g())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+g().toString(16)+" bytes");return J|0}function N(J){return+J!=J&&(J=0),v.alloc(+J)}v.isBuffer=function(G){return!!(G!=null&&G._isBuffer)},v.compare=function(G,$){if(!v.isBuffer(G)||!v.isBuffer($))throw new TypeError("Arguments must be Buffers");if(G===$)return 0;for(var me=G.length,Pe=$.length,ve=0,Le=Math.min(me,Pe);ve<Le;++ve)if(G[ve]!==$[ve]){me=G[ve],Pe=$[ve];break}return me<Pe?-1:Pe<me?1:0},v.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(G,$){if(!d(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return v.alloc(0);var me;if($===void 0)for($=0,me=0;me<G.length;++me)$+=G[me].length;var Pe=v.allocUnsafe($),ve=0;for(me=0;me<G.length;++me){var Le=G[me];if(!v.isBuffer(Le))throw new TypeError('"list" argument must be an Array of Buffers');Le.copy(Pe,ve),ve+=Le.length}return Pe};function B(J,G){if(v.isBuffer(J))return J.length;if(typeof ArrayBuffer<"u"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(J)||J instanceof ArrayBuffer))return J.byteLength;typeof J!="string"&&(J=""+J);var $=J.length;if($===0)return 0;for(var me=!1;;)switch(G){case"ascii":case"latin1":case"binary":return $;case"utf8":case"utf-8":case void 0:return pe(J).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return $*2;case"hex":return $>>>1;case"base64":return Re(J).length;default:if(me)return pe(J).length;G=(""+G).toLowerCase(),me=!0}}v.byteLength=B;function H(J,G,$){var me=!1;if((G===void 0||G<0)&&(G=0),G>this.length||(($===void 0||$>this.length)&&($=this.length),$<=0)||($>>>=0,G>>>=0,$<=G))return"";for(J||(J="utf8");;)switch(J){case"hex":return Oe(this,G,$);case"utf8":case"utf-8":return se(this,G,$);case"ascii":return Ce(this,G,$);case"latin1":case"binary":return ke(this,G,$);case"base64":return ie(this,G,$);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ne(this,G,$);default:if(me)throw new TypeError("Unknown encoding: "+J);J=(J+"").toLowerCase(),me=!0}}v.prototype._isBuffer=!0;function q(J,G,$){var me=J[G];J[G]=J[$],J[$]=me}v.prototype.swap16=function(){var G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var $=0;$<G;$+=2)q(this,$,$+1);return this},v.prototype.swap32=function(){var G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var $=0;$<G;$+=4)q(this,$,$+3),q(this,$+1,$+2);return this},v.prototype.swap64=function(){var G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var $=0;$<G;$+=8)q(this,$,$+7),q(this,$+1,$+6),q(this,$+2,$+5),q(this,$+3,$+4);return this},v.prototype.toString=function(){var G=this.length|0;return G===0?"":arguments.length===0?se(this,0,G):H.apply(this,arguments)},v.prototype.equals=function(G){if(!v.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:v.compare(this,G)===0},v.prototype.inspect=function(){var G="",$=l.INSPECT_MAX_BYTES;return this.length>0&&(G=this.toString("hex",0,$).match(/.{2}/g).join(" "),this.length>$&&(G+=" ... ")),"<Buffer "+G+">"},v.prototype.compare=function(G,$,me,Pe,ve){if(!v.isBuffer(G))throw new TypeError("Argument must be a Buffer");if($===void 0&&($=0),me===void 0&&(me=G?G.length:0),Pe===void 0&&(Pe=0),ve===void 0&&(ve=this.length),$<0||me>G.length||Pe<0||ve>this.length)throw new RangeError("out of range index");if(Pe>=ve&&$>=me)return 0;if(Pe>=ve)return-1;if($>=me)return 1;if($>>>=0,me>>>=0,Pe>>>=0,ve>>>=0,this===G)return 0;for(var Le=ve-Pe,wt=me-$,Ot=Math.min(Le,wt),_t=this.slice(Pe,ve),Ut=G.slice($,me),It=0;It<Ot;++It)if(_t[It]!==Ut[It]){Le=_t[It],wt=Ut[It];break}return Le<wt?-1:wt<Le?1:0};function le(J,G,$,me,Pe){if(J.length===0)return-1;if(typeof $=="string"?(me=$,$=0):$>2147483647?$=2147483647:$<-2147483648&&($=-2147483648),$=+$,isNaN($)&&($=Pe?0:J.length-1),$<0&&($=J.length+$),$>=J.length){if(Pe)return-1;$=J.length-1}else if($<0)if(Pe)$=0;else return-1;if(typeof G=="string"&&(G=v.from(G,me)),v.isBuffer(G))return G.length===0?-1:ne(J,G,$,me,Pe);if(typeof G=="number")return G=G&255,v.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?Pe?Uint8Array.prototype.indexOf.call(J,G,$):Uint8Array.prototype.lastIndexOf.call(J,G,$):ne(J,[G],$,me,Pe);throw new TypeError("val must be string, number or Buffer")}function ne(J,G,$,me,Pe){var ve=1,Le=J.length,wt=G.length;if(me!==void 0&&(me=String(me).toLowerCase(),me==="ucs2"||me==="ucs-2"||me==="utf16le"||me==="utf-16le")){if(J.length<2||G.length<2)return-1;ve=2,Le/=2,wt/=2,$/=2}function Ot(Un,$n){return ve===1?Un[$n]:Un.readUInt16BE($n*ve)}var _t;if(Pe){var Ut=-1;for(_t=$;_t<Le;_t++)if(Ot(J,_t)===Ot(G,Ut===-1?0:_t-Ut)){if(Ut===-1&&(Ut=_t),_t-Ut+1===wt)return Ut*ve}else Ut!==-1&&(_t-=_t-Ut),Ut=-1}else for($+wt>Le&&($=Le-wt),_t=$;_t>=0;_t--){for(var It=!0,dn=0;dn<wt;dn++)if(Ot(J,_t+dn)!==Ot(G,dn)){It=!1;break}if(It)return _t}return-1}v.prototype.includes=function(G,$,me){return this.indexOf(G,$,me)!==-1},v.prototype.indexOf=function(G,$,me){return le(this,G,$,me,!0)},v.prototype.lastIndexOf=function(G,$,me){return le(this,G,$,me,!1)};function D(J,G,$,me){$=Number($)||0;var Pe=J.length-$;me?(me=Number(me),me>Pe&&(me=Pe)):me=Pe;var ve=G.length;if(ve%2!==0)throw new TypeError("Invalid hex string");me>ve/2&&(me=ve/2);for(var Le=0;Le<me;++Le){var wt=parseInt(G.substr(Le*2,2),16);if(isNaN(wt))return Le;J[$+Le]=wt}return Le}function O(J,G,$,me){return ce(pe(G,J.length-$),J,$,me)}function k(J,G,$,me){return ce(ge(G),J,$,me)}function z(J,G,$,me){return k(J,G,$,me)}function X(J,G,$,me){return ce(Re(G),J,$,me)}function Z(J,G,$,me){return ce(Fe(G,J.length-$),J,$,me)}v.prototype.write=function(G,$,me,Pe){if($===void 0)Pe="utf8",me=this.length,$=0;else if(me===void 0&&typeof $=="string")Pe=$,me=this.length,$=0;else if(isFinite($))$=$|0,isFinite(me)?(me=me|0,Pe===void 0&&(Pe="utf8")):(Pe=me,me=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var ve=this.length-$;if((me===void 0||me>ve)&&(me=ve),G.length>0&&(me<0||$<0)||$>this.length)throw new RangeError("Attempt to write outside buffer bounds");Pe||(Pe="utf8");for(var Le=!1;;)switch(Pe){case"hex":return D(this,G,$,me);case"utf8":case"utf-8":return O(this,G,$,me);case"ascii":return k(this,G,$,me);case"latin1":case"binary":return z(this,G,$,me);case"base64":return X(this,G,$,me);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z(this,G,$,me);default:if(Le)throw new TypeError("Unknown encoding: "+Pe);Pe=(""+Pe).toLowerCase(),Le=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ie(J,G,$){return G===0&&$===J.length?h.fromByteArray(J):h.fromByteArray(J.slice(G,$))}function se(J,G,$){$=Math.min(J.length,$);for(var me=[],Pe=G;Pe<$;){var ve=J[Pe],Le=null,wt=ve>239?4:ve>223?3:ve>191?2:1;if(Pe+wt<=$){var Ot,_t,Ut,It;switch(wt){case 1:ve<128&&(Le=ve);break;case 2:Ot=J[Pe+1],(Ot&192)===128&&(It=(ve&31)<<6|Ot&63,It>127&&(Le=It));break;case 3:Ot=J[Pe+1],_t=J[Pe+2],(Ot&192)===128&&(_t&192)===128&&(It=(ve&15)<<12|(Ot&63)<<6|_t&63,It>2047&&(It<55296||It>57343)&&(Le=It));break;case 4:Ot=J[Pe+1],_t=J[Pe+2],Ut=J[Pe+3],(Ot&192)===128&&(_t&192)===128&&(Ut&192)===128&&(It=(ve&15)<<18|(Ot&63)<<12|(_t&63)<<6|Ut&63,It>65535&&It<1114112&&(Le=It))}}Le===null?(Le=65533,wt=1):Le>65535&&(Le-=65536,me.push(Le>>>10&1023|55296),Le=56320|Le&1023),me.push(Le),Pe+=wt}return ye(me)}var ue=4096;function ye(J){var G=J.length;if(G<=ue)return String.fromCharCode.apply(String,J);for(var $="",me=0;me<G;)$+=String.fromCharCode.apply(String,J.slice(me,me+=ue));return $}function Ce(J,G,$){var me="";$=Math.min(J.length,$);for(var Pe=G;Pe<$;++Pe)me+=String.fromCharCode(J[Pe]&127);return me}function ke(J,G,$){var me="";$=Math.min(J.length,$);for(var Pe=G;Pe<$;++Pe)me+=String.fromCharCode(J[Pe]);return me}function Oe(J,G,$){var me=J.length;(!G||G<0)&&(G=0),(!$||$<0||$>me)&&($=me);for(var Pe="",ve=G;ve<$;++ve)Pe+=tt(J[ve]);return Pe}function Ne(J,G,$){for(var me=J.slice(G,$),Pe="",ve=0;ve<me.length;ve+=2)Pe+=String.fromCharCode(me[ve]+me[ve+1]*256);return Pe}v.prototype.slice=function(G,$){var me=this.length;G=~~G,$=$===void 0?me:~~$,G<0?(G+=me,G<0&&(G=0)):G>me&&(G=me),$<0?($+=me,$<0&&($=0)):$>me&&($=me),$<G&&($=G);var Pe;if(v.TYPED_ARRAY_SUPPORT)Pe=this.subarray(G,$),Pe.__proto__=v.prototype;else{var ve=$-G;Pe=new v(ve,void 0);for(var Le=0;Le<ve;++Le)Pe[Le]=this[Le+G]}return Pe};function He(J,G,$){if(J%1!==0||J<0)throw new RangeError("offset is not uint");if(J+G>$)throw new RangeError("Trying to access beyond buffer length")}v.prototype.readUIntLE=function(G,$,me){G=G|0,$=$|0,me||He(G,$,this.length);for(var Pe=this[G],ve=1,Le=0;++Le<$&&(ve*=256);)Pe+=this[G+Le]*ve;return Pe},v.prototype.readUIntBE=function(G,$,me){G=G|0,$=$|0,me||He(G,$,this.length);for(var Pe=this[G+--$],ve=1;$>0&&(ve*=256);)Pe+=this[G+--$]*ve;return Pe},v.prototype.readUInt8=function(G,$){return $||He(G,1,this.length),this[G]},v.prototype.readUInt16LE=function(G,$){return $||He(G,2,this.length),this[G]|this[G+1]<<8},v.prototype.readUInt16BE=function(G,$){return $||He(G,2,this.length),this[G]<<8|this[G+1]},v.prototype.readUInt32LE=function(G,$){return $||He(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},v.prototype.readUInt32BE=function(G,$){return $||He(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},v.prototype.readIntLE=function(G,$,me){G=G|0,$=$|0,me||He(G,$,this.length);for(var Pe=this[G],ve=1,Le=0;++Le<$&&(ve*=256);)Pe+=this[G+Le]*ve;return ve*=128,Pe>=ve&&(Pe-=Math.pow(2,8*$)),Pe},v.prototype.readIntBE=function(G,$,me){G=G|0,$=$|0,me||He(G,$,this.length);for(var Pe=$,ve=1,Le=this[G+--Pe];Pe>0&&(ve*=256);)Le+=this[G+--Pe]*ve;return ve*=128,Le>=ve&&(Le-=Math.pow(2,8*$)),Le},v.prototype.readInt8=function(G,$){return $||He(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},v.prototype.readInt16LE=function(G,$){$||He(G,2,this.length);var me=this[G]|this[G+1]<<8;return me&32768?me|4294901760:me},v.prototype.readInt16BE=function(G,$){$||He(G,2,this.length);var me=this[G+1]|this[G]<<8;return me&32768?me|4294901760:me},v.prototype.readInt32LE=function(G,$){return $||He(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},v.prototype.readInt32BE=function(G,$){return $||He(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},v.prototype.readFloatLE=function(G,$){return $||He(G,4,this.length),f.read(this,G,!0,23,4)},v.prototype.readFloatBE=function(G,$){return $||He(G,4,this.length),f.read(this,G,!1,23,4)},v.prototype.readDoubleLE=function(G,$){return $||He(G,8,this.length),f.read(this,G,!0,52,8)},v.prototype.readDoubleBE=function(G,$){return $||He(G,8,this.length),f.read(this,G,!1,52,8)};function Qe(J,G,$,me,Pe,ve){if(!v.isBuffer(J))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>Pe||G<ve)throw new RangeError('"value" argument is out of bounds');if($+me>J.length)throw new RangeError("Index out of range")}v.prototype.writeUIntLE=function(G,$,me,Pe){if(G=+G,$=$|0,me=me|0,!Pe){var ve=Math.pow(2,8*me)-1;Qe(this,G,$,me,ve,0)}var Le=1,wt=0;for(this[$]=G&255;++wt<me&&(Le*=256);)this[$+wt]=G/Le&255;return $+me},v.prototype.writeUIntBE=function(G,$,me,Pe){if(G=+G,$=$|0,me=me|0,!Pe){var ve=Math.pow(2,8*me)-1;Qe(this,G,$,me,ve,0)}var Le=me-1,wt=1;for(this[$+Le]=G&255;--Le>=0&&(wt*=256);)this[$+Le]=G/wt&255;return $+me},v.prototype.writeUInt8=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,1,255,0),v.TYPED_ARRAY_SUPPORT||(G=Math.floor(G)),this[$]=G&255,$+1};function St(J,G,$,me){G<0&&(G=65535+G+1);for(var Pe=0,ve=Math.min(J.length-$,2);Pe<ve;++Pe)J[$+Pe]=(G&255<<8*(me?Pe:1-Pe))>>>(me?Pe:1-Pe)*8}v.prototype.writeUInt16LE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[$]=G&255,this[$+1]=G>>>8):St(this,G,$,!0),$+2},v.prototype.writeUInt16BE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,2,65535,0),v.TYPED_ARRAY_SUPPORT?(this[$]=G>>>8,this[$+1]=G&255):St(this,G,$,!1),$+2};function bt(J,G,$,me){G<0&&(G=4294967295+G+1);for(var Pe=0,ve=Math.min(J.length-$,4);Pe<ve;++Pe)J[$+Pe]=G>>>(me?Pe:3-Pe)*8&255}v.prototype.writeUInt32LE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[$+3]=G>>>24,this[$+2]=G>>>16,this[$+1]=G>>>8,this[$]=G&255):bt(this,G,$,!0),$+4},v.prototype.writeUInt32BE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,4,4294967295,0),v.TYPED_ARRAY_SUPPORT?(this[$]=G>>>24,this[$+1]=G>>>16,this[$+2]=G>>>8,this[$+3]=G&255):bt(this,G,$,!1),$+4},v.prototype.writeIntLE=function(G,$,me,Pe){if(G=+G,$=$|0,!Pe){var ve=Math.pow(2,8*me-1);Qe(this,G,$,me,ve-1,-ve)}var Le=0,wt=1,Ot=0;for(this[$]=G&255;++Le<me&&(wt*=256);)G<0&&Ot===0&&this[$+Le-1]!==0&&(Ot=1),this[$+Le]=(G/wt>>0)-Ot&255;return $+me},v.prototype.writeIntBE=function(G,$,me,Pe){if(G=+G,$=$|0,!Pe){var ve=Math.pow(2,8*me-1);Qe(this,G,$,me,ve-1,-ve)}var Le=me-1,wt=1,Ot=0;for(this[$+Le]=G&255;--Le>=0&&(wt*=256);)G<0&&Ot===0&&this[$+Le+1]!==0&&(Ot=1),this[$+Le]=(G/wt>>0)-Ot&255;return $+me},v.prototype.writeInt8=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,1,127,-128),v.TYPED_ARRAY_SUPPORT||(G=Math.floor(G)),G<0&&(G=255+G+1),this[$]=G&255,$+1},v.prototype.writeInt16LE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[$]=G&255,this[$+1]=G>>>8):St(this,G,$,!0),$+2},v.prototype.writeInt16BE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,2,32767,-32768),v.TYPED_ARRAY_SUPPORT?(this[$]=G>>>8,this[$+1]=G&255):St(this,G,$,!1),$+2},v.prototype.writeInt32LE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,4,2147483647,-2147483648),v.TYPED_ARRAY_SUPPORT?(this[$]=G&255,this[$+1]=G>>>8,this[$+2]=G>>>16,this[$+3]=G>>>24):bt(this,G,$,!0),$+4},v.prototype.writeInt32BE=function(G,$,me){return G=+G,$=$|0,me||Qe(this,G,$,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),v.TYPED_ARRAY_SUPPORT?(this[$]=G>>>24,this[$+1]=G>>>16,this[$+2]=G>>>8,this[$+3]=G&255):bt(this,G,$,!1),$+4};function Jt(J,G,$,me,Pe,ve){if($+me>J.length)throw new RangeError("Index out of range");if($<0)throw new RangeError("Index out of range")}function sn(J,G,$,me,Pe){return Pe||Jt(J,G,$,4),f.write(J,G,$,me,23,4),$+4}v.prototype.writeFloatLE=function(G,$,me){return sn(this,G,$,!0,me)},v.prototype.writeFloatBE=function(G,$,me){return sn(this,G,$,!1,me)};function Se(J,G,$,me,Pe){return Pe||Jt(J,G,$,8),f.write(J,G,$,me,52,8),$+8}v.prototype.writeDoubleLE=function(G,$,me){return Se(this,G,$,!0,me)},v.prototype.writeDoubleBE=function(G,$,me){return Se(this,G,$,!1,me)},v.prototype.copy=function(G,$,me,Pe){if(me||(me=0),!Pe&&Pe!==0&&(Pe=this.length),$>=G.length&&($=G.length),$||($=0),Pe>0&&Pe<me&&(Pe=me),Pe===me||G.length===0||this.length===0)return 0;if($<0)throw new RangeError("targetStart out of bounds");if(me<0||me>=this.length)throw new RangeError("sourceStart out of bounds");if(Pe<0)throw new RangeError("sourceEnd out of bounds");Pe>this.length&&(Pe=this.length),G.length-$<Pe-me&&(Pe=G.length-$+me);var ve=Pe-me,Le;if(this===G&&me<$&&$<Pe)for(Le=ve-1;Le>=0;--Le)G[Le+$]=this[Le+me];else if(ve<1e3||!v.TYPED_ARRAY_SUPPORT)for(Le=0;Le<ve;++Le)G[Le+$]=this[Le+me];else Uint8Array.prototype.set.call(G,this.subarray(me,me+ve),$);return ve},v.prototype.fill=function(G,$,me,Pe){if(typeof G=="string"){if(typeof $=="string"?(Pe=$,$=0,me=this.length):typeof me=="string"&&(Pe=me,me=this.length),G.length===1){var ve=G.charCodeAt(0);ve<256&&(G=ve)}if(Pe!==void 0&&typeof Pe!="string")throw new TypeError("encoding must be a string");if(typeof Pe=="string"&&!v.isEncoding(Pe))throw new TypeError("Unknown encoding: "+Pe)}else typeof G=="number"&&(G=G&255);if($<0||this.length<$||this.length<me)throw new RangeError("Out of range index");if(me<=$)return this;$=$>>>0,me=me===void 0?this.length:me>>>0,G||(G=0);var Le;if(typeof G=="number")for(Le=$;Le<me;++Le)this[Le]=G;else{var wt=v.isBuffer(G)?G:pe(new v(G,Pe).toString()),Ot=wt.length;for(Le=0;Le<me-$;++Le)this[Le+$]=wt[Le%Ot]}return this};var qe=/[^+\/0-9A-Za-z-_]/g;function Ue(J){if(J=At(J).replace(qe,""),J.length<2)return"";for(;J.length%4!==0;)J=J+"=";return J}function At(J){return J.trim?J.trim():J.replace(/^\s+|\s+$/g,"")}function tt(J){return J<16?"0"+J.toString(16):J.toString(16)}function pe(J,G){G=G||1/0;for(var $,me=J.length,Pe=null,ve=[],Le=0;Le<me;++Le){if($=J.charCodeAt(Le),$>55295&&$<57344){if(!Pe){if($>56319){(G-=3)>-1&&ve.push(239,191,189);continue}else if(Le+1===me){(G-=3)>-1&&ve.push(239,191,189);continue}Pe=$;continue}if($<56320){(G-=3)>-1&&ve.push(239,191,189),Pe=$;continue}$=(Pe-55296<<10|$-56320)+65536}else Pe&&(G-=3)>-1&&ve.push(239,191,189);if(Pe=null,$<128){if((G-=1)<0)break;ve.push($)}else if($<2048){if((G-=2)<0)break;ve.push($>>6|192,$&63|128)}else if($<65536){if((G-=3)<0)break;ve.push($>>12|224,$>>6&63|128,$&63|128)}else if($<1114112){if((G-=4)<0)break;ve.push($>>18|240,$>>12&63|128,$>>6&63|128,$&63|128)}else throw new Error("Invalid code point")}return ve}function ge(J){for(var G=[],$=0;$<J.length;++$)G.push(J.charCodeAt($)&255);return G}function Fe(J,G){for(var $,me,Pe,ve=[],Le=0;Le<J.length&&!((G-=2)<0);++Le)$=J.charCodeAt(Le),me=$>>8,Pe=$%256,ve.push(Pe),ve.push(me);return ve}function Re(J){return h.toByteArray(Ue(J))}function ce(J,G,$,me){for(var Pe=0;Pe<me&&!(Pe+$>=G.length||Pe>=J.length);++Pe)G[Pe+$]=J[Pe];return Pe}function ae(J){return J!==J}}).call(this,typeof ks<"u"?ks:typeof self<"u"?self:typeof window<"u"?window:{},i("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(i,o,l){(function(){if(!(typeof window>"u"))try{var a=new window.CustomEvent("test",{cancelable:!0});if(a.preventDefault(),a.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var u=function(f,d){var m,g;return d=d||{},d.bubbles=!!d.bubbles,d.cancelable=!!d.cancelable,m=document.createEvent("CustomEvent"),m.initCustomEvent(f,d.bubbles,d.cancelable,d.detail),g=m.preventDefault,m.preventDefault=function(){g.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},m};u.prototype=window.Event.prototype,window.CustomEvent=u}})()},{}],8:[function(i,o,l){l=o.exports=i("./debug"),l.log=h,l.formatArgs=u,l.save=f,l.load=d,l.useColors=a,l.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:m(),l.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function a(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}l.formatters.j=function(g){return JSON.stringify(g)};function u(){var g=arguments,x=this.useColors;if(g[0]=(x?"%c":"")+this.namespace+(x?" %c":" ")+g[0]+(x?"%c ":" "),!x)return g;var v="color: "+this.color;g=[g[0],v,"color: inherit"].concat(Array.prototype.slice.call(g,1));var A=0,_=0;return g[0].replace(/%[a-z%]/g,function(E){E!=="%%"&&(A++,E==="%c"&&(_=A))}),g.splice(_,0,v),g}function h(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function f(g){try{g==null?l.storage.removeItem("debug"):l.storage.debug=g}catch{}}function d(){var g;try{g=l.storage.debug}catch{}return g}l.enable(d());function m(){try{return window.localStorage}catch{}}},{"./debug":9}],9:[function(i,o,l){l=o.exports=h,l.coerce=g,l.disable=d,l.enable=f,l.enabled=m,l.names=[],l.skips=[],l.formatters={};var a=0;function u(){return l.colors[a++%l.colors.length]}function h(x){function v(){}v.enabled=!1;function A(){var E=A;E.useColors==null&&(E.useColors=l.useColors()),E.color==null&&E.useColors&&(E.color=u());var w=Array.prototype.slice.call(arguments);w[0]=l.coerce(w[0]),typeof w[0]!="string"&&(w=["%o"].concat(w));var S=0;w[0]=w[0].replace(/%([a-z%])/g,function(R,L){if(R==="%%")return R;S++;var I=l.formatters[L];if(typeof I=="function"){var N=w[S];R=I.call(E,N),w.splice(S,1),S--}return R}),typeof l.formatArgs=="function"&&(w=l.formatArgs.apply(E,w));var T=A.log||l.log||console.log.bind(console);T.apply(E,w)}A.enabled=!0;var _=l.enabled(x)?A:v;return _.namespace=x,_}function f(x){l.save(x);for(var v=(x||"").split(/[\s,]+/),A=v.length,_=0;_<A;_++)!v[_]||(x=v[_].replace(/\*/g,".*?"),x[0]==="-"?l.skips.push(new RegExp("^"+x.substr(1)+"$")):l.names.push(new RegExp("^"+x+"$")))}function d(){l.enable("")}function m(x){var v,A;for(v=0,A=l.skips.length;v<A;v++)if(l.skips[v].test(x))return!1;for(v=0,A=l.names.length;v<A;v++)if(l.names[v].test(x))return!0;return!1}function g(x){return x instanceof Error?x.stack||x.message:x}},{}],10:[function(i,o,l){var a=i("is-obj"),u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;function f(g){if(g==null)throw new TypeError("Sources cannot be null or undefined");return Object(g)}function d(g,x,v){var A=x[v];if(A!=null){if(u.call(g,v)&&(g[v]===void 0||g[v]===null))throw new TypeError("Cannot convert undefined or null to object ("+v+")");!u.call(g,v)||!a(A)?g[v]=A:g[v]=m(Object(g[v]),x[v])}}function m(g,x){if(g===x)return g;x=Object(x);for(var v in x)u.call(x,v)&&d(g,x,v);if(Object.getOwnPropertySymbols)for(var A=Object.getOwnPropertySymbols(x),_=0;_<A.length;_++)h.call(x,A[_])&&d(g,x,A[_]);return g}o.exports=function(x){x=f(x);for(var v=1;v<arguments.length;v++)m(x,arguments[v]);return x}},{"is-obj":34}],11:[function(i,o,l){var a=i("object-keys"),u=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",h=Object.prototype.toString,f=Array.prototype.concat,d=Object.defineProperty,m=function(_){return typeof _=="function"&&h.call(_)==="[object Function]"},g=function(){var _={};try{d(_,"x",{enumerable:!1,value:_});for(var E in _)return!1;return _.x===_}catch{return!1}},x=d&&g(),v=function(_,E,w,S){E in _&&(!m(S)||!S())||(x?d(_,E,{configurable:!0,enumerable:!1,value:w,writable:!0}):_[E]=w)},A=function(_,E){var w=arguments.length>2?arguments[2]:{},S=a(E);u&&(S=f.call(S,Object.getOwnPropertySymbols(E)));for(var T=0;T<S.length;T+=1)v(_,S[T],E[S[T]],w[S[T]])};A.supportsDescriptors=!!x,o.exports=A},{"object-keys":41}],12:[function(i,o,l){/*! (C) WebReflection Mit Style License */(function(a,u,h,f){function d(Ve,nt){for(var yt=0,Wt=Ve.length;yt<Wt;yt++)L(Ve[yt],nt)}function m(Ve){for(var nt=0,yt=Ve.length,Wt;nt<yt;nt++)Wt=Ve[nt],Je(Wt,ue[x(Wt)])}function g(Ve){return function(nt){ge(nt)&&(L(nt,Ve),d(nt.querySelectorAll(ye),Ve))}}function x(Ve){var nt=ce.call(Ve,"is"),yt=Ve.nodeName.toUpperCase(),Wt=ke.call(se,nt?X+nt.toUpperCase():z+yt);return nt&&-1<Wt&&!v(yt,nt)?-1:Wt}function v(Ve,nt){return-1<ye.indexOf(Ve+'[is="'+nt+'"]')}function A(Ve){var nt=Ve.currentTarget,yt=Ve.attrChange,Wt=Ve.attrName,pn=Ve.target;_t&&(!pn||pn===nt)&&nt.attributeChangedCallback&&Wt!=="style"&&Ve.prevValue!==Ve.newValue&&nt.attributeChangedCallback(Wt,yt===Ve[q]?null:Ve.prevValue,yt===Ve[ne]?null:Ve.newValue)}function _(Ve){var nt=g(Ve);return function(yt){Pe.push(nt,yt.target)}}function E(Ve){Ot&&(Ot=!1,Ve.currentTarget.removeEventListener(O,E)),d((Ve.target||u).querySelectorAll(ye),Ve.detail===B?B:N),pe&&T()}function w(Ve,nt){var yt=this;ae.call(yt,Ve,nt),Ut.call(yt,{target:yt})}function S(Ve,nt){Ue(Ve,nt),Un?Un.observe(Ve,$):(wt&&(Ve.setAttribute=w,Ve[I]=dn(Ve),Ve.addEventListener(k,Ut)),Ve.addEventListener(D,A)),Ve.createdCallback&&_t&&(Ve.created=!0,Ve.createdCallback(),Ve.created=!1)}function T(){for(var Ve,nt=0,yt=Fe.length;nt<yt;nt++)Ve=Fe[nt],Ce.contains(Ve)||(yt--,Fe.splice(nt--,1),L(Ve,B))}function R(Ve){throw new Error("A "+Ve+" type is already registered")}function L(Ve,nt){var yt,Wt=x(Ve);-1<Wt&&($n(Ve,ue[Wt]),Wt=0,nt===N&&!Ve[N]?(Ve[B]=!1,Ve[N]=!0,Wt=1,pe&&ke.call(Fe,Ve)<0&&Fe.push(Ve)):nt===B&&!Ve[B]&&(Ve[N]=!1,Ve[B]=!0,Wt=1),Wt&&(yt=Ve[nt+"Callback"])&&yt.call(Ve))}if(!(f in u)){var I="__"+f+(Math.random()*1e5>>0),N="attached",B="detached",H="extends",q="ADDITION",le="MODIFICATION",ne="REMOVAL",D="DOMAttrModified",O="DOMContentLoaded",k="DOMSubtreeModified",z="<",X="=",Z=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,ie=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],se=[],ue=[],ye="",Ce=u.documentElement,ke=se.indexOf||function(Ve){for(var nt=this.length;nt--&&this[nt]!==Ve;);return nt},Oe=h.prototype,Ne=Oe.hasOwnProperty,He=Oe.isPrototypeOf,Qe=h.defineProperty,St=h.getOwnPropertyDescriptor,bt=h.getOwnPropertyNames,Jt=h.getPrototypeOf,sn=h.setPrototypeOf,Se=!!h.__proto__,qe=h.create||function Ve(nt){return nt?(Ve.prototype=nt,new Ve):this},Ue=sn||(Se?function(Ve,nt){return Ve.__proto__=nt,Ve}:bt&&St?function(){function Ve(nt,yt){for(var Wt,pn=bt(yt),An=0,mn=pn.length;An<mn;An++)Wt=pn[An],Ne.call(nt,Wt)||Qe(nt,Wt,St(yt,Wt))}return function(nt,yt){do Ve(nt,yt);while((yt=Jt(yt))&&!He.call(yt,nt));return nt}}():function(Ve,nt){for(var yt in nt)Ve[yt]=nt[yt];return Ve}),At=a.MutationObserver||a.WebKitMutationObserver,tt=(a.HTMLElement||a.Element||a.Node).prototype,pe=!He.call(tt,Ce),ge=pe?function(Ve){return Ve.nodeType===1}:function(Ve){return He.call(tt,Ve)},Fe=pe&&[],Re=tt.cloneNode,ce=tt.getAttribute,ae=tt.setAttribute,J=tt.removeAttribute,G=u.createElement,$=At&&{attributes:!0,characterData:!0,attributeOldValue:!0},me=At||function(Ve){wt=!1,Ce.removeEventListener(D,me)},Pe,ve=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.msRequestAnimationFrame||function(Ve){setTimeout(Ve,10)},Le=!1,wt=!0,Ot=!0,_t=!0,Ut,It,dn,Un,$n,Je;sn||Se?($n=function(Ve,nt){He.call(nt,Ve)||S(Ve,nt)},Je=S):($n=function(Ve,nt){Ve[I]||(Ve[I]=h(!0),S(Ve,nt))},Je=$n),pe?(wt=!1,function(){var Ve=St(tt,"addEventListener"),nt=Ve.value,yt=function(An){var mn=new CustomEvent(D,{bubbles:!0});mn.attrName=An,mn.prevValue=ce.call(this,An),mn.newValue=null,mn[ne]=mn.attrChange=2,J.call(this,An),this.dispatchEvent(mn)},Wt=function(An,mn){var Yn=this.hasAttribute(An),Bn=Yn&&ce.call(this,An);e=new CustomEvent(D,{bubbles:!0}),ae.call(this,An,mn),e.attrName=An,e.prevValue=Yn?Bn:null,e.newValue=mn,Yn?e[le]=e.attrChange=1:e[q]=e.attrChange=0,this.dispatchEvent(e)},pn=function(An){var mn=An.currentTarget,Yn=mn[I],Bn=An.propertyName,mi;Yn.hasOwnProperty(Bn)&&(Yn=Yn[Bn],mi=new CustomEvent(D,{bubbles:!0}),mi.attrName=Yn.name,mi.prevValue=Yn.value||null,mi.newValue=Yn.value=mn[Bn]||null,mi.prevValue==null?mi[q]=mi.attrChange=0:mi[le]=mi.attrChange=1,mn.dispatchEvent(mi))};Ve.value=function(An,mn,Yn){An===D&&this.attributeChangedCallback&&this.setAttribute!==Wt&&(this[I]={className:{name:"class",value:this.className}},this.setAttribute=Wt,this.removeAttribute=yt,nt.call(this,"propertychange",pn)),nt.call(this,An,mn,Yn)},Qe(tt,"addEventListener",Ve)}()):At||(Ce.addEventListener(D,me),Ce.setAttribute(I,1),Ce.removeAttribute(I),wt&&(Ut=function(Ve){var nt=this,yt,Wt,pn;if(nt===Ve.target){yt=nt[I],nt[I]=Wt=dn(nt);for(pn in Wt){if(!(pn in yt))return It(0,nt,pn,yt[pn],Wt[pn],q);if(Wt[pn]!==yt[pn])return It(1,nt,pn,yt[pn],Wt[pn],le)}for(pn in yt)if(!(pn in Wt))return It(2,nt,pn,yt[pn],Wt[pn],ne)}},It=function(Ve,nt,yt,Wt,pn,An){var mn={attrChange:Ve,currentTarget:nt,attrName:yt,prevValue:Wt,newValue:pn};mn[An]=Ve,A(mn)},dn=function(Ve){for(var nt,yt,Wt={},pn=Ve.attributes,An=0,mn=pn.length;An<mn;An++)nt=pn[An],yt=nt.name,yt!=="setAttribute"&&(Wt[yt]=nt.value);return Wt})),u[f]=function(Ve,nt){if(mn=Ve.toUpperCase(),Le||(Le=!0,At?(Un=function(Bn,mi){function Ii(Si,Gi){for(var er=0,is=Si.length;er<is;Gi(Si[er++]));}return new At(function(Si){for(var Gi,er,is,ze=0,at=Si.length;ze<at;ze++)Gi=Si[ze],Gi.type==="childList"?(Ii(Gi.addedNodes,Bn),Ii(Gi.removedNodes,mi)):(er=Gi.target,_t&&er.attributeChangedCallback&&Gi.attributeName!=="style"&&(is=ce.call(er,Gi.attributeName),is!==Gi.oldValue&&er.attributeChangedCallback(Gi.attributeName,Gi.oldValue,is)))})}(g(N),g(B)),Un.observe(u,{childList:!0,subtree:!0})):(Pe=[],ve(function Bn(){for(;Pe.length;)Pe.shift().call(null,Pe.shift());ve(Bn)}),u.addEventListener("DOMNodeInserted",_(N)),u.addEventListener("DOMNodeRemoved",_(B))),u.addEventListener(O,E),u.addEventListener("readystatechange",E),u.createElement=function(Bn,mi){var Ii=G.apply(u,arguments),Si=""+Bn,Gi=ke.call(se,(mi?X:z)+(mi||Si).toUpperCase()),er=-1<Gi;return mi&&(Ii.setAttribute("is",mi=mi.toLowerCase()),er&&(er=v(Si.toUpperCase(),mi))),_t=!u.createElement.innerHTMLHelper,er&&Je(Ii,ue[Gi]),Ii},tt.cloneNode=function(Bn){var mi=Re.call(this,!!Bn),Ii=x(mi);return-1<Ii&&Je(mi,ue[Ii]),Bn&&m(mi.querySelectorAll(ye)),mi}),-2<ke.call(se,X+mn)+ke.call(se,z+mn)&&R(Ve),!Z.test(mn)||-1<ke.call(ie,mn))throw new Error("The type "+Ve+" is invalid");var yt=function(){return pn?u.createElement(An,mn):u.createElement(An)},Wt=nt||Oe,pn=Ne.call(Wt,H),An=pn?nt[H].toUpperCase():mn,mn,Yn;return pn&&-1<ke.call(se,z+An)&&R(An),Yn=se.push((pn?X:z)+mn)-1,ye=ye.concat(ye.length?",":"",pn?An+'[is="'+Ve.toLowerCase()+'"]':An),yt.prototype=ue[Yn]=Ne.call(Wt,"prototype")?Wt.prototype:qe(tt),d(u.querySelectorAll(ye),N),yt}}})(window,document,Object,"registerElement")},{}],13:[function(i,o,l){o.exports=function(a){switch(a){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(i,o,l){var a,u=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",f=Object.getPrototypeOf||function(A){return A.__proto__},d=a,m=a,g=a,x=typeof Uint8Array>"u"?a:f(Uint8Array),v={"$ %Array%":Array,"$ %ArrayBuffer%":typeof ArrayBuffer>"u"?a:ArrayBuffer,"$ %ArrayBufferPrototype%":typeof ArrayBuffer>"u"?a:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":h?f([][Symbol.iterator]()):a,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":a,"$ %AsyncFunction%":m,"$ %AsyncFunctionPrototype%":a,"$ %AsyncGenerator%":a,"$ %AsyncGeneratorFunction%":g,"$ %AsyncGeneratorPrototype%":a,"$ %AsyncIteratorPrototype%":a,"$ %Atomics%":typeof Atomics>"u"?a:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":typeof DataView>"u"?a:DataView,"$ %DataViewPrototype%":typeof DataView>"u"?a:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":typeof Float32Array>"u"?a:Float32Array,"$ %Float32ArrayPrototype%":typeof Float32Array>"u"?a:Float32Array.prototype,"$ %Float64Array%":typeof Float64Array>"u"?a:Float64Array,"$ %Float64ArrayPrototype%":typeof Float64Array>"u"?a:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":a,"$ %GeneratorFunction%":d,"$ %GeneratorPrototype%":a,"$ %Int8Array%":typeof Int8Array>"u"?a:Int8Array,"$ %Int8ArrayPrototype%":typeof Int8Array>"u"?a:Int8Array.prototype,"$ %Int16Array%":typeof Int16Array>"u"?a:Int16Array,"$ %Int16ArrayPrototype%":typeof Int16Array>"u"?a:Int8Array.prototype,"$ %Int32Array%":typeof Int32Array>"u"?a:Int32Array,"$ %Int32ArrayPrototype%":typeof Int32Array>"u"?a:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":h?f(f([][Symbol.iterator]())):a,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":typeof Map>"u"?a:Map,"$ %MapIteratorPrototype%":typeof Map>"u"||!h?a:f(new Map()[Symbol.iterator]()),"$ %MapPrototype%":typeof Map>"u"?a:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":typeof Promise>"u"?a:Promise,"$ %PromisePrototype%":typeof Promise>"u"?a:Promise.prototype,"$ %PromiseProto_then%":typeof Promise>"u"?a:Promise.prototype.then,"$ %Promise_all%":typeof Promise>"u"?a:Promise.all,"$ %Promise_reject%":typeof Promise>"u"?a:Promise.reject,"$ %Promise_resolve%":typeof Promise>"u"?a:Promise.resolve,"$ %Proxy%":typeof Proxy>"u"?a:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":typeof Reflect>"u"?a:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":typeof Set>"u"?a:Set,"$ %SetIteratorPrototype%":typeof Set>"u"||!h?a:f(new Set()[Symbol.iterator]()),"$ %SetPrototype%":typeof Set>"u"?a:Set.prototype,"$ %SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?a:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":typeof SharedArrayBuffer>"u"?a:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":h?f(""[Symbol.iterator]()):a,"$ %StringPrototype%":String.prototype,"$ %Symbol%":h?Symbol:a,"$ %SymbolPrototype%":h?Symbol.prototype:a,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":u,"$ %TypedArray%":x,"$ %TypedArrayPrototype%":x?x.prototype:a,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":typeof Uint8Array>"u"?a:Uint8Array,"$ %Uint8ArrayPrototype%":typeof Uint8Array>"u"?a:Uint8Array.prototype,"$ %Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?a:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":typeof Uint8ClampedArray>"u"?a:Uint8ClampedArray.prototype,"$ %Uint16Array%":typeof Uint16Array>"u"?a:Uint16Array,"$ %Uint16ArrayPrototype%":typeof Uint16Array>"u"?a:Uint16Array.prototype,"$ %Uint32Array%":typeof Uint32Array>"u"?a:Uint32Array,"$ %Uint32ArrayPrototype%":typeof Uint32Array>"u"?a:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":typeof WeakMap>"u"?a:WeakMap,"$ %WeakMapPrototype%":typeof WeakMap>"u"?a:WeakMap.prototype,"$ %WeakSet%":typeof WeakSet>"u"?a:WeakSet,"$ %WeakSetPrototype%":typeof WeakSet>"u"?a:WeakSet.prototype};o.exports=function(_,E){if(arguments.length>1&&typeof E!="boolean")throw new TypeError('"allowMissing" argument must be a boolean');var w="$ "+_;if(!(w in v))throw new SyntaxError("intrinsic "+_+" does not exist!");if(typeof v[w]>"u"&&!E)throw new TypeError("intrinsic "+_+" exists, but is not available. Please file an issue!");return v[w]}},{}],15:[function(i,o,l){var a=i("./GetIntrinsic"),u=a("%Object%"),h=a("%TypeError%"),f=a("%String%"),d=i("./helpers/assertRecord"),m=i("./helpers/isNaN"),g=i("./helpers/isFinite"),x=i("./helpers/sign"),v=i("./helpers/mod"),A=i("is-callable"),_=i("es-to-primitive/es5"),E=i("has"),w={ToPrimitive:_,ToBoolean:function(T){return!!T},ToNumber:function(T){return+T},ToInteger:function(T){var R=this.ToNumber(T);return m(R)?0:R===0||!g(R)?R:x(R)*Math.floor(Math.abs(R))},ToInt32:function(T){return this.ToNumber(T)>>0},ToUint32:function(T){return this.ToNumber(T)>>>0},ToUint16:function(T){var R=this.ToNumber(T);if(m(R)||R===0||!g(R))return 0;var L=x(R)*Math.floor(Math.abs(R));return v(L,65536)},ToString:function(T){return f(T)},ToObject:function(T){return this.CheckObjectCoercible(T),u(T)},CheckObjectCoercible:function(T,R){if(T==null)throw new h(R||"Cannot call method on "+T);return T},IsCallable:A,SameValue:function(T,R){return T===R?T===0?1/T===1/R:!0:m(T)&&m(R)},Type:function(T){if(T===null)return"Null";if(typeof T>"u")return"Undefined";if(typeof T=="function"||typeof T=="object")return"Object";if(typeof T=="number")return"Number";if(typeof T=="boolean")return"Boolean";if(typeof T=="string")return"String"},IsPropertyDescriptor:function(T){if(this.Type(T)!=="Object")return!1;var R={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var L in T)if(E(T,L)&&!R[L])return!1;var I=E(T,"[[Value]]"),N=E(T,"[[Get]]")||E(T,"[[Set]]");if(I&&N)throw new h("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(T){return!(typeof T>"u"||(d(this,"Property Descriptor","Desc",T),!E(T,"[[Get]]")&&!E(T,"[[Set]]")))},IsDataDescriptor:function(T){return!(typeof T>"u"||(d(this,"Property Descriptor","Desc",T),!E(T,"[[Value]]")&&!E(T,"[[Writable]]")))},IsGenericDescriptor:function(T){return typeof T>"u"?!1:(d(this,"Property Descriptor","Desc",T),!this.IsAccessorDescriptor(T)&&!this.IsDataDescriptor(T))},FromPropertyDescriptor:function(T){if(typeof T>"u")return T;if(d(this,"Property Descriptor","Desc",T),this.IsDataDescriptor(T))return{value:T["[[Value]]"],writable:!!T["[[Writable]]"],enumerable:!!T["[[Enumerable]]"],configurable:!!T["[[Configurable]]"]};if(this.IsAccessorDescriptor(T))return{get:T["[[Get]]"],set:T["[[Set]]"],enumerable:!!T["[[Enumerable]]"],configurable:!!T["[[Configurable]]"]};throw new h("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(T){if(this.Type(T)!=="Object")throw new h("ToPropertyDescriptor requires an object");var R={};if(E(T,"enumerable")&&(R["[[Enumerable]]"]=this.ToBoolean(T.enumerable)),E(T,"configurable")&&(R["[[Configurable]]"]=this.ToBoolean(T.configurable)),E(T,"value")&&(R["[[Value]]"]=T.value),E(T,"writable")&&(R["[[Writable]]"]=this.ToBoolean(T.writable)),E(T,"get")){var L=T.get;if(typeof L<"u"&&!this.IsCallable(L))throw new TypeError("getter must be a function");R["[[Get]]"]=L}if(E(T,"set")){var I=T.set;if(typeof I<"u"&&!this.IsCallable(I))throw new h("setter must be a function");R["[[Set]]"]=I}if((E(R,"[[Get]]")||E(R,"[[Set]]"))&&(E(R,"[[Value]]")||E(R,"[[Writable]]")))throw new h("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return R}};o.exports=w},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(i,o,l){var a=i("../GetIntrinsic"),u=a("%TypeError%"),h=a("%SyntaxError%"),f=i("has"),d={"Property Descriptor":function(g,x){if(g.Type(x)!=="Object")return!1;var v={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var A in x)if(f(x,A)&&!v[A])return!1;var _=f(x,"[[Value]]"),E=f(x,"[[Get]]")||f(x,"[[Set]]");if(_&&E)throw new u("Property Descriptors may not be both accessor and data descriptors");return!0}};o.exports=function(g,x,v,A){var _=d[x];if(typeof _!="function")throw new h("unknown record type: "+x);if(!_(g,A))throw new u(v+" must be a "+x);console.log(_(g,A),A)}},{"../GetIntrinsic":14,has:28}],17:[function(i,o,l){var a=Number.isNaN||function(u){return u!==u};o.exports=Number.isFinite||function(u){return typeof u=="number"&&!a(u)&&u!==1/0&&u!==-1/0}},{}],18:[function(i,o,l){o.exports=Number.isNaN||function(u){return u!==u}},{}],19:[function(i,o,l){o.exports=function(u,h){var f=u%h;return Math.floor(f>=0?f:f+h)}},{}],20:[function(i,o,l){o.exports=function(u){return u>=0?1:-1}},{}],21:[function(i,o,l){var a=Object.prototype.toString,u=i("./helpers/isPrimitive"),h=i("is-callable"),f={"[[DefaultValue]]":function(d){var m;if(arguments.length>1?m=arguments[1]:m=a.call(d)==="[object Date]"?String:Number,m===String||m===Number){var g=m===String?["toString","valueOf"]:["valueOf","toString"],x,v;for(v=0;v<g.length;++v)if(h(d[g[v]])&&(x=d[g[v]](),u(x)))return x;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};o.exports=function(m){return u(m)?m:arguments.length>1?f["[[DefaultValue]]"](m,arguments[1]):f["[[DefaultValue]]"](m)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(i,o,l){o.exports=function(u){return u===null||typeof u!="function"&&typeof u!="object"}},{}],23:[function(i,o,l){var a=i("dtype");o.exports=u;function u(h,f,d){if(!h)throw new TypeError("must specify data as first parameter");if(d=+(d||0)|0,Array.isArray(h)&&h[0]&&typeof h[0][0]=="number"){var m=h[0].length,g=h.length*m,x,v,A,_;(!f||typeof f=="string")&&(f=new(a(f||"float32"))(g+d));var E=f.length-d;if(g!==E)throw new Error("source length "+g+" ("+m+"x"+h.length+") does not match destination length "+E);for(x=0,A=d;x<h.length;x++)for(v=0;v<m;v++)f[A++]=h[x][v]===null?NaN:h[x][v]}else if(!f||typeof f=="string"){var w=a(f||"float32");if(Array.isArray(h)||f==="array")for(f=new w(h.length+d),x=0,A=d,_=f.length;A<_;A++,x++)f[A]=h[x]===null?NaN:h[x];else d===0?f=new w(h):(f=new w(h.length+d),f.set(h,d))}else f.set(h,d);return f}},{dtype:13}],24:[function(i,o,l){var a=i("is-callable"),u=Object.prototype.toString,h=Object.prototype.hasOwnProperty,f=function(v,A,_){for(var E=0,w=v.length;E<w;E++)h.call(v,E)&&(_==null?A(v[E],E,v):A.call(_,v[E],E,v))},d=function(v,A,_){for(var E=0,w=v.length;E<w;E++)_==null?A(v.charAt(E),E,v):A.call(_,v.charAt(E),E,v)},m=function(v,A,_){for(var E in v)h.call(v,E)&&(_==null?A(v[E],E,v):A.call(_,v[E],E,v))},g=function(v,A,_){if(!a(A))throw new TypeError("iterator must be a function");var E;arguments.length>=3&&(E=_),u.call(v)==="[object Array]"?f(v,A,E):typeof v=="string"?d(v,A,E):m(v,A,E)};o.exports=g},{"is-callable":32}],25:[function(i,o,l){var a="Function.prototype.bind called on incompatible ",u=Array.prototype.slice,h=Object.prototype.toString,f="[object Function]";o.exports=function(m){var g=this;if(typeof g!="function"||h.call(g)!==f)throw new TypeError(a+g);for(var x=u.call(arguments,1),v,A=function(){if(this instanceof v){var T=g.apply(this,x.concat(u.call(arguments)));return Object(T)===T?T:this}else return g.apply(m,x.concat(u.call(arguments)))},_=Math.max(0,g.length-x.length),E=[],w=0;w<_;w++)E.push("$"+w);if(v=Function("binder","return function ("+E.join(",")+"){ return binder.apply(this,arguments); }")(A),g.prototype){var S=function(){};S.prototype=g.prototype,v.prototype=new S,S.prototype=null}return v}},{}],26:[function(i,o,l){var a=i("./implementation");o.exports=Function.prototype.bind||a},{"./implementation":25}],27:[function(i,o,l){(function(a){var u;typeof window<"u"?u=window:typeof a<"u"?u=a:typeof self<"u"?u=self:u={},o.exports=u}).call(this,typeof ks<"u"?ks:typeof self<"u"?self:typeof window<"u"?window:{})},{}],28:[function(i,o,l){var a=i("function-bind");o.exports=a.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(i,o,l){l.read=function(a,u,h,f,d){var m,g,x=d*8-f-1,v=(1<<x)-1,A=v>>1,_=-7,E=h?d-1:0,w=h?-1:1,S=a[u+E];for(E+=w,m=S&(1<<-_)-1,S>>=-_,_+=x;_>0;m=m*256+a[u+E],E+=w,_-=8);for(g=m&(1<<-_)-1,m>>=-_,_+=f;_>0;g=g*256+a[u+E],E+=w,_-=8);if(m===0)m=1-A;else{if(m===v)return g?NaN:(S?-1:1)*(1/0);g=g+Math.pow(2,f),m=m-A}return(S?-1:1)*g*Math.pow(2,m-f)},l.write=function(a,u,h,f,d,m){var g,x,v,A=m*8-d-1,_=(1<<A)-1,E=_>>1,w=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=f?0:m-1,T=f?1:-1,R=u<0||u===0&&1/u<0?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(x=isNaN(u)?1:0,g=_):(g=Math.floor(Math.log(u)/Math.LN2),u*(v=Math.pow(2,-g))<1&&(g--,v*=2),g+E>=1?u+=w/v:u+=w*Math.pow(2,1-E),u*v>=2&&(g++,v/=2),g+E>=_?(x=0,g=_):g+E>=1?(x=(u*v-1)*Math.pow(2,d),g=g+E):(x=u*Math.pow(2,E-1)*Math.pow(2,d),g=0));d>=8;a[h+S]=x&255,S+=T,x/=256,d-=8);for(g=g<<d|x,A+=d;A>0;a[h+S]=g&255,S+=T,g/=256,A-=8);a[h+S-T]|=R*128}},{}],30:[function(i,o,l){typeof Object.create=="function"?o.exports=function(u,h){h&&(u.super_=h,u.prototype=Object.create(h.prototype,{constructor:{value:u,enumerable:!1,writable:!0,configurable:!0}}))}:o.exports=function(u,h){if(h){u.super_=h;var f=function(){};f.prototype=h.prototype,u.prototype=new f,u.prototype.constructor=u}}},{}],31:[function(i,o,l){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */o.exports=function(h){return h!=null&&(a(h)||u(h)||!!h._isBuffer)};function a(h){return!!h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h)}function u(h){return typeof h.readFloatLE=="function"&&typeof h.slice=="function"&&a(h.slice(0,0))}},{}],32:[function(i,o,l){var a=Function.prototype.toString,u=/^\s*class\b/,h=function(A){try{var _=a.call(A);return u.test(_)}catch{return!1}},f=function(A){try{return h(A)?!1:(a.call(A),!0)}catch{return!1}},d=Object.prototype.toString,m="[object Function]",g="[object GeneratorFunction]",x=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol";o.exports=function(A){if(!A||typeof A!="function"&&typeof A!="object")return!1;if(typeof A=="function"&&!A.prototype)return!0;if(x)return f(A);if(h(A))return!1;var _=d.call(A);return _===m||_===g}},{}],33:[function(i,o,l){o.exports=u;var a=Object.prototype.toString;function u(h){var f=a.call(h);return f==="[object Function]"||typeof h=="function"&&f!=="[object RegExp]"||typeof window<"u"&&(h===window.setTimeout||h===window.alert||h===window.confirm||h===window.prompt)}},{}],34:[function(i,o,l){o.exports=function(a){var u=typeof a;return a!==null&&(u==="object"||u==="function")}},{}],35:[function(i,o,l){var a={}.toString;o.exports=Array.isArray||function(u){return a.call(u)=="[object Array]"}},{}],36:[function(i,o,l){var a=i("word-wrapper"),u=i("xtend"),h=i("as-number"),f=["x","e","a","o","n","s","r","c","u","m","v","w","z"],d=["m","w"],m=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],g="	".charCodeAt(0),x=" ".charCodeAt(0),v=0,A=1,_=2;o.exports=function(le){return new E(le)};function E(q){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(q)}E.prototype.update=function(q){if(q=u({measure:this._measure},q),this._opt=q,this._opt.tabSize=h(this._opt.tabSize,4),!q.font)throw new Error("must provide a valid bitmap font");var le=this.glyphs,ne=q.text||"",D=q.font;this._setupSpaceGlyphs(D);var O=a.lines(ne,q),k=q.width||0;le.length=0;var z=O.reduce(function(Ne,He){return Math.max(Ne,He.width,k)},0),X=0,Z=0,ie=h(q.lineHeight,D.common.lineHeight),se=D.common.base,ue=ie-se,ye=q.letterSpacing||0,Ce=ie*O.length-ue,ke=B(this._opt.align);Z-=Ce,this._width=z,this._height=Ce,this._descender=ie-se,this._baseline=se,this._xHeight=R(D),this._capHeight=I(D),this._lineHeight=ie,this._ascender=ie-ue-this._xHeight;var Oe=this;O.forEach(function(Ne,He){for(var Qe=Ne.start,St=Ne.end,bt=Ne.width,Jt,sn=Qe;sn<St;sn++){var Se=ne.charCodeAt(sn),qe=Oe.getGlyph(D,Se);if(qe){Jt&&(X+=N(D,Jt.id,qe.id));var Ue=X;ke===A?Ue+=(z-bt)/2:ke===_&&(Ue+=z-bt),le.push({position:[Ue,Z],data:qe,index:sn,line:He}),X+=qe.xadvance+ye,Jt=qe}}Z+=ie,X=0}),this._linesTotal=O.length},E.prototype._setupSpaceGlyphs=function(q){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!q.chars||q.chars.length===0)){var le=T(q,x)||L(q)||q.chars[0],ne=this._opt.tabSize*le.xadvance;this._fallbackSpaceGlyph=le,this._fallbackTabGlyph=u(le,{x:0,y:0,xadvance:ne,id:g,xoffset:0,yoffset:0,width:0,height:0})}},E.prototype.getGlyph=function(q,le){var ne=T(q,le);return ne||(le===g?this._fallbackTabGlyph:le===x?this._fallbackSpaceGlyph:null)},E.prototype.computeMetrics=function(q,le,ne,D){var O=this._opt.letterSpacing||0,k=this._opt.font,z=0,X=0,Z=0,ie,se;if(!k.chars||k.chars.length===0)return{start:le,end:le,width:0};ne=Math.min(q.length,ne);for(var ue=le;ue<ne;ue++){var ye=q.charCodeAt(ue),ie=this.getGlyph(k,ye);if(ie){ie.xoffset;var Ce=se?N(k,se.id,ie.id):0;z+=Ce;var ke=z+ie.xadvance+O,Oe=z+ie.width;if(Oe>=D||ke>=D)break;z=ke,X=Oe,se=ie}Z++}return se&&(X+=se.xoffset),{start:le,end:le+Z,width:X}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(w);function w(q){Object.defineProperty(E.prototype,q,{get:S(q),configurable:!0})}function S(q){return new Function(["return function "+q+"() {","  return this._"+q,"}"].join(`
`))()}function T(q,le){if(!q.chars||q.chars.length===0)return null;var ne=H(q.chars,le);return ne>=0?q.chars[ne]:null}function R(q){for(var le=0;le<f.length;le++){var ne=f[le].charCodeAt(0),D=H(q.chars,ne);if(D>=0)return q.chars[D].height}return 0}function L(q){for(var le=0;le<d.length;le++){var ne=d[le].charCodeAt(0),D=H(q.chars,ne);if(D>=0)return q.chars[D]}return 0}function I(q){for(var le=0;le<m.length;le++){var ne=m[le].charCodeAt(0),D=H(q.chars,ne);if(D>=0)return q.chars[D].height}return 0}function N(q,le,ne){if(!q.kernings||q.kernings.length===0)return 0;for(var D=q.kernings,O=0;O<D.length;O++){var k=D[O];if(k.first===le&&k.second===ne)return k.amount}return 0}function B(q){return q==="center"?A:q==="right"?_:v}function H(q,le,ne){ne=ne||0;for(var D=ne;D<q.length;D++)if(q[D].id===le)return D;return-1}},{"as-number":2,"word-wrapper":70,xtend:73}],37:[function(i,o,l){(function(a){var u=i("xhr"),h=function(){},f=i("parse-bmfont-ascii"),d=i("parse-bmfont-xml"),m=i("parse-bmfont-binary"),g=i("./lib/is-binary"),x=i("xtend"),v=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();o.exports=function(E,w){w=typeof w=="function"?w:h,typeof E=="string"?E={uri:E}:E||(E={});var S=E.binary;S&&(E=_(E)),u(E,function(T,R,L){if(T)return w(T);if(!/^2/.test(R.statusCode))return w(new Error("http status code: "+R.statusCode));if(!L)return w(new Error("no body result"));var I=!1;if(A(L)){var N=new Uint8Array(L);L=new a(N,"binary")}g(L)&&(I=!0,typeof L=="string"&&(L=new a(L,"binary"))),I||(a.isBuffer(L)&&(L=L.toString(E.encoding)),L=L.trim());var B;try{var H=R.headers["content-type"];I?B=m(L):/json/.test(H)||L.charAt(0)==="{"?B=JSON.parse(L):/xml/.test(H)||L.charAt(0)==="<"?B=d(L):B=f(L)}catch(q){w(new Error("error parsing font "+q.message)),w=h}w(null,B)})};function A(E){var w=Object.prototype.toString;return w.call(E)==="[object ArrayBuffer]"}function _(E){if(v)return x(E,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest>"u")throw new Error("your browser does not support XHR loading");var w=new self.XMLHttpRequest;return w.overrideMimeType("text/plain; charset=x-user-defined"),x({xhr:w},E)}}).call(this,i("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:71,xtend:73}],38:[function(i,o,l){(function(a){var u=i("buffer-equal"),h=new a([66,77,70,3]);o.exports=function(f){return typeof f=="string"?f.substring(0,3)==="BMF":f.length>4&&u(f.slice(0,4),h)}}).call(this,i("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(i,o,l){var a=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable;function f(m){if(m==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(m)}function d(){try{if(!Object.assign)return!1;var m=new String("abc");if(m[5]="de",Object.getOwnPropertyNames(m)[0]==="5")return!1;for(var g={},x=0;x<10;x++)g["_"+String.fromCharCode(x)]=x;var v=Object.getOwnPropertyNames(g).map(function(_){return g[_]});if(v.join("")!=="0123456789")return!1;var A={};return"abcdefghijklmnopqrst".split("").forEach(function(_){A[_]=_}),Object.keys(Object.assign({},A)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}o.exports=d()?Object.assign:function(m,g){for(var x,v=f(m),A,_=1;_<arguments.length;_++){x=Object(arguments[_]);for(var E in x)u.call(x,E)&&(v[E]=x[E]);if(a){A=a(x);for(var w=0;w<A.length;w++)h.call(x,A[w])&&(v[A[w]]=x[A[w]])}}return v}},{}],40:[function(i,o,l){var a;if(!Object.keys){var u=Object.prototype.hasOwnProperty,h=Object.prototype.toString,f=i("./isArguments"),d=Object.prototype.propertyIsEnumerable,m=!d.call({toString:null},"toString"),g=d.call(function(){},"prototype"),x=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],v=function(w){var S=w.constructor;return S&&S.prototype===w},A={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},_=function(){if(typeof window>"u")return!1;for(var w in window)try{if(!A["$"+w]&&u.call(window,w)&&window[w]!==null&&typeof window[w]=="object")try{v(window[w])}catch{return!0}}catch{return!0}return!1}(),E=function(w){if(typeof window>"u"||!_)return v(w);try{return v(w)}catch{return!1}};a=function(S){var T=S!==null&&typeof S=="object",R=h.call(S)==="[object Function]",L=f(S),I=T&&h.call(S)==="[object String]",N=[];if(!T&&!R&&!L)throw new TypeError("Object.keys called on a non-object");var B=g&&R;if(I&&S.length>0&&!u.call(S,0))for(var H=0;H<S.length;++H)N.push(String(H));if(L&&S.length>0)for(var q=0;q<S.length;++q)N.push(String(q));else for(var le in S)!(B&&le==="prototype")&&u.call(S,le)&&N.push(String(le));if(m)for(var ne=E(S),D=0;D<x.length;++D)!(ne&&x[D]==="constructor")&&u.call(S,x[D])&&N.push(x[D]);return N}}o.exports=a},{"./isArguments":42}],41:[function(i,o,l){var a=Array.prototype.slice,u=i("./isArguments"),h=Object.keys,f=h?function(g){return h(g)}:i("./implementation"),d=Object.keys;f.shim=function(){if(Object.keys){var g=function(){var x=Object.keys(arguments);return x&&x.length===arguments.length}(1,2);g||(Object.keys=function(v){return u(v)?d(a.call(v)):d(v)})}else Object.keys=f;return Object.keys||f},o.exports=f},{"./implementation":40,"./isArguments":42}],42:[function(i,o,l){var a=Object.prototype.toString;o.exports=function(h){var f=a.call(h),d=f==="[object Arguments]";return d||(d=f!=="[object Array]"&&h!==null&&typeof h=="object"&&typeof h.length=="number"&&h.length>=0&&a.call(h.callee)==="[object Function]"),d}},{}],43:[function(i,o,l){o.exports=function(d){if(!d)throw new Error("no data provided");d=d.toString().trim();var m={pages:[],chars:[],kernings:[]},g=d.split(/\r\n?|\n/g);if(g.length===0)throw new Error("no data in BMFont file");for(var x=0;x<g.length;x++){var v=a(g[x],x);if(!!v)if(v.key==="page"){if(typeof v.data.id!="number")throw new Error("malformed file at line "+x+" -- needs page id=N");if(typeof v.data.file!="string")throw new Error("malformed file at line "+x+' -- needs page file="path"');m.pages[v.data.id]=v.data.file}else v.key==="chars"||v.key==="kernings"||(v.key==="char"?m.chars.push(v.data):v.key==="kerning"?m.kernings.push(v.data):m[v.key]=v.data)}return m};function a(f,d){if(f=f.replace(/\t+/g," ").trim(),!f)return null;var m=f.indexOf(" ");if(m===-1)throw new Error("no named row at line "+d);var g=f.substring(0,m);f=f.substring(m+1),f=f.replace(/letter=[\'\"]\S+[\'\"]/gi,""),f=f.split("="),f=f.map(function(E){return E.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var x=[],v=0;v<f.length;v++){var A=f[v];v===0?x.push({key:A[0],data:""}):v===f.length-1?x[x.length-1].data=u(A[0]):(x[x.length-1].data=u(A[0]),x.push({key:A[1],data:""}))}var _={key:g,data:{}};return x.forEach(function(E){_.data[E.key]=E.data}),_}function u(f){return!f||f.length===0?"":f.indexOf('"')===0||f.indexOf("'")===0?f.substring(1,f.length-1):f.indexOf(",")!==-1?h(f):parseInt(f,10)}function h(f){return f.split(",").map(function(d){return parseInt(d,10)})}},{}],44:[function(i,o,l){var a=[66,77,70];o.exports=function(_){if(_.length<6)throw new Error("invalid buffer length for BMFont");var E=a.every(function(L,I){return _.readUInt8(I)===L});if(!E)throw new Error("BMFont missing BMF byte header");var w=3,S=_.readUInt8(w++);if(S>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var T={kernings:[],chars:[]},R=0;R<5;R++)w+=u(T,_,w);return T};function u(A,_,E){if(E>_.length-1)return 0;var w=_.readUInt8(E++),S=_.readInt32LE(E);switch(E+=4,w){case 1:A.info=h(_,E);break;case 2:A.common=f(_,E);break;case 3:A.pages=d(_,E,S);break;case 4:A.chars=m(_,E,S);break;case 5:A.kernings=g(_,E,S);break}return 5+S}function h(A,_){var E={};E.size=A.readInt16LE(_);var w=A.readUInt8(_+2);return E.smooth=w>>7&1,E.unicode=w>>6&1,E.italic=w>>5&1,E.bold=w>>4&1,w>>3&1&&(E.fixedHeight=1),E.charset=A.readUInt8(_+3)||"",E.stretchH=A.readUInt16LE(_+4),E.aa=A.readUInt8(_+6),E.padding=[A.readInt8(_+7),A.readInt8(_+8),A.readInt8(_+9),A.readInt8(_+10)],E.spacing=[A.readInt8(_+11),A.readInt8(_+12)],E.outline=A.readUInt8(_+13),E.face=v(A,_+14),E}function f(A,_){var E={};return E.lineHeight=A.readUInt16LE(_),E.base=A.readUInt16LE(_+2),E.scaleW=A.readUInt16LE(_+4),E.scaleH=A.readUInt16LE(_+6),E.pages=A.readUInt16LE(_+8),A.readUInt8(_+10),E.packed=0,E.alphaChnl=A.readUInt8(_+11),E.redChnl=A.readUInt8(_+12),E.greenChnl=A.readUInt8(_+13),E.blueChnl=A.readUInt8(_+14),E}function d(A,_,E){for(var w=[],S=x(A,_),T=S.length+1,R=E/T,L=0;L<R;L++)w[L]=A.slice(_,_+S.length).toString("utf8"),_+=T;return w}function m(A,_,E){for(var w=[],S=E/20,T=0;T<S;T++){var R={},L=T*20;R.id=A.readUInt32LE(_+0+L),R.x=A.readUInt16LE(_+4+L),R.y=A.readUInt16LE(_+6+L),R.width=A.readUInt16LE(_+8+L),R.height=A.readUInt16LE(_+10+L),R.xoffset=A.readInt16LE(_+12+L),R.yoffset=A.readInt16LE(_+14+L),R.xadvance=A.readInt16LE(_+16+L),R.page=A.readUInt8(_+18+L),R.chnl=A.readUInt8(_+19+L),w[T]=R}return w}function g(A,_,E){for(var w=[],S=E/10,T=0;T<S;T++){var R={},L=T*10;R.first=A.readUInt32LE(_+0+L),R.second=A.readUInt32LE(_+4+L),R.amount=A.readInt16LE(_+8+L),w[T]=R}return w}function x(A,_){for(var E=_;E<A.length&&A[E]!==0;E++);return A.slice(_,E)}function v(A,_){return x(A,_).toString("utf8")}},{}],45:[function(i,o,l){var a=i("./parse-attribs"),u=i("xml-parse-from-string"),h={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};o.exports=function(x){x=x.toString();var v=u(x),A={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(L){var I=v.getElementsByTagName(L)[0];I&&(A[L]=a(f(I)))});var _=v.getElementsByTagName("pages")[0];if(!_)throw new Error("malformed file -- no <pages> element");for(var E=_.getElementsByTagName("page"),w=0;w<E.length;w++){var S=E[w],T=parseInt(S.getAttribute("id"),10),R=S.getAttribute("file");if(isNaN(T))throw new Error('malformed file -- page "id" attribute is NaN');if(!R)throw new Error('malformed file -- needs page "file" attribute');A.pages[parseInt(T,10)]=R}return["chars","kernings"].forEach(function(L){var I=v.getElementsByTagName(L)[0];if(!!I)for(var N=L.substring(0,L.length-1),B=I.getElementsByTagName(N),H=0;H<B.length;H++){var q=B[H];A[L].push(a(f(q)))}}),A};function f(g){var x=d(g);return x.reduce(function(v,A){var _=m(A.nodeName);return v[_]=A.nodeValue,v},{})}function d(g){for(var x=[],v=0;v<g.attributes.length;v++)x.push(g.attributes[v]);return x}function m(g){return h[g.toLowerCase()]||g}},{"./parse-attribs":46,"xml-parse-from-string":72}],46:[function(i,o,l){var a="chasrset";o.exports=function(f){a in f&&(f.charset=f[a],delete f[a]);for(var d in f)d==="face"||d==="charset"||(d==="padding"||d==="spacing"?f[d]=u(f[d]):f[d]=parseInt(f[d],10));return f};function u(h){return h.split(",").map(function(f){return parseInt(f,10)})}},{}],47:[function(i,o,l){var a=i("string.prototype.trim"),u=i("for-each"),h=function(f){return Object.prototype.toString.call(f)==="[object Array]"};o.exports=function(f){if(!f)return{};var d={};return u(a(f).split(`
`),function(m){var g=m.indexOf(":"),x=a(m.slice(0,g)).toLowerCase(),v=a(m.slice(g+1));typeof d[x]>"u"?d[x]=v:h(d[x])?d[x].push(v):d[x]=[d[x],v]}),d}},{"for-each":24,"string.prototype.trim":53}],48:[function(i,o,l){(function(a){var u=a.performance||{},h=function(){for(var f=["now","webkitNow","msNow","mozNow","oNow"];f.length;){var d=f.shift();if(d in u)return u[d].bind(u)}var m=Date.now||function(){return new Date().getTime()},g=(u.timing||{}).navigationStart||m();return function(){return m()-g}}();h.performanceNow=u.now,h.noConflict=function(){u.now=h.performanceNow},h.conflict=function(){u.now=h},h.conflict(),o.exports=h}).call(this,typeof ks<"u"?ks:typeof self<"u"?self:typeof window<"u"?window:{})},{}],49:[function(i,o,l){var a=o.exports={},u,h;function f(){throw new Error("setTimeout has not been defined")}function d(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?u=setTimeout:u=f}catch{u=f}try{typeof clearTimeout=="function"?h=clearTimeout:h=d}catch{h=d}})();function m(R){if(u===setTimeout)return setTimeout(R,0);if((u===f||!u)&&setTimeout)return u=setTimeout,setTimeout(R,0);try{return u(R,0)}catch{try{return u.call(null,R,0)}catch{return u.call(this,R,0)}}}function g(R){if(h===clearTimeout)return clearTimeout(R);if((h===d||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(R);try{return h(R)}catch{try{return h.call(null,R)}catch{return h.call(this,R)}}}var x=[],v=!1,A,_=-1;function E(){!v||!A||(v=!1,A.length?x=A.concat(x):_=-1,x.length&&w())}function w(){if(!v){var R=m(E);v=!0;for(var L=x.length;L;){for(A=x,x=[];++_<L;)A&&A[_].run();_=-1,L=x.length}A=null,v=!1,g(R)}}a.nextTick=function(R){var L=new Array(arguments.length-1);if(arguments.length>1)for(var I=1;I<arguments.length;I++)L[I-1]=arguments[I];x.push(new S(R,L)),x.length===1&&!v&&m(w)};function S(R,L){this.fun=R,this.array=L}S.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={};function T(){}a.on=T,a.addListener=T,a.once=T,a.off=T,a.removeListener=T,a.removeAllListeners=T,a.emit=T,a.prependListener=T,a.prependOnceListener=T,a.listeners=function(R){return[]},a.binding=function(R){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(R){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],50:[function(i,o,l){(function(a){(function(u){var h=setTimeout,f=typeof a=="function"&&a||function(S){h(S,1)};function d(S,T){return function(){S.apply(T,arguments)}}var m=Array.isArray||function(S){return Object.prototype.toString.call(S)==="[object Array]"};function g(S){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof S!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],w(S,d(v,this),d(A,this))}function x(S){var T=this;if(this._state===null){this._deferreds.push(S);return}f(function(){var R=T._state?S.onFulfilled:S.onRejected;if(R===null){(T._state?S.resolve:S.reject)(T._value);return}var L;try{L=R(T._value)}catch(I){S.reject(I);return}S.resolve(L)})}function v(S){try{if(S===this)throw new TypeError("A promise cannot be resolved with itself.");if(S&&(typeof S=="object"||typeof S=="function")){var T=S.then;if(typeof T=="function"){w(d(T,S),d(v,this),d(A,this));return}}this._state=!0,this._value=S,_.call(this)}catch(R){A.call(this,R)}}function A(S){this._state=!1,this._value=S,_.call(this)}function _(){for(var S=0,T=this._deferreds.length;S<T;S++)x.call(this,this._deferreds[S]);this._deferreds=null}function E(S,T,R,L){this.onFulfilled=typeof S=="function"?S:null,this.onRejected=typeof T=="function"?T:null,this.resolve=R,this.reject=L}function w(S,T,R){var L=!1;try{S(function(I){L||(L=!0,T(I))},function(I){L||(L=!0,R(I))})}catch(I){if(L)return;L=!0,R(I)}}g.prototype.catch=function(S){return this.then(null,S)},g.prototype.then=function(S,T){var R=this;return new g(function(L,I){x.call(R,new E(S,T,L,I))})},g.all=function(){var S=Array.prototype.slice.call(arguments.length===1&&m(arguments[0])?arguments[0]:arguments);return new g(function(T,R){if(S.length===0)return T([]);var L=S.length;function I(B,H){try{if(H&&(typeof H=="object"||typeof H=="function")){var q=H.then;if(typeof q=="function"){q.call(H,function(le){I(B,le)},R);return}}S[B]=H,--L===0&&T(S)}catch(le){R(le)}}for(var N=0;N<S.length;N++)I(N,S[N])})},g.resolve=function(S){return S&&typeof S=="object"&&S.constructor===g?S:new g(function(T){T(S)})},g.reject=function(S){return new g(function(T,R){R(S)})},g.race=function(S){return new g(function(T,R){for(var L=0,I=S.length;L<I;L++)S[L].then(T,R)})},g._setImmediateFn=function(T){f=T},typeof o<"u"&&o.exports?o.exports=g:u.Promise||(u.Promise=g)})(this)}).call(this,i("timers").setImmediate)},{timers:68}],51:[function(i,o,l){var a=i("dtype"),u=i("an-array"),h=i("is-buffer"),f=[0,2,3],d=[2,1,3];o.exports=function(g,x){(!g||!(u(g)||h(g)))&&(x=g||{},g=null),typeof x=="number"?x={count:x}:x=x||{};for(var v=typeof x.type=="string"?x.type:"uint16",A=typeof x.count=="number"?x.count:1,_=x.start||0,E=x.clockwise!==!1?f:d,w=E[0],S=E[1],T=E[2],R=A*6,L=g||new(a(v))(R),I=0,N=0;I<R;I+=6,N+=4){var B=I+_;L[B+0]=N+0,L[B+1]=N+1,L[B+2]=N+2,L[B+3]=N+w,L[B+4]=N+S,L[B+5]=N+T}return L}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(i,o,l){var a=i("function-bind"),u=i("es-abstract/es5"),h=a.call(Function.call,String.prototype.replace),f=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,d=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;o.exports=function(){var g=u.ToString(u.CheckObjectCoercible(this));return h(h(g,f,""),d,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(i,o,l){var a=i("function-bind"),u=i("define-properties"),h=i("./implementation"),f=i("./polyfill"),d=i("./shim"),m=a.call(Function.call,f());u(m,{getPolyfill:f,implementation:h,shim:d}),o.exports=m},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(i,o,l){var a=i("./implementation"),u="\u200B";o.exports=function(){return String.prototype.trim&&u.trim()===u?String.prototype.trim:a}},{"./implementation":52}],55:[function(i,o,l){var a=i("define-properties"),u=i("./polyfill");o.exports=function(){var f=u();return a(String.prototype,{trim:f},{trim:function(){return String.prototype.trim!==f}}),f}},{"./polyfill":54,"define-properties":11}],56:[function(i,o,l){var a={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},u={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},h=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],f={CSS:{},springs:{}};function d(we,We,et){return Math.min(Math.max(we,We),et)}function m(we,We){return we.indexOf(We)>-1}function g(we,We){return we.apply(null,We)}var x=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,v=/^rgb/,A=/^hsl/,_={arr:function(we){return Array.isArray(we)},obj:function(we){return m(Object.prototype.toString.call(we),"Object")},pth:function(we){return _.obj(we)&&we.hasOwnProperty("totalLength")},svg:function(we){return we instanceof SVGElement},inp:function(we){return we instanceof HTMLInputElement},dom:function(we){return we.nodeType||_.svg(we)},str:function(we){return typeof we=="string"},fnc:function(we){return typeof we=="function"},und:function(we){return typeof we>"u"},hex:function(we){return x.test(we)},rgb:function(we){return v.test(we)},hsl:function(we){return A.test(we)},col:function(we){return _.hex(we)||_.rgb(we)||_.hsl(we)},key:function(we){return!a.hasOwnProperty(we)&&!u.hasOwnProperty(we)&&we!=="targets"&&we!=="keyframes"}},E=/\(([^)]+)\)/;function w(we){var We=E.exec(we);return We?We[1].split(",").map(function(et){return parseFloat(et)}):[]}function S(we,We){var et=w(we),mt=d(_.und(et[0])?1:et[0],.1,100),ot=d(_.und(et[1])?100:et[1],.1,100),Tt=d(_.und(et[2])?10:et[2],.1,100),zt=d(_.und(et[3])?0:et[3],.1,100),un=Math.sqrt(ot/mt),tn=Tt/(2*Math.sqrt(ot*mt)),Bt=tn<1?un*Math.sqrt(1-tn*tn):0,fn=1,ln=tn<1?(tn*un+-zt)/Bt:-zt+un;function Jn(di){var ri=We?We*di/1e3:di;return tn<1?ri=Math.exp(-ri*tn*un)*(fn*Math.cos(Bt*ri)+ln*Math.sin(Bt*ri)):ri=(fn+ln*ri)*Math.exp(-ri*un),di===0||di===1?di:1-ri}function hi(){var di=f.springs[we];if(di)return di;for(var ri=1/6,_i=0,ki=0;;)if(_i+=ri,Jn(_i)===1){if(ki++,ki>=16)break}else ki=0;var Ni=_i*ri*1e3;return f.springs[we]=Ni,Ni}return We?Jn:hi}function T(we,We){we===void 0&&(we=1),We===void 0&&(We=.5);var et=d(we,1,10),mt=d(We,.1,2);return function(ot){return ot===0||ot===1?ot:-et*Math.pow(2,10*(ot-1))*Math.sin((ot-1-mt/(Math.PI*2)*Math.asin(1/et))*(Math.PI*2)/mt)}}function R(we){return we===void 0&&(we=10),function(We){return Math.round(We*we)*(1/we)}}var L=function(){var we=11,We=1/(we-1);function et(fn,ln){return 1-3*ln+3*fn}function mt(fn,ln){return 3*ln-6*fn}function ot(fn){return 3*fn}function Tt(fn,ln,Jn){return((et(ln,Jn)*fn+mt(ln,Jn))*fn+ot(ln))*fn}function zt(fn,ln,Jn){return 3*et(ln,Jn)*fn*fn+2*mt(ln,Jn)*fn+ot(ln)}function un(fn,ln,Jn,hi,di){var ri,_i,ki=0;do _i=ln+(Jn-ln)/2,ri=Tt(_i,hi,di)-fn,ri>0?Jn=_i:ln=_i;while(Math.abs(ri)>1e-7&&++ki<10);return _i}function tn(fn,ln,Jn,hi){for(var di=0;di<4;++di){var ri=zt(ln,Jn,hi);if(ri===0)return ln;var _i=Tt(ln,Jn,hi)-fn;ln-=_i/ri}return ln}function Bt(fn,ln,Jn,hi){if(!(0<=fn&&fn<=1&&0<=Jn&&Jn<=1))return;var di=new Float32Array(we);if(fn!==ln||Jn!==hi)for(var ri=0;ri<we;++ri)di[ri]=Tt(ri*We,fn,Jn);function _i(ki){for(var Ni=0,Vn=1,gi=we-1;Vn!==gi&&di[Vn]<=ki;++Vn)Ni+=We;--Vn;var Xn=(ki-di[Vn])/(di[Vn+1]-di[Vn]),wr=Ni+Xn*We,Vi=zt(wr,fn,Jn);return Vi>=.001?tn(ki,wr,fn,Jn):Vi===0?wr:un(ki,Ni,Ni+We,fn,Jn)}return function(ki){return fn===ln&&Jn===hi||ki===0||ki===1?ki:Tt(_i(ki),ln,hi)}}return Bt}(),I=function(){var we=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],We={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],T],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(zt,un){return function(tn){return 1-T(zt,un)(1-tn)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(zt,un){return function(tn){return tn<.5?T(zt,un)(tn*2)/2:1-T(zt,un)(tn*-2+2)/2}}]},et={linear:[.25,.25,.75,.75]};for(var mt in We)for(var ot=0,Tt=We[mt].length;ot<Tt;ot++)et["ease"+mt+we[ot]]=We[mt][ot];return et}();function N(we,We){if(_.fnc(we))return we;var et=we.split("(")[0],mt=I[et],ot=w(we);switch(et){case"spring":return S(we,We);case"cubicBezier":return g(L,ot);case"steps":return g(R,ot);default:return _.fnc(mt)?g(mt,ot):g(L,mt)}}function B(we){try{var We=document.querySelectorAll(we);return We}catch{return}}var H=[];function q(we,We){for(var et=H,mt=we.length,ot=arguments.length>=2?arguments[1]:void 0,Tt=0;Tt<mt;Tt++)if(Tt in we){var zt=we[Tt];We.call(ot,zt,Tt,we)&&et.push(zt)}return H=we,H.length=0,et}function le(we,We){We||(We=[]);for(var et=0,mt=we.length;et<mt;et++){var ot=we[et];Array.isArray(ot)?le(ot,We):We.push(ot)}return We}function ne(we){return _.arr(we)?we:(_.str(we)&&(we=B(we)||we),we instanceof NodeList||we instanceof HTMLCollection?[].slice.call(we):[we])}function D(we,We){return we.some(function(et){return et===We})}function O(we){var We={};for(var et in we)We[et]=we[et];return We}function k(we,We){var et=O(we);for(var mt in we)et[mt]=We.hasOwnProperty(mt)?We[mt]:we[mt];return et}function z(we,We){var et=O(we);for(var mt in We)et[mt]=_.und(we[mt])?We[mt]:we[mt];return et}var X=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function Z(we){var We=X.exec(we);return We?"rgba("+We[1]+",1)":we}var ie=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,se=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function ue(we){var We=we.replace(ie,function(zt,un,tn,Bt){return un+un+tn+tn+Bt+Bt}),et=se.exec(We),mt=parseInt(et[1],16),ot=parseInt(et[2],16),Tt=parseInt(et[3],16);return"rgba("+mt+","+ot+","+Tt+",1)"}var ye=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,Ce=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function ke(we){var We=ye.exec(we)||Ce.exec(we),et=parseInt(We[1],10)/360,mt=parseInt(We[2],10)/100,ot=parseInt(We[3],10)/100,Tt=We[4]||1;function zt(Jn,hi,di){return di<0&&(di+=1),di>1&&(di-=1),di<1/6?Jn+(hi-Jn)*6*di:di<1/2?hi:di<2/3?Jn+(hi-Jn)*(2/3-di)*6:Jn}var un,tn,Bt;if(mt==0)un=tn=Bt=ot;else{var fn=ot<.5?ot*(1+mt):ot+mt-ot*mt,ln=2*ot-fn;un=zt(ln,fn,et+1/3),tn=zt(ln,fn,et),Bt=zt(ln,fn,et-1/3)}return"rgba("+un*255+","+tn*255+","+Bt*255+","+Tt+")"}function Oe(we){if(_.rgb(we))return Z(we);if(_.hex(we))return ue(we);if(_.hsl(we))return ke(we)}var Ne=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function He(we){var We=Ne.exec(we);if(We)return We[2]}function Qe(we){if(m(we,"translate")||we==="perspective")return"px";if(m(we,"rotate")||m(we,"skew"))return"deg"}function St(we,We){return _.fnc(we)?we(We.target,We.id,We.total):we}function bt(we,We){return we.getAttribute(We)}function Jt(we,We,et){var mt=He(We);if(D([et,"deg","rad","turn"],mt))return We;var ot=f.CSS[We+et];if(!_.und(ot))return ot;var Tt=100,zt=document.createElement(we.tagName),un=we.parentNode&&we.parentNode!==document?we.parentNode:document.body;un.appendChild(zt),zt.style.position="absolute",zt.style.width=Tt+et;var tn=Tt/zt.offsetWidth;un.removeChild(zt);var Bt=tn*parseFloat(We);return f.CSS[We+et]=Bt,Bt}function sn(we,We,et){if(We in we.style){var mt=We.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),ot=we.style[We]||getComputedStyle(we).getPropertyValue(mt)||"0";return et?Jt(we,ot,et):ot}}function Se(we,We){if(_.dom(we)&&!_.inp(we)&&(bt(we,We)||_.svg(we)&&we[We]))return"attribute";if(_.dom(we)&&D(h,We))return"transform";if(_.dom(we)&&We!=="transform"&&sn(we,We))return"css";if(we[We]!=null)return"object"}var qe=/(\w+)\(([^)]*)\)/g;function Ue(we){if(!!_.dom(we)){for(var We=we.style.transform||"",et=new Map,mt;mt=qe.exec(We);)et.set(mt[1],mt[2]);return et}}function At(we,We,et,mt){var ot=m(We,"scale")?1:0+Qe(We),Tt=Ue(we).get(We)||ot;return et&&(et.transforms.list.set(We,Tt),et.transforms.last=We),mt?Jt(we,Tt,mt):Tt}function tt(we,We,et,mt){switch(Se(we,We)){case"transform":return At(we,We,mt,et);case"css":return sn(we,We,et);case"attribute":return bt(we,We);default:return we[We]||0}}var pe=/^(\*=|\+=|-=)/;function ge(we,We){var et=pe.exec(we);if(!et)return we;var mt=He(we)||0,ot=parseFloat(We),Tt=parseFloat(we.replace(et[0],""));switch(et[0][0]){case"+":return ot+Tt+mt;case"-":return ot-Tt+mt;case"*":return ot*Tt+mt}}var Fe=/\s/g;function Re(we,We){if(_.col(we))return Oe(we);var et=He(we),mt=et?we.substr(0,we.length-et.length):we;return We&&!Fe.test(we)?mt+We:mt}function ce(we,We){return Math.sqrt(Math.pow(We.x-we.x,2)+Math.pow(We.y-we.y,2))}function ae(we){return Math.PI*2*bt(we,"r")}function J(we){return bt(we,"width")*2+bt(we,"height")*2}function G(we){return ce({x:bt(we,"x1"),y:bt(we,"y1")},{x:bt(we,"x2"),y:bt(we,"y2")})}function $(we){for(var We=we.points,et=0,mt,ot=0;ot<We.numberOfItems;ot++){var Tt=We.getItem(ot);ot>0&&(et+=ce(mt,Tt)),mt=Tt}return et}function me(we){var We=we.points;return $(we)+ce(We.getItem(We.numberOfItems-1),We.getItem(0))}function Pe(we){if(we.getTotalLength)return we.getTotalLength();switch(we.tagName.toLowerCase()){case"circle":return ae(we);case"rect":return J(we);case"line":return G(we);case"polyline":return $(we);case"polygon":return me(we)}}function ve(we){var We=Pe(we);return we.setAttribute("stroke-dasharray",We),We}function Le(we){for(var We=we.parentNode;_.svg(We)&&(We=We.parentNode,!!_.svg(We.parentNode)););return We}function wt(we,We){var et=We||{},mt=et.el||Le(we),ot=mt.getBoundingClientRect(),Tt=bt(mt,"viewBox"),zt=ot.width,un=ot.height,tn=et.viewBox||(Tt?Tt.split(" "):[0,0,zt,un]);return{el:mt,viewBox:tn,x:tn[0]/1,y:tn[1]/1,w:zt/tn[2],h:un/tn[3]}}function Ot(we,We){var et=_.str(we)?B(we)[0]:we,mt=We||100;return function(ot){return{property:ot,el:et,svg:wt(et),totalLength:Pe(et)*(mt/100)}}}function _t(we,We){function et(un){un===void 0&&(un=0);var tn=We+un>=1?We+un:0;return we.el.getPointAtLength(tn)}var mt=wt(we.el,we.svg),ot=et(),Tt=et(-1),zt=et(1);switch(we.property){case"x":return(ot.x-mt.x)*mt.w;case"y":return(ot.y-mt.y)*mt.h;case"angle":return Math.atan2(zt.y-Tt.y,zt.x-Tt.x)*180/Math.PI}}var Ut=/-?\d*\.?\d+/g;function It(we,We){var et=Re(_.pth(we)?we.totalLength:we,We)+"";return{original:et,numbers:et.match(Ut)?et.match(Ut).map(Number):[0],strings:_.str(we)||We?et.split(Ut):[]}}function dn(we){var We=we?le(_.arr(we)?we.map(ne):ne(we)):[];return q(We,function(et,mt,ot){return ot.indexOf(et)===mt})}function Un(we){var We=dn(we);return We.map(function(et,mt){return{target:et,id:mt,total:We.length,transforms:{list:Ue(et)}}})}var $n=/^spring/;function Je(we,We){var et=O(We);if($n.test(et.easing)&&(et.duration=S(et.easing)),_.arr(we)){var mt=we.length,ot=mt===2&&!_.obj(we[0]);ot?we={value:we}:_.fnc(We.duration)||(et.duration=We.duration/mt)}var Tt=_.arr(we)?we:[we];return Tt.map(function(zt,un){var tn=_.obj(zt)&&!_.pth(zt)?zt:{value:zt};return _.und(tn.delay)&&(tn.delay=un?0:We.delay),_.und(tn.endDelay)&&(tn.endDelay=un===Tt.length-1?We.endDelay:0),tn}).map(function(zt){return z(zt,et)})}function Ve(we){for(var We=q(le(we.map(function(Tt){return Object.keys(Tt)})),function(Tt){return _.key(Tt)}).reduce(function(Tt,zt){return Tt.indexOf(zt)<0&&Tt.push(zt),Tt},[]),et={},mt=function(Tt){var zt=We[Tt];et[zt]=we.map(function(un){var tn={};for(var Bt in un)_.key(Bt)?Bt==zt&&(tn.value=un[Bt]):tn[Bt]=un[Bt];return tn})},ot=0;ot<We.length;ot++)mt(ot);return et}function nt(we,We){var et=[],mt=We.keyframes;mt&&(We=z(Ve(mt),We));for(var ot in We)_.key(ot)&&et.push({name:ot,tweens:Je(We[ot],we)});return et}function yt(we,We){var et={};for(var mt in we){var ot=St(we[mt],We);_.arr(ot)&&(ot=ot.map(function(Tt){return St(Tt,We)}),ot.length===1&&(ot=ot[0])),et[mt]=ot}return et.duration=parseFloat(et.duration),et.delay=parseFloat(et.delay),et}function Wt(we,We){var et;return we.tweens.map(function(mt){var ot=yt(mt,We),Tt=ot.value,zt=_.arr(Tt)?Tt[1]:Tt,un=He(zt),tn=tt(We.target,we.name,un,We),Bt=et?et.to.original:tn,fn=_.arr(Tt)?Tt[0]:Bt,ln=He(fn)||He(tn),Jn=un||ln;return _.und(zt)&&(zt=Bt),ot.from=It(fn,Jn),ot.to=It(ge(zt,fn),Jn),ot.start=et?et.end:0,ot.end=ot.start+ot.delay+ot.duration+ot.endDelay,ot.easing=N(ot.easing,ot.duration),ot.isPath=_.pth(Tt),ot.isColor=_.col(ot.from.original),ot.isColor&&(ot.round=1),et=ot,ot})}var pn={css:function(we,We,et){return we.style[We]=et},attribute:function(we,We,et){return we.setAttribute(We,et)},object:function(we,We,et){return we[We]=et},transform:function(we,We,et,mt,ot){if(mt.list.set(We,et),We===mt.last||ot){var Tt="";mt.list.forEach(function(zt,un){Tt+=un+"("+zt+") "}),we.style.transform=Tt}}};function An(we,We){for(var et=Un(we),mt=0,ot=et.length;mt<ot;mt++){var Tt=et[mt];for(var zt in We){var un=St(We[zt],Tt),tn=Tt.target,Bt=He(un),fn=tt(tn,zt,Bt,Tt),ln=Bt||He(fn),Jn=ge(Re(un,ln),fn),hi=Se(tn,zt);pn[hi](tn,zt,Jn,Tt.transforms,!0)}}}function mn(we,We){var et=Se(we.target,We.name);if(et){var mt=Wt(We,we),ot=mt[mt.length-1];return{type:et,property:We.name,animatable:we,tweens:mt,duration:ot.end,delay:mt[0].delay,endDelay:ot.endDelay}}}function Yn(we,We){return q(le(we.map(function(et){return We.map(function(mt){return mn(et,mt)})})),function(et){return!_.und(et)})}function Bn(we,We){var et=we.length,mt=function(Tt){return Tt.timelineOffset?Tt.timelineOffset:0},ot={};return ot.duration=et?Math.max.apply(Math,we.map(function(Tt){return mt(Tt)+Tt.duration})):We.duration,ot.delay=et?Math.min.apply(Math,we.map(function(Tt){return mt(Tt)+Tt.delay})):We.delay,ot.endDelay=et?ot.duration-Math.max.apply(Math,we.map(function(Tt){return mt(Tt)+Tt.duration-Tt.endDelay})):We.endDelay,ot}var mi=0;function Ii(we){var We=k(a,we),et=k(u,we),mt=nt(et,we),ot=Un(we.targets),Tt=Yn(ot,mt),zt=Bn(Tt,et),un=mi;return mi++,z(We,{id:un,children:[],animatables:ot,animations:Tt,duration:zt.duration,delay:zt.delay,endDelay:zt.endDelay})}var Si=[],Gi=[],er,is=function(){function we(){er=requestAnimationFrame(We)}function We(et){var mt=Si.length;if(mt){for(var ot=0;ot<mt;){var Tt=Si[ot];if(!Tt.paused)Tt.tick(et);else{var zt=Si.indexOf(Tt);zt>-1&&(Si.splice(zt,1),mt=Si.length)}ot++}we()}else er=cancelAnimationFrame(er)}return we}();function ze(){if(document.hidden){for(var we=0,We=Si.length;we<We;we++)activeInstance[we].pause();Gi=Si.slice(0),Si=[]}else for(var et=0,mt=Gi.length;et<mt;et++)Gi[et].play()}document.addEventListener("visibilitychange",ze);function at(we){we===void 0&&(we={});var We=0,et=0,mt=0,ot,Tt=0,zt=null;function un(){return window.Promise&&new Promise(function(Vn){return zt=Vn})}var tn=un(),Bt=Ii(we);function fn(){Bt.reversed=!Bt.reversed;for(var Vn=0,gi=ot.length;Vn<gi;Vn++)ot[Vn].reversed=Bt.reversed}function ln(Vn){return Bt.reversed?Bt.duration-Vn:Vn}function Jn(){We=0,et=ln(Bt.currentTime)*(1/at.speed)}function hi(Vn,gi){gi&&gi.seek(Vn-gi.timelineOffset)}function di(Vn){if(Bt.reversePlayback)for(var Xn=Tt;Xn--;)hi(Vn,ot[Xn]);else for(var gi=0;gi<Tt;gi++)hi(Vn,ot[gi])}function ri(Vn){for(var gi=0,Xn=Bt.animations,wr=Xn.length;gi<wr;){var Vi=Xn[gi],Wi=Vi.animatable,K=Vi.tweens,te=K.length-1,fe=K[te];te&&(fe=q(K,function(en){return Vn<en.end})[0]||fe);for(var _e=d(Vn-fe.start-fe.delay,0,fe.duration)/fe.duration,Be=isNaN(_e)?1:fe.easing(_e),Ze=fe.to.strings,lt=fe.round,qt=[],xt=fe.to.numbers.length,pt=void 0,oe=0;oe<xt;oe++){var he=void 0,be=fe.to.numbers[oe],Te=fe.from.numbers[oe]||0;fe.isPath?he=_t(fe.value,Be*be):he=Te+Be*(be-Te),lt&&(fe.isColor&&oe>2||(he=Math.round(he*lt)/lt)),qt.push(he)}var Ae=Ze.length;if(!Ae)pt=qt[0];else{pt=Ze[0];for(var rt=0;rt<Ae;rt++){Ze[rt];var Mt=Ze[rt+1],Ft=qt[rt];isNaN(Ft)||(Mt?pt+=Ft+Mt:pt+=Ft+" ")}}pn[Vi.type](Wi.target,Vi.property,pt,Wi.transforms),Vi.currentValue=pt,gi++}}function _i(Vn){Bt[Vn]&&!Bt.passThrough&&Bt[Vn](Bt)}function ki(){Bt.remaining&&Bt.remaining!==!0&&Bt.remaining--}function Ni(Vn){var gi=Bt.duration,Xn=Bt.delay,wr=gi-Bt.endDelay,Vi=ln(Vn);Bt.progress=d(Vi/gi*100,0,100),Bt.reversePlayback=Vi<Bt.currentTime,ot&&di(Vi),!Bt.began&&Bt.currentTime>0&&(Bt.began=!0,_i("begin"),_i("loopBegin")),Vi<=Xn&&Bt.currentTime!==0&&ri(0),(Vi>=wr&&Bt.currentTime!==gi||!gi)&&ri(gi),Vi>Xn&&Vi<wr?(Bt.changeBegan||(Bt.changeBegan=!0,Bt.changeCompleted=!1,_i("changeBegin")),_i("change"),ri(Vi)):Bt.changeBegan&&(Bt.changeCompleted=!0,Bt.changeBegan=!1,_i("changeComplete")),Bt.currentTime=d(Vi,0,gi),Bt.began&&_i("update"),Vn>=gi&&(et=0,ki(),Bt.remaining?(We=mt,_i("loopComplete"),_i("loopBegin"),Bt.direction==="alternate"&&fn()):(Bt.paused=!0,Bt.completed||(Bt.completed=!0,_i("loopComplete"),_i("complete"),"Promise"in window&&(zt(),tn=un()))))}return Bt.reset=function(){var Vn=Bt.direction;Bt.passThrough=!1,Bt.currentTime=0,Bt.progress=0,Bt.paused=!0,Bt.began=!1,Bt.changeBegan=!1,Bt.completed=!1,Bt.changeCompleted=!1,Bt.reversePlayback=!1,Bt.reversed=Vn==="reverse",Bt.remaining=Bt.loop,ot=Bt.children,Tt=ot.length;for(var gi=Tt;gi--;)Bt.children[gi].reset();(Bt.reversed&&Bt.loop!==!0||Vn==="alternate"&&Bt.loop===1)&&Bt.remaining++,ri(0)},Bt.set=function(Vn,gi){return An(Vn,gi),Bt},Bt.tick=function(Vn){mt=Vn,We||(We=mt),Ni((mt+(et-We))*at.speed)},Bt.seek=function(Vn){Ni(ln(Vn))},Bt.pause=function(){Bt.paused=!0,Jn()},Bt.play=function(){!Bt.paused||(Bt.paused=!1,Si.push(Bt),Jn(),er||is())},Bt.reverse=function(){fn(),Jn()},Bt.restart=function(){Bt.reset(),Bt.play()},Bt.finished=tn,Bt.reset(),Bt.autoplay&&Bt.play(),Bt}function Pt(we,We){for(var et=We.length;et--;)D(we,We[et].animatable.target)&&We.splice(et,1)}function ft(we){for(var We=dn(we),et=Si.length;et--;){var mt=Si[et],ot=mt.animations,Tt=mt.children;Pt(We,ot);for(var zt=Tt.length;zt--;){var un=Tt[zt],tn=un.animations;Pt(We,tn),!tn.length&&!un.children.length&&Tt.splice(zt,1)}!ot.length&&!Tt.length&&mt.pause()}}function Ht(we,We){We===void 0&&(We={});var et=We.direction||"normal",mt=We.easing?N(We.easing):null,ot=We.grid,Tt=We.axis,zt=We.from||0,un=zt==="first",tn=zt==="center",Bt=zt==="last",fn=_.arr(we),ln=parseFloat(fn?we[0]:we),Jn=fn?parseFloat(we[1]):0,hi=He(fn?we[1]:we)||0,di=We.start||0+(fn?ln:0),ri=[],_i=0;return function(ki,Ni,Vn){if(un&&(zt=0),tn&&(zt=(Vn-1)/2),Bt&&(zt=Vn-1),!ri.length){for(var gi=0;gi<Vn;gi++){if(!ot)ri.push(Math.abs(zt-gi));else{var Xn=tn?(ot[0]-1)/2:zt%ot[0],wr=tn?(ot[1]-1)/2:Math.floor(zt/ot[0]),Vi=gi%ot[0],Wi=Math.floor(gi/ot[0]),K=Xn-Vi,te=wr-Wi,fe=Math.sqrt(K*K+te*te);Tt==="x"&&(fe=-K),Tt==="y"&&(fe=-te),ri.push(fe)}_i=Math.max.apply(Math,ri)}mt&&(ri=ri.map(function(Be){return mt(Be/_i)*_i})),et==="reverse"&&(ri=ri.map(function(Be){return Tt?Be<0?Be*-1:-Be:Math.abs(_i-Be)}))}var _e=fn?(Jn-ln)/_i:ln;return di+_e*(Math.round(ri[Ni]*100)/100)+hi}}function In(we){we===void 0&&(we={});var We=at(we);return We.duration=0,We.add=function(et,mt){var ot=Si.indexOf(We),Tt=We.children;ot>-1&&Si.splice(ot,1);function zt(Jn){Jn.passThrough=!0}for(var un=0;un<Tt.length;un++)zt(Tt[un]);var tn=z(et,k(u,we));tn.targets=tn.targets||we.targets;var Bt=We.duration;tn.autoplay=!1,tn.direction=We.direction,tn.timelineOffset=_.und(mt)?Bt:ge(mt,Bt),zt(We),We.seek(tn.timelineOffset);var fn=at(tn);zt(fn),Tt.push(fn);var ln=Bn(Tt,we);return We.delay=ln.delay,We.endDelay=ln.endDelay,We.duration=ln.duration,We.seek(0),We.reset(),We.autoplay&&We.play(),We},We}at.version="3.0.0",at.speed=1,at.running=Si,at.remove=ft,at.get=tt,at.set=An,at.convertPx=Jt,at.path=Ot,at.setDashoffset=ve,at.stagger=Ht,at.timeline=In,at.easing=N,at.penner=I,at.random=function(we,We){return Math.floor(Math.random()*(We-we+1))+we},o.exports=at},{}],57:[function(i,o,l){/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */(function(a,u){typeof l=="object"&&typeof o<"u"?u(l):(a=typeof globalThis<"u"?globalThis:a||self,u(a.THREE={}))})(this,function(a){const u="137",h={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},f={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},d=0,m=1,g=2,x=3,v=0,A=1,_=2,E=3,w=0,S=1,T=2,R=1,L=2,I=0,N=1,B=2,H=3,q=4,le=5,ne=100,D=101,O=102,k=103,z=104,X=200,Z=201,ie=202,se=203,ue=204,ye=205,Ce=206,ke=207,Oe=208,Ne=209,He=210,Qe=0,St=1,bt=2,Jt=3,sn=4,Se=5,qe=6,Ue=7,At=0,tt=1,pe=2,ge=0,Fe=1,Re=2,ce=3,ae=4,J=5,G=300,$=301,me=302,Pe=303,ve=304,Le=306,wt=307,Ot=1e3,_t=1001,Ut=1002,It=1003,dn=1004,Un=1004,$n=1005,Je=1005,Ve=1006,nt=1007,yt=1007,Wt=1008,pn=1008,An=1009,mn=1010,Yn=1011,Bn=1012,mi=1013,Ii=1014,Si=1015,Gi=1016,er=1017,is=1018,ze=1020,at=1021,Pt=1023,ft=1024,Ht=1025,In=1026,we=1027,We=1028,et=1029,mt=1030,ot=1031,Tt=1033,zt=33776,un=33777,tn=33778,Bt=33779,fn=35840,ln=35841,Jn=35842,hi=35843,di=36196,ri=37492,_i=37496,ki=37808,Ni=37809,Vn=37810,gi=37811,Xn=37812,wr=37813,Vi=37814,Wi=37815,K=37816,te=37817,fe=37818,_e=37819,Be=37820,Ze=37821,lt=36492,qt=2200,xt=2201,pt=2202,oe=2300,he=2301,be=2302,Te=2400,Ae=2401,rt=2402,Mt=2500,Ft=2501,en=0,Mn=1,rn=2,hn=3e3,Sn=3001,Kn=3200,ei=3201,bn=0,ti=1,xi=0,Ti=7680,qi=7681,rr=7682,Ei=7683,Mr=34055,fi=34056,Po=5386,fo=512,Ia=513,Bc=514,Uc=515,Pr=516,cN=517,uN=518,wM=519,Zu=35044,Ju=35048,hN=35040,dN=35045,fN=35049,pN=35041,mN=35046,gN=35050,vN=35042,yN="100",px="300 es",Xm=1035;class ka{addEventListener(s,c){this._listeners===void 0&&(this._listeners={});const p=this._listeners;p[s]===void 0&&(p[s]=[]),p[s].indexOf(c)===-1&&p[s].push(c)}hasEventListener(s,c){if(this._listeners===void 0)return!1;const p=this._listeners;return p[s]!==void 0&&p[s].indexOf(c)!==-1}removeEventListener(s,c){if(this._listeners===void 0)return;const y=this._listeners[s];if(y!==void 0){const M=y.indexOf(c);M!==-1&&y.splice(M,1)}}dispatchEvent(s){if(this._listeners===void 0)return;const p=this._listeners[s.type];if(p!==void 0){s.target=this;const y=p.slice(0);for(let M=0,C=y.length;M<C;M++)y[M].call(this,s);s.target=null}}}const rs=[];for(let b=0;b<256;b++)rs[b]=(b<16?"0":"")+b.toString(16);let qm=1234567;const zc=Math.PI/180,vf=180/Math.PI;function Ws(){const b=Math.random()*4294967295|0,s=Math.random()*4294967295|0,c=Math.random()*4294967295|0,p=Math.random()*4294967295|0;return(rs[b&255]+rs[b>>8&255]+rs[b>>16&255]+rs[b>>24&255]+"-"+rs[s&255]+rs[s>>8&255]+"-"+rs[s>>16&15|64]+rs[s>>24&255]+"-"+rs[c&63|128]+rs[c>>8&255]+"-"+rs[c>>16&255]+rs[c>>24&255]+rs[p&255]+rs[p>>8&255]+rs[p>>16&255]+rs[p>>24&255]).toUpperCase()}function ss(b,s,c){return Math.max(s,Math.min(c,b))}function mx(b,s){return(b%s+s)%s}function xN(b,s,c,p,y){return p+(b-s)*(y-p)/(c-s)}function _N(b,s,c){return b!==s?(c-b)/(s-b):0}function yf(b,s,c){return(1-c)*b+c*s}function bN(b,s,c,p){return yf(b,s,1-Math.exp(-c*p))}function EN(b,s=1){return s-Math.abs(mx(b,s*2)-s)}function AN(b,s,c){return b<=s?0:b>=c?1:(b=(b-s)/(c-s),b*b*(3-2*b))}function wN(b,s,c){return b<=s?0:b>=c?1:(b=(b-s)/(c-s),b*b*b*(b*(b*6-15)+10))}function MN(b,s){return b+Math.floor(Math.random()*(s-b+1))}function SN(b,s){return b+Math.random()*(s-b)}function TN(b){return b*(.5-Math.random())}function CN(b){return b!==void 0&&(qm=b%2147483647),qm=qm*16807%2147483647,(qm-1)/2147483646}function RN(b){return b*zc}function LN(b){return b*vf}function gx(b){return(b&b-1)===0&&b!==0}function MM(b){return Math.pow(2,Math.ceil(Math.log(b)/Math.LN2))}function SM(b){return Math.pow(2,Math.floor(Math.log(b)/Math.LN2))}function PN(b,s,c,p,y){const M=Math.cos,C=Math.sin,P=M(c/2),F=C(c/2),U=M((s+p)/2),V=C((s+p)/2),W=M((s-p)/2),j=C((s-p)/2),Y=M((p-s)/2),ee=C((p-s)/2);switch(y){case"XYX":b.set(P*V,F*W,F*j,P*U);break;case"YZY":b.set(F*j,P*V,F*W,P*U);break;case"ZXZ":b.set(F*W,F*j,P*V,P*U);break;case"XZX":b.set(P*V,F*ee,F*Y,P*U);break;case"YXY":b.set(F*Y,P*V,F*ee,P*U);break;case"ZYZ":b.set(F*ee,F*Y,P*V,P*U);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+y)}}var TM=Object.freeze({__proto__:null,DEG2RAD:zc,RAD2DEG:vf,generateUUID:Ws,clamp:ss,euclideanModulo:mx,mapLinear:xN,inverseLerp:_N,lerp:yf,damp:bN,pingpong:EN,smoothstep:AN,smootherstep:wN,randInt:MN,randFloat:SN,randFloatSpread:TN,seededRandom:CN,degToRad:RN,radToDeg:LN,isPowerOfTwo:gx,ceilPowerOfTwo:MM,floorPowerOfTwo:SM,setQuaternionFromProperEuler:PN});class Qt{constructor(s=0,c=0){this.x=s,this.y=c}get width(){return this.x}set width(s){this.x=s}get height(){return this.y}set height(s){this.y=s}set(s,c){return this.x=s,this.y=c,this}setScalar(s){return this.x=s,this.y=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setComponent(s,c){switch(s){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y)}copy(s){return this.x=s.x,this.y=s.y,this}add(s,c){return c!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(s,c)):(this.x+=s.x,this.y+=s.y,this)}addScalar(s){return this.x+=s,this.y+=s,this}addVectors(s,c){return this.x=s.x+c.x,this.y=s.y+c.y,this}addScaledVector(s,c){return this.x+=s.x*c,this.y+=s.y*c,this}sub(s,c){return c!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(s,c)):(this.x-=s.x,this.y-=s.y,this)}subScalar(s){return this.x-=s,this.y-=s,this}subVectors(s,c){return this.x=s.x-c.x,this.y=s.y-c.y,this}multiply(s){return this.x*=s.x,this.y*=s.y,this}multiplyScalar(s){return this.x*=s,this.y*=s,this}divide(s){return this.x/=s.x,this.y/=s.y,this}divideScalar(s){return this.multiplyScalar(1/s)}applyMatrix3(s){const c=this.x,p=this.y,y=s.elements;return this.x=y[0]*c+y[3]*p+y[6],this.y=y[1]*c+y[4]*p+y[7],this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this}clamp(s,c){return this.x=Math.max(s.x,Math.min(c.x,this.x)),this.y=Math.max(s.y,Math.min(c.y,this.y)),this}clampScalar(s,c){return this.x=Math.max(s,Math.min(c,this.x)),this.y=Math.max(s,Math.min(c,this.y)),this}clampLength(s,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(s,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(s){return this.x*s.x+this.y*s.y}cross(s){return this.x*s.y-this.y*s.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const c=this.x-s.x,p=this.y-s.y;return c*c+p*p}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,c){return this.x+=(s.x-this.x)*c,this.y+=(s.y-this.y)*c,this}lerpVectors(s,c,p){return this.x=s.x+(c.x-s.x)*p,this.y=s.y+(c.y-s.y)*p,this}equals(s){return s.x===this.x&&s.y===this.y}fromArray(s,c=0){return this.x=s[c],this.y=s[c+1],this}toArray(s=[],c=0){return s[c]=this.x,s[c+1]=this.y,s}fromBufferAttribute(s,c,p){return p!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=s.getX(c),this.y=s.getY(c),this}rotateAround(s,c){const p=Math.cos(c),y=Math.sin(c),M=this.x-s.x,C=this.y-s.y;return this.x=M*p-C*y+s.x,this.y=M*y+C*p+s.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}Qt.prototype.isVector2=!0;class Hr{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(s,c,p,y,M,C,P,F,U){const V=this.elements;return V[0]=s,V[1]=y,V[2]=P,V[3]=c,V[4]=M,V[5]=F,V[6]=p,V[7]=C,V[8]=U,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(s){const c=this.elements,p=s.elements;return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],this}extractBasis(s,c,p){return s.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),p.setFromMatrix3Column(this,2),this}setFromMatrix4(s){const c=s.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(s){return this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,c){const p=s.elements,y=c.elements,M=this.elements,C=p[0],P=p[3],F=p[6],U=p[1],V=p[4],W=p[7],j=p[2],Y=p[5],ee=p[8],de=y[0],xe=y[3],re=y[6],Q=y[1],De=y[4],Me=y[7],Ie=y[2],Xe=y[5],st=y[8];return M[0]=C*de+P*Q+F*Ie,M[3]=C*xe+P*De+F*Xe,M[6]=C*re+P*Me+F*st,M[1]=U*de+V*Q+W*Ie,M[4]=U*xe+V*De+W*Xe,M[7]=U*re+V*Me+W*st,M[2]=j*de+Y*Q+ee*Ie,M[5]=j*xe+Y*De+ee*Xe,M[8]=j*re+Y*Me+ee*st,this}multiplyScalar(s){const c=this.elements;return c[0]*=s,c[3]*=s,c[6]*=s,c[1]*=s,c[4]*=s,c[7]*=s,c[2]*=s,c[5]*=s,c[8]*=s,this}determinant(){const s=this.elements,c=s[0],p=s[1],y=s[2],M=s[3],C=s[4],P=s[5],F=s[6],U=s[7],V=s[8];return c*C*V-c*P*U-p*M*V+p*P*F+y*M*U-y*C*F}invert(){const s=this.elements,c=s[0],p=s[1],y=s[2],M=s[3],C=s[4],P=s[5],F=s[6],U=s[7],V=s[8],W=V*C-P*U,j=P*F-V*M,Y=U*M-C*F,ee=c*W+p*j+y*Y;if(ee===0)return this.set(0,0,0,0,0,0,0,0,0);const de=1/ee;return s[0]=W*de,s[1]=(y*U-V*p)*de,s[2]=(P*p-y*C)*de,s[3]=j*de,s[4]=(V*c-y*F)*de,s[5]=(y*M-P*c)*de,s[6]=Y*de,s[7]=(p*F-U*c)*de,s[8]=(C*c-p*M)*de,this}transpose(){let s;const c=this.elements;return s=c[1],c[1]=c[3],c[3]=s,s=c[2],c[2]=c[6],c[6]=s,s=c[5],c[5]=c[7],c[7]=s,this}getNormalMatrix(s){return this.setFromMatrix4(s).invert().transpose()}transposeIntoArray(s){const c=this.elements;return s[0]=c[0],s[1]=c[3],s[2]=c[6],s[3]=c[1],s[4]=c[4],s[5]=c[7],s[6]=c[2],s[7]=c[5],s[8]=c[8],this}setUvTransform(s,c,p,y,M,C,P){const F=Math.cos(M),U=Math.sin(M);return this.set(p*F,p*U,-p*(F*C+U*P)+C+s,-y*U,y*F,-y*(-U*C+F*P)+P+c,0,0,1),this}scale(s,c){const p=this.elements;return p[0]*=s,p[3]*=s,p[6]*=s,p[1]*=c,p[4]*=c,p[7]*=c,this}rotate(s){const c=Math.cos(s),p=Math.sin(s),y=this.elements,M=y[0],C=y[3],P=y[6],F=y[1],U=y[4],V=y[7];return y[0]=c*M+p*F,y[3]=c*C+p*U,y[6]=c*P+p*V,y[1]=-p*M+c*F,y[4]=-p*C+c*U,y[7]=-p*P+c*V,this}translate(s,c){const p=this.elements;return p[0]+=s*p[2],p[3]+=s*p[5],p[6]+=s*p[8],p[1]+=c*p[2],p[4]+=c*p[5],p[7]+=c*p[8],this}equals(s){const c=this.elements,p=s.elements;for(let y=0;y<9;y++)if(c[y]!==p[y])return!1;return!0}fromArray(s,c=0){for(let p=0;p<9;p++)this.elements[p]=s[p+c];return this}toArray(s=[],c=0){const p=this.elements;return s[c]=p[0],s[c+1]=p[1],s[c+2]=p[2],s[c+3]=p[3],s[c+4]=p[4],s[c+5]=p[5],s[c+6]=p[6],s[c+7]=p[7],s[c+8]=p[8],s}clone(){return new this.constructor().fromArray(this.elements)}}Hr.prototype.isMatrix3=!0;function CM(b){for(let s=b.length-1;s>=0;--s)if(b[s]>65535)return!0;return!1}const DN={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function eh(b,s){return new DN[b](s)}function xf(b){return document.createElementNS("http://www.w3.org/1999/xhtml",b)}const RM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Do={h:0,s:0,l:0},Ym={h:0,s:0,l:0};function vx(b,s,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?b+(s-b)*6*c:c<1/2?s:c<2/3?b+(s-b)*6*(2/3-c):b}function th(b){return b<.04045?b*.0773993808:Math.pow(b*.9478672986+.0521327014,2.4)}function yx(b){return b<.0031308?b*12.92:1.055*Math.pow(b,.41666)-.055}class Tn{constructor(s,c,p){return c===void 0&&p===void 0?this.set(s):this.setRGB(s,c,p)}set(s){return s&&s.isColor?this.copy(s):typeof s=="number"?this.setHex(s):typeof s=="string"&&this.setStyle(s),this}setScalar(s){return this.r=s,this.g=s,this.b=s,this}setHex(s){return s=Math.floor(s),this.r=(s>>16&255)/255,this.g=(s>>8&255)/255,this.b=(s&255)/255,this}setRGB(s,c,p){return this.r=s,this.g=c,this.b=p,this}setHSL(s,c,p){if(s=mx(s,1),c=ss(c,0,1),p=ss(p,0,1),c===0)this.r=this.g=this.b=p;else{const y=p<=.5?p*(1+c):p+c-p*c,M=2*p-y;this.r=vx(M,y,s+1/3),this.g=vx(M,y,s),this.b=vx(M,y,s-1/3)}return this}setStyle(s){function c(y){y!==void 0&&parseFloat(y)<1&&console.warn("THREE.Color: Alpha component of "+s+" will be ignored.")}let p;if(p=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(s)){let y;const M=p[1],C=p[2];switch(M){case"rgb":case"rgba":if(y=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(C))return this.r=Math.min(255,parseInt(y[1],10))/255,this.g=Math.min(255,parseInt(y[2],10))/255,this.b=Math.min(255,parseInt(y[3],10))/255,c(y[4]),this;if(y=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(C))return this.r=Math.min(100,parseInt(y[1],10))/100,this.g=Math.min(100,parseInt(y[2],10))/100,this.b=Math.min(100,parseInt(y[3],10))/100,c(y[4]),this;break;case"hsl":case"hsla":if(y=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(C)){const P=parseFloat(y[1])/360,F=parseInt(y[2],10)/100,U=parseInt(y[3],10)/100;return c(y[4]),this.setHSL(P,F,U)}break}}else if(p=/^\#([A-Fa-f\d]+)$/.exec(s)){const y=p[1],M=y.length;if(M===3)return this.r=parseInt(y.charAt(0)+y.charAt(0),16)/255,this.g=parseInt(y.charAt(1)+y.charAt(1),16)/255,this.b=parseInt(y.charAt(2)+y.charAt(2),16)/255,this;if(M===6)return this.r=parseInt(y.charAt(0)+y.charAt(1),16)/255,this.g=parseInt(y.charAt(2)+y.charAt(3),16)/255,this.b=parseInt(y.charAt(4)+y.charAt(5),16)/255,this}return s&&s.length>0?this.setColorName(s):this}setColorName(s){const c=RM[s.toLowerCase()];return c!==void 0?this.setHex(c):console.warn("THREE.Color: Unknown color "+s),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(s){return this.r=s.r,this.g=s.g,this.b=s.b,this}copySRGBToLinear(s){return this.r=th(s.r),this.g=th(s.g),this.b=th(s.b),this}copyLinearToSRGB(s){return this.r=yx(s.r),this.g=yx(s.g),this.b=yx(s.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(s){const c=this.r,p=this.g,y=this.b,M=Math.max(c,p,y),C=Math.min(c,p,y);let P,F;const U=(C+M)/2;if(C===M)P=0,F=0;else{const V=M-C;switch(F=U<=.5?V/(M+C):V/(2-M-C),M){case c:P=(p-y)/V+(p<y?6:0);break;case p:P=(y-c)/V+2;break;case y:P=(c-p)/V+4;break}P/=6}return s.h=P,s.s=F,s.l=U,s}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(s,c,p){return this.getHSL(Do),Do.h+=s,Do.s+=c,Do.l+=p,this.setHSL(Do.h,Do.s,Do.l),this}add(s){return this.r+=s.r,this.g+=s.g,this.b+=s.b,this}addColors(s,c){return this.r=s.r+c.r,this.g=s.g+c.g,this.b=s.b+c.b,this}addScalar(s){return this.r+=s,this.g+=s,this.b+=s,this}sub(s){return this.r=Math.max(0,this.r-s.r),this.g=Math.max(0,this.g-s.g),this.b=Math.max(0,this.b-s.b),this}multiply(s){return this.r*=s.r,this.g*=s.g,this.b*=s.b,this}multiplyScalar(s){return this.r*=s,this.g*=s,this.b*=s,this}lerp(s,c){return this.r+=(s.r-this.r)*c,this.g+=(s.g-this.g)*c,this.b+=(s.b-this.b)*c,this}lerpColors(s,c,p){return this.r=s.r+(c.r-s.r)*p,this.g=s.g+(c.g-s.g)*p,this.b=s.b+(c.b-s.b)*p,this}lerpHSL(s,c){this.getHSL(Do),s.getHSL(Ym);const p=yf(Do.h,Ym.h,c),y=yf(Do.s,Ym.s,c),M=yf(Do.l,Ym.l,c);return this.setHSL(p,y,M),this}equals(s){return s.r===this.r&&s.g===this.g&&s.b===this.b}fromArray(s,c=0){return this.r=s[c],this.g=s[c+1],this.b=s[c+2],this}toArray(s=[],c=0){return s[c]=this.r,s[c+1]=this.g,s[c+2]=this.b,s}fromBufferAttribute(s,c){return this.r=s.getX(c),this.g=s.getY(c),this.b=s.getZ(c),s.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Tn.NAMES=RM,Tn.prototype.isColor=!0,Tn.prototype.r=1,Tn.prototype.g=1,Tn.prototype.b=1;let nh;class Pl{static getDataURL(s){if(/^data:/i.test(s.src)||typeof HTMLCanvasElement>"u")return s.src;let c;if(s instanceof HTMLCanvasElement)c=s;else{nh===void 0&&(nh=xf("canvas")),nh.width=s.width,nh.height=s.height;const p=nh.getContext("2d");s instanceof ImageData?p.putImageData(s,0,0):p.drawImage(s,0,0,s.width,s.height),c=nh}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",s),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}static sRGBToLinear(s){if(typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&s instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&s instanceof ImageBitmap){const c=xf("canvas");c.width=s.width,c.height=s.height;const p=c.getContext("2d");p.drawImage(s,0,0,s.width,s.height);const y=p.getImageData(0,0,s.width,s.height),M=y.data;for(let C=0;C<M.length;C++)M[C]=th(M[C]/255)*255;return p.putImageData(y,0,0),c}else if(s.data){const c=s.data.slice(0);for(let p=0;p<c.length;p++)c instanceof Uint8Array||c instanceof Uint8ClampedArray?c[p]=Math.floor(th(c[p]/255)*255):c[p]=th(c[p]);return{data:c,width:s.width,height:s.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),s}}let ON=0;class Nr extends ka{constructor(s=Nr.DEFAULT_IMAGE,c=Nr.DEFAULT_MAPPING,p=_t,y=_t,M=Ve,C=Wt,P=Pt,F=An,U=1,V=hn){super(),Object.defineProperty(this,"id",{value:ON++}),this.uuid=Ws(),this.name="",this.image=s,this.mipmaps=[],this.mapping=c,this.wrapS=p,this.wrapT=y,this.magFilter=M,this.minFilter=C,this.anisotropy=U,this.format=P,this.internalFormat=null,this.type=F,this.offset=new Qt(0,0),this.repeat=new Qt(1,1),this.center=new Qt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Hr,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=V,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(s){return this.name=s.name,this.image=s.image,this.mipmaps=s.mipmaps.slice(0),this.mapping=s.mapping,this.wrapS=s.wrapS,this.wrapT=s.wrapT,this.magFilter=s.magFilter,this.minFilter=s.minFilter,this.anisotropy=s.anisotropy,this.format=s.format,this.internalFormat=s.internalFormat,this.type=s.type,this.offset.copy(s.offset),this.repeat.copy(s.repeat),this.center.copy(s.center),this.rotation=s.rotation,this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrix.copy(s.matrix),this.generateMipmaps=s.generateMipmaps,this.premultiplyAlpha=s.premultiplyAlpha,this.flipY=s.flipY,this.unpackAlignment=s.unpackAlignment,this.encoding=s.encoding,this.userData=JSON.parse(JSON.stringify(s.userData)),this}toJSON(s){const c=s===void 0||typeof s=="string";if(!c&&s.textures[this.uuid]!==void 0)return s.textures[this.uuid];const p={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const y=this.image;if(y.uuid===void 0&&(y.uuid=Ws()),!c&&s.images[y.uuid]===void 0){let M;if(Array.isArray(y)){M=[];for(let C=0,P=y.length;C<P;C++)y[C].isDataTexture?M.push(xx(y[C].image)):M.push(xx(y[C]))}else M=xx(y);s.images[y.uuid]={uuid:y.uuid,url:M}}p.image=y.uuid}return JSON.stringify(this.userData)!=="{}"&&(p.userData=this.userData),c||(s.textures[this.uuid]=p),p}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(s){if(this.mapping!==G)return s;if(s.applyMatrix3(this.matrix),s.x<0||s.x>1)switch(this.wrapS){case Ot:s.x=s.x-Math.floor(s.x);break;case _t:s.x=s.x<0?0:1;break;case Ut:Math.abs(Math.floor(s.x)%2)===1?s.x=Math.ceil(s.x)-s.x:s.x=s.x-Math.floor(s.x);break}if(s.y<0||s.y>1)switch(this.wrapT){case Ot:s.y=s.y-Math.floor(s.y);break;case _t:s.y=s.y<0?0:1;break;case Ut:Math.abs(Math.floor(s.y)%2)===1?s.y=Math.ceil(s.y)-s.y:s.y=s.y-Math.floor(s.y);break}return this.flipY&&(s.y=1-s.y),s}set needsUpdate(s){s===!0&&this.version++}}Nr.DEFAULT_IMAGE=void 0,Nr.DEFAULT_MAPPING=G,Nr.prototype.isTexture=!0;function xx(b){return typeof HTMLImageElement<"u"&&b instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&b instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&b instanceof ImageBitmap?Pl.getDataURL(b):b.data?{data:Array.prototype.slice.call(b.data),width:b.width,height:b.height,type:b.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class Qi{constructor(s=0,c=0,p=0,y=1){this.x=s,this.y=c,this.z=p,this.w=y}get width(){return this.z}set width(s){this.z=s}get height(){return this.w}set height(s){this.w=s}set(s,c,p,y){return this.x=s,this.y=c,this.z=p,this.w=y,this}setScalar(s){return this.x=s,this.y=s,this.z=s,this.w=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setZ(s){return this.z=s,this}setW(s){return this.w=s,this}setComponent(s,c){switch(s){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this.w=s.w!==void 0?s.w:1,this}add(s,c){return c!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(s,c)):(this.x+=s.x,this.y+=s.y,this.z+=s.z,this.w+=s.w,this)}addScalar(s){return this.x+=s,this.y+=s,this.z+=s,this.w+=s,this}addVectors(s,c){return this.x=s.x+c.x,this.y=s.y+c.y,this.z=s.z+c.z,this.w=s.w+c.w,this}addScaledVector(s,c){return this.x+=s.x*c,this.y+=s.y*c,this.z+=s.z*c,this.w+=s.w*c,this}sub(s,c){return c!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(s,c)):(this.x-=s.x,this.y-=s.y,this.z-=s.z,this.w-=s.w,this)}subScalar(s){return this.x-=s,this.y-=s,this.z-=s,this.w-=s,this}subVectors(s,c){return this.x=s.x-c.x,this.y=s.y-c.y,this.z=s.z-c.z,this.w=s.w-c.w,this}multiply(s){return this.x*=s.x,this.y*=s.y,this.z*=s.z,this.w*=s.w,this}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this.w*=s,this}applyMatrix4(s){const c=this.x,p=this.y,y=this.z,M=this.w,C=s.elements;return this.x=C[0]*c+C[4]*p+C[8]*y+C[12]*M,this.y=C[1]*c+C[5]*p+C[9]*y+C[13]*M,this.z=C[2]*c+C[6]*p+C[10]*y+C[14]*M,this.w=C[3]*c+C[7]*p+C[11]*y+C[15]*M,this}divideScalar(s){return this.multiplyScalar(1/s)}setAxisAngleFromQuaternion(s){this.w=2*Math.acos(s.w);const c=Math.sqrt(1-s.w*s.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=s.x/c,this.y=s.y/c,this.z=s.z/c),this}setAxisAngleFromRotationMatrix(s){let c,p,y,M;const F=s.elements,U=F[0],V=F[4],W=F[8],j=F[1],Y=F[5],ee=F[9],de=F[2],xe=F[6],re=F[10];if(Math.abs(V-j)<.01&&Math.abs(W-de)<.01&&Math.abs(ee-xe)<.01){if(Math.abs(V+j)<.1&&Math.abs(W+de)<.1&&Math.abs(ee+xe)<.1&&Math.abs(U+Y+re-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const De=(U+1)/2,Me=(Y+1)/2,Ie=(re+1)/2,Xe=(V+j)/4,st=(W+de)/4,ut=(ee+xe)/4;return De>Me&&De>Ie?De<.01?(p=0,y=.707106781,M=.707106781):(p=Math.sqrt(De),y=Xe/p,M=st/p):Me>Ie?Me<.01?(p=.707106781,y=0,M=.707106781):(y=Math.sqrt(Me),p=Xe/y,M=ut/y):Ie<.01?(p=.707106781,y=.707106781,M=0):(M=Math.sqrt(Ie),p=st/M,y=ut/M),this.set(p,y,M,c),this}let Q=Math.sqrt((xe-ee)*(xe-ee)+(W-de)*(W-de)+(j-V)*(j-V));return Math.abs(Q)<.001&&(Q=1),this.x=(xe-ee)/Q,this.y=(W-de)/Q,this.z=(j-V)/Q,this.w=Math.acos((U+Y+re-1)/2),this}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this.w=Math.min(this.w,s.w),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this.w=Math.max(this.w,s.w),this}clamp(s,c){return this.x=Math.max(s.x,Math.min(c.x,this.x)),this.y=Math.max(s.y,Math.min(c.y,this.y)),this.z=Math.max(s.z,Math.min(c.z,this.z)),this.w=Math.max(s.w,Math.min(c.w,this.w)),this}clampScalar(s,c){return this.x=Math.max(s,Math.min(c,this.x)),this.y=Math.max(s,Math.min(c,this.y)),this.z=Math.max(s,Math.min(c,this.z)),this.w=Math.max(s,Math.min(c,this.w)),this}clampLength(s,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(s,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z+this.w*s.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,c){return this.x+=(s.x-this.x)*c,this.y+=(s.y-this.y)*c,this.z+=(s.z-this.z)*c,this.w+=(s.w-this.w)*c,this}lerpVectors(s,c,p){return this.x=s.x+(c.x-s.x)*p,this.y=s.y+(c.y-s.y)*p,this.z=s.z+(c.z-s.z)*p,this.w=s.w+(c.w-s.w)*p,this}equals(s){return s.x===this.x&&s.y===this.y&&s.z===this.z&&s.w===this.w}fromArray(s,c=0){return this.x=s[c],this.y=s[c+1],this.z=s[c+2],this.w=s[c+3],this}toArray(s=[],c=0){return s[c]=this.x,s[c+1]=this.y,s[c+2]=this.z,s[c+3]=this.w,s}fromBufferAttribute(s,c,p){return p!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=s.getX(c),this.y=s.getY(c),this.z=s.getZ(c),this.w=s.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}Qi.prototype.isVector4=!0;class js extends ka{constructor(s,c,p={}){super(),this.width=s,this.height=c,this.depth=1,this.scissor=new Qi(0,0,s,c),this.scissorTest=!1,this.viewport=new Qi(0,0,s,c),this.texture=new Nr(void 0,p.mapping,p.wrapS,p.wrapT,p.magFilter,p.minFilter,p.format,p.type,p.anisotropy,p.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:s,height:c,depth:1},this.texture.generateMipmaps=p.generateMipmaps!==void 0?p.generateMipmaps:!1,this.texture.internalFormat=p.internalFormat!==void 0?p.internalFormat:null,this.texture.minFilter=p.minFilter!==void 0?p.minFilter:Ve,this.depthBuffer=p.depthBuffer!==void 0?p.depthBuffer:!0,this.stencilBuffer=p.stencilBuffer!==void 0?p.stencilBuffer:!1,this.depthTexture=p.depthTexture!==void 0?p.depthTexture:null}setTexture(s){s.image={width:this.width,height:this.height,depth:this.depth},this.texture=s}setSize(s,c,p=1){(this.width!==s||this.height!==c||this.depth!==p)&&(this.width=s,this.height=c,this.depth=p,this.texture.image.width=s,this.texture.image.height=c,this.texture.image.depth=p,this.dispose()),this.viewport.set(0,0,s,c),this.scissor.set(0,0,s,c)}clone(){return new this.constructor().copy(this)}copy(s){return this.width=s.width,this.height=s.height,this.depth=s.depth,this.viewport.copy(s.viewport),this.texture=s.texture.clone(),this.texture.image=Object.assign({},s.texture.image),this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,this.depthTexture=s.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}js.prototype.isWebGLRenderTarget=!0;class LM extends js{constructor(s,c,p){super(s,c);const y=this.texture;this.texture=[];for(let M=0;M<p;M++)this.texture[M]=y.clone()}setSize(s,c,p=1){if(this.width!==s||this.height!==c||this.depth!==p){this.width=s,this.height=c,this.depth=p;for(let y=0,M=this.texture.length;y<M;y++)this.texture[y].image.width=s,this.texture[y].image.height=c,this.texture[y].image.depth=p;this.dispose()}return this.viewport.set(0,0,s,c),this.scissor.set(0,0,s,c),this}copy(s){this.dispose(),this.width=s.width,this.height=s.height,this.depth=s.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=s.depthBuffer,this.stencilBuffer=s.stencilBuffer,this.depthTexture=s.depthTexture,this.texture.length=0;for(let c=0,p=s.texture.length;c<p;c++)this.texture[c]=s.texture[c].clone();return this}}LM.prototype.isWebGLMultipleRenderTargets=!0;class Km extends js{constructor(s,c,p={}){super(s,c,p),this.samples=4,this.ignoreDepthForMultisampleCopy=p.ignoreDepth!==void 0?p.ignoreDepth:!0,this.useRenderToTexture=p.useRenderToTexture!==void 0?p.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(s){return super.copy.call(this,s),this.samples=s.samples,this.useRenderToTexture=s.useRenderToTexture,this.useRenderbuffer=s.useRenderbuffer,this}}Km.prototype.isWebGLMultisampleRenderTarget=!0;class Yr{constructor(s=0,c=0,p=0,y=1){this._x=s,this._y=c,this._z=p,this._w=y}static slerp(s,c,p,y){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),p.slerpQuaternions(s,c,y)}static slerpFlat(s,c,p,y,M,C,P){let F=p[y+0],U=p[y+1],V=p[y+2],W=p[y+3];const j=M[C+0],Y=M[C+1],ee=M[C+2],de=M[C+3];if(P===0){s[c+0]=F,s[c+1]=U,s[c+2]=V,s[c+3]=W;return}if(P===1){s[c+0]=j,s[c+1]=Y,s[c+2]=ee,s[c+3]=de;return}if(W!==de||F!==j||U!==Y||V!==ee){let xe=1-P;const re=F*j+U*Y+V*ee+W*de,Q=re>=0?1:-1,De=1-re*re;if(De>Number.EPSILON){const Ie=Math.sqrt(De),Xe=Math.atan2(Ie,re*Q);xe=Math.sin(xe*Xe)/Ie,P=Math.sin(P*Xe)/Ie}const Me=P*Q;if(F=F*xe+j*Me,U=U*xe+Y*Me,V=V*xe+ee*Me,W=W*xe+de*Me,xe===1-P){const Ie=1/Math.sqrt(F*F+U*U+V*V+W*W);F*=Ie,U*=Ie,V*=Ie,W*=Ie}}s[c]=F,s[c+1]=U,s[c+2]=V,s[c+3]=W}static multiplyQuaternionsFlat(s,c,p,y,M,C){const P=p[y],F=p[y+1],U=p[y+2],V=p[y+3],W=M[C],j=M[C+1],Y=M[C+2],ee=M[C+3];return s[c]=P*ee+V*W+F*Y-U*j,s[c+1]=F*ee+V*j+U*W-P*Y,s[c+2]=U*ee+V*Y+P*j-F*W,s[c+3]=V*ee-P*W-F*j-U*Y,s}get x(){return this._x}set x(s){this._x=s,this._onChangeCallback()}get y(){return this._y}set y(s){this._y=s,this._onChangeCallback()}get z(){return this._z}set z(s){this._z=s,this._onChangeCallback()}get w(){return this._w}set w(s){this._w=s,this._onChangeCallback()}set(s,c,p,y){return this._x=s,this._y=c,this._z=p,this._w=y,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(s){return this._x=s.x,this._y=s.y,this._z=s.z,this._w=s.w,this._onChangeCallback(),this}setFromEuler(s,c){if(!(s&&s.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const p=s._x,y=s._y,M=s._z,C=s._order,P=Math.cos,F=Math.sin,U=P(p/2),V=P(y/2),W=P(M/2),j=F(p/2),Y=F(y/2),ee=F(M/2);switch(C){case"XYZ":this._x=j*V*W+U*Y*ee,this._y=U*Y*W-j*V*ee,this._z=U*V*ee+j*Y*W,this._w=U*V*W-j*Y*ee;break;case"YXZ":this._x=j*V*W+U*Y*ee,this._y=U*Y*W-j*V*ee,this._z=U*V*ee-j*Y*W,this._w=U*V*W+j*Y*ee;break;case"ZXY":this._x=j*V*W-U*Y*ee,this._y=U*Y*W+j*V*ee,this._z=U*V*ee+j*Y*W,this._w=U*V*W-j*Y*ee;break;case"ZYX":this._x=j*V*W-U*Y*ee,this._y=U*Y*W+j*V*ee,this._z=U*V*ee-j*Y*W,this._w=U*V*W+j*Y*ee;break;case"YZX":this._x=j*V*W+U*Y*ee,this._y=U*Y*W+j*V*ee,this._z=U*V*ee-j*Y*W,this._w=U*V*W-j*Y*ee;break;case"XZY":this._x=j*V*W-U*Y*ee,this._y=U*Y*W-j*V*ee,this._z=U*V*ee+j*Y*W,this._w=U*V*W+j*Y*ee;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+C)}return c!==!1&&this._onChangeCallback(),this}setFromAxisAngle(s,c){const p=c/2,y=Math.sin(p);return this._x=s.x*y,this._y=s.y*y,this._z=s.z*y,this._w=Math.cos(p),this._onChangeCallback(),this}setFromRotationMatrix(s){const c=s.elements,p=c[0],y=c[4],M=c[8],C=c[1],P=c[5],F=c[9],U=c[2],V=c[6],W=c[10],j=p+P+W;if(j>0){const Y=.5/Math.sqrt(j+1);this._w=.25/Y,this._x=(V-F)*Y,this._y=(M-U)*Y,this._z=(C-y)*Y}else if(p>P&&p>W){const Y=2*Math.sqrt(1+p-P-W);this._w=(V-F)/Y,this._x=.25*Y,this._y=(y+C)/Y,this._z=(M+U)/Y}else if(P>W){const Y=2*Math.sqrt(1+P-p-W);this._w=(M-U)/Y,this._x=(y+C)/Y,this._y=.25*Y,this._z=(F+V)/Y}else{const Y=2*Math.sqrt(1+W-p-P);this._w=(C-y)/Y,this._x=(M+U)/Y,this._y=(F+V)/Y,this._z=.25*Y}return this._onChangeCallback(),this}setFromUnitVectors(s,c){let p=s.dot(c)+1;return p<Number.EPSILON?(p=0,Math.abs(s.x)>Math.abs(s.z)?(this._x=-s.y,this._y=s.x,this._z=0,this._w=p):(this._x=0,this._y=-s.z,this._z=s.y,this._w=p)):(this._x=s.y*c.z-s.z*c.y,this._y=s.z*c.x-s.x*c.z,this._z=s.x*c.y-s.y*c.x,this._w=p),this.normalize()}angleTo(s){return 2*Math.acos(Math.abs(ss(this.dot(s),-1,1)))}rotateTowards(s,c){const p=this.angleTo(s);if(p===0)return this;const y=Math.min(1,c/p);return this.slerp(s,y),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(s){return this._x*s._x+this._y*s._y+this._z*s._z+this._w*s._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let s=this.length();return s===0?(this._x=0,this._y=0,this._z=0,this._w=1):(s=1/s,this._x=this._x*s,this._y=this._y*s,this._z=this._z*s,this._w=this._w*s),this._onChangeCallback(),this}multiply(s,c){return c!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(s,c)):this.multiplyQuaternions(this,s)}premultiply(s){return this.multiplyQuaternions(s,this)}multiplyQuaternions(s,c){const p=s._x,y=s._y,M=s._z,C=s._w,P=c._x,F=c._y,U=c._z,V=c._w;return this._x=p*V+C*P+y*U-M*F,this._y=y*V+C*F+M*P-p*U,this._z=M*V+C*U+p*F-y*P,this._w=C*V-p*P-y*F-M*U,this._onChangeCallback(),this}slerp(s,c){if(c===0)return this;if(c===1)return this.copy(s);const p=this._x,y=this._y,M=this._z,C=this._w;let P=C*s._w+p*s._x+y*s._y+M*s._z;if(P<0?(this._w=-s._w,this._x=-s._x,this._y=-s._y,this._z=-s._z,P=-P):this.copy(s),P>=1)return this._w=C,this._x=p,this._y=y,this._z=M,this;const F=1-P*P;if(F<=Number.EPSILON){const Y=1-c;return this._w=Y*C+c*this._w,this._x=Y*p+c*this._x,this._y=Y*y+c*this._y,this._z=Y*M+c*this._z,this.normalize(),this._onChangeCallback(),this}const U=Math.sqrt(F),V=Math.atan2(U,P),W=Math.sin((1-c)*V)/U,j=Math.sin(c*V)/U;return this._w=C*W+this._w*j,this._x=p*W+this._x*j,this._y=y*W+this._y*j,this._z=M*W+this._z*j,this._onChangeCallback(),this}slerpQuaternions(s,c,p){return this.copy(s).slerp(c,p)}random(){const s=Math.random(),c=Math.sqrt(1-s),p=Math.sqrt(s),y=2*Math.PI*Math.random(),M=2*Math.PI*Math.random();return this.set(c*Math.cos(y),p*Math.sin(M),p*Math.cos(M),c*Math.sin(y))}equals(s){return s._x===this._x&&s._y===this._y&&s._z===this._z&&s._w===this._w}fromArray(s,c=0){return this._x=s[c],this._y=s[c+1],this._z=s[c+2],this._w=s[c+3],this._onChangeCallback(),this}toArray(s=[],c=0){return s[c]=this._x,s[c+1]=this._y,s[c+2]=this._z,s[c+3]=this._w,s}fromBufferAttribute(s,c){return this._x=s.getX(c),this._y=s.getY(c),this._z=s.getZ(c),this._w=s.getW(c),this}_onChange(s){return this._onChangeCallback=s,this}_onChangeCallback(){}}Yr.prototype.isQuaternion=!0;class Ge{constructor(s=0,c=0,p=0){this.x=s,this.y=c,this.z=p}set(s,c,p){return p===void 0&&(p=this.z),this.x=s,this.y=c,this.z=p,this}setScalar(s){return this.x=s,this.y=s,this.z=s,this}setX(s){return this.x=s,this}setY(s){return this.y=s,this}setZ(s){return this.z=s,this}setComponent(s,c){switch(s){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+s)}return this}getComponent(s){switch(s){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+s)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(s){return this.x=s.x,this.y=s.y,this.z=s.z,this}add(s,c){return c!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(s,c)):(this.x+=s.x,this.y+=s.y,this.z+=s.z,this)}addScalar(s){return this.x+=s,this.y+=s,this.z+=s,this}addVectors(s,c){return this.x=s.x+c.x,this.y=s.y+c.y,this.z=s.z+c.z,this}addScaledVector(s,c){return this.x+=s.x*c,this.y+=s.y*c,this.z+=s.z*c,this}sub(s,c){return c!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(s,c)):(this.x-=s.x,this.y-=s.y,this.z-=s.z,this)}subScalar(s){return this.x-=s,this.y-=s,this.z-=s,this}subVectors(s,c){return this.x=s.x-c.x,this.y=s.y-c.y,this.z=s.z-c.z,this}multiply(s,c){return c!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(s,c)):(this.x*=s.x,this.y*=s.y,this.z*=s.z,this)}multiplyScalar(s){return this.x*=s,this.y*=s,this.z*=s,this}multiplyVectors(s,c){return this.x=s.x*c.x,this.y=s.y*c.y,this.z=s.z*c.z,this}applyEuler(s){return s&&s.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(PM.setFromEuler(s))}applyAxisAngle(s,c){return this.applyQuaternion(PM.setFromAxisAngle(s,c))}applyMatrix3(s){const c=this.x,p=this.y,y=this.z,M=s.elements;return this.x=M[0]*c+M[3]*p+M[6]*y,this.y=M[1]*c+M[4]*p+M[7]*y,this.z=M[2]*c+M[5]*p+M[8]*y,this}applyNormalMatrix(s){return this.applyMatrix3(s).normalize()}applyMatrix4(s){const c=this.x,p=this.y,y=this.z,M=s.elements,C=1/(M[3]*c+M[7]*p+M[11]*y+M[15]);return this.x=(M[0]*c+M[4]*p+M[8]*y+M[12])*C,this.y=(M[1]*c+M[5]*p+M[9]*y+M[13])*C,this.z=(M[2]*c+M[6]*p+M[10]*y+M[14])*C,this}applyQuaternion(s){const c=this.x,p=this.y,y=this.z,M=s.x,C=s.y,P=s.z,F=s.w,U=F*c+C*y-P*p,V=F*p+P*c-M*y,W=F*y+M*p-C*c,j=-M*c-C*p-P*y;return this.x=U*F+j*-M+V*-P-W*-C,this.y=V*F+j*-C+W*-M-U*-P,this.z=W*F+j*-P+U*-C-V*-M,this}project(s){return this.applyMatrix4(s.matrixWorldInverse).applyMatrix4(s.projectionMatrix)}unproject(s){return this.applyMatrix4(s.projectionMatrixInverse).applyMatrix4(s.matrixWorld)}transformDirection(s){const c=this.x,p=this.y,y=this.z,M=s.elements;return this.x=M[0]*c+M[4]*p+M[8]*y,this.y=M[1]*c+M[5]*p+M[9]*y,this.z=M[2]*c+M[6]*p+M[10]*y,this.normalize()}divide(s){return this.x/=s.x,this.y/=s.y,this.z/=s.z,this}divideScalar(s){return this.multiplyScalar(1/s)}min(s){return this.x=Math.min(this.x,s.x),this.y=Math.min(this.y,s.y),this.z=Math.min(this.z,s.z),this}max(s){return this.x=Math.max(this.x,s.x),this.y=Math.max(this.y,s.y),this.z=Math.max(this.z,s.z),this}clamp(s,c){return this.x=Math.max(s.x,Math.min(c.x,this.x)),this.y=Math.max(s.y,Math.min(c.y,this.y)),this.z=Math.max(s.z,Math.min(c.z,this.z)),this}clampScalar(s,c){return this.x=Math.max(s,Math.min(c,this.x)),this.y=Math.max(s,Math.min(c,this.y)),this.z=Math.max(s,Math.min(c,this.z)),this}clampLength(s,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(s,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(s){return this.x*s.x+this.y*s.y+this.z*s.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(s){return this.normalize().multiplyScalar(s)}lerp(s,c){return this.x+=(s.x-this.x)*c,this.y+=(s.y-this.y)*c,this.z+=(s.z-this.z)*c,this}lerpVectors(s,c,p){return this.x=s.x+(c.x-s.x)*p,this.y=s.y+(c.y-s.y)*p,this.z=s.z+(c.z-s.z)*p,this}cross(s,c){return c!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(s,c)):this.crossVectors(this,s)}crossVectors(s,c){const p=s.x,y=s.y,M=s.z,C=c.x,P=c.y,F=c.z;return this.x=y*F-M*P,this.y=M*C-p*F,this.z=p*P-y*C,this}projectOnVector(s){const c=s.lengthSq();if(c===0)return this.set(0,0,0);const p=s.dot(this)/c;return this.copy(s).multiplyScalar(p)}projectOnPlane(s){return _x.copy(this).projectOnVector(s),this.sub(_x)}reflect(s){return this.sub(_x.copy(s).multiplyScalar(2*this.dot(s)))}angleTo(s){const c=Math.sqrt(this.lengthSq()*s.lengthSq());if(c===0)return Math.PI/2;const p=this.dot(s)/c;return Math.acos(ss(p,-1,1))}distanceTo(s){return Math.sqrt(this.distanceToSquared(s))}distanceToSquared(s){const c=this.x-s.x,p=this.y-s.y,y=this.z-s.z;return c*c+p*p+y*y}manhattanDistanceTo(s){return Math.abs(this.x-s.x)+Math.abs(this.y-s.y)+Math.abs(this.z-s.z)}setFromSpherical(s){return this.setFromSphericalCoords(s.radius,s.phi,s.theta)}setFromSphericalCoords(s,c,p){const y=Math.sin(c)*s;return this.x=y*Math.sin(p),this.y=Math.cos(c)*s,this.z=y*Math.cos(p),this}setFromCylindrical(s){return this.setFromCylindricalCoords(s.radius,s.theta,s.y)}setFromCylindricalCoords(s,c,p){return this.x=s*Math.sin(c),this.y=p,this.z=s*Math.cos(c),this}setFromMatrixPosition(s){const c=s.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(s){const c=this.setFromMatrixColumn(s,0).length(),p=this.setFromMatrixColumn(s,1).length(),y=this.setFromMatrixColumn(s,2).length();return this.x=c,this.y=p,this.z=y,this}setFromMatrixColumn(s,c){return this.fromArray(s.elements,c*4)}setFromMatrix3Column(s,c){return this.fromArray(s.elements,c*3)}equals(s){return s.x===this.x&&s.y===this.y&&s.z===this.z}fromArray(s,c=0){return this.x=s[c],this.y=s[c+1],this.z=s[c+2],this}toArray(s=[],c=0){return s[c]=this.x,s[c+1]=this.y,s[c+2]=this.z,s}fromBufferAttribute(s,c,p){return p!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=s.getX(c),this.y=s.getY(c),this.z=s.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const s=(Math.random()-.5)*2,c=Math.random()*Math.PI*2,p=Math.sqrt(1-s**2);return this.x=p*Math.cos(c),this.y=p*Math.sin(c),this.z=s,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}Ge.prototype.isVector3=!0;const _x=new Ge,PM=new Yr;class $s{constructor(s=new Ge(1/0,1/0,1/0),c=new Ge(-1/0,-1/0,-1/0)){this.min=s,this.max=c}set(s,c){return this.min.copy(s),this.max.copy(c),this}setFromArray(s){let c=1/0,p=1/0,y=1/0,M=-1/0,C=-1/0,P=-1/0;for(let F=0,U=s.length;F<U;F+=3){const V=s[F],W=s[F+1],j=s[F+2];V<c&&(c=V),W<p&&(p=W),j<y&&(y=j),V>M&&(M=V),W>C&&(C=W),j>P&&(P=j)}return this.min.set(c,p,y),this.max.set(M,C,P),this}setFromBufferAttribute(s){let c=1/0,p=1/0,y=1/0,M=-1/0,C=-1/0,P=-1/0;for(let F=0,U=s.count;F<U;F++){const V=s.getX(F),W=s.getY(F),j=s.getZ(F);V<c&&(c=V),W<p&&(p=W),j<y&&(y=j),V>M&&(M=V),W>C&&(C=W),j>P&&(P=j)}return this.min.set(c,p,y),this.max.set(M,C,P),this}setFromPoints(s){this.makeEmpty();for(let c=0,p=s.length;c<p;c++)this.expandByPoint(s[c]);return this}setFromCenterAndSize(s,c){const p=Hc.copy(c).multiplyScalar(.5);return this.min.copy(s).sub(p),this.max.copy(s).add(p),this}setFromObject(s,c=!1){return this.makeEmpty(),this.expandByObject(s,c)}clone(){return new this.constructor().copy(this)}copy(s){return this.min.copy(s.min),this.max.copy(s.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(s){return this.isEmpty()?s.set(0,0,0):s.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(s){return this.isEmpty()?s.set(0,0,0):s.subVectors(this.max,this.min)}expandByPoint(s){return this.min.min(s),this.max.max(s),this}expandByVector(s){return this.min.sub(s),this.max.add(s),this}expandByScalar(s){return this.min.addScalar(-s),this.max.addScalar(s),this}expandByObject(s,c=!1){s.updateWorldMatrix(!1,!1);const p=s.geometry;if(p!==void 0)if(c&&p.attributes!=null&&p.attributes.position!==void 0){const M=p.attributes.position;for(let C=0,P=M.count;C<P;C++)Hc.fromBufferAttribute(M,C).applyMatrix4(s.matrixWorld),this.expandByPoint(Hc)}else p.boundingBox===null&&p.computeBoundingBox(),bx.copy(p.boundingBox),bx.applyMatrix4(s.matrixWorld),this.union(bx);const y=s.children;for(let M=0,C=y.length;M<C;M++)this.expandByObject(y[M],c);return this}containsPoint(s){return!(s.x<this.min.x||s.x>this.max.x||s.y<this.min.y||s.y>this.max.y||s.z<this.min.z||s.z>this.max.z)}containsBox(s){return this.min.x<=s.min.x&&s.max.x<=this.max.x&&this.min.y<=s.min.y&&s.max.y<=this.max.y&&this.min.z<=s.min.z&&s.max.z<=this.max.z}getParameter(s,c){return c.set((s.x-this.min.x)/(this.max.x-this.min.x),(s.y-this.min.y)/(this.max.y-this.min.y),(s.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(s){return!(s.max.x<this.min.x||s.min.x>this.max.x||s.max.y<this.min.y||s.min.y>this.max.y||s.max.z<this.min.z||s.min.z>this.max.z)}intersectsSphere(s){return this.clampPoint(s.center,Hc),Hc.distanceToSquared(s.center)<=s.radius*s.radius}intersectsPlane(s){let c,p;return s.normal.x>0?(c=s.normal.x*this.min.x,p=s.normal.x*this.max.x):(c=s.normal.x*this.max.x,p=s.normal.x*this.min.x),s.normal.y>0?(c+=s.normal.y*this.min.y,p+=s.normal.y*this.max.y):(c+=s.normal.y*this.max.y,p+=s.normal.y*this.min.y),s.normal.z>0?(c+=s.normal.z*this.min.z,p+=s.normal.z*this.max.z):(c+=s.normal.z*this.max.z,p+=s.normal.z*this.min.z),c<=-s.constant&&p>=-s.constant}intersectsTriangle(s){if(this.isEmpty())return!1;this.getCenter(_f),Qm.subVectors(this.max,_f),ih.subVectors(s.a,_f),rh.subVectors(s.b,_f),sh.subVectors(s.c,_f),Dl.subVectors(rh,ih),Ol.subVectors(sh,rh),Gc.subVectors(ih,sh);let c=[0,-Dl.z,Dl.y,0,-Ol.z,Ol.y,0,-Gc.z,Gc.y,Dl.z,0,-Dl.x,Ol.z,0,-Ol.x,Gc.z,0,-Gc.x,-Dl.y,Dl.x,0,-Ol.y,Ol.x,0,-Gc.y,Gc.x,0];return!Ex(c,ih,rh,sh,Qm)||(c=[1,0,0,0,1,0,0,0,1],!Ex(c,ih,rh,sh,Qm))?!1:(Zm.crossVectors(Dl,Ol),c=[Zm.x,Zm.y,Zm.z],Ex(c,ih,rh,sh,Qm))}clampPoint(s,c){return c.copy(s).clamp(this.min,this.max)}distanceToPoint(s){return Hc.copy(s).clamp(this.min,this.max).sub(s).length()}getBoundingSphere(s){return this.getCenter(s.center),s.radius=this.getSize(Hc).length()*.5,s}intersect(s){return this.min.max(s.min),this.max.min(s.max),this.isEmpty()&&this.makeEmpty(),this}union(s){return this.min.min(s.min),this.max.max(s.max),this}applyMatrix4(s){return this.isEmpty()?this:(Na[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(s),Na[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(s),Na[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(s),Na[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(s),Na[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(s),Na[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(s),Na[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(s),Na[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(s),this.setFromPoints(Na),this)}translate(s){return this.min.add(s),this.max.add(s),this}equals(s){return s.min.equals(this.min)&&s.max.equals(this.max)}}$s.prototype.isBox3=!0;const Na=[new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge,new Ge],Hc=new Ge,bx=new $s,ih=new Ge,rh=new Ge,sh=new Ge,Dl=new Ge,Ol=new Ge,Gc=new Ge,_f=new Ge,Qm=new Ge,Zm=new Ge,Vc=new Ge;function Ex(b,s,c,p,y){for(let M=0,C=b.length-3;M<=C;M+=3){Vc.fromArray(b,M);const P=y.x*Math.abs(Vc.x)+y.y*Math.abs(Vc.y)+y.z*Math.abs(Vc.z),F=s.dot(Vc),U=c.dot(Vc),V=p.dot(Vc);if(Math.max(-Math.max(F,U,V),Math.min(F,U,V))>P)return!1}return!0}const IN=new $s,DM=new Ge,Jm=new Ge,Ax=new Ge;class Il{constructor(s=new Ge,c=-1){this.center=s,this.radius=c}set(s,c){return this.center.copy(s),this.radius=c,this}setFromPoints(s,c){const p=this.center;c!==void 0?p.copy(c):IN.setFromPoints(s).getCenter(p);let y=0;for(let M=0,C=s.length;M<C;M++)y=Math.max(y,p.distanceToSquared(s[M]));return this.radius=Math.sqrt(y),this}copy(s){return this.center.copy(s.center),this.radius=s.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(s){return s.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(s){return s.distanceTo(this.center)-this.radius}intersectsSphere(s){const c=this.radius+s.radius;return s.center.distanceToSquared(this.center)<=c*c}intersectsBox(s){return s.intersectsSphere(this)}intersectsPlane(s){return Math.abs(s.distanceToPoint(this.center))<=this.radius}clampPoint(s,c){const p=this.center.distanceToSquared(s);return c.copy(s),p>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(s){return this.isEmpty()?(s.makeEmpty(),s):(s.set(this.center,this.center),s.expandByScalar(this.radius),s)}applyMatrix4(s){return this.center.applyMatrix4(s),this.radius=this.radius*s.getMaxScaleOnAxis(),this}translate(s){return this.center.add(s),this}expandByPoint(s){Ax.subVectors(s,this.center);const c=Ax.lengthSq();if(c>this.radius*this.radius){const p=Math.sqrt(c),y=(p-this.radius)*.5;this.center.add(Ax.multiplyScalar(y/p)),this.radius+=y}return this}union(s){return this.center.equals(s.center)===!0?Jm.set(0,0,1).multiplyScalar(s.radius):Jm.subVectors(s.center,this.center).normalize().multiplyScalar(s.radius),this.expandByPoint(DM.copy(s.center).add(Jm)),this.expandByPoint(DM.copy(s.center).sub(Jm)),this}equals(s){return s.center.equals(this.center)&&s.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Fa=new Ge,wx=new Ge,eg=new Ge,kl=new Ge,Mx=new Ge,tg=new Ge,Sx=new Ge;class Nl{constructor(s=new Ge,c=new Ge(0,0,-1)){this.origin=s,this.direction=c}set(s,c){return this.origin.copy(s),this.direction.copy(c),this}copy(s){return this.origin.copy(s.origin),this.direction.copy(s.direction),this}at(s,c){return c.copy(this.direction).multiplyScalar(s).add(this.origin)}lookAt(s){return this.direction.copy(s).sub(this.origin).normalize(),this}recast(s){return this.origin.copy(this.at(s,Fa)),this}closestPointToPoint(s,c){c.subVectors(s,this.origin);const p=c.dot(this.direction);return p<0?c.copy(this.origin):c.copy(this.direction).multiplyScalar(p).add(this.origin)}distanceToPoint(s){return Math.sqrt(this.distanceSqToPoint(s))}distanceSqToPoint(s){const c=Fa.subVectors(s,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(s):(Fa.copy(this.direction).multiplyScalar(c).add(this.origin),Fa.distanceToSquared(s))}distanceSqToSegment(s,c,p,y){wx.copy(s).add(c).multiplyScalar(.5),eg.copy(c).sub(s).normalize(),kl.copy(this.origin).sub(wx);const M=s.distanceTo(c)*.5,C=-this.direction.dot(eg),P=kl.dot(this.direction),F=-kl.dot(eg),U=kl.lengthSq(),V=Math.abs(1-C*C);let W,j,Y,ee;if(V>0)if(W=C*F-P,j=C*P-F,ee=M*V,W>=0)if(j>=-ee)if(j<=ee){const de=1/V;W*=de,j*=de,Y=W*(W+C*j+2*P)+j*(C*W+j+2*F)+U}else j=M,W=Math.max(0,-(C*j+P)),Y=-W*W+j*(j+2*F)+U;else j=-M,W=Math.max(0,-(C*j+P)),Y=-W*W+j*(j+2*F)+U;else j<=-ee?(W=Math.max(0,-(-C*M+P)),j=W>0?-M:Math.min(Math.max(-M,-F),M),Y=-W*W+j*(j+2*F)+U):j<=ee?(W=0,j=Math.min(Math.max(-M,-F),M),Y=j*(j+2*F)+U):(W=Math.max(0,-(C*M+P)),j=W>0?M:Math.min(Math.max(-M,-F),M),Y=-W*W+j*(j+2*F)+U);else j=C>0?-M:M,W=Math.max(0,-(C*j+P)),Y=-W*W+j*(j+2*F)+U;return p&&p.copy(this.direction).multiplyScalar(W).add(this.origin),y&&y.copy(eg).multiplyScalar(j).add(wx),Y}intersectSphere(s,c){Fa.subVectors(s.center,this.origin);const p=Fa.dot(this.direction),y=Fa.dot(Fa)-p*p,M=s.radius*s.radius;if(y>M)return null;const C=Math.sqrt(M-y),P=p-C,F=p+C;return P<0&&F<0?null:P<0?this.at(F,c):this.at(P,c)}intersectsSphere(s){return this.distanceSqToPoint(s.center)<=s.radius*s.radius}distanceToPlane(s){const c=s.normal.dot(this.direction);if(c===0)return s.distanceToPoint(this.origin)===0?0:null;const p=-(this.origin.dot(s.normal)+s.constant)/c;return p>=0?p:null}intersectPlane(s,c){const p=this.distanceToPlane(s);return p===null?null:this.at(p,c)}intersectsPlane(s){const c=s.distanceToPoint(this.origin);return c===0||s.normal.dot(this.direction)*c<0}intersectBox(s,c){let p,y,M,C,P,F;const U=1/this.direction.x,V=1/this.direction.y,W=1/this.direction.z,j=this.origin;return U>=0?(p=(s.min.x-j.x)*U,y=(s.max.x-j.x)*U):(p=(s.max.x-j.x)*U,y=(s.min.x-j.x)*U),V>=0?(M=(s.min.y-j.y)*V,C=(s.max.y-j.y)*V):(M=(s.max.y-j.y)*V,C=(s.min.y-j.y)*V),p>C||M>y||((M>p||p!==p)&&(p=M),(C<y||y!==y)&&(y=C),W>=0?(P=(s.min.z-j.z)*W,F=(s.max.z-j.z)*W):(P=(s.max.z-j.z)*W,F=(s.min.z-j.z)*W),p>F||P>y)||((P>p||p!==p)&&(p=P),(F<y||y!==y)&&(y=F),y<0)?null:this.at(p>=0?p:y,c)}intersectsBox(s){return this.intersectBox(s,Fa)!==null}intersectTriangle(s,c,p,y,M){Mx.subVectors(c,s),tg.subVectors(p,s),Sx.crossVectors(Mx,tg);let C=this.direction.dot(Sx),P;if(C>0){if(y)return null;P=1}else if(C<0)P=-1,C=-C;else return null;kl.subVectors(this.origin,s);const F=P*this.direction.dot(tg.crossVectors(kl,tg));if(F<0)return null;const U=P*this.direction.dot(Mx.cross(kl));if(U<0||F+U>C)return null;const V=-P*kl.dot(Sx);return V<0?null:this.at(V/C,M)}applyMatrix4(s){return this.origin.applyMatrix4(s),this.direction.transformDirection(s),this}equals(s){return s.origin.equals(this.origin)&&s.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class zn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(s,c,p,y,M,C,P,F,U,V,W,j,Y,ee,de,xe){const re=this.elements;return re[0]=s,re[4]=c,re[8]=p,re[12]=y,re[1]=M,re[5]=C,re[9]=P,re[13]=F,re[2]=U,re[6]=V,re[10]=W,re[14]=j,re[3]=Y,re[7]=ee,re[11]=de,re[15]=xe,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new zn().fromArray(this.elements)}copy(s){const c=this.elements,p=s.elements;return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],c[9]=p[9],c[10]=p[10],c[11]=p[11],c[12]=p[12],c[13]=p[13],c[14]=p[14],c[15]=p[15],this}copyPosition(s){const c=this.elements,p=s.elements;return c[12]=p[12],c[13]=p[13],c[14]=p[14],this}setFromMatrix3(s){const c=s.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(s,c,p){return s.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),p.setFromMatrixColumn(this,2),this}makeBasis(s,c,p){return this.set(s.x,c.x,p.x,0,s.y,c.y,p.y,0,s.z,c.z,p.z,0,0,0,0,1),this}extractRotation(s){const c=this.elements,p=s.elements,y=1/oh.setFromMatrixColumn(s,0).length(),M=1/oh.setFromMatrixColumn(s,1).length(),C=1/oh.setFromMatrixColumn(s,2).length();return c[0]=p[0]*y,c[1]=p[1]*y,c[2]=p[2]*y,c[3]=0,c[4]=p[4]*M,c[5]=p[5]*M,c[6]=p[6]*M,c[7]=0,c[8]=p[8]*C,c[9]=p[9]*C,c[10]=p[10]*C,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(s){s&&s.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const c=this.elements,p=s.x,y=s.y,M=s.z,C=Math.cos(p),P=Math.sin(p),F=Math.cos(y),U=Math.sin(y),V=Math.cos(M),W=Math.sin(M);if(s.order==="XYZ"){const j=C*V,Y=C*W,ee=P*V,de=P*W;c[0]=F*V,c[4]=-F*W,c[8]=U,c[1]=Y+ee*U,c[5]=j-de*U,c[9]=-P*F,c[2]=de-j*U,c[6]=ee+Y*U,c[10]=C*F}else if(s.order==="YXZ"){const j=F*V,Y=F*W,ee=U*V,de=U*W;c[0]=j+de*P,c[4]=ee*P-Y,c[8]=C*U,c[1]=C*W,c[5]=C*V,c[9]=-P,c[2]=Y*P-ee,c[6]=de+j*P,c[10]=C*F}else if(s.order==="ZXY"){const j=F*V,Y=F*W,ee=U*V,de=U*W;c[0]=j-de*P,c[4]=-C*W,c[8]=ee+Y*P,c[1]=Y+ee*P,c[5]=C*V,c[9]=de-j*P,c[2]=-C*U,c[6]=P,c[10]=C*F}else if(s.order==="ZYX"){const j=C*V,Y=C*W,ee=P*V,de=P*W;c[0]=F*V,c[4]=ee*U-Y,c[8]=j*U+de,c[1]=F*W,c[5]=de*U+j,c[9]=Y*U-ee,c[2]=-U,c[6]=P*F,c[10]=C*F}else if(s.order==="YZX"){const j=C*F,Y=C*U,ee=P*F,de=P*U;c[0]=F*V,c[4]=de-j*W,c[8]=ee*W+Y,c[1]=W,c[5]=C*V,c[9]=-P*V,c[2]=-U*V,c[6]=Y*W+ee,c[10]=j-de*W}else if(s.order==="XZY"){const j=C*F,Y=C*U,ee=P*F,de=P*U;c[0]=F*V,c[4]=-W,c[8]=U*V,c[1]=j*W+de,c[5]=C*V,c[9]=Y*W-ee,c[2]=ee*W-Y,c[6]=P*V,c[10]=de*W+j}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(s){return this.compose(kN,s,NN)}lookAt(s,c,p){const y=this.elements;return Xs.subVectors(s,c),Xs.lengthSq()===0&&(Xs.z=1),Xs.normalize(),Fl.crossVectors(p,Xs),Fl.lengthSq()===0&&(Math.abs(p.z)===1?Xs.x+=1e-4:Xs.z+=1e-4,Xs.normalize(),Fl.crossVectors(p,Xs)),Fl.normalize(),ng.crossVectors(Xs,Fl),y[0]=Fl.x,y[4]=ng.x,y[8]=Xs.x,y[1]=Fl.y,y[5]=ng.y,y[9]=Xs.y,y[2]=Fl.z,y[6]=ng.z,y[10]=Xs.z,this}multiply(s,c){return c!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(s,c)):this.multiplyMatrices(this,s)}premultiply(s){return this.multiplyMatrices(s,this)}multiplyMatrices(s,c){const p=s.elements,y=c.elements,M=this.elements,C=p[0],P=p[4],F=p[8],U=p[12],V=p[1],W=p[5],j=p[9],Y=p[13],ee=p[2],de=p[6],xe=p[10],re=p[14],Q=p[3],De=p[7],Me=p[11],Ie=p[15],Xe=y[0],st=y[4],ut=y[8],Dt=y[12],Rt=y[1],Ee=y[5],Ye=y[9],vt=y[13],Et=y[2],gt=y[6],Lt=y[10],Vt=y[14],on=y[3],Cn=y[7],Qn=y[11],Dn=y[15];return M[0]=C*Xe+P*Rt+F*Et+U*on,M[4]=C*st+P*Ee+F*gt+U*Cn,M[8]=C*ut+P*Ye+F*Lt+U*Qn,M[12]=C*Dt+P*vt+F*Vt+U*Dn,M[1]=V*Xe+W*Rt+j*Et+Y*on,M[5]=V*st+W*Ee+j*gt+Y*Cn,M[9]=V*ut+W*Ye+j*Lt+Y*Qn,M[13]=V*Dt+W*vt+j*Vt+Y*Dn,M[2]=ee*Xe+de*Rt+xe*Et+re*on,M[6]=ee*st+de*Ee+xe*gt+re*Cn,M[10]=ee*ut+de*Ye+xe*Lt+re*Qn,M[14]=ee*Dt+de*vt+xe*Vt+re*Dn,M[3]=Q*Xe+De*Rt+Me*Et+Ie*on,M[7]=Q*st+De*Ee+Me*gt+Ie*Cn,M[11]=Q*ut+De*Ye+Me*Lt+Ie*Qn,M[15]=Q*Dt+De*vt+Me*Vt+Ie*Dn,this}multiplyScalar(s){const c=this.elements;return c[0]*=s,c[4]*=s,c[8]*=s,c[12]*=s,c[1]*=s,c[5]*=s,c[9]*=s,c[13]*=s,c[2]*=s,c[6]*=s,c[10]*=s,c[14]*=s,c[3]*=s,c[7]*=s,c[11]*=s,c[15]*=s,this}determinant(){const s=this.elements,c=s[0],p=s[4],y=s[8],M=s[12],C=s[1],P=s[5],F=s[9],U=s[13],V=s[2],W=s[6],j=s[10],Y=s[14],ee=s[3],de=s[7],xe=s[11],re=s[15];return ee*(+M*F*W-y*U*W-M*P*j+p*U*j+y*P*Y-p*F*Y)+de*(+c*F*Y-c*U*j+M*C*j-y*C*Y+y*U*V-M*F*V)+xe*(+c*U*W-c*P*Y-M*C*W+p*C*Y+M*P*V-p*U*V)+re*(-y*P*V-c*F*W+c*P*j+y*C*W-p*C*j+p*F*V)}transpose(){const s=this.elements;let c;return c=s[1],s[1]=s[4],s[4]=c,c=s[2],s[2]=s[8],s[8]=c,c=s[6],s[6]=s[9],s[9]=c,c=s[3],s[3]=s[12],s[12]=c,c=s[7],s[7]=s[13],s[13]=c,c=s[11],s[11]=s[14],s[14]=c,this}setPosition(s,c,p){const y=this.elements;return s.isVector3?(y[12]=s.x,y[13]=s.y,y[14]=s.z):(y[12]=s,y[13]=c,y[14]=p),this}invert(){const s=this.elements,c=s[0],p=s[1],y=s[2],M=s[3],C=s[4],P=s[5],F=s[6],U=s[7],V=s[8],W=s[9],j=s[10],Y=s[11],ee=s[12],de=s[13],xe=s[14],re=s[15],Q=W*xe*U-de*j*U+de*F*Y-P*xe*Y-W*F*re+P*j*re,De=ee*j*U-V*xe*U-ee*F*Y+C*xe*Y+V*F*re-C*j*re,Me=V*de*U-ee*W*U+ee*P*Y-C*de*Y-V*P*re+C*W*re,Ie=ee*W*F-V*de*F-ee*P*j+C*de*j+V*P*xe-C*W*xe,Xe=c*Q+p*De+y*Me+M*Ie;if(Xe===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const st=1/Xe;return s[0]=Q*st,s[1]=(de*j*M-W*xe*M-de*y*Y+p*xe*Y+W*y*re-p*j*re)*st,s[2]=(P*xe*M-de*F*M+de*y*U-p*xe*U-P*y*re+p*F*re)*st,s[3]=(W*F*M-P*j*M-W*y*U+p*j*U+P*y*Y-p*F*Y)*st,s[4]=De*st,s[5]=(V*xe*M-ee*j*M+ee*y*Y-c*xe*Y-V*y*re+c*j*re)*st,s[6]=(ee*F*M-C*xe*M-ee*y*U+c*xe*U+C*y*re-c*F*re)*st,s[7]=(C*j*M-V*F*M+V*y*U-c*j*U-C*y*Y+c*F*Y)*st,s[8]=Me*st,s[9]=(ee*W*M-V*de*M-ee*p*Y+c*de*Y+V*p*re-c*W*re)*st,s[10]=(C*de*M-ee*P*M+ee*p*U-c*de*U-C*p*re+c*P*re)*st,s[11]=(V*P*M-C*W*M-V*p*U+c*W*U+C*p*Y-c*P*Y)*st,s[12]=Ie*st,s[13]=(V*de*y-ee*W*y+ee*p*j-c*de*j-V*p*xe+c*W*xe)*st,s[14]=(ee*P*y-C*de*y-ee*p*F+c*de*F+C*p*xe-c*P*xe)*st,s[15]=(C*W*y-V*P*y+V*p*F-c*W*F-C*p*j+c*P*j)*st,this}scale(s){const c=this.elements,p=s.x,y=s.y,M=s.z;return c[0]*=p,c[4]*=y,c[8]*=M,c[1]*=p,c[5]*=y,c[9]*=M,c[2]*=p,c[6]*=y,c[10]*=M,c[3]*=p,c[7]*=y,c[11]*=M,this}getMaxScaleOnAxis(){const s=this.elements,c=s[0]*s[0]+s[1]*s[1]+s[2]*s[2],p=s[4]*s[4]+s[5]*s[5]+s[6]*s[6],y=s[8]*s[8]+s[9]*s[9]+s[10]*s[10];return Math.sqrt(Math.max(c,p,y))}makeTranslation(s,c,p){return this.set(1,0,0,s,0,1,0,c,0,0,1,p,0,0,0,1),this}makeRotationX(s){const c=Math.cos(s),p=Math.sin(s);return this.set(1,0,0,0,0,c,-p,0,0,p,c,0,0,0,0,1),this}makeRotationY(s){const c=Math.cos(s),p=Math.sin(s);return this.set(c,0,p,0,0,1,0,0,-p,0,c,0,0,0,0,1),this}makeRotationZ(s){const c=Math.cos(s),p=Math.sin(s);return this.set(c,-p,0,0,p,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(s,c){const p=Math.cos(c),y=Math.sin(c),M=1-p,C=s.x,P=s.y,F=s.z,U=M*C,V=M*P;return this.set(U*C+p,U*P-y*F,U*F+y*P,0,U*P+y*F,V*P+p,V*F-y*C,0,U*F-y*P,V*F+y*C,M*F*F+p,0,0,0,0,1),this}makeScale(s,c,p){return this.set(s,0,0,0,0,c,0,0,0,0,p,0,0,0,0,1),this}makeShear(s,c,p,y,M,C){return this.set(1,p,M,0,s,1,C,0,c,y,1,0,0,0,0,1),this}compose(s,c,p){const y=this.elements,M=c._x,C=c._y,P=c._z,F=c._w,U=M+M,V=C+C,W=P+P,j=M*U,Y=M*V,ee=M*W,de=C*V,xe=C*W,re=P*W,Q=F*U,De=F*V,Me=F*W,Ie=p.x,Xe=p.y,st=p.z;return y[0]=(1-(de+re))*Ie,y[1]=(Y+Me)*Ie,y[2]=(ee-De)*Ie,y[3]=0,y[4]=(Y-Me)*Xe,y[5]=(1-(j+re))*Xe,y[6]=(xe+Q)*Xe,y[7]=0,y[8]=(ee+De)*st,y[9]=(xe-Q)*st,y[10]=(1-(j+de))*st,y[11]=0,y[12]=s.x,y[13]=s.y,y[14]=s.z,y[15]=1,this}decompose(s,c,p){const y=this.elements;let M=oh.set(y[0],y[1],y[2]).length();const C=oh.set(y[4],y[5],y[6]).length(),P=oh.set(y[8],y[9],y[10]).length();this.determinant()<0&&(M=-M),s.x=y[12],s.y=y[13],s.z=y[14],Oo.copy(this);const U=1/M,V=1/C,W=1/P;return Oo.elements[0]*=U,Oo.elements[1]*=U,Oo.elements[2]*=U,Oo.elements[4]*=V,Oo.elements[5]*=V,Oo.elements[6]*=V,Oo.elements[8]*=W,Oo.elements[9]*=W,Oo.elements[10]*=W,c.setFromRotationMatrix(Oo),p.x=M,p.y=C,p.z=P,this}makePerspective(s,c,p,y,M,C){C===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const P=this.elements,F=2*M/(c-s),U=2*M/(p-y),V=(c+s)/(c-s),W=(p+y)/(p-y),j=-(C+M)/(C-M),Y=-2*C*M/(C-M);return P[0]=F,P[4]=0,P[8]=V,P[12]=0,P[1]=0,P[5]=U,P[9]=W,P[13]=0,P[2]=0,P[6]=0,P[10]=j,P[14]=Y,P[3]=0,P[7]=0,P[11]=-1,P[15]=0,this}makeOrthographic(s,c,p,y,M,C){const P=this.elements,F=1/(c-s),U=1/(p-y),V=1/(C-M),W=(c+s)*F,j=(p+y)*U,Y=(C+M)*V;return P[0]=2*F,P[4]=0,P[8]=0,P[12]=-W,P[1]=0,P[5]=2*U,P[9]=0,P[13]=-j,P[2]=0,P[6]=0,P[10]=-2*V,P[14]=-Y,P[3]=0,P[7]=0,P[11]=0,P[15]=1,this}equals(s){const c=this.elements,p=s.elements;for(let y=0;y<16;y++)if(c[y]!==p[y])return!1;return!0}fromArray(s,c=0){for(let p=0;p<16;p++)this.elements[p]=s[p+c];return this}toArray(s=[],c=0){const p=this.elements;return s[c]=p[0],s[c+1]=p[1],s[c+2]=p[2],s[c+3]=p[3],s[c+4]=p[4],s[c+5]=p[5],s[c+6]=p[6],s[c+7]=p[7],s[c+8]=p[8],s[c+9]=p[9],s[c+10]=p[10],s[c+11]=p[11],s[c+12]=p[12],s[c+13]=p[13],s[c+14]=p[14],s[c+15]=p[15],s}}zn.prototype.isMatrix4=!0;const oh=new Ge,Oo=new zn,kN=new Ge(0,0,0),NN=new Ge(1,1,1),Fl=new Ge,ng=new Ge,Xs=new Ge,OM=new zn,IM=new Yr;class Wc{constructor(s=0,c=0,p=0,y=Wc.DefaultOrder){this._x=s,this._y=c,this._z=p,this._order=y}get x(){return this._x}set x(s){this._x=s,this._onChangeCallback()}get y(){return this._y}set y(s){this._y=s,this._onChangeCallback()}get z(){return this._z}set z(s){this._z=s,this._onChangeCallback()}get order(){return this._order}set order(s){this._order=s,this._onChangeCallback()}set(s,c,p,y=this._order){return this._x=s,this._y=c,this._z=p,this._order=y,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(s){return this._x=s._x,this._y=s._y,this._z=s._z,this._order=s._order,this._onChangeCallback(),this}setFromRotationMatrix(s,c=this._order,p=!0){const y=s.elements,M=y[0],C=y[4],P=y[8],F=y[1],U=y[5],V=y[9],W=y[2],j=y[6],Y=y[10];switch(c){case"XYZ":this._y=Math.asin(ss(P,-1,1)),Math.abs(P)<.9999999?(this._x=Math.atan2(-V,Y),this._z=Math.atan2(-C,M)):(this._x=Math.atan2(j,U),this._z=0);break;case"YXZ":this._x=Math.asin(-ss(V,-1,1)),Math.abs(V)<.9999999?(this._y=Math.atan2(P,Y),this._z=Math.atan2(F,U)):(this._y=Math.atan2(-W,M),this._z=0);break;case"ZXY":this._x=Math.asin(ss(j,-1,1)),Math.abs(j)<.9999999?(this._y=Math.atan2(-W,Y),this._z=Math.atan2(-C,U)):(this._y=0,this._z=Math.atan2(F,M));break;case"ZYX":this._y=Math.asin(-ss(W,-1,1)),Math.abs(W)<.9999999?(this._x=Math.atan2(j,Y),this._z=Math.atan2(F,M)):(this._x=0,this._z=Math.atan2(-C,U));break;case"YZX":this._z=Math.asin(ss(F,-1,1)),Math.abs(F)<.9999999?(this._x=Math.atan2(-V,U),this._y=Math.atan2(-W,M)):(this._x=0,this._y=Math.atan2(P,Y));break;case"XZY":this._z=Math.asin(-ss(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(j,U),this._y=Math.atan2(P,M)):(this._x=Math.atan2(-V,Y),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}return this._order=c,p===!0&&this._onChangeCallback(),this}setFromQuaternion(s,c,p){return OM.makeRotationFromQuaternion(s),this.setFromRotationMatrix(OM,c,p)}setFromVector3(s,c=this._order){return this.set(s.x,s.y,s.z,c)}reorder(s){return IM.setFromEuler(this),this.setFromQuaternion(IM,s)}equals(s){return s._x===this._x&&s._y===this._y&&s._z===this._z&&s._order===this._order}fromArray(s){return this._x=s[0],this._y=s[1],this._z=s[2],s[3]!==void 0&&(this._order=s[3]),this._onChangeCallback(),this}toArray(s=[],c=0){return s[c]=this._x,s[c+1]=this._y,s[c+2]=this._z,s[c+3]=this._order,s}toVector3(s){return s?s.set(this._x,this._y,this._z):new Ge(this._x,this._y,this._z)}_onChange(s){return this._onChangeCallback=s,this}_onChangeCallback(){}}Wc.prototype.isEuler=!0,Wc.DefaultOrder="XYZ",Wc.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class ig{constructor(){this.mask=1}set(s){this.mask=(1<<s|0)>>>0}enable(s){this.mask|=1<<s|0}enableAll(){this.mask=-1}toggle(s){this.mask^=1<<s|0}disable(s){this.mask&=~(1<<s|0)}disableAll(){this.mask=0}test(s){return(this.mask&s.mask)!==0}isEnabled(s){return(this.mask&(1<<s|0))!==0}}let FN=0;const kM=new Ge,ah=new Yr,Ba=new zn,rg=new Ge,bf=new Ge,BN=new Ge,UN=new Yr,NM=new Ge(1,0,0),FM=new Ge(0,1,0),BM=new Ge(0,0,1),zN={type:"added"},UM={type:"removed"};class Oi extends ka{constructor(){super(),Object.defineProperty(this,"id",{value:FN++}),this.uuid=Ws(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Oi.DefaultUp.clone();const s=new Ge,c=new Wc,p=new Yr,y=new Ge(1,1,1);function M(){p.setFromEuler(c,!1)}function C(){c.setFromQuaternion(p,void 0,!1)}c._onChange(M),p._onChange(C),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:s},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:p},scale:{configurable:!0,enumerable:!0,value:y},modelViewMatrix:{value:new zn},normalMatrix:{value:new Hr}}),this.matrix=new zn,this.matrixWorld=new zn,this.matrixAutoUpdate=Oi.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ig,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(s){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(s),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(s){return this.quaternion.premultiply(s),this}setRotationFromAxisAngle(s,c){this.quaternion.setFromAxisAngle(s,c)}setRotationFromEuler(s){this.quaternion.setFromEuler(s,!0)}setRotationFromMatrix(s){this.quaternion.setFromRotationMatrix(s)}setRotationFromQuaternion(s){this.quaternion.copy(s)}rotateOnAxis(s,c){return ah.setFromAxisAngle(s,c),this.quaternion.multiply(ah),this}rotateOnWorldAxis(s,c){return ah.setFromAxisAngle(s,c),this.quaternion.premultiply(ah),this}rotateX(s){return this.rotateOnAxis(NM,s)}rotateY(s){return this.rotateOnAxis(FM,s)}rotateZ(s){return this.rotateOnAxis(BM,s)}translateOnAxis(s,c){return kM.copy(s).applyQuaternion(this.quaternion),this.position.add(kM.multiplyScalar(c)),this}translateX(s){return this.translateOnAxis(NM,s)}translateY(s){return this.translateOnAxis(FM,s)}translateZ(s){return this.translateOnAxis(BM,s)}localToWorld(s){return s.applyMatrix4(this.matrixWorld)}worldToLocal(s){return s.applyMatrix4(Ba.copy(this.matrixWorld).invert())}lookAt(s,c,p){s.isVector3?rg.copy(s):rg.set(s,c,p);const y=this.parent;this.updateWorldMatrix(!0,!1),bf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ba.lookAt(bf,rg,this.up):Ba.lookAt(rg,bf,this.up),this.quaternion.setFromRotationMatrix(Ba),y&&(Ba.extractRotation(y.matrixWorld),ah.setFromRotationMatrix(Ba),this.quaternion.premultiply(ah.invert()))}add(s){if(arguments.length>1){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}return s===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",s),this):(s&&s.isObject3D?(s.parent!==null&&s.parent.remove(s),s.parent=this,this.children.push(s),s.dispatchEvent(zN)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",s),this)}remove(s){if(arguments.length>1){for(let p=0;p<arguments.length;p++)this.remove(arguments[p]);return this}const c=this.children.indexOf(s);return c!==-1&&(s.parent=null,this.children.splice(c,1),s.dispatchEvent(UM)),this}removeFromParent(){const s=this.parent;return s!==null&&s.remove(this),this}clear(){for(let s=0;s<this.children.length;s++){const c=this.children[s];c.parent=null,c.dispatchEvent(UM)}return this.children.length=0,this}attach(s){return this.updateWorldMatrix(!0,!1),Ba.copy(this.matrixWorld).invert(),s.parent!==null&&(s.parent.updateWorldMatrix(!0,!1),Ba.multiply(s.parent.matrixWorld)),s.applyMatrix4(Ba),this.add(s),s.updateWorldMatrix(!1,!0),this}getObjectById(s){return this.getObjectByProperty("id",s)}getObjectByName(s){return this.getObjectByProperty("name",s)}getObjectByProperty(s,c){if(this[s]===c)return this;for(let p=0,y=this.children.length;p<y;p++){const C=this.children[p].getObjectByProperty(s,c);if(C!==void 0)return C}}getWorldPosition(s){return this.updateWorldMatrix(!0,!1),s.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(s){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bf,s,BN),s}getWorldScale(s){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(bf,UN,s),s}getWorldDirection(s){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return s.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(s){s(this);const c=this.children;for(let p=0,y=c.length;p<y;p++)c[p].traverse(s)}traverseVisible(s){if(this.visible===!1)return;s(this);const c=this.children;for(let p=0,y=c.length;p<y;p++)c[p].traverseVisible(s)}traverseAncestors(s){const c=this.parent;c!==null&&(s(c),c.traverseAncestors(s))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(s){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||s)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,s=!0);const c=this.children;for(let p=0,y=c.length;p<y;p++)c[p].updateMatrixWorld(s)}updateWorldMatrix(s,c){const p=this.parent;if(s===!0&&p!==null&&p.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),c===!0){const y=this.children;for(let M=0,C=y.length;M<C;M++)y[M].updateWorldMatrix(!1,!0)}}toJSON(s){const c=s===void 0||typeof s=="string",p={};c&&(s={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},p.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const y={};y.uuid=this.uuid,y.type=this.type,this.name!==""&&(y.name=this.name),this.castShadow===!0&&(y.castShadow=!0),this.receiveShadow===!0&&(y.receiveShadow=!0),this.visible===!1&&(y.visible=!1),this.frustumCulled===!1&&(y.frustumCulled=!1),this.renderOrder!==0&&(y.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(y.userData=this.userData),y.layers=this.layers.mask,y.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(y.matrixAutoUpdate=!1),this.isInstancedMesh&&(y.type="InstancedMesh",y.count=this.count,y.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(y.instanceColor=this.instanceColor.toJSON()));function M(P,F){return P[F.uuid]===void 0&&(P[F.uuid]=F.toJSON(s)),F.uuid}if(this.isScene)this.background&&(this.background.isColor?y.background=this.background.toJSON():this.background.isTexture&&(y.background=this.background.toJSON(s).uuid)),this.environment&&this.environment.isTexture&&(y.environment=this.environment.toJSON(s).uuid);else if(this.isMesh||this.isLine||this.isPoints){y.geometry=M(s.geometries,this.geometry);const P=this.geometry.parameters;if(P!==void 0&&P.shapes!==void 0){const F=P.shapes;if(Array.isArray(F))for(let U=0,V=F.length;U<V;U++){const W=F[U];M(s.shapes,W)}else M(s.shapes,F)}}if(this.isSkinnedMesh&&(y.bindMode=this.bindMode,y.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(M(s.skeletons,this.skeleton),y.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const P=[];for(let F=0,U=this.material.length;F<U;F++)P.push(M(s.materials,this.material[F]));y.material=P}else y.material=M(s.materials,this.material);if(this.children.length>0){y.children=[];for(let P=0;P<this.children.length;P++)y.children.push(this.children[P].toJSON(s).object)}if(this.animations.length>0){y.animations=[];for(let P=0;P<this.animations.length;P++){const F=this.animations[P];y.animations.push(M(s.animations,F))}}if(c){const P=C(s.geometries),F=C(s.materials),U=C(s.textures),V=C(s.images),W=C(s.shapes),j=C(s.skeletons),Y=C(s.animations);P.length>0&&(p.geometries=P),F.length>0&&(p.materials=F),U.length>0&&(p.textures=U),V.length>0&&(p.images=V),W.length>0&&(p.shapes=W),j.length>0&&(p.skeletons=j),Y.length>0&&(p.animations=Y)}return p.object=y,p;function C(P){const F=[];for(const U in P){const V=P[U];delete V.metadata,F.push(V)}return F}}clone(s){return new this.constructor().copy(this,s)}copy(s,c=!0){if(this.name=s.name,this.up.copy(s.up),this.position.copy(s.position),this.rotation.order=s.rotation.order,this.quaternion.copy(s.quaternion),this.scale.copy(s.scale),this.matrix.copy(s.matrix),this.matrixWorld.copy(s.matrixWorld),this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrixWorldNeedsUpdate=s.matrixWorldNeedsUpdate,this.layers.mask=s.layers.mask,this.visible=s.visible,this.castShadow=s.castShadow,this.receiveShadow=s.receiveShadow,this.frustumCulled=s.frustumCulled,this.renderOrder=s.renderOrder,this.userData=JSON.parse(JSON.stringify(s.userData)),c===!0)for(let p=0;p<s.children.length;p++){const y=s.children[p];this.add(y.clone())}return this}}Oi.DefaultUp=new Ge(0,1,0),Oi.DefaultMatrixAutoUpdate=!0,Oi.prototype.isObject3D=!0;const Io=new Ge,Ua=new Ge,Tx=new Ge,za=new Ge,lh=new Ge,ch=new Ge,zM=new Ge,Cx=new Ge,Rx=new Ge,Lx=new Ge;class Dr{constructor(s=new Ge,c=new Ge,p=new Ge){this.a=s,this.b=c,this.c=p}static getNormal(s,c,p,y){y.subVectors(p,c),Io.subVectors(s,c),y.cross(Io);const M=y.lengthSq();return M>0?y.multiplyScalar(1/Math.sqrt(M)):y.set(0,0,0)}static getBarycoord(s,c,p,y,M){Io.subVectors(y,c),Ua.subVectors(p,c),Tx.subVectors(s,c);const C=Io.dot(Io),P=Io.dot(Ua),F=Io.dot(Tx),U=Ua.dot(Ua),V=Ua.dot(Tx),W=C*U-P*P;if(W===0)return M.set(-2,-1,-1);const j=1/W,Y=(U*F-P*V)*j,ee=(C*V-P*F)*j;return M.set(1-Y-ee,ee,Y)}static containsPoint(s,c,p,y){return this.getBarycoord(s,c,p,y,za),za.x>=0&&za.y>=0&&za.x+za.y<=1}static getUV(s,c,p,y,M,C,P,F){return this.getBarycoord(s,c,p,y,za),F.set(0,0),F.addScaledVector(M,za.x),F.addScaledVector(C,za.y),F.addScaledVector(P,za.z),F}static isFrontFacing(s,c,p,y){return Io.subVectors(p,c),Ua.subVectors(s,c),Io.cross(Ua).dot(y)<0}set(s,c,p){return this.a.copy(s),this.b.copy(c),this.c.copy(p),this}setFromPointsAndIndices(s,c,p,y){return this.a.copy(s[c]),this.b.copy(s[p]),this.c.copy(s[y]),this}setFromAttributeAndIndices(s,c,p,y){return this.a.fromBufferAttribute(s,c),this.b.fromBufferAttribute(s,p),this.c.fromBufferAttribute(s,y),this}clone(){return new this.constructor().copy(this)}copy(s){return this.a.copy(s.a),this.b.copy(s.b),this.c.copy(s.c),this}getArea(){return Io.subVectors(this.c,this.b),Ua.subVectors(this.a,this.b),Io.cross(Ua).length()*.5}getMidpoint(s){return s.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(s){return Dr.getNormal(this.a,this.b,this.c,s)}getPlane(s){return s.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(s,c){return Dr.getBarycoord(s,this.a,this.b,this.c,c)}getUV(s,c,p,y,M){return Dr.getUV(s,this.a,this.b,this.c,c,p,y,M)}containsPoint(s){return Dr.containsPoint(s,this.a,this.b,this.c)}isFrontFacing(s){return Dr.isFrontFacing(this.a,this.b,this.c,s)}intersectsBox(s){return s.intersectsTriangle(this)}closestPointToPoint(s,c){const p=this.a,y=this.b,M=this.c;let C,P;lh.subVectors(y,p),ch.subVectors(M,p),Cx.subVectors(s,p);const F=lh.dot(Cx),U=ch.dot(Cx);if(F<=0&&U<=0)return c.copy(p);Rx.subVectors(s,y);const V=lh.dot(Rx),W=ch.dot(Rx);if(V>=0&&W<=V)return c.copy(y);const j=F*W-V*U;if(j<=0&&F>=0&&V<=0)return C=F/(F-V),c.copy(p).addScaledVector(lh,C);Lx.subVectors(s,M);const Y=lh.dot(Lx),ee=ch.dot(Lx);if(ee>=0&&Y<=ee)return c.copy(M);const de=Y*U-F*ee;if(de<=0&&U>=0&&ee<=0)return P=U/(U-ee),c.copy(p).addScaledVector(ch,P);const xe=V*ee-Y*W;if(xe<=0&&W-V>=0&&Y-ee>=0)return zM.subVectors(M,y),P=(W-V)/(W-V+(Y-ee)),c.copy(y).addScaledVector(zM,P);const re=1/(xe+de+j);return C=de*re,P=j*re,c.copy(p).addScaledVector(lh,C).addScaledVector(ch,P)}equals(s){return s.a.equals(this.a)&&s.b.equals(this.b)&&s.c.equals(this.c)}}let HN=0;class Kr extends ka{constructor(){super(),Object.defineProperty(this,"id",{value:HN++}),this.uuid=Ws(),this.name="",this.type="Material",this.fog=!0,this.blending=N,this.side=w,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=ue,this.blendDst=ye,this.blendEquation=ne,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Jt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=wM,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ti,this.stencilZFail=Ti,this.stencilZPass=Ti,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(s){this._alphaTest>0!=s>0&&this.version++,this._alphaTest=s}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(s){if(s!==void 0)for(const c in s){const p=s[c];if(p===void 0){console.warn("THREE.Material: '"+c+"' parameter is undefined.");continue}if(c==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=p===R;continue}const y=this[c];if(y===void 0){console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.");continue}y&&y.isColor?y.set(p):y&&y.isVector3&&p&&p.isVector3?y.copy(p):this[c]=p}}toJSON(s){const c=s===void 0||typeof s=="string";c&&(s={textures:{},images:{}});const p={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};p.uuid=this.uuid,p.type=this.type,this.name!==""&&(p.name=this.name),this.color&&this.color.isColor&&(p.color=this.color.getHex()),this.roughness!==void 0&&(p.roughness=this.roughness),this.metalness!==void 0&&(p.metalness=this.metalness),this.sheen!==void 0&&(p.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(p.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(p.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(p.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(p.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(p.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(p.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(p.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(p.shininess=this.shininess),this.clearcoat!==void 0&&(p.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(p.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(p.clearcoatMap=this.clearcoatMap.toJSON(s).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(p.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(s).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(p.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(s).uuid,p.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(p.map=this.map.toJSON(s).uuid),this.matcap&&this.matcap.isTexture&&(p.matcap=this.matcap.toJSON(s).uuid),this.alphaMap&&this.alphaMap.isTexture&&(p.alphaMap=this.alphaMap.toJSON(s).uuid),this.lightMap&&this.lightMap.isTexture&&(p.lightMap=this.lightMap.toJSON(s).uuid,p.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(p.aoMap=this.aoMap.toJSON(s).uuid,p.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(p.bumpMap=this.bumpMap.toJSON(s).uuid,p.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(p.normalMap=this.normalMap.toJSON(s).uuid,p.normalMapType=this.normalMapType,p.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(p.displacementMap=this.displacementMap.toJSON(s).uuid,p.displacementScale=this.displacementScale,p.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(p.roughnessMap=this.roughnessMap.toJSON(s).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(p.metalnessMap=this.metalnessMap.toJSON(s).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(p.emissiveMap=this.emissiveMap.toJSON(s).uuid),this.specularMap&&this.specularMap.isTexture&&(p.specularMap=this.specularMap.toJSON(s).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(p.specularIntensityMap=this.specularIntensityMap.toJSON(s).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(p.specularColorMap=this.specularColorMap.toJSON(s).uuid),this.envMap&&this.envMap.isTexture&&(p.envMap=this.envMap.toJSON(s).uuid,this.combine!==void 0&&(p.combine=this.combine)),this.envMapIntensity!==void 0&&(p.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(p.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(p.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(p.gradientMap=this.gradientMap.toJSON(s).uuid),this.transmission!==void 0&&(p.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(p.transmissionMap=this.transmissionMap.toJSON(s).uuid),this.thickness!==void 0&&(p.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(p.thicknessMap=this.thicknessMap.toJSON(s).uuid),this.attenuationDistance!==void 0&&(p.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(p.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(p.size=this.size),this.shadowSide!==null&&(p.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(p.sizeAttenuation=this.sizeAttenuation),this.blending!==N&&(p.blending=this.blending),this.side!==w&&(p.side=this.side),this.vertexColors&&(p.vertexColors=!0),this.opacity<1&&(p.opacity=this.opacity),this.transparent===!0&&(p.transparent=this.transparent),p.depthFunc=this.depthFunc,p.depthTest=this.depthTest,p.depthWrite=this.depthWrite,p.colorWrite=this.colorWrite,p.alphaWrite=this.alphaWrite,p.stencilWrite=this.stencilWrite,p.stencilWriteMask=this.stencilWriteMask,p.stencilFunc=this.stencilFunc,p.stencilRef=this.stencilRef,p.stencilFuncMask=this.stencilFuncMask,p.stencilFail=this.stencilFail,p.stencilZFail=this.stencilZFail,p.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(p.rotation=this.rotation),this.polygonOffset===!0&&(p.polygonOffset=!0),this.polygonOffsetFactor!==0&&(p.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(p.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(p.linewidth=this.linewidth),this.dashSize!==void 0&&(p.dashSize=this.dashSize),this.gapSize!==void 0&&(p.gapSize=this.gapSize),this.scale!==void 0&&(p.scale=this.scale),this.dithering===!0&&(p.dithering=!0),this.alphaTest>0&&(p.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(p.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(p.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(p.wireframe=this.wireframe),this.wireframeLinewidth>1&&(p.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(p.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(p.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(p.flatShading=this.flatShading),this.visible===!1&&(p.visible=!1),this.toneMapped===!1&&(p.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(p.userData=this.userData);function y(M){const C=[];for(const P in M){const F=M[P];delete F.metadata,C.push(F)}return C}if(c){const M=y(s.textures),C=y(s.images);M.length>0&&(p.textures=M),C.length>0&&(p.images=C)}return p}clone(){return new this.constructor().copy(this)}copy(s){this.name=s.name,this.fog=s.fog,this.blending=s.blending,this.side=s.side,this.vertexColors=s.vertexColors,this.opacity=s.opacity,this.transparent=s.transparent,this.blendSrc=s.blendSrc,this.blendDst=s.blendDst,this.blendEquation=s.blendEquation,this.blendSrcAlpha=s.blendSrcAlpha,this.blendDstAlpha=s.blendDstAlpha,this.blendEquationAlpha=s.blendEquationAlpha,this.depthFunc=s.depthFunc,this.depthTest=s.depthTest,this.depthWrite=s.depthWrite,this.stencilWriteMask=s.stencilWriteMask,this.stencilFunc=s.stencilFunc,this.stencilRef=s.stencilRef,this.stencilFuncMask=s.stencilFuncMask,this.stencilFail=s.stencilFail,this.stencilZFail=s.stencilZFail,this.stencilZPass=s.stencilZPass,this.stencilWrite=s.stencilWrite;const c=s.clippingPlanes;let p=null;if(c!==null){const y=c.length;p=new Array(y);for(let M=0;M!==y;++M)p[M]=c[M].clone()}return this.clippingPlanes=p,this.clipIntersection=s.clipIntersection,this.clipShadows=s.clipShadows,this.shadowSide=s.shadowSide,this.colorWrite=s.colorWrite,this.alphaWrite=s.alphaWrite,this.precision=s.precision,this.polygonOffset=s.polygonOffset,this.polygonOffsetFactor=s.polygonOffsetFactor,this.polygonOffsetUnits=s.polygonOffsetUnits,this.dithering=s.dithering,this.alphaTest=s.alphaTest,this.alphaToCoverage=s.alphaToCoverage,this.premultipliedAlpha=s.premultipliedAlpha,this.visible=s.visible,this.toneMapped=s.toneMapped,this.userData=JSON.parse(JSON.stringify(s.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(s){s===!0&&this.version++}}Kr.prototype.isMaterial=!0;class Ha extends Kr{constructor(s){super(),this.type="MeshBasicMaterial",this.color=new Tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=At,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this}}Ha.prototype.isMeshBasicMaterial=!0;const lr=new Ge,sg=new Qt;class Hi{constructor(s,c,p){if(Array.isArray(s))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=s,this.itemSize=c,this.count=s!==void 0?s.length/c:0,this.normalized=p===!0,this.usage=Zu,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(s){s===!0&&this.version++}setUsage(s){return this.usage=s,this}copy(s){return this.name=s.name,this.array=new s.array.constructor(s.array),this.itemSize=s.itemSize,this.count=s.count,this.normalized=s.normalized,this.usage=s.usage,this}copyAt(s,c,p){s*=this.itemSize,p*=c.itemSize;for(let y=0,M=this.itemSize;y<M;y++)this.array[s+y]=c.array[p+y];return this}copyArray(s){return this.array.set(s),this}copyColorsArray(s){const c=this.array;let p=0;for(let y=0,M=s.length;y<M;y++){let C=s[y];C===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",y),C=new Tn),c[p++]=C.r,c[p++]=C.g,c[p++]=C.b}return this}copyVector2sArray(s){const c=this.array;let p=0;for(let y=0,M=s.length;y<M;y++){let C=s[y];C===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",y),C=new Qt),c[p++]=C.x,c[p++]=C.y}return this}copyVector3sArray(s){const c=this.array;let p=0;for(let y=0,M=s.length;y<M;y++){let C=s[y];C===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",y),C=new Ge),c[p++]=C.x,c[p++]=C.y,c[p++]=C.z}return this}copyVector4sArray(s){const c=this.array;let p=0;for(let y=0,M=s.length;y<M;y++){let C=s[y];C===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",y),C=new Qi),c[p++]=C.x,c[p++]=C.y,c[p++]=C.z,c[p++]=C.w}return this}applyMatrix3(s){if(this.itemSize===2)for(let c=0,p=this.count;c<p;c++)sg.fromBufferAttribute(this,c),sg.applyMatrix3(s),this.setXY(c,sg.x,sg.y);else if(this.itemSize===3)for(let c=0,p=this.count;c<p;c++)lr.fromBufferAttribute(this,c),lr.applyMatrix3(s),this.setXYZ(c,lr.x,lr.y,lr.z);return this}applyMatrix4(s){for(let c=0,p=this.count;c<p;c++)lr.x=this.getX(c),lr.y=this.getY(c),lr.z=this.getZ(c),lr.applyMatrix4(s),this.setXYZ(c,lr.x,lr.y,lr.z);return this}applyNormalMatrix(s){for(let c=0,p=this.count;c<p;c++)lr.x=this.getX(c),lr.y=this.getY(c),lr.z=this.getZ(c),lr.applyNormalMatrix(s),this.setXYZ(c,lr.x,lr.y,lr.z);return this}transformDirection(s){for(let c=0,p=this.count;c<p;c++)lr.x=this.getX(c),lr.y=this.getY(c),lr.z=this.getZ(c),lr.transformDirection(s),this.setXYZ(c,lr.x,lr.y,lr.z);return this}set(s,c=0){return this.array.set(s,c),this}getX(s){return this.array[s*this.itemSize]}setX(s,c){return this.array[s*this.itemSize]=c,this}getY(s){return this.array[s*this.itemSize+1]}setY(s,c){return this.array[s*this.itemSize+1]=c,this}getZ(s){return this.array[s*this.itemSize+2]}setZ(s,c){return this.array[s*this.itemSize+2]=c,this}getW(s){return this.array[s*this.itemSize+3]}setW(s,c){return this.array[s*this.itemSize+3]=c,this}setXY(s,c,p){return s*=this.itemSize,this.array[s+0]=c,this.array[s+1]=p,this}setXYZ(s,c,p,y){return s*=this.itemSize,this.array[s+0]=c,this.array[s+1]=p,this.array[s+2]=y,this}setXYZW(s,c,p,y,M){return s*=this.itemSize,this.array[s+0]=c,this.array[s+1]=p,this.array[s+2]=y,this.array[s+3]=M,this}onUpload(s){return this.onUploadCallback=s,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const s={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(s.name=this.name),this.usage!==Zu&&(s.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(s.updateRange=this.updateRange),s}}Hi.prototype.isBufferAttribute=!0;class HM extends Hi{constructor(s,c,p){super(new Int8Array(s),c,p)}}class GM extends Hi{constructor(s,c,p){super(new Uint8Array(s),c,p)}}class VM extends Hi{constructor(s,c,p){super(new Uint8ClampedArray(s),c,p)}}class WM extends Hi{constructor(s,c,p){super(new Int16Array(s),c,p)}}class og extends Hi{constructor(s,c,p){super(new Uint16Array(s),c,p)}}class jM extends Hi{constructor(s,c,p){super(new Int32Array(s),c,p)}}class ag extends Hi{constructor(s,c,p){super(new Uint32Array(s),c,p)}}class $M extends Hi{constructor(s,c,p){super(new Uint16Array(s),c,p)}}$M.prototype.isFloat16BufferAttribute=!0;class Hn extends Hi{constructor(s,c,p){super(new Float32Array(s),c,p)}}class XM extends Hi{constructor(s,c,p){super(new Float64Array(s),c,p)}}let GN=0;const po=new zn,Px=new Oi,uh=new Ge,qs=new $s,Ef=new $s,Qr=new Ge;class si extends ka{constructor(){super(),Object.defineProperty(this,"id",{value:GN++}),this.uuid=Ws(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(s){return Array.isArray(s)?this.index=new(CM(s)?ag:og)(s,1):this.index=s,this}getAttribute(s){return this.attributes[s]}setAttribute(s,c){return this.attributes[s]=c,this}deleteAttribute(s){return delete this.attributes[s],this}hasAttribute(s){return this.attributes[s]!==void 0}addGroup(s,c,p=0){this.groups.push({start:s,count:c,materialIndex:p})}clearGroups(){this.groups=[]}setDrawRange(s,c){this.drawRange.start=s,this.drawRange.count=c}applyMatrix4(s){const c=this.attributes.position;c!==void 0&&(c.applyMatrix4(s),c.needsUpdate=!0);const p=this.attributes.normal;if(p!==void 0){const M=new Hr().getNormalMatrix(s);p.applyNormalMatrix(M),p.needsUpdate=!0}const y=this.attributes.tangent;return y!==void 0&&(y.transformDirection(s),y.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(s){return po.makeRotationFromQuaternion(s),this.applyMatrix4(po),this}rotateX(s){return po.makeRotationX(s),this.applyMatrix4(po),this}rotateY(s){return po.makeRotationY(s),this.applyMatrix4(po),this}rotateZ(s){return po.makeRotationZ(s),this.applyMatrix4(po),this}translate(s,c,p){return po.makeTranslation(s,c,p),this.applyMatrix4(po),this}scale(s,c,p){return po.makeScale(s,c,p),this.applyMatrix4(po),this}lookAt(s){return Px.lookAt(s),Px.updateMatrix(),this.applyMatrix4(Px.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(uh).negate(),this.translate(uh.x,uh.y,uh.z),this}setFromPoints(s){const c=[];for(let p=0,y=s.length;p<y;p++){const M=s[p];c.push(M.x,M.y,M.z||0)}return this.setAttribute("position",new Hn(c,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new $s);const s=this.attributes.position,c=this.morphAttributes.position;if(s&&s.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ge(-1/0,-1/0,-1/0),new Ge(1/0,1/0,1/0));return}if(s!==void 0){if(this.boundingBox.setFromBufferAttribute(s),c)for(let p=0,y=c.length;p<y;p++){const M=c[p];qs.setFromBufferAttribute(M),this.morphTargetsRelative?(Qr.addVectors(this.boundingBox.min,qs.min),this.boundingBox.expandByPoint(Qr),Qr.addVectors(this.boundingBox.max,qs.max),this.boundingBox.expandByPoint(Qr)):(this.boundingBox.expandByPoint(qs.min),this.boundingBox.expandByPoint(qs.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Il);const s=this.attributes.position,c=this.morphAttributes.position;if(s&&s.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ge,1/0);return}if(s){const p=this.boundingSphere.center;if(qs.setFromBufferAttribute(s),c)for(let M=0,C=c.length;M<C;M++){const P=c[M];Ef.setFromBufferAttribute(P),this.morphTargetsRelative?(Qr.addVectors(qs.min,Ef.min),qs.expandByPoint(Qr),Qr.addVectors(qs.max,Ef.max),qs.expandByPoint(Qr)):(qs.expandByPoint(Ef.min),qs.expandByPoint(Ef.max))}qs.getCenter(p);let y=0;for(let M=0,C=s.count;M<C;M++)Qr.fromBufferAttribute(s,M),y=Math.max(y,p.distanceToSquared(Qr));if(c)for(let M=0,C=c.length;M<C;M++){const P=c[M],F=this.morphTargetsRelative;for(let U=0,V=P.count;U<V;U++)Qr.fromBufferAttribute(P,U),F&&(uh.fromBufferAttribute(s,U),Qr.add(uh)),y=Math.max(y,p.distanceToSquared(Qr))}this.boundingSphere.radius=Math.sqrt(y),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const s=this.index,c=this.attributes;if(s===null||c.position===void 0||c.normal===void 0||c.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const p=s.array,y=c.position.array,M=c.normal.array,C=c.uv.array,P=y.length/3;c.tangent===void 0&&this.setAttribute("tangent",new Hi(new Float32Array(4*P),4));const F=c.tangent.array,U=[],V=[];for(let Rt=0;Rt<P;Rt++)U[Rt]=new Ge,V[Rt]=new Ge;const W=new Ge,j=new Ge,Y=new Ge,ee=new Qt,de=new Qt,xe=new Qt,re=new Ge,Q=new Ge;function De(Rt,Ee,Ye){W.fromArray(y,Rt*3),j.fromArray(y,Ee*3),Y.fromArray(y,Ye*3),ee.fromArray(C,Rt*2),de.fromArray(C,Ee*2),xe.fromArray(C,Ye*2),j.sub(W),Y.sub(W),de.sub(ee),xe.sub(ee);const vt=1/(de.x*xe.y-xe.x*de.y);!isFinite(vt)||(re.copy(j).multiplyScalar(xe.y).addScaledVector(Y,-de.y).multiplyScalar(vt),Q.copy(Y).multiplyScalar(de.x).addScaledVector(j,-xe.x).multiplyScalar(vt),U[Rt].add(re),U[Ee].add(re),U[Ye].add(re),V[Rt].add(Q),V[Ee].add(Q),V[Ye].add(Q))}let Me=this.groups;Me.length===0&&(Me=[{start:0,count:p.length}]);for(let Rt=0,Ee=Me.length;Rt<Ee;++Rt){const Ye=Me[Rt],vt=Ye.start,Et=Ye.count;for(let gt=vt,Lt=vt+Et;gt<Lt;gt+=3)De(p[gt+0],p[gt+1],p[gt+2])}const Ie=new Ge,Xe=new Ge,st=new Ge,ut=new Ge;function Dt(Rt){st.fromArray(M,Rt*3),ut.copy(st);const Ee=U[Rt];Ie.copy(Ee),Ie.sub(st.multiplyScalar(st.dot(Ee))).normalize(),Xe.crossVectors(ut,Ee);const vt=Xe.dot(V[Rt])<0?-1:1;F[Rt*4]=Ie.x,F[Rt*4+1]=Ie.y,F[Rt*4+2]=Ie.z,F[Rt*4+3]=vt}for(let Rt=0,Ee=Me.length;Rt<Ee;++Rt){const Ye=Me[Rt],vt=Ye.start,Et=Ye.count;for(let gt=vt,Lt=vt+Et;gt<Lt;gt+=3)Dt(p[gt+0]),Dt(p[gt+1]),Dt(p[gt+2])}}computeVertexNormals(){const s=this.index,c=this.getAttribute("position");if(c!==void 0){let p=this.getAttribute("normal");if(p===void 0)p=new Hi(new Float32Array(c.count*3),3),this.setAttribute("normal",p);else for(let j=0,Y=p.count;j<Y;j++)p.setXYZ(j,0,0,0);const y=new Ge,M=new Ge,C=new Ge,P=new Ge,F=new Ge,U=new Ge,V=new Ge,W=new Ge;if(s)for(let j=0,Y=s.count;j<Y;j+=3){const ee=s.getX(j+0),de=s.getX(j+1),xe=s.getX(j+2);y.fromBufferAttribute(c,ee),M.fromBufferAttribute(c,de),C.fromBufferAttribute(c,xe),V.subVectors(C,M),W.subVectors(y,M),V.cross(W),P.fromBufferAttribute(p,ee),F.fromBufferAttribute(p,de),U.fromBufferAttribute(p,xe),P.add(V),F.add(V),U.add(V),p.setXYZ(ee,P.x,P.y,P.z),p.setXYZ(de,F.x,F.y,F.z),p.setXYZ(xe,U.x,U.y,U.z)}else for(let j=0,Y=c.count;j<Y;j+=3)y.fromBufferAttribute(c,j+0),M.fromBufferAttribute(c,j+1),C.fromBufferAttribute(c,j+2),V.subVectors(C,M),W.subVectors(y,M),V.cross(W),p.setXYZ(j+0,V.x,V.y,V.z),p.setXYZ(j+1,V.x,V.y,V.z),p.setXYZ(j+2,V.x,V.y,V.z);this.normalizeNormals(),p.needsUpdate=!0}}merge(s,c){if(!(s&&s.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",s);return}c===void 0&&(c=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const p=this.attributes;for(const y in p){if(s.attributes[y]===void 0)continue;const C=p[y].array,P=s.attributes[y],F=P.array,U=P.itemSize*c,V=Math.min(F.length,C.length-U);for(let W=0,j=U;W<V;W++,j++)C[j]=F[W]}return this}normalizeNormals(){const s=this.attributes.normal;for(let c=0,p=s.count;c<p;c++)Qr.fromBufferAttribute(s,c),Qr.normalize(),s.setXYZ(c,Qr.x,Qr.y,Qr.z)}toNonIndexed(){function s(P,F){const U=P.array,V=P.itemSize,W=P.normalized,j=new U.constructor(F.length*V);let Y=0,ee=0;for(let de=0,xe=F.length;de<xe;de++){P.isInterleavedBufferAttribute?Y=F[de]*P.data.stride+P.offset:Y=F[de]*V;for(let re=0;re<V;re++)j[ee++]=U[Y++]}return new Hi(j,V,W)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new si,p=this.index.array,y=this.attributes;for(const P in y){const F=y[P],U=s(F,p);c.setAttribute(P,U)}const M=this.morphAttributes;for(const P in M){const F=[],U=M[P];for(let V=0,W=U.length;V<W;V++){const j=U[V],Y=s(j,p);F.push(Y)}c.morphAttributes[P]=F}c.morphTargetsRelative=this.morphTargetsRelative;const C=this.groups;for(let P=0,F=C.length;P<F;P++){const U=C[P];c.addGroup(U.start,U.count,U.materialIndex)}return c}toJSON(){const s={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),Object.keys(this.userData).length>0&&(s.userData=this.userData),this.parameters!==void 0){const F=this.parameters;for(const U in F)F[U]!==void 0&&(s[U]=F[U]);return s}s.data={attributes:{}};const c=this.index;c!==null&&(s.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const p=this.attributes;for(const F in p){const U=p[F];s.data.attributes[F]=U.toJSON(s.data)}const y={};let M=!1;for(const F in this.morphAttributes){const U=this.morphAttributes[F],V=[];for(let W=0,j=U.length;W<j;W++){const Y=U[W];V.push(Y.toJSON(s.data))}V.length>0&&(y[F]=V,M=!0)}M&&(s.data.morphAttributes=y,s.data.morphTargetsRelative=this.morphTargetsRelative);const C=this.groups;C.length>0&&(s.data.groups=JSON.parse(JSON.stringify(C)));const P=this.boundingSphere;return P!==null&&(s.data.boundingSphere={center:P.center.toArray(),radius:P.radius}),s}clone(){return new this.constructor().copy(this)}copy(s){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=s.name;const p=s.index;p!==null&&this.setIndex(p.clone(c));const y=s.attributes;for(const U in y){const V=y[U];this.setAttribute(U,V.clone(c))}const M=s.morphAttributes;for(const U in M){const V=[],W=M[U];for(let j=0,Y=W.length;j<Y;j++)V.push(W[j].clone(c));this.morphAttributes[U]=V}this.morphTargetsRelative=s.morphTargetsRelative;const C=s.groups;for(let U=0,V=C.length;U<V;U++){const W=C[U];this.addGroup(W.start,W.count,W.materialIndex)}const P=s.boundingBox;P!==null&&(this.boundingBox=P.clone());const F=s.boundingSphere;return F!==null&&(this.boundingSphere=F.clone()),this.drawRange.start=s.drawRange.start,this.drawRange.count=s.drawRange.count,this.userData=s.userData,s.parameters!==void 0&&(this.parameters=Object.assign({},s.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}si.prototype.isBufferGeometry=!0;const qM=new zn,hh=new Nl,Dx=new Il,Bl=new Ge,Ul=new Ge,zl=new Ge,Ox=new Ge,Ix=new Ge,kx=new Ge,lg=new Ge,cg=new Ge,ug=new Ge,hg=new Qt,dg=new Qt,fg=new Qt,Nx=new Ge,pg=new Ge;class Fr extends Oi{constructor(s=new si,c=new Ha){super(),this.type="Mesh",this.geometry=s,this.material=c,this.updateMorphTargets()}copy(s){return super.copy(s),s.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=s.morphTargetInfluences.slice()),s.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},s.morphTargetDictionary)),this.material=s.material,this.geometry=s.geometry,this}updateMorphTargets(){const s=this.geometry;if(s.isBufferGeometry){const c=s.morphAttributes,p=Object.keys(c);if(p.length>0){const y=c[p[0]];if(y!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let M=0,C=y.length;M<C;M++){const P=y[M].name||String(M);this.morphTargetInfluences.push(0),this.morphTargetDictionary[P]=M}}}}else{const c=s.morphTargets;c!==void 0&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(s,c){const p=this.geometry,y=this.material,M=this.matrixWorld;if(y===void 0||(p.boundingSphere===null&&p.computeBoundingSphere(),Dx.copy(p.boundingSphere),Dx.applyMatrix4(M),s.ray.intersectsSphere(Dx)===!1)||(qM.copy(M).invert(),hh.copy(s.ray).applyMatrix4(qM),p.boundingBox!==null&&hh.intersectsBox(p.boundingBox)===!1))return;let C;if(p.isBufferGeometry){const P=p.index,F=p.attributes.position,U=p.morphAttributes.position,V=p.morphTargetsRelative,W=p.attributes.uv,j=p.attributes.uv2,Y=p.groups,ee=p.drawRange;if(P!==null)if(Array.isArray(y))for(let de=0,xe=Y.length;de<xe;de++){const re=Y[de],Q=y[re.materialIndex],De=Math.max(re.start,ee.start),Me=Math.min(P.count,Math.min(re.start+re.count,ee.start+ee.count));for(let Ie=De,Xe=Me;Ie<Xe;Ie+=3){const st=P.getX(Ie),ut=P.getX(Ie+1),Dt=P.getX(Ie+2);C=mg(this,Q,s,hh,F,U,V,W,j,st,ut,Dt),C&&(C.faceIndex=Math.floor(Ie/3),C.face.materialIndex=re.materialIndex,c.push(C))}}else{const de=Math.max(0,ee.start),xe=Math.min(P.count,ee.start+ee.count);for(let re=de,Q=xe;re<Q;re+=3){const De=P.getX(re),Me=P.getX(re+1),Ie=P.getX(re+2);C=mg(this,y,s,hh,F,U,V,W,j,De,Me,Ie),C&&(C.faceIndex=Math.floor(re/3),c.push(C))}}else if(F!==void 0)if(Array.isArray(y))for(let de=0,xe=Y.length;de<xe;de++){const re=Y[de],Q=y[re.materialIndex],De=Math.max(re.start,ee.start),Me=Math.min(F.count,Math.min(re.start+re.count,ee.start+ee.count));for(let Ie=De,Xe=Me;Ie<Xe;Ie+=3){const st=Ie,ut=Ie+1,Dt=Ie+2;C=mg(this,Q,s,hh,F,U,V,W,j,st,ut,Dt),C&&(C.faceIndex=Math.floor(Ie/3),C.face.materialIndex=re.materialIndex,c.push(C))}}else{const de=Math.max(0,ee.start),xe=Math.min(F.count,ee.start+ee.count);for(let re=de,Q=xe;re<Q;re+=3){const De=re,Me=re+1,Ie=re+2;C=mg(this,y,s,hh,F,U,V,W,j,De,Me,Ie),C&&(C.faceIndex=Math.floor(re/3),c.push(C))}}}else p.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}Fr.prototype.isMesh=!0;function VN(b,s,c,p,y,M,C,P){let F;if(s.side===S?F=p.intersectTriangle(C,M,y,!0,P):F=p.intersectTriangle(y,M,C,s.side!==T,P),F===null)return null;pg.copy(P),pg.applyMatrix4(b.matrixWorld);const U=c.ray.origin.distanceTo(pg);return U<c.near||U>c.far?null:{distance:U,point:pg.clone(),object:b}}function mg(b,s,c,p,y,M,C,P,F,U,V,W){Bl.fromBufferAttribute(y,U),Ul.fromBufferAttribute(y,V),zl.fromBufferAttribute(y,W);const j=b.morphTargetInfluences;if(M&&j){lg.set(0,0,0),cg.set(0,0,0),ug.set(0,0,0);for(let ee=0,de=M.length;ee<de;ee++){const xe=j[ee],re=M[ee];xe!==0&&(Ox.fromBufferAttribute(re,U),Ix.fromBufferAttribute(re,V),kx.fromBufferAttribute(re,W),C?(lg.addScaledVector(Ox,xe),cg.addScaledVector(Ix,xe),ug.addScaledVector(kx,xe)):(lg.addScaledVector(Ox.sub(Bl),xe),cg.addScaledVector(Ix.sub(Ul),xe),ug.addScaledVector(kx.sub(zl),xe)))}Bl.add(lg),Ul.add(cg),zl.add(ug)}b.isSkinnedMesh&&(b.boneTransform(U,Bl),b.boneTransform(V,Ul),b.boneTransform(W,zl));const Y=VN(b,s,c,p,Bl,Ul,zl,Nx);if(Y){P&&(hg.fromBufferAttribute(P,U),dg.fromBufferAttribute(P,V),fg.fromBufferAttribute(P,W),Y.uv=Dr.getUV(Nx,Bl,Ul,zl,hg,dg,fg,new Qt)),F&&(hg.fromBufferAttribute(F,U),dg.fromBufferAttribute(F,V),fg.fromBufferAttribute(F,W),Y.uv2=Dr.getUV(Nx,Bl,Ul,zl,hg,dg,fg,new Qt));const ee={a:U,b:V,c:W,normal:new Ge,materialIndex:0};Dr.getNormal(Bl,Ul,zl,ee.normal),Y.face=ee}return Y}class Ga extends si{constructor(s=1,c=1,p=1,y=1,M=1,C=1){super(),this.type="BoxGeometry",this.parameters={width:s,height:c,depth:p,widthSegments:y,heightSegments:M,depthSegments:C};const P=this;y=Math.floor(y),M=Math.floor(M),C=Math.floor(C);const F=[],U=[],V=[],W=[];let j=0,Y=0;ee("z","y","x",-1,-1,p,c,s,C,M,0),ee("z","y","x",1,-1,p,c,-s,C,M,1),ee("x","z","y",1,1,s,p,c,y,C,2),ee("x","z","y",1,-1,s,p,-c,y,C,3),ee("x","y","z",1,-1,s,c,p,y,M,4),ee("x","y","z",-1,-1,s,c,-p,y,M,5),this.setIndex(F),this.setAttribute("position",new Hn(U,3)),this.setAttribute("normal",new Hn(V,3)),this.setAttribute("uv",new Hn(W,2));function ee(de,xe,re,Q,De,Me,Ie,Xe,st,ut,Dt){const Rt=Me/st,Ee=Ie/ut,Ye=Me/2,vt=Ie/2,Et=Xe/2,gt=st+1,Lt=ut+1;let Vt=0,on=0;const Cn=new Ge;for(let Qn=0;Qn<Lt;Qn++){const Dn=Qn*Ee-vt;for(let Yt=0;Yt<gt;Yt++){const gn=Yt*Rt-Ye;Cn[de]=gn*Q,Cn[xe]=Dn*De,Cn[re]=Et,U.push(Cn.x,Cn.y,Cn.z),Cn[de]=0,Cn[xe]=0,Cn[re]=Xe>0?1:-1,V.push(Cn.x,Cn.y,Cn.z),W.push(Yt/st),W.push(1-Qn/ut),Vt+=1}}for(let Qn=0;Qn<ut;Qn++)for(let Dn=0;Dn<st;Dn++){const Yt=j+Dn+gt*Qn,gn=j+Dn+gt*(Qn+1),ni=j+(Dn+1)+gt*(Qn+1),ht=j+(Dn+1)+gt*Qn;F.push(Yt,gn,ht),F.push(gn,ni,ht),on+=6}P.addGroup(Y,on,Dt),Y+=on,j+=Vt}}static fromJSON(s){return new Ga(s.width,s.height,s.depth,s.widthSegments,s.heightSegments,s.depthSegments)}}function dh(b){const s={};for(const c in b){s[c]={};for(const p in b[c]){const y=b[c][p];y&&(y.isColor||y.isMatrix3||y.isMatrix4||y.isVector2||y.isVector3||y.isVector4||y.isTexture||y.isQuaternion)?s[c][p]=y.clone():Array.isArray(y)?s[c][p]=y.slice():s[c][p]=y}}return s}function us(b){const s={};for(let c=0;c<b.length;c++){const p=dh(b[c]);for(const y in p)s[y]=p[y]}return s}const YM={clone:dh,merge:us};var WN=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,jN=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Va extends Kr{constructor(s){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=WN,this.fragmentShader=jN,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,s!==void 0&&(s.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(s))}copy(s){return super.copy(s),this.fragmentShader=s.fragmentShader,this.vertexShader=s.vertexShader,this.uniforms=dh(s.uniforms),this.defines=Object.assign({},s.defines),this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.lights=s.lights,this.clipping=s.clipping,this.extensions=Object.assign({},s.extensions),this.glslVersion=s.glslVersion,this}toJSON(s){const c=super.toJSON(s);c.glslVersion=this.glslVersion,c.uniforms={};for(const y in this.uniforms){const C=this.uniforms[y].value;C&&C.isTexture?c.uniforms[y]={type:"t",value:C.toJSON(s).uuid}:C&&C.isColor?c.uniforms[y]={type:"c",value:C.getHex()}:C&&C.isVector2?c.uniforms[y]={type:"v2",value:C.toArray()}:C&&C.isVector3?c.uniforms[y]={type:"v3",value:C.toArray()}:C&&C.isVector4?c.uniforms[y]={type:"v4",value:C.toArray()}:C&&C.isMatrix3?c.uniforms[y]={type:"m3",value:C.toArray()}:C&&C.isMatrix4?c.uniforms[y]={type:"m4",value:C.toArray()}:c.uniforms[y]={value:C}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader;const p={};for(const y in this.extensions)this.extensions[y]===!0&&(p[y]=!0);return Object.keys(p).length>0&&(c.extensions=p),c}}Va.prototype.isShaderMaterial=!0;class Af extends Oi{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new zn,this.projectionMatrix=new zn,this.projectionMatrixInverse=new zn}copy(s,c){return super.copy(s,c),this.matrixWorldInverse.copy(s.matrixWorldInverse),this.projectionMatrix.copy(s.projectionMatrix),this.projectionMatrixInverse.copy(s.projectionMatrixInverse),this}getWorldDirection(s){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return s.set(-c[8],-c[9],-c[10]).normalize()}updateMatrixWorld(s){super.updateMatrixWorld(s),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(s,c){super.updateWorldMatrix(s,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}Af.prototype.isCamera=!0;class Br extends Af{constructor(s=50,c=1,p=.1,y=2e3){super(),this.type="PerspectiveCamera",this.fov=s,this.zoom=1,this.near=p,this.far=y,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(s,c){return super.copy(s,c),this.fov=s.fov,this.zoom=s.zoom,this.near=s.near,this.far=s.far,this.focus=s.focus,this.aspect=s.aspect,this.view=s.view===null?null:Object.assign({},s.view),this.filmGauge=s.filmGauge,this.filmOffset=s.filmOffset,this}setFocalLength(s){const c=.5*this.getFilmHeight()/s;this.fov=vf*2*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const s=Math.tan(zc*.5*this.fov);return .5*this.getFilmHeight()/s}getEffectiveFOV(){return vf*2*Math.atan(Math.tan(zc*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(s,c,p,y,M,C){this.aspect=s/c,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=s,this.view.fullHeight=c,this.view.offsetX=p,this.view.offsetY=y,this.view.width=M,this.view.height=C,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const s=this.near;let c=s*Math.tan(zc*.5*this.fov)/this.zoom,p=2*c,y=this.aspect*p,M=-.5*y;const C=this.view;if(this.view!==null&&this.view.enabled){const F=C.fullWidth,U=C.fullHeight;M+=C.offsetX*y/F,c-=C.offsetY*p/U,y*=C.width/F,p*=C.height/U}const P=this.filmOffset;P!==0&&(M+=s*P/this.getFilmWidth()),this.projectionMatrix.makePerspective(M,M+y,c,c-p,s,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(s){const c=super.toJSON(s);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,this.view!==null&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}Br.prototype.isPerspectiveCamera=!0;const fh=90,ph=1;class gg extends Oi{constructor(s,c,p){if(super(),this.type="CubeCamera",p.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=p;const y=new Br(fh,ph,s,c);y.layers=this.layers,y.up.set(0,-1,0),y.lookAt(new Ge(1,0,0)),this.add(y);const M=new Br(fh,ph,s,c);M.layers=this.layers,M.up.set(0,-1,0),M.lookAt(new Ge(-1,0,0)),this.add(M);const C=new Br(fh,ph,s,c);C.layers=this.layers,C.up.set(0,0,1),C.lookAt(new Ge(0,1,0)),this.add(C);const P=new Br(fh,ph,s,c);P.layers=this.layers,P.up.set(0,0,-1),P.lookAt(new Ge(0,-1,0)),this.add(P);const F=new Br(fh,ph,s,c);F.layers=this.layers,F.up.set(0,-1,0),F.lookAt(new Ge(0,0,1)),this.add(F);const U=new Br(fh,ph,s,c);U.layers=this.layers,U.up.set(0,-1,0),U.lookAt(new Ge(0,0,-1)),this.add(U)}update(s,c){this.parent===null&&this.updateMatrixWorld();const p=this.renderTarget,[y,M,C,P,F,U]=this.children,V=s.xr.enabled,W=s.getRenderTarget();s.xr.enabled=!1;const j=p.texture.generateMipmaps;p.texture.generateMipmaps=!1,s.setRenderTarget(p,0),s.render(c,y),s.setRenderTarget(p,1),s.render(c,M),s.setRenderTarget(p,2),s.render(c,C),s.setRenderTarget(p,3),s.render(c,P),s.setRenderTarget(p,4),s.render(c,F),p.texture.generateMipmaps=j,s.setRenderTarget(p,5),s.render(c,U),s.setRenderTarget(W),s.xr.enabled=V,p.texture.needsPMREMUpdate=!0}}class mh extends Nr{constructor(s,c,p,y,M,C,P,F,U,V){s=s!==void 0?s:[],c=c!==void 0?c:$,super(s,c,p,y,M,C,P,F,U,V),this.flipY=!1}get images(){return this.image}set images(s){this.image=s}}mh.prototype.isCubeTexture=!0;class vg extends js{constructor(s,c,p){Number.isInteger(c)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),c=p),super(s,s,c),c=c||{},this.texture=new mh(void 0,c.mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=c.generateMipmaps!==void 0?c.generateMipmaps:!1,this.texture.minFilter=c.minFilter!==void 0?c.minFilter:Ve}fromEquirectangularTexture(s,c){this.texture.type=c.type,this.texture.format=Pt,this.texture.encoding=c.encoding,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const p={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},y=new Ga(5,5,5),M=new Va({name:"CubemapFromEquirect",uniforms:dh(p.uniforms),vertexShader:p.vertexShader,fragmentShader:p.fragmentShader,side:S,blending:I});M.uniforms.tEquirect.value=c;const C=new Fr(y,M),P=c.minFilter;return c.minFilter===Wt&&(c.minFilter=Ve),new gg(1,10,this).update(s,C),c.minFilter=P,C.geometry.dispose(),C.material.dispose(),this}clear(s,c,p,y){const M=s.getRenderTarget();for(let C=0;C<6;C++)s.setRenderTarget(this,C),s.clear(c,p,y);s.setRenderTarget(M)}}vg.prototype.isWebGLCubeRenderTarget=!0;const Fx=new Ge,$N=new Ge,XN=new Hr;class la{constructor(s=new Ge(1,0,0),c=0){this.normal=s,this.constant=c}set(s,c){return this.normal.copy(s),this.constant=c,this}setComponents(s,c,p,y){return this.normal.set(s,c,p),this.constant=y,this}setFromNormalAndCoplanarPoint(s,c){return this.normal.copy(s),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(s,c,p){const y=Fx.subVectors(p,c).cross($N.subVectors(s,c)).normalize();return this.setFromNormalAndCoplanarPoint(y,s),this}copy(s){return this.normal.copy(s.normal),this.constant=s.constant,this}normalize(){const s=1/this.normal.length();return this.normal.multiplyScalar(s),this.constant*=s,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(s){return this.normal.dot(s)+this.constant}distanceToSphere(s){return this.distanceToPoint(s.center)-s.radius}projectPoint(s,c){return c.copy(this.normal).multiplyScalar(-this.distanceToPoint(s)).add(s)}intersectLine(s,c){const p=s.delta(Fx),y=this.normal.dot(p);if(y===0)return this.distanceToPoint(s.start)===0?c.copy(s.start):null;const M=-(s.start.dot(this.normal)+this.constant)/y;return M<0||M>1?null:c.copy(p).multiplyScalar(M).add(s.start)}intersectsLine(s){const c=this.distanceToPoint(s.start),p=this.distanceToPoint(s.end);return c<0&&p>0||p<0&&c>0}intersectsBox(s){return s.intersectsPlane(this)}intersectsSphere(s){return s.intersectsPlane(this)}coplanarPoint(s){return s.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(s,c){const p=c||XN.getNormalMatrix(s),y=this.coplanarPoint(Fx).applyMatrix4(s),M=this.normal.applyMatrix3(p).normalize();return this.constant=-y.dot(M),this}translate(s){return this.constant-=s.dot(this.normal),this}equals(s){return s.normal.equals(this.normal)&&s.constant===this.constant}clone(){return new this.constructor().copy(this)}}la.prototype.isPlane=!0;const gh=new Il,yg=new Ge;class wf{constructor(s=new la,c=new la,p=new la,y=new la,M=new la,C=new la){this.planes=[s,c,p,y,M,C]}set(s,c,p,y,M,C){const P=this.planes;return P[0].copy(s),P[1].copy(c),P[2].copy(p),P[3].copy(y),P[4].copy(M),P[5].copy(C),this}copy(s){const c=this.planes;for(let p=0;p<6;p++)c[p].copy(s.planes[p]);return this}setFromProjectionMatrix(s){const c=this.planes,p=s.elements,y=p[0],M=p[1],C=p[2],P=p[3],F=p[4],U=p[5],V=p[6],W=p[7],j=p[8],Y=p[9],ee=p[10],de=p[11],xe=p[12],re=p[13],Q=p[14],De=p[15];return c[0].setComponents(P-y,W-F,de-j,De-xe).normalize(),c[1].setComponents(P+y,W+F,de+j,De+xe).normalize(),c[2].setComponents(P+M,W+U,de+Y,De+re).normalize(),c[3].setComponents(P-M,W-U,de-Y,De-re).normalize(),c[4].setComponents(P-C,W-V,de-ee,De-Q).normalize(),c[5].setComponents(P+C,W+V,de+ee,De+Q).normalize(),this}intersectsObject(s){const c=s.geometry;return c.boundingSphere===null&&c.computeBoundingSphere(),gh.copy(c.boundingSphere).applyMatrix4(s.matrixWorld),this.intersectsSphere(gh)}intersectsSprite(s){return gh.center.set(0,0,0),gh.radius=.7071067811865476,gh.applyMatrix4(s.matrixWorld),this.intersectsSphere(gh)}intersectsSphere(s){const c=this.planes,p=s.center,y=-s.radius;for(let M=0;M<6;M++)if(c[M].distanceToPoint(p)<y)return!1;return!0}intersectsBox(s){const c=this.planes;for(let p=0;p<6;p++){const y=c[p];if(yg.x=y.normal.x>0?s.max.x:s.min.x,yg.y=y.normal.y>0?s.max.y:s.min.y,yg.z=y.normal.z>0?s.max.z:s.min.z,y.distanceToPoint(yg)<0)return!1}return!0}containsPoint(s){const c=this.planes;for(let p=0;p<6;p++)if(c[p].distanceToPoint(s)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Bx(){let b=null,s=!1,c=null,p=null;function y(M,C){c(M,C),p=b.requestAnimationFrame(y)}return{start:function(){s!==!0&&c!==null&&(p=b.requestAnimationFrame(y),s=!0)},stop:function(){b.cancelAnimationFrame(p),s=!1},setAnimationLoop:function(M){c=M},setContext:function(M){b=M}}}function qN(b,s){const c=s.isWebGL2,p=new WeakMap;function y(U,V){const W=U.array,j=U.usage,Y=b.createBuffer();b.bindBuffer(V,Y),b.bufferData(V,W,j),U.onUploadCallback();let ee=b.FLOAT;return W instanceof Float32Array?ee=b.FLOAT:W instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):W instanceof Uint16Array?U.isFloat16BufferAttribute?c?ee=b.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):ee=b.UNSIGNED_SHORT:W instanceof Int16Array?ee=b.SHORT:W instanceof Uint32Array?ee=b.UNSIGNED_INT:W instanceof Int32Array?ee=b.INT:W instanceof Int8Array?ee=b.BYTE:(W instanceof Uint8Array||W instanceof Uint8ClampedArray)&&(ee=b.UNSIGNED_BYTE),{buffer:Y,type:ee,bytesPerElement:W.BYTES_PER_ELEMENT,version:U.version}}function M(U,V,W){const j=V.array,Y=V.updateRange;b.bindBuffer(W,U),Y.count===-1?b.bufferSubData(W,0,j):(c?b.bufferSubData(W,Y.offset*j.BYTES_PER_ELEMENT,j,Y.offset,Y.count):b.bufferSubData(W,Y.offset*j.BYTES_PER_ELEMENT,j.subarray(Y.offset,Y.offset+Y.count)),Y.count=-1)}function C(U){return U.isInterleavedBufferAttribute&&(U=U.data),p.get(U)}function P(U){U.isInterleavedBufferAttribute&&(U=U.data);const V=p.get(U);V&&(b.deleteBuffer(V.buffer),p.delete(U))}function F(U,V){if(U.isGLBufferAttribute){const j=p.get(U);(!j||j.version<U.version)&&p.set(U,{buffer:U.buffer,type:U.type,bytesPerElement:U.elementSize,version:U.version});return}U.isInterleavedBufferAttribute&&(U=U.data);const W=p.get(U);W===void 0?p.set(U,y(U,V)):W.version<U.version&&(M(W.buffer,U,V),W.version=U.version)}return{get:C,remove:P,update:F}}class jc extends si{constructor(s=1,c=1,p=1,y=1){super(),this.type="PlaneGeometry",this.parameters={width:s,height:c,widthSegments:p,heightSegments:y};const M=s/2,C=c/2,P=Math.floor(p),F=Math.floor(y),U=P+1,V=F+1,W=s/P,j=c/F,Y=[],ee=[],de=[],xe=[];for(let re=0;re<V;re++){const Q=re*j-C;for(let De=0;De<U;De++){const Me=De*W-M;ee.push(Me,-Q,0),de.push(0,0,1),xe.push(De/P),xe.push(1-re/F)}}for(let re=0;re<F;re++)for(let Q=0;Q<P;Q++){const De=Q+U*re,Me=Q+U*(re+1),Ie=Q+1+U*(re+1),Xe=Q+1+U*re;Y.push(De,Me,Xe),Y.push(Me,Ie,Xe)}this.setIndex(Y),this.setAttribute("position",new Hn(ee,3)),this.setAttribute("normal",new Hn(de,3)),this.setAttribute("uv",new Hn(xe,2))}static fromJSON(s){return new jc(s.width,s.height,s.widthSegments,s.heightSegments)}}var YN=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,KN=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,QN=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,ZN=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,JN=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,eF=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,tF="vec3 transformed = vec3( position );",nF=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,iF=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,rF=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,sF=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,oF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,aF=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,lF=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,cF=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,uF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,hF=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,dF=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,fF=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,pF=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		return texture2D( envMap, uv ).rgb;
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,mF=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,gF=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,vF=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,yF=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,xF=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,_F="gl_FragColor = linearToOutputTexel( gl_FragColor );",bF=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,EF=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,AF=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,wF=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,MF=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,SF=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,TF=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,CF=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,RF=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,LF=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,PF=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,DF=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,OF=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,IF=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,kF=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,NF=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,FF=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,BF=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,UF=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,zF=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,HF=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,GF=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,VF=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,WF=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,jF=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,$F=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,XF=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,qF=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,YF=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,KF=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,QF=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,ZF=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,JF=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,e4=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,t4=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,n4=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,i4=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,r4=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,s4=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,o4=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,a4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,l4=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,c4=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,u4=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,h4=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,d4=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,f4=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,p4=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,m4=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,g4=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,v4=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,y4=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,x4=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,_4=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,b4=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,E4=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,A4=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,w4=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,M4=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,S4=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,T4=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,C4=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,R4=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,L4=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,P4=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,D4=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,O4=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,I4=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,k4=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,N4=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,F4=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,B4=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,U4=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,z4=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,H4=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,G4=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Pi={alphamap_fragment:YN,alphamap_pars_fragment:KN,alphatest_fragment:QN,alphatest_pars_fragment:ZN,aomap_fragment:JN,aomap_pars_fragment:eF,begin_vertex:tF,beginnormal_vertex:nF,bsdfs:iF,bumpmap_pars_fragment:rF,clipping_planes_fragment:sF,clipping_planes_pars_fragment:oF,clipping_planes_pars_vertex:aF,clipping_planes_vertex:lF,color_fragment:cF,color_pars_fragment:uF,color_pars_vertex:hF,color_vertex:dF,common:fF,cube_uv_reflection_fragment:pF,defaultnormal_vertex:mF,displacementmap_pars_vertex:gF,displacementmap_vertex:vF,emissivemap_fragment:yF,emissivemap_pars_fragment:xF,encodings_fragment:_F,encodings_pars_fragment:bF,envmap_fragment:EF,envmap_common_pars_fragment:AF,envmap_pars_fragment:wF,envmap_pars_vertex:MF,envmap_physical_pars_fragment:NF,envmap_vertex:SF,fog_vertex:TF,fog_pars_vertex:CF,fog_fragment:RF,fog_pars_fragment:LF,gradientmap_pars_fragment:PF,lightmap_fragment:DF,lightmap_pars_fragment:OF,lights_lambert_vertex:IF,lights_pars_begin:kF,lights_toon_fragment:FF,lights_toon_pars_fragment:BF,lights_phong_fragment:UF,lights_phong_pars_fragment:zF,lights_physical_fragment:HF,lights_physical_pars_fragment:GF,lights_fragment_begin:VF,lights_fragment_maps:WF,lights_fragment_end:jF,logdepthbuf_fragment:$F,logdepthbuf_pars_fragment:XF,logdepthbuf_pars_vertex:qF,logdepthbuf_vertex:YF,map_fragment:KF,map_pars_fragment:QF,map_particle_fragment:ZF,map_particle_pars_fragment:JF,metalnessmap_fragment:e4,metalnessmap_pars_fragment:t4,morphnormal_vertex:n4,morphtarget_pars_vertex:i4,morphtarget_vertex:r4,normal_fragment_begin:s4,normal_fragment_maps:o4,normal_pars_fragment:a4,normal_pars_vertex:l4,normal_vertex:c4,normalmap_pars_fragment:u4,clearcoat_normal_fragment_begin:h4,clearcoat_normal_fragment_maps:d4,clearcoat_pars_fragment:f4,output_fragment:p4,packing:m4,premultiplied_alpha_fragment:g4,project_vertex:v4,dithering_fragment:y4,dithering_pars_fragment:x4,roughnessmap_fragment:_4,roughnessmap_pars_fragment:b4,shadowmap_pars_fragment:E4,shadowmap_pars_vertex:A4,shadowmap_vertex:w4,shadowmask_pars_fragment:M4,skinbase_vertex:S4,skinning_pars_vertex:T4,skinning_vertex:C4,skinnormal_vertex:R4,specularmap_fragment:L4,specularmap_pars_fragment:P4,tonemapping_fragment:D4,tonemapping_pars_fragment:O4,transmission_fragment:I4,transmission_pars_fragment:k4,uv_pars_fragment:N4,uv_pars_vertex:F4,uv_vertex:B4,uv2_pars_fragment:U4,uv2_pars_vertex:z4,uv2_vertex:H4,worldpos_vertex:G4,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`},En={common:{diffuse:{value:new Tn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Hr},uv2Transform:{value:new Hr},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Qt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Tn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Tn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Hr}},sprite:{diffuse:{value:new Tn(16777215)},opacity:{value:1},center:{value:new Qt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Hr}}},ko={basic:{uniforms:us([En.common,En.specularmap,En.envmap,En.aomap,En.lightmap,En.fog]),vertexShader:Pi.meshbasic_vert,fragmentShader:Pi.meshbasic_frag},lambert:{uniforms:us([En.common,En.specularmap,En.envmap,En.aomap,En.lightmap,En.emissivemap,En.fog,En.lights,{emissive:{value:new Tn(0)}}]),vertexShader:Pi.meshlambert_vert,fragmentShader:Pi.meshlambert_frag},phong:{uniforms:us([En.common,En.specularmap,En.envmap,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.fog,En.lights,{emissive:{value:new Tn(0)},specular:{value:new Tn(1118481)},shininess:{value:30}}]),vertexShader:Pi.meshphong_vert,fragmentShader:Pi.meshphong_frag},standard:{uniforms:us([En.common,En.envmap,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.roughnessmap,En.metalnessmap,En.fog,En.lights,{emissive:{value:new Tn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag},toon:{uniforms:us([En.common,En.aomap,En.lightmap,En.emissivemap,En.bumpmap,En.normalmap,En.displacementmap,En.gradientmap,En.fog,En.lights,{emissive:{value:new Tn(0)}}]),vertexShader:Pi.meshtoon_vert,fragmentShader:Pi.meshtoon_frag},matcap:{uniforms:us([En.common,En.bumpmap,En.normalmap,En.displacementmap,En.fog,{matcap:{value:null}}]),vertexShader:Pi.meshmatcap_vert,fragmentShader:Pi.meshmatcap_frag},points:{uniforms:us([En.points,En.fog]),vertexShader:Pi.points_vert,fragmentShader:Pi.points_frag},dashed:{uniforms:us([En.common,En.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pi.linedashed_vert,fragmentShader:Pi.linedashed_frag},depth:{uniforms:us([En.common,En.displacementmap]),vertexShader:Pi.depth_vert,fragmentShader:Pi.depth_frag},normal:{uniforms:us([En.common,En.bumpmap,En.normalmap,En.displacementmap,{opacity:{value:1}}]),vertexShader:Pi.meshnormal_vert,fragmentShader:Pi.meshnormal_frag},sprite:{uniforms:us([En.sprite,En.fog]),vertexShader:Pi.sprite_vert,fragmentShader:Pi.sprite_frag},background:{uniforms:{uvTransform:{value:new Hr},t2D:{value:null}},vertexShader:Pi.background_vert,fragmentShader:Pi.background_frag},cube:{uniforms:us([En.envmap,{opacity:{value:1}}]),vertexShader:Pi.cube_vert,fragmentShader:Pi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pi.equirect_vert,fragmentShader:Pi.equirect_frag},distanceRGBA:{uniforms:us([En.common,En.displacementmap,{referencePosition:{value:new Ge},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pi.distanceRGBA_vert,fragmentShader:Pi.distanceRGBA_frag},shadow:{uniforms:us([En.lights,En.fog,{color:{value:new Tn(0)},opacity:{value:1}}]),vertexShader:Pi.shadow_vert,fragmentShader:Pi.shadow_frag}};ko.physical={uniforms:us([ko.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Qt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Tn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Qt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Tn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Tn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Pi.meshphysical_vert,fragmentShader:Pi.meshphysical_frag};function V4(b,s,c,p,y,M){const C=new Tn(0);let P=y===!0?0:1,F,U,V=null,W=0,j=null;function Y(de,xe){let re=!1,Q=xe.isScene===!0?xe.background:null;Q&&Q.isTexture&&(Q=s.get(Q));const De=b.xr,Me=De.getSession&&De.getSession();Me&&Me.environmentBlendMode==="additive"&&(Q=null),Q===null?ee(C,P):Q&&Q.isColor&&(ee(Q,1),re=!0),(b.autoClear||re)&&b.clear(b.autoClearColor,b.autoClearDepth,b.autoClearStencil),Q&&(Q.isCubeTexture||Q.mapping===Le)?(U===void 0&&(U=new Fr(new Ga(1,1,1),new Va({name:"BackgroundCubeMaterial",uniforms:dh(ko.cube.uniforms),vertexShader:ko.cube.vertexShader,fragmentShader:ko.cube.fragmentShader,side:S,depthTest:!1,depthWrite:!1,fog:!1})),U.geometry.deleteAttribute("normal"),U.geometry.deleteAttribute("uv"),U.onBeforeRender=function(Ie,Xe,st){this.matrixWorld.copyPosition(st.matrixWorld)},Object.defineProperty(U.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),p.update(U)),U.material.uniforms.envMap.value=Q,U.material.uniforms.flipEnvMap.value=Q.isCubeTexture&&Q.isRenderTargetTexture===!1?-1:1,(V!==Q||W!==Q.version||j!==b.toneMapping)&&(U.material.needsUpdate=!0,V=Q,W=Q.version,j=b.toneMapping),de.unshift(U,U.geometry,U.material,0,0,null)):Q&&Q.isTexture&&(F===void 0&&(F=new Fr(new jc(2,2),new Va({name:"BackgroundMaterial",uniforms:dh(ko.background.uniforms),vertexShader:ko.background.vertexShader,fragmentShader:ko.background.fragmentShader,side:w,depthTest:!1,depthWrite:!1,fog:!1})),F.geometry.deleteAttribute("normal"),Object.defineProperty(F.material,"map",{get:function(){return this.uniforms.t2D.value}}),p.update(F)),F.material.uniforms.t2D.value=Q,Q.matrixAutoUpdate===!0&&Q.updateMatrix(),F.material.uniforms.uvTransform.value.copy(Q.matrix),(V!==Q||W!==Q.version||j!==b.toneMapping)&&(F.material.needsUpdate=!0,V=Q,W=Q.version,j=b.toneMapping),de.unshift(F,F.geometry,F.material,0,0,null))}function ee(de,xe){c.buffers.color.setClear(de.r,de.g,de.b,xe,M)}return{getClearColor:function(){return C},setClearColor:function(de,xe=1){C.set(de),P=xe,ee(C,P)},getClearAlpha:function(){return P},setClearAlpha:function(de){P=de,ee(C,P)},render:Y}}function W4(b,s,c,p){const y=b.getParameter(b.MAX_VERTEX_ATTRIBS),M=p.isWebGL2?null:s.get("OES_vertex_array_object"),C=p.isWebGL2||M!==null,P={},F=de(null);let U=F;function V(vt,Et,gt,Lt,Vt){let on=!1;if(C){const Cn=ee(Lt,gt,Et);U!==Cn&&(U=Cn,j(U.object)),on=xe(Lt,Vt),on&&re(Lt,Vt)}else{const Cn=Et.wireframe===!0;(U.geometry!==Lt.id||U.program!==gt.id||U.wireframe!==Cn)&&(U.geometry=Lt.id,U.program=gt.id,U.wireframe=Cn,on=!0)}vt.isInstancedMesh===!0&&(on=!0),Vt!==null&&c.update(Vt,b.ELEMENT_ARRAY_BUFFER),on&&(st(vt,Et,gt,Lt),Vt!==null&&b.bindBuffer(b.ELEMENT_ARRAY_BUFFER,c.get(Vt).buffer))}function W(){return p.isWebGL2?b.createVertexArray():M.createVertexArrayOES()}function j(vt){return p.isWebGL2?b.bindVertexArray(vt):M.bindVertexArrayOES(vt)}function Y(vt){return p.isWebGL2?b.deleteVertexArray(vt):M.deleteVertexArrayOES(vt)}function ee(vt,Et,gt){const Lt=gt.wireframe===!0;let Vt=P[vt.id];Vt===void 0&&(Vt={},P[vt.id]=Vt);let on=Vt[Et.id];on===void 0&&(on={},Vt[Et.id]=on);let Cn=on[Lt];return Cn===void 0&&(Cn=de(W()),on[Lt]=Cn),Cn}function de(vt){const Et=[],gt=[],Lt=[];for(let Vt=0;Vt<y;Vt++)Et[Vt]=0,gt[Vt]=0,Lt[Vt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Et,enabledAttributes:gt,attributeDivisors:Lt,object:vt,attributes:{},index:null}}function xe(vt,Et){const gt=U.attributes,Lt=vt.attributes;let Vt=0;for(const on in Lt){const Cn=gt[on],Qn=Lt[on];if(Cn===void 0||Cn.attribute!==Qn||Cn.data!==Qn.data)return!0;Vt++}return U.attributesNum!==Vt||U.index!==Et}function re(vt,Et){const gt={},Lt=vt.attributes;let Vt=0;for(const on in Lt){const Cn=Lt[on],Qn={};Qn.attribute=Cn,Cn.data&&(Qn.data=Cn.data),gt[on]=Qn,Vt++}U.attributes=gt,U.attributesNum=Vt,U.index=Et}function Q(){const vt=U.newAttributes;for(let Et=0,gt=vt.length;Et<gt;Et++)vt[Et]=0}function De(vt){Me(vt,0)}function Me(vt,Et){const gt=U.newAttributes,Lt=U.enabledAttributes,Vt=U.attributeDivisors;gt[vt]=1,Lt[vt]===0&&(b.enableVertexAttribArray(vt),Lt[vt]=1),Vt[vt]!==Et&&((p.isWebGL2?b:s.get("ANGLE_instanced_arrays"))[p.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](vt,Et),Vt[vt]=Et)}function Ie(){const vt=U.newAttributes,Et=U.enabledAttributes;for(let gt=0,Lt=Et.length;gt<Lt;gt++)Et[gt]!==vt[gt]&&(b.disableVertexAttribArray(gt),Et[gt]=0)}function Xe(vt,Et,gt,Lt,Vt,on){p.isWebGL2===!0&&(gt===b.INT||gt===b.UNSIGNED_INT)?b.vertexAttribIPointer(vt,Et,gt,Vt,on):b.vertexAttribPointer(vt,Et,gt,Lt,Vt,on)}function st(vt,Et,gt,Lt){if(p.isWebGL2===!1&&(vt.isInstancedMesh||Lt.isInstancedBufferGeometry)&&s.get("ANGLE_instanced_arrays")===null)return;Q();const Vt=Lt.attributes,on=gt.getAttributes(),Cn=Et.defaultAttributeValues;for(const Qn in on){const Dn=on[Qn];if(Dn.location>=0){let Yt=Vt[Qn];if(Yt===void 0&&(Qn==="instanceMatrix"&&vt.instanceMatrix&&(Yt=vt.instanceMatrix),Qn==="instanceColor"&&vt.instanceColor&&(Yt=vt.instanceColor)),Yt!==void 0){const gn=Yt.normalized,ni=Yt.itemSize,ht=c.get(Yt);if(ht===void 0)continue;const ai=ht.buffer,Nn=ht.type,li=ht.bytesPerElement;if(Yt.isInterleavedBufferAttribute){const On=Yt.data,Ai=On.stride,ci=Yt.offset;if(On&&On.isInstancedInterleavedBuffer){for(let $t=0;$t<Dn.locationSize;$t++)Me(Dn.location+$t,On.meshPerAttribute);vt.isInstancedMesh!==!0&&Lt._maxInstanceCount===void 0&&(Lt._maxInstanceCount=On.meshPerAttribute*On.count)}else for(let $t=0;$t<Dn.locationSize;$t++)De(Dn.location+$t);b.bindBuffer(b.ARRAY_BUFFER,ai);for(let $t=0;$t<Dn.locationSize;$t++)Xe(Dn.location+$t,ni/Dn.locationSize,Nn,gn,Ai*li,(ci+ni/Dn.locationSize*$t)*li)}else{if(Yt.isInstancedBufferAttribute){for(let On=0;On<Dn.locationSize;On++)Me(Dn.location+On,Yt.meshPerAttribute);vt.isInstancedMesh!==!0&&Lt._maxInstanceCount===void 0&&(Lt._maxInstanceCount=Yt.meshPerAttribute*Yt.count)}else for(let On=0;On<Dn.locationSize;On++)De(Dn.location+On);b.bindBuffer(b.ARRAY_BUFFER,ai);for(let On=0;On<Dn.locationSize;On++)Xe(Dn.location+On,ni/Dn.locationSize,Nn,gn,ni*li,ni/Dn.locationSize*On*li)}}else if(Cn!==void 0){const gn=Cn[Qn];if(gn!==void 0)switch(gn.length){case 2:b.vertexAttrib2fv(Dn.location,gn);break;case 3:b.vertexAttrib3fv(Dn.location,gn);break;case 4:b.vertexAttrib4fv(Dn.location,gn);break;default:b.vertexAttrib1fv(Dn.location,gn)}}}}Ie()}function ut(){Ee();for(const vt in P){const Et=P[vt];for(const gt in Et){const Lt=Et[gt];for(const Vt in Lt)Y(Lt[Vt].object),delete Lt[Vt];delete Et[gt]}delete P[vt]}}function Dt(vt){if(P[vt.id]===void 0)return;const Et=P[vt.id];for(const gt in Et){const Lt=Et[gt];for(const Vt in Lt)Y(Lt[Vt].object),delete Lt[Vt];delete Et[gt]}delete P[vt.id]}function Rt(vt){for(const Et in P){const gt=P[Et];if(gt[vt.id]===void 0)continue;const Lt=gt[vt.id];for(const Vt in Lt)Y(Lt[Vt].object),delete Lt[Vt];delete gt[vt.id]}}function Ee(){Ye(),U!==F&&(U=F,j(U.object))}function Ye(){F.geometry=null,F.program=null,F.wireframe=!1}return{setup:V,reset:Ee,resetDefaultState:Ye,dispose:ut,releaseStatesOfGeometry:Dt,releaseStatesOfProgram:Rt,initAttributes:Q,enableAttribute:De,disableUnusedAttributes:Ie}}function j4(b,s,c,p){const y=p.isWebGL2;let M;function C(U){M=U}function P(U,V){b.drawArrays(M,U,V),c.update(V,M,1)}function F(U,V,W){if(W===0)return;let j,Y;if(y)j=b,Y="drawArraysInstanced";else if(j=s.get("ANGLE_instanced_arrays"),Y="drawArraysInstancedANGLE",j===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}j[Y](M,U,V,W),c.update(V,M,W)}this.setMode=C,this.render=P,this.renderInstances=F}function $4(b,s,c){let p;function y(){if(p!==void 0)return p;if(s.has("EXT_texture_filter_anisotropic")===!0){const st=s.get("EXT_texture_filter_anisotropic");p=b.getParameter(st.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else p=0;return p}function M(st){if(st==="highp"){if(b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.HIGH_FLOAT).precision>0&&b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.HIGH_FLOAT).precision>0)return"highp";st="mediump"}return st==="mediump"&&b.getShaderPrecisionFormat(b.VERTEX_SHADER,b.MEDIUM_FLOAT).precision>0&&b.getShaderPrecisionFormat(b.FRAGMENT_SHADER,b.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const C=typeof WebGL2RenderingContext<"u"&&b instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&b instanceof WebGL2ComputeRenderingContext;let P=c.precision!==void 0?c.precision:"highp";const F=M(P);F!==P&&(console.warn("THREE.WebGLRenderer:",P,"not supported, using",F,"instead."),P=F);const U=C||s.has("WEBGL_draw_buffers"),V=c.logarithmicDepthBuffer===!0,W=b.getParameter(b.MAX_TEXTURE_IMAGE_UNITS),j=b.getParameter(b.MAX_VERTEX_TEXTURE_IMAGE_UNITS),Y=b.getParameter(b.MAX_TEXTURE_SIZE),ee=b.getParameter(b.MAX_CUBE_MAP_TEXTURE_SIZE),de=b.getParameter(b.MAX_VERTEX_ATTRIBS),xe=b.getParameter(b.MAX_VERTEX_UNIFORM_VECTORS),re=b.getParameter(b.MAX_VARYING_VECTORS),Q=b.getParameter(b.MAX_FRAGMENT_UNIFORM_VECTORS),De=j>0,Me=C||s.has("OES_texture_float"),Ie=De&&Me,Xe=C?b.getParameter(b.MAX_SAMPLES):0;return{isWebGL2:C,drawBuffers:U,getMaxAnisotropy:y,getMaxPrecision:M,precision:P,logarithmicDepthBuffer:V,maxTextures:W,maxVertexTextures:j,maxTextureSize:Y,maxCubemapSize:ee,maxAttributes:de,maxVertexUniforms:xe,maxVaryings:re,maxFragmentUniforms:Q,vertexTextures:De,floatFragmentTextures:Me,floatVertexTextures:Ie,maxSamples:Xe}}function X4(b){const s=this;let c=null,p=0,y=!1,M=!1;const C=new la,P=new Hr,F={value:null,needsUpdate:!1};this.uniform=F,this.numPlanes=0,this.numIntersection=0,this.init=function(W,j,Y){const ee=W.length!==0||j||p!==0||y;return y=j,c=V(W,Y,0),p=W.length,ee},this.beginShadows=function(){M=!0,V(null)},this.endShadows=function(){M=!1,U()},this.setState=function(W,j,Y){const ee=W.clippingPlanes,de=W.clipIntersection,xe=W.clipShadows,re=b.get(W);if(!y||ee===null||ee.length===0||M&&!xe)M?V(null):U();else{const Q=M?0:p,De=Q*4;let Me=re.clippingState||null;F.value=Me,Me=V(ee,j,De,Y);for(let Ie=0;Ie!==De;++Ie)Me[Ie]=c[Ie];re.clippingState=Me,this.numIntersection=de?this.numPlanes:0,this.numPlanes+=Q}};function U(){F.value!==c&&(F.value=c,F.needsUpdate=p>0),s.numPlanes=p,s.numIntersection=0}function V(W,j,Y,ee){const de=W!==null?W.length:0;let xe=null;if(de!==0){if(xe=F.value,ee!==!0||xe===null){const re=Y+de*4,Q=j.matrixWorldInverse;P.getNormalMatrix(Q),(xe===null||xe.length<re)&&(xe=new Float32Array(re));for(let De=0,Me=Y;De!==de;++De,Me+=4)C.copy(W[De]).applyMatrix4(Q,P),C.normal.toArray(xe,Me),xe[Me+3]=C.constant}F.value=xe,F.needsUpdate=!0}return s.numPlanes=de,s.numIntersection=0,xe}}function q4(b){let s=new WeakMap;function c(C,P){return P===Pe?C.mapping=$:P===ve&&(C.mapping=me),C}function p(C){if(C&&C.isTexture&&C.isRenderTargetTexture===!1){const P=C.mapping;if(P===Pe||P===ve)if(s.has(C)){const F=s.get(C).texture;return c(F,C.mapping)}else{const F=C.image;if(F&&F.height>0){const U=new vg(F.height/2);return U.fromEquirectangularTexture(b,C),s.set(C,U),C.addEventListener("dispose",y),c(U.texture,C.mapping)}else return null}}return C}function y(C){const P=C.target;P.removeEventListener("dispose",y);const F=s.get(P);F!==void 0&&(s.delete(P),F.dispose())}function M(){s=new WeakMap}return{get:p,dispose:M}}class Mf extends Af{constructor(s=-1,c=1,p=1,y=-1,M=.1,C=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=s,this.right=c,this.top=p,this.bottom=y,this.near=M,this.far=C,this.updateProjectionMatrix()}copy(s,c){return super.copy(s,c),this.left=s.left,this.right=s.right,this.top=s.top,this.bottom=s.bottom,this.near=s.near,this.far=s.far,this.zoom=s.zoom,this.view=s.view===null?null:Object.assign({},s.view),this}setViewOffset(s,c,p,y,M,C){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=s,this.view.fullHeight=c,this.view.offsetX=p,this.view.offsetY=y,this.view.width=M,this.view.height=C,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const s=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),p=(this.right+this.left)/2,y=(this.top+this.bottom)/2;let M=p-s,C=p+s,P=y+c,F=y-c;if(this.view!==null&&this.view.enabled){const U=(this.right-this.left)/this.view.fullWidth/this.zoom,V=(this.top-this.bottom)/this.view.fullHeight/this.zoom;M+=U*this.view.offsetX,C=M+U*this.view.width,P-=V*this.view.offsetY,F=P-V*this.view.height}this.projectionMatrix.makeOrthographic(M,C,P,F,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(s){const c=super.toJSON(s);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,this.view!==null&&(c.object.view=Object.assign({},this.view)),c}}Mf.prototype.isOrthographicCamera=!0;class vh extends Va{constructor(s){super(s),this.type="RawShaderMaterial"}}vh.prototype.isRawShaderMaterial=!0;const yh=4,Hl=8,ca=Math.pow(2,Hl),KM=[.125,.215,.35,.446,.526,.582],QM=Hl-yh+1+KM.length,xh=20,Ux=new Mf,{_lodPlanes:Sf,_sizeLods:ZM,_sigmas:xg}=Y4(),JM=new Tn;let zx=null;const $c=(1+Math.sqrt(5))/2,_h=1/$c,eS=[new Ge(1,1,1),new Ge(-1,1,1),new Ge(1,1,-1),new Ge(-1,1,-1),new Ge(0,$c,_h),new Ge(0,$c,-_h),new Ge(_h,0,$c),new Ge(-_h,0,$c),new Ge($c,_h,0),new Ge(-$c,_h,0)];class Hx{constructor(s){this._renderer=s,this._pingPongRenderTarget=null,this._blurMaterial=K4(xh),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(s,c=0,p=.1,y=100){zx=this._renderer.getRenderTarget();const M=this._allocateTargets();return this._sceneToCubeUV(s,p,y,M),c>0&&this._blur(M,0,0,c),this._applyPMREM(M),this._cleanup(M),M}fromEquirectangular(s,c=null){return this._fromTexture(s,c)}fromCubemap(s,c=null){return this._fromTexture(s,c)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=iS(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=nS(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let s=0;s<Sf.length;s++)Sf[s].dispose()}_cleanup(s){this._renderer.setRenderTarget(zx),s.scissorTest=!1,_g(s,0,0,s.width,s.height)}_fromTexture(s,c){zx=this._renderer.getRenderTarget();const p=c||this._allocateTargets(s);return this._textureToCubeUV(s,p),this._applyPMREM(p),this._cleanup(p),p}_allocateTargets(s){const c={magFilter:Ve,minFilter:Ve,generateMipmaps:!1,type:Gi,format:Pt,encoding:hn,depthBuffer:!1},p=tS(c);return p.depthBuffer=!s,this._pingPongRenderTarget===null&&(this._pingPongRenderTarget=tS(c)),p}_compileMaterial(s){const c=new Fr(Sf[0],s);this._renderer.compile(c,Ux)}_sceneToCubeUV(s,c,p,y){const P=new Br(90,1,c,p),F=[1,-1,1,1,1,1],U=[1,1,1,-1,-1,-1],V=this._renderer,W=V.autoClear,j=V.toneMapping;V.getClearColor(JM),V.toneMapping=ge,V.autoClear=!1;const Y=new Ha({name:"PMREM.Background",side:S,depthWrite:!1,depthTest:!1}),ee=new Fr(new Ga,Y);let de=!1;const xe=s.background;xe?xe.isColor&&(Y.color.copy(xe),s.background=null,de=!0):(Y.color.copy(JM),de=!0);for(let re=0;re<6;re++){const Q=re%3;Q===0?(P.up.set(0,F[re],0),P.lookAt(U[re],0,0)):Q===1?(P.up.set(0,0,F[re]),P.lookAt(0,U[re],0)):(P.up.set(0,F[re],0),P.lookAt(0,0,U[re])),_g(y,Q*ca,re>2?ca:0,ca,ca),V.setRenderTarget(y),de&&V.render(ee,P),V.render(s,P)}ee.geometry.dispose(),ee.material.dispose(),V.toneMapping=j,V.autoClear=W,s.background=xe}_textureToCubeUV(s,c){const p=this._renderer,y=s.mapping===$||s.mapping===me;y?(this._cubemapShader===null&&(this._cubemapShader=iS()),this._cubemapShader.uniforms.flipEnvMap.value=s.isRenderTargetTexture===!1?-1:1):this._equirectShader===null&&(this._equirectShader=nS());const M=y?this._cubemapShader:this._equirectShader,C=new Fr(Sf[0],M),P=M.uniforms;P.envMap.value=s,y||P.texelSize.value.set(1/s.image.width,1/s.image.height),_g(c,0,0,3*ca,2*ca),p.setRenderTarget(c),p.render(C,Ux)}_applyPMREM(s){const c=this._renderer,p=c.autoClear;c.autoClear=!1;for(let y=1;y<QM;y++){const M=Math.sqrt(xg[y]*xg[y]-xg[y-1]*xg[y-1]),C=eS[(y-1)%eS.length];this._blur(s,y-1,y,M,C)}c.autoClear=p}_blur(s,c,p,y,M){const C=this._pingPongRenderTarget;this._halfBlur(s,C,c,p,y,"latitudinal",M),this._halfBlur(C,s,p,p,y,"longitudinal",M)}_halfBlur(s,c,p,y,M,C,P){const F=this._renderer,U=this._blurMaterial;C!=="latitudinal"&&C!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const V=3,W=new Fr(Sf[y],U),j=U.uniforms,Y=ZM[p]-1,ee=isFinite(M)?Math.PI/(2*Y):2*Math.PI/(2*xh-1),de=M/ee,xe=isFinite(M)?1+Math.floor(V*de):xh;xe>xh&&console.warn(`sigmaRadians, ${M}, is too large and will clip, as it requested ${xe} samples when the maximum is set to ${xh}`);const re=[];let Q=0;for(let Xe=0;Xe<xh;++Xe){const st=Xe/de,ut=Math.exp(-st*st/2);re.push(ut),Xe===0?Q+=ut:Xe<xe&&(Q+=2*ut)}for(let Xe=0;Xe<re.length;Xe++)re[Xe]=re[Xe]/Q;j.envMap.value=s.texture,j.samples.value=xe,j.weights.value=re,j.latitudinal.value=C==="latitudinal",P&&(j.poleAxis.value=P),j.dTheta.value=ee,j.mipInt.value=Hl-p;const De=ZM[y],Me=3*Math.max(0,ca-2*De),Ie=(y===0?0:2*ca)+2*De*(y>Hl-yh?y-Hl+yh:0);_g(c,Me,Ie,3*De,2*De),F.setRenderTarget(c),F.render(W,Ux)}}function Y4(){const b=[],s=[],c=[];let p=Hl;for(let y=0;y<QM;y++){const M=Math.pow(2,p);s.push(M);let C=1/M;y>Hl-yh?C=KM[y-Hl+yh-1]:y===0&&(C=0),c.push(C);const P=1/(M-1),F=-P/2,U=1+P/2,V=[F,F,U,F,U,U,F,F,U,U,F,U],W=6,j=6,Y=3,ee=2,de=1,xe=new Float32Array(Y*j*W),re=new Float32Array(ee*j*W),Q=new Float32Array(de*j*W);for(let Me=0;Me<W;Me++){const Ie=Me%3*2/3-1,Xe=Me>2?0:-1,st=[Ie,Xe,0,Ie+2/3,Xe,0,Ie+2/3,Xe+1,0,Ie,Xe,0,Ie+2/3,Xe+1,0,Ie,Xe+1,0];xe.set(st,Y*j*Me),re.set(V,ee*j*Me);const ut=[Me,Me,Me,Me,Me,Me];Q.set(ut,de*j*Me)}const De=new si;De.setAttribute("position",new Hi(xe,Y)),De.setAttribute("uv",new Hi(re,ee)),De.setAttribute("faceIndex",new Hi(Q,de)),b.push(De),p>yh&&p--}return{_lodPlanes:b,_sizeLods:s,_sigmas:c}}function tS(b){const s=new js(3*ca,3*ca,b);return s.texture.mapping=Le,s.texture.name="PMREM.cubeUv",s.scissorTest=!0,s}function _g(b,s,c,p,y){b.viewport.set(s,c,p,y),b.scissor.set(s,c,p,y)}function K4(b){const s=new Float32Array(b),c=new Ge(0,1,0);return new vh({name:"SphericalGaussianBlur",defines:{n:b},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:s},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:c}},vertexShader:Gx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:I,depthTest:!1,depthWrite:!1})}function nS(){const b=new Qt(1,1);return new vh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:b}},vertexShader:Gx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = texture2D ( envMap, uv ).rgb;
				uv.x += texelSize.x;
				vec3 tr = texture2D ( envMap, uv ).rgb;
				uv.y += texelSize.y;
				vec3 br = texture2D ( envMap, uv ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = texture2D ( envMap, uv ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:I,depthTest:!1,depthWrite:!1})}function iS(){return new vh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Gx(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:I,depthTest:!1,depthWrite:!1})}function Gx(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Q4(b){let s=new WeakMap,c=null;function p(P){if(P&&P.isTexture){const F=P.mapping,U=F===Pe||F===ve,V=F===$||F===me;if(U||V)if(P.isRenderTargetTexture&&P.needsPMREMUpdate===!0){P.needsPMREMUpdate=!1;let W=s.get(P);return c===null&&(c=new Hx(b)),W=U?c.fromEquirectangular(P,W):c.fromCubemap(P,W),s.set(P,W),W.texture}else{if(s.has(P))return s.get(P).texture;{const W=P.image;if(U&&W&&W.height>0||V&&W&&y(W)){c===null&&(c=new Hx(b));const j=U?c.fromEquirectangular(P):c.fromCubemap(P);return s.set(P,j),P.addEventListener("dispose",M),j.texture}else return null}}}return P}function y(P){let F=0;const U=6;for(let V=0;V<U;V++)P[V]!==void 0&&F++;return F===U}function M(P){const F=P.target;F.removeEventListener("dispose",M);const U=s.get(F);U!==void 0&&(s.delete(F),U.dispose())}function C(){s=new WeakMap,c!==null&&(c.dispose(),c=null)}return{get:p,dispose:C}}function Z4(b){const s={};function c(p){if(s[p]!==void 0)return s[p];let y;switch(p){case"WEBGL_depth_texture":y=b.getExtension("WEBGL_depth_texture")||b.getExtension("MOZ_WEBGL_depth_texture")||b.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":y=b.getExtension("EXT_texture_filter_anisotropic")||b.getExtension("MOZ_EXT_texture_filter_anisotropic")||b.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":y=b.getExtension("WEBGL_compressed_texture_s3tc")||b.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":y=b.getExtension("WEBGL_compressed_texture_pvrtc")||b.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:y=b.getExtension(p)}return s[p]=y,y}return{has:function(p){return c(p)!==null},init:function(p){p.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float"),c("WEBGL_multisampled_render_to_texture")},get:function(p){const y=c(p);return y===null&&console.warn("THREE.WebGLRenderer: "+p+" extension not supported."),y}}}function J4(b,s,c,p){const y={},M=new WeakMap;function C(W){const j=W.target;j.index!==null&&s.remove(j.index);for(const ee in j.attributes)s.remove(j.attributes[ee]);j.removeEventListener("dispose",C),delete y[j.id];const Y=M.get(j);Y&&(s.remove(Y),M.delete(j)),p.releaseStatesOfGeometry(j),j.isInstancedBufferGeometry===!0&&delete j._maxInstanceCount,c.memory.geometries--}function P(W,j){return y[j.id]===!0||(j.addEventListener("dispose",C),y[j.id]=!0,c.memory.geometries++),j}function F(W){const j=W.attributes;for(const ee in j)s.update(j[ee],b.ARRAY_BUFFER);const Y=W.morphAttributes;for(const ee in Y){const de=Y[ee];for(let xe=0,re=de.length;xe<re;xe++)s.update(de[xe],b.ARRAY_BUFFER)}}function U(W){const j=[],Y=W.index,ee=W.attributes.position;let de=0;if(Y!==null){const Q=Y.array;de=Y.version;for(let De=0,Me=Q.length;De<Me;De+=3){const Ie=Q[De+0],Xe=Q[De+1],st=Q[De+2];j.push(Ie,Xe,Xe,st,st,Ie)}}else{const Q=ee.array;de=ee.version;for(let De=0,Me=Q.length/3-1;De<Me;De+=3){const Ie=De+0,Xe=De+1,st=De+2;j.push(Ie,Xe,Xe,st,st,Ie)}}const xe=new(CM(j)?ag:og)(j,1);xe.version=de;const re=M.get(W);re&&s.remove(re),M.set(W,xe)}function V(W){const j=M.get(W);if(j){const Y=W.index;Y!==null&&j.version<Y.version&&U(W)}else U(W);return M.get(W)}return{get:P,update:F,getWireframeAttribute:V}}function eB(b,s,c,p){const y=p.isWebGL2;let M;function C(j){M=j}let P,F;function U(j){P=j.type,F=j.bytesPerElement}function V(j,Y){b.drawElements(M,Y,P,j*F),c.update(Y,M,1)}function W(j,Y,ee){if(ee===0)return;let de,xe;if(y)de=b,xe="drawElementsInstanced";else if(de=s.get("ANGLE_instanced_arrays"),xe="drawElementsInstancedANGLE",de===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}de[xe](M,Y,P,j*F,ee),c.update(Y,M,ee)}this.setMode=C,this.setIndex=U,this.render=V,this.renderInstances=W}function tB(b){const s={geometries:0,textures:0},c={frame:0,calls:0,triangles:0,points:0,lines:0};function p(M,C,P){switch(c.calls++,C){case b.TRIANGLES:c.triangles+=P*(M/3);break;case b.LINES:c.lines+=P*(M/2);break;case b.LINE_STRIP:c.lines+=P*(M-1);break;case b.LINE_LOOP:c.lines+=P*M;break;case b.POINTS:c.points+=P*M;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",C);break}}function y(){c.frame++,c.calls=0,c.triangles=0,c.points=0,c.lines=0}return{memory:s,render:c,programs:null,autoReset:!0,reset:y,update:p}}class bg extends Nr{constructor(s=null,c=1,p=1,y=1){super(null),this.image={data:s,width:c,height:p,depth:y},this.magFilter=It,this.minFilter=It,this.wrapR=_t,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}bg.prototype.isDataTexture2DArray=!0;function nB(b,s){return b[0]-s[0]}function iB(b,s){return Math.abs(s[1])-Math.abs(b[1])}function rS(b,s){let c=1;const p=s.isInterleavedBufferAttribute?s.data.array:s.array;p instanceof Int8Array?c=127:p instanceof Int16Array?c=32767:p instanceof Int32Array?c=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",p),b.divideScalar(c)}function rB(b,s,c){const p={},y=new Float32Array(8),M=new WeakMap,C=new Ge,P=[];for(let U=0;U<8;U++)P[U]=[U,0];function F(U,V,W,j){const Y=U.morphTargetInfluences;if(s.isWebGL2===!0){const de=V.morphAttributes.position.length;let xe=M.get(V);if(xe===void 0||xe.count!==de){let vt=function(){Ee.dispose(),M.delete(V),V.removeEventListener("dispose",vt)};var ee=vt;xe!==void 0&&xe.texture.dispose();const De=V.morphAttributes.normal!==void 0,Me=V.morphAttributes.position,Ie=V.morphAttributes.normal||[],Xe=V.attributes.position.count,st=De===!0?2:1;let ut=Xe*st,Dt=1;ut>s.maxTextureSize&&(Dt=Math.ceil(ut/s.maxTextureSize),ut=s.maxTextureSize);const Rt=new Float32Array(ut*Dt*4*de),Ee=new bg(Rt,ut,Dt,de);Ee.format=Pt,Ee.type=Si,Ee.needsUpdate=!0;const Ye=st*4;for(let Et=0;Et<de;Et++){const gt=Me[Et],Lt=Ie[Et],Vt=ut*Dt*4*Et;for(let on=0;on<gt.count;on++){C.fromBufferAttribute(gt,on),gt.normalized===!0&&rS(C,gt);const Cn=on*Ye;Rt[Vt+Cn+0]=C.x,Rt[Vt+Cn+1]=C.y,Rt[Vt+Cn+2]=C.z,Rt[Vt+Cn+3]=0,De===!0&&(C.fromBufferAttribute(Lt,on),Lt.normalized===!0&&rS(C,Lt),Rt[Vt+Cn+4]=C.x,Rt[Vt+Cn+5]=C.y,Rt[Vt+Cn+6]=C.z,Rt[Vt+Cn+7]=0)}}xe={count:de,texture:Ee,size:new Qt(ut,Dt)},M.set(V,xe),V.addEventListener("dispose",vt)}let re=0;for(let De=0;De<Y.length;De++)re+=Y[De];const Q=V.morphTargetsRelative?1:1-re;j.getUniforms().setValue(b,"morphTargetBaseInfluence",Q),j.getUniforms().setValue(b,"morphTargetInfluences",Y),j.getUniforms().setValue(b,"morphTargetsTexture",xe.texture,c),j.getUniforms().setValue(b,"morphTargetsTextureSize",xe.size)}else{const de=Y===void 0?0:Y.length;let xe=p[V.id];if(xe===void 0||xe.length!==de){xe=[];for(let Ie=0;Ie<de;Ie++)xe[Ie]=[Ie,0];p[V.id]=xe}for(let Ie=0;Ie<de;Ie++){const Xe=xe[Ie];Xe[0]=Ie,Xe[1]=Y[Ie]}xe.sort(iB);for(let Ie=0;Ie<8;Ie++)Ie<de&&xe[Ie][1]?(P[Ie][0]=xe[Ie][0],P[Ie][1]=xe[Ie][1]):(P[Ie][0]=Number.MAX_SAFE_INTEGER,P[Ie][1]=0);P.sort(nB);const re=V.morphAttributes.position,Q=V.morphAttributes.normal;let De=0;for(let Ie=0;Ie<8;Ie++){const Xe=P[Ie],st=Xe[0],ut=Xe[1];st!==Number.MAX_SAFE_INTEGER&&ut?(re&&V.getAttribute("morphTarget"+Ie)!==re[st]&&V.setAttribute("morphTarget"+Ie,re[st]),Q&&V.getAttribute("morphNormal"+Ie)!==Q[st]&&V.setAttribute("morphNormal"+Ie,Q[st]),y[Ie]=ut,De+=ut):(re&&V.hasAttribute("morphTarget"+Ie)===!0&&V.deleteAttribute("morphTarget"+Ie),Q&&V.hasAttribute("morphNormal"+Ie)===!0&&V.deleteAttribute("morphNormal"+Ie),y[Ie]=0)}const Me=V.morphTargetsRelative?1:1-De;j.getUniforms().setValue(b,"morphTargetBaseInfluence",Me),j.getUniforms().setValue(b,"morphTargetInfluences",y)}}return{update:F}}function sB(b,s,c,p){let y=new WeakMap;function M(F){const U=p.render.frame,V=F.geometry,W=s.get(F,V);return y.get(W)!==U&&(s.update(W),y.set(W,U)),F.isInstancedMesh&&(F.hasEventListener("dispose",P)===!1&&F.addEventListener("dispose",P),c.update(F.instanceMatrix,b.ARRAY_BUFFER),F.instanceColor!==null&&c.update(F.instanceColor,b.ARRAY_BUFFER)),W}function C(){y=new WeakMap}function P(F){const U=F.target;U.removeEventListener("dispose",P),c.remove(U.instanceMatrix),U.instanceColor!==null&&c.remove(U.instanceColor)}return{update:M,dispose:C}}class Vx extends Nr{constructor(s=null,c=1,p=1,y=1){super(null),this.image={data:s,width:c,height:p,depth:y},this.magFilter=It,this.minFilter=It,this.wrapR=_t,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Vx.prototype.isDataTexture3D=!0;const sS=new Nr,oS=new bg,aS=new Vx,lS=new mh,cS=[],uS=[],hS=new Float32Array(16),dS=new Float32Array(9),fS=new Float32Array(4);function bh(b,s,c){const p=b[0];if(p<=0||p>0)return b;const y=s*c;let M=cS[y];if(M===void 0&&(M=new Float32Array(y),cS[y]=M),s!==0){p.toArray(M,0);for(let C=1,P=0;C!==s;++C)P+=c,b[C].toArray(M,P)}return M}function bs(b,s){if(b.length!==s.length)return!1;for(let c=0,p=b.length;c<p;c++)if(b[c]!==s[c])return!1;return!0}function hs(b,s){for(let c=0,p=s.length;c<p;c++)b[c]=s[c]}function Eg(b,s){let c=uS[s];c===void 0&&(c=new Int32Array(s),uS[s]=c);for(let p=0;p!==s;++p)c[p]=b.allocateTextureUnit();return c}function oB(b,s){const c=this.cache;c[0]!==s&&(b.uniform1f(this.addr,s),c[0]=s)}function aB(b,s){const c=this.cache;if(s.x!==void 0)(c[0]!==s.x||c[1]!==s.y)&&(b.uniform2f(this.addr,s.x,s.y),c[0]=s.x,c[1]=s.y);else{if(bs(c,s))return;b.uniform2fv(this.addr,s),hs(c,s)}}function lB(b,s){const c=this.cache;if(s.x!==void 0)(c[0]!==s.x||c[1]!==s.y||c[2]!==s.z)&&(b.uniform3f(this.addr,s.x,s.y,s.z),c[0]=s.x,c[1]=s.y,c[2]=s.z);else if(s.r!==void 0)(c[0]!==s.r||c[1]!==s.g||c[2]!==s.b)&&(b.uniform3f(this.addr,s.r,s.g,s.b),c[0]=s.r,c[1]=s.g,c[2]=s.b);else{if(bs(c,s))return;b.uniform3fv(this.addr,s),hs(c,s)}}function cB(b,s){const c=this.cache;if(s.x!==void 0)(c[0]!==s.x||c[1]!==s.y||c[2]!==s.z||c[3]!==s.w)&&(b.uniform4f(this.addr,s.x,s.y,s.z,s.w),c[0]=s.x,c[1]=s.y,c[2]=s.z,c[3]=s.w);else{if(bs(c,s))return;b.uniform4fv(this.addr,s),hs(c,s)}}function uB(b,s){const c=this.cache,p=s.elements;if(p===void 0){if(bs(c,s))return;b.uniformMatrix2fv(this.addr,!1,s),hs(c,s)}else{if(bs(c,p))return;fS.set(p),b.uniformMatrix2fv(this.addr,!1,fS),hs(c,p)}}function hB(b,s){const c=this.cache,p=s.elements;if(p===void 0){if(bs(c,s))return;b.uniformMatrix3fv(this.addr,!1,s),hs(c,s)}else{if(bs(c,p))return;dS.set(p),b.uniformMatrix3fv(this.addr,!1,dS),hs(c,p)}}function dB(b,s){const c=this.cache,p=s.elements;if(p===void 0){if(bs(c,s))return;b.uniformMatrix4fv(this.addr,!1,s),hs(c,s)}else{if(bs(c,p))return;hS.set(p),b.uniformMatrix4fv(this.addr,!1,hS),hs(c,p)}}function fB(b,s){const c=this.cache;c[0]!==s&&(b.uniform1i(this.addr,s),c[0]=s)}function pB(b,s){const c=this.cache;bs(c,s)||(b.uniform2iv(this.addr,s),hs(c,s))}function mB(b,s){const c=this.cache;bs(c,s)||(b.uniform3iv(this.addr,s),hs(c,s))}function gB(b,s){const c=this.cache;bs(c,s)||(b.uniform4iv(this.addr,s),hs(c,s))}function vB(b,s){const c=this.cache;c[0]!==s&&(b.uniform1ui(this.addr,s),c[0]=s)}function yB(b,s){const c=this.cache;bs(c,s)||(b.uniform2uiv(this.addr,s),hs(c,s))}function xB(b,s){const c=this.cache;bs(c,s)||(b.uniform3uiv(this.addr,s),hs(c,s))}function _B(b,s){const c=this.cache;bs(c,s)||(b.uniform4uiv(this.addr,s),hs(c,s))}function bB(b,s,c){const p=this.cache,y=c.allocateTextureUnit();p[0]!==y&&(b.uniform1i(this.addr,y),p[0]=y),c.safeSetTexture2D(s||sS,y)}function EB(b,s,c){const p=this.cache,y=c.allocateTextureUnit();p[0]!==y&&(b.uniform1i(this.addr,y),p[0]=y),c.setTexture3D(s||aS,y)}function AB(b,s,c){const p=this.cache,y=c.allocateTextureUnit();p[0]!==y&&(b.uniform1i(this.addr,y),p[0]=y),c.safeSetTextureCube(s||lS,y)}function wB(b,s,c){const p=this.cache,y=c.allocateTextureUnit();p[0]!==y&&(b.uniform1i(this.addr,y),p[0]=y),c.setTexture2DArray(s||oS,y)}function MB(b){switch(b){case 5126:return oB;case 35664:return aB;case 35665:return lB;case 35666:return cB;case 35674:return uB;case 35675:return hB;case 35676:return dB;case 5124:case 35670:return fB;case 35667:case 35671:return pB;case 35668:case 35672:return mB;case 35669:case 35673:return gB;case 5125:return vB;case 36294:return yB;case 36295:return xB;case 36296:return _B;case 35678:case 36198:case 36298:case 36306:case 35682:return bB;case 35679:case 36299:case 36307:return EB;case 35680:case 36300:case 36308:case 36293:return AB;case 36289:case 36303:case 36311:case 36292:return wB}}function SB(b,s){b.uniform1fv(this.addr,s)}function TB(b,s){const c=bh(s,this.size,2);b.uniform2fv(this.addr,c)}function CB(b,s){const c=bh(s,this.size,3);b.uniform3fv(this.addr,c)}function RB(b,s){const c=bh(s,this.size,4);b.uniform4fv(this.addr,c)}function LB(b,s){const c=bh(s,this.size,4);b.uniformMatrix2fv(this.addr,!1,c)}function PB(b,s){const c=bh(s,this.size,9);b.uniformMatrix3fv(this.addr,!1,c)}function DB(b,s){const c=bh(s,this.size,16);b.uniformMatrix4fv(this.addr,!1,c)}function OB(b,s){b.uniform1iv(this.addr,s)}function IB(b,s){b.uniform2iv(this.addr,s)}function kB(b,s){b.uniform3iv(this.addr,s)}function NB(b,s){b.uniform4iv(this.addr,s)}function FB(b,s){b.uniform1uiv(this.addr,s)}function BB(b,s){b.uniform2uiv(this.addr,s)}function UB(b,s){b.uniform3uiv(this.addr,s)}function zB(b,s){b.uniform4uiv(this.addr,s)}function HB(b,s,c){const p=s.length,y=Eg(c,p);b.uniform1iv(this.addr,y);for(let M=0;M!==p;++M)c.safeSetTexture2D(s[M]||sS,y[M])}function GB(b,s,c){const p=s.length,y=Eg(c,p);b.uniform1iv(this.addr,y);for(let M=0;M!==p;++M)c.setTexture3D(s[M]||aS,y[M])}function VB(b,s,c){const p=s.length,y=Eg(c,p);b.uniform1iv(this.addr,y);for(let M=0;M!==p;++M)c.safeSetTextureCube(s[M]||lS,y[M])}function WB(b,s,c){const p=s.length,y=Eg(c,p);b.uniform1iv(this.addr,y);for(let M=0;M!==p;++M)c.setTexture2DArray(s[M]||oS,y[M])}function jB(b){switch(b){case 5126:return SB;case 35664:return TB;case 35665:return CB;case 35666:return RB;case 35674:return LB;case 35675:return PB;case 35676:return DB;case 5124:case 35670:return OB;case 35667:case 35671:return IB;case 35668:case 35672:return kB;case 35669:case 35673:return NB;case 5125:return FB;case 36294:return BB;case 36295:return UB;case 36296:return zB;case 35678:case 36198:case 36298:case 36306:case 35682:return HB;case 35679:case 36299:case 36307:return GB;case 35680:case 36300:case 36308:case 36293:return VB;case 36289:case 36303:case 36311:case 36292:return WB}}function $B(b,s,c){this.id=b,this.addr=c,this.cache=[],this.setValue=MB(s.type)}function pS(b,s,c){this.id=b,this.addr=c,this.cache=[],this.size=s.size,this.setValue=jB(s.type)}pS.prototype.updateCache=function(b){const s=this.cache;b instanceof Float32Array&&s.length!==b.length&&(this.cache=new Float32Array(b.length)),hs(s,b)};function mS(b){this.id=b,this.seq=[],this.map={}}mS.prototype.setValue=function(b,s,c){const p=this.seq;for(let y=0,M=p.length;y!==M;++y){const C=p[y];C.setValue(b,s[C.id],c)}};const Wx=/(\w+)(\])?(\[|\.)?/g;function gS(b,s){b.seq.push(s),b.map[s.id]=s}function XB(b,s,c){const p=b.name,y=p.length;for(Wx.lastIndex=0;;){const M=Wx.exec(p),C=Wx.lastIndex;let P=M[1];const F=M[2]==="]",U=M[3];if(F&&(P=P|0),U===void 0||U==="["&&C+2===y){gS(c,U===void 0?new $B(P,b,s):new pS(P,b,s));break}else{let W=c.map[P];W===void 0&&(W=new mS(P),gS(c,W)),c=W}}}function Gl(b,s){this.seq=[],this.map={};const c=b.getProgramParameter(s,b.ACTIVE_UNIFORMS);for(let p=0;p<c;++p){const y=b.getActiveUniform(s,p),M=b.getUniformLocation(s,y.name);XB(y,M,this)}}Gl.prototype.setValue=function(b,s,c,p){const y=this.map[s];y!==void 0&&y.setValue(b,c,p)},Gl.prototype.setOptional=function(b,s,c){const p=s[c];p!==void 0&&this.setValue(b,c,p)},Gl.upload=function(b,s,c,p){for(let y=0,M=s.length;y!==M;++y){const C=s[y],P=c[C.id];P.needsUpdate!==!1&&C.setValue(b,P.value,p)}},Gl.seqWithValue=function(b,s){const c=[];for(let p=0,y=b.length;p!==y;++p){const M=b[p];M.id in s&&c.push(M)}return c};function vS(b,s,c){const p=b.createShader(s);return b.shaderSource(p,c),b.compileShader(p),p}let qB=0;function YB(b){const s=b.split(`
`);for(let c=0;c<s.length;c++)s[c]=c+1+": "+s[c];return s.join(`
`)}function KB(b){switch(b){case hn:return["Linear","( value )"];case Sn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",b),["Linear","( value )"]}}function yS(b,s,c){const p=b.getShaderParameter(s,b.COMPILE_STATUS),y=b.getShaderInfoLog(s).trim();return p&&y===""?"":c.toUpperCase()+`

`+y+`

`+YB(b.getShaderSource(s))}function QB(b,s){const c=KB(s);return"vec4 "+b+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function ZB(b,s){let c;switch(s){case Fe:c="Linear";break;case Re:c="Reinhard";break;case ce:c="OptimizedCineon";break;case ae:c="ACESFilmic";break;case J:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",s),c="Linear"}return"vec3 "+b+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function JB(b){return[b.extensionDerivatives||b.envMapCubeUV||b.bumpMap||b.tangentSpaceNormalMap||b.clearcoatNormalMap||b.flatShading||b.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(b.extensionFragDepth||b.logarithmicDepthBuffer)&&b.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",b.extensionDrawBuffers&&b.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(b.extensionShaderTextureLOD||b.envMap||b.transmission)&&b.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Tf).join(`
`)}function e5(b){const s=[];for(const c in b){const p=b[c];p!==!1&&s.push("#define "+c+" "+p)}return s.join(`
`)}function t5(b,s){const c={},p=b.getProgramParameter(s,b.ACTIVE_ATTRIBUTES);for(let y=0;y<p;y++){const M=b.getActiveAttrib(s,y),C=M.name;let P=1;M.type===b.FLOAT_MAT2&&(P=2),M.type===b.FLOAT_MAT3&&(P=3),M.type===b.FLOAT_MAT4&&(P=4),c[C]={type:M.type,location:b.getAttribLocation(s,C),locationSize:P}}return c}function Tf(b){return b!==""}function xS(b,s){return b.replace(/NUM_DIR_LIGHTS/g,s.numDirLights).replace(/NUM_SPOT_LIGHTS/g,s.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,s.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,s.numPointLights).replace(/NUM_HEMI_LIGHTS/g,s.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,s.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,s.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,s.numPointLightShadows)}function _S(b,s){return b.replace(/NUM_CLIPPING_PLANES/g,s.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,s.numClippingPlanes-s.numClipIntersection)}const n5=/^[ \t]*#include +<([\w\d./]+)>/gm;function jx(b){return b.replace(n5,i5)}function i5(b,s){const c=Pi[s];if(c===void 0)throw new Error("Can not resolve #include <"+s+">");return jx(c)}const r5=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,s5=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function bS(b){return b.replace(s5,ES).replace(r5,o5)}function o5(b,s,c,p){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ES(b,s,c,p)}function ES(b,s,c,p){let y="";for(let M=parseInt(s);M<parseInt(c);M++)y+=p.replace(/\[\s*i\s*\]/g,"[ "+M+" ]").replace(/UNROLLED_LOOP_INDEX/g,M);return y}function AS(b){let s="precision "+b.precision+` float;
precision `+b.precision+" int;";return b.precision==="highp"?s+=`
#define HIGH_PRECISION`:b.precision==="mediump"?s+=`
#define MEDIUM_PRECISION`:b.precision==="lowp"&&(s+=`
#define LOW_PRECISION`),s}function a5(b){let s="SHADOWMAP_TYPE_BASIC";return b.shadowMapType===A?s="SHADOWMAP_TYPE_PCF":b.shadowMapType===_?s="SHADOWMAP_TYPE_PCF_SOFT":b.shadowMapType===E&&(s="SHADOWMAP_TYPE_VSM"),s}function l5(b){let s="ENVMAP_TYPE_CUBE";if(b.envMap)switch(b.envMapMode){case $:case me:s="ENVMAP_TYPE_CUBE";break;case Le:case wt:s="ENVMAP_TYPE_CUBE_UV";break}return s}function c5(b){let s="ENVMAP_MODE_REFLECTION";if(b.envMap)switch(b.envMapMode){case me:case wt:s="ENVMAP_MODE_REFRACTION";break}return s}function u5(b){let s="ENVMAP_BLENDING_NONE";if(b.envMap)switch(b.combine){case At:s="ENVMAP_BLENDING_MULTIPLY";break;case tt:s="ENVMAP_BLENDING_MIX";break;case pe:s="ENVMAP_BLENDING_ADD";break}return s}function h5(b,s,c,p){const y=b.getContext(),M=c.defines;let C=c.vertexShader,P=c.fragmentShader;const F=a5(c),U=l5(c),V=c5(c),W=u5(c),j=c.isWebGL2?"":JB(c),Y=e5(M),ee=y.createProgram();let de,xe,re=c.glslVersion?"#version "+c.glslVersion+`
`:"";c.isRawShaderMaterial?(de=[Y].filter(Tf).join(`
`),de.length>0&&(de+=`
`),xe=[j,Y].filter(Tf).join(`
`),xe.length>0&&(xe+=`
`)):(de=[AS(c),"#define SHADER_NAME "+c.shaderName,Y,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+c.maxBones,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+V:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.displacementMap&&c.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularColorMap?"#define USE_SPECULARCOLORMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.sheenColorMap?"#define USE_SHEENCOLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&c.flatShading===!1?"#define USE_MORPHNORMALS":"",c.morphTargets&&c.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",c.morphTargets&&c.isWebGL2?"#define MORPHTARGETS_COUNT "+c.morphTargetsCount:"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Tf).join(`
`),xe=[j,AS(c),"#define SHADER_NAME "+c.shaderName,Y,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+U:"",c.envMap?"#define "+V:"",c.envMap?"#define "+W:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularColorMap?"#define USE_SPECULARCOLORMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.sheen?"#define USE_SHEEN":"",c.sheenColorMap?"#define USE_SHEENCOLORMAP":"",c.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+F:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(c.extensionShaderTextureLOD||c.envMap)&&c.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==ge?"#define TONE_MAPPING":"",c.toneMapping!==ge?Pi.tonemapping_pars_fragment:"",c.toneMapping!==ge?ZB("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.alphaWrite?"":"#define OPAQUE",Pi.encodings_pars_fragment,QB("linearToOutputTexel",c.outputEncoding),c.depthPacking?"#define DEPTH_PACKING "+c.depthPacking:"",`
`].filter(Tf).join(`
`)),C=jx(C),C=xS(C,c),C=_S(C,c),P=jx(P),P=xS(P,c),P=_S(P,c),C=bS(C),P=bS(P),c.isWebGL2&&c.isRawShaderMaterial!==!0&&(re=`#version 300 es
`,de=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+de,xe=["#define varying in",c.glslVersion===px?"":"layout(location = 0) out highp vec4 pc_fragColor;",c.glslVersion===px?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+xe);const Q=re+de+C,De=re+xe+P,Me=vS(y,y.VERTEX_SHADER,Q),Ie=vS(y,y.FRAGMENT_SHADER,De);if(y.attachShader(ee,Me),y.attachShader(ee,Ie),c.index0AttributeName!==void 0?y.bindAttribLocation(ee,0,c.index0AttributeName):c.morphTargets===!0&&y.bindAttribLocation(ee,0,"position"),y.linkProgram(ee),b.debug.checkShaderErrors){const ut=y.getProgramInfoLog(ee).trim(),Dt=y.getShaderInfoLog(Me).trim(),Rt=y.getShaderInfoLog(Ie).trim();let Ee=!0,Ye=!0;if(y.getProgramParameter(ee,y.LINK_STATUS)===!1){Ee=!1;const vt=yS(y,Me,"vertex"),Et=yS(y,Ie,"fragment");console.error("THREE.WebGLProgram: Shader Error "+y.getError()+" - VALIDATE_STATUS "+y.getProgramParameter(ee,y.VALIDATE_STATUS)+`

Program Info Log: `+ut+`
`+vt+`
`+Et)}else ut!==""?console.warn("THREE.WebGLProgram: Program Info Log:",ut):(Dt===""||Rt==="")&&(Ye=!1);Ye&&(this.diagnostics={runnable:Ee,programLog:ut,vertexShader:{log:Dt,prefix:de},fragmentShader:{log:Rt,prefix:xe}})}y.deleteShader(Me),y.deleteShader(Ie);let Xe;this.getUniforms=function(){return Xe===void 0&&(Xe=new Gl(y,ee)),Xe};let st;return this.getAttributes=function(){return st===void 0&&(st=t5(y,ee)),st},this.destroy=function(){p.releaseStatesOfProgram(this),y.deleteProgram(ee),this.program=void 0},this.name=c.shaderName,this.id=qB++,this.cacheKey=s,this.usedTimes=1,this.program=ee,this.vertexShader=Me,this.fragmentShader=Ie,this}let d5=0;class f5{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(s){const c=s.vertexShader,p=s.fragmentShader,y=this._getShaderStage(c),M=this._getShaderStage(p),C=this._getShaderCacheForMaterial(s);return C.has(y)===!1&&(C.add(y),y.usedTimes++),C.has(M)===!1&&(C.add(M),M.usedTimes++),this}remove(s){const c=this.materialCache.get(s);for(const p of c)p.usedTimes--,p.usedTimes===0&&this.shaderCache.delete(p);return this.materialCache.delete(s),this}getVertexShaderID(s){return this._getShaderStage(s.vertexShader).id}getFragmentShaderID(s){return this._getShaderStage(s.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(s){const c=this.materialCache;return c.has(s)===!1&&c.set(s,new Set),c.get(s)}_getShaderStage(s){const c=this.shaderCache;if(c.has(s)===!1){const p=new p5;c.set(s,p)}return c.get(s)}}class p5{constructor(){this.id=d5++,this.usedTimes=0}}function m5(b,s,c,p,y,M,C){const P=new ig,F=new f5,U=[],V=y.isWebGL2,W=y.logarithmicDepthBuffer,j=y.floatVertexTextures,Y=y.maxVertexUniforms,ee=y.vertexTextures;let de=y.precision;const xe={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function re(Ee){const vt=Ee.skeleton.bones;if(j)return 1024;{const gt=Math.floor((Y-20)/4),Lt=Math.min(gt,vt.length);return Lt<vt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+vt.length+" bones. This GPU supports "+Lt+"."),0):Lt}}function Q(Ee,Ye,vt,Et,gt){const Lt=Et.fog,Vt=Ee.isMeshStandardMaterial?Et.environment:null,on=(Ee.isMeshStandardMaterial?c:s).get(Ee.envMap||Vt),Cn=xe[Ee.type],Qn=gt.isSkinnedMesh?re(gt):0;Ee.precision!==null&&(de=y.getMaxPrecision(Ee.precision),de!==Ee.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ee.precision,"not supported, using",de,"instead."));let Dn,Yt,gn,ni;if(Cn){const On=ko[Cn];Dn=On.vertexShader,Yt=On.fragmentShader}else Dn=Ee.vertexShader,Yt=Ee.fragmentShader,F.update(Ee),gn=F.getVertexShaderID(Ee),ni=F.getFragmentShaderID(Ee);const ht=b.getRenderTarget(),ai=Ee.alphaTest>0,Nn=Ee.clearcoat>0;return{isWebGL2:V,shaderID:Cn,shaderName:Ee.type,vertexShader:Dn,fragmentShader:Yt,defines:Ee.defines,customVertexShaderID:gn,customFragmentShaderID:ni,isRawShaderMaterial:Ee.isRawShaderMaterial===!0,glslVersion:Ee.glslVersion,precision:de,instancing:gt.isInstancedMesh===!0,instancingColor:gt.isInstancedMesh===!0&&gt.instanceColor!==null,supportsVertexTextures:ee,outputEncoding:ht===null?b.outputEncoding:ht.isXRRenderTarget===!0?ht.texture.encoding:hn,map:!!Ee.map,matcap:!!Ee.matcap,envMap:!!on,envMapMode:on&&on.mapping,envMapCubeUV:!!on&&(on.mapping===Le||on.mapping===wt),lightMap:!!Ee.lightMap,aoMap:!!Ee.aoMap,emissiveMap:!!Ee.emissiveMap,bumpMap:!!Ee.bumpMap,normalMap:!!Ee.normalMap,objectSpaceNormalMap:Ee.normalMapType===ti,tangentSpaceNormalMap:Ee.normalMapType===bn,decodeVideoTexture:!!Ee.map&&Ee.map.isVideoTexture===!0&&Ee.map.encoding===Sn,clearcoat:Nn,clearcoatMap:Nn&&!!Ee.clearcoatMap,clearcoatRoughnessMap:Nn&&!!Ee.clearcoatRoughnessMap,clearcoatNormalMap:Nn&&!!Ee.clearcoatNormalMap,displacementMap:!!Ee.displacementMap,roughnessMap:!!Ee.roughnessMap,metalnessMap:!!Ee.metalnessMap,specularMap:!!Ee.specularMap,specularIntensityMap:!!Ee.specularIntensityMap,specularColorMap:!!Ee.specularColorMap,alphaMap:!!Ee.alphaMap,alphaTest:ai,alphaWrite:Ee.alphaWrite||Ee.transparent,gradientMap:!!Ee.gradientMap,sheen:Ee.sheen>0,sheenColorMap:!!Ee.sheenColorMap,sheenRoughnessMap:!!Ee.sheenRoughnessMap,transmission:Ee.transmission>0,transmissionMap:!!Ee.transmissionMap,thicknessMap:!!Ee.thicknessMap,combine:Ee.combine,vertexTangents:!!Ee.normalMap&&!!gt.geometry&&!!gt.geometry.attributes.tangent,vertexColors:Ee.vertexColors,vertexAlphas:Ee.vertexColors===!0&&!!gt.geometry&&!!gt.geometry.attributes.color&&gt.geometry.attributes.color.itemSize===4,vertexUvs:!!Ee.map||!!Ee.bumpMap||!!Ee.normalMap||!!Ee.specularMap||!!Ee.alphaMap||!!Ee.emissiveMap||!!Ee.roughnessMap||!!Ee.metalnessMap||!!Ee.clearcoatMap||!!Ee.clearcoatRoughnessMap||!!Ee.clearcoatNormalMap||!!Ee.displacementMap||!!Ee.transmissionMap||!!Ee.thicknessMap||!!Ee.specularIntensityMap||!!Ee.specularColorMap||!!Ee.sheenColorMap||!!Ee.sheenRoughnessMap,uvsVertexOnly:!(!!Ee.map||!!Ee.bumpMap||!!Ee.normalMap||!!Ee.specularMap||!!Ee.alphaMap||!!Ee.emissiveMap||!!Ee.roughnessMap||!!Ee.metalnessMap||!!Ee.clearcoatNormalMap||Ee.transmission>0||!!Ee.transmissionMap||!!Ee.thicknessMap||!!Ee.specularIntensityMap||!!Ee.specularColorMap||Ee.sheen>0||!!Ee.sheenColorMap||!!Ee.sheenRoughnessMap)&&!!Ee.displacementMap,fog:!!Lt,useFog:Ee.fog,fogExp2:Lt&&Lt.isFogExp2,flatShading:!!Ee.flatShading,sizeAttenuation:Ee.sizeAttenuation,logarithmicDepthBuffer:W,skinning:gt.isSkinnedMesh===!0&&Qn>0,maxBones:Qn,useVertexTexture:j,morphTargets:!!gt.geometry&&!!gt.geometry.morphAttributes.position,morphNormals:!!gt.geometry&&!!gt.geometry.morphAttributes.normal,morphTargetsCount:!!gt.geometry&&!!gt.geometry.morphAttributes.position?gt.geometry.morphAttributes.position.length:0,numDirLights:Ye.directional.length,numPointLights:Ye.point.length,numSpotLights:Ye.spot.length,numRectAreaLights:Ye.rectArea.length,numHemiLights:Ye.hemi.length,numDirLightShadows:Ye.directionalShadowMap.length,numPointLightShadows:Ye.pointShadowMap.length,numSpotLightShadows:Ye.spotShadowMap.length,numClippingPlanes:C.numPlanes,numClipIntersection:C.numIntersection,dithering:Ee.dithering,shadowMapEnabled:b.shadowMap.enabled&&vt.length>0,shadowMapType:b.shadowMap.type,toneMapping:Ee.toneMapped?b.toneMapping:ge,physicallyCorrectLights:b.physicallyCorrectLights,premultipliedAlpha:Ee.premultipliedAlpha,doubleSided:Ee.side===T,flipSided:Ee.side===S,depthPacking:Ee.depthPacking!==void 0?Ee.depthPacking:!1,index0AttributeName:Ee.index0AttributeName,extensionDerivatives:Ee.extensions&&Ee.extensions.derivatives,extensionFragDepth:Ee.extensions&&Ee.extensions.fragDepth,extensionDrawBuffers:Ee.extensions&&Ee.extensions.drawBuffers,extensionShaderTextureLOD:Ee.extensions&&Ee.extensions.shaderTextureLOD,rendererExtensionFragDepth:V||p.has("EXT_frag_depth"),rendererExtensionDrawBuffers:V||p.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:V||p.has("EXT_shader_texture_lod"),customProgramCacheKey:Ee.customProgramCacheKey()}}function De(Ee){const Ye=[];if(Ee.shaderID?Ye.push(Ee.shaderID):(Ye.push(Ee.customVertexShaderID),Ye.push(Ee.customFragmentShaderID)),Ee.defines!==void 0)for(const vt in Ee.defines)Ye.push(vt),Ye.push(Ee.defines[vt]);return Ee.isRawShaderMaterial===!1&&(Me(Ye,Ee),Ie(Ye,Ee),Ye.push(b.outputEncoding)),Ye.push(Ee.customProgramCacheKey),Ye.join()}function Me(Ee,Ye){Ee.push(Ye.precision),Ee.push(Ye.outputEncoding),Ee.push(Ye.envMapMode),Ee.push(Ye.combine),Ee.push(Ye.vertexUvs),Ee.push(Ye.fogExp2),Ee.push(Ye.sizeAttenuation),Ee.push(Ye.maxBones),Ee.push(Ye.morphTargetsCount),Ee.push(Ye.numDirLights),Ee.push(Ye.numPointLights),Ee.push(Ye.numSpotLights),Ee.push(Ye.numHemiLights),Ee.push(Ye.numRectAreaLights),Ee.push(Ye.numDirLightShadows),Ee.push(Ye.numPointLightShadows),Ee.push(Ye.numSpotLightShadows),Ee.push(Ye.shadowMapType),Ee.push(Ye.toneMapping),Ee.push(Ye.numClippingPlanes),Ee.push(Ye.numClipIntersection),Ee.push(Ye.alphaWrite)}function Ie(Ee,Ye){P.disableAll(),Ye.isWebGL2&&P.enable(0),Ye.supportsVertexTextures&&P.enable(1),Ye.instancing&&P.enable(2),Ye.instancingColor&&P.enable(3),Ye.map&&P.enable(4),Ye.matcap&&P.enable(5),Ye.envMap&&P.enable(6),Ye.envMapCubeUV&&P.enable(7),Ye.lightMap&&P.enable(8),Ye.aoMap&&P.enable(9),Ye.emissiveMap&&P.enable(10),Ye.bumpMap&&P.enable(11),Ye.normalMap&&P.enable(12),Ye.objectSpaceNormalMap&&P.enable(13),Ye.tangentSpaceNormalMap&&P.enable(14),Ye.clearcoat&&P.enable(15),Ye.clearcoatMap&&P.enable(16),Ye.clearcoatRoughnessMap&&P.enable(17),Ye.clearcoatNormalMap&&P.enable(18),Ye.displacementMap&&P.enable(19),Ye.specularMap&&P.enable(20),Ye.roughnessMap&&P.enable(21),Ye.metalnessMap&&P.enable(22),Ye.gradientMap&&P.enable(23),Ye.alphaMap&&P.enable(24),Ye.alphaTest&&P.enable(25),Ye.vertexColors&&P.enable(26),Ye.vertexAlphas&&P.enable(27),Ye.vertexUvs&&P.enable(28),Ye.vertexTangents&&P.enable(29),Ye.uvsVertexOnly&&P.enable(30),Ye.fog&&P.enable(31),Ee.push(P.mask),P.disableAll(),Ye.useFog&&P.enable(0),Ye.flatShading&&P.enable(1),Ye.logarithmicDepthBuffer&&P.enable(2),Ye.skinning&&P.enable(3),Ye.useVertexTexture&&P.enable(4),Ye.morphTargets&&P.enable(5),Ye.morphNormals&&P.enable(6),Ye.premultipliedAlpha&&P.enable(7),Ye.shadowMapEnabled&&P.enable(8),Ye.physicallyCorrectLights&&P.enable(9),Ye.doubleSided&&P.enable(10),Ye.flipSided&&P.enable(11),Ye.depthPacking&&P.enable(12),Ye.dithering&&P.enable(13),Ye.specularIntensityMap&&P.enable(14),Ye.specularColorMap&&P.enable(15),Ye.transmission&&P.enable(16),Ye.transmissionMap&&P.enable(17),Ye.thicknessMap&&P.enable(18),Ye.sheen&&P.enable(19),Ye.sheenColorMap&&P.enable(20),Ye.sheenRoughnessMap&&P.enable(21),Ye.decodeVideoTexture&&P.enable(22),Ee.push(P.mask)}function Xe(Ee){const Ye=xe[Ee.type];let vt;if(Ye){const Et=ko[Ye];vt=YM.clone(Et.uniforms)}else vt=Ee.uniforms;return vt}function st(Ee,Ye){let vt;for(let Et=0,gt=U.length;Et<gt;Et++){const Lt=U[Et];if(Lt.cacheKey===Ye){vt=Lt,++vt.usedTimes;break}}return vt===void 0&&(vt=new h5(b,Ye,Ee,M),U.push(vt)),vt}function ut(Ee){if(--Ee.usedTimes===0){const Ye=U.indexOf(Ee);U[Ye]=U[U.length-1],U.pop(),Ee.destroy()}}function Dt(Ee){F.remove(Ee)}function Rt(){F.dispose()}return{getParameters:Q,getProgramCacheKey:De,getUniforms:Xe,acquireProgram:st,releaseProgram:ut,releaseShaderCache:Dt,programs:U,dispose:Rt}}function g5(){let b=new WeakMap;function s(M){let C=b.get(M);return C===void 0&&(C={},b.set(M,C)),C}function c(M){b.delete(M)}function p(M,C,P){b.get(M)[C]=P}function y(){b=new WeakMap}return{get:s,remove:c,update:p,dispose:y}}function v5(b,s){return b.groupOrder!==s.groupOrder?b.groupOrder-s.groupOrder:b.renderOrder!==s.renderOrder?b.renderOrder-s.renderOrder:b.material.id!==s.material.id?b.material.id-s.material.id:b.z!==s.z?b.z-s.z:b.id-s.id}function wS(b,s){return b.groupOrder!==s.groupOrder?b.groupOrder-s.groupOrder:b.renderOrder!==s.renderOrder?b.renderOrder-s.renderOrder:b.z!==s.z?s.z-b.z:b.id-s.id}function MS(){const b=[];let s=0;const c=[],p=[],y=[];function M(){s=0,c.length=0,p.length=0,y.length=0}function C(W,j,Y,ee,de,xe){let re=b[s];return re===void 0?(re={id:W.id,object:W,geometry:j,material:Y,groupOrder:ee,renderOrder:W.renderOrder,z:de,group:xe},b[s]=re):(re.id=W.id,re.object=W,re.geometry=j,re.material=Y,re.groupOrder=ee,re.renderOrder=W.renderOrder,re.z=de,re.group=xe),s++,re}function P(W,j,Y,ee,de,xe){const re=C(W,j,Y,ee,de,xe);Y.transmission>0?p.push(re):Y.transparent===!0?y.push(re):c.push(re)}function F(W,j,Y,ee,de,xe){const re=C(W,j,Y,ee,de,xe);Y.transmission>0?p.unshift(re):Y.transparent===!0?y.unshift(re):c.unshift(re)}function U(W,j){c.length>1&&c.sort(W||v5),p.length>1&&p.sort(j||wS),y.length>1&&y.sort(j||wS)}function V(){for(let W=s,j=b.length;W<j;W++){const Y=b[W];if(Y.id===null)break;Y.id=null,Y.object=null,Y.geometry=null,Y.material=null,Y.group=null}}return{opaque:c,transmissive:p,transparent:y,init:M,push:P,unshift:F,finish:V,sort:U}}function y5(){let b=new WeakMap;function s(p,y){let M;return b.has(p)===!1?(M=new MS,b.set(p,[M])):y>=b.get(p).length?(M=new MS,b.get(p).push(M)):M=b.get(p)[y],M}function c(){b=new WeakMap}return{get:s,dispose:c}}function x5(){const b={};return{get:function(s){if(b[s.id]!==void 0)return b[s.id];let c;switch(s.type){case"DirectionalLight":c={direction:new Ge,color:new Tn};break;case"SpotLight":c={position:new Ge,direction:new Ge,color:new Tn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new Ge,color:new Tn,distance:0,decay:0};break;case"HemisphereLight":c={direction:new Ge,skyColor:new Tn,groundColor:new Tn};break;case"RectAreaLight":c={color:new Tn,position:new Ge,halfWidth:new Ge,halfHeight:new Ge};break}return b[s.id]=c,c}}}function _5(){const b={};return{get:function(s){if(b[s.id]!==void 0)return b[s.id];let c;switch(s.type){case"DirectionalLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qt};break;case"SpotLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qt};break;case"PointLight":c={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Qt,shadowCameraNear:1,shadowCameraFar:1e3};break}return b[s.id]=c,c}}}let b5=0;function E5(b,s){return(s.castShadow?1:0)-(b.castShadow?1:0)}function A5(b,s){const c=new x5,p=_5(),y={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let V=0;V<9;V++)y.probe.push(new Ge);const M=new Ge,C=new zn,P=new zn;function F(V,W){let j=0,Y=0,ee=0;for(let Dt=0;Dt<9;Dt++)y.probe[Dt].set(0,0,0);let de=0,xe=0,re=0,Q=0,De=0,Me=0,Ie=0,Xe=0;V.sort(E5);const st=W!==!0?Math.PI:1;for(let Dt=0,Rt=V.length;Dt<Rt;Dt++){const Ee=V[Dt],Ye=Ee.color,vt=Ee.intensity,Et=Ee.distance,gt=Ee.shadow&&Ee.shadow.map?Ee.shadow.map.texture:null;if(Ee.isAmbientLight)j+=Ye.r*vt*st,Y+=Ye.g*vt*st,ee+=Ye.b*vt*st;else if(Ee.isLightProbe)for(let Lt=0;Lt<9;Lt++)y.probe[Lt].addScaledVector(Ee.sh.coefficients[Lt],vt);else if(Ee.isDirectionalLight){const Lt=c.get(Ee);if(Lt.color.copy(Ee.color).multiplyScalar(Ee.intensity*st),Ee.castShadow){const Vt=Ee.shadow,on=p.get(Ee);on.shadowBias=Vt.bias,on.shadowNormalBias=Vt.normalBias,on.shadowRadius=Vt.radius,on.shadowMapSize=Vt.mapSize,y.directionalShadow[de]=on,y.directionalShadowMap[de]=gt,y.directionalShadowMatrix[de]=Ee.shadow.matrix,Me++}y.directional[de]=Lt,de++}else if(Ee.isSpotLight){const Lt=c.get(Ee);if(Lt.position.setFromMatrixPosition(Ee.matrixWorld),Lt.color.copy(Ye).multiplyScalar(vt*st),Lt.distance=Et,Lt.coneCos=Math.cos(Ee.angle),Lt.penumbraCos=Math.cos(Ee.angle*(1-Ee.penumbra)),Lt.decay=Ee.decay,Ee.castShadow){const Vt=Ee.shadow,on=p.get(Ee);on.shadowBias=Vt.bias,on.shadowNormalBias=Vt.normalBias,on.shadowRadius=Vt.radius,on.shadowMapSize=Vt.mapSize,y.spotShadow[re]=on,y.spotShadowMap[re]=gt,y.spotShadowMatrix[re]=Ee.shadow.matrix,Xe++}y.spot[re]=Lt,re++}else if(Ee.isRectAreaLight){const Lt=c.get(Ee);Lt.color.copy(Ye).multiplyScalar(vt),Lt.halfWidth.set(Ee.width*.5,0,0),Lt.halfHeight.set(0,Ee.height*.5,0),y.rectArea[Q]=Lt,Q++}else if(Ee.isPointLight){const Lt=c.get(Ee);if(Lt.color.copy(Ee.color).multiplyScalar(Ee.intensity*st),Lt.distance=Ee.distance,Lt.decay=Ee.decay,Ee.castShadow){const Vt=Ee.shadow,on=p.get(Ee);on.shadowBias=Vt.bias,on.shadowNormalBias=Vt.normalBias,on.shadowRadius=Vt.radius,on.shadowMapSize=Vt.mapSize,on.shadowCameraNear=Vt.camera.near,on.shadowCameraFar=Vt.camera.far,y.pointShadow[xe]=on,y.pointShadowMap[xe]=gt,y.pointShadowMatrix[xe]=Ee.shadow.matrix,Ie++}y.point[xe]=Lt,xe++}else if(Ee.isHemisphereLight){const Lt=c.get(Ee);Lt.skyColor.copy(Ee.color).multiplyScalar(vt*st),Lt.groundColor.copy(Ee.groundColor).multiplyScalar(vt*st),y.hemi[De]=Lt,De++}}Q>0&&(s.isWebGL2||b.has("OES_texture_float_linear")===!0?(y.rectAreaLTC1=En.LTC_FLOAT_1,y.rectAreaLTC2=En.LTC_FLOAT_2):b.has("OES_texture_half_float_linear")===!0?(y.rectAreaLTC1=En.LTC_HALF_1,y.rectAreaLTC2=En.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),y.ambient[0]=j,y.ambient[1]=Y,y.ambient[2]=ee;const ut=y.hash;(ut.directionalLength!==de||ut.pointLength!==xe||ut.spotLength!==re||ut.rectAreaLength!==Q||ut.hemiLength!==De||ut.numDirectionalShadows!==Me||ut.numPointShadows!==Ie||ut.numSpotShadows!==Xe)&&(y.directional.length=de,y.spot.length=re,y.rectArea.length=Q,y.point.length=xe,y.hemi.length=De,y.directionalShadow.length=Me,y.directionalShadowMap.length=Me,y.pointShadow.length=Ie,y.pointShadowMap.length=Ie,y.spotShadow.length=Xe,y.spotShadowMap.length=Xe,y.directionalShadowMatrix.length=Me,y.pointShadowMatrix.length=Ie,y.spotShadowMatrix.length=Xe,ut.directionalLength=de,ut.pointLength=xe,ut.spotLength=re,ut.rectAreaLength=Q,ut.hemiLength=De,ut.numDirectionalShadows=Me,ut.numPointShadows=Ie,ut.numSpotShadows=Xe,y.version=b5++)}function U(V,W){let j=0,Y=0,ee=0,de=0,xe=0;const re=W.matrixWorldInverse;for(let Q=0,De=V.length;Q<De;Q++){const Me=V[Q];if(Me.isDirectionalLight){const Ie=y.directional[j];Ie.direction.setFromMatrixPosition(Me.matrixWorld),M.setFromMatrixPosition(Me.target.matrixWorld),Ie.direction.sub(M),Ie.direction.transformDirection(re),j++}else if(Me.isSpotLight){const Ie=y.spot[ee];Ie.position.setFromMatrixPosition(Me.matrixWorld),Ie.position.applyMatrix4(re),Ie.direction.setFromMatrixPosition(Me.matrixWorld),M.setFromMatrixPosition(Me.target.matrixWorld),Ie.direction.sub(M),Ie.direction.transformDirection(re),ee++}else if(Me.isRectAreaLight){const Ie=y.rectArea[de];Ie.position.setFromMatrixPosition(Me.matrixWorld),Ie.position.applyMatrix4(re),P.identity(),C.copy(Me.matrixWorld),C.premultiply(re),P.extractRotation(C),Ie.halfWidth.set(Me.width*.5,0,0),Ie.halfHeight.set(0,Me.height*.5,0),Ie.halfWidth.applyMatrix4(P),Ie.halfHeight.applyMatrix4(P),de++}else if(Me.isPointLight){const Ie=y.point[Y];Ie.position.setFromMatrixPosition(Me.matrixWorld),Ie.position.applyMatrix4(re),Y++}else if(Me.isHemisphereLight){const Ie=y.hemi[xe];Ie.direction.setFromMatrixPosition(Me.matrixWorld),Ie.direction.transformDirection(re),Ie.direction.normalize(),xe++}}}return{setup:F,setupView:U,state:y}}function SS(b,s){const c=new A5(b,s),p=[],y=[];function M(){p.length=0,y.length=0}function C(W){p.push(W)}function P(W){y.push(W)}function F(W){c.setup(p,W)}function U(W){c.setupView(p,W)}return{init:M,state:{lightsArray:p,shadowsArray:y,lights:c},setupLights:F,setupLightsView:U,pushLight:C,pushShadow:P}}function w5(b,s){let c=new WeakMap;function p(M,C=0){let P;return c.has(M)===!1?(P=new SS(b,s),c.set(M,[P])):C>=c.get(M).length?(P=new SS(b,s),c.get(M).push(P)):P=c.get(M)[C],P}function y(){c=new WeakMap}return{get:p,dispose:y}}class Ag extends Kr{constructor(s){super(),this.type="MeshDepthMaterial",this.depthPacking=Kn,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(s)}copy(s){return super.copy(s),this.depthPacking=s.depthPacking,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this}}Ag.prototype.isMeshDepthMaterial=!0;class wg extends Kr{constructor(s){super(),this.type="MeshDistanceMaterial",this.referencePosition=new Ge,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(s)}copy(s){return super.copy(s),this.referencePosition.copy(s.referencePosition),this.nearDistance=s.nearDistance,this.farDistance=s.farDistance,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this}}wg.prototype.isMeshDistanceMaterial=!0;const M5=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,S5=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function TS(b,s,c){let p=new wf;const y=new Qt,M=new Qt,C=new Qi,P=new Ag({depthPacking:ei}),F=new wg,U={},V=c.maxTextureSize,W={0:S,1:w,2:T},j=new Va({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Qt},radius:{value:4}},vertexShader:M5,fragmentShader:S5}),Y=j.clone();Y.defines.HORIZONTAL_PASS=1;const ee=new si;ee.setAttribute("position",new Hi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const de=new Fr(ee,j),xe=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=A,this.render=function(Me,Ie,Xe){if(xe.enabled===!1||xe.autoUpdate===!1&&xe.needsUpdate===!1||Me.length===0)return;const st=b.getRenderTarget(),ut=b.getActiveCubeFace(),Dt=b.getActiveMipmapLevel(),Rt=b.state;Rt.setBlending(I),Rt.buffers.color.setClear(1,1,1,1),Rt.buffers.depth.setTest(!0),Rt.setScissorTest(!1);for(let Ee=0,Ye=Me.length;Ee<Ye;Ee++){const vt=Me[Ee],Et=vt.shadow;if(Et===void 0){console.warn("THREE.WebGLShadowMap:",vt,"has no shadow.");continue}if(Et.autoUpdate===!1&&Et.needsUpdate===!1)continue;y.copy(Et.mapSize);const gt=Et.getFrameExtents();if(y.multiply(gt),M.copy(Et.mapSize),(y.x>V||y.y>V)&&(y.x>V&&(M.x=Math.floor(V/gt.x),y.x=M.x*gt.x,Et.mapSize.x=M.x),y.y>V&&(M.y=Math.floor(V/gt.y),y.y=M.y*gt.y,Et.mapSize.y=M.y)),Et.map===null&&!Et.isPointLightShadow&&this.type===E){const Vt={minFilter:Ve,magFilter:Ve,format:Pt};Et.map=new js(y.x,y.y,Vt),Et.map.texture.name=vt.name+".shadowMap",Et.mapPass=new js(y.x,y.y,Vt),Et.camera.updateProjectionMatrix()}if(Et.map===null){const Vt={minFilter:It,magFilter:It,format:Pt};Et.map=new js(y.x,y.y,Vt),Et.map.texture.name=vt.name+".shadowMap",Et.camera.updateProjectionMatrix()}b.setRenderTarget(Et.map),b.clear();const Lt=Et.getViewportCount();for(let Vt=0;Vt<Lt;Vt++){const on=Et.getViewport(Vt);C.set(M.x*on.x,M.y*on.y,M.x*on.z,M.y*on.w),Rt.viewport(C),Et.updateMatrices(vt,Vt),p=Et.getFrustum(),De(Ie,Xe,Et.camera,vt,this.type)}!Et.isPointLightShadow&&this.type===E&&re(Et,Xe),Et.needsUpdate=!1}xe.needsUpdate=!1,b.setRenderTarget(st,ut,Dt)};function re(Me,Ie){const Xe=s.update(de);j.defines.VSM_SAMPLES!==Me.blurSamples&&(j.defines.VSM_SAMPLES=Me.blurSamples,Y.defines.VSM_SAMPLES=Me.blurSamples,j.needsUpdate=!0,Y.needsUpdate=!0),j.uniforms.shadow_pass.value=Me.map.texture,j.uniforms.resolution.value=Me.mapSize,j.uniforms.radius.value=Me.radius,b.setRenderTarget(Me.mapPass),b.clear(),b.renderBufferDirect(Ie,null,Xe,j,de,null),Y.uniforms.shadow_pass.value=Me.mapPass.texture,Y.uniforms.resolution.value=Me.mapSize,Y.uniforms.radius.value=Me.radius,b.setRenderTarget(Me.map),b.clear(),b.renderBufferDirect(Ie,null,Xe,Y,de,null)}function Q(Me,Ie,Xe,st,ut,Dt,Rt){let Ee=null;const Ye=st.isPointLight===!0?Me.customDistanceMaterial:Me.customDepthMaterial;if(Ye!==void 0?Ee=Ye:Ee=st.isPointLight===!0?F:P,b.localClippingEnabled&&Xe.clipShadows===!0&&Xe.clippingPlanes.length!==0||Xe.displacementMap&&Xe.displacementScale!==0||Xe.alphaMap&&Xe.alphaTest>0){const vt=Ee.uuid,Et=Xe.uuid;let gt=U[vt];gt===void 0&&(gt={},U[vt]=gt);let Lt=gt[Et];Lt===void 0&&(Lt=Ee.clone(),gt[Et]=Lt),Ee=Lt}return Ee.visible=Xe.visible,Ee.wireframe=Xe.wireframe,Rt===E?Ee.side=Xe.shadowSide!==null?Xe.shadowSide:Xe.side:Ee.side=Xe.shadowSide!==null?Xe.shadowSide:W[Xe.side],Ee.alphaMap=Xe.alphaMap,Ee.alphaTest=Xe.alphaTest,Ee.clipShadows=Xe.clipShadows,Ee.clippingPlanes=Xe.clippingPlanes,Ee.clipIntersection=Xe.clipIntersection,Ee.displacementMap=Xe.displacementMap,Ee.displacementScale=Xe.displacementScale,Ee.displacementBias=Xe.displacementBias,Ee.wireframeLinewidth=Xe.wireframeLinewidth,Ee.linewidth=Xe.linewidth,st.isPointLight===!0&&Ee.isMeshDistanceMaterial===!0&&(Ee.referencePosition.setFromMatrixPosition(st.matrixWorld),Ee.nearDistance=ut,Ee.farDistance=Dt),Ee}function De(Me,Ie,Xe,st,ut){if(Me.visible===!1)return;if(Me.layers.test(Ie.layers)&&(Me.isMesh||Me.isLine||Me.isPoints)&&(Me.castShadow||Me.receiveShadow&&ut===E)&&(!Me.frustumCulled||p.intersectsObject(Me))){Me.modelViewMatrix.multiplyMatrices(Xe.matrixWorldInverse,Me.matrixWorld);const Ee=s.update(Me),Ye=Me.material;if(Array.isArray(Ye)){const vt=Ee.groups;for(let Et=0,gt=vt.length;Et<gt;Et++){const Lt=vt[Et],Vt=Ye[Lt.materialIndex];if(Vt&&Vt.visible){const on=Q(Me,Ee,Vt,st,Xe.near,Xe.far,ut);b.renderBufferDirect(Xe,null,Ee,on,Me,Lt)}}}else if(Ye.visible){const vt=Q(Me,Ee,Ye,st,Xe.near,Xe.far,ut);b.renderBufferDirect(Xe,null,Ee,vt,Me,null)}}const Rt=Me.children;for(let Ee=0,Ye=Rt.length;Ee<Ye;Ee++)De(Rt[Ee],Ie,Xe,st,ut)}}function T5(b,s,c){const p=c.isWebGL2;function y(){let ct=!1;const jn=new Qi;let Fn=null;const yi=new Qi(0,0,0,0);return{setMask:function(Kt){Fn!==Kt&&!ct&&(b.colorMask(Kt,Kt,Kt,Kt),Fn=Kt)},setLocked:function(Kt){ct=Kt},setClear:function(Kt,oi,Ui,yr,Ks){Ks===!0&&(Kt*=yr,oi*=yr,Ui*=yr),jn.set(Kt,oi,Ui,yr),yi.equals(jn)===!1&&(b.clearColor(Kt,oi,Ui,yr),yi.copy(jn))},reset:function(){ct=!1,Fn=null,yi.set(-1,0,0,0)}}}function M(){let ct=!1,jn=null,Fn=null,yi=null;return{setTest:function(Kt){Kt?ht(b.DEPTH_TEST):ai(b.DEPTH_TEST)},setMask:function(Kt){jn!==Kt&&!ct&&(b.depthMask(Kt),jn=Kt)},setFunc:function(Kt){if(Fn!==Kt){if(Kt)switch(Kt){case Qe:b.depthFunc(b.NEVER);break;case St:b.depthFunc(b.ALWAYS);break;case bt:b.depthFunc(b.LESS);break;case Jt:b.depthFunc(b.LEQUAL);break;case sn:b.depthFunc(b.EQUAL);break;case Se:b.depthFunc(b.GEQUAL);break;case qe:b.depthFunc(b.GREATER);break;case Ue:b.depthFunc(b.NOTEQUAL);break;default:b.depthFunc(b.LEQUAL)}else b.depthFunc(b.LEQUAL);Fn=Kt}},setLocked:function(Kt){ct=Kt},setClear:function(Kt){yi!==Kt&&(b.clearDepth(Kt),yi=Kt)},reset:function(){ct=!1,jn=null,Fn=null,yi=null}}}function C(){let ct=!1,jn=null,Fn=null,yi=null,Kt=null,oi=null,Ui=null,yr=null,Ks=null;return{setTest:function(Tr){ct||(Tr?ht(b.STENCIL_TEST):ai(b.STENCIL_TEST))},setMask:function(Tr){jn!==Tr&&!ct&&(b.stencilMask(Tr),jn=Tr)},setFunc:function(Tr,ma,Xa){(Fn!==Tr||yi!==ma||Kt!==Xa)&&(b.stencilFunc(Tr,ma,Xa),Fn=Tr,yi=ma,Kt=Xa)},setOp:function(Tr,ma,Xa){(oi!==Tr||Ui!==ma||yr!==Xa)&&(b.stencilOp(Tr,ma,Xa),oi=Tr,Ui=ma,yr=Xa)},setLocked:function(Tr){ct=Tr},setClear:function(Tr){Ks!==Tr&&(b.clearStencil(Tr),Ks=Tr)},reset:function(){ct=!1,jn=null,Fn=null,yi=null,Kt=null,oi=null,Ui=null,yr=null,Ks=null}}}const P=new y,F=new M,U=new C;let V={},W={},j=new WeakMap,Y=[],ee=null,de=!1,xe=null,re=null,Q=null,De=null,Me=null,Ie=null,Xe=null,st=!1,ut=null,Dt=null,Rt=null,Ee=null,Ye=null;const vt=b.getParameter(b.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Et=!1,gt=0;const Lt=b.getParameter(b.VERSION);Lt.indexOf("WebGL")!==-1?(gt=parseFloat(/^WebGL (\d)/.exec(Lt)[1]),Et=gt>=1):Lt.indexOf("OpenGL ES")!==-1&&(gt=parseFloat(/^OpenGL ES (\d)/.exec(Lt)[1]),Et=gt>=2);let Vt=null,on={};const Cn=b.getParameter(b.SCISSOR_BOX),Qn=b.getParameter(b.VIEWPORT),Dn=new Qi().fromArray(Cn),Yt=new Qi().fromArray(Qn);function gn(ct,jn,Fn){const yi=new Uint8Array(4),Kt=b.createTexture();b.bindTexture(ct,Kt),b.texParameteri(ct,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(ct,b.TEXTURE_MAG_FILTER,b.NEAREST);for(let oi=0;oi<Fn;oi++)b.texImage2D(jn+oi,0,b.RGBA,1,1,0,b.RGBA,b.UNSIGNED_BYTE,yi);return Kt}const ni={};ni[b.TEXTURE_2D]=gn(b.TEXTURE_2D,b.TEXTURE_2D,1),ni[b.TEXTURE_CUBE_MAP]=gn(b.TEXTURE_CUBE_MAP,b.TEXTURE_CUBE_MAP_POSITIVE_X,6),P.setClear(0,0,0,1),F.setClear(1),U.setClear(0),ht(b.DEPTH_TEST),F.setFunc(Jt),xn(!1),Gn(m),ht(b.CULL_FACE),$t(I);function ht(ct){V[ct]!==!0&&(b.enable(ct),V[ct]=!0)}function ai(ct){V[ct]!==!1&&(b.disable(ct),V[ct]=!1)}function Nn(ct,jn){return W[ct]!==jn?(b.bindFramebuffer(ct,jn),W[ct]=jn,p&&(ct===b.DRAW_FRAMEBUFFER&&(W[b.FRAMEBUFFER]=jn),ct===b.FRAMEBUFFER&&(W[b.DRAW_FRAMEBUFFER]=jn)),!0):!1}function li(ct,jn){let Fn=Y,yi=!1;if(ct)if(Fn=j.get(jn),Fn===void 0&&(Fn=[],j.set(jn,Fn)),ct.isWebGLMultipleRenderTargets){const Kt=ct.texture;if(Fn.length!==Kt.length||Fn[0]!==b.COLOR_ATTACHMENT0){for(let oi=0,Ui=Kt.length;oi<Ui;oi++)Fn[oi]=b.COLOR_ATTACHMENT0+oi;Fn.length=Kt.length,yi=!0}}else Fn[0]!==b.COLOR_ATTACHMENT0&&(Fn[0]=b.COLOR_ATTACHMENT0,yi=!0);else Fn[0]!==b.BACK&&(Fn[0]=b.BACK,yi=!0);yi&&(c.isWebGL2?b.drawBuffers(Fn):s.get("WEBGL_draw_buffers").drawBuffersWEBGL(Fn))}function On(ct){return ee!==ct?(b.useProgram(ct),ee=ct,!0):!1}const Ai={[ne]:b.FUNC_ADD,[D]:b.FUNC_SUBTRACT,[O]:b.FUNC_REVERSE_SUBTRACT};if(p)Ai[k]=b.MIN,Ai[z]=b.MAX;else{const ct=s.get("EXT_blend_minmax");ct!==null&&(Ai[k]=ct.MIN_EXT,Ai[z]=ct.MAX_EXT)}const ci={[X]:b.ZERO,[Z]:b.ONE,[ie]:b.SRC_COLOR,[ue]:b.SRC_ALPHA,[He]:b.SRC_ALPHA_SATURATE,[Oe]:b.DST_COLOR,[Ce]:b.DST_ALPHA,[se]:b.ONE_MINUS_SRC_COLOR,[ye]:b.ONE_MINUS_SRC_ALPHA,[Ne]:b.ONE_MINUS_DST_COLOR,[ke]:b.ONE_MINUS_DST_ALPHA};function $t(ct,jn,Fn,yi,Kt,oi,Ui,yr){if(ct===I){de===!0&&(ai(b.BLEND),de=!1);return}if(de===!1&&(ht(b.BLEND),de=!0),ct!==le){if(ct!==xe||yr!==st){if((re!==ne||Me!==ne)&&(b.blendEquation(b.FUNC_ADD),re=ne,Me=ne),yr)switch(ct){case N:b.blendFuncSeparate(b.ONE,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);break;case B:b.blendFunc(b.ONE,b.ONE);break;case H:b.blendFuncSeparate(b.ZERO,b.ONE_MINUS_SRC_COLOR,b.ZERO,b.ONE);break;case q:b.blendFuncSeparate(b.ZERO,b.SRC_COLOR,b.ZERO,b.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct);break}else switch(ct){case N:b.blendFuncSeparate(b.SRC_ALPHA,b.ONE_MINUS_SRC_ALPHA,b.ONE,b.ONE_MINUS_SRC_ALPHA);break;case B:b.blendFunc(b.SRC_ALPHA,b.ONE);break;case H:b.blendFuncSeparate(b.ZERO,b.ONE_MINUS_SRC_COLOR,b.ZERO,b.ONE);break;case q:b.blendFunc(b.ZERO,b.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct);break}Q=null,De=null,Ie=null,Xe=null,xe=ct,st=yr}return}Kt=Kt||jn,oi=oi||Fn,Ui=Ui||yi,(jn!==re||Kt!==Me)&&(b.blendEquationSeparate(Ai[jn],Ai[Kt]),re=jn,Me=Kt),(Fn!==Q||yi!==De||oi!==Ie||Ui!==Xe)&&(b.blendFuncSeparate(ci[Fn],ci[yi],ci[oi],ci[Ui]),Q=Fn,De=yi,Ie=oi,Xe=Ui),xe=ct,st=null}function vn(ct,jn){ct.side===T?ai(b.CULL_FACE):ht(b.CULL_FACE);let Fn=ct.side===S;jn&&(Fn=!Fn),xn(Fn),ct.blending===N&&ct.transparent===!1?$t(I):$t(ct.blending,ct.blendEquation,ct.blendSrc,ct.blendDst,ct.blendEquationAlpha,ct.blendSrcAlpha,ct.blendDstAlpha,ct.premultipliedAlpha),F.setFunc(ct.depthFunc),F.setTest(ct.depthTest),F.setMask(ct.depthWrite),P.setMask(ct.colorWrite);const yi=ct.stencilWrite;U.setTest(yi),yi&&(U.setMask(ct.stencilWriteMask),U.setFunc(ct.stencilFunc,ct.stencilRef,ct.stencilFuncMask),U.setOp(ct.stencilFail,ct.stencilZFail,ct.stencilZPass)),vi(ct.polygonOffset,ct.polygonOffsetFactor,ct.polygonOffsetUnits),ct.alphaToCoverage===!0?ht(b.SAMPLE_ALPHA_TO_COVERAGE):ai(b.SAMPLE_ALPHA_TO_COVERAGE)}function xn(ct){ut!==ct&&(ct?b.frontFace(b.CW):b.frontFace(b.CCW),ut=ct)}function Gn(ct){ct!==d?(ht(b.CULL_FACE),ct!==Dt&&(ct===m?b.cullFace(b.BACK):ct===g?b.cullFace(b.FRONT):b.cullFace(b.FRONT_AND_BACK))):ai(b.CULL_FACE),Dt=ct}function Ln(ct){ct!==Rt&&(Et&&b.lineWidth(ct),Rt=ct)}function vi(ct,jn,Fn){ct?(ht(b.POLYGON_OFFSET_FILL),(Ee!==jn||Ye!==Fn)&&(b.polygonOffset(jn,Fn),Ee=jn,Ye=Fn)):ai(b.POLYGON_OFFSET_FILL)}function pi(ct){ct?ht(b.SCISSOR_TEST):ai(b.SCISSOR_TEST)}function Fi(ct){ct===void 0&&(ct=b.TEXTURE0+vt-1),Vt!==ct&&(b.activeTexture(ct),Vt=ct)}function cr(ct,jn){Vt===null&&Fi();let Fn=on[Vt];Fn===void 0&&(Fn={type:void 0,texture:void 0},on[Vt]=Fn),(Fn.type!==ct||Fn.texture!==jn)&&(b.bindTexture(ct,jn||ni[ct]),Fn.type=ct,Fn.texture=jn)}function ir(){const ct=on[Vt];ct!==void 0&&ct.type!==void 0&&(b.bindTexture(ct.type,null),ct.type=void 0,ct.texture=void 0)}function Ke(){try{b.compressedTexImage2D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function je(){try{b.texSubImage2D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function Xt(){try{b.texSubImage3D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function yn(){try{b.compressedTexSubImage2D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function qn(){try{b.texStorage2D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function jt(){try{b.texStorage3D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function ii(){try{b.texImage2D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function Zn(){try{b.texImage3D.apply(b,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}}function Pn(ct){Dn.equals(ct)===!1&&(b.scissor(ct.x,ct.y,ct.z,ct.w),Dn.copy(ct))}function wn(ct){Yt.equals(ct)===!1&&(b.viewport(ct.x,ct.y,ct.z,ct.w),Yt.copy(ct))}function wi(){b.disable(b.BLEND),b.disable(b.CULL_FACE),b.disable(b.DEPTH_TEST),b.disable(b.POLYGON_OFFSET_FILL),b.disable(b.SCISSOR_TEST),b.disable(b.STENCIL_TEST),b.disable(b.SAMPLE_ALPHA_TO_COVERAGE),b.blendEquation(b.FUNC_ADD),b.blendFunc(b.ONE,b.ZERO),b.blendFuncSeparate(b.ONE,b.ZERO,b.ONE,b.ZERO),b.colorMask(!0,!0,!0,!0),b.clearColor(0,0,0,0),b.depthMask(!0),b.depthFunc(b.LESS),b.clearDepth(1),b.stencilMask(4294967295),b.stencilFunc(b.ALWAYS,0,4294967295),b.stencilOp(b.KEEP,b.KEEP,b.KEEP),b.clearStencil(0),b.cullFace(b.BACK),b.frontFace(b.CCW),b.polygonOffset(0,0),b.activeTexture(b.TEXTURE0),b.bindFramebuffer(b.FRAMEBUFFER,null),p===!0&&(b.bindFramebuffer(b.DRAW_FRAMEBUFFER,null),b.bindFramebuffer(b.READ_FRAMEBUFFER,null)),b.useProgram(null),b.lineWidth(1),b.scissor(0,0,b.canvas.width,b.canvas.height),b.viewport(0,0,b.canvas.width,b.canvas.height),V={},Vt=null,on={},W={},j=new WeakMap,Y=[],ee=null,de=!1,xe=null,re=null,Q=null,De=null,Me=null,Ie=null,Xe=null,st=!1,ut=null,Dt=null,Rt=null,Ee=null,Ye=null,Dn.set(0,0,b.canvas.width,b.canvas.height),Yt.set(0,0,b.canvas.width,b.canvas.height),P.reset(),F.reset(),U.reset()}return{buffers:{color:P,depth:F,stencil:U},enable:ht,disable:ai,bindFramebuffer:Nn,drawBuffers:li,useProgram:On,setBlending:$t,setMaterial:vn,setFlipSided:xn,setCullFace:Gn,setLineWidth:Ln,setPolygonOffset:vi,setScissorTest:pi,activeTexture:Fi,bindTexture:cr,unbindTexture:ir,compressedTexImage2D:Ke,texImage2D:ii,texImage3D:Zn,texStorage2D:qn,texStorage3D:jt,texSubImage2D:je,texSubImage3D:Xt,compressedTexSubImage2D:yn,scissor:Pn,viewport:wn,reset:wi}}function C5(b,s,c,p,y,M,C){const P=y.isWebGL2,F=y.maxTextures,U=y.maxCubemapSize,V=y.maxTextureSize,W=y.maxSamples,Y=s.has("WEBGL_multisampled_render_to_texture")?s.get("WEBGL_multisampled_render_to_texture"):void 0,ee=new WeakMap;let de,xe=!1;try{xe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function re(Ke,je){return xe?new OffscreenCanvas(Ke,je):xf("canvas")}function Q(Ke,je,Xt,yn){let qn=1;if((Ke.width>yn||Ke.height>yn)&&(qn=yn/Math.max(Ke.width,Ke.height)),qn<1||je===!0)if(typeof HTMLImageElement<"u"&&Ke instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ke instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ke instanceof ImageBitmap){const jt=je?SM:Math.floor,ii=jt(qn*Ke.width),Zn=jt(qn*Ke.height);de===void 0&&(de=re(ii,Zn));const Pn=Xt?re(ii,Zn):de;return Pn.width=ii,Pn.height=Zn,Pn.getContext("2d").drawImage(Ke,0,0,ii,Zn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ke.width+"x"+Ke.height+") to ("+ii+"x"+Zn+")."),Pn}else return"data"in Ke&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ke.width+"x"+Ke.height+")."),Ke;return Ke}function De(Ke){return gx(Ke.width)&&gx(Ke.height)}function Me(Ke){return P?!1:Ke.wrapS!==_t||Ke.wrapT!==_t||Ke.minFilter!==It&&Ke.minFilter!==Ve}function Ie(Ke,je){return Ke.generateMipmaps&&je&&Ke.minFilter!==It&&Ke.minFilter!==Ve}function Xe(Ke){b.generateMipmap(Ke)}function st(Ke,je,Xt,yn,qn=!1){if(P===!1)return je;if(Ke!==null){if(b[Ke]!==void 0)return b[Ke];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ke+"'")}let jt=je;return je===b.RED&&(Xt===b.FLOAT&&(jt=b.R32F),Xt===b.HALF_FLOAT&&(jt=b.R16F),Xt===b.UNSIGNED_BYTE&&(jt=b.R8)),je===b.RG&&(Xt===b.FLOAT&&(jt=b.RG32F),Xt===b.HALF_FLOAT&&(jt=b.RG16F),Xt===b.UNSIGNED_BYTE&&(jt=b.RG8)),je===b.RGBA&&(Xt===b.FLOAT&&(jt=b.RGBA32F),Xt===b.HALF_FLOAT&&(jt=b.RGBA16F),Xt===b.UNSIGNED_BYTE&&(jt=yn===Sn&&qn===!1?b.SRGB8_ALPHA8:b.RGBA8),Xt===b.UNSIGNED_SHORT_4_4_4_4&&(jt=b.RGBA4),Xt===b.UNSIGNED_SHORT_5_5_5_1&&(jt=b.RGB5_A1)),(jt===b.R16F||jt===b.R32F||jt===b.RG16F||jt===b.RG32F||jt===b.RGBA16F||jt===b.RGBA32F)&&s.get("EXT_color_buffer_float"),jt}function ut(Ke,je,Xt){return Ie(Ke,Xt)===!0||Ke.isFramebufferTexture&&Ke.minFilter!==It&&Ke.minFilter!==Ve?Math.log2(Math.max(je.width,je.height))+1:Ke.mipmaps!==void 0&&Ke.mipmaps.length>0?Ke.mipmaps.length:Ke.isCompressedTexture&&Array.isArray(Ke.image)?je.mipmaps.length:1}function Dt(Ke){return Ke===It||Ke===dn||Ke===$n?b.NEAREST:b.LINEAR}function Rt(Ke){const je=Ke.target;je.removeEventListener("dispose",Rt),Ye(je),je.isVideoTexture&&ee.delete(je),C.memory.textures--}function Ee(Ke){const je=Ke.target;je.removeEventListener("dispose",Ee),vt(je)}function Ye(Ke){const je=p.get(Ke);je.__webglInit!==void 0&&(b.deleteTexture(je.__webglTexture),p.remove(Ke))}function vt(Ke){const je=Ke.texture,Xt=p.get(Ke),yn=p.get(je);if(!!Ke){if(yn.__webglTexture!==void 0&&(b.deleteTexture(yn.__webglTexture),C.memory.textures--),Ke.depthTexture&&Ke.depthTexture.dispose(),Ke.isWebGLCubeRenderTarget)for(let qn=0;qn<6;qn++)b.deleteFramebuffer(Xt.__webglFramebuffer[qn]),Xt.__webglDepthbuffer&&b.deleteRenderbuffer(Xt.__webglDepthbuffer[qn]);else b.deleteFramebuffer(Xt.__webglFramebuffer),Xt.__webglDepthbuffer&&b.deleteRenderbuffer(Xt.__webglDepthbuffer),Xt.__webglMultisampledFramebuffer&&b.deleteFramebuffer(Xt.__webglMultisampledFramebuffer),Xt.__webglColorRenderbuffer&&b.deleteRenderbuffer(Xt.__webglColorRenderbuffer),Xt.__webglDepthRenderbuffer&&b.deleteRenderbuffer(Xt.__webglDepthRenderbuffer);if(Ke.isWebGLMultipleRenderTargets)for(let qn=0,jt=je.length;qn<jt;qn++){const ii=p.get(je[qn]);ii.__webglTexture&&(b.deleteTexture(ii.__webglTexture),C.memory.textures--),p.remove(je[qn])}p.remove(je),p.remove(Ke)}}let Et=0;function gt(){Et=0}function Lt(){const Ke=Et;return Ke>=F&&console.warn("THREE.WebGLTextures: Trying to use "+Ke+" texture units while this GPU supports only "+F),Et+=1,Ke}function Vt(Ke,je){const Xt=p.get(Ke);if(Ke.isVideoTexture&&Ln(Ke),Ke.version>0&&Xt.__version!==Ke.version){const yn=Ke.image;if(yn===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(yn.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ht(Xt,Ke,je);return}}c.activeTexture(b.TEXTURE0+je),c.bindTexture(b.TEXTURE_2D,Xt.__webglTexture)}function on(Ke,je){const Xt=p.get(Ke);if(Ke.version>0&&Xt.__version!==Ke.version){ht(Xt,Ke,je);return}c.activeTexture(b.TEXTURE0+je),c.bindTexture(b.TEXTURE_2D_ARRAY,Xt.__webglTexture)}function Cn(Ke,je){const Xt=p.get(Ke);if(Ke.version>0&&Xt.__version!==Ke.version){ht(Xt,Ke,je);return}c.activeTexture(b.TEXTURE0+je),c.bindTexture(b.TEXTURE_3D,Xt.__webglTexture)}function Qn(Ke,je){const Xt=p.get(Ke);if(Ke.version>0&&Xt.__version!==Ke.version){ai(Xt,Ke,je);return}c.activeTexture(b.TEXTURE0+je),c.bindTexture(b.TEXTURE_CUBE_MAP,Xt.__webglTexture)}const Dn={[Ot]:b.REPEAT,[_t]:b.CLAMP_TO_EDGE,[Ut]:b.MIRRORED_REPEAT},Yt={[It]:b.NEAREST,[dn]:b.NEAREST_MIPMAP_NEAREST,[$n]:b.NEAREST_MIPMAP_LINEAR,[Ve]:b.LINEAR,[nt]:b.LINEAR_MIPMAP_NEAREST,[Wt]:b.LINEAR_MIPMAP_LINEAR};function gn(Ke,je,Xt){if(Xt?(b.texParameteri(Ke,b.TEXTURE_WRAP_S,Dn[je.wrapS]),b.texParameteri(Ke,b.TEXTURE_WRAP_T,Dn[je.wrapT]),(Ke===b.TEXTURE_3D||Ke===b.TEXTURE_2D_ARRAY)&&b.texParameteri(Ke,b.TEXTURE_WRAP_R,Dn[je.wrapR]),b.texParameteri(Ke,b.TEXTURE_MAG_FILTER,Yt[je.magFilter]),b.texParameteri(Ke,b.TEXTURE_MIN_FILTER,Yt[je.minFilter])):(b.texParameteri(Ke,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(Ke,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),(Ke===b.TEXTURE_3D||Ke===b.TEXTURE_2D_ARRAY)&&b.texParameteri(Ke,b.TEXTURE_WRAP_R,b.CLAMP_TO_EDGE),(je.wrapS!==_t||je.wrapT!==_t)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),b.texParameteri(Ke,b.TEXTURE_MAG_FILTER,Dt(je.magFilter)),b.texParameteri(Ke,b.TEXTURE_MIN_FILTER,Dt(je.minFilter)),je.minFilter!==It&&je.minFilter!==Ve&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),s.has("EXT_texture_filter_anisotropic")===!0){const yn=s.get("EXT_texture_filter_anisotropic");if(je.type===Si&&s.has("OES_texture_float_linear")===!1||P===!1&&je.type===Gi&&s.has("OES_texture_half_float_linear")===!1)return;(je.anisotropy>1||p.get(je).__currentAnisotropy)&&(b.texParameterf(Ke,yn.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(je.anisotropy,y.getMaxAnisotropy())),p.get(je).__currentAnisotropy=je.anisotropy)}}function ni(Ke,je){Ke.__webglInit===void 0&&(Ke.__webglInit=!0,je.addEventListener("dispose",Rt),Ke.__webglTexture=b.createTexture(),C.memory.textures++)}function ht(Ke,je,Xt){let yn=b.TEXTURE_2D;je.isDataTexture2DArray&&(yn=b.TEXTURE_2D_ARRAY),je.isDataTexture3D&&(yn=b.TEXTURE_3D),ni(Ke,je),c.activeTexture(b.TEXTURE0+Xt),c.bindTexture(yn,Ke.__webglTexture),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,je.flipY),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,je.premultiplyAlpha),b.pixelStorei(b.UNPACK_ALIGNMENT,je.unpackAlignment),b.pixelStorei(b.UNPACK_COLORSPACE_CONVERSION_WEBGL,b.NONE);const qn=Me(je)&&De(je.image)===!1;let jt=Q(je.image,qn,!1,V);jt=vi(je,jt);const ii=De(jt)||P,Zn=M.convert(je.format,je.encoding);let Pn=M.convert(je.type),wn=st(je.internalFormat,Zn,Pn,je.encoding,je.isVideoTexture);gn(yn,je,ii);let wi;const ct=je.mipmaps,jn=P&&je.isVideoTexture!==!0,Fn=Ke.__version===void 0,yi=ut(je,jt,ii);if(je.isDepthTexture)wn=b.DEPTH_COMPONENT,P?je.type===Si?wn=b.DEPTH_COMPONENT32F:je.type===Ii?wn=b.DEPTH_COMPONENT24:je.type===ze?wn=b.DEPTH24_STENCIL8:wn=b.DEPTH_COMPONENT16:je.type===Si&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),je.format===In&&wn===b.DEPTH_COMPONENT&&je.type!==Bn&&je.type!==Ii&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),je.type=Bn,Pn=M.convert(je.type)),je.format===we&&wn===b.DEPTH_COMPONENT&&(wn=b.DEPTH_STENCIL,je.type!==ze&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),je.type=ze,Pn=M.convert(je.type))),jn&&Fn?c.texStorage2D(b.TEXTURE_2D,1,wn,jt.width,jt.height):c.texImage2D(b.TEXTURE_2D,0,wn,jt.width,jt.height,0,Zn,Pn,null);else if(je.isDataTexture)if(ct.length>0&&ii){jn&&Fn&&c.texStorage2D(b.TEXTURE_2D,yi,wn,ct[0].width,ct[0].height);for(let Kt=0,oi=ct.length;Kt<oi;Kt++)wi=ct[Kt],jn?c.texSubImage2D(b.TEXTURE_2D,0,0,0,wi.width,wi.height,Zn,Pn,wi.data):c.texImage2D(b.TEXTURE_2D,Kt,wn,wi.width,wi.height,0,Zn,Pn,wi.data);je.generateMipmaps=!1}else jn?(Fn&&c.texStorage2D(b.TEXTURE_2D,yi,wn,jt.width,jt.height),c.texSubImage2D(b.TEXTURE_2D,0,0,0,jt.width,jt.height,Zn,Pn,jt.data)):c.texImage2D(b.TEXTURE_2D,0,wn,jt.width,jt.height,0,Zn,Pn,jt.data);else if(je.isCompressedTexture){jn&&Fn&&c.texStorage2D(b.TEXTURE_2D,yi,wn,ct[0].width,ct[0].height);for(let Kt=0,oi=ct.length;Kt<oi;Kt++)wi=ct[Kt],je.format!==Pt?Zn!==null?jn?c.compressedTexSubImage2D(b.TEXTURE_2D,Kt,0,0,wi.width,wi.height,Zn,wi.data):c.compressedTexImage2D(b.TEXTURE_2D,Kt,wn,wi.width,wi.height,0,wi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):jn?c.texSubImage2D(b.TEXTURE_2D,Kt,0,0,wi.width,wi.height,Zn,Pn,wi.data):c.texImage2D(b.TEXTURE_2D,Kt,wn,wi.width,wi.height,0,Zn,Pn,wi.data)}else if(je.isDataTexture2DArray)jn?(Fn&&c.texStorage3D(b.TEXTURE_2D_ARRAY,yi,wn,jt.width,jt.height,jt.depth),c.texSubImage3D(b.TEXTURE_2D_ARRAY,0,0,0,0,jt.width,jt.height,jt.depth,Zn,Pn,jt.data)):c.texImage3D(b.TEXTURE_2D_ARRAY,0,wn,jt.width,jt.height,jt.depth,0,Zn,Pn,jt.data);else if(je.isDataTexture3D)jn?(Fn&&c.texStorage3D(b.TEXTURE_3D,yi,wn,jt.width,jt.height,jt.depth),c.texSubImage3D(b.TEXTURE_3D,0,0,0,0,jt.width,jt.height,jt.depth,Zn,Pn,jt.data)):c.texImage3D(b.TEXTURE_3D,0,wn,jt.width,jt.height,jt.depth,0,Zn,Pn,jt.data);else if(je.isFramebufferTexture)jn&&Fn?c.texStorage2D(b.TEXTURE_2D,yi,wn,jt.width,jt.height):c.texImage2D(b.TEXTURE_2D,0,wn,jt.width,jt.height,0,Zn,Pn,null);else if(ct.length>0&&ii){jn&&Fn&&c.texStorage2D(b.TEXTURE_2D,yi,wn,ct[0].width,ct[0].height);for(let Kt=0,oi=ct.length;Kt<oi;Kt++)wi=ct[Kt],jn?c.texSubImage2D(b.TEXTURE_2D,Kt,0,0,Zn,Pn,wi):c.texImage2D(b.TEXTURE_2D,Kt,wn,Zn,Pn,wi);je.generateMipmaps=!1}else jn?(Fn&&c.texStorage2D(b.TEXTURE_2D,yi,wn,jt.width,jt.height),c.texSubImage2D(b.TEXTURE_2D,0,0,0,Zn,Pn,jt)):c.texImage2D(b.TEXTURE_2D,0,wn,Zn,Pn,jt);Ie(je,ii)&&Xe(yn),Ke.__version=je.version,je.onUpdate&&je.onUpdate(je)}function ai(Ke,je,Xt){if(je.image.length!==6)return;ni(Ke,je),c.activeTexture(b.TEXTURE0+Xt),c.bindTexture(b.TEXTURE_CUBE_MAP,Ke.__webglTexture),b.pixelStorei(b.UNPACK_FLIP_Y_WEBGL,je.flipY),b.pixelStorei(b.UNPACK_PREMULTIPLY_ALPHA_WEBGL,je.premultiplyAlpha),b.pixelStorei(b.UNPACK_ALIGNMENT,je.unpackAlignment),b.pixelStorei(b.UNPACK_COLORSPACE_CONVERSION_WEBGL,b.NONE);const yn=je&&(je.isCompressedTexture||je.image[0].isCompressedTexture),qn=je.image[0]&&je.image[0].isDataTexture,jt=[];for(let Kt=0;Kt<6;Kt++)!yn&&!qn?jt[Kt]=Q(je.image[Kt],!1,!0,U):jt[Kt]=qn?je.image[Kt].image:je.image[Kt],jt[Kt]=vi(je,jt[Kt]);const ii=jt[0],Zn=De(ii)||P,Pn=M.convert(je.format,je.encoding),wn=M.convert(je.type),wi=st(je.internalFormat,Pn,wn,je.encoding),ct=P&&je.isVideoTexture!==!0,jn=Ke.__version===void 0;let Fn=ut(je,ii,Zn);gn(b.TEXTURE_CUBE_MAP,je,Zn);let yi;if(yn){ct&&jn&&c.texStorage2D(b.TEXTURE_CUBE_MAP,Fn,wi,ii.width,ii.height);for(let Kt=0;Kt<6;Kt++){yi=jt[Kt].mipmaps;for(let oi=0;oi<yi.length;oi++){const Ui=yi[oi];je.format!==Pt?Pn!==null?ct?c.compressedTexSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi,0,0,Ui.width,Ui.height,Pn,Ui.data):c.compressedTexImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi,wi,Ui.width,Ui.height,0,Ui.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ct?c.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi,0,0,Ui.width,Ui.height,Pn,wn,Ui.data):c.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi,wi,Ui.width,Ui.height,0,Pn,wn,Ui.data)}}}else{yi=je.mipmaps,ct&&jn&&(yi.length>0&&Fn++,c.texStorage2D(b.TEXTURE_CUBE_MAP,Fn,wi,jt[0].width,jt[0].height));for(let Kt=0;Kt<6;Kt++)if(qn){ct?c.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,0,0,0,jt[Kt].width,jt[Kt].height,Pn,wn,jt[Kt].data):c.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,0,wi,jt[Kt].width,jt[Kt].height,0,Pn,wn,jt[Kt].data);for(let oi=0;oi<yi.length;oi++){const yr=yi[oi].image[Kt].image;ct?c.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi+1,0,0,yr.width,yr.height,Pn,wn,yr.data):c.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi+1,wi,yr.width,yr.height,0,Pn,wn,yr.data)}}else{ct?c.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,0,0,0,Pn,wn,jt[Kt]):c.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,0,wi,Pn,wn,jt[Kt]);for(let oi=0;oi<yi.length;oi++){const Ui=yi[oi];ct?c.texSubImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi+1,0,0,Pn,wn,Ui.image[Kt]):c.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+Kt,oi+1,wi,Pn,wn,Ui.image[Kt])}}}Ie(je,Zn)&&Xe(b.TEXTURE_CUBE_MAP),Ke.__version=je.version,je.onUpdate&&je.onUpdate(je)}function Nn(Ke,je,Xt,yn,qn){const jt=M.convert(Xt.format,Xt.encoding),ii=M.convert(Xt.type),Zn=st(Xt.internalFormat,jt,ii,Xt.encoding);p.get(je).__hasExternalTextures||(qn===b.TEXTURE_3D||qn===b.TEXTURE_2D_ARRAY?c.texImage3D(qn,0,Zn,je.width,je.height,je.depth,0,jt,ii,null):c.texImage2D(qn,0,Zn,je.width,je.height,0,jt,ii,null)),c.bindFramebuffer(b.FRAMEBUFFER,Ke),je.useRenderToTexture?Y.framebufferTexture2DMultisampleEXT(b.FRAMEBUFFER,yn,qn,p.get(Xt).__webglTexture,0,Gn(je)):b.framebufferTexture2D(b.FRAMEBUFFER,yn,qn,p.get(Xt).__webglTexture,0),c.bindFramebuffer(b.FRAMEBUFFER,null)}function li(Ke,je,Xt){if(b.bindRenderbuffer(b.RENDERBUFFER,Ke),je.depthBuffer&&!je.stencilBuffer){let yn=b.DEPTH_COMPONENT16;if(Xt||je.useRenderToTexture){const qn=je.depthTexture;qn&&qn.isDepthTexture&&(qn.type===Si?yn=b.DEPTH_COMPONENT32F:qn.type===Ii&&(yn=b.DEPTH_COMPONENT24));const jt=Gn(je);je.useRenderToTexture?Y.renderbufferStorageMultisampleEXT(b.RENDERBUFFER,jt,yn,je.width,je.height):b.renderbufferStorageMultisample(b.RENDERBUFFER,jt,yn,je.width,je.height)}else b.renderbufferStorage(b.RENDERBUFFER,yn,je.width,je.height);b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.RENDERBUFFER,Ke)}else if(je.depthBuffer&&je.stencilBuffer){const yn=Gn(je);Xt&&je.useRenderbuffer?b.renderbufferStorageMultisample(b.RENDERBUFFER,yn,b.DEPTH24_STENCIL8,je.width,je.height):je.useRenderToTexture?Y.renderbufferStorageMultisampleEXT(b.RENDERBUFFER,yn,b.DEPTH24_STENCIL8,je.width,je.height):b.renderbufferStorage(b.RENDERBUFFER,b.DEPTH_STENCIL,je.width,je.height),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.RENDERBUFFER,Ke)}else{const yn=je.isWebGLMultipleRenderTargets===!0?je.texture[0]:je.texture,qn=M.convert(yn.format,yn.encoding),jt=M.convert(yn.type),ii=st(yn.internalFormat,qn,jt,yn.encoding),Zn=Gn(je);Xt&&je.useRenderbuffer?b.renderbufferStorageMultisample(b.RENDERBUFFER,Zn,ii,je.width,je.height):je.useRenderToTexture?Y.renderbufferStorageMultisampleEXT(b.RENDERBUFFER,Zn,ii,je.width,je.height):b.renderbufferStorage(b.RENDERBUFFER,ii,je.width,je.height)}b.bindRenderbuffer(b.RENDERBUFFER,null)}function On(Ke,je){if(je&&je.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(b.FRAMEBUFFER,Ke),!(je.depthTexture&&je.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!p.get(je.depthTexture).__webglTexture||je.depthTexture.image.width!==je.width||je.depthTexture.image.height!==je.height)&&(je.depthTexture.image.width=je.width,je.depthTexture.image.height=je.height,je.depthTexture.needsUpdate=!0),Vt(je.depthTexture,0);const yn=p.get(je.depthTexture).__webglTexture,qn=Gn(je);if(je.depthTexture.format===In)je.useRenderToTexture?Y.framebufferTexture2DMultisampleEXT(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.TEXTURE_2D,yn,0,qn):b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_ATTACHMENT,b.TEXTURE_2D,yn,0);else if(je.depthTexture.format===we)je.useRenderToTexture?Y.framebufferTexture2DMultisampleEXT(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,yn,0,qn):b.framebufferTexture2D(b.FRAMEBUFFER,b.DEPTH_STENCIL_ATTACHMENT,b.TEXTURE_2D,yn,0);else throw new Error("Unknown depthTexture format")}function Ai(Ke){const je=p.get(Ke),Xt=Ke.isWebGLCubeRenderTarget===!0;if(Ke.depthTexture&&!je.__autoAllocateDepthBuffer){if(Xt)throw new Error("target.depthTexture not supported in Cube render targets");On(je.__webglFramebuffer,Ke)}else if(Xt){je.__webglDepthbuffer=[];for(let yn=0;yn<6;yn++)c.bindFramebuffer(b.FRAMEBUFFER,je.__webglFramebuffer[yn]),je.__webglDepthbuffer[yn]=b.createRenderbuffer(),li(je.__webglDepthbuffer[yn],Ke,!1)}else c.bindFramebuffer(b.FRAMEBUFFER,je.__webglFramebuffer),je.__webglDepthbuffer=b.createRenderbuffer(),li(je.__webglDepthbuffer,Ke,!1);c.bindFramebuffer(b.FRAMEBUFFER,null)}function ci(Ke,je,Xt){const yn=p.get(Ke);je!==void 0&&Nn(yn.__webglFramebuffer,Ke,Ke.texture,b.COLOR_ATTACHMENT0,b.TEXTURE_2D),Xt!==void 0&&Ai(Ke)}function $t(Ke){const je=Ke.texture,Xt=p.get(Ke),yn=p.get(je);Ke.addEventListener("dispose",Ee),Ke.isWebGLMultipleRenderTargets!==!0&&(yn.__webglTexture===void 0&&(yn.__webglTexture=b.createTexture()),yn.__version=je.version,C.memory.textures++);const qn=Ke.isWebGLCubeRenderTarget===!0,jt=Ke.isWebGLMultipleRenderTargets===!0,ii=je.isDataTexture3D||je.isDataTexture2DArray,Zn=De(Ke)||P;if(qn){Xt.__webglFramebuffer=[];for(let Pn=0;Pn<6;Pn++)Xt.__webglFramebuffer[Pn]=b.createFramebuffer()}else if(Xt.__webglFramebuffer=b.createFramebuffer(),jt)if(y.drawBuffers){const Pn=Ke.texture;for(let wn=0,wi=Pn.length;wn<wi;wn++){const ct=p.get(Pn[wn]);ct.__webglTexture===void 0&&(ct.__webglTexture=b.createTexture(),C.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Ke.useRenderbuffer)if(P){Xt.__webglMultisampledFramebuffer=b.createFramebuffer(),Xt.__webglColorRenderbuffer=b.createRenderbuffer(),b.bindRenderbuffer(b.RENDERBUFFER,Xt.__webglColorRenderbuffer);const Pn=M.convert(je.format,je.encoding),wn=M.convert(je.type),wi=st(je.internalFormat,Pn,wn,je.encoding),ct=Gn(Ke);b.renderbufferStorageMultisample(b.RENDERBUFFER,ct,wi,Ke.width,Ke.height),c.bindFramebuffer(b.FRAMEBUFFER,Xt.__webglMultisampledFramebuffer),b.framebufferRenderbuffer(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.RENDERBUFFER,Xt.__webglColorRenderbuffer),b.bindRenderbuffer(b.RENDERBUFFER,null),Ke.depthBuffer&&(Xt.__webglDepthRenderbuffer=b.createRenderbuffer(),li(Xt.__webglDepthRenderbuffer,Ke,!0)),c.bindFramebuffer(b.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(qn){c.bindTexture(b.TEXTURE_CUBE_MAP,yn.__webglTexture),gn(b.TEXTURE_CUBE_MAP,je,Zn);for(let Pn=0;Pn<6;Pn++)Nn(Xt.__webglFramebuffer[Pn],Ke,je,b.COLOR_ATTACHMENT0,b.TEXTURE_CUBE_MAP_POSITIVE_X+Pn);Ie(je,Zn)&&Xe(b.TEXTURE_CUBE_MAP),c.unbindTexture()}else if(jt){const Pn=Ke.texture;for(let wn=0,wi=Pn.length;wn<wi;wn++){const ct=Pn[wn],jn=p.get(ct);c.bindTexture(b.TEXTURE_2D,jn.__webglTexture),gn(b.TEXTURE_2D,ct,Zn),Nn(Xt.__webglFramebuffer,Ke,ct,b.COLOR_ATTACHMENT0+wn,b.TEXTURE_2D),Ie(ct,Zn)&&Xe(b.TEXTURE_2D)}c.unbindTexture()}else{let Pn=b.TEXTURE_2D;ii&&(P?Pn=je.isDataTexture3D?b.TEXTURE_3D:b.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),c.bindTexture(Pn,yn.__webglTexture),gn(Pn,je,Zn),Nn(Xt.__webglFramebuffer,Ke,je,b.COLOR_ATTACHMENT0,Pn),Ie(je,Zn)&&Xe(Pn),c.unbindTexture()}Ke.depthBuffer&&Ai(Ke)}function vn(Ke){const je=De(Ke)||P,Xt=Ke.isWebGLMultipleRenderTargets===!0?Ke.texture:[Ke.texture];for(let yn=0,qn=Xt.length;yn<qn;yn++){const jt=Xt[yn];if(Ie(jt,je)){const ii=Ke.isWebGLCubeRenderTarget?b.TEXTURE_CUBE_MAP:b.TEXTURE_2D,Zn=p.get(jt).__webglTexture;c.bindTexture(ii,Zn),Xe(ii),c.unbindTexture()}}}function xn(Ke){if(Ke.useRenderbuffer)if(P){const je=Ke.width,Xt=Ke.height;let yn=b.COLOR_BUFFER_BIT;const qn=[b.COLOR_ATTACHMENT0],jt=Ke.stencilBuffer?b.DEPTH_STENCIL_ATTACHMENT:b.DEPTH_ATTACHMENT;Ke.depthBuffer&&qn.push(jt),Ke.ignoreDepthForMultisampleCopy||(Ke.depthBuffer&&(yn|=b.DEPTH_BUFFER_BIT),Ke.stencilBuffer&&(yn|=b.STENCIL_BUFFER_BIT));const ii=p.get(Ke);c.bindFramebuffer(b.READ_FRAMEBUFFER,ii.__webglMultisampledFramebuffer),c.bindFramebuffer(b.DRAW_FRAMEBUFFER,ii.__webglFramebuffer),Ke.ignoreDepthForMultisampleCopy&&(b.invalidateFramebuffer(b.READ_FRAMEBUFFER,[jt]),b.invalidateFramebuffer(b.DRAW_FRAMEBUFFER,[jt])),b.blitFramebuffer(0,0,je,Xt,0,0,je,Xt,yn,b.NEAREST),b.invalidateFramebuffer(b.READ_FRAMEBUFFER,qn),c.bindFramebuffer(b.READ_FRAMEBUFFER,null),c.bindFramebuffer(b.DRAW_FRAMEBUFFER,ii.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function Gn(Ke){return P&&(Ke.useRenderbuffer||Ke.useRenderToTexture)?Math.min(W,Ke.samples):0}function Ln(Ke){const je=C.render.frame;ee.get(Ke)!==je&&(ee.set(Ke,je),Ke.update())}function vi(Ke,je){const Xt=Ke.encoding,yn=Ke.format,qn=Ke.type;return Ke.isCompressedTexture===!0||Ke.isVideoTexture===!0||Ke.format===Xm||Xt!==hn&&(Xt===Sn?P===!1?s.has("EXT_sRGB")===!0&&yn===Pt?(Ke.format=Xm,Ke.minFilter=Ve,Ke.generateMipmaps=!1):je=Pl.sRGBToLinear(je):(yn!==Pt||qn!==An)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",Xt)),je}let pi=!1,Fi=!1;function cr(Ke,je){Ke&&Ke.isWebGLRenderTarget&&(pi===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),pi=!0),Ke=Ke.texture),Vt(Ke,je)}function ir(Ke,je){Ke&&Ke.isWebGLCubeRenderTarget&&(Fi===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Fi=!0),Ke=Ke.texture),Qn(Ke,je)}this.allocateTextureUnit=Lt,this.resetTextureUnits=gt,this.setTexture2D=Vt,this.setTexture2DArray=on,this.setTexture3D=Cn,this.setTextureCube=Qn,this.rebindTextures=ci,this.setupRenderTarget=$t,this.updateRenderTargetMipmap=vn,this.updateMultisampleRenderTarget=xn,this.setupDepthRenderbuffer=Ai,this.setupFrameBufferTexture=Nn,this.safeSetTexture2D=cr,this.safeSetTextureCube=ir}function CS(b,s,c){const p=c.isWebGL2;function y(M,C=null){let P;if(M===An)return b.UNSIGNED_BYTE;if(M===er)return b.UNSIGNED_SHORT_4_4_4_4;if(M===is)return b.UNSIGNED_SHORT_5_5_5_1;if(M===mn)return b.BYTE;if(M===Yn)return b.SHORT;if(M===Bn)return b.UNSIGNED_SHORT;if(M===mi)return b.INT;if(M===Ii)return b.UNSIGNED_INT;if(M===Si)return b.FLOAT;if(M===Gi)return p?b.HALF_FLOAT:(P=s.get("OES_texture_half_float"),P!==null?P.HALF_FLOAT_OES:null);if(M===at)return b.ALPHA;if(M===Pt)return b.RGBA;if(M===ft)return b.LUMINANCE;if(M===Ht)return b.LUMINANCE_ALPHA;if(M===In)return b.DEPTH_COMPONENT;if(M===we)return b.DEPTH_STENCIL;if(M===We)return b.RED;if(M===Xm)return P=s.get("EXT_sRGB"),P!==null?P.SRGB_ALPHA_EXT:null;if(M===et)return b.RED_INTEGER;if(M===mt)return b.RG;if(M===ot)return b.RG_INTEGER;if(M===Tt)return b.RGBA_INTEGER;if(M===zt||M===un||M===tn||M===Bt)if(C===Sn)if(P=s.get("WEBGL_compressed_texture_s3tc_srgb"),P!==null){if(M===zt)return P.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(M===un)return P.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(M===tn)return P.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(M===Bt)return P.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(P=s.get("WEBGL_compressed_texture_s3tc"),P!==null){if(M===zt)return P.COMPRESSED_RGB_S3TC_DXT1_EXT;if(M===un)return P.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(M===tn)return P.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(M===Bt)return P.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(M===fn||M===ln||M===Jn||M===hi)if(P=s.get("WEBGL_compressed_texture_pvrtc"),P!==null){if(M===fn)return P.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(M===ln)return P.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(M===Jn)return P.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(M===hi)return P.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(M===di)return P=s.get("WEBGL_compressed_texture_etc1"),P!==null?P.COMPRESSED_RGB_ETC1_WEBGL:null;if(M===ri||M===_i)if(P=s.get("WEBGL_compressed_texture_etc"),P!==null){if(M===ri)return C===Sn?P.COMPRESSED_SRGB8_ETC2:P.COMPRESSED_RGB8_ETC2;if(M===_i)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:P.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(M===ki||M===Ni||M===Vn||M===gi||M===Xn||M===wr||M===Vi||M===Wi||M===K||M===te||M===fe||M===_e||M===Be||M===Ze)if(P=s.get("WEBGL_compressed_texture_astc"),P!==null){if(M===ki)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:P.COMPRESSED_RGBA_ASTC_4x4_KHR;if(M===Ni)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:P.COMPRESSED_RGBA_ASTC_5x4_KHR;if(M===Vn)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:P.COMPRESSED_RGBA_ASTC_5x5_KHR;if(M===gi)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:P.COMPRESSED_RGBA_ASTC_6x5_KHR;if(M===Xn)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:P.COMPRESSED_RGBA_ASTC_6x6_KHR;if(M===wr)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:P.COMPRESSED_RGBA_ASTC_8x5_KHR;if(M===Vi)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:P.COMPRESSED_RGBA_ASTC_8x6_KHR;if(M===Wi)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:P.COMPRESSED_RGBA_ASTC_8x8_KHR;if(M===K)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:P.COMPRESSED_RGBA_ASTC_10x5_KHR;if(M===te)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:P.COMPRESSED_RGBA_ASTC_10x6_KHR;if(M===fe)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:P.COMPRESSED_RGBA_ASTC_10x8_KHR;if(M===_e)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:P.COMPRESSED_RGBA_ASTC_10x10_KHR;if(M===Be)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:P.COMPRESSED_RGBA_ASTC_12x10_KHR;if(M===Ze)return C===Sn?P.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:P.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(M===lt)if(P=s.get("EXT_texture_compression_bptc"),P!==null){if(M===lt)return C===Sn?P.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:P.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(M===ze)return p?b.UNSIGNED_INT_24_8:(P=s.get("WEBGL_depth_texture"),P!==null?P.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:y}}class Vl extends Oi{constructor(){super(),this.type="Group"}}Vl.prototype.isGroup=!0;class Mg extends Br{constructor(s=[]){super(),this.cameras=s}}Mg.prototype.isArrayCamera=!0;var RS=new Ge,LS=new Ge;function R5(b,s,c){RS.setFromMatrixPosition(s.matrixWorld),LS.setFromMatrixPosition(c.matrixWorld);var p=RS.distanceTo(LS),y=s.projectionMatrix.elements,M=c.projectionMatrix.elements,C=y[14]/(y[10]-1),P=y[14]/(y[10]+1),F=(y[9]+1)/y[5],U=(y[9]-1)/y[5],V=(y[8]-1)/y[0],W=(M[8]+1)/M[0],j=C*V,Y=C*W,ee=p/(-V+W),de=ee*-V;s.matrixWorld.decompose(b.position,b.quaternion,b.scale),b.translateX(de),b.translateZ(ee),b.matrixWorld.compose(b.position,b.quaternion,b.scale),b.matrixWorldInverse.getInverse(b.matrixWorld);var xe=C+ee,re=P+ee,Q=j-de,De=Y+(p-de),Me=F*P/re*xe,Ie=U*P/re*xe;b.projectionMatrix.makePerspective(Q,De,Me,Ie,xe,re)}function PS(b){var s,c,p=this,y=null,M=null,C=null,P=[],F=new zn,U=new zn,V=1,W="local-floor";typeof window<"u"&&"VRFrameData"in window&&(M=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",Me,!1));var j=new zn,Y=new Yr,ee=new Ge,de=new Br;de.viewport=new Qi,de.layers.enable(1);var xe=new Br;xe.viewport=new Qi,xe.layers.enable(2);var re=new Mg([de,xe]);re.layers.enable(1),re.layers.enable(2);var Q=new Qt,De;function Me(){var Ee=p.isPresenting=y!==null&&y.isPresenting===!0;if(Ee){var Ye=y.getEyeParameters("left");s=2*Ye.renderWidth*V,c=Ye.renderHeight*V,De=b.getPixelRatio(),b.getSize(Q),b.setDrawingBufferSize(s,c,1),de.viewport.set(0,0,s/2,c),xe.viewport.set(s/2,0,s/2,c),Rt.start(),p.dispatchEvent({type:"sessionstart"})}else p.enabled&&b.setDrawingBufferSize(Q.width,Q.height,De),Rt.stop(),p.dispatchEvent({type:"sessionend"})}var Ie=[],Xe=[];function st(Ee){for(var Ye=navigator.getGamepads&&navigator.getGamepads(),vt=0,Et=Ye.length;vt<Et;vt++){var gt=Ye[vt];if(gt&&(gt.id==="Daydream Controller"||gt.id==="Gear VR Controller"||gt.id==="Oculus Go Controller"||gt.id==="OpenVR Gamepad"||gt.id.startsWith("Oculus Touch")||gt.id.startsWith("HTC Vive Focus")||gt.id.startsWith("Spatial Controller"))){var Lt=gt.hand;if(Ee===0&&(Lt===""||Lt==="right")||Ee===1&&Lt==="left")return gt}}}function ut(){for(var Ee=0;Ee<P.length;Ee++){var Ye=P[Ee],vt=st(Ee);if(vt!==void 0&&vt.pose!==void 0){if(vt.pose===null)return;var Et=vt.pose;Et.hasPosition===!1&&Ye.position.set(.2,-.6,-.05),Et.position!==null&&Ye.position.fromArray(Et.position),Et.orientation!==null&&Ye.quaternion.fromArray(Et.orientation),Ye.matrix.compose(Ye.position,Ye.quaternion,Ye.scale),Ye.matrix.premultiply(F),Ye.matrix.decompose(Ye.position,Ye.quaternion,Ye.scale),Ye.matrixWorldNeedsUpdate=!0,Ye.visible=!0;var gt=vt.id==="Daydream Controller"?0:1;Ie[Ee]===void 0&&(Ie[Ee]=!1),Ie[Ee]!==vt.buttons[gt].pressed&&(Ie[Ee]=vt.buttons[gt].pressed,Ie[Ee]===!0?Ye.dispatchEvent({type:"selectstart"}):(Ye.dispatchEvent({type:"selectend"}),Ye.dispatchEvent({type:"select"}))),gt=2,Xe[Ee]===void 0&&(Xe[Ee]=!1),vt.buttons[gt]!==void 0&&Xe[Ee]!==vt.buttons[gt].pressed&&(Xe[Ee]=vt.buttons[gt].pressed,Xe[Ee]===!0?Ye.dispatchEvent({type:"squeezestart"}):(Ye.dispatchEvent({type:"squeezeend"}),Ye.dispatchEvent({type:"squeeze"})))}else Ye.visible=!1}}function Dt(Ee,Ye){Ye!==null&&Ye.length===4&&Ee.set(Ye[0]*s,Ye[1]*c,Ye[2]*s,Ye[3]*c)}this.enabled=!1,this.getController=function(Ee){var Ye=P[Ee];return Ye===void 0&&(Ye=new Vl,Ye.matrixAutoUpdate=!1,Ye.visible=!1,P[Ee]=Ye),Ye},this.getDevice=function(){return y},this.setDevice=function(Ee){Ee!==void 0&&(y=Ee),Rt.setContext(Ee)},this.setFramebufferScaleFactor=function(Ee){V=Ee},this.setReferenceSpaceType=function(Ee){W=Ee},this.setPoseTarget=function(Ee){Ee!==void 0&&(C=Ee)},this.getCamera=function(Ee){var Ye=W==="local-floor"?1.6:0;if(y.depthNear=Ee.near,y.depthFar=Ee.far,y.getFrameData(M),W==="local-floor"){var vt=y.stageParameters;vt?F.fromArray(vt.sittingToStandingTransform):F.makeTranslation(0,Ye,0)}var Et=M.pose,gt=C!==null?C:Ee;gt.matrix.copy(F),gt.matrix.decompose(gt.position,gt.quaternion,gt.scale),Et.orientation!==null&&(Y.fromArray(Et.orientation),gt.quaternion.multiply(Y)),Et.position!==null&&(Y.setFromRotationMatrix(F),ee.fromArray(Et.position),ee.applyQuaternion(Y),gt.position.add(ee)),gt.updateMatrixWorld();for(var Lt=gt.children,Vt=0,on=Lt.length;Vt<on;Vt++)Lt[Vt].updateMatrixWorld(!0);de.near=Ee.near,xe.near=Ee.near,de.far=Ee.far,xe.far=Ee.far,de.matrixWorldInverse.fromArray(M.leftViewMatrix),xe.matrixWorldInverse.fromArray(M.rightViewMatrix),U.getInverse(F),W==="local-floor"&&(de.matrixWorldInverse.multiply(U),xe.matrixWorldInverse.multiply(U));var Cn=gt.parent;Cn!==null&&(j.getInverse(Cn.matrixWorld),de.matrixWorldInverse.multiply(j),xe.matrixWorldInverse.multiply(j)),de.matrixWorld.getInverse(de.matrixWorldInverse),xe.matrixWorld.getInverse(xe.matrixWorldInverse),de.projectionMatrix.fromArray(M.leftProjectionMatrix),xe.projectionMatrix.fromArray(M.rightProjectionMatrix),R5(re,de,xe);var Qn=y.getLayers();if(Qn.length){var Dn=Qn[0];Dt(de.viewport,Dn.leftBounds),Dt(xe.viewport,Dn.rightBounds)}return ut(),re},this.getStandingMatrix=function(){return F},this.isPresenting=!1;var Rt=new Bx;this.setAnimationLoop=function(Ee){Rt.setAnimationLoop(Ee),this.isPresenting&&Rt.start()},this.submitFrame=function(){this.isPresenting&&y.submitFrame()},this.dispose=function(){typeof window<"u"&&window.removeEventListener("vrdisplaypresentchange",Me)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")},this.addEventListener=function(){}}Object.assign(PS.prototype,ka.prototype);const L5={type:"move"};class $x{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Vl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Vl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ge,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ge),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Vl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ge,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ge),this._grip}dispatchEvent(s){return this._targetRay!==null&&this._targetRay.dispatchEvent(s),this._grip!==null&&this._grip.dispatchEvent(s),this._hand!==null&&this._hand.dispatchEvent(s),this}disconnect(s){return this.dispatchEvent({type:"disconnected",data:s}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(s,c,p){let y=null,M=null,C=null;const P=this._targetRay,F=this._grip,U=this._hand;if(s&&c.session.visibilityState!=="visible-blurred")if(P!==null&&(y=c.getPose(s.targetRaySpace,p),y!==null&&(P.matrix.fromArray(y.transform.matrix),P.matrix.decompose(P.position,P.rotation,P.scale),y.linearVelocity?(P.hasLinearVelocity=!0,P.linearVelocity.copy(y.linearVelocity)):P.hasLinearVelocity=!1,y.angularVelocity?(P.hasAngularVelocity=!0,P.angularVelocity.copy(y.angularVelocity)):P.hasAngularVelocity=!1,this.dispatchEvent(L5))),U&&s.hand){C=!0;for(const de of s.hand.values()){const xe=c.getJointPose(de,p);if(U.joints[de.jointName]===void 0){const Q=new Vl;Q.matrixAutoUpdate=!1,Q.visible=!1,U.joints[de.jointName]=Q,U.add(Q)}const re=U.joints[de.jointName];xe!==null&&(re.matrix.fromArray(xe.transform.matrix),re.matrix.decompose(re.position,re.rotation,re.scale),re.jointRadius=xe.radius),re.visible=xe!==null}const V=U.joints["index-finger-tip"],W=U.joints["thumb-tip"],j=V.position.distanceTo(W.position),Y=.02,ee=.005;U.inputState.pinching&&j>Y+ee?(U.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:s.handedness,target:this})):!U.inputState.pinching&&j<=Y-ee&&(U.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:s.handedness,target:this}))}else F!==null&&s.gripSpace&&(M=c.getPose(s.gripSpace,p),M!==null&&(F.matrix.fromArray(M.transform.matrix),F.matrix.decompose(F.position,F.rotation,F.scale),M.linearVelocity?(F.hasLinearVelocity=!0,F.linearVelocity.copy(M.linearVelocity)):F.hasLinearVelocity=!1,M.angularVelocity?(F.hasAngularVelocity=!0,F.angularVelocity.copy(M.angularVelocity)):F.hasAngularVelocity=!1));return P!==null&&(P.visible=y!==null),F!==null&&(F.visible=M!==null),U!==null&&(U.visible=C!==null),this}}class Sg extends Nr{constructor(s,c,p,y,M,C,P,F,U,V){if(V=V!==void 0?V:In,V!==In&&V!==we)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");p===void 0&&V===In&&(p=Bn),p===void 0&&V===we&&(p=ze),super(null,y,M,C,P,F,V,p,U),this.image={width:s,height:c},this.magFilter=P!==void 0?P:It,this.minFilter=F!==void 0?F:It,this.flipY=!1,this.generateMipmaps=!1}}Sg.prototype.isDepthTexture=!0;class P5 extends ka{constructor(s,c){super();const p=this;let y=null,M=1;var C=null;let P=null,F="local-floor";const U=s.extensions.has("WEBGL_multisampled_render_to_texture");let V=null;var W=[];let j=null,Y=null,ee=null,de=!1,xe=null;const re=c.getContextAttributes();let Q=null,De=null;const Me=[],Ie=new Map,Xe=new Br;Xe.layers.enable(1),Xe.viewport=new Qi;const st=new Br;st.layers.enable(2),st.viewport=new Qi;const ut=[Xe,st],Dt=new Mg;Dt.layers.enable(1),Dt.layers.enable(2);let Rt=null,Ee=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.getCameraPose=function(){return V},this.getController=function(Yt){let gn=Me[Yt];return gn===void 0&&(gn=new $x,Me[Yt]=gn),gn.getTargetRaySpace()},this.getControllerGrip=function(Yt){let gn=Me[Yt];return gn===void 0&&(gn=new $x,Me[Yt]=gn),gn.getGripSpace()},this.getHand=function(Yt){let gn=Me[Yt];return gn===void 0&&(gn=new $x,Me[Yt]=gn),gn.getHandSpace()};function Ye(Yt){const gn=Ie.get(Yt.inputSource);gn&&gn.dispatchEvent({type:Yt.type,data:Yt.inputSource})}function vt(){Ie.forEach(function(Yt,gn){Yt.disconnect(gn)}),Ie.clear(),Rt=null,Ee=null,s.setRenderTarget(Q),ee=null,Y=null,j=null,y=null,De=null,Dn.stop(),p.isPresenting=!1,p.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Yt){M=Yt,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Yt){F=Yt,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return P},this.getBaseLayer=function(){return Y!==null?Y:ee},this.getBinding=function(){return j},this.getFrame=function(){return xe},this.getSession=function(){return y},this.setSession=async function(Yt){if(y=Yt,y!==null){if(Q=s.getRenderTarget(),y.addEventListener("select",Ye),y.addEventListener("selectstart",Ye),y.addEventListener("selectend",Ye),y.addEventListener("squeeze",Ye),y.addEventListener("squeezestart",Ye),y.addEventListener("squeezeend",Ye),y.addEventListener("end",vt),y.addEventListener("inputsourceschange",Et),re.xrCompatible!==!0&&await c.makeXRCompatible(),y.renderState.layers===void 0||s.capabilities.isWebGL2===!1){const gn={antialias:y.renderState.layers===void 0?re.antialias:!0,alpha:re.alpha,depth:re.depth,stencil:re.stencil,framebufferScaleFactor:M};ee=new XRWebGLLayer(y,c,gn),y.updateRenderState({baseLayer:ee}),De=new js(ee.framebufferWidth,ee.framebufferHeight,{format:Pt,type:An,encoding:s.outputEncoding})}else{de=re.antialias;let gn=null,ni=null,ht=null;re.depth&&(ht=re.stencil?c.DEPTH24_STENCIL8:c.DEPTH_COMPONENT24,gn=re.stencil?we:In,ni=re.stencil?ze:Bn);const ai={colorFormat:s.outputEncoding===Sn?c.SRGB8_ALPHA8:c.RGBA8,depthFormat:ht,scaleFactor:M};j=new XRWebGLBinding(y,c),Y=j.createProjectionLayer(ai),y.updateRenderState({layers:[Y]}),de?De=new Km(Y.textureWidth,Y.textureHeight,{format:Pt,type:An,depthTexture:new Sg(Y.textureWidth,Y.textureHeight,ni,void 0,void 0,void 0,void 0,void 0,void 0,gn),stencilBuffer:re.stencil,ignoreDepth:Y.ignoreDepthValues,useRenderToTexture:U,encoding:s.outputEncoding}):De=new js(Y.textureWidth,Y.textureHeight,{format:Pt,type:An,depthTexture:new Sg(Y.textureWidth,Y.textureHeight,ni,void 0,void 0,void 0,void 0,void 0,void 0,gn),stencilBuffer:re.stencil,ignoreDepth:Y.ignoreDepthValues,encoding:s.outputEncoding})}De.isXRRenderTarget=!0,this.setFoveation(1),P=await y.requestReferenceSpace(F),Dn.setContext(y),Dn.start(),p.isPresenting=!0,p.dispatchEvent({type:"sessionstart"})}},this.addLayer=function(Yt){!window.XRWebGLBinding||!this.layersEnabled||!y||(W.push(Yt),this.updateLayers())},this.removeLayer=function(Yt){!window.XRWebGLBinding||!this.layersEnabled||!y||(W.splice(W.indexOf(Yt),1),this.updateLayers())},this.updateLayers=function(){var Yt=W.map(function(gn){return gn});Yt.unshift(y.renderState.layers[0]),y.updateRenderState({layers:Yt})};function Et(Yt){const gn=y.inputSources;for(let ni=0;ni<Me.length;ni++)Ie.set(gn[ni],Me[ni]);for(let ni=0;ni<Yt.removed.length;ni++){const ht=Yt.removed[ni],ai=Ie.get(ht);ai&&(ai.dispatchEvent({type:"disconnected",data:ht}),Ie.delete(ht))}for(let ni=0;ni<Yt.added.length;ni++){const ht=Yt.added[ni],ai=Ie.get(ht);ai&&ai.dispatchEvent({type:"connected",data:ht})}}const gt=new Ge,Lt=new Ge;function Vt(Yt,gn,ni){gt.setFromMatrixPosition(gn.matrixWorld),Lt.setFromMatrixPosition(ni.matrixWorld);const ht=gt.distanceTo(Lt),ai=gn.projectionMatrix.elements,Nn=ni.projectionMatrix.elements,li=ai[14]/(ai[10]-1),On=ai[14]/(ai[10]+1),Ai=(ai[9]+1)/ai[5],ci=(ai[9]-1)/ai[5],$t=(ai[8]-1)/ai[0],vn=(Nn[8]+1)/Nn[0],xn=li*$t,Gn=li*vn,Ln=ht/(-$t+vn),vi=Ln*-$t;gn.matrixWorld.decompose(Yt.position,Yt.quaternion,Yt.scale),Yt.translateX(vi),Yt.translateZ(Ln),Yt.matrixWorld.compose(Yt.position,Yt.quaternion,Yt.scale),Yt.matrixWorldInverse.copy(Yt.matrixWorld).invert();const pi=li+Ln,Fi=On+Ln,cr=xn-vi,ir=Gn+(ht-vi),Ke=Ai*On/Fi*pi,je=ci*On/Fi*pi;Yt.projectionMatrix.makePerspective(cr,ir,Ke,je,pi,Fi)}function on(Yt,gn){gn===null?Yt.matrixWorld.copy(Yt.matrix):Yt.matrixWorld.multiplyMatrices(gn.matrixWorld,Yt.matrix),Yt.matrixWorldInverse.copy(Yt.matrixWorld).invert()}this.setPoseTarget=function(Yt){Yt!==void 0&&(C=Yt)},this.updateCamera=function(Yt){if(y===null)return;Dt.near=st.near=Xe.near=Yt.near,Dt.far=st.far=Xe.far=Yt.far,(Rt!==Dt.near||Ee!==Dt.far)&&(y.updateRenderState({depthNear:Dt.near,depthFar:Dt.far}),Rt=Dt.near,Ee=Dt.far);const gn=Dt.cameras;var ni=C||Yt;const ht=ni.parent;on(Dt,ht);for(let Nn=0;Nn<gn.length;Nn++)on(gn[Nn],ht);Dt.matrixWorld.decompose(Dt.position,Dt.quaternion,Dt.scale),ni.matrixWorld.copy(Dt.matrixWorld),ni.matrix.copy(Dt.matrix),ni.matrix.decompose(ni.position,ni.quaternion,ni.scale);const ai=ni.children;for(let Nn=0,li=ai.length;Nn<li;Nn++)ai[Nn].updateMatrixWorld(!0);gn.length===2?Vt(Dt,Xe,st):Dt.projectionMatrix.copy(Xe.projectionMatrix)},this.getCamera=function(){return Dt},this.getFoveation=function(){if(Y!==null)return Y.fixedFoveation;if(ee!==null)return ee.fixedFoveation},this.setFoveation=function(Yt){Y!==null&&(Y.fixedFoveation=Yt),ee!==null&&ee.fixedFoveation!==void 0&&(ee.fixedFoveation=Yt)};let Cn=null;function Qn(Yt,gn){if(V=gn.getViewerPose(P),xe=gn,V!==null){const ht=V.views;ee!==null&&(s.setRenderTargetFramebuffer(De,ee.framebuffer),s.setRenderTarget(De));let ai=!1;ht.length!==Dt.cameras.length&&(Dt.cameras.length=0,ai=!0);for(let Nn=0;Nn<ht.length;Nn++){const li=ht[Nn];let On=null;if(ee!==null)On=ee.getViewport(li);else{const ci=j.getViewSubImage(Y,li);On=ci.viewport,Nn===0&&(s.setRenderTargetTextures(De,ci.colorTexture,Y.ignoreDepthValues?void 0:ci.depthStencilTexture),s.setRenderTarget(De))}const Ai=ut[Nn];Ai.matrix.fromArray(li.transform.matrix),Ai.projectionMatrix.fromArray(li.projectionMatrix),Ai.viewport.set(On.x,On.y,On.width,On.height),Nn===0&&Dt.matrix.copy(Ai.matrix),ai===!0&&Dt.cameras.push(Ai)}}const ni=y.inputSources;for(let ht=0;ht<Me.length;ht++){const ai=Me[ht],Nn=ni[ht];ai.update(Nn,gn,P)}Cn&&Cn(Yt,gn),xe=null}const Dn=new Bx;Dn.setAnimationLoop(Qn),this.setAnimationLoop=function(Yt){Cn=Yt},this.dispose=function(){}}}function D5(b){function s(re,Q){re.fogColor.value.copy(Q.color),Q.isFog?(re.fogNear.value=Q.near,re.fogFar.value=Q.far):Q.isFogExp2&&(re.fogDensity.value=Q.density)}function c(re,Q,De,Me,Ie){Q.isMeshBasicMaterial?p(re,Q):Q.isMeshLambertMaterial?(p(re,Q),F(re,Q)):Q.isMeshToonMaterial?(p(re,Q),V(re,Q)):Q.isMeshPhongMaterial?(p(re,Q),U(re,Q)):Q.isMeshStandardMaterial?(p(re,Q),Q.isMeshPhysicalMaterial?j(re,Q,Ie):W(re,Q)):Q.isMeshMatcapMaterial?(p(re,Q),Y(re,Q)):Q.isMeshDepthMaterial?(p(re,Q),ee(re,Q)):Q.isMeshDistanceMaterial?(p(re,Q),de(re,Q)):Q.isMeshNormalMaterial?(p(re,Q),xe(re,Q)):Q.isLineBasicMaterial?(y(re,Q),Q.isLineDashedMaterial&&M(re,Q)):Q.isPointsMaterial?C(re,Q,De,Me):Q.isSpriteMaterial?P(re,Q):Q.isShadowMaterial?(re.color.value.copy(Q.color),re.opacity.value=Q.opacity):Q.isShaderMaterial&&(Q.uniformsNeedUpdate=!1)}function p(re,Q){re.opacity.value=Q.opacity,Q.color&&re.diffuse.value.copy(Q.color),Q.emissive&&re.emissive.value.copy(Q.emissive).multiplyScalar(Q.emissiveIntensity),Q.map&&(re.map.value=Q.map),Q.alphaMap&&(re.alphaMap.value=Q.alphaMap),Q.specularMap&&(re.specularMap.value=Q.specularMap),Q.alphaTest>0&&(re.alphaTest.value=Q.alphaTest);const De=b.get(Q).envMap;De&&(re.envMap.value=De,re.flipEnvMap.value=De.isCubeTexture&&De.isRenderTargetTexture===!1?-1:1,re.reflectivity.value=Q.reflectivity,re.ior.value=Q.ior,re.refractionRatio.value=Q.refractionRatio),Q.lightMap&&(re.lightMap.value=Q.lightMap,re.lightMapIntensity.value=Q.lightMapIntensity),Q.aoMap&&(re.aoMap.value=Q.aoMap,re.aoMapIntensity.value=Q.aoMapIntensity);let Me;Q.map?Me=Q.map:Q.specularMap?Me=Q.specularMap:Q.displacementMap?Me=Q.displacementMap:Q.normalMap?Me=Q.normalMap:Q.bumpMap?Me=Q.bumpMap:Q.roughnessMap?Me=Q.roughnessMap:Q.metalnessMap?Me=Q.metalnessMap:Q.alphaMap?Me=Q.alphaMap:Q.emissiveMap?Me=Q.emissiveMap:Q.clearcoatMap?Me=Q.clearcoatMap:Q.clearcoatNormalMap?Me=Q.clearcoatNormalMap:Q.clearcoatRoughnessMap?Me=Q.clearcoatRoughnessMap:Q.specularIntensityMap?Me=Q.specularIntensityMap:Q.specularColorMap?Me=Q.specularColorMap:Q.transmissionMap?Me=Q.transmissionMap:Q.thicknessMap?Me=Q.thicknessMap:Q.sheenColorMap?Me=Q.sheenColorMap:Q.sheenRoughnessMap&&(Me=Q.sheenRoughnessMap),Me!==void 0&&(Me.isWebGLRenderTarget&&(Me=Me.texture),Me.matrixAutoUpdate===!0&&Me.updateMatrix(),re.uvTransform.value.copy(Me.matrix));let Ie;Q.aoMap?Ie=Q.aoMap:Q.lightMap&&(Ie=Q.lightMap),Ie!==void 0&&(Ie.isWebGLRenderTarget&&(Ie=Ie.texture),Ie.matrixAutoUpdate===!0&&Ie.updateMatrix(),re.uv2Transform.value.copy(Ie.matrix))}function y(re,Q){re.diffuse.value.copy(Q.color),re.opacity.value=Q.opacity}function M(re,Q){re.dashSize.value=Q.dashSize,re.totalSize.value=Q.dashSize+Q.gapSize,re.scale.value=Q.scale}function C(re,Q,De,Me){re.diffuse.value.copy(Q.color),re.opacity.value=Q.opacity,re.size.value=Q.size*De,re.scale.value=Me*.5,Q.map&&(re.map.value=Q.map),Q.alphaMap&&(re.alphaMap.value=Q.alphaMap),Q.alphaTest>0&&(re.alphaTest.value=Q.alphaTest);let Ie;Q.map?Ie=Q.map:Q.alphaMap&&(Ie=Q.alphaMap),Ie!==void 0&&(Ie.matrixAutoUpdate===!0&&Ie.updateMatrix(),re.uvTransform.value.copy(Ie.matrix))}function P(re,Q){re.diffuse.value.copy(Q.color),re.opacity.value=Q.opacity,re.rotation.value=Q.rotation,Q.map&&(re.map.value=Q.map),Q.alphaMap&&(re.alphaMap.value=Q.alphaMap),Q.alphaTest>0&&(re.alphaTest.value=Q.alphaTest);let De;Q.map?De=Q.map:Q.alphaMap&&(De=Q.alphaMap),De!==void 0&&(De.matrixAutoUpdate===!0&&De.updateMatrix(),re.uvTransform.value.copy(De.matrix))}function F(re,Q){Q.emissiveMap&&(re.emissiveMap.value=Q.emissiveMap)}function U(re,Q){re.specular.value.copy(Q.specular),re.shininess.value=Math.max(Q.shininess,1e-4),Q.emissiveMap&&(re.emissiveMap.value=Q.emissiveMap),Q.bumpMap&&(re.bumpMap.value=Q.bumpMap,re.bumpScale.value=Q.bumpScale,Q.side===S&&(re.bumpScale.value*=-1)),Q.normalMap&&(re.normalMap.value=Q.normalMap,re.normalScale.value.copy(Q.normalScale),Q.side===S&&re.normalScale.value.negate()),Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias)}function V(re,Q){Q.gradientMap&&(re.gradientMap.value=Q.gradientMap),Q.emissiveMap&&(re.emissiveMap.value=Q.emissiveMap),Q.bumpMap&&(re.bumpMap.value=Q.bumpMap,re.bumpScale.value=Q.bumpScale,Q.side===S&&(re.bumpScale.value*=-1)),Q.normalMap&&(re.normalMap.value=Q.normalMap,re.normalScale.value.copy(Q.normalScale),Q.side===S&&re.normalScale.value.negate()),Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias)}function W(re,Q){re.roughness.value=Q.roughness,re.metalness.value=Q.metalness,Q.roughnessMap&&(re.roughnessMap.value=Q.roughnessMap),Q.metalnessMap&&(re.metalnessMap.value=Q.metalnessMap),Q.emissiveMap&&(re.emissiveMap.value=Q.emissiveMap),Q.bumpMap&&(re.bumpMap.value=Q.bumpMap,re.bumpScale.value=Q.bumpScale,Q.side===S&&(re.bumpScale.value*=-1)),Q.normalMap&&(re.normalMap.value=Q.normalMap,re.normalScale.value.copy(Q.normalScale),Q.side===S&&re.normalScale.value.negate()),Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias),b.get(Q).envMap&&(re.envMapIntensity.value=Q.envMapIntensity)}function j(re,Q,De){W(re,Q),re.ior.value=Q.ior,Q.sheen>0&&(re.sheenColor.value.copy(Q.sheenColor).multiplyScalar(Q.sheen),re.sheenRoughness.value=Q.sheenRoughness,Q.sheenColorMap&&(re.sheenColorMap.value=Q.sheenColorMap),Q.sheenRoughnessMap&&(re.sheenRoughnessMap.value=Q.sheenRoughnessMap)),Q.clearcoat>0&&(re.clearcoat.value=Q.clearcoat,re.clearcoatRoughness.value=Q.clearcoatRoughness,Q.clearcoatMap&&(re.clearcoatMap.value=Q.clearcoatMap),Q.clearcoatRoughnessMap&&(re.clearcoatRoughnessMap.value=Q.clearcoatRoughnessMap),Q.clearcoatNormalMap&&(re.clearcoatNormalScale.value.copy(Q.clearcoatNormalScale),re.clearcoatNormalMap.value=Q.clearcoatNormalMap,Q.side===S&&re.clearcoatNormalScale.value.negate())),Q.transmission>0&&(re.transmission.value=Q.transmission,re.transmissionSamplerMap.value=De.texture,re.transmissionSamplerSize.value.set(De.width,De.height),Q.transmissionMap&&(re.transmissionMap.value=Q.transmissionMap),re.thickness.value=Q.thickness,Q.thicknessMap&&(re.thicknessMap.value=Q.thicknessMap),re.attenuationDistance.value=Q.attenuationDistance,re.attenuationColor.value.copy(Q.attenuationColor)),re.specularIntensity.value=Q.specularIntensity,re.specularColor.value.copy(Q.specularColor),Q.specularIntensityMap&&(re.specularIntensityMap.value=Q.specularIntensityMap),Q.specularColorMap&&(re.specularColorMap.value=Q.specularColorMap)}function Y(re,Q){Q.matcap&&(re.matcap.value=Q.matcap),Q.bumpMap&&(re.bumpMap.value=Q.bumpMap,re.bumpScale.value=Q.bumpScale,Q.side===S&&(re.bumpScale.value*=-1)),Q.normalMap&&(re.normalMap.value=Q.normalMap,re.normalScale.value.copy(Q.normalScale),Q.side===S&&re.normalScale.value.negate()),Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias)}function ee(re,Q){Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias)}function de(re,Q){Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias),re.referencePosition.value.copy(Q.referencePosition),re.nearDistance.value=Q.nearDistance,re.farDistance.value=Q.farDistance}function xe(re,Q){Q.bumpMap&&(re.bumpMap.value=Q.bumpMap,re.bumpScale.value=Q.bumpScale,Q.side===S&&(re.bumpScale.value*=-1)),Q.normalMap&&(re.normalMap.value=Q.normalMap,re.normalScale.value.copy(Q.normalScale),Q.side===S&&re.normalScale.value.negate()),Q.displacementMap&&(re.displacementMap.value=Q.displacementMap,re.displacementScale.value=Q.displacementScale,re.displacementBias.value=Q.displacementBias)}return{refreshFogUniforms:s,refreshMaterialUniforms:c}}function O5(){const b=xf("canvas");return b.style.display="block",b}function sr(b={}){const s=b.canvas!==void 0?b.canvas:O5(),c=b.context!==void 0?b.context:null,p=b.alpha!==void 0?b.alpha:!1,y=b.depth!==void 0?b.depth:!0,M=b.stencil!==void 0?b.stencil:!0,C=b.antialias!==void 0?b.antialias:!1,P=b.premultipliedAlpha!==void 0?b.premultipliedAlpha:!0,F=b.preserveDrawingBuffer!==void 0?b.preserveDrawingBuffer:!1,U=b.powerPreference!==void 0?b.powerPreference:"default",V=b.failIfMajorPerformanceCaveat!==void 0?b.failIfMajorPerformanceCaveat:!1;let W=null,j=null;const Y=[],ee=[];this.domElement=s,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=hn,this.physicallyCorrectLights=!1,this.toneMapping=ge,this.toneMappingExposure=1;const de=this;let xe=!1,re=0,Q=0,De=null,Me=-1,Ie=null;const Xe=new Qi,st=new Qi;let ut=null,Dt=s.width,Rt=s.height,Ee=1,Ye=null,vt=null;const Et=new Qi(0,0,Dt,Rt),gt=new Qi(0,0,Dt,Rt);let Lt=!1;const Vt=new wf;let on=!1,Cn=!1,Qn=null;const Dn=new zn,Yt=new Ge,gn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ni(){return De===null?Ee:1}let ht=c;function ai($e,Ct){for(let Nt=0;Nt<$e.length;Nt++){const kt=$e[Nt],Zt=s.getContext(kt,Ct);if(Zt!==null)return Zt}return null}try{const $e={alpha:!0,depth:y,stencil:M,antialias:C,premultipliedAlpha:P,preserveDrawingBuffer:F,powerPreference:U,failIfMajorPerformanceCaveat:V};if("setAttribute"in s&&s.setAttribute("data-engine",`three.js r${u}`),s.addEventListener("webglcontextlost",wi,!1),s.addEventListener("webglcontextrestored",ct,!1),ht===null){const Ct=["webgl2","webgl","experimental-webgl"];if(de.isWebGL1Renderer===!0&&Ct.shift(),ht=ai(Ct,$e),ht===null)throw ai(Ct)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}ht.getShaderPrecisionFormat===void 0&&(ht.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch($e){throw console.error("THREE.WebGLRenderer: "+$e.message),$e}let Nn,li,On,Ai,ci,$t,vn,xn,Gn,Ln,vi,pi,Fi,cr,ir,Ke,je,Xt,yn,qn,jt,ii,Zn;function Pn(){Nn=new Z4(ht),li=new $4(ht,Nn,b),Nn.init(li),ii=new CS(ht,Nn,li),On=new T5(ht,Nn,li),Ai=new tB(ht),ci=new g5,$t=new C5(ht,Nn,On,ci,li,ii,Ai),vn=new q4(de),xn=new Q4(de),Gn=new qN(ht,li),Zn=new W4(ht,Nn,Gn,li),Ln=new J4(ht,Gn,Ai,Zn),vi=new sB(ht,Ln,Gn,Ai),yn=new rB(ht,li,$t),Ke=new X4(ci),pi=new m5(de,vn,xn,Nn,li,Zn,Ke),Fi=new D5(ci),cr=new y5,ir=new w5(Nn,li),Xt=new V4(de,vn,On,vi,p,P),je=new TS(de,vi,li),qn=new j4(ht,Nn,Ai,li),jt=new eB(ht,Nn,Ai,li),Ai.programs=pi.programs,de.capabilities=li,de.extensions=Nn,de.properties=ci,de.renderLists=cr,de.shadowMap=je,de.state=On,de.info=Ai}Pn();const wn=typeof navigator<"u"&&"xr"in navigator?new P5(de,ht):new PS(de);this.xr=wn,this.getContext=function(){return ht},this.getContextAttributes=function(){return ht.getContextAttributes()},this.forceContextLoss=function(){const $e=Nn.get("WEBGL_lose_context");$e&&$e.loseContext()},this.forceContextRestore=function(){const $e=Nn.get("WEBGL_lose_context");$e&&$e.restoreContext()},this.getPixelRatio=function(){return Ee},this.setPixelRatio=function($e){$e!==void 0&&(Ee=$e,this.setSize(Dt,Rt,!1))},this.getSize=function($e){return $e.set(Dt,Rt)},this.setSize=function($e,Ct,Nt){if(wn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Dt=$e,Rt=Ct,s.width=Math.floor($e*Ee),s.height=Math.floor(Ct*Ee),Nt!==!1&&(s.style.width=$e+"px",s.style.height=Ct+"px"),this.setViewport(0,0,$e,Ct)},this.getDrawingBufferSize=function($e){return $e.set(Dt*Ee,Rt*Ee).floor()},this.setDrawingBufferSize=function($e,Ct,Nt){Dt=$e,Rt=Ct,Ee=Nt,s.width=Math.floor($e*Nt),s.height=Math.floor(Ct*Nt),this.setViewport(0,0,$e,Ct)},this.getCurrentViewport=function($e){return $e.copy(Xe)},this.getViewport=function($e){return $e.copy(Et)},this.setViewport=function($e,Ct,Nt,kt){$e.isVector4?Et.set($e.x,$e.y,$e.z,$e.w):Et.set($e,Ct,Nt,kt),On.viewport(Xe.copy(Et).multiplyScalar(Ee).floor())},this.getScissor=function($e){return $e.copy(gt)},this.setScissor=function($e,Ct,Nt,kt){$e.isVector4?gt.set($e.x,$e.y,$e.z,$e.w):gt.set($e,Ct,Nt,kt),On.scissor(st.copy(gt).multiplyScalar(Ee).floor())},this.getScissorTest=function(){return Lt},this.setScissorTest=function($e){On.setScissorTest(Lt=$e)},this.setOpaqueSort=function($e){Ye=$e},this.setTransparentSort=function($e){vt=$e},this.getClearColor=function($e){return $e.copy(Xt.getClearColor())},this.setClearColor=function(){Xt.setClearColor.apply(Xt,arguments)},this.getClearAlpha=function(){return Xt.getClearAlpha()},this.setClearAlpha=function(){Xt.setClearAlpha.apply(Xt,arguments)},this.clear=function($e,Ct,Nt){let kt=0;($e===void 0||$e)&&(kt|=ht.COLOR_BUFFER_BIT),(Ct===void 0||Ct)&&(kt|=ht.DEPTH_BUFFER_BIT),(Nt===void 0||Nt)&&(kt|=ht.STENCIL_BUFFER_BIT),ht.clear(kt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){s.removeEventListener("webglcontextlost",wi,!1),s.removeEventListener("webglcontextrestored",ct,!1),cr.dispose(),ir.dispose(),ci.dispose(),vn.dispose(),xn.dispose(),vi.dispose(),Zn.dispose(),pi.dispose(),wn.dispose(),wn.removeEventListener("sessionstart",Ui),wn.removeEventListener("sessionend",yr),Qn&&(Qn.dispose(),Qn=null),Ks.stop()};function wi($e){$e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),xe=!0}function ct(){console.log("THREE.WebGLRenderer: Context Restored."),xe=!1;const $e=Ai.autoReset,Ct=je.enabled,Nt=je.autoUpdate,kt=je.needsUpdate,Zt=je.type;Pn(),Ai.autoReset=$e,je.enabled=Ct,je.autoUpdate=Nt,je.needsUpdate=kt,je.type=Zt}function jn($e){const Ct=$e.target;Ct.removeEventListener("dispose",jn),Fn(Ct)}function Fn($e){yi($e),ci.remove($e)}function yi($e){const Ct=ci.get($e).programs;Ct!==void 0&&(Ct.forEach(function(Nt){pi.releaseProgram(Nt)}),$e.isShaderMaterial&&pi.releaseShaderCache($e))}this.renderBufferDirect=function($e,Ct,Nt,kt,Zt,bi){Ct===null&&(Ct=gn);const Mi=Zt.isMesh&&Zt.matrixWorld.determinant()<0,Di=I6($e,Ct,Nt,kt,Zt);On.setMaterial(kt,Mi);let Ri=Nt.index;const tr=Nt.attributes.position;if(Ri===null){if(tr===void 0||tr.count===0)return}else if(Ri.count===0)return;let $i=1;kt.wireframe===!0&&(Ri=Ln.getWireframeAttribute(Nt),$i=2),Zn.setup(Zt,kt,Di,Nt,Ri);let Yi,Cr=qn;Ri!==null&&(Yi=Gn.get(Ri),Cr=jt,Cr.setIndex(Yi));const lu=Ri!==null?Ri.count:tr.count,Uh=Nt.drawRange.start*$i,Zi=Nt.drawRange.count*$i,ga=bi!==null?bi.start*$i:0,Gr=bi!==null?bi.count*$i:1/0,va=Math.max(Uh,ga),cv=Math.min(lu,Uh+Zi,ga+Gr)-1,ya=Math.max(0,cv-va+1);if(ya!==0){if(Zt.isMesh)kt.wireframe===!0?(On.setLineWidth(kt.wireframeLinewidth*ni()),Cr.setMode(ht.LINES)):Cr.setMode(ht.TRIANGLES);else if(Zt.isLine){let qa=kt.linewidth;qa===void 0&&(qa=1),On.setLineWidth(qa*ni()),Zt.isLineSegments?Cr.setMode(ht.LINES):Zt.isLineLoop?Cr.setMode(ht.LINE_LOOP):Cr.setMode(ht.LINE_STRIP)}else Zt.isPoints?Cr.setMode(ht.POINTS):Zt.isSprite&&Cr.setMode(ht.TRIANGLES);if(Zt.isInstancedMesh)Cr.renderInstances(va,ya,Zt.count);else if(Nt.isInstancedBufferGeometry){const qa=Math.min(Nt.instanceCount,Nt._maxInstanceCount);Cr.renderInstances(va,ya,qa)}else Cr.render(va,ya)}},this.compile=function($e,Ct){j=ir.get($e),j.init(),ee.push(j),$e.traverseVisible(function(Nt){Nt.isLight&&Nt.layers.test(Ct.layers)&&(j.pushLight(Nt),Nt.castShadow&&j.pushShadow(Nt))}),j.setupLights(de.physicallyCorrectLights),$e.traverse(function(Nt){const kt=Nt.material;if(kt)if(Array.isArray(kt))for(let Zt=0;Zt<kt.length;Zt++){const bi=kt[Zt];z_(bi,$e,Nt)}else z_(kt,$e,Nt)}),ee.pop(),j=null};let Kt=null;function oi($e){Kt&&Kt($e)}function Ui(){Ks.stop()}function yr(){Ks.start()}const Ks=new Bx;Ks.setAnimationLoop(oi),typeof window<"u"&&Ks.setContext(window),this.setAnimationLoop=function($e){Kt=$e,wn.setAnimationLoop($e),$e===null?Ks.stop():Ks.start()},wn.addEventListener("sessionstart",Ui),wn.addEventListener("sessionend",yr),this.render=function($e,Ct){if(Ct!==void 0&&Ct.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(xe===!0)return;$e.autoUpdate===!0&&$e.updateMatrixWorld(),Ct.parent===null&&Ct.updateMatrixWorld(),wn.enabled===!0&&wn.isPresenting===!0&&(wn.cameraAutoUpdate===!0&&wn.updateCamera(Ct),Ct=wn.getCamera()),$e.isScene===!0&&$e.onBeforeRender(de,$e,Ct,De),j=ir.get($e,ee.length),j.init(),ee.push(j),Dn.multiplyMatrices(Ct.projectionMatrix,Ct.matrixWorldInverse),Vt.setFromProjectionMatrix(Dn),Cn=this.localClippingEnabled,on=Ke.init(this.clippingPlanes,Cn,Ct),W=cr.get($e,Y.length),W.init(),Y.push(W),Tr($e,Ct,0,de.sortObjects),W.finish(),de.sortObjects===!0&&W.sort(Ye,vt),on===!0&&Ke.beginShadows();const Nt=j.state.shadowsArray;if(je.render(Nt,$e,Ct),on===!0&&Ke.endShadows(),this.info.autoReset===!0&&this.info.reset(),Xt.render(W,$e),j.setupLights(de.physicallyCorrectLights),Ct.isArrayCamera){const kt=Ct.cameras;for(let Zt=0,bi=kt.length;Zt<bi;Zt++){const Mi=kt[Zt];ma(W,$e,Mi,Mi.viewport)}}else ma(W,$e,Ct);De!==null&&($t.updateMultisampleRenderTarget(De),$t.updateRenderTargetMipmap(De)),$e.isScene===!0&&$e.onAfterRender(de,$e,Ct),On.buffers.depth.setTest(!0),On.buffers.depth.setMask(!0),On.buffers.color.setMask(!0),On.setPolygonOffset(!1),wn.enabled&&wn.submitFrame&&wn.submitFrame(),Zn.resetDefaultState(),Me=-1,Ie=null,ee.pop(),ee.length>0?j=ee[ee.length-1]:j=null,Y.pop(),Y.length>0?W=Y[Y.length-1]:W=null};function Tr($e,Ct,Nt,kt){if($e.visible===!1)return;if($e.layers.test(Ct.layers)){if($e.isGroup)Nt=$e.renderOrder;else if($e.isLOD)$e.autoUpdate===!0&&$e.update(Ct);else if($e.isLight)j.pushLight($e),$e.castShadow&&j.pushShadow($e);else if($e.isSprite){if(!$e.frustumCulled||Vt.intersectsSprite($e)){kt&&Yt.setFromMatrixPosition($e.matrixWorld).applyMatrix4(Dn);const Mi=vi.update($e),Di=$e.material;Di.visible&&W.push($e,Mi,Di,Nt,Yt.z,null)}}else if(($e.isMesh||$e.isLine||$e.isPoints)&&($e.isSkinnedMesh&&$e.skeleton.frame!==Ai.render.frame&&($e.skeleton.update(),$e.skeleton.frame=Ai.render.frame),!$e.frustumCulled||Vt.intersectsObject($e))){kt&&Yt.setFromMatrixPosition($e.matrixWorld).applyMatrix4(Dn);const Mi=vi.update($e),Di=$e.material;if(Array.isArray(Di)){const Ri=Mi.groups;for(let tr=0,$i=Ri.length;tr<$i;tr++){const Yi=Ri[tr],Cr=Di[Yi.materialIndex];Cr&&Cr.visible&&W.push($e,Mi,Cr,Nt,Yt.z,Yi)}}else Di.visible&&W.push($e,Mi,Di,Nt,Yt.z,null)}}const bi=$e.children;for(let Mi=0,Di=bi.length;Mi<Di;Mi++)Tr(bi[Mi],Ct,Nt,kt)}function ma($e,Ct,Nt,kt){const Zt=$e.opaque,bi=$e.transmissive,Mi=$e.transparent;j.setupLightsView(Nt),bi.length>0&&Xa(Zt,Ct,Nt),kt&&On.viewport(Xe.copy(kt)),Zt.length>0&&lv(Zt,Ct,Nt),bi.length>0&&lv(bi,Ct,Nt),Mi.length>0&&lv(Mi,Ct,Nt)}function Xa($e,Ct,Nt){if(Qn===null){const Mi=C===!0&&li.isWebGL2===!0?Km:js;Qn=new Mi(1024,1024,{generateMipmaps:!0,type:ii.convert(Gi)!==null?Gi:An,minFilter:Wt,magFilter:It,wrapS:_t,wrapT:_t,useRenderToTexture:Nn.has("WEBGL_multisampled_render_to_texture")})}const kt=de.getRenderTarget();de.setRenderTarget(Qn),de.clear();const Zt=de.toneMapping;de.toneMapping=ge,lv($e,Ct,Nt),de.toneMapping=Zt,$t.updateMultisampleRenderTarget(Qn),$t.updateRenderTargetMipmap(Qn),de.setRenderTarget(kt)}function lv($e,Ct,Nt){const kt=Ct.isScene===!0?Ct.overrideMaterial:null;for(let Zt=0,bi=$e.length;Zt<bi;Zt++){const Mi=$e[Zt],Di=Mi.object,Ri=Mi.geometry,tr=kt===null?Mi.material:kt,$i=Mi.group;Di.layers.test(Nt.layers)&&O6(Di,Ct,Nt,Ri,tr,$i)}}function O6($e,Ct,Nt,kt,Zt,bi){$e.onBeforeRender(de,Ct,Nt,kt,Zt,bi),$e.modelViewMatrix.multiplyMatrices(Nt.matrixWorldInverse,$e.matrixWorld),$e.normalMatrix.getNormalMatrix($e.modelViewMatrix),Zt.onBeforeRender(de,Ct,Nt,kt,$e,bi),Zt.transparent===!0&&Zt.side===T?(Zt.side=S,Zt.needsUpdate=!0,de.renderBufferDirect(Nt,Ct,kt,Zt,$e,bi),Zt.side=w,Zt.needsUpdate=!0,de.renderBufferDirect(Nt,Ct,kt,Zt,$e,bi),Zt.side=T):de.renderBufferDirect(Nt,Ct,kt,Zt,$e,bi),$e.onAfterRender(de,Ct,Nt,kt,Zt,bi)}function z_($e,Ct,Nt){Ct.isScene!==!0&&(Ct=gn);const kt=ci.get($e),Zt=j.state.lights,bi=j.state.shadowsArray,Mi=Zt.state.version,Di=pi.getParameters($e,Zt.state,bi,Ct,Nt),Ri=pi.getProgramCacheKey(Di);let tr=kt.programs;kt.environment=$e.isMeshStandardMaterial?Ct.environment:null,kt.fog=Ct.fog,kt.envMap=($e.isMeshStandardMaterial?xn:vn).get($e.envMap||kt.environment),tr===void 0&&($e.addEventListener("dispose",jn),tr=new Map,kt.programs=tr);let $i=tr.get(Ri);if($i!==void 0){if(kt.currentProgram===$i&&kt.lightsStateVersion===Mi)return l2($e,Di),$i}else Di.uniforms=pi.getUniforms($e),$e.onBuild(Nt,Di,de),$e.onBeforeCompile(Di,de),$i=pi.acquireProgram(Di,Ri),tr.set(Ri,$i),kt.uniforms=Di.uniforms;const Yi=kt.uniforms;(!$e.isShaderMaterial&&!$e.isRawShaderMaterial||$e.clipping===!0)&&(Yi.clippingPlanes=Ke.uniform),l2($e,Di),kt.needsLights=N6($e),kt.lightsStateVersion=Mi,kt.needsLights&&(Yi.ambientLightColor.value=Zt.state.ambient,Yi.lightProbe.value=Zt.state.probe,Yi.directionalLights.value=Zt.state.directional,Yi.directionalLightShadows.value=Zt.state.directionalShadow,Yi.spotLights.value=Zt.state.spot,Yi.spotLightShadows.value=Zt.state.spotShadow,Yi.rectAreaLights.value=Zt.state.rectArea,Yi.ltc_1.value=Zt.state.rectAreaLTC1,Yi.ltc_2.value=Zt.state.rectAreaLTC2,Yi.pointLights.value=Zt.state.point,Yi.pointLightShadows.value=Zt.state.pointShadow,Yi.hemisphereLights.value=Zt.state.hemi,Yi.directionalShadowMap.value=Zt.state.directionalShadowMap,Yi.directionalShadowMatrix.value=Zt.state.directionalShadowMatrix,Yi.spotShadowMap.value=Zt.state.spotShadowMap,Yi.spotShadowMatrix.value=Zt.state.spotShadowMatrix,Yi.pointShadowMap.value=Zt.state.pointShadowMap,Yi.pointShadowMatrix.value=Zt.state.pointShadowMatrix);const Cr=$i.getUniforms(),lu=Gl.seqWithValue(Cr.seq,Yi);return kt.currentProgram=$i,kt.uniformsList=lu,$i}function l2($e,Ct){const Nt=ci.get($e);Nt.outputEncoding=Ct.outputEncoding,Nt.instancing=Ct.instancing,Nt.skinning=Ct.skinning,Nt.morphTargets=Ct.morphTargets,Nt.morphNormals=Ct.morphNormals,Nt.morphTargetsCount=Ct.morphTargetsCount,Nt.numClippingPlanes=Ct.numClippingPlanes,Nt.numIntersection=Ct.numClipIntersection,Nt.vertexAlphas=Ct.vertexAlphas,Nt.vertexTangents=Ct.vertexTangents,Nt.toneMapping=Ct.toneMapping}function I6($e,Ct,Nt,kt,Zt){Ct.isScene!==!0&&(Ct=gn),$t.resetTextureUnits();const bi=Ct.fog,Mi=kt.isMeshStandardMaterial?Ct.environment:null,Di=De===null?de.outputEncoding:De.isXRRenderTarget===!0?De.texture.encoding:hn,Ri=(kt.isMeshStandardMaterial?xn:vn).get(kt.envMap||Mi),tr=kt.vertexColors===!0&&!!Nt.attributes.color&&Nt.attributes.color.itemSize===4,$i=!!kt.normalMap&&!!Nt.attributes.tangent,Yi=!!Nt.morphAttributes.position,Cr=!!Nt.morphAttributes.normal,lu=Nt.morphAttributes.position?Nt.morphAttributes.position.length:0,Uh=kt.toneMapped?de.toneMapping:ge,Zi=ci.get(kt),ga=j.state.lights;if(on===!0&&(Cn===!0||$e!==Ie)){const Bo=$e===Ie&&kt.id===Me;Ke.setState(kt,$e,Bo)}let Gr=!1;kt.version===Zi.__version?(Zi.needsLights&&Zi.lightsStateVersion!==ga.state.version||Zi.outputEncoding!==Di||Zt.isInstancedMesh&&Zi.instancing===!1||!Zt.isInstancedMesh&&Zi.instancing===!0||Zt.isSkinnedMesh&&Zi.skinning===!1||!Zt.isSkinnedMesh&&Zi.skinning===!0||Zi.envMap!==Ri||kt.fog&&Zi.fog!==bi||Zi.numClippingPlanes!==void 0&&(Zi.numClippingPlanes!==Ke.numPlanes||Zi.numIntersection!==Ke.numIntersection)||Zi.vertexAlphas!==tr||Zi.vertexTangents!==$i||Zi.morphTargets!==Yi||Zi.morphNormals!==Cr||Zi.toneMapping!==Uh||li.isWebGL2===!0&&Zi.morphTargetsCount!==lu)&&(Gr=!0):(Gr=!0,Zi.__version=kt.version);let va=Zi.currentProgram;Gr===!0&&(va=z_(kt,Ct,Zt));let cv=!1,ya=!1,qa=!1;const ds=va.getUniforms(),Yf=Zi.uniforms;if(On.useProgram(va.program)&&(cv=!0,ya=!0,qa=!0),kt.id!==Me&&(Me=kt.id,ya=!0),cv||Ie!==$e){if(ds.setValue(ht,"projectionMatrix",$e.projectionMatrix),li.logarithmicDepthBuffer&&ds.setValue(ht,"logDepthBufFC",2/(Math.log($e.far+1)/Math.LN2)),Ie!==$e&&(Ie=$e,ya=!0,qa=!0),kt.isShaderMaterial||kt.isMeshPhongMaterial||kt.isMeshToonMaterial||kt.isMeshStandardMaterial||kt.envMap){const Bo=ds.map.cameraPosition;Bo!==void 0&&Bo.setValue(ht,Yt.setFromMatrixPosition($e.matrixWorld))}(kt.isMeshPhongMaterial||kt.isMeshToonMaterial||kt.isMeshLambertMaterial||kt.isMeshBasicMaterial||kt.isMeshStandardMaterial||kt.isShaderMaterial)&&ds.setValue(ht,"isOrthographic",$e.isOrthographicCamera===!0),(kt.isMeshPhongMaterial||kt.isMeshToonMaterial||kt.isMeshLambertMaterial||kt.isMeshBasicMaterial||kt.isMeshStandardMaterial||kt.isShaderMaterial||kt.isShadowMaterial||Zt.isSkinnedMesh)&&ds.setValue(ht,"viewMatrix",$e.matrixWorldInverse)}if(Zt.isSkinnedMesh){ds.setOptional(ht,Zt,"bindMatrix"),ds.setOptional(ht,Zt,"bindMatrixInverse");const Bo=Zt.skeleton;Bo&&(li.floatVertexTextures?(Bo.boneTexture===null&&Bo.computeBoneTexture(),ds.setValue(ht,"boneTexture",Bo.boneTexture,$t),ds.setValue(ht,"boneTextureSize",Bo.boneTextureSize)):ds.setOptional(ht,Bo,"boneMatrices"))}return!!Nt&&(Nt.morphAttributes.position!==void 0||Nt.morphAttributes.normal!==void 0)&&yn.update(Zt,Nt,kt,va),(ya||Zi.receiveShadow!==Zt.receiveShadow)&&(Zi.receiveShadow=Zt.receiveShadow,ds.setValue(ht,"receiveShadow",Zt.receiveShadow)),ya&&(ds.setValue(ht,"toneMappingExposure",de.toneMappingExposure),Zi.needsLights&&k6(Yf,qa),bi&&kt.fog&&Fi.refreshFogUniforms(Yf,bi),Fi.refreshMaterialUniforms(Yf,kt,Ee,Rt,Qn),Gl.upload(ht,Zi.uniformsList,Yf,$t)),kt.isShaderMaterial&&kt.uniformsNeedUpdate===!0&&(Gl.upload(ht,Zi.uniformsList,Yf,$t),kt.uniformsNeedUpdate=!1),kt.isSpriteMaterial&&ds.setValue(ht,"center",Zt.center),ds.setValue(ht,"modelViewMatrix",Zt.modelViewMatrix),ds.setValue(ht,"normalMatrix",Zt.normalMatrix),ds.setValue(ht,"modelMatrix",Zt.matrixWorld),va}function k6($e,Ct){$e.ambientLightColor.needsUpdate=Ct,$e.lightProbe.needsUpdate=Ct,$e.directionalLights.needsUpdate=Ct,$e.directionalLightShadows.needsUpdate=Ct,$e.pointLights.needsUpdate=Ct,$e.pointLightShadows.needsUpdate=Ct,$e.spotLights.needsUpdate=Ct,$e.spotLightShadows.needsUpdate=Ct,$e.rectAreaLights.needsUpdate=Ct,$e.hemisphereLights.needsUpdate=Ct}function N6($e){return $e.isMeshLambertMaterial||$e.isMeshToonMaterial||$e.isMeshPhongMaterial||$e.isMeshStandardMaterial||$e.isShadowMaterial||$e.isShaderMaterial&&$e.lights===!0}this.setTexture2D=function(){var $e=!1;return function(Nt,kt){Nt&&Nt.isWebGLRenderTarget&&($e||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),$e=!0),Nt=Nt.texture),$t.setTexture2D(Nt,kt)}}(),this.getActiveCubeFace=function(){return re},this.getActiveMipmapLevel=function(){return Q},this.getRenderTarget=function(){return De},this.setRenderTargetTextures=function($e,Ct,Nt){ci.get($e.texture).__webglTexture=Ct,ci.get($e.depthTexture).__webglTexture=Nt;const kt=ci.get($e);kt.__hasExternalTextures=!0,kt.__hasExternalTextures&&(kt.__autoAllocateDepthBuffer=Nt===void 0,kt.__autoAllocateDepthBuffer||$e.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),$e.useRenderToTexture=!1,$e.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function($e,Ct){const Nt=ci.get($e);Nt.__webglFramebuffer=Ct,Nt.__useDefaultFramebuffer=Ct===void 0},this.setRenderTarget=function($e,Ct=0,Nt=0){De=$e,re=Ct,Q=Nt;let kt=!0;if($e){const Ri=ci.get($e);Ri.__useDefaultFramebuffer!==void 0?(On.bindFramebuffer(ht.FRAMEBUFFER,null),kt=!1):Ri.__webglFramebuffer===void 0?$t.setupRenderTarget($e):Ri.__hasExternalTextures&&$t.rebindTextures($e,ci.get($e.texture).__webglTexture,ci.get($e.depthTexture).__webglTexture)}let Zt=null,bi=!1,Mi=!1;if($e){const Ri=$e.texture;(Ri.isDataTexture3D||Ri.isDataTexture2DArray)&&(Mi=!0);const tr=ci.get($e).__webglFramebuffer;$e.isWebGLCubeRenderTarget?(Zt=tr[Ct],bi=!0):$e.useRenderbuffer?Zt=ci.get($e).__webglMultisampledFramebuffer:Zt=tr,Xe.copy($e.viewport),st.copy($e.scissor),ut=$e.scissorTest}else Xe.copy(Et).multiplyScalar(Ee).floor(),st.copy(gt).multiplyScalar(Ee).floor(),ut=Lt;if(On.bindFramebuffer(ht.FRAMEBUFFER,Zt)&&li.drawBuffers&&kt&&On.drawBuffers($e,Zt),On.viewport(Xe),On.scissor(st),On.setScissorTest(ut),bi){const Ri=ci.get($e.texture);ht.framebufferTexture2D(ht.FRAMEBUFFER,ht.COLOR_ATTACHMENT0,ht.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Ri.__webglTexture,Nt)}else if(Mi){const Ri=ci.get($e.texture),tr=Ct||0;ht.framebufferTextureLayer(ht.FRAMEBUFFER,ht.COLOR_ATTACHMENT0,Ri.__webglTexture,Nt||0,tr)}Me=-1},this.readRenderTargetPixels=function($e,Ct,Nt,kt,Zt,bi,Mi){if(!($e&&$e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Di=ci.get($e).__webglFramebuffer;if($e.isWebGLCubeRenderTarget&&Mi!==void 0&&(Di=Di[Mi]),Di){On.bindFramebuffer(ht.FRAMEBUFFER,Di);try{const Ri=$e.texture,tr=Ri.format,$i=Ri.type;if(tr!==Pt&&ii.convert(tr)!==ht.getParameter(ht.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Yi=$i===Gi&&(Nn.has("EXT_color_buffer_half_float")||li.isWebGL2&&Nn.has("EXT_color_buffer_float"));if($i!==An&&ii.convert($i)!==ht.getParameter(ht.IMPLEMENTATION_COLOR_READ_TYPE)&&!($i===Si&&(li.isWebGL2||Nn.has("OES_texture_float")||Nn.has("WEBGL_color_buffer_float")))&&!Yi){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ht.checkFramebufferStatus(ht.FRAMEBUFFER)===ht.FRAMEBUFFER_COMPLETE?Ct>=0&&Ct<=$e.width-kt&&Nt>=0&&Nt<=$e.height-Zt&&ht.readPixels(Ct,Nt,kt,Zt,ii.convert(tr),ii.convert($i),bi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Ri=De!==null?ci.get(De).__webglFramebuffer:null;On.bindFramebuffer(ht.FRAMEBUFFER,Ri)}}},this.copyFramebufferToTexture=function($e,Ct,Nt=0){if(Ct.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}const kt=Math.pow(2,-Nt),Zt=Math.floor(Ct.image.width*kt),bi=Math.floor(Ct.image.height*kt);$t.setTexture2D(Ct,0),ht.copyTexSubImage2D(ht.TEXTURE_2D,Nt,0,0,$e.x,$e.y,Zt,bi),On.unbindTexture()},this.copyTextureToTexture=function($e,Ct,Nt,kt=0){const Zt=Ct.image.width,bi=Ct.image.height,Mi=ii.convert(Nt.format),Di=ii.convert(Nt.type);$t.setTexture2D(Nt,0),ht.pixelStorei(ht.UNPACK_FLIP_Y_WEBGL,Nt.flipY),ht.pixelStorei(ht.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Nt.premultiplyAlpha),ht.pixelStorei(ht.UNPACK_ALIGNMENT,Nt.unpackAlignment),Ct.isDataTexture?ht.texSubImage2D(ht.TEXTURE_2D,kt,$e.x,$e.y,Zt,bi,Mi,Di,Ct.image.data):Ct.isCompressedTexture?ht.compressedTexSubImage2D(ht.TEXTURE_2D,kt,$e.x,$e.y,Ct.mipmaps[0].width,Ct.mipmaps[0].height,Mi,Ct.mipmaps[0].data):ht.texSubImage2D(ht.TEXTURE_2D,kt,$e.x,$e.y,Mi,Di,Ct.image),kt===0&&Nt.generateMipmaps&&ht.generateMipmap(ht.TEXTURE_2D),On.unbindTexture()},this.copyTextureToTexture3D=function($e,Ct,Nt,kt,Zt=0){if(de.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const bi=$e.max.x-$e.min.x+1,Mi=$e.max.y-$e.min.y+1,Di=$e.max.z-$e.min.z+1,Ri=ii.convert(kt.format),tr=ii.convert(kt.type);let $i;if(kt.isDataTexture3D)$t.setTexture3D(kt,0),$i=ht.TEXTURE_3D;else if(kt.isDataTexture2DArray)$t.setTexture2DArray(kt,0),$i=ht.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}ht.pixelStorei(ht.UNPACK_FLIP_Y_WEBGL,kt.flipY),ht.pixelStorei(ht.UNPACK_PREMULTIPLY_ALPHA_WEBGL,kt.premultiplyAlpha),ht.pixelStorei(ht.UNPACK_ALIGNMENT,kt.unpackAlignment);const Yi=ht.getParameter(ht.UNPACK_ROW_LENGTH),Cr=ht.getParameter(ht.UNPACK_IMAGE_HEIGHT),lu=ht.getParameter(ht.UNPACK_SKIP_PIXELS),Uh=ht.getParameter(ht.UNPACK_SKIP_ROWS),Zi=ht.getParameter(ht.UNPACK_SKIP_IMAGES),ga=Nt.isCompressedTexture?Nt.mipmaps[0]:Nt.image;ht.pixelStorei(ht.UNPACK_ROW_LENGTH,ga.width),ht.pixelStorei(ht.UNPACK_IMAGE_HEIGHT,ga.height),ht.pixelStorei(ht.UNPACK_SKIP_PIXELS,$e.min.x),ht.pixelStorei(ht.UNPACK_SKIP_ROWS,$e.min.y),ht.pixelStorei(ht.UNPACK_SKIP_IMAGES,$e.min.z),Nt.isDataTexture||Nt.isDataTexture3D?ht.texSubImage3D($i,Zt,Ct.x,Ct.y,Ct.z,bi,Mi,Di,Ri,tr,ga.data):Nt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),ht.compressedTexSubImage3D($i,Zt,Ct.x,Ct.y,Ct.z,bi,Mi,Di,Ri,ga.data)):ht.texSubImage3D($i,Zt,Ct.x,Ct.y,Ct.z,bi,Mi,Di,Ri,tr,ga),ht.pixelStorei(ht.UNPACK_ROW_LENGTH,Yi),ht.pixelStorei(ht.UNPACK_IMAGE_HEIGHT,Cr),ht.pixelStorei(ht.UNPACK_SKIP_PIXELS,lu),ht.pixelStorei(ht.UNPACK_SKIP_ROWS,Uh),ht.pixelStorei(ht.UNPACK_SKIP_IMAGES,Zi),Zt===0&&kt.generateMipmaps&&ht.generateMipmap($i),On.unbindTexture()},this.initTexture=function($e){$t.setTexture2D($e,0),On.unbindTexture()},this.resetState=function(){re=0,Q=0,De=null,On.reset(),Zn.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}sr.prototype.isWebGLRenderer=!0;class DS extends sr{}DS.prototype.isWebGL1Renderer=!0;class Cf{constructor(s,c=25e-5){this.name="",this.color=new Tn(s),this.density=c}clone(){return new Cf(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Cf.prototype.isFogExp2=!0;class Rf{constructor(s,c=1,p=1e3){this.name="",this.color=new Tn(s),this.near=c,this.far=p}clone(){return new Rf(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Rf.prototype.isFog=!0;class Tg extends Oi{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(s,c){return super.copy(s,c),s.background!==null&&(this.background=s.background.clone()),s.environment!==null&&(this.environment=s.environment.clone()),s.fog!==null&&(this.fog=s.fog.clone()),s.overrideMaterial!==null&&(this.overrideMaterial=s.overrideMaterial.clone()),this.autoUpdate=s.autoUpdate,this.matrixAutoUpdate=s.matrixAutoUpdate,this}toJSON(s){const c=super.toJSON(s);return this.fog!==null&&(c.object.fog=this.fog.toJSON()),c}}Tg.prototype.isScene=!0;class Xc{constructor(s,c){this.array=s,this.stride=c,this.count=s!==void 0?s.length/c:0,this.usage=Zu,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ws()}onUploadCallback(){}set needsUpdate(s){s===!0&&this.version++}setUsage(s){return this.usage=s,this}copy(s){return this.array=new s.array.constructor(s.array),this.count=s.count,this.stride=s.stride,this.usage=s.usage,this}copyAt(s,c,p){s*=this.stride,p*=c.stride;for(let y=0,M=this.stride;y<M;y++)this.array[s+y]=c.array[p+y];return this}set(s,c=0){return this.array.set(s,c),this}clone(s){s.arrayBuffers===void 0&&(s.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ws()),s.arrayBuffers[this.array.buffer._uuid]===void 0&&(s.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const c=new this.array.constructor(s.arrayBuffers[this.array.buffer._uuid]),p=new this.constructor(c,this.stride);return p.setUsage(this.usage),p}onUpload(s){return this.onUploadCallback=s,this}toJSON(s){return s.arrayBuffers===void 0&&(s.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Ws()),s.arrayBuffers[this.array.buffer._uuid]===void 0&&(s.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Xc.prototype.isInterleavedBuffer=!0;const Or=new Ge;class Wl{constructor(s,c,p,y=!1){this.name="",this.data=s,this.itemSize=c,this.offset=p,this.normalized=y===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(s){this.data.needsUpdate=s}applyMatrix4(s){for(let c=0,p=this.data.count;c<p;c++)Or.x=this.getX(c),Or.y=this.getY(c),Or.z=this.getZ(c),Or.applyMatrix4(s),this.setXYZ(c,Or.x,Or.y,Or.z);return this}applyNormalMatrix(s){for(let c=0,p=this.count;c<p;c++)Or.x=this.getX(c),Or.y=this.getY(c),Or.z=this.getZ(c),Or.applyNormalMatrix(s),this.setXYZ(c,Or.x,Or.y,Or.z);return this}transformDirection(s){for(let c=0,p=this.count;c<p;c++)Or.x=this.getX(c),Or.y=this.getY(c),Or.z=this.getZ(c),Or.transformDirection(s),this.setXYZ(c,Or.x,Or.y,Or.z);return this}setX(s,c){return this.data.array[s*this.data.stride+this.offset]=c,this}setY(s,c){return this.data.array[s*this.data.stride+this.offset+1]=c,this}setZ(s,c){return this.data.array[s*this.data.stride+this.offset+2]=c,this}setW(s,c){return this.data.array[s*this.data.stride+this.offset+3]=c,this}getX(s){return this.data.array[s*this.data.stride+this.offset]}getY(s){return this.data.array[s*this.data.stride+this.offset+1]}getZ(s){return this.data.array[s*this.data.stride+this.offset+2]}getW(s){return this.data.array[s*this.data.stride+this.offset+3]}setXY(s,c,p){return s=s*this.data.stride+this.offset,this.data.array[s+0]=c,this.data.array[s+1]=p,this}setXYZ(s,c,p,y){return s=s*this.data.stride+this.offset,this.data.array[s+0]=c,this.data.array[s+1]=p,this.data.array[s+2]=y,this}setXYZW(s,c,p,y,M){return s=s*this.data.stride+this.offset,this.data.array[s+0]=c,this.data.array[s+1]=p,this.data.array[s+2]=y,this.data.array[s+3]=M,this}clone(s){if(s===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let p=0;p<this.count;p++){const y=p*this.data.stride+this.offset;for(let M=0;M<this.itemSize;M++)c.push(this.data.array[y+M])}return new Hi(new this.array.constructor(c),this.itemSize,this.normalized)}else return s.interleavedBuffers===void 0&&(s.interleavedBuffers={}),s.interleavedBuffers[this.data.uuid]===void 0&&(s.interleavedBuffers[this.data.uuid]=this.data.clone(s)),new Wl(s.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(s){if(s===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let p=0;p<this.count;p++){const y=p*this.data.stride+this.offset;for(let M=0;M<this.itemSize;M++)c.push(this.data.array[y+M])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:c,normalized:this.normalized}}else return s.interleavedBuffers===void 0&&(s.interleavedBuffers={}),s.interleavedBuffers[this.data.uuid]===void 0&&(s.interleavedBuffers[this.data.uuid]=this.data.toJSON(s)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Wl.prototype.isInterleavedBufferAttribute=!0;class Cg extends Kr{constructor(s){super(),this.type="SpriteMaterial",this.color=new Tn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.rotation=s.rotation,this.sizeAttenuation=s.sizeAttenuation,this}}Cg.prototype.isSpriteMaterial=!0;let Eh;const Lf=new Ge,Ah=new Ge,wh=new Ge,Mh=new Qt,Pf=new Qt,OS=new zn,Rg=new Ge,Df=new Ge,Lg=new Ge,IS=new Qt,Xx=new Qt,kS=new Qt;class Pg extends Oi{constructor(s){if(super(),this.type="Sprite",Eh===void 0){Eh=new si;const c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),p=new Xc(c,5);Eh.setIndex([0,1,2,0,2,3]),Eh.setAttribute("position",new Wl(p,3,0,!1)),Eh.setAttribute("uv",new Wl(p,2,3,!1))}this.geometry=Eh,this.material=s!==void 0?s:new Cg,this.center=new Qt(.5,.5)}raycast(s,c){s.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ah.setFromMatrixScale(this.matrixWorld),OS.copy(s.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(s.camera.matrixWorldInverse,this.matrixWorld),wh.setFromMatrixPosition(this.modelViewMatrix),s.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Ah.multiplyScalar(-wh.z);const p=this.material.rotation;let y,M;p!==0&&(M=Math.cos(p),y=Math.sin(p));const C=this.center;Dg(Rg.set(-.5,-.5,0),wh,C,Ah,y,M),Dg(Df.set(.5,-.5,0),wh,C,Ah,y,M),Dg(Lg.set(.5,.5,0),wh,C,Ah,y,M),IS.set(0,0),Xx.set(1,0),kS.set(1,1);let P=s.ray.intersectTriangle(Rg,Df,Lg,!1,Lf);if(P===null&&(Dg(Df.set(-.5,.5,0),wh,C,Ah,y,M),Xx.set(0,1),P=s.ray.intersectTriangle(Rg,Lg,Df,!1,Lf),P===null))return;const F=s.ray.origin.distanceTo(Lf);F<s.near||F>s.far||c.push({distance:F,point:Lf.clone(),uv:Dr.getUV(Lf,Rg,Df,Lg,IS,Xx,kS,new Qt),face:null,object:this})}copy(s){return super.copy(s),s.center!==void 0&&this.center.copy(s.center),this.material=s.material,this}}Pg.prototype.isSprite=!0;function Dg(b,s,c,p,y,M){Mh.subVectors(b,c).addScalar(.5).multiply(p),y!==void 0?(Pf.x=M*Mh.x-y*Mh.y,Pf.y=y*Mh.x+M*Mh.y):Pf.copy(Mh),b.copy(s),b.x+=Pf.x,b.y+=Pf.y,b.applyMatrix4(OS)}const Og=new Ge,NS=new Ge;class FS extends Oi{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(s){super.copy(s,!1);const c=s.levels;for(let p=0,y=c.length;p<y;p++){const M=c[p];this.addLevel(M.object.clone(),M.distance)}return this.autoUpdate=s.autoUpdate,this}addLevel(s,c=0){c=Math.abs(c);const p=this.levels;let y;for(y=0;y<p.length&&!(c<p[y].distance);y++);return p.splice(y,0,{distance:c,object:s}),this.add(s),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(s){const c=this.levels;if(c.length>0){let p,y;for(p=1,y=c.length;p<y&&!(s<c[p].distance);p++);return c[p-1].object}return null}raycast(s,c){if(this.levels.length>0){Og.setFromMatrixPosition(this.matrixWorld);const y=s.ray.origin.distanceTo(Og);this.getObjectForDistance(y).raycast(s,c)}}update(s){const c=this.levels;if(c.length>1){Og.setFromMatrixPosition(s.matrixWorld),NS.setFromMatrixPosition(this.matrixWorld);const p=Og.distanceTo(NS)/s.zoom;c[0].object.visible=!0;let y,M;for(y=1,M=c.length;y<M&&p>=c[y].distance;y++)c[y-1].object.visible=!1,c[y].object.visible=!0;for(this._currentLevel=y-1;y<M;y++)c[y].object.visible=!1}}toJSON(s){const c=super.toJSON(s);this.autoUpdate===!1&&(c.object.autoUpdate=!1),c.object.levels=[];const p=this.levels;for(let y=0,M=p.length;y<M;y++){const C=p[y];c.object.levels.push({object:C.object.uuid,distance:C.distance})}return c}}const BS=new Ge,US=new Qi,zS=new Qi,I5=new Ge,HS=new zn;class Ig extends Fr{constructor(s,c){super(s,c),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new zn,this.bindMatrixInverse=new zn}copy(s){return super.copy(s),this.bindMode=s.bindMode,this.bindMatrix.copy(s.bindMatrix),this.bindMatrixInverse.copy(s.bindMatrixInverse),this.skeleton=s.skeleton,this}bind(s,c){this.skeleton=s,c===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld),this.bindMatrix.copy(c),this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const s=new Qi,c=this.geometry.attributes.skinWeight;for(let p=0,y=c.count;p<y;p++){s.x=c.getX(p),s.y=c.getY(p),s.z=c.getZ(p),s.w=c.getW(p);const M=1/s.manhattanLength();M!==1/0?s.multiplyScalar(M):s.set(1,0,0,0),c.setXYZW(p,s.x,s.y,s.z,s.w)}}updateMatrixWorld(s){super.updateMatrixWorld(s),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(s,c){const p=this.skeleton,y=this.geometry;US.fromBufferAttribute(y.attributes.skinIndex,s),zS.fromBufferAttribute(y.attributes.skinWeight,s),BS.copy(c).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(let M=0;M<4;M++){const C=zS.getComponent(M);if(C!==0){const P=US.getComponent(M);HS.multiplyMatrices(p.bones[P].matrixWorld,p.boneInverses[P]),c.addScaledVector(I5.copy(BS).applyMatrix4(HS),C)}}return c.applyMatrix4(this.bindMatrixInverse)}}Ig.prototype.isSkinnedMesh=!0;class kg extends Oi{constructor(){super(),this.type="Bone"}}kg.prototype.isBone=!0;class qc extends Nr{constructor(s=null,c=1,p=1,y,M,C,P,F,U=It,V=It,W,j){super(null,C,P,F,U,V,y,M,W,j),this.image={data:s,width:c,height:p},this.magFilter=U,this.minFilter=V,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}qc.prototype.isDataTexture=!0;const GS=new zn,k5=new zn;class Ng{constructor(s=[],c=[]){this.uuid=Ws(),this.bones=s.slice(0),this.boneInverses=c,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const s=this.bones,c=this.boneInverses;if(this.boneMatrices=new Float32Array(s.length*16),c.length===0)this.calculateInverses();else if(s.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let p=0,y=this.bones.length;p<y;p++)this.boneInverses.push(new zn)}}calculateInverses(){this.boneInverses.length=0;for(let s=0,c=this.bones.length;s<c;s++){const p=new zn;this.bones[s]&&p.copy(this.bones[s].matrixWorld).invert(),this.boneInverses.push(p)}}pose(){for(let s=0,c=this.bones.length;s<c;s++){const p=this.bones[s];p&&p.matrixWorld.copy(this.boneInverses[s]).invert()}for(let s=0,c=this.bones.length;s<c;s++){const p=this.bones[s];p&&(p.parent&&p.parent.isBone?(p.matrix.copy(p.parent.matrixWorld).invert(),p.matrix.multiply(p.matrixWorld)):p.matrix.copy(p.matrixWorld),p.matrix.decompose(p.position,p.quaternion,p.scale))}}update(){const s=this.bones,c=this.boneInverses,p=this.boneMatrices,y=this.boneTexture;for(let M=0,C=s.length;M<C;M++){const P=s[M]?s[M].matrixWorld:k5;GS.multiplyMatrices(P,c[M]),GS.toArray(p,M*16)}y!==null&&(y.needsUpdate=!0)}clone(){return new Ng(this.bones,this.boneInverses)}computeBoneTexture(){let s=Math.sqrt(this.bones.length*4);s=MM(s),s=Math.max(s,4);const c=new Float32Array(s*s*4);c.set(this.boneMatrices);const p=new qc(c,s,s,Pt,Si);return p.needsUpdate=!0,this.boneMatrices=c,this.boneTexture=p,this.boneTextureSize=s,this}getBoneByName(s){for(let c=0,p=this.bones.length;c<p;c++){const y=this.bones[c];if(y.name===s)return y}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(s,c){this.uuid=s.uuid;for(let p=0,y=s.bones.length;p<y;p++){const M=s.bones[p];let C=c[M];C===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",M),C=new kg),this.bones.push(C),this.boneInverses.push(new zn().fromArray(s.boneInverses[p]))}return this.init(),this}toJSON(){const s={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};s.uuid=this.uuid;const c=this.bones,p=this.boneInverses;for(let y=0,M=c.length;y<M;y++){const C=c[y];s.bones.push(C.uuid);const P=p[y];s.boneInverses.push(P.toArray())}return s}}class Yc extends Hi{constructor(s,c,p,y=1){typeof p=="number"&&(y=p,p=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(s,c,p),this.meshPerAttribute=y}copy(s){return super.copy(s),this.meshPerAttribute=s.meshPerAttribute,this}toJSON(){const s=super.toJSON();return s.meshPerAttribute=this.meshPerAttribute,s.isInstancedBufferAttribute=!0,s}}Yc.prototype.isInstancedBufferAttribute=!0;const VS=new zn,WS=new zn,Fg=[],Of=new Fr;class qx extends Fr{constructor(s,c,p){super(s,c),this.instanceMatrix=new Yc(new Float32Array(p*16),16),this.instanceColor=null,this.count=p,this.frustumCulled=!1}copy(s){return super.copy(s),this.instanceMatrix.copy(s.instanceMatrix),s.instanceColor!==null&&(this.instanceColor=s.instanceColor.clone()),this.count=s.count,this}getColorAt(s,c){c.fromArray(this.instanceColor.array,s*3)}getMatrixAt(s,c){c.fromArray(this.instanceMatrix.array,s*16)}raycast(s,c){const p=this.matrixWorld,y=this.count;if(Of.geometry=this.geometry,Of.material=this.material,Of.material!==void 0)for(let M=0;M<y;M++){this.getMatrixAt(M,VS),WS.multiplyMatrices(p,VS),Of.matrixWorld=WS,Of.raycast(s,Fg);for(let C=0,P=Fg.length;C<P;C++){const F=Fg[C];F.instanceId=M,F.object=this,c.push(F)}Fg.length=0}}setColorAt(s,c){this.instanceColor===null&&(this.instanceColor=new Yc(new Float32Array(this.instanceMatrix.count*3),3)),c.toArray(this.instanceColor.array,s*3)}setMatrixAt(s,c){c.toArray(this.instanceMatrix.array,s*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}qx.prototype.isInstancedMesh=!0;class Zr extends Kr{constructor(s){super(),this.type="LineBasicMaterial",this.color=new Tn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.linewidth=s.linewidth,this.linecap=s.linecap,this.linejoin=s.linejoin,this}}Zr.prototype.isLineBasicMaterial=!0;const jS=new Ge,$S=new Ge,XS=new zn,Yx=new Nl,Bg=new Il;class Wa extends Oi{constructor(s=new si,c=new Zr){super(),this.type="Line",this.geometry=s,this.material=c,this.updateMorphTargets()}copy(s){return super.copy(s),this.material=s.material,this.geometry=s.geometry,this}computeLineDistances(){const s=this.geometry;if(s.isBufferGeometry)if(s.index===null){const c=s.attributes.position,p=[0];for(let y=1,M=c.count;y<M;y++)jS.fromBufferAttribute(c,y-1),$S.fromBufferAttribute(c,y),p[y]=p[y-1],p[y]+=jS.distanceTo($S);s.setAttribute("lineDistance",new Hn(p,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else s.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(s,c){const p=this.geometry,y=this.matrixWorld,M=s.params.Line.threshold,C=p.drawRange;if(p.boundingSphere===null&&p.computeBoundingSphere(),Bg.copy(p.boundingSphere),Bg.applyMatrix4(y),Bg.radius+=M,s.ray.intersectsSphere(Bg)===!1)return;XS.copy(y).invert(),Yx.copy(s.ray).applyMatrix4(XS);const P=M/((this.scale.x+this.scale.y+this.scale.z)/3),F=P*P,U=new Ge,V=new Ge,W=new Ge,j=new Ge,Y=this.isLineSegments?2:1;if(p.isBufferGeometry){const ee=p.index,xe=p.attributes.position;if(ee!==null){const re=Math.max(0,C.start),Q=Math.min(ee.count,C.start+C.count);for(let De=re,Me=Q-1;De<Me;De+=Y){const Ie=ee.getX(De),Xe=ee.getX(De+1);if(U.fromBufferAttribute(xe,Ie),V.fromBufferAttribute(xe,Xe),Yx.distanceSqToSegment(U,V,j,W)>F)continue;j.applyMatrix4(this.matrixWorld);const ut=s.ray.origin.distanceTo(j);ut<s.near||ut>s.far||c.push({distance:ut,point:W.clone().applyMatrix4(this.matrixWorld),index:De,face:null,faceIndex:null,object:this})}}else{const re=Math.max(0,C.start),Q=Math.min(xe.count,C.start+C.count);for(let De=re,Me=Q-1;De<Me;De+=Y){if(U.fromBufferAttribute(xe,De),V.fromBufferAttribute(xe,De+1),Yx.distanceSqToSegment(U,V,j,W)>F)continue;j.applyMatrix4(this.matrixWorld);const Xe=s.ray.origin.distanceTo(j);Xe<s.near||Xe>s.far||c.push({distance:Xe,point:W.clone().applyMatrix4(this.matrixWorld),index:De,face:null,faceIndex:null,object:this})}}}else p.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const s=this.geometry;if(s.isBufferGeometry){const c=s.morphAttributes,p=Object.keys(c);if(p.length>0){const y=c[p[0]];if(y!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let M=0,C=y.length;M<C;M++){const P=y[M].name||String(M);this.morphTargetInfluences.push(0),this.morphTargetDictionary[P]=M}}}}else{const c=s.morphTargets;c!==void 0&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Wa.prototype.isLine=!0;const qS=new Ge,YS=new Ge;class Is extends Wa{constructor(s,c){super(s,c),this.type="LineSegments"}computeLineDistances(){const s=this.geometry;if(s.isBufferGeometry)if(s.index===null){const c=s.attributes.position,p=[];for(let y=0,M=c.count;y<M;y+=2)qS.fromBufferAttribute(c,y),YS.fromBufferAttribute(c,y+1),p[y]=y===0?0:p[y-1],p[y+1]=p[y]+qS.distanceTo(YS);s.setAttribute("lineDistance",new Hn(p,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else s.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Is.prototype.isLineSegments=!0;class Kx extends Wa{constructor(s,c){super(s,c),this.type="LineLoop"}}Kx.prototype.isLineLoop=!0;class Kc extends Kr{constructor(s){super(),this.type="PointsMaterial",this.color=new Tn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.size=s.size,this.sizeAttenuation=s.sizeAttenuation,this}}Kc.prototype.isPointsMaterial=!0;const KS=new zn,Qx=new Nl,Ug=new Il,zg=new Ge;class If extends Oi{constructor(s=new si,c=new Kc){super(),this.type="Points",this.geometry=s,this.material=c,this.updateMorphTargets()}copy(s){return super.copy(s),this.material=s.material,this.geometry=s.geometry,this}raycast(s,c){const p=this.geometry,y=this.matrixWorld,M=s.params.Points.threshold,C=p.drawRange;if(p.boundingSphere===null&&p.computeBoundingSphere(),Ug.copy(p.boundingSphere),Ug.applyMatrix4(y),Ug.radius+=M,s.ray.intersectsSphere(Ug)===!1)return;KS.copy(y).invert(),Qx.copy(s.ray).applyMatrix4(KS);const P=M/((this.scale.x+this.scale.y+this.scale.z)/3),F=P*P;if(p.isBufferGeometry){const U=p.index,W=p.attributes.position;if(U!==null){const j=Math.max(0,C.start),Y=Math.min(U.count,C.start+C.count);for(let ee=j,de=Y;ee<de;ee++){const xe=U.getX(ee);zg.fromBufferAttribute(W,xe),QS(zg,xe,F,y,s,c,this)}}else{const j=Math.max(0,C.start),Y=Math.min(W.count,C.start+C.count);for(let ee=j,de=Y;ee<de;ee++)zg.fromBufferAttribute(W,ee),QS(zg,ee,F,y,s,c,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const s=this.geometry;if(s.isBufferGeometry){const c=s.morphAttributes,p=Object.keys(c);if(p.length>0){const y=c[p[0]];if(y!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let M=0,C=y.length;M<C;M++){const P=y[M].name||String(M);this.morphTargetInfluences.push(0),this.morphTargetDictionary[P]=M}}}}else{const c=s.morphTargets;c!==void 0&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}If.prototype.isPoints=!0;function QS(b,s,c,p,y,M,C){const P=Qx.distanceSqToPoint(b);if(P<c){const F=new Ge;Qx.closestPointToPoint(b,F),F.applyMatrix4(p);const U=y.ray.origin.distanceTo(F);if(U<y.near||U>y.far)return;M.push({distance:U,distanceToRay:Math.sqrt(P),point:F,index:s,face:null,object:C})}}class ZS extends Nr{constructor(s,c,p,y,M,C,P,F,U){super(s,c,p,y,M,C,P,F,U),this.minFilter=C!==void 0?C:Ve,this.magFilter=M!==void 0?M:Ve,this.generateMipmaps=!1;const V=this;function W(){V.needsUpdate=!0,s.requestVideoFrameCallback(W)}"requestVideoFrameCallback"in s&&s.requestVideoFrameCallback(W)}clone(){return new this.constructor(this.image).copy(this)}update(){const s=this.image;"requestVideoFrameCallback"in s===!1&&s.readyState>=s.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}ZS.prototype.isVideoTexture=!0;class JS extends Nr{constructor(s,c,p){super({width:s,height:c}),this.format=p,this.magFilter=It,this.minFilter=It,this.generateMipmaps=!1,this.needsUpdate=!0}}JS.prototype.isFramebufferTexture=!0;class Zx extends Nr{constructor(s,c,p,y,M,C,P,F,U,V,W,j){super(null,C,P,F,U,V,y,M,W,j),this.image={width:c,height:p},this.mipmaps=s,this.flipY=!1,this.generateMipmaps=!1}}Zx.prototype.isCompressedTexture=!0;class eT extends Nr{constructor(s,c,p,y,M,C,P,F,U){super(s,c,p,y,M,C,P,F,U),this.needsUpdate=!0}}eT.prototype.isCanvasTexture=!0;class Sh extends si{constructor(s=1,c=8,p=0,y=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:s,segments:c,thetaStart:p,thetaLength:y},c=Math.max(3,c);const M=[],C=[],P=[],F=[],U=new Ge,V=new Qt;C.push(0,0,0),P.push(0,0,1),F.push(.5,.5);for(let W=0,j=3;W<=c;W++,j+=3){const Y=p+W/c*y;U.x=s*Math.cos(Y),U.y=s*Math.sin(Y),C.push(U.x,U.y,U.z),P.push(0,0,1),V.x=(C[j]/s+1)/2,V.y=(C[j+1]/s+1)/2,F.push(V.x,V.y)}for(let W=1;W<=c;W++)M.push(W,W+1,0);this.setIndex(M),this.setAttribute("position",new Hn(C,3)),this.setAttribute("normal",new Hn(P,3)),this.setAttribute("uv",new Hn(F,2))}static fromJSON(s){return new Sh(s.radius,s.segments,s.thetaStart,s.thetaLength)}}class jl extends si{constructor(s=1,c=1,p=1,y=8,M=1,C=!1,P=0,F=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:s,radiusBottom:c,height:p,radialSegments:y,heightSegments:M,openEnded:C,thetaStart:P,thetaLength:F};const U=this;y=Math.floor(y),M=Math.floor(M);const V=[],W=[],j=[],Y=[];let ee=0;const de=[],xe=p/2;let re=0;Q(),C===!1&&(s>0&&De(!0),c>0&&De(!1)),this.setIndex(V),this.setAttribute("position",new Hn(W,3)),this.setAttribute("normal",new Hn(j,3)),this.setAttribute("uv",new Hn(Y,2));function Q(){const Me=new Ge,Ie=new Ge;let Xe=0;const st=(c-s)/p;for(let ut=0;ut<=M;ut++){const Dt=[],Rt=ut/M,Ee=Rt*(c-s)+s;for(let Ye=0;Ye<=y;Ye++){const vt=Ye/y,Et=vt*F+P,gt=Math.sin(Et),Lt=Math.cos(Et);Ie.x=Ee*gt,Ie.y=-Rt*p+xe,Ie.z=Ee*Lt,W.push(Ie.x,Ie.y,Ie.z),Me.set(gt,st,Lt).normalize(),j.push(Me.x,Me.y,Me.z),Y.push(vt,1-Rt),Dt.push(ee++)}de.push(Dt)}for(let ut=0;ut<y;ut++)for(let Dt=0;Dt<M;Dt++){const Rt=de[Dt][ut],Ee=de[Dt+1][ut],Ye=de[Dt+1][ut+1],vt=de[Dt][ut+1];V.push(Rt,Ee,vt),V.push(Ee,Ye,vt),Xe+=6}U.addGroup(re,Xe,0),re+=Xe}function De(Me){const Ie=ee,Xe=new Qt,st=new Ge;let ut=0;const Dt=Me===!0?s:c,Rt=Me===!0?1:-1;for(let Ye=1;Ye<=y;Ye++)W.push(0,xe*Rt,0),j.push(0,Rt,0),Y.push(.5,.5),ee++;const Ee=ee;for(let Ye=0;Ye<=y;Ye++){const Et=Ye/y*F+P,gt=Math.cos(Et),Lt=Math.sin(Et);st.x=Dt*Lt,st.y=xe*Rt,st.z=Dt*gt,W.push(st.x,st.y,st.z),j.push(0,Rt,0),Xe.x=gt*.5+.5,Xe.y=Lt*.5*Rt+.5,Y.push(Xe.x,Xe.y),ee++}for(let Ye=0;Ye<y;Ye++){const vt=Ie+Ye,Et=Ee+Ye;Me===!0?V.push(Et,Et+1,vt):V.push(Et+1,Et,vt),ut+=3}U.addGroup(re,ut,Me===!0?1:2),re+=ut}}static fromJSON(s){return new jl(s.radiusTop,s.radiusBottom,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength)}}class Th extends jl{constructor(s=1,c=1,p=8,y=1,M=!1,C=0,P=Math.PI*2){super(0,s,c,p,y,M,C,P),this.type="ConeGeometry",this.parameters={radius:s,height:c,radialSegments:p,heightSegments:y,openEnded:M,thetaStart:C,thetaLength:P}}static fromJSON(s){return new Th(s.radius,s.height,s.radialSegments,s.heightSegments,s.openEnded,s.thetaStart,s.thetaLength)}}class ua extends si{constructor(s=[],c=[],p=1,y=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:s,indices:c,radius:p,detail:y};const M=[],C=[];P(y),U(p),V(),this.setAttribute("position",new Hn(M,3)),this.setAttribute("normal",new Hn(M.slice(),3)),this.setAttribute("uv",new Hn(C,2)),y===0?this.computeVertexNormals():this.normalizeNormals();function P(Q){const De=new Ge,Me=new Ge,Ie=new Ge;for(let Xe=0;Xe<c.length;Xe+=3)Y(c[Xe+0],De),Y(c[Xe+1],Me),Y(c[Xe+2],Ie),F(De,Me,Ie,Q)}function F(Q,De,Me,Ie){const Xe=Ie+1,st=[];for(let ut=0;ut<=Xe;ut++){st[ut]=[];const Dt=Q.clone().lerp(Me,ut/Xe),Rt=De.clone().lerp(Me,ut/Xe),Ee=Xe-ut;for(let Ye=0;Ye<=Ee;Ye++)Ye===0&&ut===Xe?st[ut][Ye]=Dt:st[ut][Ye]=Dt.clone().lerp(Rt,Ye/Ee)}for(let ut=0;ut<Xe;ut++)for(let Dt=0;Dt<2*(Xe-ut)-1;Dt++){const Rt=Math.floor(Dt/2);Dt%2===0?(j(st[ut][Rt+1]),j(st[ut+1][Rt]),j(st[ut][Rt])):(j(st[ut][Rt+1]),j(st[ut+1][Rt+1]),j(st[ut+1][Rt]))}}function U(Q){const De=new Ge;for(let Me=0;Me<M.length;Me+=3)De.x=M[Me+0],De.y=M[Me+1],De.z=M[Me+2],De.normalize().multiplyScalar(Q),M[Me+0]=De.x,M[Me+1]=De.y,M[Me+2]=De.z}function V(){const Q=new Ge;for(let De=0;De<M.length;De+=3){Q.x=M[De+0],Q.y=M[De+1],Q.z=M[De+2];const Me=xe(Q)/2/Math.PI+.5,Ie=re(Q)/Math.PI+.5;C.push(Me,1-Ie)}ee(),W()}function W(){for(let Q=0;Q<C.length;Q+=6){const De=C[Q+0],Me=C[Q+2],Ie=C[Q+4],Xe=Math.max(De,Me,Ie),st=Math.min(De,Me,Ie);Xe>.9&&st<.1&&(De<.2&&(C[Q+0]+=1),Me<.2&&(C[Q+2]+=1),Ie<.2&&(C[Q+4]+=1))}}function j(Q){M.push(Q.x,Q.y,Q.z)}function Y(Q,De){const Me=Q*3;De.x=s[Me+0],De.y=s[Me+1],De.z=s[Me+2]}function ee(){const Q=new Ge,De=new Ge,Me=new Ge,Ie=new Ge,Xe=new Qt,st=new Qt,ut=new Qt;for(let Dt=0,Rt=0;Dt<M.length;Dt+=9,Rt+=6){Q.set(M[Dt+0],M[Dt+1],M[Dt+2]),De.set(M[Dt+3],M[Dt+4],M[Dt+5]),Me.set(M[Dt+6],M[Dt+7],M[Dt+8]),Xe.set(C[Rt+0],C[Rt+1]),st.set(C[Rt+2],C[Rt+3]),ut.set(C[Rt+4],C[Rt+5]),Ie.copy(Q).add(De).add(Me).divideScalar(3);const Ee=xe(Ie);de(Xe,Rt+0,Q,Ee),de(st,Rt+2,De,Ee),de(ut,Rt+4,Me,Ee)}}function de(Q,De,Me,Ie){Ie<0&&Q.x===1&&(C[De]=Q.x-1),Me.x===0&&Me.z===0&&(C[De]=Ie/2/Math.PI+.5)}function xe(Q){return Math.atan2(Q.z,-Q.x)}function re(Q){return Math.atan2(-Q.y,Math.sqrt(Q.x*Q.x+Q.z*Q.z))}}static fromJSON(s){return new ua(s.vertices,s.indices,s.radius,s.details)}}class Ch extends ua{constructor(s=1,c=0){const p=(1+Math.sqrt(5))/2,y=1/p,M=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-y,-p,0,-y,p,0,y,-p,0,y,p,-y,-p,0,-y,p,0,y,-p,0,y,p,0,-p,0,-y,p,0,-y,-p,0,y,p,0,y],C=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(M,C,s,c),this.type="DodecahedronGeometry",this.parameters={radius:s,detail:c}}static fromJSON(s){return new Ch(s.radius,s.detail)}}const Hg=new Ge,Gg=new Ge,Jx=new Ge,Vg=new Dr;class e_ extends si{constructor(s=null,c=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:s,thresholdAngle:c},s!==null){const y=Math.pow(10,4),M=Math.cos(zc*c),C=s.getIndex(),P=s.getAttribute("position"),F=C?C.count:P.count,U=[0,0,0],V=["a","b","c"],W=new Array(3),j={},Y=[];for(let ee=0;ee<F;ee+=3){C?(U[0]=C.getX(ee),U[1]=C.getX(ee+1),U[2]=C.getX(ee+2)):(U[0]=ee,U[1]=ee+1,U[2]=ee+2);const{a:de,b:xe,c:re}=Vg;if(de.fromBufferAttribute(P,U[0]),xe.fromBufferAttribute(P,U[1]),re.fromBufferAttribute(P,U[2]),Vg.getNormal(Jx),W[0]=`${Math.round(de.x*y)},${Math.round(de.y*y)},${Math.round(de.z*y)}`,W[1]=`${Math.round(xe.x*y)},${Math.round(xe.y*y)},${Math.round(xe.z*y)}`,W[2]=`${Math.round(re.x*y)},${Math.round(re.y*y)},${Math.round(re.z*y)}`,!(W[0]===W[1]||W[1]===W[2]||W[2]===W[0]))for(let Q=0;Q<3;Q++){const De=(Q+1)%3,Me=W[Q],Ie=W[De],Xe=Vg[V[Q]],st=Vg[V[De]],ut=`${Me}_${Ie}`,Dt=`${Ie}_${Me}`;Dt in j&&j[Dt]?(Jx.dot(j[Dt].normal)<=M&&(Y.push(Xe.x,Xe.y,Xe.z),Y.push(st.x,st.y,st.z)),j[Dt]=null):ut in j||(j[ut]={index0:U[Q],index1:U[De],normal:Jx.clone()})}}for(const ee in j)if(j[ee]){const{index0:de,index1:xe}=j[ee];Hg.fromBufferAttribute(P,de),Gg.fromBufferAttribute(P,xe),Y.push(Hg.x,Hg.y,Hg.z),Y.push(Gg.x,Gg.y,Gg.z)}this.setAttribute("position",new Hn(Y,3))}}}class Ys{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(s,c){const p=this.getUtoTmapping(s);return this.getPoint(p,c)}getPoints(s=5){const c=[];for(let p=0;p<=s;p++)c.push(this.getPoint(p/s));return c}getSpacedPoints(s=5){const c=[];for(let p=0;p<=s;p++)c.push(this.getPointAt(p/s));return c}getLength(){const s=this.getLengths();return s[s.length-1]}getLengths(s=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===s+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let p,y=this.getPoint(0),M=0;c.push(0);for(let C=1;C<=s;C++)p=this.getPoint(C/s),M+=p.distanceTo(y),c.push(M),y=p;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(s,c){const p=this.getLengths();let y=0;const M=p.length;let C;c?C=c:C=s*p[M-1];let P=0,F=M-1,U;for(;P<=F;)if(y=Math.floor(P+(F-P)/2),U=p[y]-C,U<0)P=y+1;else if(U>0)F=y-1;else{F=y;break}if(y=F,p[y]===C)return y/(M-1);const V=p[y],j=p[y+1]-V,Y=(C-V)/j;return(y+Y)/(M-1)}getTangent(s,c){let y=s-1e-4,M=s+1e-4;y<0&&(y=0),M>1&&(M=1);const C=this.getPoint(y),P=this.getPoint(M),F=c||(C.isVector2?new Qt:new Ge);return F.copy(P).sub(C).normalize(),F}getTangentAt(s,c){const p=this.getUtoTmapping(s);return this.getTangent(p,c)}computeFrenetFrames(s,c){const p=new Ge,y=[],M=[],C=[],P=new Ge,F=new zn;for(let Y=0;Y<=s;Y++){const ee=Y/s;y[Y]=this.getTangentAt(ee,new Ge)}M[0]=new Ge,C[0]=new Ge;let U=Number.MAX_VALUE;const V=Math.abs(y[0].x),W=Math.abs(y[0].y),j=Math.abs(y[0].z);V<=U&&(U=V,p.set(1,0,0)),W<=U&&(U=W,p.set(0,1,0)),j<=U&&p.set(0,0,1),P.crossVectors(y[0],p).normalize(),M[0].crossVectors(y[0],P),C[0].crossVectors(y[0],M[0]);for(let Y=1;Y<=s;Y++){if(M[Y]=M[Y-1].clone(),C[Y]=C[Y-1].clone(),P.crossVectors(y[Y-1],y[Y]),P.length()>Number.EPSILON){P.normalize();const ee=Math.acos(ss(y[Y-1].dot(y[Y]),-1,1));M[Y].applyMatrix4(F.makeRotationAxis(P,ee))}C[Y].crossVectors(y[Y],M[Y])}if(c===!0){let Y=Math.acos(ss(M[0].dot(M[s]),-1,1));Y/=s,y[0].dot(P.crossVectors(M[0],M[s]))>0&&(Y=-Y);for(let ee=1;ee<=s;ee++)M[ee].applyMatrix4(F.makeRotationAxis(y[ee],Y*ee)),C[ee].crossVectors(y[ee],M[ee])}return{tangents:y,normals:M,binormals:C}}clone(){return new this.constructor().copy(this)}copy(s){return this.arcLengthDivisions=s.arcLengthDivisions,this}toJSON(){const s={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return s.arcLengthDivisions=this.arcLengthDivisions,s.type=this.type,s}fromJSON(s){return this.arcLengthDivisions=s.arcLengthDivisions,this}}class kf extends Ys{constructor(s=0,c=0,p=1,y=1,M=0,C=Math.PI*2,P=!1,F=0){super(),this.type="EllipseCurve",this.aX=s,this.aY=c,this.xRadius=p,this.yRadius=y,this.aStartAngle=M,this.aEndAngle=C,this.aClockwise=P,this.aRotation=F}getPoint(s,c){const p=c||new Qt,y=Math.PI*2;let M=this.aEndAngle-this.aStartAngle;const C=Math.abs(M)<Number.EPSILON;for(;M<0;)M+=y;for(;M>y;)M-=y;M<Number.EPSILON&&(C?M=0:M=y),this.aClockwise===!0&&!C&&(M===y?M=-y:M=M-y);const P=this.aStartAngle+s*M;let F=this.aX+this.xRadius*Math.cos(P),U=this.aY+this.yRadius*Math.sin(P);if(this.aRotation!==0){const V=Math.cos(this.aRotation),W=Math.sin(this.aRotation),j=F-this.aX,Y=U-this.aY;F=j*V-Y*W+this.aX,U=j*W+Y*V+this.aY}return p.set(F,U)}copy(s){return super.copy(s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this}toJSON(){const s=super.toJSON();return s.aX=this.aX,s.aY=this.aY,s.xRadius=this.xRadius,s.yRadius=this.yRadius,s.aStartAngle=this.aStartAngle,s.aEndAngle=this.aEndAngle,s.aClockwise=this.aClockwise,s.aRotation=this.aRotation,s}fromJSON(s){return super.fromJSON(s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this}}kf.prototype.isEllipseCurve=!0;class t_ extends kf{constructor(s,c,p,y,M,C){super(s,c,p,p,y,M,C),this.type="ArcCurve"}}t_.prototype.isArcCurve=!0;function n_(){let b=0,s=0,c=0,p=0;function y(M,C,P,F){b=M,s=P,c=-3*M+3*C-2*P-F,p=2*M-2*C+P+F}return{initCatmullRom:function(M,C,P,F,U){y(C,P,U*(P-M),U*(F-C))},initNonuniformCatmullRom:function(M,C,P,F,U,V,W){let j=(C-M)/U-(P-M)/(U+V)+(P-C)/V,Y=(P-C)/V-(F-C)/(V+W)+(F-P)/W;j*=V,Y*=V,y(C,P,j,Y)},calc:function(M){const C=M*M,P=C*M;return b+s*M+c*C+p*P}}}const Wg=new Ge,i_=new n_,r_=new n_,s_=new n_;class o_ extends Ys{constructor(s=[],c=!1,p="centripetal",y=.5){super(),this.type="CatmullRomCurve3",this.points=s,this.closed=c,this.curveType=p,this.tension=y}getPoint(s,c=new Ge){const p=c,y=this.points,M=y.length,C=(M-(this.closed?0:1))*s;let P=Math.floor(C),F=C-P;this.closed?P+=P>0?0:(Math.floor(Math.abs(P)/M)+1)*M:F===0&&P===M-1&&(P=M-2,F=1);let U,V;this.closed||P>0?U=y[(P-1)%M]:(Wg.subVectors(y[0],y[1]).add(y[0]),U=Wg);const W=y[P%M],j=y[(P+1)%M];if(this.closed||P+2<M?V=y[(P+2)%M]:(Wg.subVectors(y[M-1],y[M-2]).add(y[M-1]),V=Wg),this.curveType==="centripetal"||this.curveType==="chordal"){const Y=this.curveType==="chordal"?.5:.25;let ee=Math.pow(U.distanceToSquared(W),Y),de=Math.pow(W.distanceToSquared(j),Y),xe=Math.pow(j.distanceToSquared(V),Y);de<1e-4&&(de=1),ee<1e-4&&(ee=de),xe<1e-4&&(xe=de),i_.initNonuniformCatmullRom(U.x,W.x,j.x,V.x,ee,de,xe),r_.initNonuniformCatmullRom(U.y,W.y,j.y,V.y,ee,de,xe),s_.initNonuniformCatmullRom(U.z,W.z,j.z,V.z,ee,de,xe)}else this.curveType==="catmullrom"&&(i_.initCatmullRom(U.x,W.x,j.x,V.x,this.tension),r_.initCatmullRom(U.y,W.y,j.y,V.y,this.tension),s_.initCatmullRom(U.z,W.z,j.z,V.z,this.tension));return p.set(i_.calc(F),r_.calc(F),s_.calc(F)),p}copy(s){super.copy(s),this.points=[];for(let c=0,p=s.points.length;c<p;c++){const y=s.points[c];this.points.push(y.clone())}return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this}toJSON(){const s=super.toJSON();s.points=[];for(let c=0,p=this.points.length;c<p;c++){const y=this.points[c];s.points.push(y.toArray())}return s.closed=this.closed,s.curveType=this.curveType,s.tension=this.tension,s}fromJSON(s){super.fromJSON(s),this.points=[];for(let c=0,p=s.points.length;c<p;c++){const y=s.points[c];this.points.push(new Ge().fromArray(y))}return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this}}o_.prototype.isCatmullRomCurve3=!0;function tT(b,s,c,p,y){const M=(p-s)*.5,C=(y-c)*.5,P=b*b,F=b*P;return(2*c-2*p+M+C)*F+(-3*c+3*p-2*M-C)*P+M*b+c}function N5(b,s){const c=1-b;return c*c*s}function F5(b,s){return 2*(1-b)*b*s}function B5(b,s){return b*b*s}function Nf(b,s,c,p){return N5(b,s)+F5(b,c)+B5(b,p)}function U5(b,s){const c=1-b;return c*c*c*s}function z5(b,s){const c=1-b;return 3*c*c*b*s}function H5(b,s){return 3*(1-b)*b*b*s}function G5(b,s){return b*b*b*s}function Ff(b,s,c,p,y){return U5(b,s)+z5(b,c)+H5(b,p)+G5(b,y)}class jg extends Ys{constructor(s=new Qt,c=new Qt,p=new Qt,y=new Qt){super(),this.type="CubicBezierCurve",this.v0=s,this.v1=c,this.v2=p,this.v3=y}getPoint(s,c=new Qt){const p=c,y=this.v0,M=this.v1,C=this.v2,P=this.v3;return p.set(Ff(s,y.x,M.x,C.x,P.x),Ff(s,y.y,M.y,C.y,P.y)),p}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this}}jg.prototype.isCubicBezierCurve=!0;class a_ extends Ys{constructor(s=new Ge,c=new Ge,p=new Ge,y=new Ge){super(),this.type="CubicBezierCurve3",this.v0=s,this.v1=c,this.v2=p,this.v3=y}getPoint(s,c=new Ge){const p=c,y=this.v0,M=this.v1,C=this.v2,P=this.v3;return p.set(Ff(s,y.x,M.x,C.x,P.x),Ff(s,y.y,M.y,C.y,P.y),Ff(s,y.z,M.z,C.z,P.z)),p}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this}}a_.prototype.isCubicBezierCurve3=!0;class Bf extends Ys{constructor(s=new Qt,c=new Qt){super(),this.type="LineCurve",this.v1=s,this.v2=c}getPoint(s,c=new Qt){const p=c;return s===1?p.copy(this.v2):(p.copy(this.v2).sub(this.v1),p.multiplyScalar(s).add(this.v1)),p}getPointAt(s,c){return this.getPoint(s,c)}getTangent(s,c){const p=c||new Qt;return p.copy(this.v2).sub(this.v1).normalize(),p}copy(s){return super.copy(s),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}Bf.prototype.isLineCurve=!0;class nT extends Ys{constructor(s=new Ge,c=new Ge){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=s,this.v2=c}getPoint(s,c=new Ge){const p=c;return s===1?p.copy(this.v2):(p.copy(this.v2).sub(this.v1),p.multiplyScalar(s).add(this.v1)),p}getPointAt(s,c){return this.getPoint(s,c)}copy(s){return super.copy(s),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}class $g extends Ys{constructor(s=new Qt,c=new Qt,p=new Qt){super(),this.type="QuadraticBezierCurve",this.v0=s,this.v1=c,this.v2=p}getPoint(s,c=new Qt){const p=c,y=this.v0,M=this.v1,C=this.v2;return p.set(Nf(s,y.x,M.x,C.x),Nf(s,y.y,M.y,C.y)),p}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}$g.prototype.isQuadraticBezierCurve=!0;class Xg extends Ys{constructor(s=new Ge,c=new Ge,p=new Ge){super(),this.type="QuadraticBezierCurve3",this.v0=s,this.v1=c,this.v2=p}getPoint(s,c=new Ge){const p=c,y=this.v0,M=this.v1,C=this.v2;return p.set(Nf(s,y.x,M.x,C.x),Nf(s,y.y,M.y,C.y),Nf(s,y.z,M.z,C.z)),p}copy(s){return super.copy(s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this}toJSON(){const s=super.toJSON();return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s}fromJSON(s){return super.fromJSON(s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this}}Xg.prototype.isQuadraticBezierCurve3=!0;class qg extends Ys{constructor(s=[]){super(),this.type="SplineCurve",this.points=s}getPoint(s,c=new Qt){const p=c,y=this.points,M=(y.length-1)*s,C=Math.floor(M),P=M-C,F=y[C===0?C:C-1],U=y[C],V=y[C>y.length-2?y.length-1:C+1],W=y[C>y.length-3?y.length-1:C+2];return p.set(tT(P,F.x,U.x,V.x,W.x),tT(P,F.y,U.y,V.y,W.y)),p}copy(s){super.copy(s),this.points=[];for(let c=0,p=s.points.length;c<p;c++){const y=s.points[c];this.points.push(y.clone())}return this}toJSON(){const s=super.toJSON();s.points=[];for(let c=0,p=this.points.length;c<p;c++){const y=this.points[c];s.points.push(y.toArray())}return s}fromJSON(s){super.fromJSON(s),this.points=[];for(let c=0,p=s.points.length;c<p;c++){const y=s.points[c];this.points.push(new Qt().fromArray(y))}return this}}qg.prototype.isSplineCurve=!0;var l_=Object.freeze({__proto__:null,ArcCurve:t_,CatmullRomCurve3:o_,CubicBezierCurve:jg,CubicBezierCurve3:a_,EllipseCurve:kf,LineCurve:Bf,LineCurve3:nT,QuadraticBezierCurve:$g,QuadraticBezierCurve3:Xg,SplineCurve:qg});class iT extends Ys{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(s){this.curves.push(s)}closePath(){const s=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);s.equals(c)||this.curves.push(new Bf(c,s))}getPoint(s,c){const p=s*this.getLength(),y=this.getCurveLengths();let M=0;for(;M<y.length;){if(y[M]>=p){const C=y[M]-p,P=this.curves[M],F=P.getLength(),U=F===0?0:1-C/F;return P.getPointAt(U,c)}M++}return null}getLength(){const s=this.getCurveLengths();return s[s.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const s=[];let c=0;for(let p=0,y=this.curves.length;p<y;p++)c+=this.curves[p].getLength(),s.push(c);return this.cacheLengths=s,s}getSpacedPoints(s=40){const c=[];for(let p=0;p<=s;p++)c.push(this.getPoint(p/s));return this.autoClose&&c.push(c[0]),c}getPoints(s=12){const c=[];let p;for(let y=0,M=this.curves;y<M.length;y++){const C=M[y],P=C&&C.isEllipseCurve?s*2:C&&(C.isLineCurve||C.isLineCurve3)?1:C&&C.isSplineCurve?s*C.points.length:s,F=C.getPoints(P);for(let U=0;U<F.length;U++){const V=F[U];p&&p.equals(V)||(c.push(V),p=V)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(s){super.copy(s),this.curves=[];for(let c=0,p=s.curves.length;c<p;c++){const y=s.curves[c];this.curves.push(y.clone())}return this.autoClose=s.autoClose,this}toJSON(){const s=super.toJSON();s.autoClose=this.autoClose,s.curves=[];for(let c=0,p=this.curves.length;c<p;c++){const y=this.curves[c];s.curves.push(y.toJSON())}return s}fromJSON(s){super.fromJSON(s),this.autoClose=s.autoClose,this.curves=[];for(let c=0,p=s.curves.length;c<p;c++){const y=s.curves[c];this.curves.push(new l_[y.type]().fromJSON(y))}return this}}class Uf extends iT{constructor(s){super(),this.type="Path",this.currentPoint=new Qt,s&&this.setFromPoints(s)}setFromPoints(s){this.moveTo(s[0].x,s[0].y);for(let c=1,p=s.length;c<p;c++)this.lineTo(s[c].x,s[c].y);return this}moveTo(s,c){return this.currentPoint.set(s,c),this}lineTo(s,c){const p=new Bf(this.currentPoint.clone(),new Qt(s,c));return this.curves.push(p),this.currentPoint.set(s,c),this}quadraticCurveTo(s,c,p,y){const M=new $g(this.currentPoint.clone(),new Qt(s,c),new Qt(p,y));return this.curves.push(M),this.currentPoint.set(p,y),this}bezierCurveTo(s,c,p,y,M,C){const P=new jg(this.currentPoint.clone(),new Qt(s,c),new Qt(p,y),new Qt(M,C));return this.curves.push(P),this.currentPoint.set(M,C),this}splineThru(s){const c=[this.currentPoint.clone()].concat(s),p=new qg(c);return this.curves.push(p),this.currentPoint.copy(s[s.length-1]),this}arc(s,c,p,y,M,C){const P=this.currentPoint.x,F=this.currentPoint.y;return this.absarc(s+P,c+F,p,y,M,C),this}absarc(s,c,p,y,M,C){return this.absellipse(s,c,p,p,y,M,C),this}ellipse(s,c,p,y,M,C,P,F){const U=this.currentPoint.x,V=this.currentPoint.y;return this.absellipse(s+U,c+V,p,y,M,C,P,F),this}absellipse(s,c,p,y,M,C,P,F){const U=new kf(s,c,p,y,M,C,P,F);if(this.curves.length>0){const W=U.getPoint(0);W.equals(this.currentPoint)||this.lineTo(W.x,W.y)}this.curves.push(U);const V=U.getPoint(1);return this.currentPoint.copy(V),this}copy(s){return super.copy(s),this.currentPoint.copy(s.currentPoint),this}toJSON(){const s=super.toJSON();return s.currentPoint=this.currentPoint.toArray(),s}fromJSON(s){return super.fromJSON(s),this.currentPoint.fromArray(s.currentPoint),this}}class ha extends Uf{constructor(s){super(s),this.uuid=Ws(),this.type="Shape",this.holes=[]}getPointsHoles(s){const c=[];for(let p=0,y=this.holes.length;p<y;p++)c[p]=this.holes[p].getPoints(s);return c}extractPoints(s){return{shape:this.getPoints(s),holes:this.getPointsHoles(s)}}copy(s){super.copy(s),this.holes=[];for(let c=0,p=s.holes.length;c<p;c++){const y=s.holes[c];this.holes.push(y.clone())}return this}toJSON(){const s=super.toJSON();s.uuid=this.uuid,s.holes=[];for(let c=0,p=this.holes.length;c<p;c++){const y=this.holes[c];s.holes.push(y.toJSON())}return s}fromJSON(s){super.fromJSON(s),this.uuid=s.uuid,this.holes=[];for(let c=0,p=s.holes.length;c<p;c++){const y=s.holes[c];this.holes.push(new Uf().fromJSON(y))}return this}}const V5={triangulate:function(b,s,c=2){const p=s&&s.length,y=p?s[0]*c:b.length;let M=rT(b,0,y,c,!0);const C=[];if(!M||M.next===M.prev)return C;let P,F,U,V,W,j,Y;if(p&&(M=q5(b,s,M,c)),b.length>80*c){P=U=b[0],F=V=b[1];for(let ee=c;ee<y;ee+=c)W=b[ee],j=b[ee+1],W<P&&(P=W),j<F&&(F=j),W>U&&(U=W),j>V&&(V=j);Y=Math.max(U-P,V-F),Y=Y!==0?1/Y:0}return zf(M,C,c,P,F,Y),C}};function rT(b,s,c,p,y){let M,C;if(y===sU(b,s,c,p)>0)for(M=s;M<c;M+=p)C=aT(M,b[M],b[M+1],C);else for(M=c-p;M>=s;M-=p)C=aT(M,b[M],b[M+1],C);return C&&Yg(C,C.next)&&(Gf(C),C=C.next),C}function $l(b,s){if(!b)return b;s||(s=b);let c=b,p;do if(p=!1,!c.steiner&&(Yg(c,c.next)||vr(c.prev,c,c.next)===0)){if(Gf(c),c=s=c.prev,c===c.next)break;p=!0}else c=c.next;while(p||c!==s);return s}function zf(b,s,c,p,y,M,C){if(!b)return;!C&&M&&J5(b,p,y,M);let P=b,F,U;for(;b.prev!==b.next;){if(F=b.prev,U=b.next,M?j5(b,p,y,M):W5(b)){s.push(F.i/c),s.push(b.i/c),s.push(U.i/c),Gf(b),b=U.next,P=U.next;continue}if(b=U,b===P){C?C===1?(b=$5($l(b),s,c),zf(b,s,c,p,y,M,2)):C===2&&X5(b,s,c,p,y,M):zf($l(b),s,c,p,y,M,1);break}}}function W5(b){const s=b.prev,c=b,p=b.next;if(vr(s,c,p)>=0)return!1;let y=b.next.next;for(;y!==b.prev;){if(Rh(s.x,s.y,c.x,c.y,p.x,p.y,y.x,y.y)&&vr(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function j5(b,s,c,p){const y=b.prev,M=b,C=b.next;if(vr(y,M,C)>=0)return!1;const P=y.x<M.x?y.x<C.x?y.x:C.x:M.x<C.x?M.x:C.x,F=y.y<M.y?y.y<C.y?y.y:C.y:M.y<C.y?M.y:C.y,U=y.x>M.x?y.x>C.x?y.x:C.x:M.x>C.x?M.x:C.x,V=y.y>M.y?y.y>C.y?y.y:C.y:M.y>C.y?M.y:C.y,W=c_(P,F,s,c,p),j=c_(U,V,s,c,p);let Y=b.prevZ,ee=b.nextZ;for(;Y&&Y.z>=W&&ee&&ee.z<=j;){if(Y!==b.prev&&Y!==b.next&&Rh(y.x,y.y,M.x,M.y,C.x,C.y,Y.x,Y.y)&&vr(Y.prev,Y,Y.next)>=0||(Y=Y.prevZ,ee!==b.prev&&ee!==b.next&&Rh(y.x,y.y,M.x,M.y,C.x,C.y,ee.x,ee.y)&&vr(ee.prev,ee,ee.next)>=0))return!1;ee=ee.nextZ}for(;Y&&Y.z>=W;){if(Y!==b.prev&&Y!==b.next&&Rh(y.x,y.y,M.x,M.y,C.x,C.y,Y.x,Y.y)&&vr(Y.prev,Y,Y.next)>=0)return!1;Y=Y.prevZ}for(;ee&&ee.z<=j;){if(ee!==b.prev&&ee!==b.next&&Rh(y.x,y.y,M.x,M.y,C.x,C.y,ee.x,ee.y)&&vr(ee.prev,ee,ee.next)>=0)return!1;ee=ee.nextZ}return!0}function $5(b,s,c){let p=b;do{const y=p.prev,M=p.next.next;!Yg(y,M)&&sT(y,p,p.next,M)&&Hf(y,M)&&Hf(M,y)&&(s.push(y.i/c),s.push(p.i/c),s.push(M.i/c),Gf(p),Gf(p.next),p=b=M),p=p.next}while(p!==b);return $l(p)}function X5(b,s,c,p,y,M){let C=b;do{let P=C.next.next;for(;P!==C.prev;){if(C.i!==P.i&&nU(C,P)){let F=oT(C,P);C=$l(C,C.next),F=$l(F,F.next),zf(C,s,c,p,y,M),zf(F,s,c,p,y,M);return}P=P.next}C=C.next}while(C!==b)}function q5(b,s,c,p){const y=[];let M,C,P,F,U;for(M=0,C=s.length;M<C;M++)P=s[M]*p,F=M<C-1?s[M+1]*p:b.length,U=rT(b,P,F,p,!1),U===U.next&&(U.steiner=!0),y.push(tU(U));for(y.sort(Y5),M=0;M<y.length;M++)K5(y[M],c),c=$l(c,c.next);return c}function Y5(b,s){return b.x-s.x}function K5(b,s){if(s=Q5(b,s),s){const c=oT(s,b);$l(s,s.next),$l(c,c.next)}}function Q5(b,s){let c=s;const p=b.x,y=b.y;let M=-1/0,C;do{if(y<=c.y&&y>=c.next.y&&c.next.y!==c.y){const j=c.x+(y-c.y)*(c.next.x-c.x)/(c.next.y-c.y);if(j<=p&&j>M){if(M=j,j===p){if(y===c.y)return c;if(y===c.next.y)return c.next}C=c.x<c.next.x?c:c.next}}c=c.next}while(c!==s);if(!C)return null;if(p===M)return C;const P=C,F=C.x,U=C.y;let V=1/0,W;c=C;do p>=c.x&&c.x>=F&&p!==c.x&&Rh(y<U?p:M,y,F,U,y<U?M:p,y,c.x,c.y)&&(W=Math.abs(y-c.y)/(p-c.x),Hf(c,b)&&(W<V||W===V&&(c.x>C.x||c.x===C.x&&Z5(C,c)))&&(C=c,V=W)),c=c.next;while(c!==P);return C}function Z5(b,s){return vr(b.prev,b,s.prev)<0&&vr(s.next,b,b.next)<0}function J5(b,s,c,p){let y=b;do y.z===null&&(y.z=c_(y.x,y.y,s,c,p)),y.prevZ=y.prev,y.nextZ=y.next,y=y.next;while(y!==b);y.prevZ.nextZ=null,y.prevZ=null,eU(y)}function eU(b){let s,c,p,y,M,C,P,F,U=1;do{for(c=b,b=null,M=null,C=0;c;){for(C++,p=c,P=0,s=0;s<U&&(P++,p=p.nextZ,!!p);s++);for(F=U;P>0||F>0&&p;)P!==0&&(F===0||!p||c.z<=p.z)?(y=c,c=c.nextZ,P--):(y=p,p=p.nextZ,F--),M?M.nextZ=y:b=y,y.prevZ=M,M=y;c=p}M.nextZ=null,U*=2}while(C>1);return b}function c_(b,s,c,p,y){return b=32767*(b-c)*y,s=32767*(s-p)*y,b=(b|b<<8)&16711935,b=(b|b<<4)&252645135,b=(b|b<<2)&858993459,b=(b|b<<1)&1431655765,s=(s|s<<8)&16711935,s=(s|s<<4)&252645135,s=(s|s<<2)&858993459,s=(s|s<<1)&1431655765,b|s<<1}function tU(b){let s=b,c=b;do(s.x<c.x||s.x===c.x&&s.y<c.y)&&(c=s),s=s.next;while(s!==b);return c}function Rh(b,s,c,p,y,M,C,P){return(y-C)*(s-P)-(b-C)*(M-P)>=0&&(b-C)*(p-P)-(c-C)*(s-P)>=0&&(c-C)*(M-P)-(y-C)*(p-P)>=0}function nU(b,s){return b.next.i!==s.i&&b.prev.i!==s.i&&!iU(b,s)&&(Hf(b,s)&&Hf(s,b)&&rU(b,s)&&(vr(b.prev,b,s.prev)||vr(b,s.prev,s))||Yg(b,s)&&vr(b.prev,b,b.next)>0&&vr(s.prev,s,s.next)>0)}function vr(b,s,c){return(s.y-b.y)*(c.x-s.x)-(s.x-b.x)*(c.y-s.y)}function Yg(b,s){return b.x===s.x&&b.y===s.y}function sT(b,s,c,p){const y=Qg(vr(b,s,c)),M=Qg(vr(b,s,p)),C=Qg(vr(c,p,b)),P=Qg(vr(c,p,s));return!!(y!==M&&C!==P||y===0&&Kg(b,c,s)||M===0&&Kg(b,p,s)||C===0&&Kg(c,b,p)||P===0&&Kg(c,s,p))}function Kg(b,s,c){return s.x<=Math.max(b.x,c.x)&&s.x>=Math.min(b.x,c.x)&&s.y<=Math.max(b.y,c.y)&&s.y>=Math.min(b.y,c.y)}function Qg(b){return b>0?1:b<0?-1:0}function iU(b,s){let c=b;do{if(c.i!==b.i&&c.next.i!==b.i&&c.i!==s.i&&c.next.i!==s.i&&sT(c,c.next,b,s))return!0;c=c.next}while(c!==b);return!1}function Hf(b,s){return vr(b.prev,b,b.next)<0?vr(b,s,b.next)>=0&&vr(b,b.prev,s)>=0:vr(b,s,b.prev)<0||vr(b,b.next,s)<0}function rU(b,s){let c=b,p=!1;const y=(b.x+s.x)/2,M=(b.y+s.y)/2;do c.y>M!=c.next.y>M&&c.next.y!==c.y&&y<(c.next.x-c.x)*(M-c.y)/(c.next.y-c.y)+c.x&&(p=!p),c=c.next;while(c!==b);return p}function oT(b,s){const c=new u_(b.i,b.x,b.y),p=new u_(s.i,s.x,s.y),y=b.next,M=s.prev;return b.next=s,s.prev=b,c.next=y,y.prev=c,p.next=c,c.prev=p,M.next=p,p.prev=M,p}function aT(b,s,c,p){const y=new u_(b,s,c);return p?(y.next=p.next,y.prev=p,p.next.prev=y,p.next=y):(y.prev=y,y.next=y),y}function Gf(b){b.next.prev=b.prev,b.prev.next=b.next,b.prevZ&&(b.prevZ.nextZ=b.nextZ),b.nextZ&&(b.nextZ.prevZ=b.prevZ)}function u_(b,s,c){this.i=b,this.x=s,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function sU(b,s,c,p){let y=0;for(let M=s,C=c-p;M<c;M+=p)y+=(b[C]-b[M])*(b[M+1]+b[C+1]),C=M;return y}class da{static area(s){const c=s.length;let p=0;for(let y=c-1,M=0;M<c;y=M++)p+=s[y].x*s[M].y-s[M].x*s[y].y;return p*.5}static isClockWise(s){return da.area(s)<0}static triangulateShape(s,c){const p=[],y=[],M=[];lT(s),cT(p,s);let C=s.length;c.forEach(lT);for(let F=0;F<c.length;F++)y.push(C),C+=c[F].length,cT(p,c[F]);const P=V5.triangulate(p,y);for(let F=0;F<P.length;F+=3)M.push(P.slice(F,F+3));return M}}function lT(b){const s=b.length;s>2&&b[s-1].equals(b[0])&&b.pop()}function cT(b,s){for(let c=0;c<s.length;c++)b.push(s[c].x),b.push(s[c].y)}class fa extends si{constructor(s=new ha([new Qt(.5,.5),new Qt(-.5,.5),new Qt(-.5,-.5),new Qt(.5,-.5)]),c={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:s,options:c},s=Array.isArray(s)?s:[s];const p=this,y=[],M=[];for(let P=0,F=s.length;P<F;P++){const U=s[P];C(U)}this.setAttribute("position",new Hn(y,3)),this.setAttribute("uv",new Hn(M,2)),this.computeVertexNormals();function C(P){const F=[],U=c.curveSegments!==void 0?c.curveSegments:12,V=c.steps!==void 0?c.steps:1;let W=c.depth!==void 0?c.depth:1,j=c.bevelEnabled!==void 0?c.bevelEnabled:!0,Y=c.bevelThickness!==void 0?c.bevelThickness:.2,ee=c.bevelSize!==void 0?c.bevelSize:Y-.1,de=c.bevelOffset!==void 0?c.bevelOffset:0,xe=c.bevelSegments!==void 0?c.bevelSegments:3;const re=c.extrudePath,Q=c.UVGenerator!==void 0?c.UVGenerator:oU;c.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),W=c.amount);let De,Me=!1,Ie,Xe,st,ut;re&&(De=re.getSpacedPoints(V),Me=!0,j=!1,Ie=re.computeFrenetFrames(V,!1),Xe=new Ge,st=new Ge,ut=new Ge),j||(xe=0,Y=0,ee=0,de=0);const Dt=P.extractPoints(U);let Rt=Dt.shape;const Ee=Dt.holes;if(!da.isClockWise(Rt)){Rt=Rt.reverse();for(let $t=0,vn=Ee.length;$t<vn;$t++){const xn=Ee[$t];da.isClockWise(xn)&&(Ee[$t]=xn.reverse())}}const vt=da.triangulateShape(Rt,Ee),Et=Rt;for(let $t=0,vn=Ee.length;$t<vn;$t++){const xn=Ee[$t];Rt=Rt.concat(xn)}function gt($t,vn,xn){return vn||console.error("THREE.ExtrudeGeometry: vec does not exist"),vn.clone().multiplyScalar(xn).add($t)}const Lt=Rt.length,Vt=vt.length;function on($t,vn,xn){let Gn,Ln,vi;const pi=$t.x-vn.x,Fi=$t.y-vn.y,cr=xn.x-$t.x,ir=xn.y-$t.y,Ke=pi*pi+Fi*Fi,je=pi*ir-Fi*cr;if(Math.abs(je)>Number.EPSILON){const Xt=Math.sqrt(Ke),yn=Math.sqrt(cr*cr+ir*ir),qn=vn.x-Fi/Xt,jt=vn.y+pi/Xt,ii=xn.x-ir/yn,Zn=xn.y+cr/yn,Pn=((ii-qn)*ir-(Zn-jt)*cr)/(pi*ir-Fi*cr);Gn=qn+pi*Pn-$t.x,Ln=jt+Fi*Pn-$t.y;const wn=Gn*Gn+Ln*Ln;if(wn<=2)return new Qt(Gn,Ln);vi=Math.sqrt(wn/2)}else{let Xt=!1;pi>Number.EPSILON?cr>Number.EPSILON&&(Xt=!0):pi<-Number.EPSILON?cr<-Number.EPSILON&&(Xt=!0):Math.sign(Fi)===Math.sign(ir)&&(Xt=!0),Xt?(Gn=-Fi,Ln=pi,vi=Math.sqrt(Ke)):(Gn=pi,Ln=Fi,vi=Math.sqrt(Ke/2))}return new Qt(Gn/vi,Ln/vi)}const Cn=[];for(let $t=0,vn=Et.length,xn=vn-1,Gn=$t+1;$t<vn;$t++,xn++,Gn++)xn===vn&&(xn=0),Gn===vn&&(Gn=0),Cn[$t]=on(Et[$t],Et[xn],Et[Gn]);const Qn=[];let Dn,Yt=Cn.concat();for(let $t=0,vn=Ee.length;$t<vn;$t++){const xn=Ee[$t];Dn=[];for(let Gn=0,Ln=xn.length,vi=Ln-1,pi=Gn+1;Gn<Ln;Gn++,vi++,pi++)vi===Ln&&(vi=0),pi===Ln&&(pi=0),Dn[Gn]=on(xn[Gn],xn[vi],xn[pi]);Qn.push(Dn),Yt=Yt.concat(Dn)}for(let $t=0;$t<xe;$t++){const vn=$t/xe,xn=Y*Math.cos(vn*Math.PI/2),Gn=ee*Math.sin(vn*Math.PI/2)+de;for(let Ln=0,vi=Et.length;Ln<vi;Ln++){const pi=gt(Et[Ln],Cn[Ln],Gn);Nn(pi.x,pi.y,-xn)}for(let Ln=0,vi=Ee.length;Ln<vi;Ln++){const pi=Ee[Ln];Dn=Qn[Ln];for(let Fi=0,cr=pi.length;Fi<cr;Fi++){const ir=gt(pi[Fi],Dn[Fi],Gn);Nn(ir.x,ir.y,-xn)}}}const gn=ee+de;for(let $t=0;$t<Lt;$t++){const vn=j?gt(Rt[$t],Yt[$t],gn):Rt[$t];Me?(st.copy(Ie.normals[0]).multiplyScalar(vn.x),Xe.copy(Ie.binormals[0]).multiplyScalar(vn.y),ut.copy(De[0]).add(st).add(Xe),Nn(ut.x,ut.y,ut.z)):Nn(vn.x,vn.y,0)}for(let $t=1;$t<=V;$t++)for(let vn=0;vn<Lt;vn++){const xn=j?gt(Rt[vn],Yt[vn],gn):Rt[vn];Me?(st.copy(Ie.normals[$t]).multiplyScalar(xn.x),Xe.copy(Ie.binormals[$t]).multiplyScalar(xn.y),ut.copy(De[$t]).add(st).add(Xe),Nn(ut.x,ut.y,ut.z)):Nn(xn.x,xn.y,W/V*$t)}for(let $t=xe-1;$t>=0;$t--){const vn=$t/xe,xn=Y*Math.cos(vn*Math.PI/2),Gn=ee*Math.sin(vn*Math.PI/2)+de;for(let Ln=0,vi=Et.length;Ln<vi;Ln++){const pi=gt(Et[Ln],Cn[Ln],Gn);Nn(pi.x,pi.y,W+xn)}for(let Ln=0,vi=Ee.length;Ln<vi;Ln++){const pi=Ee[Ln];Dn=Qn[Ln];for(let Fi=0,cr=pi.length;Fi<cr;Fi++){const ir=gt(pi[Fi],Dn[Fi],Gn);Me?Nn(ir.x,ir.y+De[V-1].y,De[V-1].x+xn):Nn(ir.x,ir.y,W+xn)}}}ni(),ht();function ni(){const $t=y.length/3;if(j){let vn=0,xn=Lt*vn;for(let Gn=0;Gn<Vt;Gn++){const Ln=vt[Gn];li(Ln[2]+xn,Ln[1]+xn,Ln[0]+xn)}vn=V+xe*2,xn=Lt*vn;for(let Gn=0;Gn<Vt;Gn++){const Ln=vt[Gn];li(Ln[0]+xn,Ln[1]+xn,Ln[2]+xn)}}else{for(let vn=0;vn<Vt;vn++){const xn=vt[vn];li(xn[2],xn[1],xn[0])}for(let vn=0;vn<Vt;vn++){const xn=vt[vn];li(xn[0]+Lt*V,xn[1]+Lt*V,xn[2]+Lt*V)}}p.addGroup($t,y.length/3-$t,0)}function ht(){const $t=y.length/3;let vn=0;ai(Et,vn),vn+=Et.length;for(let xn=0,Gn=Ee.length;xn<Gn;xn++){const Ln=Ee[xn];ai(Ln,vn),vn+=Ln.length}p.addGroup($t,y.length/3-$t,1)}function ai($t,vn){let xn=$t.length;for(;--xn>=0;){const Gn=xn;let Ln=xn-1;Ln<0&&(Ln=$t.length-1);for(let vi=0,pi=V+xe*2;vi<pi;vi++){const Fi=Lt*vi,cr=Lt*(vi+1),ir=vn+Gn+Fi,Ke=vn+Ln+Fi,je=vn+Ln+cr,Xt=vn+Gn+cr;On(ir,Ke,je,Xt)}}}function Nn($t,vn,xn){F.push($t),F.push(vn),F.push(xn)}function li($t,vn,xn){Ai($t),Ai(vn),Ai(xn);const Gn=y.length/3,Ln=Q.generateTopUV(p,y,Gn-3,Gn-2,Gn-1);ci(Ln[0]),ci(Ln[1]),ci(Ln[2])}function On($t,vn,xn,Gn){Ai($t),Ai(vn),Ai(Gn),Ai(vn),Ai(xn),Ai(Gn);const Ln=y.length/3,vi=Q.generateSideWallUV(p,y,Ln-6,Ln-3,Ln-2,Ln-1);ci(vi[0]),ci(vi[1]),ci(vi[3]),ci(vi[1]),ci(vi[2]),ci(vi[3])}function Ai($t){y.push(F[$t*3+0]),y.push(F[$t*3+1]),y.push(F[$t*3+2])}function ci($t){M.push($t.x),M.push($t.y)}}}toJSON(){const s=super.toJSON(),c=this.parameters.shapes,p=this.parameters.options;return aU(c,p,s)}static fromJSON(s,c){const p=[];for(let M=0,C=s.shapes.length;M<C;M++){const P=c[s.shapes[M]];p.push(P)}const y=s.options.extrudePath;return y!==void 0&&(s.options.extrudePath=new l_[y.type]().fromJSON(y)),new fa(p,s.options)}}const oU={generateTopUV:function(b,s,c,p,y){const M=s[c*3],C=s[c*3+1],P=s[p*3],F=s[p*3+1],U=s[y*3],V=s[y*3+1];return[new Qt(M,C),new Qt(P,F),new Qt(U,V)]},generateSideWallUV:function(b,s,c,p,y,M){const C=s[c*3],P=s[c*3+1],F=s[c*3+2],U=s[p*3],V=s[p*3+1],W=s[p*3+2],j=s[y*3],Y=s[y*3+1],ee=s[y*3+2],de=s[M*3],xe=s[M*3+1],re=s[M*3+2];return Math.abs(P-V)<Math.abs(C-U)?[new Qt(C,1-F),new Qt(U,1-W),new Qt(j,1-ee),new Qt(de,1-re)]:[new Qt(P,1-F),new Qt(V,1-W),new Qt(Y,1-ee),new Qt(xe,1-re)]}};function aU(b,s,c){if(c.shapes=[],Array.isArray(b))for(let p=0,y=b.length;p<y;p++){const M=b[p];c.shapes.push(M.uuid)}else c.shapes.push(b.uuid);return s.extrudePath!==void 0&&(c.options.extrudePath=s.extrudePath.toJSON()),c}class Lh extends ua{constructor(s=1,c=0){const p=(1+Math.sqrt(5))/2,y=[-1,p,0,1,p,0,-1,-p,0,1,-p,0,0,-1,p,0,1,p,0,-1,-p,0,1,-p,p,0,-1,p,0,1,-p,0,-1,-p,0,1],M=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(y,M,s,c),this.type="IcosahedronGeometry",this.parameters={radius:s,detail:c}}static fromJSON(s){return new Lh(s.radius,s.detail)}}class Ph extends si{constructor(s=[new Qt(0,.5),new Qt(.5,0),new Qt(0,-.5)],c=12,p=0,y=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:s,segments:c,phiStart:p,phiLength:y},c=Math.floor(c),y=ss(y,0,Math.PI*2);const M=[],C=[],P=[],F=[],U=[],V=1/c,W=new Ge,j=new Qt,Y=new Ge,ee=new Ge,de=new Ge;let xe=0,re=0;for(let Q=0;Q<=s.length-1;Q++)switch(Q){case 0:xe=s[Q+1].x-s[Q].x,re=s[Q+1].y-s[Q].y,Y.x=re*1,Y.y=-xe,Y.z=re*0,de.copy(Y),Y.normalize(),F.push(Y.x,Y.y,Y.z);break;case s.length-1:F.push(de.x,de.y,de.z);break;default:xe=s[Q+1].x-s[Q].x,re=s[Q+1].y-s[Q].y,Y.x=re*1,Y.y=-xe,Y.z=re*0,ee.copy(Y),Y.x+=de.x,Y.y+=de.y,Y.z+=de.z,Y.normalize(),F.push(Y.x,Y.y,Y.z),de.copy(ee)}for(let Q=0;Q<=c;Q++){const De=p+Q*V*y,Me=Math.sin(De),Ie=Math.cos(De);for(let Xe=0;Xe<=s.length-1;Xe++){W.x=s[Xe].x*Me,W.y=s[Xe].y,W.z=s[Xe].x*Ie,C.push(W.x,W.y,W.z),j.x=Q/c,j.y=Xe/(s.length-1),P.push(j.x,j.y);const st=F[3*Xe+0]*Me,ut=F[3*Xe+1],Dt=F[3*Xe+0]*Ie;U.push(st,ut,Dt)}}for(let Q=0;Q<c;Q++)for(let De=0;De<s.length-1;De++){const Me=De+Q*s.length,Ie=Me,Xe=Me+s.length,st=Me+s.length+1,ut=Me+1;M.push(Ie,Xe,ut),M.push(st,ut,Xe)}this.setIndex(M),this.setAttribute("position",new Hn(C,3)),this.setAttribute("uv",new Hn(P,2)),this.setAttribute("normal",new Hn(U,3))}static fromJSON(s){return new Ph(s.points,s.segments,s.phiStart,s.phiLength)}}class Qc extends ua{constructor(s=1,c=0){const p=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],y=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(p,y,s,c),this.type="OctahedronGeometry",this.parameters={radius:s,detail:c}}static fromJSON(s){return new Qc(s.radius,s.detail)}}class Dh extends si{constructor(s=.5,c=1,p=8,y=1,M=0,C=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:s,outerRadius:c,thetaSegments:p,phiSegments:y,thetaStart:M,thetaLength:C},p=Math.max(3,p),y=Math.max(1,y);const P=[],F=[],U=[],V=[];let W=s;const j=(c-s)/y,Y=new Ge,ee=new Qt;for(let de=0;de<=y;de++){for(let xe=0;xe<=p;xe++){const re=M+xe/p*C;Y.x=W*Math.cos(re),Y.y=W*Math.sin(re),F.push(Y.x,Y.y,Y.z),U.push(0,0,1),ee.x=(Y.x/c+1)/2,ee.y=(Y.y/c+1)/2,V.push(ee.x,ee.y)}W+=j}for(let de=0;de<y;de++){const xe=de*(p+1);for(let re=0;re<p;re++){const Q=re+xe,De=Q,Me=Q+p+1,Ie=Q+p+2,Xe=Q+1;P.push(De,Me,Xe),P.push(Me,Ie,Xe)}}this.setIndex(P),this.setAttribute("position",new Hn(F,3)),this.setAttribute("normal",new Hn(U,3)),this.setAttribute("uv",new Hn(V,2))}static fromJSON(s){return new Dh(s.innerRadius,s.outerRadius,s.thetaSegments,s.phiSegments,s.thetaStart,s.thetaLength)}}class Zc extends si{constructor(s=new ha([new Qt(0,.5),new Qt(-.5,-.5),new Qt(.5,-.5)]),c=12){super(),this.type="ShapeGeometry",this.parameters={shapes:s,curveSegments:c};const p=[],y=[],M=[],C=[];let P=0,F=0;if(Array.isArray(s)===!1)U(s);else for(let V=0;V<s.length;V++)U(s[V]),this.addGroup(P,F,V),P+=F,F=0;this.setIndex(p),this.setAttribute("position",new Hn(y,3)),this.setAttribute("normal",new Hn(M,3)),this.setAttribute("uv",new Hn(C,2));function U(V){const W=y.length/3,j=V.extractPoints(c);let Y=j.shape;const ee=j.holes;da.isClockWise(Y)===!1&&(Y=Y.reverse());for(let xe=0,re=ee.length;xe<re;xe++){const Q=ee[xe];da.isClockWise(Q)===!0&&(ee[xe]=Q.reverse())}const de=da.triangulateShape(Y,ee);for(let xe=0,re=ee.length;xe<re;xe++){const Q=ee[xe];Y=Y.concat(Q)}for(let xe=0,re=Y.length;xe<re;xe++){const Q=Y[xe];y.push(Q.x,Q.y,0),M.push(0,0,1),C.push(Q.x,Q.y)}for(let xe=0,re=de.length;xe<re;xe++){const Q=de[xe],De=Q[0]+W,Me=Q[1]+W,Ie=Q[2]+W;p.push(De,Me,Ie),F+=3}}}toJSON(){const s=super.toJSON(),c=this.parameters.shapes;return lU(c,s)}static fromJSON(s,c){const p=[];for(let y=0,M=s.shapes.length;y<M;y++){const C=c[s.shapes[y]];p.push(C)}return new Zc(p,s.curveSegments)}}function lU(b,s){if(s.shapes=[],Array.isArray(b))for(let c=0,p=b.length;c<p;c++){const y=b[c];s.shapes.push(y.uuid)}else s.shapes.push(b.uuid);return s}class Jc extends si{constructor(s=1,c=32,p=16,y=0,M=Math.PI*2,C=0,P=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:s,widthSegments:c,heightSegments:p,phiStart:y,phiLength:M,thetaStart:C,thetaLength:P},c=Math.max(3,Math.floor(c)),p=Math.max(2,Math.floor(p));const F=Math.min(C+P,Math.PI);let U=0;const V=[],W=new Ge,j=new Ge,Y=[],ee=[],de=[],xe=[];for(let re=0;re<=p;re++){const Q=[],De=re/p;let Me=0;re==0&&C==0?Me=.5/c:re==p&&F==Math.PI&&(Me=-.5/c);for(let Ie=0;Ie<=c;Ie++){const Xe=Ie/c;W.x=-s*Math.cos(y+Xe*M)*Math.sin(C+De*P),W.y=s*Math.cos(C+De*P),W.z=s*Math.sin(y+Xe*M)*Math.sin(C+De*P),ee.push(W.x,W.y,W.z),j.copy(W).normalize(),de.push(j.x,j.y,j.z),xe.push(Xe+Me,1-De),Q.push(U++)}V.push(Q)}for(let re=0;re<p;re++)for(let Q=0;Q<c;Q++){const De=V[re][Q+1],Me=V[re][Q],Ie=V[re+1][Q],Xe=V[re+1][Q+1];(re!==0||C>0)&&Y.push(De,Me,Xe),(re!==p-1||F<Math.PI)&&Y.push(Me,Ie,Xe)}this.setIndex(Y),this.setAttribute("position",new Hn(ee,3)),this.setAttribute("normal",new Hn(de,3)),this.setAttribute("uv",new Hn(xe,2))}static fromJSON(s){return new Jc(s.radius,s.widthSegments,s.heightSegments,s.phiStart,s.phiLength,s.thetaStart,s.thetaLength)}}class Oh extends ua{constructor(s=1,c=0){const p=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],y=[2,1,0,0,3,2,1,3,0,2,3,1];super(p,y,s,c),this.type="TetrahedronGeometry",this.parameters={radius:s,detail:c}}static fromJSON(s){return new Oh(s.radius,s.detail)}}class Ih extends si{constructor(s=1,c=.4,p=8,y=6,M=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:s,tube:c,radialSegments:p,tubularSegments:y,arc:M},p=Math.floor(p),y=Math.floor(y);const C=[],P=[],F=[],U=[],V=new Ge,W=new Ge,j=new Ge;for(let Y=0;Y<=p;Y++)for(let ee=0;ee<=y;ee++){const de=ee/y*M,xe=Y/p*Math.PI*2;W.x=(s+c*Math.cos(xe))*Math.cos(de),W.y=(s+c*Math.cos(xe))*Math.sin(de),W.z=c*Math.sin(xe),P.push(W.x,W.y,W.z),V.x=s*Math.cos(de),V.y=s*Math.sin(de),j.subVectors(W,V).normalize(),F.push(j.x,j.y,j.z),U.push(ee/y),U.push(Y/p)}for(let Y=1;Y<=p;Y++)for(let ee=1;ee<=y;ee++){const de=(y+1)*Y+ee-1,xe=(y+1)*(Y-1)+ee-1,re=(y+1)*(Y-1)+ee,Q=(y+1)*Y+ee;C.push(de,xe,Q),C.push(xe,re,Q)}this.setIndex(C),this.setAttribute("position",new Hn(P,3)),this.setAttribute("normal",new Hn(F,3)),this.setAttribute("uv",new Hn(U,2))}static fromJSON(s){return new Ih(s.radius,s.tube,s.radialSegments,s.tubularSegments,s.arc)}}class kh extends si{constructor(s=1,c=.4,p=64,y=8,M=2,C=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:s,tube:c,tubularSegments:p,radialSegments:y,p:M,q:C},p=Math.floor(p),y=Math.floor(y);const P=[],F=[],U=[],V=[],W=new Ge,j=new Ge,Y=new Ge,ee=new Ge,de=new Ge,xe=new Ge,re=new Ge;for(let De=0;De<=p;++De){const Me=De/p*M*Math.PI*2;Q(Me,M,C,s,Y),Q(Me+.01,M,C,s,ee),xe.subVectors(ee,Y),re.addVectors(ee,Y),de.crossVectors(xe,re),re.crossVectors(de,xe),de.normalize(),re.normalize();for(let Ie=0;Ie<=y;++Ie){const Xe=Ie/y*Math.PI*2,st=-c*Math.cos(Xe),ut=c*Math.sin(Xe);W.x=Y.x+(st*re.x+ut*de.x),W.y=Y.y+(st*re.y+ut*de.y),W.z=Y.z+(st*re.z+ut*de.z),F.push(W.x,W.y,W.z),j.subVectors(W,Y).normalize(),U.push(j.x,j.y,j.z),V.push(De/p),V.push(Ie/y)}}for(let De=1;De<=p;De++)for(let Me=1;Me<=y;Me++){const Ie=(y+1)*(De-1)+(Me-1),Xe=(y+1)*De+(Me-1),st=(y+1)*De+Me,ut=(y+1)*(De-1)+Me;P.push(Ie,Xe,ut),P.push(Xe,st,ut)}this.setIndex(P),this.setAttribute("position",new Hn(F,3)),this.setAttribute("normal",new Hn(U,3)),this.setAttribute("uv",new Hn(V,2));function Q(De,Me,Ie,Xe,st){const ut=Math.cos(De),Dt=Math.sin(De),Rt=Ie/Me*De,Ee=Math.cos(Rt);st.x=Xe*(2+Ee)*.5*ut,st.y=Xe*(2+Ee)*Dt*.5,st.z=Xe*Math.sin(Rt)*.5}}static fromJSON(s){return new kh(s.radius,s.tube,s.tubularSegments,s.radialSegments,s.p,s.q)}}class Nh extends si{constructor(s=new Xg(new Ge(-1,-1,0),new Ge(-1,1,0),new Ge(1,1,0)),c=64,p=1,y=8,M=!1){super(),this.type="TubeGeometry",this.parameters={path:s,tubularSegments:c,radius:p,radialSegments:y,closed:M};const C=s.computeFrenetFrames(c,M);this.tangents=C.tangents,this.normals=C.normals,this.binormals=C.binormals;const P=new Ge,F=new Ge,U=new Qt;let V=new Ge;const W=[],j=[],Y=[],ee=[];de(),this.setIndex(ee),this.setAttribute("position",new Hn(W,3)),this.setAttribute("normal",new Hn(j,3)),this.setAttribute("uv",new Hn(Y,2));function de(){for(let De=0;De<c;De++)xe(De);xe(M===!1?c:0),Q(),re()}function xe(De){V=s.getPointAt(De/c,V);const Me=C.normals[De],Ie=C.binormals[De];for(let Xe=0;Xe<=y;Xe++){const st=Xe/y*Math.PI*2,ut=Math.sin(st),Dt=-Math.cos(st);F.x=Dt*Me.x+ut*Ie.x,F.y=Dt*Me.y+ut*Ie.y,F.z=Dt*Me.z+ut*Ie.z,F.normalize(),j.push(F.x,F.y,F.z),P.x=V.x+p*F.x,P.y=V.y+p*F.y,P.z=V.z+p*F.z,W.push(P.x,P.y,P.z)}}function re(){for(let De=1;De<=c;De++)for(let Me=1;Me<=y;Me++){const Ie=(y+1)*(De-1)+(Me-1),Xe=(y+1)*De+(Me-1),st=(y+1)*De+Me,ut=(y+1)*(De-1)+Me;ee.push(Ie,Xe,ut),ee.push(Xe,st,ut)}}function Q(){for(let De=0;De<=c;De++)for(let Me=0;Me<=y;Me++)U.x=De/c,U.y=Me/y,Y.push(U.x,U.y)}}toJSON(){const s=super.toJSON();return s.path=this.parameters.path.toJSON(),s}static fromJSON(s){return new Nh(new l_[s.path.type]().fromJSON(s.path),s.tubularSegments,s.radius,s.radialSegments,s.closed)}}class h_ extends si{constructor(s=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:s},s!==null){const c=[],p=new Set,y=new Ge,M=new Ge;if(s.index!==null){const C=s.attributes.position,P=s.index;let F=s.groups;F.length===0&&(F=[{start:0,count:P.count,materialIndex:0}]);for(let U=0,V=F.length;U<V;++U){const W=F[U],j=W.start,Y=W.count;for(let ee=j,de=j+Y;ee<de;ee+=3)for(let xe=0;xe<3;xe++){const re=P.getX(ee+xe),Q=P.getX(ee+(xe+1)%3);y.fromBufferAttribute(C,re),M.fromBufferAttribute(C,Q),uT(y,M,p)===!0&&(c.push(y.x,y.y,y.z),c.push(M.x,M.y,M.z))}}}else{const C=s.attributes.position;for(let P=0,F=C.count/3;P<F;P++)for(let U=0;U<3;U++){const V=3*P+U,W=3*P+(U+1)%3;y.fromBufferAttribute(C,V),M.fromBufferAttribute(C,W),uT(y,M,p)===!0&&(c.push(y.x,y.y,y.z),c.push(M.x,M.y,M.z))}}this.setAttribute("position",new Hn(c,3))}}}function uT(b,s,c){const p=`${b.x},${b.y},${b.z}-${s.x},${s.y},${s.z}`,y=`${s.x},${s.y},${s.z}-${b.x},${b.y},${b.z}`;return c.has(p)===!0||c.has(y)===!0?!1:(c.add(p,y),!0)}var hT=Object.freeze({__proto__:null,BoxGeometry:Ga,BoxBufferGeometry:Ga,CircleGeometry:Sh,CircleBufferGeometry:Sh,ConeGeometry:Th,ConeBufferGeometry:Th,CylinderGeometry:jl,CylinderBufferGeometry:jl,DodecahedronGeometry:Ch,DodecahedronBufferGeometry:Ch,EdgesGeometry:e_,ExtrudeGeometry:fa,ExtrudeBufferGeometry:fa,IcosahedronGeometry:Lh,IcosahedronBufferGeometry:Lh,LatheGeometry:Ph,LatheBufferGeometry:Ph,OctahedronGeometry:Qc,OctahedronBufferGeometry:Qc,PlaneGeometry:jc,PlaneBufferGeometry:jc,PolyhedronGeometry:ua,PolyhedronBufferGeometry:ua,RingGeometry:Dh,RingBufferGeometry:Dh,ShapeGeometry:Zc,ShapeBufferGeometry:Zc,SphereGeometry:Jc,SphereBufferGeometry:Jc,TetrahedronGeometry:Oh,TetrahedronBufferGeometry:Oh,TorusGeometry:Ih,TorusBufferGeometry:Ih,TorusKnotGeometry:kh,TorusKnotBufferGeometry:kh,TubeGeometry:Nh,TubeBufferGeometry:Nh,WireframeGeometry:h_});class d_ extends Kr{constructor(s){super(),this.type="ShadowMaterial",this.color=new Tn(0),this.transparent=!0,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this}}d_.prototype.isShadowMaterial=!0;class Zg extends Kr{constructor(s){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Tn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new Qt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.defines={STANDARD:""},this.color.copy(s.color),this.roughness=s.roughness,this.metalness=s.metalness,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.roughnessMap=s.roughnessMap,this.metalnessMap=s.metalnessMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.envMapIntensity=s.envMapIntensity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.flatShading=s.flatShading,this}}Zg.prototype.isMeshStandardMaterial=!0;class f_ extends Zg{constructor(s){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Qt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ss(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.sheenColor=new Tn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Tn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Tn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(s)}get sheen(){return this._sheen}set sheen(s){this._sheen>0!=s>0&&this.version++,this._sheen=s}get clearcoat(){return this._clearcoat}set clearcoat(s){this._clearcoat>0!=s>0&&this.version++,this._clearcoat=s}get transmission(){return this._transmission}set transmission(s){this._transmission>0!=s>0&&this.version++,this._transmission=s}copy(s){return super.copy(s),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=s.clearcoat,this.clearcoatMap=s.clearcoatMap,this.clearcoatRoughness=s.clearcoatRoughness,this.clearcoatRoughnessMap=s.clearcoatRoughnessMap,this.clearcoatNormalMap=s.clearcoatNormalMap,this.clearcoatNormalScale.copy(s.clearcoatNormalScale),this.ior=s.ior,this.sheen=s.sheen,this.sheenColor.copy(s.sheenColor),this.sheenColorMap=s.sheenColorMap,this.sheenRoughness=s.sheenRoughness,this.sheenRoughnessMap=s.sheenRoughnessMap,this.transmission=s.transmission,this.transmissionMap=s.transmissionMap,this.thickness=s.thickness,this.thicknessMap=s.thicknessMap,this.attenuationDistance=s.attenuationDistance,this.attenuationColor.copy(s.attenuationColor),this.specularIntensity=s.specularIntensity,this.specularIntensityMap=s.specularIntensityMap,this.specularColor.copy(s.specularColor),this.specularColorMap=s.specularColorMap,this}}f_.prototype.isMeshPhysicalMaterial=!0;class p_ extends Kr{constructor(s){super(),this.type="MeshPhongMaterial",this.color=new Tn(16777215),this.specular=new Tn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new Qt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=At,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.specular.copy(s.specular),this.shininess=s.shininess,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.flatShading=s.flatShading,this}}p_.prototype.isMeshPhongMaterial=!0;class m_ extends Kr{constructor(s){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Tn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new Qt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.gradientMap=s.gradientMap,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this}}m_.prototype.isMeshToonMaterial=!0;class g_ extends Kr{constructor(s){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new Qt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.flatShading=s.flatShading,this}}g_.prototype.isMeshNormalMaterial=!0;class v_ extends Kr{constructor(s){super(),this.type="MeshLambertMaterial",this.color=new Tn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Tn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=At,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(s)}copy(s){return super.copy(s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this}}v_.prototype.isMeshLambertMaterial=!0;class y_ extends Kr{constructor(s){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Tn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=bn,this.normalScale=new Qt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(s)}copy(s){return super.copy(s),this.defines={MATCAP:""},this.color.copy(s.color),this.matcap=s.matcap,this.map=s.map,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.flatShading=s.flatShading,this}}y_.prototype.isMeshMatcapMaterial=!0;class x_ extends Zr{constructor(s){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(s)}copy(s){return super.copy(s),this.scale=s.scale,this.dashSize=s.dashSize,this.gapSize=s.gapSize,this}}x_.prototype.isLineDashedMaterial=!0;var cU=Object.freeze({__proto__:null,ShadowMaterial:d_,SpriteMaterial:Cg,RawShaderMaterial:vh,ShaderMaterial:Va,PointsMaterial:Kc,MeshPhysicalMaterial:f_,MeshStandardMaterial:Zg,MeshPhongMaterial:p_,MeshToonMaterial:m_,MeshNormalMaterial:g_,MeshLambertMaterial:v_,MeshDepthMaterial:Ag,MeshDistanceMaterial:wg,MeshBasicMaterial:Ha,MeshMatcapMaterial:y_,LineDashedMaterial:x_,LineBasicMaterial:Zr,Material:Kr});const hr={arraySlice:function(b,s,c){return hr.isTypedArray(b)?new b.constructor(b.subarray(s,c!==void 0?c:b.length)):b.slice(s,c)},convertArray:function(b,s,c){return!b||!c&&b.constructor===s?b:typeof s.BYTES_PER_ELEMENT=="number"?new s(b):Array.prototype.slice.call(b)},isTypedArray:function(b){return ArrayBuffer.isView(b)&&!(b instanceof DataView)},getKeyframeOrder:function(b){function s(y,M){return b[y]-b[M]}const c=b.length,p=new Array(c);for(let y=0;y!==c;++y)p[y]=y;return p.sort(s),p},sortedArray:function(b,s,c){const p=b.length,y=new b.constructor(p);for(let M=0,C=0;C!==p;++M){const P=c[M]*s;for(let F=0;F!==s;++F)y[C++]=b[P+F]}return y},flattenJSON:function(b,s,c,p){let y=1,M=b[0];for(;M!==void 0&&M[p]===void 0;)M=b[y++];if(M===void 0)return;let C=M[p];if(C!==void 0)if(Array.isArray(C))do C=M[p],C!==void 0&&(s.push(M.time),c.push.apply(c,C)),M=b[y++];while(M!==void 0);else if(C.toArray!==void 0)do C=M[p],C!==void 0&&(s.push(M.time),C.toArray(c,c.length)),M=b[y++];while(M!==void 0);else do C=M[p],C!==void 0&&(s.push(M.time),c.push(C)),M=b[y++];while(M!==void 0)},subclip:function(b,s,c,p,y=30){const M=b.clone();M.name=s;const C=[];for(let F=0;F<M.tracks.length;++F){const U=M.tracks[F],V=U.getValueSize(),W=[],j=[];for(let Y=0;Y<U.times.length;++Y){const ee=U.times[Y]*y;if(!(ee<c||ee>=p)){W.push(U.times[Y]);for(let de=0;de<V;++de)j.push(U.values[Y*V+de])}}W.length!==0&&(U.times=hr.convertArray(W,U.times.constructor),U.values=hr.convertArray(j,U.values.constructor),C.push(U))}M.tracks=C;let P=1/0;for(let F=0;F<M.tracks.length;++F)P>M.tracks[F].times[0]&&(P=M.tracks[F].times[0]);for(let F=0;F<M.tracks.length;++F)M.tracks[F].shift(-1*P);return M.resetDuration(),M},makeClipAdditive:function(b,s=0,c=b,p=30){p<=0&&(p=30);const y=c.tracks.length,M=s/p;for(let C=0;C<y;++C){const P=c.tracks[C],F=P.ValueTypeName;if(F==="bool"||F==="string")continue;const U=b.tracks.find(function(re){return re.name===P.name&&re.ValueTypeName===F});if(U===void 0)continue;let V=0;const W=P.getValueSize();P.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(V=W/3);let j=0;const Y=U.getValueSize();U.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(j=Y/3);const ee=P.times.length-1;let de;if(M<=P.times[0]){const re=V,Q=W-V;de=hr.arraySlice(P.values,re,Q)}else if(M>=P.times[ee]){const re=ee*W+V,Q=re+W-V;de=hr.arraySlice(P.values,re,Q)}else{const re=P.createInterpolant(),Q=V,De=W-V;re.evaluate(M),de=hr.arraySlice(re.resultBuffer,Q,De)}F==="quaternion"&&new Yr().fromArray(de).normalize().conjugate().toArray(de);const xe=U.times.length;for(let re=0;re<xe;++re){const Q=re*Y+j;if(F==="quaternion")Yr.multiplyQuaternionsFlat(U.values,Q,de,0,U.values,Q);else{const De=Y-j*2;for(let Me=0;Me<De;++Me)U.values[Q+Me]-=de[Me]}}}return b.blendMode=Ft,b}};class ja{constructor(s,c,p,y){this.parameterPositions=s,this._cachedIndex=0,this.resultBuffer=y!==void 0?y:new c.constructor(p),this.sampleValues=c,this.valueSize=p,this.settings=null,this.DefaultSettings_={}}evaluate(s){const c=this.parameterPositions;let p=this._cachedIndex,y=c[p],M=c[p-1];e:{t:{let C;n:{i:if(!(s<y)){for(let P=p+2;;){if(y===void 0){if(s<M)break i;return p=c.length,this._cachedIndex=p,this.afterEnd_(p-1,s,M)}if(p===P)break;if(M=y,y=c[++p],s<y)break t}C=c.length;break n}if(!(s>=M)){const P=c[1];s<P&&(p=2,M=P);for(let F=p-2;;){if(M===void 0)return this._cachedIndex=0,this.beforeStart_(0,s,y);if(p===F)break;if(y=M,M=c[--p-1],s>=M)break t}C=p,p=0;break n}break e}for(;p<C;){const P=p+C>>>1;s<c[P]?C=P:p=P+1}if(y=c[p],M=c[p-1],M===void 0)return this._cachedIndex=0,this.beforeStart_(0,s,y);if(y===void 0)return p=c.length,this._cachedIndex=p,this.afterEnd_(p-1,M,s)}this._cachedIndex=p,this.intervalChanged_(p,M,y)}return this.interpolate_(p,M,s,y)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(s){const c=this.resultBuffer,p=this.sampleValues,y=this.valueSize,M=s*y;for(let C=0;C!==y;++C)c[C]=p[M+C];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}ja.prototype.beforeStart_=ja.prototype.copySampleValue_,ja.prototype.afterEnd_=ja.prototype.copySampleValue_;class dT extends ja{constructor(s,c,p,y){super(s,c,p,y),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Te,endingEnd:Te}}intervalChanged_(s,c,p){const y=this.parameterPositions;let M=s-2,C=s+1,P=y[M],F=y[C];if(P===void 0)switch(this.getSettings_().endingStart){case Ae:M=s,P=2*c-p;break;case rt:M=y.length-2,P=c+y[M]-y[M+1];break;default:M=s,P=p}if(F===void 0)switch(this.getSettings_().endingEnd){case Ae:C=s,F=2*p-c;break;case rt:C=1,F=p+y[1]-y[0];break;default:C=s-1,F=c}const U=(p-c)*.5,V=this.valueSize;this._weightPrev=U/(c-P),this._weightNext=U/(F-p),this._offsetPrev=M*V,this._offsetNext=C*V}interpolate_(s,c,p,y){const M=this.resultBuffer,C=this.sampleValues,P=this.valueSize,F=s*P,U=F-P,V=this._offsetPrev,W=this._offsetNext,j=this._weightPrev,Y=this._weightNext,ee=(p-c)/(y-c),de=ee*ee,xe=de*ee,re=-j*xe+2*j*de-j*ee,Q=(1+j)*xe+(-1.5-2*j)*de+(-.5+j)*ee+1,De=(-1-Y)*xe+(1.5+Y)*de+.5*ee,Me=Y*xe-Y*de;for(let Ie=0;Ie!==P;++Ie)M[Ie]=re*C[V+Ie]+Q*C[U+Ie]+De*C[F+Ie]+Me*C[W+Ie];return M}}class __ extends ja{constructor(s,c,p,y){super(s,c,p,y)}interpolate_(s,c,p,y){const M=this.resultBuffer,C=this.sampleValues,P=this.valueSize,F=s*P,U=F-P,V=(p-c)/(y-c),W=1-V;for(let j=0;j!==P;++j)M[j]=C[U+j]*W+C[F+j]*V;return M}}class fT extends ja{constructor(s,c,p,y){super(s,c,p,y)}interpolate_(s){return this.copySampleValue_(s-1)}}class No{constructor(s,c,p,y){if(s===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(c===void 0||c.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+s);this.name=s,this.times=hr.convertArray(c,this.TimeBufferType),this.values=hr.convertArray(p,this.ValueBufferType),this.setInterpolation(y||this.DefaultInterpolation)}static toJSON(s){const c=s.constructor;let p;if(c.toJSON!==this.toJSON)p=c.toJSON(s);else{p={name:s.name,times:hr.convertArray(s.times,Array),values:hr.convertArray(s.values,Array)};const y=s.getInterpolation();y!==s.DefaultInterpolation&&(p.interpolation=y)}return p.type=s.ValueTypeName,p}InterpolantFactoryMethodDiscrete(s){return new fT(this.times,this.values,this.getValueSize(),s)}InterpolantFactoryMethodLinear(s){return new __(this.times,this.values,this.getValueSize(),s)}InterpolantFactoryMethodSmooth(s){return new dT(this.times,this.values,this.getValueSize(),s)}setInterpolation(s){let c;switch(s){case oe:c=this.InterpolantFactoryMethodDiscrete;break;case he:c=this.InterpolantFactoryMethodLinear;break;case be:c=this.InterpolantFactoryMethodSmooth;break}if(c===void 0){const p="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(s!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(p);return console.warn("THREE.KeyframeTrack:",p),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return oe;case this.InterpolantFactoryMethodLinear:return he;case this.InterpolantFactoryMethodSmooth:return be}}getValueSize(){return this.values.length/this.times.length}shift(s){if(s!==0){const c=this.times;for(let p=0,y=c.length;p!==y;++p)c[p]+=s}return this}scale(s){if(s!==1){const c=this.times;for(let p=0,y=c.length;p!==y;++p)c[p]*=s}return this}trim(s,c){const p=this.times,y=p.length;let M=0,C=y-1;for(;M!==y&&p[M]<s;)++M;for(;C!==-1&&p[C]>c;)--C;if(++C,M!==0||C!==y){M>=C&&(C=Math.max(C,1),M=C-1);const P=this.getValueSize();this.times=hr.arraySlice(p,M,C),this.values=hr.arraySlice(this.values,M*P,C*P)}return this}validate(){let s=!0;const c=this.getValueSize();c-Math.floor(c)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),s=!1);const p=this.times,y=this.values,M=p.length;M===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),s=!1);let C=null;for(let P=0;P!==M;P++){const F=p[P];if(typeof F=="number"&&isNaN(F)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,P,F),s=!1;break}if(C!==null&&C>F){console.error("THREE.KeyframeTrack: Out of order keys.",this,P,F,C),s=!1;break}C=F}if(y!==void 0&&hr.isTypedArray(y))for(let P=0,F=y.length;P!==F;++P){const U=y[P];if(isNaN(U)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,P,U),s=!1;break}}return s}optimize(){const s=hr.arraySlice(this.times),c=hr.arraySlice(this.values),p=this.getValueSize(),y=this.getInterpolation()===be,M=s.length-1;let C=1;for(let P=1;P<M;++P){let F=!1;const U=s[P],V=s[P+1];if(U!==V&&(P!==1||U!==s[0]))if(y)F=!0;else{const W=P*p,j=W-p,Y=W+p;for(let ee=0;ee!==p;++ee){const de=c[W+ee];if(de!==c[j+ee]||de!==c[Y+ee]){F=!0;break}}}if(F){if(P!==C){s[C]=s[P];const W=P*p,j=C*p;for(let Y=0;Y!==p;++Y)c[j+Y]=c[W+Y]}++C}}if(M>0){s[C]=s[M];for(let P=M*p,F=C*p,U=0;U!==p;++U)c[F+U]=c[P+U];++C}return C!==s.length?(this.times=hr.arraySlice(s,0,C),this.values=hr.arraySlice(c,0,C*p)):(this.times=s,this.values=c),this}clone(){const s=hr.arraySlice(this.times,0),c=hr.arraySlice(this.values,0),p=this.constructor,y=new p(this.name,s,c);return y.createInterpolant=this.createInterpolant,y}}No.prototype.TimeBufferType=Float32Array,No.prototype.ValueBufferType=Float32Array,No.prototype.DefaultInterpolation=he;class eu extends No{}eu.prototype.ValueTypeName="bool",eu.prototype.ValueBufferType=Array,eu.prototype.DefaultInterpolation=oe,eu.prototype.InterpolantFactoryMethodLinear=void 0,eu.prototype.InterpolantFactoryMethodSmooth=void 0;class b_ extends No{}b_.prototype.ValueTypeName="color";class Vf extends No{}Vf.prototype.ValueTypeName="number";class pT extends ja{constructor(s,c,p,y){super(s,c,p,y)}interpolate_(s,c,p,y){const M=this.resultBuffer,C=this.sampleValues,P=this.valueSize,F=(p-c)/(y-c);let U=s*P;for(let V=U+P;U!==V;U+=4)Yr.slerpFlat(M,0,C,U-P,C,U,F);return M}}class Fh extends No{InterpolantFactoryMethodLinear(s){return new pT(this.times,this.values,this.getValueSize(),s)}}Fh.prototype.ValueTypeName="quaternion",Fh.prototype.DefaultInterpolation=he,Fh.prototype.InterpolantFactoryMethodSmooth=void 0;class tu extends No{}tu.prototype.ValueTypeName="string",tu.prototype.ValueBufferType=Array,tu.prototype.DefaultInterpolation=oe,tu.prototype.InterpolantFactoryMethodLinear=void 0,tu.prototype.InterpolantFactoryMethodSmooth=void 0;class Wf extends No{}Wf.prototype.ValueTypeName="vector";class jf{constructor(s,c=-1,p,y=Mt){this.name=s,this.tracks=p,this.duration=c,this.blendMode=y,this.uuid=Ws(),this.duration<0&&this.resetDuration()}static parse(s){const c=[],p=s.tracks,y=1/(s.fps||1);for(let C=0,P=p.length;C!==P;++C)c.push(hU(p[C]).scale(y));const M=new this(s.name,s.duration,c,s.blendMode);return M.uuid=s.uuid,M}static toJSON(s){const c=[],p=s.tracks,y={name:s.name,duration:s.duration,tracks:c,uuid:s.uuid,blendMode:s.blendMode};for(let M=0,C=p.length;M!==C;++M)c.push(No.toJSON(p[M]));return y}static CreateFromMorphTargetSequence(s,c,p,y){const M=c.length,C=[];for(let P=0;P<M;P++){let F=[],U=[];F.push((P+M-1)%M,P,(P+1)%M),U.push(0,1,0);const V=hr.getKeyframeOrder(F);F=hr.sortedArray(F,1,V),U=hr.sortedArray(U,1,V),!y&&F[0]===0&&(F.push(M),U.push(U[0])),C.push(new Vf(".morphTargetInfluences["+c[P].name+"]",F,U).scale(1/p))}return new this(s,-1,C)}static findByName(s,c){let p=s;if(!Array.isArray(s)){const y=s;p=y.geometry&&y.geometry.animations||y.animations}for(let y=0;y<p.length;y++)if(p[y].name===c)return p[y];return null}static CreateClipsFromMorphTargetSequences(s,c,p){const y={},M=/^([\w-]*?)([\d]+)$/;for(let P=0,F=s.length;P<F;P++){const U=s[P],V=U.name.match(M);if(V&&V.length>1){const W=V[1];let j=y[W];j||(y[W]=j=[]),j.push(U)}}const C=[];for(const P in y)C.push(this.CreateFromMorphTargetSequence(P,y[P],c,p));return C}static parseAnimation(s,c){if(!s)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const p=function(W,j,Y,ee,de){if(Y.length!==0){const xe=[],re=[];hr.flattenJSON(Y,xe,re,ee),xe.length!==0&&de.push(new W(j,xe,re))}},y=[],M=s.name||"default",C=s.fps||30,P=s.blendMode;let F=s.length||-1;const U=s.hierarchy||[];for(let W=0;W<U.length;W++){const j=U[W].keys;if(!(!j||j.length===0))if(j[0].morphTargets){const Y={};let ee;for(ee=0;ee<j.length;ee++)if(j[ee].morphTargets)for(let de=0;de<j[ee].morphTargets.length;de++)Y[j[ee].morphTargets[de]]=-1;for(const de in Y){const xe=[],re=[];for(let Q=0;Q!==j[ee].morphTargets.length;++Q){const De=j[ee];xe.push(De.time),re.push(De.morphTarget===de?1:0)}y.push(new Vf(".morphTargetInfluence["+de+"]",xe,re))}F=Y.length*(C||1)}else{const Y=".bones["+c[W].name+"]";p(Wf,Y+".position",j,"pos",y),p(Fh,Y+".quaternion",j,"rot",y),p(Wf,Y+".scale",j,"scl",y)}}return y.length===0?null:new this(M,F,y,P)}resetDuration(){const s=this.tracks;let c=0;for(let p=0,y=s.length;p!==y;++p){const M=this.tracks[p];c=Math.max(c,M.times[M.times.length-1])}return this.duration=c,this}trim(){for(let s=0;s<this.tracks.length;s++)this.tracks[s].trim(0,this.duration);return this}validate(){let s=!0;for(let c=0;c<this.tracks.length;c++)s=s&&this.tracks[c].validate();return s}optimize(){for(let s=0;s<this.tracks.length;s++)this.tracks[s].optimize();return this}clone(){const s=[];for(let c=0;c<this.tracks.length;c++)s.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,s,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function uU(b){switch(b.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Vf;case"vector":case"vector2":case"vector3":case"vector4":return Wf;case"color":return b_;case"quaternion":return Fh;case"bool":case"boolean":return eu;case"string":return tu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+b)}function hU(b){if(b.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const s=uU(b.type);if(b.times===void 0){const c=[],p=[];hr.flattenJSON(b.keys,c,p,"value"),b.times=c,b.values=p}return s.parse!==void 0?s.parse(b):new s(b.name,b.times,b.values,b.interpolation)}const nu={enabled:!1,files:{},add:function(b,s){this.enabled!==!1&&(this.files[b]=s)},get:function(b){if(this.enabled!==!1)return this.files[b]},remove:function(b){delete this.files[b]},clear:function(){this.files={}}};class E_{constructor(s,c,p){const y=this;let M=!1,C=0,P=0,F;const U=[];this.onStart=void 0,this.onLoad=s,this.onProgress=c,this.onError=p,this.itemStart=function(V){P++,M===!1&&y.onStart!==void 0&&y.onStart(V,C,P),M=!0},this.itemEnd=function(V){C++,y.onProgress!==void 0&&y.onProgress(V,C,P),C===P&&(M=!1,y.onLoad!==void 0&&y.onLoad())},this.itemError=function(V){y.onError!==void 0&&y.onError(V)},this.resolveURL=function(V){return F?F(V):V},this.setURLModifier=function(V){return F=V,this},this.addHandler=function(V,W){return U.push(V,W),this},this.removeHandler=function(V){const W=U.indexOf(V);return W!==-1&&U.splice(W,2),this},this.getHandler=function(V){for(let W=0,j=U.length;W<j;W+=2){const Y=U[W],ee=U[W+1];if(Y.global&&(Y.lastIndex=0),Y.test(V))return ee}return null}}}const mT=new E_;class Es{constructor(s){this.manager=s!==void 0?s:mT,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(s,c){const p=this;return new Promise(function(y,M){p.load(s,y,c,M)})}parse(){}setCrossOrigin(s){return this.crossOrigin=s,this}setWithCredentials(s){return this.withCredentials=s,this}setPath(s){return this.path=s,this}setResourcePath(s){return this.resourcePath=s,this}setRequestHeader(s){return this.requestHeader=s,this}}const $a={};class pa extends Es{constructor(s){super(s)}load(s,c,p,y){s===void 0&&(s=""),this.path!==void 0&&(s=this.path+s),s=this.manager.resolveURL(s);const M=nu.get(s);if(M!==void 0)return this.manager.itemStart(s),setTimeout(()=>{c&&c(M),this.manager.itemEnd(s)},0),M;if($a[s]!==void 0){$a[s].push({onLoad:c,onProgress:p,onError:y});return}$a[s]=[],$a[s].push({onLoad:c,onProgress:p,onError:y});const C=new Request(s,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),P=this.mimeType,F=this.responseType;fetch(C).then(U=>{if(U.status===200||U.status===0){if(U.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||U.body.getReader===void 0)return U;const V=$a[s],W=U.body.getReader(),j=U.headers.get("Content-Length"),Y=j?parseInt(j):0,ee=Y!==0;let de=0;const xe=new ReadableStream({start(re){Q();function Q(){W.read().then(({done:De,value:Me})=>{if(De)re.close();else{de+=Me.byteLength;const Ie=new ProgressEvent("progress",{lengthComputable:ee,loaded:de,total:Y});for(let Xe=0,st=V.length;Xe<st;Xe++){const ut=V[Xe];ut.onProgress&&ut.onProgress(Ie)}re.enqueue(Me),Q()}})}}});return new Response(xe)}else throw Error(`fetch for "${U.url}" responded with ${U.status}: ${U.statusText}`)}).then(U=>{switch(F){case"arraybuffer":return U.arrayBuffer();case"blob":return U.blob();case"document":return U.text().then(V=>new DOMParser().parseFromString(V,P));case"json":return U.json();default:if(P===void 0)return U.text();{const W=/charset="?([^;"\s]*)"?/i.exec(P),j=W&&W[1]?W[1].toLowerCase():void 0,Y=new TextDecoder(j);return U.arrayBuffer().then(ee=>Y.decode(ee))}}}).then(U=>{nu.add(s,U);const V=$a[s];delete $a[s];for(let W=0,j=V.length;W<j;W++){const Y=V[W];Y.onLoad&&Y.onLoad(U)}}).catch(U=>{const V=$a[s];if(V===void 0)throw this.manager.itemError(s),U;delete $a[s];for(let W=0,j=V.length;W<j;W++){const Y=V[W];Y.onError&&Y.onError(U)}this.manager.itemError(s)}).finally(()=>{this.manager.itemEnd(s)}),this.manager.itemStart(s)}setResponseType(s){return this.responseType=s,this}setMimeType(s){return this.mimeType=s,this}}class dU extends Es{constructor(s){super(s)}load(s,c,p,y){const M=this,C=new pa(this.manager);C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(s,function(P){try{c(M.parse(JSON.parse(P)))}catch(F){y?y(F):console.error(F),M.manager.itemError(s)}},p,y)}parse(s){const c=[];for(let p=0;p<s.length;p++){const y=jf.parse(s[p]);c.push(y)}return c}}class fU extends Es{constructor(s){super(s)}load(s,c,p,y){const M=this,C=[],P=new Zx,F=new pa(this.manager);F.setPath(this.path),F.setResponseType("arraybuffer"),F.setRequestHeader(this.requestHeader),F.setWithCredentials(M.withCredentials);let U=0;function V(W){F.load(s[W],function(j){const Y=M.parse(j,!0);C[W]={width:Y.width,height:Y.height,format:Y.format,mipmaps:Y.mipmaps},U+=1,U===6&&(Y.mipmapCount===1&&(P.minFilter=Ve),P.image=C,P.format=Y.format,P.needsUpdate=!0,c&&c(P))},p,y)}if(Array.isArray(s))for(let W=0,j=s.length;W<j;++W)V(W);else F.load(s,function(W){const j=M.parse(W,!0);if(j.isCubemap){const Y=j.mipmaps.length/j.mipmapCount;for(let ee=0;ee<Y;ee++){C[ee]={mipmaps:[]};for(let de=0;de<j.mipmapCount;de++)C[ee].mipmaps.push(j.mipmaps[ee*j.mipmapCount+de]),C[ee].format=j.format,C[ee].width=j.width,C[ee].height=j.height}P.image=C}else P.image.width=j.width,P.image.height=j.height,P.mipmaps=j.mipmaps;j.mipmapCount===1&&(P.minFilter=Ve),P.format=j.format,P.needsUpdate=!0,c&&c(P)},p,y);return P}}class $f extends Es{constructor(s){super(s)}load(s,c,p,y){this.path!==void 0&&(s=this.path+s),s=this.manager.resolveURL(s);const M=this,C=nu.get(s);if(C!==void 0)return M.manager.itemStart(s),setTimeout(function(){c&&c(C),M.manager.itemEnd(s)},0),C;const P=xf("img");function F(){V(),nu.add(s,this),c&&c(this),M.manager.itemEnd(s)}function U(W){V(),y&&y(W),M.manager.itemError(s),M.manager.itemEnd(s)}function V(){P.removeEventListener("load",F,!1),P.removeEventListener("error",U,!1)}return P.addEventListener("load",F,!1),P.addEventListener("error",U,!1),s.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(P.crossOrigin=this.crossOrigin),M.manager.itemStart(s),P.src=s,P}}class gT extends Es{constructor(s){super(s)}load(s,c,p,y){const M=new mh,C=new $f(this.manager);C.setCrossOrigin(this.crossOrigin),C.setPath(this.path);let P=0;function F(U){C.load(s[U],function(V){M.images[U]=V,P++,P===6&&(M.needsUpdate=!0,c&&c(M))},void 0,y)}for(let U=0;U<s.length;++U)F(U);return M}}class vT extends Es{constructor(s){super(s)}load(s,c,p,y){const M=this,C=new qc,P=new pa(this.manager);return P.setResponseType("arraybuffer"),P.setRequestHeader(this.requestHeader),P.setPath(this.path),P.setWithCredentials(M.withCredentials),P.load(s,function(F){const U=M.parse(F);!U||(U.image!==void 0?C.image=U.image:U.data!==void 0&&(C.image.width=U.width,C.image.height=U.height,C.image.data=U.data),C.wrapS=U.wrapS!==void 0?U.wrapS:_t,C.wrapT=U.wrapT!==void 0?U.wrapT:_t,C.magFilter=U.magFilter!==void 0?U.magFilter:Ve,C.minFilter=U.minFilter!==void 0?U.minFilter:Ve,C.anisotropy=U.anisotropy!==void 0?U.anisotropy:1,U.encoding!==void 0&&(C.encoding=U.encoding),U.flipY!==void 0&&(C.flipY=U.flipY),U.format!==void 0&&(C.format=U.format),U.type!==void 0&&(C.type=U.type),U.mipmaps!==void 0&&(C.mipmaps=U.mipmaps,C.minFilter=Wt),U.mipmapCount===1&&(C.minFilter=Ve),U.generateMipmaps!==void 0&&(C.generateMipmaps=U.generateMipmaps),C.needsUpdate=!0,c&&c(C,U))},p,y),C}}class yT extends Es{constructor(s){super(s)}load(s,c,p,y){const M=new Nr,C=new $f(this.manager);return C.setCrossOrigin(this.crossOrigin),C.setPath(this.path),C.load(s,function(P){M.image=P,M.needsUpdate=!0,c!==void 0&&c(M)},p,y),M}}class Fo extends Oi{constructor(s,c=1){super(),this.type="Light",this.color=new Tn(s),this.intensity=c}dispose(){}copy(s){return super.copy(s),this.color.copy(s.color),this.intensity=s.intensity,this}toJSON(s){const c=super.toJSON(s);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,this.groundColor!==void 0&&(c.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(c.object.distance=this.distance),this.angle!==void 0&&(c.object.angle=this.angle),this.decay!==void 0&&(c.object.decay=this.decay),this.penumbra!==void 0&&(c.object.penumbra=this.penumbra),this.shadow!==void 0&&(c.object.shadow=this.shadow.toJSON()),c}}Fo.prototype.isLight=!0;class A_ extends Fo{constructor(s,c,p){super(s,p),this.type="HemisphereLight",this.position.copy(Oi.DefaultUp),this.updateMatrix(),this.groundColor=new Tn(c)}copy(s){return Fo.prototype.copy.call(this,s),this.groundColor.copy(s.groundColor),this}}A_.prototype.isHemisphereLight=!0;const xT=new zn,_T=new Ge,bT=new Ge;class w_{constructor(s){this.camera=s,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Qt(512,512),this.map=null,this.mapPass=null,this.matrix=new zn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new wf,this._frameExtents=new Qt(1,1),this._viewportCount=1,this._viewports=[new Qi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(s){const c=this.camera,p=this.matrix;_T.setFromMatrixPosition(s.matrixWorld),c.position.copy(_T),bT.setFromMatrixPosition(s.target.matrixWorld),c.lookAt(bT),c.updateMatrixWorld(),xT.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(xT),p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(c.projectionMatrix),p.multiply(c.matrixWorldInverse)}getViewport(s){return this._viewports[s]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(s){return this.camera=s.camera.clone(),this.bias=s.bias,this.radius=s.radius,this.mapSize.copy(s.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const s={};return this.bias!==0&&(s.bias=this.bias),this.normalBias!==0&&(s.normalBias=this.normalBias),this.radius!==1&&(s.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(s.mapSize=this.mapSize.toArray()),s.camera=this.camera.toJSON(!1).object,delete s.camera.matrix,s}}class ET extends w_{constructor(){super(new Br(50,1,.5,500)),this.focus=1}updateMatrices(s){const c=this.camera,p=vf*2*s.angle*this.focus,y=this.mapSize.width/this.mapSize.height,M=s.distance||c.far;(p!==c.fov||y!==c.aspect||M!==c.far)&&(c.fov=p,c.aspect=y,c.far=M,c.updateProjectionMatrix()),super.updateMatrices(s)}copy(s){return super.copy(s),this.focus=s.focus,this}}ET.prototype.isSpotLightShadow=!0;class M_ extends Fo{constructor(s,c,p=0,y=Math.PI/3,M=0,C=1){super(s,c),this.type="SpotLight",this.position.copy(Oi.DefaultUp),this.updateMatrix(),this.target=new Oi,this.distance=p,this.angle=y,this.penumbra=M,this.decay=C,this.shadow=new ET}get power(){return this.intensity*Math.PI}set power(s){this.intensity=s/Math.PI}dispose(){this.shadow.dispose()}copy(s){return super.copy(s),this.distance=s.distance,this.angle=s.angle,this.penumbra=s.penumbra,this.decay=s.decay,this.target=s.target.clone(),this.shadow=s.shadow.clone(),this}}M_.prototype.isSpotLight=!0;const AT=new zn,Xf=new Ge,S_=new Ge;class wT extends w_{constructor(){super(new Br(90,1,.5,500)),this._frameExtents=new Qt(4,2),this._viewportCount=6,this._viewports=[new Qi(2,1,1,1),new Qi(0,1,1,1),new Qi(3,1,1,1),new Qi(1,1,1,1),new Qi(3,0,1,1),new Qi(1,0,1,1)],this._cubeDirections=[new Ge(1,0,0),new Ge(-1,0,0),new Ge(0,0,1),new Ge(0,0,-1),new Ge(0,1,0),new Ge(0,-1,0)],this._cubeUps=[new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,1,0),new Ge(0,0,1),new Ge(0,0,-1)]}updateMatrices(s,c=0){const p=this.camera,y=this.matrix,M=s.distance||p.far;M!==p.far&&(p.far=M,p.updateProjectionMatrix()),Xf.setFromMatrixPosition(s.matrixWorld),p.position.copy(Xf),S_.copy(p.position),S_.add(this._cubeDirections[c]),p.up.copy(this._cubeUps[c]),p.lookAt(S_),p.updateMatrixWorld(),y.makeTranslation(-Xf.x,-Xf.y,-Xf.z),AT.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),this._frustum.setFromProjectionMatrix(AT)}}wT.prototype.isPointLightShadow=!0;class T_ extends Fo{constructor(s,c,p=0,y=1){super(s,c),this.type="PointLight",this.distance=p,this.decay=y,this.shadow=new wT}get power(){return this.intensity*4*Math.PI}set power(s){this.intensity=s/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(s){return super.copy(s),this.distance=s.distance,this.decay=s.decay,this.shadow=s.shadow.clone(),this}}T_.prototype.isPointLight=!0;class MT extends w_{constructor(){super(new Mf(-5,5,5,-5,.5,500))}}MT.prototype.isDirectionalLightShadow=!0;class C_ extends Fo{constructor(s,c){super(s,c),this.type="DirectionalLight",this.position.copy(Oi.DefaultUp),this.updateMatrix(),this.target=new Oi,this.shadow=new MT}dispose(){this.shadow.dispose()}copy(s){return super.copy(s),this.target=s.target.clone(),this.shadow=s.shadow.clone(),this}}C_.prototype.isDirectionalLight=!0;class R_ extends Fo{constructor(s,c){super(s,c),this.type="AmbientLight"}}R_.prototype.isAmbientLight=!0;class L_ extends Fo{constructor(s,c,p=10,y=10){super(s,c),this.type="RectAreaLight",this.width=p,this.height=y}get power(){return this.intensity*this.width*this.height*Math.PI}set power(s){this.intensity=s/(this.width*this.height*Math.PI)}copy(s){return super.copy(s),this.width=s.width,this.height=s.height,this}toJSON(s){const c=super.toJSON(s);return c.object.width=this.width,c.object.height=this.height,c}}L_.prototype.isRectAreaLight=!0;class P_{constructor(){this.coefficients=[];for(let s=0;s<9;s++)this.coefficients.push(new Ge)}set(s){for(let c=0;c<9;c++)this.coefficients[c].copy(s[c]);return this}zero(){for(let s=0;s<9;s++)this.coefficients[s].set(0,0,0);return this}getAt(s,c){const p=s.x,y=s.y,M=s.z,C=this.coefficients;return c.copy(C[0]).multiplyScalar(.282095),c.addScaledVector(C[1],.488603*y),c.addScaledVector(C[2],.488603*M),c.addScaledVector(C[3],.488603*p),c.addScaledVector(C[4],1.092548*(p*y)),c.addScaledVector(C[5],1.092548*(y*M)),c.addScaledVector(C[6],.315392*(3*M*M-1)),c.addScaledVector(C[7],1.092548*(p*M)),c.addScaledVector(C[8],.546274*(p*p-y*y)),c}getIrradianceAt(s,c){const p=s.x,y=s.y,M=s.z,C=this.coefficients;return c.copy(C[0]).multiplyScalar(.886227),c.addScaledVector(C[1],2*.511664*y),c.addScaledVector(C[2],2*.511664*M),c.addScaledVector(C[3],2*.511664*p),c.addScaledVector(C[4],2*.429043*p*y),c.addScaledVector(C[5],2*.429043*y*M),c.addScaledVector(C[6],.743125*M*M-.247708),c.addScaledVector(C[7],2*.429043*p*M),c.addScaledVector(C[8],.429043*(p*p-y*y)),c}add(s){for(let c=0;c<9;c++)this.coefficients[c].add(s.coefficients[c]);return this}addScaledSH(s,c){for(let p=0;p<9;p++)this.coefficients[p].addScaledVector(s.coefficients[p],c);return this}scale(s){for(let c=0;c<9;c++)this.coefficients[c].multiplyScalar(s);return this}lerp(s,c){for(let p=0;p<9;p++)this.coefficients[p].lerp(s.coefficients[p],c);return this}equals(s){for(let c=0;c<9;c++)if(!this.coefficients[c].equals(s.coefficients[c]))return!1;return!0}copy(s){return this.set(s.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(s,c=0){const p=this.coefficients;for(let y=0;y<9;y++)p[y].fromArray(s,c+y*3);return this}toArray(s=[],c=0){const p=this.coefficients;for(let y=0;y<9;y++)p[y].toArray(s,c+y*3);return s}static getBasisAt(s,c){const p=s.x,y=s.y,M=s.z;c[0]=.282095,c[1]=.488603*y,c[2]=.488603*M,c[3]=.488603*p,c[4]=1.092548*p*y,c[5]=1.092548*y*M,c[6]=.315392*(3*M*M-1),c[7]=1.092548*p*M,c[8]=.546274*(p*p-y*y)}}P_.prototype.isSphericalHarmonics3=!0;class qf extends Fo{constructor(s=new P_,c=1){super(void 0,c),this.sh=s}copy(s){return super.copy(s),this.sh.copy(s.sh),this}fromJSON(s){return this.intensity=s.intensity,this.sh.fromArray(s.sh),this}toJSON(s){const c=super.toJSON(s);return c.object.sh=this.sh.toArray(),c}}qf.prototype.isLightProbe=!0;class ST extends Es{constructor(s){super(s),this.textures={}}load(s,c,p,y){const M=this,C=new pa(M.manager);C.setPath(M.path),C.setRequestHeader(M.requestHeader),C.setWithCredentials(M.withCredentials),C.load(s,function(P){try{c(M.parse(JSON.parse(P)))}catch(F){y?y(F):console.error(F),M.manager.itemError(s)}},p,y)}parse(s){const c=this.textures;function p(M){return c[M]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",M),c[M]}const y=new cU[s.type];if(s.uuid!==void 0&&(y.uuid=s.uuid),s.name!==void 0&&(y.name=s.name),s.color!==void 0&&y.color!==void 0&&y.color.setHex(s.color),s.roughness!==void 0&&(y.roughness=s.roughness),s.metalness!==void 0&&(y.metalness=s.metalness),s.sheen!==void 0&&(y.sheen=s.sheen),s.sheenColor!==void 0&&(y.sheenColor=new Tn().setHex(s.sheenColor)),s.sheenRoughness!==void 0&&(y.sheenRoughness=s.sheenRoughness),s.emissive!==void 0&&y.emissive!==void 0&&y.emissive.setHex(s.emissive),s.specular!==void 0&&y.specular!==void 0&&y.specular.setHex(s.specular),s.specularIntensity!==void 0&&(y.specularIntensity=s.specularIntensity),s.specularColor!==void 0&&y.specularColor!==void 0&&y.specularColor.setHex(s.specularColor),s.shininess!==void 0&&(y.shininess=s.shininess),s.clearcoat!==void 0&&(y.clearcoat=s.clearcoat),s.clearcoatRoughness!==void 0&&(y.clearcoatRoughness=s.clearcoatRoughness),s.transmission!==void 0&&(y.transmission=s.transmission),s.thickness!==void 0&&(y.thickness=s.thickness),s.attenuationDistance!==void 0&&(y.attenuationDistance=s.attenuationDistance),s.attenuationColor!==void 0&&y.attenuationColor!==void 0&&y.attenuationColor.setHex(s.attenuationColor),s.fog!==void 0&&(y.fog=s.fog),s.flatShading!==void 0&&(y.flatShading=s.flatShading),s.blending!==void 0&&(y.blending=s.blending),s.combine!==void 0&&(y.combine=s.combine),s.side!==void 0&&(y.side=s.side),s.shadowSide!==void 0&&(y.shadowSide=s.shadowSide),s.opacity!==void 0&&(y.opacity=s.opacity),s.transparent!==void 0&&(y.transparent=s.transparent),s.alphaTest!==void 0&&(y.alphaTest=s.alphaTest),s.depthTest!==void 0&&(y.depthTest=s.depthTest),s.depthWrite!==void 0&&(y.depthWrite=s.depthWrite),s.colorWrite!==void 0&&(y.colorWrite=s.colorWrite),s.alphaWrite!==void 0&&(y.alphaWrite=s.alphaWrite),s.stencilWrite!==void 0&&(y.stencilWrite=s.stencilWrite),s.stencilWriteMask!==void 0&&(y.stencilWriteMask=s.stencilWriteMask),s.stencilFunc!==void 0&&(y.stencilFunc=s.stencilFunc),s.stencilRef!==void 0&&(y.stencilRef=s.stencilRef),s.stencilFuncMask!==void 0&&(y.stencilFuncMask=s.stencilFuncMask),s.stencilFail!==void 0&&(y.stencilFail=s.stencilFail),s.stencilZFail!==void 0&&(y.stencilZFail=s.stencilZFail),s.stencilZPass!==void 0&&(y.stencilZPass=s.stencilZPass),s.wireframe!==void 0&&(y.wireframe=s.wireframe),s.wireframeLinewidth!==void 0&&(y.wireframeLinewidth=s.wireframeLinewidth),s.wireframeLinecap!==void 0&&(y.wireframeLinecap=s.wireframeLinecap),s.wireframeLinejoin!==void 0&&(y.wireframeLinejoin=s.wireframeLinejoin),s.rotation!==void 0&&(y.rotation=s.rotation),s.linewidth!==1&&(y.linewidth=s.linewidth),s.dashSize!==void 0&&(y.dashSize=s.dashSize),s.gapSize!==void 0&&(y.gapSize=s.gapSize),s.scale!==void 0&&(y.scale=s.scale),s.polygonOffset!==void 0&&(y.polygonOffset=s.polygonOffset),s.polygonOffsetFactor!==void 0&&(y.polygonOffsetFactor=s.polygonOffsetFactor),s.polygonOffsetUnits!==void 0&&(y.polygonOffsetUnits=s.polygonOffsetUnits),s.dithering!==void 0&&(y.dithering=s.dithering),s.alphaToCoverage!==void 0&&(y.alphaToCoverage=s.alphaToCoverage),s.premultipliedAlpha!==void 0&&(y.premultipliedAlpha=s.premultipliedAlpha),s.visible!==void 0&&(y.visible=s.visible),s.toneMapped!==void 0&&(y.toneMapped=s.toneMapped),s.userData!==void 0&&(y.userData=s.userData),s.vertexColors!==void 0&&(typeof s.vertexColors=="number"?y.vertexColors=s.vertexColors>0:y.vertexColors=s.vertexColors),s.uniforms!==void 0)for(const M in s.uniforms){const C=s.uniforms[M];switch(y.uniforms[M]={},C.type){case"t":y.uniforms[M].value=p(C.value);break;case"c":y.uniforms[M].value=new Tn().setHex(C.value);break;case"v2":y.uniforms[M].value=new Qt().fromArray(C.value);break;case"v3":y.uniforms[M].value=new Ge().fromArray(C.value);break;case"v4":y.uniforms[M].value=new Qi().fromArray(C.value);break;case"m3":y.uniforms[M].value=new Hr().fromArray(C.value);break;case"m4":y.uniforms[M].value=new zn().fromArray(C.value);break;default:y.uniforms[M].value=C.value}}if(s.defines!==void 0&&(y.defines=s.defines),s.vertexShader!==void 0&&(y.vertexShader=s.vertexShader),s.fragmentShader!==void 0&&(y.fragmentShader=s.fragmentShader),s.extensions!==void 0)for(const M in s.extensions)y.extensions[M]=s.extensions[M];if(s.shading!==void 0&&(y.flatShading=s.shading===1),s.size!==void 0&&(y.size=s.size),s.sizeAttenuation!==void 0&&(y.sizeAttenuation=s.sizeAttenuation),s.map!==void 0&&(y.map=p(s.map)),s.matcap!==void 0&&(y.matcap=p(s.matcap)),s.alphaMap!==void 0&&(y.alphaMap=p(s.alphaMap)),s.bumpMap!==void 0&&(y.bumpMap=p(s.bumpMap)),s.bumpScale!==void 0&&(y.bumpScale=s.bumpScale),s.normalMap!==void 0&&(y.normalMap=p(s.normalMap)),s.normalMapType!==void 0&&(y.normalMapType=s.normalMapType),s.normalScale!==void 0){let M=s.normalScale;Array.isArray(M)===!1&&(M=[M,M]),y.normalScale=new Qt().fromArray(M)}return s.displacementMap!==void 0&&(y.displacementMap=p(s.displacementMap)),s.displacementScale!==void 0&&(y.displacementScale=s.displacementScale),s.displacementBias!==void 0&&(y.displacementBias=s.displacementBias),s.roughnessMap!==void 0&&(y.roughnessMap=p(s.roughnessMap)),s.metalnessMap!==void 0&&(y.metalnessMap=p(s.metalnessMap)),s.emissiveMap!==void 0&&(y.emissiveMap=p(s.emissiveMap)),s.emissiveIntensity!==void 0&&(y.emissiveIntensity=s.emissiveIntensity),s.specularMap!==void 0&&(y.specularMap=p(s.specularMap)),s.specularIntensityMap!==void 0&&(y.specularIntensityMap=p(s.specularIntensityMap)),s.specularColorMap!==void 0&&(y.specularColorMap=p(s.specularColorMap)),s.envMap!==void 0&&(y.envMap=p(s.envMap)),s.envMapIntensity!==void 0&&(y.envMapIntensity=s.envMapIntensity),s.reflectivity!==void 0&&(y.reflectivity=s.reflectivity),s.refractionRatio!==void 0&&(y.refractionRatio=s.refractionRatio),s.lightMap!==void 0&&(y.lightMap=p(s.lightMap)),s.lightMapIntensity!==void 0&&(y.lightMapIntensity=s.lightMapIntensity),s.aoMap!==void 0&&(y.aoMap=p(s.aoMap)),s.aoMapIntensity!==void 0&&(y.aoMapIntensity=s.aoMapIntensity),s.gradientMap!==void 0&&(y.gradientMap=p(s.gradientMap)),s.clearcoatMap!==void 0&&(y.clearcoatMap=p(s.clearcoatMap)),s.clearcoatRoughnessMap!==void 0&&(y.clearcoatRoughnessMap=p(s.clearcoatRoughnessMap)),s.clearcoatNormalMap!==void 0&&(y.clearcoatNormalMap=p(s.clearcoatNormalMap)),s.clearcoatNormalScale!==void 0&&(y.clearcoatNormalScale=new Qt().fromArray(s.clearcoatNormalScale)),s.transmissionMap!==void 0&&(y.transmissionMap=p(s.transmissionMap)),s.thicknessMap!==void 0&&(y.thicknessMap=p(s.thicknessMap)),s.sheenColorMap!==void 0&&(y.sheenColorMap=p(s.sheenColorMap)),s.sheenRoughnessMap!==void 0&&(y.sheenRoughnessMap=p(s.sheenRoughnessMap)),y}setTextures(s){return this.textures=s,this}}class Jg{static decodeText(s){if(typeof TextDecoder<"u")return new TextDecoder().decode(s);let c="";for(let p=0,y=s.length;p<y;p++)c+=String.fromCharCode(s[p]);try{return decodeURIComponent(escape(c))}catch{return c}}static extractUrlBase(s){const c=s.lastIndexOf("/");return c===-1?"./":s.substr(0,c+1)}static resolveURL(s,c){return typeof s!="string"||s===""?"":(/^https?:\/\//i.test(c)&&/^\//.test(s)&&(c=c.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(s)||/^data:.*,.*$/i.test(s)||/^blob:.*$/i.test(s)?s:c+s)}}class D_ extends si{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(s){return super.copy(s),this.instanceCount=s.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const s=super.toJSON(this);return s.instanceCount=this.instanceCount,s.isInstancedBufferGeometry=!0,s}}D_.prototype.isInstancedBufferGeometry=!0;class TT extends Es{constructor(s){super(s)}load(s,c,p,y){const M=this,C=new pa(M.manager);C.setPath(M.path),C.setRequestHeader(M.requestHeader),C.setWithCredentials(M.withCredentials),C.load(s,function(P){try{c(M.parse(JSON.parse(P)))}catch(F){y?y(F):console.error(F),M.manager.itemError(s)}},p,y)}parse(s){const c={},p={};function y(Y,ee){if(c[ee]!==void 0)return c[ee];const xe=Y.interleavedBuffers[ee],re=M(Y,xe.buffer),Q=eh(xe.type,re),De=new Xc(Q,xe.stride);return De.uuid=xe.uuid,c[ee]=De,De}function M(Y,ee){if(p[ee]!==void 0)return p[ee];const xe=Y.arrayBuffers[ee],re=new Uint32Array(xe).buffer;return p[ee]=re,re}const C=s.isInstancedBufferGeometry?new D_:new si,P=s.data.index;if(P!==void 0){const Y=eh(P.type,P.array);C.setIndex(new Hi(Y,1))}const F=s.data.attributes;for(const Y in F){const ee=F[Y];let de;if(ee.isInterleavedBufferAttribute){const xe=y(s.data,ee.data);de=new Wl(xe,ee.itemSize,ee.offset,ee.normalized)}else{const xe=eh(ee.type,ee.array),re=ee.isInstancedBufferAttribute?Yc:Hi;de=new re(xe,ee.itemSize,ee.normalized)}ee.name!==void 0&&(de.name=ee.name),ee.usage!==void 0&&de.setUsage(ee.usage),ee.updateRange!==void 0&&(de.updateRange.offset=ee.updateRange.offset,de.updateRange.count=ee.updateRange.count),C.setAttribute(Y,de)}const U=s.data.morphAttributes;if(U)for(const Y in U){const ee=U[Y],de=[];for(let xe=0,re=ee.length;xe<re;xe++){const Q=ee[xe];let De;if(Q.isInterleavedBufferAttribute){const Me=y(s.data,Q.data);De=new Wl(Me,Q.itemSize,Q.offset,Q.normalized)}else{const Me=eh(Q.type,Q.array);De=new Hi(Me,Q.itemSize,Q.normalized)}Q.name!==void 0&&(De.name=Q.name),de.push(De)}C.morphAttributes[Y]=de}s.data.morphTargetsRelative&&(C.morphTargetsRelative=!0);const W=s.data.groups||s.data.drawcalls||s.data.offsets;if(W!==void 0)for(let Y=0,ee=W.length;Y!==ee;++Y){const de=W[Y];C.addGroup(de.start,de.count,de.materialIndex)}const j=s.data.boundingSphere;if(j!==void 0){const Y=new Ge;j.center!==void 0&&Y.fromArray(j.center),C.boundingSphere=new Il(Y,j.radius)}return s.name&&(C.name=s.name),s.userData&&(C.userData=s.userData),C}}class pU extends Es{constructor(s){super(s)}load(s,c,p,y){const M=this,C=this.path===""?Jg.extractUrlBase(s):this.path;this.resourcePath=this.resourcePath||C;const P=new pa(this.manager);P.setPath(this.path),P.setRequestHeader(this.requestHeader),P.setWithCredentials(this.withCredentials),P.load(s,function(F){let U=null;try{U=JSON.parse(F)}catch(W){y!==void 0&&y(W),console.error("THREE:ObjectLoader: Can't parse "+s+".",W.message);return}const V=U.metadata;if(V===void 0||V.type===void 0||V.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+s);return}M.parse(U,c)},p,y)}async loadAsync(s,c){const p=this,y=this.path===""?Jg.extractUrlBase(s):this.path;this.resourcePath=this.resourcePath||y;const M=new pa(this.manager);M.setPath(this.path),M.setRequestHeader(this.requestHeader),M.setWithCredentials(this.withCredentials);const C=await M.loadAsync(s,c),P=JSON.parse(C),F=P.metadata;if(F===void 0||F.type===void 0||F.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+s);return await p.parseAsync(P)}parse(s,c){const p=this.parseAnimations(s.animations),y=this.parseShapes(s.shapes),M=this.parseGeometries(s.geometries,y),C=this.parseImages(s.images,function(){c!==void 0&&c(U)}),P=this.parseTextures(s.textures,C),F=this.parseMaterials(s.materials,P),U=this.parseObject(s.object,M,F,P,p),V=this.parseSkeletons(s.skeletons,U);if(this.bindSkeletons(U,V),c!==void 0){let W=!1;for(const j in C)if(C[j]instanceof HTMLImageElement){W=!0;break}W===!1&&c(U)}return U}async parseAsync(s){const c=this.parseAnimations(s.animations),p=this.parseShapes(s.shapes),y=this.parseGeometries(s.geometries,p),M=await this.parseImagesAsync(s.images),C=this.parseTextures(s.textures,M),P=this.parseMaterials(s.materials,C),F=this.parseObject(s.object,y,P,C,c),U=this.parseSkeletons(s.skeletons,F);return this.bindSkeletons(F,U),F}parseShapes(s){const c={};if(s!==void 0)for(let p=0,y=s.length;p<y;p++){const M=new ha().fromJSON(s[p]);c[M.uuid]=M}return c}parseSkeletons(s,c){const p={},y={};if(c.traverse(function(M){M.isBone&&(y[M.uuid]=M)}),s!==void 0)for(let M=0,C=s.length;M<C;M++){const P=new Ng().fromJSON(s[M],y);p[P.uuid]=P}return p}parseGeometries(s,c){const p={};if(s!==void 0){const M=new TT;for(let C=0,P=s.length;C<P;C++){let F;const U=s[C];switch(U.type){case"BufferGeometry":case"InstancedBufferGeometry":F=M.parse(U);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var y=new THREE.LegacyJSONLoader;F=y.parse(U,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:U.type in hT?F=hT[U.type].fromJSON(U,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${U.type}"`)}F.uuid=U.uuid,U.name!==void 0&&(F.name=U.name),F.isBufferGeometry===!0&&U.userData!==void 0&&(F.userData=U.userData),p[U.uuid]=F}}return p}parseMaterials(s,c){const p={},y={};if(s!==void 0){const M=new ST;M.setTextures(c);for(let C=0,P=s.length;C<P;C++){const F=s[C];if(F.type==="MultiMaterial"){const U=[];for(let V=0;V<F.materials.length;V++){const W=F.materials[V];p[W.uuid]===void 0&&(p[W.uuid]=M.parse(W)),U.push(p[W.uuid])}y[F.uuid]=U}else p[F.uuid]===void 0&&(p[F.uuid]=M.parse(F)),y[F.uuid]=p[F.uuid]}}return y}parseAnimations(s){const c={};if(s!==void 0)for(let p=0;p<s.length;p++){const y=s[p],M=jf.parse(y);c[M.uuid]=M}return c}parseImages(s,c){const p=this,y={};let M;function C(F){return p.manager.itemStart(F),M.load(F,function(){p.manager.itemEnd(F)},void 0,function(){p.manager.itemError(F),p.manager.itemEnd(F)})}function P(F){if(typeof F=="string"){const U=F,V=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(U)?U:p.resourcePath+U;return C(V)}else return F.data?{data:eh(F.type,F.data),width:F.width,height:F.height}:null}if(s!==void 0&&s.length>0){const F=new E_(c);M=new $f(F),M.setCrossOrigin(this.crossOrigin);for(let U=0,V=s.length;U<V;U++){const W=s[U],j=W.url;if(Array.isArray(j)){y[W.uuid]=[];for(let Y=0,ee=j.length;Y<ee;Y++){const de=j[Y],xe=P(de);xe!==null&&(xe instanceof HTMLImageElement?y[W.uuid].push(xe):y[W.uuid].push(new qc(xe.data,xe.width,xe.height)))}}else{const Y=P(W.url);Y!==null&&(y[W.uuid]=Y)}}}return y}async parseImagesAsync(s){const c=this,p={};let y;async function M(C){if(typeof C=="string"){const P=C,F=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(P)?P:c.resourcePath+P;return await y.loadAsync(F)}else return C.data?{data:eh(C.type,C.data),width:C.width,height:C.height}:null}if(s!==void 0&&s.length>0){y=new $f(this.manager),y.setCrossOrigin(this.crossOrigin);for(let C=0,P=s.length;C<P;C++){const F=s[C],U=F.url;if(Array.isArray(U)){p[F.uuid]=[];for(let V=0,W=U.length;V<W;V++){const j=U[V],Y=await M(j);Y!==null&&(Y instanceof HTMLImageElement?p[F.uuid].push(Y):p[F.uuid].push(new qc(Y.data,Y.width,Y.height)))}}else{const V=await M(F.url);V!==null&&(p[F.uuid]=V)}}}return p}parseTextures(s,c){function p(M,C){return typeof M=="number"?M:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",M),C[M])}const y={};if(s!==void 0)for(let M=0,C=s.length;M<C;M++){const P=s[M];P.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',P.uuid),c[P.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",P.image);let F;const U=c[P.image];Array.isArray(U)?(F=new mh(U),U.length===6&&(F.needsUpdate=!0)):(U&&U.data?F=new qc(U.data,U.width,U.height):F=new Nr(U),U&&(F.needsUpdate=!0)),F.uuid=P.uuid,P.name!==void 0&&(F.name=P.name),P.mapping!==void 0&&(F.mapping=p(P.mapping,mU)),P.offset!==void 0&&F.offset.fromArray(P.offset),P.repeat!==void 0&&F.repeat.fromArray(P.repeat),P.center!==void 0&&F.center.fromArray(P.center),P.rotation!==void 0&&(F.rotation=P.rotation),P.wrap!==void 0&&(F.wrapS=p(P.wrap[0],CT),F.wrapT=p(P.wrap[1],CT)),P.format!==void 0&&(F.format=P.format),P.type!==void 0&&(F.type=P.type),P.encoding!==void 0&&(F.encoding=P.encoding),P.minFilter!==void 0&&(F.minFilter=p(P.minFilter,RT)),P.magFilter!==void 0&&(F.magFilter=p(P.magFilter,RT)),P.anisotropy!==void 0&&(F.anisotropy=P.anisotropy),P.flipY!==void 0&&(F.flipY=P.flipY),P.premultiplyAlpha!==void 0&&(F.premultiplyAlpha=P.premultiplyAlpha),P.unpackAlignment!==void 0&&(F.unpackAlignment=P.unpackAlignment),P.userData!==void 0&&(F.userData=P.userData),y[P.uuid]=F}return y}parseObject(s,c,p,y,M){let C;function P(j){return c[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",j),c[j]}function F(j){if(j!==void 0){if(Array.isArray(j)){const Y=[];for(let ee=0,de=j.length;ee<de;ee++){const xe=j[ee];p[xe]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",xe),Y.push(p[xe])}return Y}return p[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",j),p[j]}}function U(j){return y[j]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",j),y[j]}let V,W;switch(s.type){case"Scene":C=new Tg,s.background!==void 0&&(Number.isInteger(s.background)?C.background=new Tn(s.background):C.background=U(s.background)),s.environment!==void 0&&(C.environment=U(s.environment)),s.fog!==void 0&&(s.fog.type==="Fog"?C.fog=new Rf(s.fog.color,s.fog.near,s.fog.far):s.fog.type==="FogExp2"&&(C.fog=new Cf(s.fog.color,s.fog.density)));break;case"PerspectiveCamera":C=new Br(s.fov,s.aspect,s.near,s.far),s.focus!==void 0&&(C.focus=s.focus),s.zoom!==void 0&&(C.zoom=s.zoom),s.filmGauge!==void 0&&(C.filmGauge=s.filmGauge),s.filmOffset!==void 0&&(C.filmOffset=s.filmOffset),s.view!==void 0&&(C.view=Object.assign({},s.view));break;case"OrthographicCamera":C=new Mf(s.left,s.right,s.top,s.bottom,s.near,s.far),s.zoom!==void 0&&(C.zoom=s.zoom),s.view!==void 0&&(C.view=Object.assign({},s.view));break;case"AmbientLight":C=new R_(s.color,s.intensity);break;case"DirectionalLight":C=new C_(s.color,s.intensity);break;case"PointLight":C=new T_(s.color,s.intensity,s.distance,s.decay);break;case"RectAreaLight":C=new L_(s.color,s.intensity,s.width,s.height);break;case"SpotLight":C=new M_(s.color,s.intensity,s.distance,s.angle,s.penumbra,s.decay);break;case"HemisphereLight":C=new A_(s.color,s.groundColor,s.intensity);break;case"LightProbe":C=new qf().fromJSON(s);break;case"SkinnedMesh":V=P(s.geometry),W=F(s.material),C=new Ig(V,W),s.bindMode!==void 0&&(C.bindMode=s.bindMode),s.bindMatrix!==void 0&&C.bindMatrix.fromArray(s.bindMatrix),s.skeleton!==void 0&&(C.skeleton=s.skeleton);break;case"Mesh":V=P(s.geometry),W=F(s.material),C=new Fr(V,W);break;case"InstancedMesh":V=P(s.geometry),W=F(s.material);const j=s.count,Y=s.instanceMatrix,ee=s.instanceColor;C=new qx(V,W,j),C.instanceMatrix=new Yc(new Float32Array(Y.array),16),ee!==void 0&&(C.instanceColor=new Yc(new Float32Array(ee.array),ee.itemSize));break;case"LOD":C=new FS;break;case"Line":C=new Wa(P(s.geometry),F(s.material));break;case"LineLoop":C=new Kx(P(s.geometry),F(s.material));break;case"LineSegments":C=new Is(P(s.geometry),F(s.material));break;case"PointCloud":case"Points":C=new If(P(s.geometry),F(s.material));break;case"Sprite":C=new Pg(F(s.material));break;case"Group":C=new Vl;break;case"Bone":C=new kg;break;default:C=new Oi}if(C.uuid=s.uuid,s.name!==void 0&&(C.name=s.name),s.matrix!==void 0?(C.matrix.fromArray(s.matrix),s.matrixAutoUpdate!==void 0&&(C.matrixAutoUpdate=s.matrixAutoUpdate),C.matrixAutoUpdate&&C.matrix.decompose(C.position,C.quaternion,C.scale)):(s.position!==void 0&&C.position.fromArray(s.position),s.rotation!==void 0&&C.rotation.fromArray(s.rotation),s.quaternion!==void 0&&C.quaternion.fromArray(s.quaternion),s.scale!==void 0&&C.scale.fromArray(s.scale)),s.castShadow!==void 0&&(C.castShadow=s.castShadow),s.receiveShadow!==void 0&&(C.receiveShadow=s.receiveShadow),s.shadow&&(s.shadow.bias!==void 0&&(C.shadow.bias=s.shadow.bias),s.shadow.normalBias!==void 0&&(C.shadow.normalBias=s.shadow.normalBias),s.shadow.radius!==void 0&&(C.shadow.radius=s.shadow.radius),s.shadow.mapSize!==void 0&&C.shadow.mapSize.fromArray(s.shadow.mapSize),s.shadow.camera!==void 0&&(C.shadow.camera=this.parseObject(s.shadow.camera))),s.visible!==void 0&&(C.visible=s.visible),s.frustumCulled!==void 0&&(C.frustumCulled=s.frustumCulled),s.renderOrder!==void 0&&(C.renderOrder=s.renderOrder),s.userData!==void 0&&(C.userData=s.userData),s.layers!==void 0&&(C.layers.mask=s.layers),s.children!==void 0){const j=s.children;for(let Y=0;Y<j.length;Y++)C.add(this.parseObject(j[Y],c,p,y,M))}if(s.animations!==void 0){const j=s.animations;for(let Y=0;Y<j.length;Y++){const ee=j[Y];C.animations.push(M[ee])}}if(s.type==="LOD"){s.autoUpdate!==void 0&&(C.autoUpdate=s.autoUpdate);const j=s.levels;for(let Y=0;Y<j.length;Y++){const ee=j[Y],de=C.getObjectByProperty("uuid",ee.object);de!==void 0&&C.addLevel(de,ee.distance)}}return C}bindSkeletons(s,c){Object.keys(c).length!==0&&s.traverse(function(p){if(p.isSkinnedMesh===!0&&p.skeleton!==void 0){const y=c[p.skeleton];y===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",p.skeleton):p.bind(y,p.bindMatrix)}})}setTexturePath(s){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(s)}}const mU={UVMapping:G,CubeReflectionMapping:$,CubeRefractionMapping:me,EquirectangularReflectionMapping:Pe,EquirectangularRefractionMapping:ve,CubeUVReflectionMapping:Le,CubeUVRefractionMapping:wt},CT={RepeatWrapping:Ot,ClampToEdgeWrapping:_t,MirroredRepeatWrapping:Ut},RT={NearestFilter:It,NearestMipmapNearestFilter:dn,NearestMipmapLinearFilter:$n,LinearFilter:Ve,LinearMipmapNearestFilter:nt,LinearMipmapLinearFilter:Wt};class LT extends Es{constructor(s){super(s),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(s){return this.options=s,this}load(s,c,p,y){s===void 0&&(s=""),this.path!==void 0&&(s=this.path+s),s=this.manager.resolveURL(s);const M=this,C=nu.get(s);if(C!==void 0)return M.manager.itemStart(s),setTimeout(function(){c&&c(C),M.manager.itemEnd(s)},0),C;const P={};P.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",P.headers=this.requestHeader,fetch(s,P).then(function(F){return F.blob()}).then(function(F){return createImageBitmap(F,Object.assign(M.options,{colorSpaceConversion:"none"}))}).then(function(F){nu.add(s,F),c&&c(F),M.manager.itemEnd(s)}).catch(function(F){y&&y(F),M.manager.itemError(s),M.manager.itemEnd(s)}),M.manager.itemStart(s)}}LT.prototype.isImageBitmapLoader=!0;let ev;const O_={getContext:function(){return ev===void 0&&(ev=new(window.AudioContext||window.webkitAudioContext)),ev},setContext:function(b){ev=b}};class PT extends Es{constructor(s){super(s)}load(s,c,p,y){const M=this,C=new pa(this.manager);C.setResponseType("arraybuffer"),C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(s,function(P){try{const F=P.slice(0);O_.getContext().decodeAudioData(F,function(V){c(V)})}catch(F){y?y(F):console.error(F),M.manager.itemError(s)}},p,y)}}class DT extends qf{constructor(s,c,p=1){super(void 0,p);const y=new Tn().set(s),M=new Tn().set(c),C=new Ge(y.r,y.g,y.b),P=new Ge(M.r,M.g,M.b),F=Math.sqrt(Math.PI),U=F*Math.sqrt(.75);this.sh.coefficients[0].copy(C).add(P).multiplyScalar(F),this.sh.coefficients[1].copy(C).sub(P).multiplyScalar(U)}}DT.prototype.isHemisphereLightProbe=!0;class OT extends qf{constructor(s,c=1){super(void 0,c);const p=new Tn().set(s);this.sh.coefficients[0].set(p.r,p.g,p.b).multiplyScalar(2*Math.sqrt(Math.PI))}}OT.prototype.isAmbientLightProbe=!0;const IT=new zn,kT=new zn,iu=new zn;class gU{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Br,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Br,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(s){const c=this._cache;if(c.focus!==s.focus||c.fov!==s.fov||c.aspect!==s.aspect*this.aspect||c.near!==s.near||c.far!==s.far||c.zoom!==s.zoom||c.eyeSep!==this.eyeSep){c.focus=s.focus,c.fov=s.fov,c.aspect=s.aspect*this.aspect,c.near=s.near,c.far=s.far,c.zoom=s.zoom,c.eyeSep=this.eyeSep,iu.copy(s.projectionMatrix);const y=c.eyeSep/2,M=y*c.near/c.focus,C=c.near*Math.tan(zc*c.fov*.5)/c.zoom;let P,F;kT.elements[12]=-y,IT.elements[12]=y,P=-C*c.aspect+M,F=C*c.aspect+M,iu.elements[0]=2*c.near/(F-P),iu.elements[8]=(F+P)/(F-P),this.cameraL.projectionMatrix.copy(iu),P=-C*c.aspect-M,F=C*c.aspect-M,iu.elements[0]=2*c.near/(F-P),iu.elements[8]=(F+P)/(F-P),this.cameraR.projectionMatrix.copy(iu)}this.cameraL.matrixWorld.copy(s.matrixWorld).multiply(kT),this.cameraR.matrixWorld.copy(s.matrixWorld).multiply(IT)}}class NT{constructor(s=!0){this.autoStart=s,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=FT(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let s=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=FT();s=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=s}return s}}function FT(){return(typeof performance>"u"?Date:performance).now()}const ru=new Ge,BT=new Yr,vU=new Ge,su=new Ge;class yU extends Oi{constructor(){super(),this.type="AudioListener",this.context=O_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new NT}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(s){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=s,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this}updateMatrixWorld(s){super.updateMatrixWorld(s);const c=this.context.listener,p=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(ru,BT,vU),su.set(0,0,-1).applyQuaternion(BT),c.positionX){const y=this.context.currentTime+this.timeDelta;c.positionX.linearRampToValueAtTime(ru.x,y),c.positionY.linearRampToValueAtTime(ru.y,y),c.positionZ.linearRampToValueAtTime(ru.z,y),c.forwardX.linearRampToValueAtTime(su.x,y),c.forwardY.linearRampToValueAtTime(su.y,y),c.forwardZ.linearRampToValueAtTime(su.z,y),c.upX.linearRampToValueAtTime(p.x,y),c.upY.linearRampToValueAtTime(p.y,y),c.upZ.linearRampToValueAtTime(p.z,y)}else c.setPosition(ru.x,ru.y,ru.z),c.setOrientation(su.x,su.y,su.z,p.x,p.y,p.z)}}class I_ extends Oi{constructor(s){super(),this.type="Audio",this.listener=s,this.context=s.context,this.gain=this.context.createGain(),this.gain.connect(s.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(s){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=s,this.connect(),this}setMediaElementSource(s){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(s),this.connect(),this}setMediaStreamSource(s){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(s),this.connect(),this}setBuffer(s){return this.buffer=s,this.sourceType="buffer",this.autoplay&&this.play(),this}play(s=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+s;const c=this.context.createBufferSource();return c.buffer=this.buffer,c.loop=this.loop,c.loopStart=this.loopStart,c.loopEnd=this.loopEnd,c.onended=this.onEnded.bind(this),c.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=c,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let s=1,c=this.filters.length;s<c;s++)this.filters[s-1].connect(this.filters[s]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let s=1,c=this.filters.length;s<c;s++)this.filters[s-1].disconnect(this.filters[s]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(s){return s||(s=[]),this._connected===!0?(this.disconnect(),this.filters=s.slice(),this.connect()):this.filters=s.slice(),this}setDetune(s){if(this.detune=s,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(s){return this.setFilters(s?[s]:[])}setPlaybackRate(s){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=s,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(s){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=s,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(s){return this.loopStart=s,this}setLoopEnd(s){return this.loopEnd=s,this}getVolume(){return this.gain.gain.value}setVolume(s){return this.gain.gain.setTargetAtTime(s,this.context.currentTime,.01),this}}const ou=new Ge,UT=new Yr,xU=new Ge,au=new Ge;class _U extends I_{constructor(s){super(s),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(s){return this.panner.refDistance=s,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(s){return this.panner.rolloffFactor=s,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(s){return this.panner.distanceModel=s,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(s){return this.panner.maxDistance=s,this}setDirectionalCone(s,c,p){return this.panner.coneInnerAngle=s,this.panner.coneOuterAngle=c,this.panner.coneOuterGain=p,this}updateMatrixWorld(s){if(super.updateMatrixWorld(s),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ou,UT,xU),au.set(0,0,1).applyQuaternion(UT);const c=this.panner;if(c.positionX){const p=this.context.currentTime+this.listener.timeDelta;c.positionX.linearRampToValueAtTime(ou.x,p),c.positionY.linearRampToValueAtTime(ou.y,p),c.positionZ.linearRampToValueAtTime(ou.z,p),c.orientationX.linearRampToValueAtTime(au.x,p),c.orientationY.linearRampToValueAtTime(au.y,p),c.orientationZ.linearRampToValueAtTime(au.z,p)}else c.setPosition(ou.x,ou.y,ou.z),c.setOrientation(au.x,au.y,au.z)}}class zT{constructor(s,c=2048){this.analyser=s.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),s.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let s=0;const c=this.getFrequencyData();for(let p=0;p<c.length;p++)s+=c[p];return s/c.length}}class HT{constructor(s,c,p){this.binding=s,this.valueSize=p;let y,M,C;switch(c){case"quaternion":y=this._slerp,M=this._slerpAdditive,C=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(p*6),this._workIndex=5;break;case"string":case"bool":y=this._select,M=this._select,C=this._setAdditiveIdentityOther,this.buffer=new Array(p*5);break;default:y=this._lerp,M=this._lerpAdditive,C=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(p*5)}this._mixBufferRegion=y,this._mixBufferRegionAdditive=M,this._setIdentity=C,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(s,c){const p=this.buffer,y=this.valueSize,M=s*y+y;let C=this.cumulativeWeight;if(C===0){for(let P=0;P!==y;++P)p[M+P]=p[P];C=c}else{C+=c;const P=c/C;this._mixBufferRegion(p,M,0,P,y)}this.cumulativeWeight=C}accumulateAdditive(s){const c=this.buffer,p=this.valueSize,y=p*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(c,y,0,s,p),this.cumulativeWeightAdditive+=s}apply(s){const c=this.valueSize,p=this.buffer,y=s*c+c,M=this.cumulativeWeight,C=this.cumulativeWeightAdditive,P=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,M<1){const F=c*this._origIndex;this._mixBufferRegion(p,y,F,1-M,c)}C>0&&this._mixBufferRegionAdditive(p,y,this._addIndex*c,1,c);for(let F=c,U=c+c;F!==U;++F)if(p[F]!==p[F+c]){P.setValue(p,y);break}}saveOriginalState(){const s=this.binding,c=this.buffer,p=this.valueSize,y=p*this._origIndex;s.getValue(c,y);for(let M=p,C=y;M!==C;++M)c[M]=c[y+M%p];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const s=this.valueSize*3;this.binding.setValue(this.buffer,s)}_setAdditiveIdentityNumeric(){const s=this._addIndex*this.valueSize,c=s+this.valueSize;for(let p=s;p<c;p++)this.buffer[p]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const s=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let p=0;p<this.valueSize;p++)this.buffer[c+p]=this.buffer[s+p]}_select(s,c,p,y,M){if(y>=.5)for(let C=0;C!==M;++C)s[c+C]=s[p+C]}_slerp(s,c,p,y){Yr.slerpFlat(s,c,s,c,s,p,y)}_slerpAdditive(s,c,p,y,M){const C=this._workIndex*M;Yr.multiplyQuaternionsFlat(s,C,s,c,s,p),Yr.slerpFlat(s,c,s,c,s,C,y)}_lerp(s,c,p,y,M){const C=1-y;for(let P=0;P!==M;++P){const F=c+P;s[F]=s[F]*C+s[p+P]*y}}_lerpAdditive(s,c,p,y,M){for(let C=0;C!==M;++C){const P=c+C;s[P]=s[P]+s[p+C]*y}}}const k_="\\[\\]\\.:\\/",bU=new RegExp("["+k_+"]","g"),N_="[^"+k_+"]",EU="[^"+k_.replace("\\.","")+"]",AU=/((?:WC+[\/:])*)/.source.replace("WC",N_),wU=/(WCOD+)?/.source.replace("WCOD",EU),MU=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",N_),SU=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",N_),TU=new RegExp("^"+AU+wU+MU+SU+"$"),CU=["material","materials","bones"];class RU{constructor(s,c,p){const y=p||ji.parseTrackName(c);this._targetGroup=s,this._bindings=s.subscribe_(c,y)}getValue(s,c){this.bind();const p=this._targetGroup.nCachedObjects_,y=this._bindings[p];y!==void 0&&y.getValue(s,c)}setValue(s,c){const p=this._bindings;for(let y=this._targetGroup.nCachedObjects_,M=p.length;y!==M;++y)p[y].setValue(s,c)}bind(){const s=this._bindings;for(let c=this._targetGroup.nCachedObjects_,p=s.length;c!==p;++c)s[c].bind()}unbind(){const s=this._bindings;for(let c=this._targetGroup.nCachedObjects_,p=s.length;c!==p;++c)s[c].unbind()}}class ji{constructor(s,c,p){this.path=c,this.parsedPath=p||ji.parseTrackName(c),this.node=ji.findNode(s,this.parsedPath.nodeName)||s,this.rootNode=s,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(s,c,p){return s&&s.isAnimationObjectGroup?new ji.Composite(s,c,p):new ji(s,c,p)}static sanitizeNodeName(s){return s.replace(/\s/g,"_").replace(bU,"")}static parseTrackName(s){const c=TU.exec(s);if(!c)throw new Error("PropertyBinding: Cannot parse trackName: "+s);const p={nodeName:c[2],objectName:c[3],objectIndex:c[4],propertyName:c[5],propertyIndex:c[6]},y=p.nodeName&&p.nodeName.lastIndexOf(".");if(y!==void 0&&y!==-1){const M=p.nodeName.substring(y+1);CU.indexOf(M)!==-1&&(p.nodeName=p.nodeName.substring(0,y),p.objectName=M)}if(p.propertyName===null||p.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+s);return p}static findNode(s,c){if(!c||c===""||c==="."||c===-1||c===s.name||c===s.uuid)return s;if(s.skeleton){const p=s.skeleton.getBoneByName(c);if(p!==void 0)return p}if(s.children){const p=function(M){for(let C=0;C<M.length;C++){const P=M[C];if(P.name===c||P.uuid===c)return P;const F=p(P.children);if(F)return F}return null},y=p(s.children);if(y)return y}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(s,c){s[c]=this.targetObject[this.propertyName]}_getValue_array(s,c){const p=this.resolvedProperty;for(let y=0,M=p.length;y!==M;++y)s[c++]=p[y]}_getValue_arrayElement(s,c){s[c]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(s,c){this.resolvedProperty.toArray(s,c)}_setValue_direct(s,c){this.targetObject[this.propertyName]=s[c]}_setValue_direct_setNeedsUpdate(s,c){this.targetObject[this.propertyName]=s[c],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(s,c){this.targetObject[this.propertyName]=s[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(s,c){const p=this.resolvedProperty;for(let y=0,M=p.length;y!==M;++y)p[y]=s[c++]}_setValue_array_setNeedsUpdate(s,c){const p=this.resolvedProperty;for(let y=0,M=p.length;y!==M;++y)p[y]=s[c++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(s,c){const p=this.resolvedProperty;for(let y=0,M=p.length;y!==M;++y)p[y]=s[c++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(s,c){this.resolvedProperty[this.propertyIndex]=s[c]}_setValue_arrayElement_setNeedsUpdate(s,c){this.resolvedProperty[this.propertyIndex]=s[c],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(s,c){this.resolvedProperty[this.propertyIndex]=s[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(s,c){this.resolvedProperty.fromArray(s,c)}_setValue_fromArray_setNeedsUpdate(s,c){this.resolvedProperty.fromArray(s,c),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(s,c){this.resolvedProperty.fromArray(s,c),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(s,c){this.bind(),this.getValue(s,c)}_setValue_unbound(s,c){this.bind(),this.setValue(s,c)}bind(){let s=this.node;const c=this.parsedPath,p=c.objectName,y=c.propertyName;let M=c.propertyIndex;if(s||(s=ji.findNode(this.rootNode,c.nodeName)||this.rootNode,this.node=s),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!s){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(p){let U=c.objectIndex;switch(p){case"materials":if(!s.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!s.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}s=s.material.materials;break;case"bones":if(!s.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}s=s.skeleton.bones;for(let V=0;V<s.length;V++)if(s[V].name===U){U=V;break}break;default:if(s[p]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}s=s[p]}if(U!==void 0){if(s[U]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,s);return}s=s[U]}}const C=s[y];if(C===void 0){const U=c.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+U+"."+y+" but it wasn't found.",s);return}let P=this.Versioning.None;this.targetObject=s,s.needsUpdate!==void 0?P=this.Versioning.NeedsUpdate:s.matrixWorldNeedsUpdate!==void 0&&(P=this.Versioning.MatrixWorldNeedsUpdate);let F=this.BindingType.Direct;if(M!==void 0){if(y==="morphTargetInfluences"){if(!s.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(s.geometry.isBufferGeometry){if(!s.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}s.morphTargetDictionary[M]!==void 0&&(M=s.morphTargetDictionary[M])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}F=this.BindingType.ArrayElement,this.resolvedProperty=C,this.propertyIndex=M}else C.fromArray!==void 0&&C.toArray!==void 0?(F=this.BindingType.HasFromToArray,this.resolvedProperty=C):Array.isArray(C)?(F=this.BindingType.EntireArray,this.resolvedProperty=C):this.propertyName=y;this.getValue=this.GetterByBindingType[F],this.setValue=this.SetterByBindingTypeAndVersioning[F][P]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ji.Composite=RU,ji.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},ji.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},ji.prototype.GetterByBindingType=[ji.prototype._getValue_direct,ji.prototype._getValue_array,ji.prototype._getValue_arrayElement,ji.prototype._getValue_toArray],ji.prototype.SetterByBindingTypeAndVersioning=[[ji.prototype._setValue_direct,ji.prototype._setValue_direct_setNeedsUpdate,ji.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_array,ji.prototype._setValue_array_setNeedsUpdate,ji.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_arrayElement,ji.prototype._setValue_arrayElement_setNeedsUpdate,ji.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ji.prototype._setValue_fromArray,ji.prototype._setValue_fromArray_setNeedsUpdate,ji.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class GT{constructor(){this.uuid=Ws(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const s={};this._indicesByUUID=s;for(let p=0,y=arguments.length;p!==y;++p)s[arguments[p].uuid]=p;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const s=this._objects,c=this._indicesByUUID,p=this._paths,y=this._parsedPaths,M=this._bindings,C=M.length;let P,F=s.length,U=this.nCachedObjects_;for(let V=0,W=arguments.length;V!==W;++V){const j=arguments[V],Y=j.uuid;let ee=c[Y];if(ee===void 0){ee=F++,c[Y]=ee,s.push(j);for(let de=0,xe=C;de!==xe;++de)M[de].push(new ji(j,p[de],y[de]))}else if(ee<U){P=s[ee];const de=--U,xe=s[de];c[xe.uuid]=ee,s[ee]=xe,c[Y]=de,s[de]=j;for(let re=0,Q=C;re!==Q;++re){const De=M[re],Me=De[de];let Ie=De[ee];De[ee]=Me,Ie===void 0&&(Ie=new ji(j,p[re],y[re])),De[de]=Ie}}else s[ee]!==P&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=U}remove(){const s=this._objects,c=this._indicesByUUID,p=this._bindings,y=p.length;let M=this.nCachedObjects_;for(let C=0,P=arguments.length;C!==P;++C){const F=arguments[C],U=F.uuid,V=c[U];if(V!==void 0&&V>=M){const W=M++,j=s[W];c[j.uuid]=V,s[V]=j,c[U]=W,s[W]=F;for(let Y=0,ee=y;Y!==ee;++Y){const de=p[Y],xe=de[W],re=de[V];de[V]=xe,de[W]=re}}}this.nCachedObjects_=M}uncache(){const s=this._objects,c=this._indicesByUUID,p=this._bindings,y=p.length;let M=this.nCachedObjects_,C=s.length;for(let P=0,F=arguments.length;P!==F;++P){const U=arguments[P],V=U.uuid,W=c[V];if(W!==void 0)if(delete c[V],W<M){const j=--M,Y=s[j],ee=--C,de=s[ee];c[Y.uuid]=W,s[W]=Y,c[de.uuid]=j,s[j]=de,s.pop();for(let xe=0,re=y;xe!==re;++xe){const Q=p[xe],De=Q[j],Me=Q[ee];Q[W]=De,Q[j]=Me,Q.pop()}}else{const j=--C,Y=s[j];j>0&&(c[Y.uuid]=W),s[W]=Y,s.pop();for(let ee=0,de=y;ee!==de;++ee){const xe=p[ee];xe[W]=xe[j],xe.pop()}}}this.nCachedObjects_=M}subscribe_(s,c){const p=this._bindingsIndicesByPath;let y=p[s];const M=this._bindings;if(y!==void 0)return M[y];const C=this._paths,P=this._parsedPaths,F=this._objects,U=F.length,V=this.nCachedObjects_,W=new Array(U);y=M.length,p[s]=y,C.push(s),P.push(c),M.push(W);for(let j=V,Y=F.length;j!==Y;++j){const ee=F[j];W[j]=new ji(ee,s,c)}return W}unsubscribe_(s){const c=this._bindingsIndicesByPath,p=c[s];if(p!==void 0){const y=this._paths,M=this._parsedPaths,C=this._bindings,P=C.length-1,F=C[P],U=s[P];c[U]=p,C[p]=F,C.pop(),M[p]=M[P],M.pop(),y[p]=y[P],y.pop()}}}GT.prototype.isAnimationObjectGroup=!0;class LU{constructor(s,c,p=null,y=c.blendMode){this._mixer=s,this._clip=c,this._localRoot=p,this.blendMode=y;const M=c.tracks,C=M.length,P=new Array(C),F={endingStart:Te,endingEnd:Te};for(let U=0;U!==C;++U){const V=M[U].createInterpolant(null);P[U]=V,V.settings=F}this._interpolantSettings=F,this._interpolants=P,this._propertyBindings=new Array(C),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=xt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(s){return this._startTime=s,this}setLoop(s,c){return this.loop=s,this.repetitions=c,this}setEffectiveWeight(s){return this.weight=s,this._effectiveWeight=this.enabled?s:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(s){return this._scheduleFading(s,0,1)}fadeOut(s){return this._scheduleFading(s,1,0)}crossFadeFrom(s,c,p){if(s.fadeOut(c),this.fadeIn(c),p){const y=this._clip.duration,M=s._clip.duration,C=M/y,P=y/M;s.warp(1,C,c),this.warp(P,1,c)}return this}crossFadeTo(s,c,p){return s.crossFadeFrom(this,c,p)}stopFading(){const s=this._weightInterpolant;return s!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(s)),this}setEffectiveTimeScale(s){return this.timeScale=s,this._effectiveTimeScale=this.paused?0:s,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(s){return this.timeScale=this._clip.duration/s,this.stopWarping()}syncWith(s){return this.time=s.time,this.timeScale=s.timeScale,this.stopWarping()}halt(s){return this.warp(this._effectiveTimeScale,0,s)}warp(s,c,p){const y=this._mixer,M=y.time,C=this.timeScale;let P=this._timeScaleInterpolant;P===null&&(P=y._lendControlInterpolant(),this._timeScaleInterpolant=P);const F=P.parameterPositions,U=P.sampleValues;return F[0]=M,F[1]=M+p,U[0]=s/C,U[1]=c/C,this}stopWarping(){const s=this._timeScaleInterpolant;return s!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(s)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(s,c,p,y){if(!this.enabled){this._updateWeight(s);return}const M=this._startTime;if(M!==null){const F=(s-M)*p;if(F<0||p===0)return;this._startTime=null,c=p*F}c*=this._updateTimeScale(s);const C=this._updateTime(c),P=this._updateWeight(s);if(P>0){const F=this._interpolants,U=this._propertyBindings;switch(this.blendMode){case Ft:for(let V=0,W=F.length;V!==W;++V)F[V].evaluate(C),U[V].accumulateAdditive(P);break;case Mt:default:for(let V=0,W=F.length;V!==W;++V)F[V].evaluate(C),U[V].accumulate(y,P)}}}_updateWeight(s){let c=0;if(this.enabled){c=this.weight;const p=this._weightInterpolant;if(p!==null){const y=p.evaluate(s)[0];c*=y,s>p.parameterPositions[1]&&(this.stopFading(),y===0&&(this.enabled=!1))}}return this._effectiveWeight=c,c}_updateTimeScale(s){let c=0;if(!this.paused){c=this.timeScale;const p=this._timeScaleInterpolant;if(p!==null){const y=p.evaluate(s)[0];c*=y,s>p.parameterPositions[1]&&(this.stopWarping(),c===0?this.paused=!0:this.timeScale=c)}}return this._effectiveTimeScale=c,c}_updateTime(s){const c=this._clip.duration,p=this.loop;let y=this.time+s,M=this._loopCount;const C=p===pt;if(s===0)return M===-1?y:C&&(M&1)===1?c-y:y;if(p===qt){M===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(y>=c)y=c;else if(y<0)y=0;else{this.time=y;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=y,this._mixer.dispatchEvent({type:"finished",action:this,direction:s<0?-1:1})}}else{if(M===-1&&(s>=0?(M=0,this._setEndings(!0,this.repetitions===0,C)):this._setEndings(this.repetitions===0,!0,C)),y>=c||y<0){const P=Math.floor(y/c);y-=c*P,M+=Math.abs(P);const F=this.repetitions-M;if(F<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,y=s>0?c:0,this.time=y,this._mixer.dispatchEvent({type:"finished",action:this,direction:s>0?1:-1});else{if(F===1){const U=s<0;this._setEndings(U,!U,C)}else this._setEndings(!1,!1,C);this._loopCount=M,this.time=y,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:P})}}else this.time=y;if(C&&(M&1)===1)return c-y}return y}_setEndings(s,c,p){const y=this._interpolantSettings;p?(y.endingStart=Ae,y.endingEnd=Ae):(s?y.endingStart=this.zeroSlopeAtStart?Ae:Te:y.endingStart=rt,c?y.endingEnd=this.zeroSlopeAtEnd?Ae:Te:y.endingEnd=rt)}_scheduleFading(s,c,p){const y=this._mixer,M=y.time;let C=this._weightInterpolant;C===null&&(C=y._lendControlInterpolant(),this._weightInterpolant=C);const P=C.parameterPositions,F=C.sampleValues;return P[0]=M,F[0]=c,P[1]=M+s,F[1]=p,this}}class VT extends ka{constructor(s){super(),this._root=s,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(s,c){const p=s._localRoot||this._root,y=s._clip.tracks,M=y.length,C=s._propertyBindings,P=s._interpolants,F=p.uuid,U=this._bindingsByRootAndName;let V=U[F];V===void 0&&(V={},U[F]=V);for(let W=0;W!==M;++W){const j=y[W],Y=j.name;let ee=V[Y];if(ee!==void 0)++ee.referenceCount,C[W]=ee;else{if(ee=C[W],ee!==void 0){ee._cacheIndex===null&&(++ee.referenceCount,this._addInactiveBinding(ee,F,Y));continue}const de=c&&c._propertyBindings[W].binding.parsedPath;ee=new HT(ji.create(p,Y,de),j.ValueTypeName,j.getValueSize()),++ee.referenceCount,this._addInactiveBinding(ee,F,Y),C[W]=ee}P[W].resultBuffer=ee.buffer}}_activateAction(s){if(!this._isActiveAction(s)){if(s._cacheIndex===null){const p=(s._localRoot||this._root).uuid,y=s._clip.uuid,M=this._actionsByClip[y];this._bindAction(s,M&&M.knownActions[0]),this._addInactiveAction(s,y,p)}const c=s._propertyBindings;for(let p=0,y=c.length;p!==y;++p){const M=c[p];M.useCount++===0&&(this._lendBinding(M),M.saveOriginalState())}this._lendAction(s)}}_deactivateAction(s){if(this._isActiveAction(s)){const c=s._propertyBindings;for(let p=0,y=c.length;p!==y;++p){const M=c[p];--M.useCount===0&&(M.restoreOriginalState(),this._takeBackBinding(M))}this._takeBackAction(s)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const s=this;this.stats={actions:{get total(){return s._actions.length},get inUse(){return s._nActiveActions}},bindings:{get total(){return s._bindings.length},get inUse(){return s._nActiveBindings}},controlInterpolants:{get total(){return s._controlInterpolants.length},get inUse(){return s._nActiveControlInterpolants}}}}_isActiveAction(s){const c=s._cacheIndex;return c!==null&&c<this._nActiveActions}_addInactiveAction(s,c,p){const y=this._actions,M=this._actionsByClip;let C=M[c];if(C===void 0)C={knownActions:[s],actionByRoot:{}},s._byClipCacheIndex=0,M[c]=C;else{const P=C.knownActions;s._byClipCacheIndex=P.length,P.push(s)}s._cacheIndex=y.length,y.push(s),C.actionByRoot[p]=s}_removeInactiveAction(s){const c=this._actions,p=c[c.length-1],y=s._cacheIndex;p._cacheIndex=y,c[y]=p,c.pop(),s._cacheIndex=null;const M=s._clip.uuid,C=this._actionsByClip,P=C[M],F=P.knownActions,U=F[F.length-1],V=s._byClipCacheIndex;U._byClipCacheIndex=V,F[V]=U,F.pop(),s._byClipCacheIndex=null;const W=P.actionByRoot,j=(s._localRoot||this._root).uuid;delete W[j],F.length===0&&delete C[M],this._removeInactiveBindingsForAction(s)}_removeInactiveBindingsForAction(s){const c=s._propertyBindings;for(let p=0,y=c.length;p!==y;++p){const M=c[p];--M.referenceCount===0&&this._removeInactiveBinding(M)}}_lendAction(s){const c=this._actions,p=s._cacheIndex,y=this._nActiveActions++,M=c[y];s._cacheIndex=y,c[y]=s,M._cacheIndex=p,c[p]=M}_takeBackAction(s){const c=this._actions,p=s._cacheIndex,y=--this._nActiveActions,M=c[y];s._cacheIndex=y,c[y]=s,M._cacheIndex=p,c[p]=M}_addInactiveBinding(s,c,p){const y=this._bindingsByRootAndName,M=this._bindings;let C=y[c];C===void 0&&(C={},y[c]=C),C[p]=s,s._cacheIndex=M.length,M.push(s)}_removeInactiveBinding(s){const c=this._bindings,p=s.binding,y=p.rootNode.uuid,M=p.path,C=this._bindingsByRootAndName,P=C[y],F=c[c.length-1],U=s._cacheIndex;F._cacheIndex=U,c[U]=F,c.pop(),delete P[M],Object.keys(P).length===0&&delete C[y]}_lendBinding(s){const c=this._bindings,p=s._cacheIndex,y=this._nActiveBindings++,M=c[y];s._cacheIndex=y,c[y]=s,M._cacheIndex=p,c[p]=M}_takeBackBinding(s){const c=this._bindings,p=s._cacheIndex,y=--this._nActiveBindings,M=c[y];s._cacheIndex=y,c[y]=s,M._cacheIndex=p,c[p]=M}_lendControlInterpolant(){const s=this._controlInterpolants,c=this._nActiveControlInterpolants++;let p=s[c];return p===void 0&&(p=new __(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),p.__cacheIndex=c,s[c]=p),p}_takeBackControlInterpolant(s){const c=this._controlInterpolants,p=s.__cacheIndex,y=--this._nActiveControlInterpolants,M=c[y];s.__cacheIndex=y,c[y]=s,M.__cacheIndex=p,c[p]=M}clipAction(s,c,p){const y=c||this._root,M=y.uuid;let C=typeof s=="string"?jf.findByName(y,s):s;const P=C!==null?C.uuid:s,F=this._actionsByClip[P];let U=null;if(p===void 0&&(C!==null?p=C.blendMode:p=Mt),F!==void 0){const W=F.actionByRoot[M];if(W!==void 0&&W.blendMode===p)return W;U=F.knownActions[0],C===null&&(C=U._clip)}if(C===null)return null;const V=new LU(this,C,c,p);return this._bindAction(V,U),this._addInactiveAction(V,P,M),V}existingAction(s,c){const p=c||this._root,y=p.uuid,M=typeof s=="string"?jf.findByName(p,s):s,C=M?M.uuid:s,P=this._actionsByClip[C];return P!==void 0&&P.actionByRoot[y]||null}stopAllAction(){const s=this._actions,c=this._nActiveActions;for(let p=c-1;p>=0;--p)s[p].stop();return this}update(s){s*=this.timeScale;const c=this._actions,p=this._nActiveActions,y=this.time+=s,M=Math.sign(s),C=this._accuIndex^=1;for(let U=0;U!==p;++U)c[U]._update(y,s,M,C);const P=this._bindings,F=this._nActiveBindings;for(let U=0;U!==F;++U)P[U].apply(C);return this}setTime(s){this.time=0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(s)}getRoot(){return this._root}uncacheClip(s){const c=this._actions,p=s.uuid,y=this._actionsByClip,M=y[p];if(M!==void 0){const C=M.knownActions;for(let P=0,F=C.length;P!==F;++P){const U=C[P];this._deactivateAction(U);const V=U._cacheIndex,W=c[c.length-1];U._cacheIndex=null,U._byClipCacheIndex=null,W._cacheIndex=V,c[V]=W,c.pop(),this._removeInactiveBindingsForAction(U)}delete y[p]}}uncacheRoot(s){const c=s.uuid,p=this._actionsByClip;for(const C in p){const P=p[C].actionByRoot,F=P[c];F!==void 0&&(this._deactivateAction(F),this._removeInactiveAction(F))}const y=this._bindingsByRootAndName,M=y[c];if(M!==void 0)for(const C in M){const P=M[C];P.restoreOriginalState(),this._removeInactiveBinding(P)}}uncacheAction(s,c){const p=this.existingAction(s,c);p!==null&&(this._deactivateAction(p),this._removeInactiveAction(p))}}VT.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class tv{constructor(s){typeof s=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),s=arguments[1]),this.value=s}clone(){return new tv(this.value.clone===void 0?this.value:this.value.clone())}}class WT extends Xc{constructor(s,c,p=1){super(s,c),this.meshPerAttribute=p}copy(s){return super.copy(s),this.meshPerAttribute=s.meshPerAttribute,this}clone(s){const c=super.clone(s);return c.meshPerAttribute=this.meshPerAttribute,c}toJSON(s){const c=super.toJSON(s);return c.isInstancedInterleavedBuffer=!0,c.meshPerAttribute=this.meshPerAttribute,c}}WT.prototype.isInstancedInterleavedBuffer=!0;class jT{constructor(s,c,p,y,M){this.buffer=s,this.type=c,this.itemSize=p,this.elementSize=y,this.count=M,this.version=0}set needsUpdate(s){s===!0&&this.version++}setBuffer(s){return this.buffer=s,this}setType(s,c){return this.type=s,this.elementSize=c,this}setItemSize(s){return this.itemSize=s,this}setCount(s){return this.count=s,this}}jT.prototype.isGLBufferAttribute=!0;class PU{constructor(s,c,p=0,y=1/0){this.ray=new Nl(s,c),this.near=p,this.far=y,this.camera=null,this.layers=new ig,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(s,c){this.ray.set(s,c)}setFromCamera(s,c){c&&c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(s.x,s.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c&&c.isOrthographicCamera?(this.ray.origin.set(s.x,s.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(s,c=!0,p=[]){return F_(s,this,p,c),p.sort($T),p}intersectObjects(s,c=!0,p=[]){for(let y=0,M=s.length;y<M;y++)F_(s[y],this,p,c);return p.sort($T),p}}function $T(b,s){return b.distance-s.distance}function F_(b,s,c,p){if(b.layers.test(s.layers)&&b.raycast(s,c),p===!0){const y=b.children;for(let M=0,C=y.length;M<C;M++)F_(y[M],s,c,!0)}}class DU{constructor(s=1,c=0,p=0){return this.radius=s,this.phi=c,this.theta=p,this}set(s,c,p){return this.radius=s,this.phi=c,this.theta=p,this}copy(s){return this.radius=s.radius,this.phi=s.phi,this.theta=s.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(s){return this.setFromCartesianCoords(s.x,s.y,s.z)}setFromCartesianCoords(s,c,p){return this.radius=Math.sqrt(s*s+c*c+p*p),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(s,p),this.phi=Math.acos(ss(c/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class OU{constructor(s=1,c=0,p=0){return this.radius=s,this.theta=c,this.y=p,this}set(s,c,p){return this.radius=s,this.theta=c,this.y=p,this}copy(s){return this.radius=s.radius,this.theta=s.theta,this.y=s.y,this}setFromVector3(s){return this.setFromCartesianCoords(s.x,s.y,s.z)}setFromCartesianCoords(s,c,p){return this.radius=Math.sqrt(s*s+p*p),this.theta=Math.atan2(s,p),this.y=c,this}clone(){return new this.constructor().copy(this)}}const XT=new Qt;class Bh{constructor(s=new Qt(1/0,1/0),c=new Qt(-1/0,-1/0)){this.min=s,this.max=c}set(s,c){return this.min.copy(s),this.max.copy(c),this}setFromPoints(s){this.makeEmpty();for(let c=0,p=s.length;c<p;c++)this.expandByPoint(s[c]);return this}setFromCenterAndSize(s,c){const p=XT.copy(c).multiplyScalar(.5);return this.min.copy(s).sub(p),this.max.copy(s).add(p),this}clone(){return new this.constructor().copy(this)}copy(s){return this.min.copy(s.min),this.max.copy(s.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(s){return this.isEmpty()?s.set(0,0):s.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(s){return this.isEmpty()?s.set(0,0):s.subVectors(this.max,this.min)}expandByPoint(s){return this.min.min(s),this.max.max(s),this}expandByVector(s){return this.min.sub(s),this.max.add(s),this}expandByScalar(s){return this.min.addScalar(-s),this.max.addScalar(s),this}containsPoint(s){return!(s.x<this.min.x||s.x>this.max.x||s.y<this.min.y||s.y>this.max.y)}containsBox(s){return this.min.x<=s.min.x&&s.max.x<=this.max.x&&this.min.y<=s.min.y&&s.max.y<=this.max.y}getParameter(s,c){return c.set((s.x-this.min.x)/(this.max.x-this.min.x),(s.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(s){return!(s.max.x<this.min.x||s.min.x>this.max.x||s.max.y<this.min.y||s.min.y>this.max.y)}clampPoint(s,c){return c.copy(s).clamp(this.min,this.max)}distanceToPoint(s){return XT.copy(s).clamp(this.min,this.max).sub(s).length()}intersect(s){return this.min.max(s.min),this.max.min(s.max),this}union(s){return this.min.min(s.min),this.max.max(s.max),this}translate(s){return this.min.add(s),this.max.add(s),this}equals(s){return s.min.equals(this.min)&&s.max.equals(this.max)}}Bh.prototype.isBox2=!0;const qT=new Ge,nv=new Ge;class YT{constructor(s=new Ge,c=new Ge){this.start=s,this.end=c}set(s,c){return this.start.copy(s),this.end.copy(c),this}copy(s){return this.start.copy(s.start),this.end.copy(s.end),this}getCenter(s){return s.addVectors(this.start,this.end).multiplyScalar(.5)}delta(s){return s.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(s,c){return this.delta(c).multiplyScalar(s).add(this.start)}closestPointToPointParameter(s,c){qT.subVectors(s,this.start),nv.subVectors(this.end,this.start);const p=nv.dot(nv);let M=nv.dot(qT)/p;return c&&(M=ss(M,0,1)),M}closestPointToPoint(s,c,p){const y=this.closestPointToPointParameter(s,c);return this.delta(p).multiplyScalar(y).add(this.start)}applyMatrix4(s){return this.start.applyMatrix4(s),this.end.applyMatrix4(s),this}equals(s){return s.start.equals(this.start)&&s.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const KT=new Ge;class IU extends Oi{constructor(s,c){super(),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=c;const p=new si,y=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let C=0,P=1,F=32;C<F;C++,P++){const U=C/F*Math.PI*2,V=P/F*Math.PI*2;y.push(Math.cos(U),Math.sin(U),1,Math.cos(V),Math.sin(V),1)}p.setAttribute("position",new Hn(y,3));const M=new Zr({fog:!1,toneMapped:!1});this.cone=new Is(p,M),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const s=this.light.distance?this.light.distance:1e3,c=s*Math.tan(this.light.angle);this.cone.scale.set(c,c,s),KT.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(KT),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Xl=new Ge,iv=new zn,B_=new zn;class QT extends Is{constructor(s){const c=ZT(s),p=new si,y=[],M=[],C=new Tn(0,0,1),P=new Tn(0,1,0);for(let U=0;U<c.length;U++){const V=c[U];V.parent&&V.parent.isBone&&(y.push(0,0,0),y.push(0,0,0),M.push(C.r,C.g,C.b),M.push(P.r,P.g,P.b))}p.setAttribute("position",new Hn(y,3)),p.setAttribute("color",new Hn(M,3));const F=new Zr({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(p,F),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=s,this.bones=c,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(s){const c=this.bones,p=this.geometry,y=p.getAttribute("position");B_.copy(this.root.matrixWorld).invert();for(let M=0,C=0;M<c.length;M++){const P=c[M];P.parent&&P.parent.isBone&&(iv.multiplyMatrices(B_,P.matrixWorld),Xl.setFromMatrixPosition(iv),y.setXYZ(C,Xl.x,Xl.y,Xl.z),iv.multiplyMatrices(B_,P.parent.matrixWorld),Xl.setFromMatrixPosition(iv),y.setXYZ(C+1,Xl.x,Xl.y,Xl.z),C+=2)}p.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(s)}}function ZT(b){const s=[];b&&b.isBone&&s.push(b);for(let c=0;c<b.children.length;c++)s.push.apply(s,ZT(b.children[c]));return s}class kU extends Fr{constructor(s,c,p){const y=new Jc(c,4,2),M=new Ha({wireframe:!0,fog:!1,toneMapped:!1});super(y,M),this.light=s,this.light.updateMatrixWorld(),this.color=p,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const NU=new Ge,JT=new Tn,e2=new Tn;class FU extends Oi{constructor(s,c,p){super(),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=p;const y=new Qc(c);y.rotateY(Math.PI*.5),this.material=new Ha({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const M=y.getAttribute("position"),C=new Float32Array(M.count*3);y.setAttribute("color",new Hi(C,3)),this.add(new Fr(y,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const s=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const c=s.geometry.getAttribute("color");JT.copy(this.light.color),e2.copy(this.light.groundColor);for(let p=0,y=c.count;p<y;p++){const M=p<y/2?JT:e2;c.setXYZ(p,M.r,M.g,M.b)}c.needsUpdate=!0}s.lookAt(NU.setFromMatrixPosition(this.light.matrixWorld).negate())}}class t2 extends Is{constructor(s=10,c=10,p=4473924,y=8947848){p=new Tn(p),y=new Tn(y);const M=c/2,C=s/c,P=s/2,F=[],U=[];for(let j=0,Y=0,ee=-P;j<=c;j++,ee+=C){F.push(-P,0,ee,P,0,ee),F.push(ee,0,-P,ee,0,P);const de=j===M?p:y;de.toArray(U,Y),Y+=3,de.toArray(U,Y),Y+=3,de.toArray(U,Y),Y+=3,de.toArray(U,Y),Y+=3}const V=new si;V.setAttribute("position",new Hn(F,3)),V.setAttribute("color",new Hn(U,3));const W=new Zr({vertexColors:!0,toneMapped:!1});super(V,W),this.type="GridHelper"}}class BU extends Is{constructor(s=10,c=16,p=8,y=64,M=4473924,C=8947848){M=new Tn(M),C=new Tn(C);const P=[],F=[];for(let W=0;W<=c;W++){const j=W/c*(Math.PI*2),Y=Math.sin(j)*s,ee=Math.cos(j)*s;P.push(0,0,0),P.push(Y,0,ee);const de=W&1?M:C;F.push(de.r,de.g,de.b),F.push(de.r,de.g,de.b)}for(let W=0;W<=p;W++){const j=W&1?M:C,Y=s-s/p*W;for(let ee=0;ee<y;ee++){let de=ee/y*(Math.PI*2),xe=Math.sin(de)*Y,re=Math.cos(de)*Y;P.push(xe,0,re),F.push(j.r,j.g,j.b),de=(ee+1)/y*(Math.PI*2),xe=Math.sin(de)*Y,re=Math.cos(de)*Y,P.push(xe,0,re),F.push(j.r,j.g,j.b)}}const U=new si;U.setAttribute("position",new Hn(P,3)),U.setAttribute("color",new Hn(F,3));const V=new Zr({vertexColors:!0,toneMapped:!1});super(U,V),this.type="PolarGridHelper"}}const n2=new Ge,rv=new Ge,i2=new Ge;class UU extends Oi{constructor(s,c,p){super(),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=p,c===void 0&&(c=1);let y=new si;y.setAttribute("position",new Hn([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3));const M=new Zr({fog:!1,toneMapped:!1});this.lightPlane=new Wa(y,M),this.add(this.lightPlane),y=new si,y.setAttribute("position",new Hn([0,0,0,0,0,1],3)),this.targetLine=new Wa(y,M),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){n2.setFromMatrixPosition(this.light.matrixWorld),rv.setFromMatrixPosition(this.light.target.matrixWorld),i2.subVectors(rv,n2),this.lightPlane.lookAt(rv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rv),this.targetLine.scale.z=i2.length()}}const sv=new Ge,Sr=new Af;class zU extends Is{constructor(s){const c=new si,p=new Zr({color:16777215,vertexColors:!0,toneMapped:!1}),y=[],M=[],C={},P=new Tn(16755200),F=new Tn(16711680),U=new Tn(43775),V=new Tn(16777215),W=new Tn(3355443);j("n1","n2",P),j("n2","n4",P),j("n4","n3",P),j("n3","n1",P),j("f1","f2",P),j("f2","f4",P),j("f4","f3",P),j("f3","f1",P),j("n1","f1",P),j("n2","f2",P),j("n3","f3",P),j("n4","f4",P),j("p","n1",F),j("p","n2",F),j("p","n3",F),j("p","n4",F),j("u1","u2",U),j("u2","u3",U),j("u3","u1",U),j("c","t",V),j("p","c",W),j("cn1","cn2",W),j("cn3","cn4",W),j("cf1","cf2",W),j("cf3","cf4",W);function j(ee,de,xe){Y(ee,xe),Y(de,xe)}function Y(ee,de){y.push(0,0,0),M.push(de.r,de.g,de.b),C[ee]===void 0&&(C[ee]=[]),C[ee].push(y.length/3-1)}c.setAttribute("position",new Hn(y,3)),c.setAttribute("color",new Hn(M,3)),super(c,p),this.type="CameraHelper",this.camera=s,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=C,this.update()}update(){const s=this.geometry,c=this.pointMap,p=1,y=1;Sr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ir("c",c,s,Sr,0,0,-1),Ir("t",c,s,Sr,0,0,1),Ir("n1",c,s,Sr,-p,-y,-1),Ir("n2",c,s,Sr,p,-y,-1),Ir("n3",c,s,Sr,-p,y,-1),Ir("n4",c,s,Sr,p,y,-1),Ir("f1",c,s,Sr,-p,-y,1),Ir("f2",c,s,Sr,p,-y,1),Ir("f3",c,s,Sr,-p,y,1),Ir("f4",c,s,Sr,p,y,1),Ir("u1",c,s,Sr,p*.7,y*1.1,-1),Ir("u2",c,s,Sr,-p*.7,y*1.1,-1),Ir("u3",c,s,Sr,0,y*2,-1),Ir("cf1",c,s,Sr,-p,0,1),Ir("cf2",c,s,Sr,p,0,1),Ir("cf3",c,s,Sr,0,-y,1),Ir("cf4",c,s,Sr,0,y,1),Ir("cn1",c,s,Sr,-p,0,-1),Ir("cn2",c,s,Sr,p,0,-1),Ir("cn3",c,s,Sr,0,-y,-1),Ir("cn4",c,s,Sr,0,y,-1),s.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ir(b,s,c,p,y,M,C){sv.set(y,M,C).unproject(p);const P=s[b];if(P!==void 0){const F=c.getAttribute("position");for(let U=0,V=P.length;U<V;U++)F.setXYZ(P[U],sv.x,sv.y,sv.z)}}const ov=new $s;class r2 extends Is{constructor(s,c=16776960){const p=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),y=new Float32Array(8*3),M=new si;M.setIndex(new Hi(p,1)),M.setAttribute("position",new Hi(y,3)),super(M,new Zr({color:c,toneMapped:!1})),this.object=s,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(s){if(s!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&ov.setFromObject(this.object),ov.isEmpty())return;const c=ov.min,p=ov.max,y=this.geometry.attributes.position,M=y.array;M[0]=p.x,M[1]=p.y,M[2]=p.z,M[3]=c.x,M[4]=p.y,M[5]=p.z,M[6]=c.x,M[7]=c.y,M[8]=p.z,M[9]=p.x,M[10]=c.y,M[11]=p.z,M[12]=p.x,M[13]=p.y,M[14]=c.z,M[15]=c.x,M[16]=p.y,M[17]=c.z,M[18]=c.x,M[19]=c.y,M[20]=c.z,M[21]=p.x,M[22]=c.y,M[23]=c.z,y.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(s){return this.object=s,this.update(),this}copy(s){return Is.prototype.copy.call(this,s),this.object=s.object,this}}class HU extends Is{constructor(s,c=16776960){const p=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),y=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],M=new si;M.setIndex(new Hi(p,1)),M.setAttribute("position",new Hn(y,3)),super(M,new Zr({color:c,toneMapped:!1})),this.box=s,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(s){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(s))}}class GU extends Wa{constructor(s,c=1,p=16776960){const y=p,M=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],C=new si;C.setAttribute("position",new Hn(M,3)),C.computeBoundingSphere(),super(C,new Zr({color:y,toneMapped:!1})),this.type="PlaneHelper",this.plane=s,this.size=c;const P=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],F=new si;F.setAttribute("position",new Hn(P,3)),F.computeBoundingSphere(),this.add(new Fr(F,new Ha({color:y,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(s){let c=-this.plane.constant;Math.abs(c)<1e-8&&(c=1e-8),this.scale.set(.5*this.size,.5*this.size,c),this.children[0].material.side=c<0?S:w,this.lookAt(this.plane.normal),super.updateMatrixWorld(s)}}const s2=new Ge;let av,U_;class VU extends Oi{constructor(s=new Ge(0,0,1),c=new Ge(0,0,0),p=1,y=16776960,M=p*.2,C=M*.2){super(),this.type="ArrowHelper",av===void 0&&(av=new si,av.setAttribute("position",new Hn([0,0,0,0,1,0],3)),U_=new jl(0,.5,1,5,1),U_.translate(0,-.5,0)),this.position.copy(c),this.line=new Wa(av,new Zr({color:y,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Fr(U_,new Ha({color:y,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(s),this.setLength(p,M,C)}setDirection(s){if(s.y>.99999)this.quaternion.set(0,0,0,1);else if(s.y<-.99999)this.quaternion.set(1,0,0,0);else{s2.set(s.z,0,-s.x).normalize();const c=Math.acos(s.y);this.quaternion.setFromAxisAngle(s2,c)}}setLength(s,c=s*.2,p=c*.2){this.line.scale.set(1,Math.max(1e-4,s-c),1),this.line.updateMatrix(),this.cone.scale.set(p,c,p),this.cone.position.y=s,this.cone.updateMatrix()}setColor(s){this.line.material.color.set(s),this.cone.material.color.set(s)}copy(s){return super.copy(s,!1),this.line.copy(s.line),this.cone.copy(s.cone),this}}class o2 extends Is{constructor(s=1){const c=[0,0,0,s,0,0,0,0,0,0,s,0,0,0,0,0,0,s],p=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],y=new si;y.setAttribute("position",new Hn(c,3)),y.setAttribute("color",new Hn(p,3));const M=new Zr({vertexColors:!0,toneMapped:!1});super(y,M),this.type="AxesHelper"}setColors(s,c,p){const y=new Tn,M=this.geometry.attributes.color.array;return y.set(s),y.toArray(M,0),y.toArray(M,3),y.set(c),y.toArray(M,6),y.toArray(M,9),y.set(p),y.toArray(M,12),y.toArray(M,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class WU{constructor(){this.type="ShapePath",this.color=new Tn,this.subPaths=[],this.currentPath=null}moveTo(s,c){return this.currentPath=new Uf,this.subPaths.push(this.currentPath),this.currentPath.moveTo(s,c),this}lineTo(s,c){return this.currentPath.lineTo(s,c),this}quadraticCurveTo(s,c,p,y){return this.currentPath.quadraticCurveTo(s,c,p,y),this}bezierCurveTo(s,c,p,y,M,C){return this.currentPath.bezierCurveTo(s,c,p,y,M,C),this}splineThru(s){return this.currentPath.splineThru(s),this}toShapes(s,c){function p(Q){const De=[];for(let Me=0,Ie=Q.length;Me<Ie;Me++){const Xe=Q[Me],st=new ha;st.curves=Xe.curves,De.push(st)}return De}function y(Q,De){const Me=De.length;let Ie=!1;for(let Xe=Me-1,st=0;st<Me;Xe=st++){let ut=De[Xe],Dt=De[st],Rt=Dt.x-ut.x,Ee=Dt.y-ut.y;if(Math.abs(Ee)>Number.EPSILON){if(Ee<0&&(ut=De[st],Rt=-Rt,Dt=De[Xe],Ee=-Ee),Q.y<ut.y||Q.y>Dt.y)continue;if(Q.y===ut.y){if(Q.x===ut.x)return!0}else{const Ye=Ee*(Q.x-ut.x)-Rt*(Q.y-ut.y);if(Ye===0)return!0;if(Ye<0)continue;Ie=!Ie}}else{if(Q.y!==ut.y)continue;if(Dt.x<=Q.x&&Q.x<=ut.x||ut.x<=Q.x&&Q.x<=Dt.x)return!0}}return Ie}const M=da.isClockWise,C=this.subPaths;if(C.length===0)return[];if(c===!0)return p(C);let P,F,U;const V=[];if(C.length===1)return F=C[0],U=new ha,U.curves=F.curves,V.push(U),V;let W=!M(C[0].getPoints());W=s?!W:W;const j=[],Y=[];let ee=[],de=0,xe;Y[de]=void 0,ee[de]=[];for(let Q=0,De=C.length;Q<De;Q++)F=C[Q],xe=F.getPoints(),P=M(xe),P=s?!P:P,P?(!W&&Y[de]&&de++,Y[de]={s:new ha,p:xe},Y[de].s.curves=F.curves,W&&de++,ee[de]=[]):ee[de].push({h:F,p:xe[0]});if(!Y[0])return p(C);if(Y.length>1){let Q=!1;const De=[];for(let Me=0,Ie=Y.length;Me<Ie;Me++)j[Me]=[];for(let Me=0,Ie=Y.length;Me<Ie;Me++){const Xe=ee[Me];for(let st=0;st<Xe.length;st++){const ut=Xe[st];let Dt=!0;for(let Rt=0;Rt<Y.length;Rt++)y(ut.p,Y[Rt].p)&&(Me!==Rt&&De.push({froms:Me,tos:Rt,hole:st}),Dt?(Dt=!1,j[Rt].push(ut)):Q=!0);Dt&&j[Me].push(ut)}}De.length>0&&(Q||(ee=j))}let re;for(let Q=0,De=Y.length;Q<De;Q++){U=Y[Q].s,V.push(U),re=ee[Q];for(let Me=0,Ie=re.length;Me<Ie;Me++)U.holes.push(re[Me].h)}return V}}const a2=new Float32Array(1),jU=new Int32Array(a2.buffer);class $U{static toHalfFloat(s){s>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),s=65504),a2[0]=s;const c=jU[0];let p=c>>16&32768,y=c>>12&2047;const M=c>>23&255;return M<103?p:M>142?(p|=31744,p|=(M==255?0:1)&&c&8388607,p):M<113?(y|=2048,p|=(y>>114-M)+(y>>113-M&1),p):(p|=M-112<<10|y>>1,p+=y&1,p)}}const XU=0,qU=1,YU=0,KU=1,QU=2;function ZU(b){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),b}function JU(b=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),b.isMultiMaterial=!0,b.materials=b,b.clone=function(){return b.slice()},b}function e6(b,s){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new If(b,s)}function t6(b){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Pg(b)}function n6(b,s){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new If(b,s)}function i6(b){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Kc(b)}function r6(b){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Kc(b)}function s6(b){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Kc(b)}function o6(b,s,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new Ge(b,s,c)}function a6(b,s){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Hi(b,s).setUsage(Ju)}function l6(b,s){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new HM(b,s)}function c6(b,s){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new GM(b,s)}function u6(b,s){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new VM(b,s)}function h6(b,s){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new WM(b,s)}function d6(b,s){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new og(b,s)}function f6(b,s){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new jM(b,s)}function p6(b,s){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new ag(b,s)}function m6(b,s){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Hn(b,s)}function g6(b,s){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new XM(b,s)}Ys.create=function(b,s){return console.log("THREE.Curve.create() has been deprecated"),b.prototype=Object.create(Ys.prototype),b.prototype.constructor=b,b.prototype.getPoint=s,b},Uf.prototype.fromPoints=function(b){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(b)};function v6(b){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new o2(b)}function y6(b,s){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new r2(b,s)}function x6(b,s){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Is(new e_(b.geometry),new Zr({color:s!==void 0?s:16777215}))}t2.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},QT.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function _6(b,s){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Is(new h_(b.geometry),new Zr({color:s!==void 0?s:16777215}))}Es.prototype.extractUrlBase=function(b){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Jg.extractUrlBase(b)},Es.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function b6(b){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new pa(b)}function E6(b){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new vT(b)}Bh.prototype.center=function(b){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(b)},Bh.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Bh.prototype.isIntersectionBox=function(b){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(b)},Bh.prototype.size=function(b){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(b)},$s.prototype.center=function(b){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(b)},$s.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},$s.prototype.isIntersectionBox=function(b){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(b)},$s.prototype.isIntersectionSphere=function(b){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(b)},$s.prototype.size=function(b){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(b)},Il.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},wf.prototype.setFromMatrix=function(b){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(b)},YT.prototype.center=function(b){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(b)},Hr.prototype.flattenToArrayOffset=function(b,s){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(b,s)},Hr.prototype.multiplyVector3=function(b){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),b.applyMatrix3(this)},Hr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Hr.prototype.applyToBufferAttribute=function(b){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),b.applyMatrix3(this)},Hr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Hr.prototype.getInverse=function(b){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(b).invert()},zn.prototype.extractPosition=function(b){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(b)},zn.prototype.flattenToArrayOffset=function(b,s){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(b,s)},zn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new Ge().setFromMatrixColumn(this,3)},zn.prototype.setRotationFromQuaternion=function(b){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(b)},zn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},zn.prototype.multiplyVector3=function(b){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),b.applyMatrix4(this)},zn.prototype.multiplyVector4=function(b){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),b.applyMatrix4(this)},zn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},zn.prototype.rotateAxis=function(b){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),b.transformDirection(this)},zn.prototype.crossVector=function(b){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),b.applyMatrix4(this)},zn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},zn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},zn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},zn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},zn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},zn.prototype.applyToBufferAttribute=function(b){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),b.applyMatrix4(this)},zn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},zn.prototype.makeFrustum=function(b,s,c,p,y,M){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(b,s,p,c,y,M)},zn.prototype.getInverse=function(b){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(b).invert()},la.prototype.isIntersectionLine=function(b){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(b)},Yr.prototype.multiplyVector3=function(b){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),b.applyQuaternion(this)},Yr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Nl.prototype.isIntersectionBox=function(b){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(b)},Nl.prototype.isIntersectionPlane=function(b){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(b)},Nl.prototype.isIntersectionSphere=function(b){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(b)},Dr.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Dr.prototype.barycoordFromPoint=function(b,s){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(b,s)},Dr.prototype.midpoint=function(b){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(b)},Dr.prototypenormal=function(b){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(b)},Dr.prototype.plane=function(b){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(b)},Dr.barycoordFromPoint=function(b,s,c,p,y){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Dr.getBarycoord(b,s,c,p,y)},Dr.normal=function(b,s,c,p){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Dr.getNormal(b,s,c,p)},ha.prototype.extractAllPoints=function(b){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(b)},ha.prototype.extrude=function(b){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new fa(this,b)},ha.prototype.makeGeometry=function(b){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Zc(this,b)},Qt.prototype.fromAttribute=function(b,s,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(b,s,c)},Qt.prototype.distanceToManhattan=function(b){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(b)},Qt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ge.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Ge.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Ge.prototype.getPositionFromMatrix=function(b){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(b)},Ge.prototype.getScaleFromMatrix=function(b){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(b)},Ge.prototype.getColumnFromMatrix=function(b,s){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(s,b)},Ge.prototype.applyProjection=function(b){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(b)},Ge.prototype.fromAttribute=function(b,s,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(b,s,c)},Ge.prototype.distanceToManhattan=function(b){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(b)},Ge.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Qi.prototype.fromAttribute=function(b,s,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(b,s,c)},Qi.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Oi.prototype.getChildByName=function(b){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(b)},Oi.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Oi.prototype.translate=function(b,s){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(s,b)},Oi.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Oi.prototype.applyMatrix=function(b){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(b)},Object.defineProperties(Oi.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(b){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=b}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Fr.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Fr.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),en},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Ig.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Br.prototype.setLens=function(b,s){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),s!==void 0&&(this.filmGauge=s),this.setFocalLength(b)},Object.defineProperties(Fo.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(b){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=b}},shadowCameraLeft:{set:function(b){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=b}},shadowCameraRight:{set:function(b){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=b}},shadowCameraTop:{set:function(b){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=b}},shadowCameraBottom:{set:function(b){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=b}},shadowCameraNear:{set:function(b){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=b}},shadowCameraFar:{set:function(b){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=b}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(b){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=b}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(b){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=b}},shadowMapHeight:{set:function(b){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=b}}}),Object.defineProperties(Hi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Ju},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Ju)}}}),Hi.prototype.setDynamic=function(b){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(b===!0?Ju:Zu),this},Hi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Hi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},si.prototype.addIndex=function(b){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(b)},si.prototype.addAttribute=function(b,s){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(s&&s.isBufferAttribute)&&!(s&&s.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(b,new Hi(arguments[1],arguments[2]))):b==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(s),this):this.setAttribute(b,s)},si.prototype.addDrawCall=function(b,s,c){c!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(b,s)},si.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},si.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},si.prototype.removeAttribute=function(b){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(b)},si.prototype.applyMatrix=function(b){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(b)},Object.defineProperties(si.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Xc.prototype.setDynamic=function(b){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(b===!0?Ju:Zu),this},Xc.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},fa.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},fa.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},fa.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Tg.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},tv.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Kr.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Tn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(b){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=b===R}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(b){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=b}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Va.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(b){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=b}}}),sr.prototype.clearTarget=function(b,s,c,p){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(b),this.clear(s,c,p)},sr.prototype.animate=function(b){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(b)},sr.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},sr.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},sr.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},sr.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},sr.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},sr.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},sr.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},sr.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},sr.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},sr.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},sr.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},sr.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},sr.prototype.enableScissorTest=function(b){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(b)},sr.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},sr.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},sr.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},sr.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},sr.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},sr.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},sr.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},sr.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(sr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(b){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=b}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(b){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=b}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(b){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=b===!0?Sn:hn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(TS.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function A6(b,s,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new vg(b,c)}Object.defineProperties(js.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(b){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=b}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(b){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=b}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(b){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=b}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(b){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=b}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(b){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=b}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(b){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=b}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(b){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=b}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(b){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=b}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(b){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=b}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(b){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=b}}}),I_.prototype.load=function(b){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const s=this;return new PT().load(b,function(p){s.setBuffer(p)}),this},zT.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},gg.prototype.updateCubeMap=function(b,s){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(b,s)},gg.prototype.clear=function(b,s,c,p){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(b,s,c,p)},Pl.crossOrigin=void 0,Pl.loadTexture=function(b,s,c,p){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const y=new yT;y.setCrossOrigin(this.crossOrigin);const M=y.load(b,c,void 0,p);return s&&(M.mapping=s),M},Pl.loadTextureCube=function(b,s,c,p){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const y=new gT;y.setCrossOrigin(this.crossOrigin);const M=y.load(b,c,void 0,p);return s&&(M.mapping=s),M},Pl.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Pl.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function w6(){console.error("THREE.CanvasRenderer has been removed")}function M6(){console.error("THREE.JSONLoader has been removed.")}const S6={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function T6(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function C6(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new si}function R6(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new si}function L6(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function P6(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function D6(){console.error("THREE.ImmediateRenderObject has been removed.")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:u}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=u),a.ACESFilmicToneMapping=ae,a.AddEquation=ne,a.AddOperation=pe,a.AdditiveAnimationBlendMode=Ft,a.AdditiveBlending=B,a.AlphaFormat=at,a.AlwaysDepth=St,a.AlwaysStencilFunc=wM,a.AmbientLight=R_,a.AmbientLightProbe=OT,a.AnimationClip=jf,a.AnimationLoader=dU,a.AnimationMixer=VT,a.AnimationObjectGroup=GT,a.AnimationUtils=hr,a.ArcCurve=t_,a.ArrayCamera=Mg,a.ArrowHelper=VU,a.Audio=I_,a.AudioAnalyser=zT,a.AudioContext=O_,a.AudioListener=yU,a.AudioLoader=PT,a.AxesHelper=o2,a.AxisHelper=v6,a.BackSide=S,a.BasicDepthPacking=Kn,a.BasicShadowMap=v,a.BinaryTextureLoader=E6,a.Bone=kg,a.BooleanKeyframeTrack=eu,a.BoundingBoxHelper=y6,a.Box2=Bh,a.Box3=$s,a.Box3Helper=HU,a.BoxBufferGeometry=Ga,a.BoxGeometry=Ga,a.BoxHelper=r2,a.BufferAttribute=Hi,a.BufferGeometry=si,a.BufferGeometryLoader=TT,a.ByteType=mn,a.Cache=nu,a.Camera=Af,a.CameraHelper=zU,a.CanvasRenderer=w6,a.CanvasTexture=eT,a.CatmullRomCurve3=o_,a.CineonToneMapping=ce,a.CircleBufferGeometry=Sh,a.CircleGeometry=Sh,a.ClampToEdgeWrapping=_t,a.Clock=NT,a.Color=Tn,a.ColorKeyframeTrack=b_,a.CompressedTexture=Zx,a.CompressedTextureLoader=fU,a.ConeBufferGeometry=Th,a.ConeGeometry=Th,a.CubeCamera=gg,a.CubeReflectionMapping=$,a.CubeRefractionMapping=me,a.CubeTexture=mh,a.CubeTextureLoader=gT,a.CubeUVReflectionMapping=Le,a.CubeUVRefractionMapping=wt,a.CubicBezierCurve=jg,a.CubicBezierCurve3=a_,a.CubicInterpolant=dT,a.CullFaceBack=m,a.CullFaceFront=g,a.CullFaceFrontBack=x,a.CullFaceNone=d,a.Curve=Ys,a.CurvePath=iT,a.CustomBlending=le,a.CustomToneMapping=J,a.CylinderBufferGeometry=jl,a.CylinderGeometry=jl,a.Cylindrical=OU,a.DataTexture=qc,a.DataTexture2DArray=bg,a.DataTexture3D=Vx,a.DataTextureLoader=vT,a.DataUtils=$U,a.DecrementStencilOp=Ei,a.DecrementWrapStencilOp=fi,a.DefaultLoadingManager=mT,a.DepthFormat=In,a.DepthStencilFormat=we,a.DepthTexture=Sg,a.DirectionalLight=C_,a.DirectionalLightHelper=UU,a.DiscreteInterpolant=fT,a.DodecahedronBufferGeometry=Ch,a.DodecahedronGeometry=Ch,a.DoubleSide=T,a.DstAlphaFactor=Ce,a.DstColorFactor=Oe,a.DynamicBufferAttribute=a6,a.DynamicCopyUsage=gN,a.DynamicDrawUsage=Ju,a.DynamicReadUsage=fN,a.EdgesGeometry=e_,a.EdgesHelper=x6,a.EllipseCurve=kf,a.EqualDepth=sn,a.EqualStencilFunc=Bc,a.EquirectangularReflectionMapping=Pe,a.EquirectangularRefractionMapping=ve,a.Euler=Wc,a.EventDispatcher=ka,a.ExtrudeBufferGeometry=fa,a.ExtrudeGeometry=fa,a.FaceColors=KU,a.FileLoader=pa,a.FlatShading=R,a.Float16BufferAttribute=$M,a.Float32Attribute=m6,a.Float32BufferAttribute=Hn,a.Float64Attribute=g6,a.Float64BufferAttribute=XM,a.FloatType=Si,a.Fog=Rf,a.FogExp2=Cf,a.Font=P6,a.FontLoader=L6,a.FramebufferTexture=JS,a.FrontSide=w,a.Frustum=wf,a.GLBufferAttribute=jT,a.GLSL1=yN,a.GLSL3=px,a.GreaterDepth=qe,a.GreaterEqualDepth=Se,a.GreaterEqualStencilFunc=uN,a.GreaterStencilFunc=Pr,a.GridHelper=t2,a.Group=Vl,a.HalfFloatType=Gi,a.HemisphereLight=A_,a.HemisphereLightHelper=FU,a.HemisphereLightProbe=DT,a.IcosahedronBufferGeometry=Lh,a.IcosahedronGeometry=Lh,a.ImageBitmapLoader=LT,a.ImageLoader=$f,a.ImageUtils=Pl,a.ImmediateRenderObject=D6,a.IncrementStencilOp=rr,a.IncrementWrapStencilOp=Mr,a.InstancedBufferAttribute=Yc,a.InstancedBufferGeometry=D_,a.InstancedInterleavedBuffer=WT,a.InstancedMesh=qx,a.Int16Attribute=h6,a.Int16BufferAttribute=WM,a.Int32Attribute=f6,a.Int32BufferAttribute=jM,a.Int8Attribute=l6,a.Int8BufferAttribute=HM,a.IntType=mi,a.InterleavedBuffer=Xc,a.InterleavedBufferAttribute=Wl,a.Interpolant=ja,a.InterpolateDiscrete=oe,a.InterpolateLinear=he,a.InterpolateSmooth=be,a.InvertStencilOp=Po,a.JSONLoader=M6,a.KeepStencilOp=Ti,a.KeyframeTrack=No,a.LOD=FS,a.LatheBufferGeometry=Ph,a.LatheGeometry=Ph,a.Layers=ig,a.LensFlare=T6,a.LessDepth=bt,a.LessEqualDepth=Jt,a.LessEqualStencilFunc=Uc,a.LessStencilFunc=Ia,a.Light=Fo,a.LightProbe=qf,a.Line=Wa,a.Line3=YT,a.LineBasicMaterial=Zr,a.LineCurve=Bf,a.LineCurve3=nT,a.LineDashedMaterial=x_,a.LineLoop=Kx,a.LinePieces=qU,a.LineSegments=Is,a.LineStrip=XU,a.LinearEncoding=hn,a.LinearFilter=Ve,a.LinearInterpolant=__,a.LinearMipMapLinearFilter=pn,a.LinearMipMapNearestFilter=yt,a.LinearMipmapLinearFilter=Wt,a.LinearMipmapNearestFilter=nt,a.LinearToneMapping=Fe,a.Loader=Es,a.LoaderUtils=Jg,a.LoadingManager=E_,a.LoopOnce=qt,a.LoopPingPong=pt,a.LoopRepeat=xt,a.LuminanceAlphaFormat=Ht,a.LuminanceFormat=ft,a.MOUSE=h,a.Material=Kr,a.MaterialLoader=ST,a.Math=TM,a.MathUtils=TM,a.Matrix3=Hr,a.Matrix4=zn,a.MaxEquation=z,a.Mesh=Fr,a.MeshBasicMaterial=Ha,a.MeshDepthMaterial=Ag,a.MeshDistanceMaterial=wg,a.MeshFaceMaterial=ZU,a.MeshLambertMaterial=v_,a.MeshMatcapMaterial=y_,a.MeshNormalMaterial=g_,a.MeshPhongMaterial=p_,a.MeshPhysicalMaterial=f_,a.MeshStandardMaterial=Zg,a.MeshToonMaterial=m_,a.MinEquation=k,a.MirroredRepeatWrapping=Ut,a.MixOperation=tt,a.MultiMaterial=JU,a.MultiplyBlending=q,a.MultiplyOperation=At,a.NearestFilter=It,a.NearestMipMapLinearFilter=Je,a.NearestMipMapNearestFilter=Un,a.NearestMipmapLinearFilter=$n,a.NearestMipmapNearestFilter=dn,a.NeverDepth=Qe,a.NeverStencilFunc=fo,a.NoBlending=I,a.NoColors=YU,a.NoToneMapping=ge,a.NormalAnimationBlendMode=Mt,a.NormalBlending=N,a.NotEqualDepth=Ue,a.NotEqualStencilFunc=cN,a.NumberKeyframeTrack=Vf,a.Object3D=Oi,a.ObjectLoader=pU,a.ObjectSpaceNormalMap=ti,a.OctahedronBufferGeometry=Qc,a.OctahedronGeometry=Qc,a.OneFactor=Z,a.OneMinusDstAlphaFactor=ke,a.OneMinusDstColorFactor=Ne,a.OneMinusSrcAlphaFactor=ye,a.OneMinusSrcColorFactor=se,a.OrthographicCamera=Mf,a.PCFShadowMap=A,a.PCFSoftShadowMap=_,a.PMREMGenerator=Hx,a.ParametricGeometry=C6,a.Particle=t6,a.ParticleBasicMaterial=r6,a.ParticleSystem=n6,a.ParticleSystemMaterial=s6,a.Path=Uf,a.PerspectiveCamera=Br,a.Plane=la,a.PlaneBufferGeometry=jc,a.PlaneGeometry=jc,a.PlaneHelper=GU,a.PointCloud=e6,a.PointCloudMaterial=i6,a.PointLight=T_,a.PointLightHelper=kU,a.Points=If,a.PointsMaterial=Kc,a.PolarGridHelper=BU,a.PolyhedronBufferGeometry=ua,a.PolyhedronGeometry=ua,a.PositionalAudio=_U,a.PropertyBinding=ji,a.PropertyMixer=HT,a.QuadraticBezierCurve=$g,a.QuadraticBezierCurve3=Xg,a.Quaternion=Yr,a.QuaternionKeyframeTrack=Fh,a.QuaternionLinearInterpolant=pT,a.REVISION=u,a.RGBADepthPacking=ei,a.RGBAFormat=Pt,a.RGBAIntegerFormat=Tt,a.RGBA_ASTC_10x10_Format=_e,a.RGBA_ASTC_10x5_Format=K,a.RGBA_ASTC_10x6_Format=te,a.RGBA_ASTC_10x8_Format=fe,a.RGBA_ASTC_12x10_Format=Be,a.RGBA_ASTC_12x12_Format=Ze,a.RGBA_ASTC_4x4_Format=ki,a.RGBA_ASTC_5x4_Format=Ni,a.RGBA_ASTC_5x5_Format=Vn,a.RGBA_ASTC_6x5_Format=gi,a.RGBA_ASTC_6x6_Format=Xn,a.RGBA_ASTC_8x5_Format=wr,a.RGBA_ASTC_8x6_Format=Vi,a.RGBA_ASTC_8x8_Format=Wi,a.RGBA_BPTC_Format=lt,a.RGBA_ETC2_EAC_Format=_i,a.RGBA_PVRTC_2BPPV1_Format=hi,a.RGBA_PVRTC_4BPPV1_Format=Jn,a.RGBA_S3TC_DXT1_Format=un,a.RGBA_S3TC_DXT3_Format=tn,a.RGBA_S3TC_DXT5_Format=Bt,a.RGB_ETC1_Format=di,a.RGB_ETC2_Format=ri,a.RGB_PVRTC_2BPPV1_Format=ln,a.RGB_PVRTC_4BPPV1_Format=fn,a.RGB_S3TC_DXT1_Format=zt,a.RGFormat=mt,a.RGIntegerFormat=ot,a.RawShaderMaterial=vh,a.Ray=Nl,a.Raycaster=PU,a.RectAreaLight=L_,a.RedFormat=We,a.RedIntegerFormat=et,a.ReinhardToneMapping=Re,a.RepeatWrapping=Ot,a.ReplaceStencilOp=qi,a.ReverseSubtractEquation=O,a.RingBufferGeometry=Dh,a.RingGeometry=Dh,a.Scene=Tg,a.SceneUtils=S6,a.ShaderChunk=Pi,a.ShaderLib=ko,a.ShaderMaterial=Va,a.ShadowMaterial=d_,a.Shape=ha,a.ShapeBufferGeometry=Zc,a.ShapeGeometry=Zc,a.ShapePath=WU,a.ShapeUtils=da,a.ShortType=Yn,a.Skeleton=Ng,a.SkeletonHelper=QT,a.SkinnedMesh=Ig,a.SmoothShading=L,a.Sphere=Il,a.SphereBufferGeometry=Jc,a.SphereGeometry=Jc,a.Spherical=DU,a.SphericalHarmonics3=P_,a.SplineCurve=qg,a.SpotLight=M_,a.SpotLightHelper=IU,a.Sprite=Pg,a.SpriteMaterial=Cg,a.SrcAlphaFactor=ue,a.SrcAlphaSaturateFactor=He,a.SrcColorFactor=ie,a.StaticCopyUsage=mN,a.StaticDrawUsage=Zu,a.StaticReadUsage=dN,a.StereoCamera=gU,a.StreamCopyUsage=vN,a.StreamDrawUsage=hN,a.StreamReadUsage=pN,a.StringKeyframeTrack=tu,a.SubtractEquation=D,a.SubtractiveBlending=H,a.TOUCH=f,a.TangentSpaceNormalMap=bn,a.TetrahedronBufferGeometry=Oh,a.TetrahedronGeometry=Oh,a.TextGeometry=R6,a.Texture=Nr,a.TextureLoader=yT,a.TorusBufferGeometry=Ih,a.TorusGeometry=Ih,a.TorusKnotBufferGeometry=kh,a.TorusKnotGeometry=kh,a.Triangle=Dr,a.TriangleFanDrawMode=rn,a.TriangleStripDrawMode=Mn,a.TrianglesDrawMode=en,a.TubeBufferGeometry=Nh,a.TubeGeometry=Nh,a.UVMapping=G,a.Uint16Attribute=d6,a.Uint16BufferAttribute=og,a.Uint32Attribute=p6,a.Uint32BufferAttribute=ag,a.Uint8Attribute=c6,a.Uint8BufferAttribute=GM,a.Uint8ClampedAttribute=u6,a.Uint8ClampedBufferAttribute=VM,a.Uniform=tv,a.UniformsLib=En,a.UniformsUtils=YM,a.UnsignedByteType=An,a.UnsignedInt248Type=ze,a.UnsignedIntType=Ii,a.UnsignedShort4444Type=er,a.UnsignedShort5551Type=is,a.UnsignedShortType=Bn,a.VSMShadowMap=E,a.Vector2=Qt,a.Vector3=Ge,a.Vector4=Qi,a.VectorKeyframeTrack=Wf,a.Vertex=o6,a.VertexColors=QU,a.VideoTexture=ZS,a.WebGL1Renderer=DS,a.WebGLCubeRenderTarget=vg,a.WebGLMultipleRenderTargets=LM,a.WebGLMultisampleRenderTarget=Km,a.WebGLRenderTarget=js,a.WebGLRenderTargetCube=A6,a.WebGLRenderer=sr,a.WebGLUtils=CS,a.WireframeGeometry=h_,a.WireframeHelper=_6,a.WrapAroundEnding=rt,a.XHRLoader=b6,a.ZeroCurvatureEnding=Te,a.ZeroFactor=X,a.ZeroSlopeEnding=Ae,a.ZeroStencilOp=xi,a._SRGBAFormat=Xm,a.sRGBEncoding=Sn,Object.defineProperty(a,"__esModule",{value:!0})})},{}],58:[function(i,o,l){(function(){class a{static fromCubeTexture(f){let d=0;const m=new THREE.Vector3,g=new THREE.Vector3,x=new THREE.Color,v=[0,0,0,0,0,0,0,0,0],A=new THREE.SphericalHarmonics3,_=A.coefficients;for(let w=0;w<6;w++){const S=f.image[w],T=S.width,R=S.height,L=document.createElement("canvas");L.width=T,L.height=R;const I=L.getContext("2d");I.drawImage(S,0,0,T,R);const N=I.getImageData(0,0,T,R),B=N.data,H=N.width,q=2/H;for(let le=0,ne=B.length;le<ne;le+=4){x.setRGB(B[le]/255,B[le+1]/255,B[le+2]/255),u(x,f.encoding);const D=le/4,O=-1+(D%H+.5)*q,k=1-(Math.floor(D/H)+.5)*q;switch(w){case 0:m.set(-1,k,-O);break;case 1:m.set(1,k,O);break;case 2:m.set(-O,1,-k);break;case 3:m.set(-O,-1,k);break;case 4:m.set(-O,k,1);break;case 5:m.set(O,k,-1);break}const z=m.lengthSq(),X=4/(Math.sqrt(z)*z);d+=X,g.copy(m).normalize(),THREE.SphericalHarmonics3.getBasisAt(g,v);for(let Z=0;Z<9;Z++)_[Z].x+=v[Z]*x.r*X,_[Z].y+=v[Z]*x.g*X,_[Z].z+=v[Z]*x.b*X}}const E=4*Math.PI/d;for(let w=0;w<9;w++)_[w].x*=E,_[w].y*=E,_[w].z*=E;return new THREE.LightProbe(A)}static fromCubeRenderTarget(f,d){let m=0;const g=new THREE.Vector3,x=new THREE.Vector3,v=new THREE.Color,A=[0,0,0,0,0,0,0,0,0],_=new THREE.SphericalHarmonics3,E=_.coefficients;for(let S=0;S<6;S++){const T=d.width,R=new Uint8Array(T*T*4);f.readRenderTargetPixels(d,0,0,T,T,R,S);const L=2/T;for(let I=0,N=R.length;I<N;I+=4){v.setRGB(R[I]/255,R[I+1]/255,R[I+2]/255),u(v,d.texture.encoding);const B=I/4,H=-1+(B%T+.5)*L,q=1-(Math.floor(B/T)+.5)*L;switch(S){case 0:g.set(1,q,-H);break;case 1:g.set(-1,q,H);break;case 2:g.set(H,1,-q);break;case 3:g.set(H,-1,q);break;case 4:g.set(H,q,1);break;case 5:g.set(-H,q,-1);break}const le=g.lengthSq(),ne=4/(Math.sqrt(le)*le);m+=ne,x.copy(g).normalize(),THREE.SphericalHarmonics3.getBasisAt(x,A);for(let D=0;D<9;D++)E[D].x+=A[D]*v.r*ne,E[D].y+=A[D]*v.g*ne,E[D].z+=A[D]*v.b*ne}}const w=4*Math.PI/m;for(let S=0;S<9;S++)E[S].x*=w,E[S].y*=w,E[S].z*=w;return new THREE.LightProbe(_)}}function u(h,f){switch(f){case THREE.sRGBEncoding:h.convertSRGBToLinear();break;case THREE.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.");break}return h}THREE.LightProbeGenerator=a})()},{}],59:[function(i,o,l){(function(){const a=new WeakMap;class u extends THREE.Loader{constructor(d){super(d),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(d){return this.decoderPath=d,this}setDecoderConfig(d){return this.decoderConfig=d,this}setWorkerLimit(d){return this.workerLimit=d,this}load(d,m,g,x){const v=new THREE.FileLoader(this.manager);v.setPath(this.path),v.setResponseType("arraybuffer"),v.setRequestHeader(this.requestHeader),v.setWithCredentials(this.withCredentials),v.load(d,A=>{const _={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(A,_).then(m).catch(x)},g,x)}decodeDracoFile(d,m,g,x){const v={attributeIDs:g||this.defaultAttributeIDs,attributeTypes:x||this.defaultAttributeTypes,useUniqueIDs:!!g};this.decodeGeometry(d,v).then(m)}decodeGeometry(d,m){for(const E in m.attributeTypes){const w=m.attributeTypes[E];w.BYTES_PER_ELEMENT!==void 0&&(m.attributeTypes[E]=w.name)}const g=JSON.stringify(m);if(a.has(d)){const E=a.get(d);if(E.key===g)return E.promise;if(d.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let x;const v=this.workerNextTaskID++,A=d.byteLength,_=this._getWorker(v,A).then(E=>(x=E,new Promise((w,S)=>{x._callbacks[v]={resolve:w,reject:S},x.postMessage({type:"decode",id:v,taskConfig:m,buffer:d},[d])}))).then(E=>this._createGeometry(E.geometry));return _.catch(()=>!0).then(()=>{x&&v&&this._releaseTask(x,v)}),a.set(d,{key:g,promise:_}),_}_createGeometry(d){const m=new THREE.BufferGeometry;d.index&&m.setIndex(new THREE.BufferAttribute(d.index.array,1));for(let g=0;g<d.attributes.length;g++){const x=d.attributes[g],v=x.name,A=x.array,_=x.itemSize;m.setAttribute(v,new THREE.BufferAttribute(A,_))}return m}_loadLibrary(d,m){const g=new THREE.FileLoader(this.manager);return g.setPath(this.decoderPath),g.setResponseType(m),g.setWithCredentials(this.withCredentials),new Promise((x,v)=>{g.load(d,x,void 0,v)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const d=typeof WebAssembly!="object"||this.decoderConfig.type==="js",m=[];return d?m.push(this._loadLibrary("draco_decoder.js","text")):(m.push(this._loadLibrary("draco_wasm_wrapper.js","text")),m.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(m).then(g=>{const x=g[0];d||(this.decoderConfig.wasmBinary=g[1]);const v=h.toString(),A=["/* draco decoder */",x,"","/* worker */",v.substring(v.indexOf("{")+1,v.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([A]))}),this.decoderPending}_getWorker(d,m){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const x=new Worker(this.workerSourceURL);x._callbacks={},x._taskCosts={},x._taskLoad=0,x.postMessage({type:"init",decoderConfig:this.decoderConfig}),x.onmessage=function(v){const A=v.data;switch(A.type){case"decode":x._callbacks[A.id].resolve(A);break;case"error":x._callbacks[A.id].reject(A);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+A.type+'"')}},this.workerPool.push(x)}else this.workerPool.sort(function(x,v){return x._taskLoad>v._taskLoad?-1:1});const g=this.workerPool[this.workerPool.length-1];return g._taskCosts[d]=m,g._taskLoad+=m,g})}_releaseTask(d,m){d._taskLoad-=d._taskCosts[m],delete d._callbacks[m],delete d._taskCosts[m]}debug(){console.log("Task load: ",this.workerPool.map(d=>d._taskLoad))}dispose(){for(let d=0;d<this.workerPool.length;++d)this.workerPool[d].terminate();return this.workerPool.length=0,this}}function h(){let f,d;onmessage=function(A){const _=A.data;switch(_.type){case"init":f=_.decoderConfig,d=new Promise(function(S){f.onModuleLoaded=function(T){S({draco:T})},DracoDecoderModule(f)});break;case"decode":const E=_.buffer,w=_.taskConfig;d.then(S=>{const T=S.draco,R=new T.Decoder,L=new T.DecoderBuffer;L.Init(new Int8Array(E),E.byteLength);try{const I=m(T,R,L,w),N=I.attributes.map(B=>B.array.buffer);I.index&&N.push(I.index.array.buffer),self.postMessage({type:"decode",id:_.id,geometry:I},N)}catch(I){console.error(I),self.postMessage({type:"error",id:_.id,error:I.message})}finally{T.destroy(L),T.destroy(R)}});break}};function m(A,_,E,w){const S=w.attributeIDs,T=w.attributeTypes;let R,L;const I=_.GetEncodedGeometryType(E);if(I===A.TRIANGULAR_MESH)R=new A.Mesh,L=_.DecodeBufferToMesh(E,R);else if(I===A.POINT_CLOUD)R=new A.PointCloud,L=_.DecodeBufferToPointCloud(E,R);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!L.ok()||R.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+L.error_msg());const N={index:null,attributes:[]};for(const B in S){const H=self[T[B]];let q,le;if(w.useUniqueIDs)le=S[B],q=_.GetAttributeByUniqueId(R,le);else{if(le=_.GetAttributeId(R,A[S[B]]),le===-1)continue;q=_.GetAttribute(R,le)}N.attributes.push(x(A,_,R,B,H,q))}return I===A.TRIANGULAR_MESH&&(N.index=g(A,_,R)),A.destroy(R),N}function g(A,_,E){const S=E.num_faces()*3,T=S*4,R=A._malloc(T);_.GetTrianglesUInt32Array(E,T,R);const L=new Uint32Array(A.HEAPF32.buffer,R,S).slice();return A._free(R),{array:L,itemSize:1}}function x(A,_,E,w,S,T){const R=T.num_components(),I=E.num_points()*R,N=I*S.BYTES_PER_ELEMENT,B=v(A,S),H=A._malloc(N);_.GetAttributeDataArrayForAllPoints(E,T,B,N,H);const q=new S(A.HEAPF32.buffer,H,I).slice();return A._free(H),{name:w,array:q,itemSize:R}}function v(A,_){switch(_){case Float32Array:return A.DT_FLOAT32;case Int8Array:return A.DT_INT8;case Int16Array:return A.DT_INT16;case Int32Array:return A.DT_INT32;case Uint8Array:return A.DT_UINT8;case Uint16Array:return A.DT_UINT16;case Uint32Array:return A.DT_UINT32}}}THREE.DRACOLoader=u})()},{}],60:[function(i,o,l){(function(){class a extends THREE.Loader{constructor(pe){super(pe),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(ge){return new m(ge)}),this.register(function(ge){return new E(ge)}),this.register(function(ge){return new w(ge)}),this.register(function(ge){return new g(ge)}),this.register(function(ge){return new x(ge)}),this.register(function(ge){return new v(ge)}),this.register(function(ge){return new A(ge)}),this.register(function(ge){return new _(ge)}),this.register(function(ge){return new f(ge)}),this.register(function(ge){return new S(ge)})}load(pe,ge,Fe,Re){const ce=this;let ae;this.resourcePath!==""?ae=this.resourcePath:this.path!==""?ae=this.path:ae=THREE.LoaderUtils.extractUrlBase(pe),this.manager.itemStart(pe);const J=function($){Re?Re($):console.error($),ce.manager.itemError(pe),ce.manager.itemEnd(pe)},G=new THREE.FileLoader(this.manager);G.setPath(this.path),G.setResponseType("arraybuffer"),G.setRequestHeader(this.requestHeader),G.setWithCredentials(this.withCredentials),G.load(pe,function($){try{ce.parse($,ae,function(me){ge(me),ce.manager.itemEnd(pe)},J)}catch(me){J(me)}},Fe,J)}setDRACOLoader(pe){return this.dracoLoader=pe,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(pe){return this.ktx2Loader=pe,this}setMeshoptDecoder(pe){return this.meshoptDecoder=pe,this}register(pe){return this.pluginCallbacks.indexOf(pe)===-1&&this.pluginCallbacks.push(pe),this}unregister(pe){return this.pluginCallbacks.indexOf(pe)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(pe),1),this}parse(pe,ge,Fe,Re){let ce;const ae={},J={};if(typeof pe=="string")ce=pe;else if(THREE.LoaderUtils.decodeText(new Uint8Array(pe,0,4))===T){try{ae[h.KHR_BINARY_GLTF]=new I(pe)}catch(Pe){Re&&Re(Pe);return}ce=ae[h.KHR_BINARY_GLTF].content}else ce=THREE.LoaderUtils.decodeText(new Uint8Array(pe));const G=JSON.parse(ce);if(G.asset===void 0||G.asset.version[0]<2){Re&&Re(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const $=new sn(G,{path:ge||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});$.fileLoader.setRequestHeader(this.requestHeader);for(let me=0;me<this.pluginCallbacks.length;me++){const Pe=this.pluginCallbacks[me]($);J[Pe.name]=Pe,ae[Pe.name]=!0}if(G.extensionsUsed)for(let me=0;me<G.extensionsUsed.length;++me){const Pe=G.extensionsUsed[me],ve=G.extensionsRequired||[];switch(Pe){case h.KHR_MATERIALS_UNLIT:ae[Pe]=new d;break;case h.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:ae[Pe]=new q;break;case h.KHR_DRACO_MESH_COMPRESSION:ae[Pe]=new N(G,this.dracoLoader);break;case h.KHR_TEXTURE_TRANSFORM:ae[Pe]=new B;break;case h.KHR_MESH_QUANTIZATION:ae[Pe]=new le;break;default:ve.indexOf(Pe)>=0&&J[Pe]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+Pe+'".')}}$.setExtensions(ae),$.setPlugins(J),$.parse(Fe,Re)}parseAsync(pe,ge){const Fe=this;return new Promise(function(Re,ce){Fe.parse(pe,ge,Re,ce)})}}function u(){let tt={};return{get:function(pe){return tt[pe]},add:function(pe,ge){tt[pe]=ge},remove:function(pe){delete tt[pe]},removeAll:function(){tt={}}}}const h={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class f{constructor(pe){this.parser=pe,this.name=h.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const pe=this.parser,ge=this.parser.json.nodes||[];for(let Fe=0,Re=ge.length;Fe<Re;Fe++){const ce=ge[Fe];ce.extensions&&ce.extensions[this.name]&&ce.extensions[this.name].light!==void 0&&pe._addNodeRef(this.cache,ce.extensions[this.name].light)}}_loadLight(pe){const ge=this.parser,Fe="light:"+pe;let Re=ge.cache.get(Fe);if(Re)return Re;const ce=ge.json,G=((ce.extensions&&ce.extensions[this.name]||{}).lights||[])[pe];let $;const me=new THREE.Color(16777215);G.color!==void 0&&me.fromArray(G.color);const Pe=G.range!==void 0?G.range:0;switch(G.type){case"directional":$=new THREE.DirectionalLight(me),$.target.position.set(0,0,-1),$.add($.target);break;case"point":$=new THREE.PointLight(me),$.distance=Pe;break;case"spot":$=new THREE.SpotLight(me),$.distance=Pe,G.spot=G.spot||{},G.spot.innerConeAngle=G.spot.innerConeAngle!==void 0?G.spot.innerConeAngle:0,G.spot.outerConeAngle=G.spot.outerConeAngle!==void 0?G.spot.outerConeAngle:Math.PI/4,$.angle=G.spot.outerConeAngle,$.penumbra=1-G.spot.innerConeAngle/G.spot.outerConeAngle,$.target.position.set(0,0,-1),$.add($.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+G.type)}return $.position.set(0,0,0),$.decay=2,G.intensity!==void 0&&($.intensity=G.intensity),$.name=ge.createUniqueName(G.name||"light_"+pe),Re=Promise.resolve($),ge.cache.add(Fe,Re),Re}createNodeAttachment(pe){const ge=this,Fe=this.parser,ce=Fe.json.nodes[pe],J=(ce.extensions&&ce.extensions[this.name]||{}).light;return J===void 0?null:this._loadLight(J).then(function(G){return Fe._getNodeRef(ge.cache,J,G)})}}class d{constructor(){this.name=h.KHR_MATERIALS_UNLIT}getMaterialType(){return THREE.MeshBasicMaterial}extendParams(pe,ge,Fe){const Re=[];pe.color=new THREE.Color(1,1,1),pe.opacity=1;const ce=ge.pbrMetallicRoughness;if(ce){if(Array.isArray(ce.baseColorFactor)){const ae=ce.baseColorFactor;pe.color.fromArray(ae),pe.opacity=ae[3]}ce.baseColorTexture!==void 0&&Re.push(Fe.assignTexture(pe,"map",ce.baseColorTexture))}return Promise.all(Re)}}class m{constructor(pe){this.parser=pe,this.name=h.KHR_MATERIALS_CLEARCOAT}getMaterialType(pe){const Fe=this.parser.json.materials[pe];return!Fe.extensions||!Fe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(pe,ge){const Fe=this.parser,Re=Fe.json.materials[pe];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const ce=[],ae=Re.extensions[this.name];if(ae.clearcoatFactor!==void 0&&(ge.clearcoat=ae.clearcoatFactor),ae.clearcoatTexture!==void 0&&ce.push(Fe.assignTexture(ge,"clearcoatMap",ae.clearcoatTexture)),ae.clearcoatRoughnessFactor!==void 0&&(ge.clearcoatRoughness=ae.clearcoatRoughnessFactor),ae.clearcoatRoughnessTexture!==void 0&&ce.push(Fe.assignTexture(ge,"clearcoatRoughnessMap",ae.clearcoatRoughnessTexture)),ae.clearcoatNormalTexture!==void 0&&(ce.push(Fe.assignTexture(ge,"clearcoatNormalMap",ae.clearcoatNormalTexture)),ae.clearcoatNormalTexture.scale!==void 0)){const J=ae.clearcoatNormalTexture.scale;ge.clearcoatNormalScale=new THREE.Vector2(J,J)}return Promise.all(ce)}}class g{constructor(pe){this.parser=pe,this.name=h.KHR_MATERIALS_SHEEN}getMaterialType(pe){const Fe=this.parser.json.materials[pe];return!Fe.extensions||!Fe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(pe,ge){const Fe=this.parser,Re=Fe.json.materials[pe];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const ce=[];ge.sheenColor=new THREE.Color(0,0,0),ge.sheenRoughness=0,ge.sheen=1;const ae=Re.extensions[this.name];return ae.sheenColorFactor!==void 0&&ge.sheenColor.fromArray(ae.sheenColorFactor),ae.sheenRoughnessFactor!==void 0&&(ge.sheenRoughness=ae.sheenRoughnessFactor),ae.sheenColorTexture!==void 0&&ce.push(Fe.assignTexture(ge,"sheenColorMap",ae.sheenColorTexture)),ae.sheenRoughnessTexture!==void 0&&ce.push(Fe.assignTexture(ge,"sheenRoughnessMap",ae.sheenRoughnessTexture)),Promise.all(ce)}}class x{constructor(pe){this.parser=pe,this.name=h.KHR_MATERIALS_TRANSMISSION}getMaterialType(pe){const Fe=this.parser.json.materials[pe];return!Fe.extensions||!Fe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(pe,ge){const Fe=this.parser,Re=Fe.json.materials[pe];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const ce=[],ae=Re.extensions[this.name];return ae.transmissionFactor!==void 0&&(ge.transmission=ae.transmissionFactor),ae.transmissionTexture!==void 0&&ce.push(Fe.assignTexture(ge,"transmissionMap",ae.transmissionTexture)),Promise.all(ce)}}class v{constructor(pe){this.parser=pe,this.name=h.KHR_MATERIALS_VOLUME}getMaterialType(pe){const Fe=this.parser.json.materials[pe];return!Fe.extensions||!Fe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(pe,ge){const Fe=this.parser,Re=Fe.json.materials[pe];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const ce=[],ae=Re.extensions[this.name];ge.thickness=ae.thicknessFactor!==void 0?ae.thicknessFactor:0,ae.thicknessTexture!==void 0&&ce.push(Fe.assignTexture(ge,"thicknessMap",ae.thicknessTexture)),ge.attenuationDistance=ae.attenuationDistance||0;const J=ae.attenuationColor||[1,1,1];return ge.attenuationColor=new THREE.Color(J[0],J[1],J[2]),Promise.all(ce)}}class A{constructor(pe){this.parser=pe,this.name=h.KHR_MATERIALS_IOR}getMaterialType(pe){const Fe=this.parser.json.materials[pe];return!Fe.extensions||!Fe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(pe,ge){const Re=this.parser.json.materials[pe];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const ce=Re.extensions[this.name];return ge.ior=ce.ior!==void 0?ce.ior:1.5,Promise.resolve()}}class _{constructor(pe){this.parser=pe,this.name=h.KHR_MATERIALS_SPECULAR}getMaterialType(pe){const Fe=this.parser.json.materials[pe];return!Fe.extensions||!Fe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(pe,ge){const Fe=this.parser,Re=Fe.json.materials[pe];if(!Re.extensions||!Re.extensions[this.name])return Promise.resolve();const ce=[],ae=Re.extensions[this.name];ge.specularIntensity=ae.specularFactor!==void 0?ae.specularFactor:1,ae.specularTexture!==void 0&&ce.push(Fe.assignTexture(ge,"specularIntensityMap",ae.specularTexture));const J=ae.specularColorFactor||[1,1,1];return ge.specularColor=new THREE.Color(J[0],J[1],J[2]),ae.specularColorTexture!==void 0&&ce.push(Fe.assignTexture(ge,"specularColorMap",ae.specularColorTexture).then(function(G){G.encoding=THREE.sRGBEncoding})),Promise.all(ce)}}class E{constructor(pe){this.parser=pe,this.name=h.KHR_TEXTURE_BASISU}loadTexture(pe){const ge=this.parser,Fe=ge.json,Re=Fe.textures[pe];if(!Re.extensions||!Re.extensions[this.name])return null;const ce=Re.extensions[this.name],ae=Fe.images[ce.source],J=ge.options.ktx2Loader;if(!J){if(Fe.extensionsRequired&&Fe.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return ge.loadTextureImage(pe,ae,J)}}class w{constructor(pe){this.parser=pe,this.name=h.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(pe){const ge=this.name,Fe=this.parser,Re=Fe.json,ce=Re.textures[pe];if(!ce.extensions||!ce.extensions[ge])return null;const ae=ce.extensions[ge],J=Re.images[ae.source];let G=Fe.textureLoader;if(J.uri){const $=Fe.options.manager.getHandler(J.uri);$!==null&&(G=$)}return this.detectSupport().then(function($){if($)return Fe.loadTextureImage(pe,J,G);if(Re.extensionsRequired&&Re.extensionsRequired.indexOf(ge)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Fe.loadTexture(pe)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(pe){const ge=new Image;ge.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",ge.onload=ge.onerror=function(){pe(ge.height===1)}})),this.isSupported}}class S{constructor(pe){this.name=h.EXT_MESHOPT_COMPRESSION,this.parser=pe}loadBufferView(pe){const ge=this.parser.json,Fe=ge.bufferViews[pe];if(Fe.extensions&&Fe.extensions[this.name]){const Re=Fe.extensions[this.name],ce=this.parser.getDependency("buffer",Re.buffer),ae=this.parser.options.meshoptDecoder;if(!ae||!ae.supported){if(ge.extensionsRequired&&ge.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([ce,ae.ready]).then(function(J){const G=Re.byteOffset||0,$=Re.byteLength||0,me=Re.count,Pe=Re.byteStride,ve=new ArrayBuffer(me*Pe),Le=new Uint8Array(J[0],G,$);return ae.decodeGltfBuffer(new Uint8Array(ve),me,Pe,Le,Re.mode,Re.filter),ve})}else return null}}const T="glTF",R=12,L={JSON:1313821514,BIN:5130562};class I{constructor(pe){this.name=h.KHR_BINARY_GLTF,this.content=null,this.body=null;const ge=new DataView(pe,0,R);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(pe.slice(0,4))),version:ge.getUint32(4,!0),length:ge.getUint32(8,!0)},this.header.magic!==T)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const Fe=this.header.length-R,Re=new DataView(pe,R);let ce=0;for(;ce<Fe;){const ae=Re.getUint32(ce,!0);ce+=4;const J=Re.getUint32(ce,!0);if(ce+=4,J===L.JSON){const G=new Uint8Array(pe,R+ce,ae);this.content=THREE.LoaderUtils.decodeText(G)}else if(J===L.BIN){const G=R+ce;this.body=pe.slice(G,G+ae)}ce+=ae}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class N{constructor(pe,ge){if(!ge)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=h.KHR_DRACO_MESH_COMPRESSION,this.json=pe,this.dracoLoader=ge,this.dracoLoader.preload()}decodePrimitive(pe,ge){const Fe=this.json,Re=this.dracoLoader,ce=pe.extensions[this.name].bufferView,ae=pe.extensions[this.name].attributes,J={},G={},$={};for(const me in ae){const Pe=se[me]||me.toLowerCase();J[Pe]=ae[me]}for(const me in pe.attributes){const Pe=se[me]||me.toLowerCase();if(ae[me]!==void 0){const ve=Fe.accessors[pe.attributes[me]],Le=z[ve.componentType];$[Pe]=Le,G[Pe]=ve.normalized===!0}}return ge.getDependency("bufferView",ce).then(function(me){return new Promise(function(Pe){Re.decodeDracoFile(me,function(ve){for(const Le in ve.attributes){const wt=ve.attributes[Le],Ot=G[Le];Ot!==void 0&&(wt.normalized=Ot)}Pe(ve)},J,$)})})}}class B{constructor(){this.name=h.KHR_TEXTURE_TRANSFORM}extendTexture(pe,ge){return ge.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),ge.offset===void 0&&ge.rotation===void 0&&ge.scale===void 0||(pe=pe.clone(),ge.offset!==void 0&&pe.offset.fromArray(ge.offset),ge.rotation!==void 0&&(pe.rotation=ge.rotation),ge.scale!==void 0&&pe.repeat.fromArray(ge.scale),pe.needsUpdate=!0),pe}}class H extends THREE.MeshStandardMaterial{constructor(pe){super(),this.isGLTFSpecularGlossinessMaterial=!0;const ge=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),Fe=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),Re=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),ce=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),ae=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),J={specular:{value:new THREE.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=J,this.onBeforeCompile=function(G){for(const $ in J)G.uniforms[$]=J[$];G.fragmentShader=G.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",ge).replace("#include <metalnessmap_pars_fragment>",Fe).replace("#include <roughnessmap_fragment>",Re).replace("#include <metalnessmap_fragment>",ce).replace("#include <lights_physical_fragment>",ae)},Object.defineProperties(this,{specular:{get:function(){return J.specular.value},set:function(G){J.specular.value=G}},specularMap:{get:function(){return J.specularMap.value},set:function(G){J.specularMap.value=G,G?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return J.glossiness.value},set:function(G){J.glossiness.value=G}},glossinessMap:{get:function(){return J.glossinessMap.value},set:function(G){J.glossinessMap.value=G,G?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(pe)}copy(pe){return super.copy(pe),this.specularMap=pe.specularMap,this.specular.copy(pe.specular),this.glossinessMap=pe.glossinessMap,this.glossiness=pe.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class q{constructor(){this.name=h.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return H}extendParams(pe,ge,Fe){const Re=ge.extensions[this.name];pe.color=new THREE.Color(1,1,1),pe.opacity=1;const ce=[];if(Array.isArray(Re.diffuseFactor)){const ae=Re.diffuseFactor;pe.color.fromArray(ae),pe.opacity=ae[3]}if(Re.diffuseTexture!==void 0&&ce.push(Fe.assignTexture(pe,"map",Re.diffuseTexture)),pe.emissive=new THREE.Color(0,0,0),pe.glossiness=Re.glossinessFactor!==void 0?Re.glossinessFactor:1,pe.specular=new THREE.Color(1,1,1),Array.isArray(Re.specularFactor)&&pe.specular.fromArray(Re.specularFactor),Re.specularGlossinessTexture!==void 0){const ae=Re.specularGlossinessTexture;ce.push(Fe.assignTexture(pe,"glossinessMap",ae)),ce.push(Fe.assignTexture(pe,"specularMap",ae))}return Promise.all(ce)}createMaterial(pe){const ge=new H(pe);return ge.fog=!0,ge.color=pe.color,ge.map=pe.map===void 0?null:pe.map,ge.lightMap=null,ge.lightMapIntensity=1,ge.aoMap=pe.aoMap===void 0?null:pe.aoMap,ge.aoMapIntensity=1,ge.emissive=pe.emissive,ge.emissiveIntensity=1,ge.emissiveMap=pe.emissiveMap===void 0?null:pe.emissiveMap,ge.bumpMap=pe.bumpMap===void 0?null:pe.bumpMap,ge.bumpScale=1,ge.normalMap=pe.normalMap===void 0?null:pe.normalMap,ge.normalMapType=THREE.TangentSpaceNormalMap,pe.normalScale&&(ge.normalScale=pe.normalScale),ge.displacementMap=null,ge.displacementScale=1,ge.displacementBias=0,ge.specularMap=pe.specularMap===void 0?null:pe.specularMap,ge.specular=pe.specular,ge.glossinessMap=pe.glossinessMap===void 0?null:pe.glossinessMap,ge.glossiness=pe.glossiness,ge.alphaMap=null,ge.envMap=pe.envMap===void 0?null:pe.envMap,ge.envMapIntensity=1,ge.refractionRatio=.98,ge}}class le{constructor(){this.name=h.KHR_MESH_QUANTIZATION}}class ne extends THREE.Interpolant{constructor(pe,ge,Fe,Re){super(pe,ge,Fe,Re)}copySampleValue_(pe){const ge=this.resultBuffer,Fe=this.sampleValues,Re=this.valueSize,ce=pe*Re*3+Re;for(let ae=0;ae!==Re;ae++)ge[ae]=Fe[ce+ae];return ge}}ne.prototype.beforeStart_=ne.prototype.copySampleValue_,ne.prototype.afterEnd_=ne.prototype.copySampleValue_,ne.prototype.interpolate_=function(tt,pe,ge,Fe){const Re=this.resultBuffer,ce=this.sampleValues,ae=this.valueSize,J=ae*2,G=ae*3,$=Fe-pe,me=(ge-pe)/$,Pe=me*me,ve=Pe*me,Le=tt*G,wt=Le-G,Ot=-2*ve+3*Pe,_t=ve-Pe,Ut=1-Ot,It=_t-Pe+me;for(let dn=0;dn!==ae;dn++){const Un=ce[wt+dn+ae],$n=ce[wt+dn+J]*$,Je=ce[Le+dn+ae],Ve=ce[Le+dn]*$;Re[dn]=Ut*Un+It*$n+Ot*Je+_t*Ve}return Re};const D=new THREE.Quaternion;class O extends ne{interpolate_(pe,ge,Fe,Re){const ce=super.interpolate_(pe,ge,Fe,Re);return D.fromArray(ce).normalize().toArray(ce),ce}}const k={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},z={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},X={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},Z={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},ie={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},se={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ue={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ye={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},Ce={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function ke(tt){return tt.DefaultMaterial===void 0&&(tt.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),tt.DefaultMaterial}function Oe(tt,pe,ge){for(const Fe in ge.extensions)tt[Fe]===void 0&&(pe.userData.gltfExtensions=pe.userData.gltfExtensions||{},pe.userData.gltfExtensions[Fe]=ge.extensions[Fe])}function Ne(tt,pe){pe.extras!==void 0&&(typeof pe.extras=="object"?Object.assign(tt.userData,pe.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+pe.extras))}function He(tt,pe,ge){let Fe=!1,Re=!1;for(let J=0,G=pe.length;J<G;J++){const $=pe[J];if($.POSITION!==void 0&&(Fe=!0),$.NORMAL!==void 0&&(Re=!0),Fe&&Re)break}if(!Fe&&!Re)return Promise.resolve(tt);const ce=[],ae=[];for(let J=0,G=pe.length;J<G;J++){const $=pe[J];if(Fe){const me=$.POSITION!==void 0?ge.getDependency("accessor",$.POSITION):tt.attributes.position;ce.push(me)}if(Re){const me=$.NORMAL!==void 0?ge.getDependency("accessor",$.NORMAL):tt.attributes.normal;ae.push(me)}}return Promise.all([Promise.all(ce),Promise.all(ae)]).then(function(J){const G=J[0],$=J[1];return Fe&&(tt.morphAttributes.position=G),Re&&(tt.morphAttributes.normal=$),tt.morphTargetsRelative=!0,tt})}function Qe(tt,pe){if(tt.updateMorphTargets(),pe.weights!==void 0)for(let ge=0,Fe=pe.weights.length;ge<Fe;ge++)tt.morphTargetInfluences[ge]=pe.weights[ge];if(pe.extras&&Array.isArray(pe.extras.targetNames)){const ge=pe.extras.targetNames;if(tt.morphTargetInfluences.length===ge.length){tt.morphTargetDictionary={};for(let Fe=0,Re=ge.length;Fe<Re;Fe++)tt.morphTargetDictionary[ge[Fe]]=Fe}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function St(tt){const pe=tt.extensions&&tt.extensions[h.KHR_DRACO_MESH_COMPRESSION];let ge;return pe?ge="draco:"+pe.bufferView+":"+pe.indices+":"+bt(pe.attributes):ge=tt.indices+":"+bt(tt.attributes)+":"+tt.mode,ge}function bt(tt){let pe="";const ge=Object.keys(tt).sort();for(let Fe=0,Re=ge.length;Fe<Re;Fe++)pe+=ge[Fe]+":"+tt[ge[Fe]]+";";return pe}function Jt(tt){switch(tt){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class sn{constructor(pe={},ge={}){this.json=pe,this.extensions={},this.plugins={},this.options=ge,this.cache=new u,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap<"u"&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(pe){this.extensions=pe}setPlugins(pe){this.plugins=pe}parse(pe,ge){const Fe=this,Re=this.json,ce=this.extensions;this.cache.removeAll(),this._invokeAll(function(ae){return ae._markDefs&&ae._markDefs()}),Promise.all(this._invokeAll(function(ae){return ae.beforeRoot&&ae.beforeRoot()})).then(function(){return Promise.all([Fe.getDependencies("scene"),Fe.getDependencies("animation"),Fe.getDependencies("camera")])}).then(function(ae){const J={scene:ae[0][Re.scene||0],scenes:ae[0],animations:ae[1],cameras:ae[2],asset:Re.asset,parser:Fe,userData:{}};Oe(ce,J,Re),Ne(J,Re),Promise.all(Fe._invokeAll(function(G){return G.afterRoot&&G.afterRoot(J)})).then(function(){pe(J)})}).catch(ge)}_markDefs(){const pe=this.json.nodes||[],ge=this.json.skins||[],Fe=this.json.meshes||[];for(let Re=0,ce=ge.length;Re<ce;Re++){const ae=ge[Re].joints;for(let J=0,G=ae.length;J<G;J++)pe[ae[J]].isBone=!0}for(let Re=0,ce=pe.length;Re<ce;Re++){const ae=pe[Re];ae.mesh!==void 0&&(this._addNodeRef(this.meshCache,ae.mesh),ae.skin!==void 0&&(Fe[ae.mesh].isSkinnedMesh=!0)),ae.camera!==void 0&&this._addNodeRef(this.cameraCache,ae.camera)}}_addNodeRef(pe,ge){ge!==void 0&&(pe.refs[ge]===void 0&&(pe.refs[ge]=pe.uses[ge]=0),pe.refs[ge]++)}_getNodeRef(pe,ge,Fe){if(pe.refs[ge]<=1)return Fe;const Re=Fe.clone(),ce=(ae,J)=>{const G=this.associations.get(ae);G!=null&&this.associations.set(J,G);for(const[$,me]of ae.children.entries())ce(me,J.children[$])};return ce(Fe,Re),Re.name+="_instance_"+pe.uses[ge]++,Re}_invokeOne(pe){const ge=Object.values(this.plugins);ge.push(this);for(let Fe=0;Fe<ge.length;Fe++){const Re=pe(ge[Fe]);if(Re)return Re}return null}_invokeAll(pe){const ge=Object.values(this.plugins);ge.unshift(this);const Fe=[];for(let Re=0;Re<ge.length;Re++){const ce=pe(ge[Re]);ce&&Fe.push(ce)}return Fe}getDependency(pe,ge){const Fe=pe+":"+ge;let Re=this.cache.get(Fe);if(!Re){switch(pe){case"scene":Re=this.loadScene(ge);break;case"node":Re=this.loadNode(ge);break;case"mesh":Re=this._invokeOne(function(ce){return ce.loadMesh&&ce.loadMesh(ge)});break;case"accessor":Re=this.loadAccessor(ge);break;case"bufferView":Re=this._invokeOne(function(ce){return ce.loadBufferView&&ce.loadBufferView(ge)});break;case"buffer":Re=this.loadBuffer(ge);break;case"material":Re=this._invokeOne(function(ce){return ce.loadMaterial&&ce.loadMaterial(ge)});break;case"texture":Re=this._invokeOne(function(ce){return ce.loadTexture&&ce.loadTexture(ge)});break;case"skin":Re=this.loadSkin(ge);break;case"animation":Re=this.loadAnimation(ge);break;case"camera":Re=this.loadCamera(ge);break;default:throw new Error("Unknown type: "+pe)}this.cache.add(Fe,Re)}return Re}getDependencies(pe){let ge=this.cache.get(pe);if(!ge){const Fe=this,Re=this.json[pe+(pe==="mesh"?"es":"s")]||[];ge=Promise.all(Re.map(function(ce,ae){return Fe.getDependency(pe,ae)})),this.cache.add(pe,ge)}return ge}loadBuffer(pe){const ge=this.json.buffers[pe],Fe=this.fileLoader;if(ge.type&&ge.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+ge.type+" buffer type is not supported.");if(ge.uri===void 0&&pe===0)return Promise.resolve(this.extensions[h.KHR_BINARY_GLTF].body);const Re=this.options;return new Promise(function(ce,ae){Fe.load(THREE.LoaderUtils.resolveURL(ge.uri,Re.path),ce,void 0,function(){ae(new Error('THREE.GLTFLoader: Failed to load buffer "'+ge.uri+'".'))})})}loadBufferView(pe){const ge=this.json.bufferViews[pe];return this.getDependency("buffer",ge.buffer).then(function(Fe){const Re=ge.byteLength||0,ce=ge.byteOffset||0;return Fe.slice(ce,ce+Re)})}loadAccessor(pe){const ge=this,Fe=this.json,Re=this.json.accessors[pe];if(Re.bufferView===void 0&&Re.sparse===void 0)return Promise.resolve(null);const ce=[];return Re.bufferView!==void 0?ce.push(this.getDependency("bufferView",Re.bufferView)):ce.push(null),Re.sparse!==void 0&&(ce.push(this.getDependency("bufferView",Re.sparse.indices.bufferView)),ce.push(this.getDependency("bufferView",Re.sparse.values.bufferView))),Promise.all(ce).then(function(ae){const J=ae[0],G=ie[Re.type],$=z[Re.componentType],me=$.BYTES_PER_ELEMENT,Pe=me*G,ve=Re.byteOffset||0,Le=Re.bufferView!==void 0?Fe.bufferViews[Re.bufferView].byteStride:void 0,wt=Re.normalized===!0;let Ot,_t;if(Le&&Le!==Pe){const Ut=Math.floor(ve/Le),It="InterleavedBuffer:"+Re.bufferView+":"+Re.componentType+":"+Ut+":"+Re.count;let dn=ge.cache.get(It);dn||(Ot=new $(J,Ut*Le,Re.count*Le/me),dn=new THREE.InterleavedBuffer(Ot,Le/me),ge.cache.add(It,dn)),_t=new THREE.InterleavedBufferAttribute(dn,G,ve%Le/me,wt)}else J===null?Ot=new $(Re.count*G):Ot=new $(J,ve,Re.count*G),_t=new THREE.BufferAttribute(Ot,G,wt);if(Re.sparse!==void 0){const Ut=ie.SCALAR,It=z[Re.sparse.indices.componentType],dn=Re.sparse.indices.byteOffset||0,Un=Re.sparse.values.byteOffset||0,$n=new It(ae[1],dn,Re.sparse.count*Ut),Je=new $(ae[2],Un,Re.sparse.count*G);J!==null&&(_t=new THREE.BufferAttribute(_t.array.slice(),_t.itemSize,_t.normalized));for(let Ve=0,nt=$n.length;Ve<nt;Ve++){const yt=$n[Ve];if(_t.setX(yt,Je[Ve*G]),G>=2&&_t.setY(yt,Je[Ve*G+1]),G>=3&&_t.setZ(yt,Je[Ve*G+2]),G>=4&&_t.setW(yt,Je[Ve*G+3]),G>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse THREE.BufferAttribute.")}}return _t})}loadTexture(pe){const ge=this.json,Fe=this.options,Re=ge.textures[pe],ce=ge.images[Re.source];let ae=this.textureLoader;if(ce.uri){const J=Fe.manager.getHandler(ce.uri);J!==null&&(ae=J)}return this.loadTextureImage(pe,ce,ae)}loadTextureImage(pe,ge,Fe){const Re=this,ce=this.json,ae=this.options,J=ce.textures[pe],G=(ge.uri||ge.bufferView)+":"+J.sampler;if(this.textureCache[G])return this.textureCache[G];const $=self.URL||self.webkitURL;let me=ge.uri||"",Pe=!1;if(ge.bufferView!==void 0)me=Re.getDependency("bufferView",ge.bufferView).then(function(Le){Pe=!0;const wt=new Blob([Le],{type:ge.mimeType});return me=$.createObjectURL(wt),me});else if(ge.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+pe+" is missing URI and bufferView");const ve=Promise.resolve(me).then(function(Le){return new Promise(function(wt,Ot){let _t=wt;Fe.isImageBitmapLoader===!0&&(_t=function(Ut){const It=new THREE.Texture(Ut);It.needsUpdate=!0,wt(It)}),Fe.load(THREE.LoaderUtils.resolveURL(Le,ae.path),_t,void 0,Ot)})}).then(function(Le){Pe===!0&&$.revokeObjectURL(me),Le.flipY=!1,J.name&&(Le.name=J.name);const Ot=(ce.samplers||{})[J.sampler]||{};return Le.magFilter=X[Ot.magFilter]||THREE.LinearFilter,Le.minFilter=X[Ot.minFilter]||THREE.LinearMipmapLinearFilter,Le.wrapS=Z[Ot.wrapS]||THREE.RepeatWrapping,Le.wrapT=Z[Ot.wrapT]||THREE.RepeatWrapping,Re.associations.set(Le,{textures:pe}),Le}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",me),null});return this.textureCache[G]=ve,ve}assignTexture(pe,ge,Fe){const Re=this;return this.getDependency("texture",Fe.index).then(function(ce){if(Fe.texCoord!==void 0&&Fe.texCoord!=0&&!(ge==="aoMap"&&Fe.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+Fe.texCoord+" for texture "+ge+" not yet supported."),Re.extensions[h.KHR_TEXTURE_TRANSFORM]){const ae=Fe.extensions!==void 0?Fe.extensions[h.KHR_TEXTURE_TRANSFORM]:void 0;if(ae){const J=Re.associations.get(ce);ce=Re.extensions[h.KHR_TEXTURE_TRANSFORM].extendTexture(ce,ae),Re.associations.set(ce,J)}}return pe[ge]=ce,ce})}assignFinalMaterial(pe){const ge=pe.geometry;let Fe=pe.material;const Re=ge.attributes.tangent===void 0,ce=ge.attributes.color!==void 0,ae=ge.attributes.normal===void 0;if(pe.isPoints){const J="PointsMaterial:"+Fe.uuid;let G=this.cache.get(J);G||(G=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(G,Fe),G.color.copy(Fe.color),G.map=Fe.map,G.sizeAttenuation=!1,this.cache.add(J,G)),Fe=G}else if(pe.isLine){const J="LineBasicMaterial:"+Fe.uuid;let G=this.cache.get(J);G||(G=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(G,Fe),G.color.copy(Fe.color),this.cache.add(J,G)),Fe=G}if(Re||ce||ae){let J="ClonedMaterial:"+Fe.uuid+":";Fe.isGLTFSpecularGlossinessMaterial&&(J+="specular-glossiness:"),Re&&(J+="derivative-tangents:"),ce&&(J+="vertex-colors:"),ae&&(J+="flat-shading:");let G=this.cache.get(J);G||(G=Fe.clone(),ce&&(G.vertexColors=!0),ae&&(G.flatShading=!0),Re&&(G.normalScale&&(G.normalScale.y*=-1),G.clearcoatNormalScale&&(G.clearcoatNormalScale.y*=-1)),this.cache.add(J,G),this.associations.set(G,this.associations.get(Fe))),Fe=G}Fe.aoMap&&ge.attributes.uv2===void 0&&ge.attributes.uv!==void 0&&ge.setAttribute("uv2",ge.attributes.uv),pe.material=Fe}getMaterialType(){return THREE.MeshStandardMaterial}loadMaterial(pe){const ge=this,Fe=this.json,Re=this.extensions,ce=Fe.materials[pe];let ae;const J={},G=ce.extensions||{},$=[];if(G[h.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const Pe=Re[h.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];ae=Pe.getMaterialType(),$.push(Pe.extendParams(J,ce,ge))}else if(G[h.KHR_MATERIALS_UNLIT]){const Pe=Re[h.KHR_MATERIALS_UNLIT];ae=Pe.getMaterialType(),$.push(Pe.extendParams(J,ce,ge))}else{const Pe=ce.pbrMetallicRoughness||{};if(J.color=new THREE.Color(1,1,1),J.opacity=1,Array.isArray(Pe.baseColorFactor)){const ve=Pe.baseColorFactor;J.color.fromArray(ve),J.opacity=ve[3]}Pe.baseColorTexture!==void 0&&$.push(ge.assignTexture(J,"map",Pe.baseColorTexture)),J.metalness=Pe.metallicFactor!==void 0?Pe.metallicFactor:1,J.roughness=Pe.roughnessFactor!==void 0?Pe.roughnessFactor:1,Pe.metallicRoughnessTexture!==void 0&&($.push(ge.assignTexture(J,"metalnessMap",Pe.metallicRoughnessTexture)),$.push(ge.assignTexture(J,"roughnessMap",Pe.metallicRoughnessTexture))),ae=this._invokeOne(function(ve){return ve.getMaterialType&&ve.getMaterialType(pe)}),$.push(Promise.all(this._invokeAll(function(ve){return ve.extendMaterialParams&&ve.extendMaterialParams(pe,J)})))}ce.doubleSided===!0&&(J.side=THREE.DoubleSide);const me=ce.alphaMode||Ce.OPAQUE;if(me===Ce.BLEND?(J.transparent=!0,J.depthWrite=!1):(J.transparent=!1,J.alphaWrite=!1,me===Ce.MASK&&(J.alphaTest=ce.alphaCutoff!==void 0?ce.alphaCutoff:.5)),ce.normalTexture!==void 0&&ae!==THREE.MeshBasicMaterial&&($.push(ge.assignTexture(J,"normalMap",ce.normalTexture)),J.normalScale=new THREE.Vector2(1,1),ce.normalTexture.scale!==void 0)){const Pe=ce.normalTexture.scale;J.normalScale.set(Pe,Pe)}return ce.occlusionTexture!==void 0&&ae!==THREE.MeshBasicMaterial&&($.push(ge.assignTexture(J,"aoMap",ce.occlusionTexture)),ce.occlusionTexture.strength!==void 0&&(J.aoMapIntensity=ce.occlusionTexture.strength)),ce.emissiveFactor!==void 0&&ae!==THREE.MeshBasicMaterial&&(J.emissive=new THREE.Color().fromArray(ce.emissiveFactor)),ce.emissiveTexture!==void 0&&ae!==THREE.MeshBasicMaterial&&$.push(ge.assignTexture(J,"emissiveMap",ce.emissiveTexture)),Promise.all($).then(function(){let Pe;return ae===H?Pe=Re[h.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(J):Pe=new ae(J),ce.name&&(Pe.name=ce.name),Pe.map&&(Pe.map.encoding=THREE.sRGBEncoding),Pe.emissiveMap&&(Pe.emissiveMap.encoding=THREE.sRGBEncoding),Ne(Pe,ce),ge.associations.set(Pe,{materials:pe}),ce.extensions&&Oe(Re,Pe,ce),Pe})}createUniqueName(pe){const ge=THREE.PropertyBinding.sanitizeNodeName(pe||"");let Fe=ge;for(let Re=1;this.nodeNamesUsed[Fe];++Re)Fe=ge+"_"+Re;return this.nodeNamesUsed[Fe]=!0,Fe}loadGeometries(pe){const ge=this,Fe=this.extensions,Re=this.primitiveCache;function ce(J){return Fe[h.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(J,ge).then(function(G){return Ue(G,J,ge)})}const ae=[];for(let J=0,G=pe.length;J<G;J++){const $=pe[J],me=St($),Pe=Re[me];if(Pe)ae.push(Pe.promise);else{let ve;$.extensions&&$.extensions[h.KHR_DRACO_MESH_COMPRESSION]?ve=ce($):ve=Ue(new THREE.BufferGeometry,$,ge),Re[me]={primitive:$,promise:ve},ae.push(ve)}}return Promise.all(ae)}loadMesh(pe){const ge=this,Fe=this.json,Re=this.extensions,ce=Fe.meshes[pe],ae=ce.primitives,J=[];for(let G=0,$=ae.length;G<$;G++){const me=ae[G].material===void 0?ke(this.cache):this.getDependency("material",ae[G].material);J.push(me)}return J.push(ge.loadGeometries(ae)),Promise.all(J).then(function(G){const $=G.slice(0,G.length-1),me=G[G.length-1],Pe=[];for(let Le=0,wt=me.length;Le<wt;Le++){const Ot=me[Le],_t=ae[Le];let Ut;const It=$[Le];if(_t.mode===k.TRIANGLES||_t.mode===k.TRIANGLE_STRIP||_t.mode===k.TRIANGLE_FAN||_t.mode===void 0)Ut=ce.isSkinnedMesh===!0?new THREE.SkinnedMesh(Ot,It):new THREE.Mesh(Ot,It),Ut.isSkinnedMesh===!0&&!Ut.geometry.attributes.skinWeight.normalized&&Ut.normalizeSkinWeights(),_t.mode===k.TRIANGLE_STRIP?Ut.geometry=At(Ut.geometry,THREE.TriangleStripDrawMode):_t.mode===k.TRIANGLE_FAN&&(Ut.geometry=At(Ut.geometry,THREE.TriangleFanDrawMode));else if(_t.mode===k.LINES)Ut=new THREE.LineSegments(Ot,It);else if(_t.mode===k.LINE_STRIP)Ut=new THREE.Line(Ot,It);else if(_t.mode===k.LINE_LOOP)Ut=new THREE.LineLoop(Ot,It);else if(_t.mode===k.POINTS)Ut=new THREE.Points(Ot,It);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+_t.mode);Object.keys(Ut.geometry.morphAttributes).length>0&&Qe(Ut,ce),Ut.name=ge.createUniqueName(ce.name||"mesh_"+pe),Ne(Ut,ce),_t.extensions&&Oe(Re,Ut,_t),ge.assignFinalMaterial(Ut),Pe.push(Ut)}for(let Le=0,wt=Pe.length;Le<wt;Le++)ge.associations.set(Pe[Le],{meshes:pe,primitives:Le});if(Pe.length===1)return Pe[0];const ve=new THREE.Group;ge.associations.set(ve,{meshes:pe});for(let Le=0,wt=Pe.length;Le<wt;Le++)ve.add(Pe[Le]);return ve})}loadCamera(pe){let ge;const Fe=this.json.cameras[pe],Re=Fe[Fe.type];if(!Re){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Fe.type==="perspective"?ge=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(Re.yfov),Re.aspectRatio||1,Re.znear||1,Re.zfar||2e6):Fe.type==="orthographic"&&(ge=new THREE.OrthographicCamera(-Re.xmag,Re.xmag,Re.ymag,-Re.ymag,Re.znear,Re.zfar)),Fe.name&&(ge.name=this.createUniqueName(Fe.name)),Ne(ge,Fe),Promise.resolve(ge)}loadSkin(pe){const ge=this.json.skins[pe],Fe={joints:ge.joints};return ge.inverseBindMatrices===void 0?Promise.resolve(Fe):this.getDependency("accessor",ge.inverseBindMatrices).then(function(Re){return Fe.inverseBindMatrices=Re,Fe})}loadAnimation(pe){const Fe=this.json.animations[pe],Re=[],ce=[],ae=[],J=[],G=[];for(let $=0,me=Fe.channels.length;$<me;$++){const Pe=Fe.channels[$],ve=Fe.samplers[Pe.sampler],Le=Pe.target,wt=Le.node!==void 0?Le.node:Le.id,Ot=Fe.parameters!==void 0?Fe.parameters[ve.input]:ve.input,_t=Fe.parameters!==void 0?Fe.parameters[ve.output]:ve.output;Re.push(this.getDependency("node",wt)),ce.push(this.getDependency("accessor",Ot)),ae.push(this.getDependency("accessor",_t)),J.push(ve),G.push(Le)}return Promise.all([Promise.all(Re),Promise.all(ce),Promise.all(ae),Promise.all(J),Promise.all(G)]).then(function($){const me=$[0],Pe=$[1],ve=$[2],Le=$[3],wt=$[4],Ot=[];for(let Ut=0,It=me.length;Ut<It;Ut++){const dn=me[Ut],Un=Pe[Ut],$n=ve[Ut],Je=Le[Ut],Ve=wt[Ut];if(dn===void 0)continue;dn.updateMatrix(),dn.matrixAutoUpdate=!0;let nt;switch(ue[Ve.path]){case ue.weights:nt=THREE.NumberKeyframeTrack;break;case ue.rotation:nt=THREE.QuaternionKeyframeTrack;break;case ue.position:case ue.scale:default:nt=THREE.VectorKeyframeTrack;break}const yt=dn.name?dn.name:dn.uuid,Wt=Je.interpolation!==void 0?ye[Je.interpolation]:THREE.InterpolateLinear,pn=[];ue[Ve.path]===ue.weights?dn.traverse(function(mn){mn.morphTargetInfluences&&pn.push(mn.name?mn.name:mn.uuid)}):pn.push(yt);let An=$n.array;if($n.normalized){const mn=Jt(An.constructor),Yn=new Float32Array(An.length);for(let Bn=0,mi=An.length;Bn<mi;Bn++)Yn[Bn]=An[Bn]*mn;An=Yn}for(let mn=0,Yn=pn.length;mn<Yn;mn++){const Bn=new nt(pn[mn]+"."+ue[Ve.path],Un.array,An,Wt);Je.interpolation==="CUBICSPLINE"&&(Bn.createInterpolant=function(Ii){const Si=this instanceof THREE.QuaternionKeyframeTrack?O:ne;return new Si(this.times,this.values,this.getValueSize()/3,Ii)},Bn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Ot.push(Bn)}}const _t=Fe.name?Fe.name:"animation_"+pe;return new THREE.AnimationClip(_t,void 0,Ot)})}createNodeMesh(pe){const ge=this.json,Fe=this,Re=ge.nodes[pe];return Re.mesh===void 0?null:Fe.getDependency("mesh",Re.mesh).then(function(ce){const ae=Fe._getNodeRef(Fe.meshCache,Re.mesh,ce);return Re.weights!==void 0&&ae.traverse(function(J){if(!!J.isMesh)for(let G=0,$=Re.weights.length;G<$;G++)J.morphTargetInfluences[G]=Re.weights[G]}),ae})}loadNode(pe){const ge=this.json,Fe=this.extensions,Re=this,ce=ge.nodes[pe],ae=ce.name?Re.createUniqueName(ce.name):"";return function(){const J=[],G=Re._invokeOne(function($){return $.createNodeMesh&&$.createNodeMesh(pe)});return G&&J.push(G),ce.camera!==void 0&&J.push(Re.getDependency("camera",ce.camera).then(function($){return Re._getNodeRef(Re.cameraCache,ce.camera,$)})),Re._invokeAll(function($){return $.createNodeAttachment&&$.createNodeAttachment(pe)}).forEach(function($){J.push($)}),Promise.all(J)}().then(function(J){let G;if(ce.isBone===!0?G=new THREE.Bone:J.length>1?G=new THREE.Group:J.length===1?G=J[0]:G=new THREE.Object3D,G!==J[0])for(let $=0,me=J.length;$<me;$++)G.add(J[$]);if(ce.name&&(G.userData.name=ce.name,G.name=ae),Ne(G,ce),ce.extensions&&Oe(Fe,G,ce),ce.matrix!==void 0){const $=new THREE.Matrix4;$.fromArray(ce.matrix),G.applyMatrix4($)}else ce.translation!==void 0&&G.position.fromArray(ce.translation),ce.rotation!==void 0&&G.quaternion.fromArray(ce.rotation),ce.scale!==void 0&&G.scale.fromArray(ce.scale);return Re.associations.has(G)||Re.associations.set(G,{}),Re.associations.get(G).nodes=pe,G})}loadScene(pe){const ge=this.json,Fe=this.extensions,Re=this.json.scenes[pe],ce=this,ae=new THREE.Group;Re.name&&(ae.name=ce.createUniqueName(Re.name)),Ne(ae,Re),Re.extensions&&Oe(Fe,ae,Re);const J=Re.nodes||[],G=[];for(let $=0,me=J.length;$<me;$++)G.push(Se(J[$],ae,ge,ce));return Promise.all(G).then(function(){const $=me=>{const Pe=new Map;for(const[ve,Le]of ce.associations)(ve instanceof THREE.Material||ve instanceof THREE.Texture)&&Pe.set(ve,Le);return me.traverse(ve=>{const Le=ce.associations.get(ve);Le!=null&&Pe.set(ve,Le)}),Pe};return ce.associations=$(ae),ae})}}function Se(tt,pe,ge,Fe){const Re=ge.nodes[tt];return Fe.getDependency("node",tt).then(function(ce){if(Re.skin===void 0)return ce;let ae;return Fe.getDependency("skin",Re.skin).then(function(J){ae=J;const G=[];for(let $=0,me=ae.joints.length;$<me;$++)G.push(Fe.getDependency("node",ae.joints[$]));return Promise.all(G)}).then(function(J){return ce.traverse(function(G){if(!G.isMesh)return;const $=[],me=[];for(let Pe=0,ve=J.length;Pe<ve;Pe++){const Le=J[Pe];if(Le){$.push(Le);const wt=new THREE.Matrix4;ae.inverseBindMatrices!==void 0&&wt.fromArray(ae.inverseBindMatrices.array,Pe*16),me.push(wt)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',ae.joints[Pe])}G.bind(new THREE.Skeleton($,me),G.matrixWorld)}),ce})}).then(function(ce){pe.add(ce);const ae=[];if(Re.children){const J=Re.children;for(let G=0,$=J.length;G<$;G++){const me=J[G];ae.push(Se(me,ce,ge,Fe))}}return Promise.all(ae)})}function qe(tt,pe,ge){const Fe=pe.attributes,Re=new THREE.Box3;if(Fe.POSITION!==void 0){const J=ge.json.accessors[Fe.POSITION],G=J.min,$=J.max;if(G!==void 0&&$!==void 0){if(Re.set(new THREE.Vector3(G[0],G[1],G[2]),new THREE.Vector3($[0],$[1],$[2])),J.normalized){const me=Jt(z[J.componentType]);Re.min.multiplyScalar(me),Re.max.multiplyScalar(me)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const ce=pe.targets;if(ce!==void 0){const J=new THREE.Vector3,G=new THREE.Vector3;for(let $=0,me=ce.length;$<me;$++){const Pe=ce[$];if(Pe.POSITION!==void 0){const ve=ge.json.accessors[Pe.POSITION],Le=ve.min,wt=ve.max;if(Le!==void 0&&wt!==void 0){if(G.setX(Math.max(Math.abs(Le[0]),Math.abs(wt[0]))),G.setY(Math.max(Math.abs(Le[1]),Math.abs(wt[1]))),G.setZ(Math.max(Math.abs(Le[2]),Math.abs(wt[2]))),ve.normalized){const Ot=Jt(z[ve.componentType]);G.multiplyScalar(Ot)}J.max(G)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Re.expandByVector(J)}tt.boundingBox=Re;const ae=new THREE.Sphere;Re.getCenter(ae.center),ae.radius=Re.min.distanceTo(Re.max)/2,tt.boundingSphere=ae}function Ue(tt,pe,ge){const Fe=pe.attributes,Re=[];function ce(ae,J){return ge.getDependency("accessor",ae).then(function(G){tt.setAttribute(J,G)})}for(const ae in Fe){const J=se[ae]||ae.toLowerCase();J in tt.attributes||Re.push(ce(Fe[ae],J))}if(pe.indices!==void 0&&!tt.index){const ae=ge.getDependency("accessor",pe.indices).then(function(J){tt.setIndex(J)});Re.push(ae)}return Ne(tt,pe),qe(tt,pe,ge),Promise.all(Re).then(function(){return pe.targets!==void 0?He(tt,pe.targets,ge):tt})}function At(tt,pe){let ge=tt.getIndex();if(ge===null){const ae=[],J=tt.getAttribute("position");if(J!==void 0){for(let G=0;G<J.count;G++)ae.push(G);tt.setIndex(ae),ge=tt.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),tt}const Fe=ge.count-2,Re=[];if(pe===THREE.TriangleFanDrawMode)for(let ae=1;ae<=Fe;ae++)Re.push(ge.getX(0)),Re.push(ge.getX(ae)),Re.push(ge.getX(ae+1));else for(let ae=0;ae<Fe;ae++)ae%2===0?(Re.push(ge.getX(ae)),Re.push(ge.getX(ae+1)),Re.push(ge.getX(ae+2))):(Re.push(ge.getX(ae+2)),Re.push(ge.getX(ae+1)),Re.push(ge.getX(ae)));Re.length/3!==Fe&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const ce=tt.clone();return ce.setIndex(Re),ce}THREE.GLTFLoader=a})()},{}],61:[function(i,o,l){(function(){class a extends THREE.Loader{constructor(f){super(f)}load(f,d,m,g){const x=this,v=this.path===""?THREE.LoaderUtils.extractUrlBase(f):this.path,A=new THREE.FileLoader(this.manager);A.setPath(this.path),A.setRequestHeader(this.requestHeader),A.setWithCredentials(this.withCredentials),A.load(f,function(_){try{d(x.parse(_,v))}catch(E){g?g(E):console.error(E),x.manager.itemError(f)}},m,g)}setMaterialOptions(f){return this.materialOptions=f,this}parse(f,d){const m=f.split(`
`);let g={};const x=/\s+/,v={};for(let _=0;_<m.length;_++){let E=m[_];if(E=E.trim(),E.length===0||E.charAt(0)==="#")continue;const w=E.indexOf(" ");let S=w>=0?E.substring(0,w):E;S=S.toLowerCase();let T=w>=0?E.substring(w+1):"";if(T=T.trim(),S==="newmtl")g={name:T},v[T]=g;else if(S==="ka"||S==="kd"||S==="ks"||S==="ke"){const R=T.split(x,3);g[S]=[parseFloat(R[0]),parseFloat(R[1]),parseFloat(R[2])]}else g[S]=T}const A=new u(this.resourcePath||d,this.materialOptions);return A.setCrossOrigin(this.crossOrigin),A.setManager(this.manager),A.setMaterials(v),A}}class u{constructor(f="",d={}){this.baseUrl=f,this.options=d,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:THREE.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:THREE.RepeatWrapping}setCrossOrigin(f){return this.crossOrigin=f,this}setManager(f){this.manager=f}setMaterials(f){this.materialsInfo=this.convert(f),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(f){if(!this.options)return f;const d={};for(const m in f){const g=f[m],x={};d[m]=x;for(const v in g){let A=!0,_=g[v];const E=v.toLowerCase();switch(E){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(_=[_[0]/255,_[1]/255,_[2]/255]),this.options&&this.options.ignoreZeroRGBs&&_[0]===0&&_[1]===0&&_[2]===0&&(A=!1);break}A&&(x[E]=_)}}return d}preload(){for(const f in this.materialsInfo)this.create(f)}getIndex(f){return this.nameLookup[f]}getAsArray(){let f=0;for(const d in this.materialsInfo)this.materialsArray[f]=this.create(d),this.nameLookup[d]=f,f++;return this.materialsArray}create(f){return this.materials[f]===void 0&&this.createMaterial_(f),this.materials[f]}createMaterial_(f){const d=this,m=this.materialsInfo[f],g={name:f,side:this.side};function x(A,_){return typeof _!="string"||_===""?"":/^https?:\/\//i.test(_)?_:A+_}function v(A,_){if(g[A])return;const E=d.getTextureParams(_,g),w=d.loadTexture(x(d.baseUrl,E.url));w.repeat.copy(E.scale),w.offset.copy(E.offset),w.wrapS=d.wrap,w.wrapT=d.wrap,(A==="map"||A==="emissiveMap")&&(w.encoding=THREE.sRGBEncoding),g[A]=w}for(const A in m){const _=m[A];let E;if(_!=="")switch(A.toLowerCase()){case"kd":g.color=new THREE.Color().fromArray(_).convertSRGBToLinear();break;case"ks":g.specular=new THREE.Color().fromArray(_).convertSRGBToLinear();break;case"ke":g.emissive=new THREE.Color().fromArray(_).convertSRGBToLinear();break;case"map_kd":v("map",_);break;case"map_ks":v("specularMap",_);break;case"map_ke":v("emissiveMap",_);break;case"norm":v("normalMap",_);break;case"map_bump":case"bump":v("bumpMap",_);break;case"map_d":v("alphaMap",_),g.transparent=!0;break;case"ns":g.shininess=parseFloat(_);break;case"d":E=parseFloat(_),E<1&&(g.opacity=E,g.transparent=!0);break;case"tr":E=parseFloat(_),this.options&&this.options.invertTrProperty&&(E=1-E),E>0&&(g.opacity=1-E,g.transparent=!0);break}}return this.materials[f]=new THREE.MeshPhongMaterial(g),this.materials[f]}getTextureParams(f,d){const m={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},g=f.split(/\s+/);let x;return x=g.indexOf("-bm"),x>=0&&(d.bumpScale=parseFloat(g[x+1]),g.splice(x,2)),x=g.indexOf("-s"),x>=0&&(m.scale.set(parseFloat(g[x+1]),parseFloat(g[x+2])),g.splice(x,4)),x=g.indexOf("-o"),x>=0&&(m.offset.set(parseFloat(g[x+1]),parseFloat(g[x+2])),g.splice(x,4)),m.url=g.join(" ").trim(),m}loadTexture(f,d,m,g,x){const v=this.manager!==void 0?this.manager:THREE.DefaultLoadingManager;let A=v.getHandler(f);A===null&&(A=new THREE.TextureLoader(v)),A.setCrossOrigin&&A.setCrossOrigin(this.crossOrigin);const _=A.load(f,m,g,x);return d!==void 0&&(_.mapping=d),_}}THREE.MTLLoader=a})()},{}],62:[function(i,o,l){(function(){const a=/^[og]\s*(.+)?/,u=/^mtllib /,h=/^usemtl /,f=/^usemap /,d=new THREE.Vector3,m=new THREE.Vector3,g=new THREE.Vector3,x=new THREE.Vector3,v=new THREE.Vector3;function A(){const E={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(w,S){if(this.object&&this.object.fromDeclaration===!1){this.object.name=w,this.object.fromDeclaration=S!==!1;return}const T=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:w||"",fromDeclaration:S!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(R,L){const I=this._finalize(!1);I&&(I.inherited||I.groupCount<=0)&&this.materials.splice(I.index,1);const N={index:this.materials.length,name:R||"",mtllib:Array.isArray(L)&&L.length>0?L[L.length-1]:"",smooth:I!==void 0?I.smooth:this.smooth,groupStart:I!==void 0?I.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(B){const H={index:typeof B=="number"?B:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return H.clone=this.clone.bind(H),H}};return this.materials.push(N),N},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(R){const L=this.currentMaterial();if(L&&L.groupEnd===-1&&(L.groupEnd=this.geometry.vertices.length/3,L.groupCount=L.groupEnd-L.groupStart,L.inherited=!1),R&&this.materials.length>1)for(let I=this.materials.length-1;I>=0;I--)this.materials[I].groupCount<=0&&this.materials.splice(I,1);return R&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),L}},T&&T.name&&typeof T.clone=="function"){const R=T.clone(0);R.inherited=!0,this.object.materials.push(R)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(w,S){const T=parseInt(w,10);return(T>=0?T-1:T+S/3)*3},parseNormalIndex:function(w,S){const T=parseInt(w,10);return(T>=0?T-1:T+S/3)*3},parseUVIndex:function(w,S){const T=parseInt(w,10);return(T>=0?T-1:T+S/2)*2},addVertex:function(w,S,T){const R=this.vertices,L=this.object.geometry.vertices;L.push(R[w+0],R[w+1],R[w+2]),L.push(R[S+0],R[S+1],R[S+2]),L.push(R[T+0],R[T+1],R[T+2])},addVertexPoint:function(w){const S=this.vertices;this.object.geometry.vertices.push(S[w+0],S[w+1],S[w+2])},addVertexLine:function(w){const S=this.vertices;this.object.geometry.vertices.push(S[w+0],S[w+1],S[w+2])},addNormal:function(w,S,T){const R=this.normals,L=this.object.geometry.normals;L.push(R[w+0],R[w+1],R[w+2]),L.push(R[S+0],R[S+1],R[S+2]),L.push(R[T+0],R[T+1],R[T+2])},addFaceNormal:function(w,S,T){const R=this.vertices,L=this.object.geometry.normals;d.fromArray(R,w),m.fromArray(R,S),g.fromArray(R,T),v.subVectors(g,m),x.subVectors(d,m),v.cross(x),v.normalize(),L.push(v.x,v.y,v.z),L.push(v.x,v.y,v.z),L.push(v.x,v.y,v.z)},addColor:function(w,S,T){const R=this.colors,L=this.object.geometry.colors;R[w]!==void 0&&L.push(R[w+0],R[w+1],R[w+2]),R[S]!==void 0&&L.push(R[S+0],R[S+1],R[S+2]),R[T]!==void 0&&L.push(R[T+0],R[T+1],R[T+2])},addUV:function(w,S,T){const R=this.uvs,L=this.object.geometry.uvs;L.push(R[w+0],R[w+1]),L.push(R[S+0],R[S+1]),L.push(R[T+0],R[T+1])},addDefaultUV:function(){const w=this.object.geometry.uvs;w.push(0,0),w.push(0,0),w.push(0,0)},addUVLine:function(w){const S=this.uvs;this.object.geometry.uvs.push(S[w+0],S[w+1])},addFace:function(w,S,T,R,L,I,N,B,H){const q=this.vertices.length;let le=this.parseVertexIndex(w,q),ne=this.parseVertexIndex(S,q),D=this.parseVertexIndex(T,q);if(this.addVertex(le,ne,D),this.addColor(le,ne,D),N!==void 0&&N!==""){const O=this.normals.length;le=this.parseNormalIndex(N,O),ne=this.parseNormalIndex(B,O),D=this.parseNormalIndex(H,O),this.addNormal(le,ne,D)}else this.addFaceNormal(le,ne,D);if(R!==void 0&&R!==""){const O=this.uvs.length;le=this.parseUVIndex(R,O),ne=this.parseUVIndex(L,O),D=this.parseUVIndex(I,O),this.addUV(le,ne,D),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(w){this.object.geometry.type="Points";const S=this.vertices.length;for(let T=0,R=w.length;T<R;T++){const L=this.parseVertexIndex(w[T],S);this.addVertexPoint(L),this.addColor(L)}},addLineGeometry:function(w,S){this.object.geometry.type="Line";const T=this.vertices.length,R=this.uvs.length;for(let L=0,I=w.length;L<I;L++)this.addVertexLine(this.parseVertexIndex(w[L],T));for(let L=0,I=S.length;L<I;L++)this.addUVLine(this.parseUVIndex(S[L],R))}};return E.startObject("",!1),E}class _ extends THREE.Loader{constructor(w){super(w),this.materials=null}load(w,S,T,R){const L=this,I=new THREE.FileLoader(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.setWithCredentials(this.withCredentials),I.load(w,function(N){try{S(L.parse(N))}catch(B){R?R(B):console.error(B),L.manager.itemError(w)}},T,R)}setMaterials(w){return this.materials=w,this}parse(w){const S=new A;w.indexOf(`\r
`)!==-1&&(w=w.replace(/\r\n/g,`
`)),w.indexOf(`\\
`)!==-1&&(w=w.replace(/\\\n/g,""));const T=w.split(`
`);let R="",L="",I=0,N=[];const B=typeof"".trimLeft=="function";for(let le=0,ne=T.length;le<ne;le++)if(R=T[le],R=B?R.trimLeft():R.trim(),I=R.length,I!==0&&(L=R.charAt(0),L!=="#"))if(L==="v"){const D=R.split(/\s+/);switch(D[0]){case"v":S.vertices.push(parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3])),D.length>=7?S.colors.push(parseFloat(D[4]),parseFloat(D[5]),parseFloat(D[6])):S.colors.push(void 0,void 0,void 0);break;case"vn":S.normals.push(parseFloat(D[1]),parseFloat(D[2]),parseFloat(D[3]));break;case"vt":S.uvs.push(parseFloat(D[1]),parseFloat(D[2]));break}}else if(L==="f"){const O=R.substr(1).trim().split(/\s+/),k=[];for(let X=0,Z=O.length;X<Z;X++){const ie=O[X];if(ie.length>0){const se=ie.split("/");k.push(se)}}const z=k[0];for(let X=1,Z=k.length-1;X<Z;X++){const ie=k[X],se=k[X+1];S.addFace(z[0],ie[0],se[0],z[1],ie[1],se[1],z[2],ie[2],se[2])}}else if(L==="l"){const D=R.substring(1).trim().split(" ");let O=[];const k=[];if(R.indexOf("/")===-1)O=D;else for(let z=0,X=D.length;z<X;z++){const Z=D[z].split("/");Z[0]!==""&&O.push(Z[0]),Z[1]!==""&&k.push(Z[1])}S.addLineGeometry(O,k)}else if(L==="p"){const O=R.substr(1).trim().split(" ");S.addPointGeometry(O)}else if((N=a.exec(R))!==null){const D=(" "+N[0].substr(1).trim()).substr(1);S.startObject(D)}else if(h.test(R))S.object.startMaterial(R.substring(7).trim(),S.materialLibraries);else if(u.test(R))S.materialLibraries.push(R.substring(7).trim());else if(f.test(R))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(L==="s"){if(N=R.split(" "),N.length>1){const O=N[1].trim().toLowerCase();S.object.smooth=O!=="0"&&O!=="off"}else S.object.smooth=!0;const D=S.object.currentMaterial();D&&(D.smooth=S.object.smooth)}else{if(R==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+R+'"')}S.finalize();const H=new THREE.Group;if(H.materialLibraries=[].concat(S.materialLibraries),!(S.objects.length===1&&S.objects[0].geometry.vertices.length===0)===!0)for(let le=0,ne=S.objects.length;le<ne;le++){const D=S.objects[le],O=D.geometry,k=D.materials,z=O.type==="Line",X=O.type==="Points";let Z=!1;if(O.vertices.length===0)continue;const ie=new THREE.BufferGeometry;ie.setAttribute("position",new THREE.Float32BufferAttribute(O.vertices,3)),O.normals.length>0&&ie.setAttribute("normal",new THREE.Float32BufferAttribute(O.normals,3)),O.colors.length>0&&(Z=!0,ie.setAttribute("color",new THREE.Float32BufferAttribute(O.colors,3))),O.hasUVIndices===!0&&ie.setAttribute("uv",new THREE.Float32BufferAttribute(O.uvs,2));const se=[];for(let ye=0,Ce=k.length;ye<Ce;ye++){const ke=k[ye],Oe=ke.name+"_"+ke.smooth+"_"+Z;let Ne=S.materials[Oe];if(this.materials!==null){if(Ne=this.materials.create(ke.name),z&&Ne&&!(Ne instanceof THREE.LineBasicMaterial)){const He=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(He,Ne),He.color.copy(Ne.color),Ne=He}else if(X&&Ne&&!(Ne instanceof THREE.PointsMaterial)){const He=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(He,Ne),He.color.copy(Ne.color),He.map=Ne.map,Ne=He}}Ne===void 0&&(z?Ne=new THREE.LineBasicMaterial:X?Ne=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):Ne=new THREE.MeshPhongMaterial,Ne.name=ke.name,Ne.flatShading=!ke.smooth,Ne.vertexColors=Z,S.materials[Oe]=Ne),se.push(Ne)}let ue;if(se.length>1){for(let ye=0,Ce=k.length;ye<Ce;ye++){const ke=k[ye];ie.addGroup(ke.groupStart,ke.groupCount,ye)}z?ue=new THREE.LineSegments(ie,se):X?ue=new THREE.Points(ie,se):ue=new THREE.Mesh(ie,se)}else z?ue=new THREE.LineSegments(ie,se[0]):X?ue=new THREE.Points(ie,se[0]):ue=new THREE.Mesh(ie,se[0]);ue.name=D.name,H.add(ue)}else if(S.vertices.length>0){const le=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),ne=new THREE.BufferGeometry;ne.setAttribute("position",new THREE.Float32BufferAttribute(S.vertices,3)),S.colors.length>0&&S.colors[0]!==void 0&&(ne.setAttribute("color",new THREE.Float32BufferAttribute(S.colors,3)),le.vertexColors=!0);const D=new THREE.Points(ne,le);H.add(D)}return H}}THREE.OBJLoader=_})()},{}],63:[function(i,o,l){(function(){function a(v){v.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use THREE.BufferGeometry.computeTangents() instead.")}function u(v,A=!1){const _=v[0].index!==null,E=new Set(Object.keys(v[0].attributes)),w=new Set(Object.keys(v[0].morphAttributes)),S={},T={},R=v[0].morphTargetsRelative,L=new THREE.BufferGeometry;let I=0;for(let N=0;N<v.length;++N){const B=v[N];let H=0;if(_!==(B.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+N+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const q in B.attributes){if(!E.has(q))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+N+'. All geometries must have compatible attributes; make sure "'+q+'" attribute exists among all geometries, or in none of them.'),null;S[q]===void 0&&(S[q]=[]),S[q].push(B.attributes[q]),H++}if(H!==E.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+N+". Make sure all geometries have the same number of attributes."),null;if(R!==B.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+N+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const q in B.morphAttributes){if(!w.has(q))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+N+".  .morphAttributes must be consistent throughout all geometries."),null;T[q]===void 0&&(T[q]=[]),T[q].push(B.morphAttributes[q])}if(L.userData.mergedUserData=L.userData.mergedUserData||[],L.userData.mergedUserData.push(B.userData),A){let q;if(_)q=B.index.count;else if(B.attributes.position!==void 0)q=B.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+N+". The geometry must have either an index or a position attribute"),null;L.addGroup(I,q,N),I+=q}}if(_){let N=0;const B=[];for(let H=0;H<v.length;++H){const q=v[H].index;for(let le=0;le<q.count;++le)B.push(q.getX(le)+N);N+=v[H].attributes.position.count}L.setIndex(B)}for(const N in S){const B=h(S[N]);if(!B)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+N+" attribute."),null;L.setAttribute(N,B)}for(const N in T){const B=T[N][0].length;if(B===0)break;L.morphAttributes=L.morphAttributes||{},L.morphAttributes[N]=[];for(let H=0;H<B;++H){const q=[];for(let ne=0;ne<T[N].length;++ne)q.push(T[N][ne][H]);const le=h(q);if(!le)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+N+" morphAttribute."),null;L.morphAttributes[N].push(le)}}return L}function h(v){let A,_,E,w=0;for(let R=0;R<v.length;++R){const L=v[R];if(L.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(A===void 0&&(A=L.array.constructor),A!==L.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. THREE.BufferAttribute.array must be of consistent array types across matching attributes."),null;if(_===void 0&&(_=L.itemSize),_!==L.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. THREE.BufferAttribute.itemSize must be consistent across matching attributes."),null;if(E===void 0&&(E=L.normalized),E!==L.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. THREE.BufferAttribute.normalized must be consistent across matching attributes."),null;w+=L.array.length}const S=new A(w);let T=0;for(let R=0;R<v.length;++R)S.set(v[R].array,T),T+=v[R].array.length;return new THREE.BufferAttribute(S,_,E)}function f(v){let A,_=0,E=0;for(let I=0,N=v.length;I<N;++I){const B=v[I];if(A===void 0&&(A=B.array.constructor),A!==B.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;_+=B.array.length,E+=B.itemSize}const w=new THREE.InterleavedBuffer(new A(_),E);let S=0;const T=[],R=["getX","getY","getZ","getW"],L=["setX","setY","setZ","setW"];for(let I=0,N=v.length;I<N;I++){const B=v[I],H=B.itemSize,q=B.count,le=new THREE.InterleavedBufferAttribute(w,H,S,B.normalized);T.push(le),S+=H;for(let ne=0;ne<q;ne++)for(let D=0;D<H;D++)le[L[D]](ne,B[R[D]](ne))}return T}function d(v){let A=0;for(const E in v.attributes){const w=v.getAttribute(E);A+=w.count*w.itemSize*w.array.BYTES_PER_ELEMENT}const _=v.getIndex();return A+=_?_.count*_.itemSize*_.array.BYTES_PER_ELEMENT:0,A}function m(v,A=1e-4){A=Math.max(A,Number.EPSILON);const _={},E=v.getIndex(),w=v.getAttribute("position"),S=E?E.count:w.count;let T=0;const R=Object.keys(v.attributes),L={},I={},N=[],B=["getX","getY","getZ","getW"];for(let ne=0,D=R.length;ne<D;ne++){const O=R[ne];L[O]=[];const k=v.morphAttributes[O];k&&(I[O]=new Array(k.length).fill().map(()=>[]))}const H=Math.log10(1/A),q=Math.pow(10,H);for(let ne=0;ne<S;ne++){const D=E?E.getX(ne):ne;let O="";for(let k=0,z=R.length;k<z;k++){const X=R[k],Z=v.getAttribute(X),ie=Z.itemSize;for(let se=0;se<ie;se++)O+=`${~~(Z[B[se]](D)*q)},`}if(O in _)N.push(_[O]);else{for(let k=0,z=R.length;k<z;k++){const X=R[k],Z=v.getAttribute(X),ie=v.morphAttributes[X],se=Z.itemSize,ue=L[X],ye=I[X];for(let Ce=0;Ce<se;Ce++){const ke=B[Ce];if(ue.push(Z[ke](D)),ie)for(let Oe=0,Ne=ie.length;Oe<Ne;Oe++)ye[Oe].push(ie[Oe][ke](D))}}_[O]=T,N.push(T),T++}}const le=v.clone();for(let ne=0,D=R.length;ne<D;ne++){const O=R[ne],k=v.getAttribute(O),z=new k.array.constructor(L[O]),X=new THREE.BufferAttribute(z,k.itemSize,k.normalized);if(le.setAttribute(O,X),O in I)for(let Z=0;Z<I[O].length;Z++){const ie=v.morphAttributes[O][Z],se=new ie.array.constructor(I[O][Z]),ue=new THREE.BufferAttribute(se,ie.itemSize,ie.normalized);le.morphAttributes[O][Z]=ue}}return le.setIndex(N),le}function g(v,A){if(A===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),v;if(A===THREE.TriangleFanDrawMode||A===THREE.TriangleStripDrawMode){let _=v.getIndex();if(_===null){const T=[],R=v.getAttribute("position");if(R!==void 0){for(let L=0;L<R.count;L++)T.push(L);v.setIndex(T),_=v.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),v}const E=_.count-2,w=[];if(A===THREE.TriangleFanDrawMode)for(let T=1;T<=E;T++)w.push(_.getX(0)),w.push(_.getX(T)),w.push(_.getX(T+1));else for(let T=0;T<E;T++)T%2===0?(w.push(_.getX(T)),w.push(_.getX(T+1)),w.push(_.getX(T+2))):(w.push(_.getX(T+2)),w.push(_.getX(T+1)),w.push(_.getX(T)));w.length/3!==E&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const S=v.clone();return S.setIndex(w),S.clearGroups(),S}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",A),v}function x(v){if(v.geometry.isBufferGeometry!==!0)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;const A=new THREE.Vector3,_=new THREE.Vector3,E=new THREE.Vector3,w=new THREE.Vector3,S=new THREE.Vector3,T=new THREE.Vector3,R=new THREE.Vector3,L=new THREE.Vector3,I=new THREE.Vector3;function N(Se,qe,Ue,At,tt,pe,ge,Fe,Re){A.fromBufferAttribute(Ue,pe),_.fromBufferAttribute(Ue,ge),E.fromBufferAttribute(Ue,Fe);const ce=Se.morphTargetInfluences;if(qe.morphTargets&&At&&ce){R.set(0,0,0),L.set(0,0,0),I.set(0,0,0);for(let ae=0,J=At.length;ae<J;ae++){const G=ce[ae],$=At[ae];G!==0&&(w.fromBufferAttribute($,pe),S.fromBufferAttribute($,ge),T.fromBufferAttribute($,Fe),tt?(R.addScaledVector(w,G),L.addScaledVector(S,G),I.addScaledVector(T,G)):(R.addScaledVector(w.sub(A),G),L.addScaledVector(S.sub(_),G),I.addScaledVector(T.sub(E),G)))}A.add(R),_.add(L),E.add(I)}Se.isSkinnedMesh&&(Se.boneTransform(pe,A),Se.boneTransform(ge,_),Se.boneTransform(Fe,E)),Re[pe*3+0]=A.x,Re[pe*3+1]=A.y,Re[pe*3+2]=A.z,Re[ge*3+0]=_.x,Re[ge*3+1]=_.y,Re[ge*3+2]=_.z,Re[Fe*3+0]=E.x,Re[Fe*3+1]=E.y,Re[Fe*3+2]=E.z}const B=v.geometry,H=v.material;let q,le,ne;const D=B.index,O=B.attributes.position,k=B.morphAttributes.position,z=B.morphTargetsRelative,X=B.attributes.normal,Z=B.morphAttributes.position,ie=B.groups,se=B.drawRange;let ue,ye,Ce,ke,Oe,Ne,He,Qe;const St=new Float32Array(O.count*O.itemSize),bt=new Float32Array(X.count*X.itemSize);if(D!==null)if(Array.isArray(H))for(ue=0,Ce=ie.length;ue<Ce;ue++)for(Oe=ie[ue],Ne=H[Oe.materialIndex],He=Math.max(Oe.start,se.start),Qe=Math.min(Oe.start+Oe.count,se.start+se.count),ye=He,ke=Qe;ye<ke;ye+=3)q=D.getX(ye),le=D.getX(ye+1),ne=D.getX(ye+2),N(v,Ne,O,k,z,q,le,ne,St),N(v,Ne,X,Z,z,q,le,ne,bt);else for(He=Math.max(0,se.start),Qe=Math.min(D.count,se.start+se.count),ue=He,Ce=Qe;ue<Ce;ue+=3)q=D.getX(ue),le=D.getX(ue+1),ne=D.getX(ue+2),N(v,H,O,k,z,q,le,ne,St),N(v,H,X,Z,z,q,le,ne,bt);else if(O!==void 0)if(Array.isArray(H))for(ue=0,Ce=ie.length;ue<Ce;ue++)for(Oe=ie[ue],Ne=H[Oe.materialIndex],He=Math.max(Oe.start,se.start),Qe=Math.min(Oe.start+Oe.count,se.start+se.count),ye=He,ke=Qe;ye<ke;ye+=3)q=ye,le=ye+1,ne=ye+2,N(v,Ne,O,k,z,q,le,ne,St),N(v,Ne,X,Z,z,q,le,ne,bt);else for(He=Math.max(0,se.start),Qe=Math.min(O.count,se.start+se.count),ue=He,Ce=Qe;ue<Ce;ue+=3)q=ue,le=ue+1,ne=ue+2,N(v,H,O,k,z,q,le,ne,St),N(v,H,X,Z,z,q,le,ne,bt);const Jt=new THREE.Float32BufferAttribute(St,3),sn=new THREE.Float32BufferAttribute(bt,3);return{positionAttribute:O,normalAttribute:X,morphedPositionAttribute:Jt,morphedNormalAttribute:sn}}THREE.BufferGeometryUtils={},THREE.BufferGeometryUtils.computeMorphedAttributes=x,THREE.BufferGeometryUtils.computeTangents=a,THREE.BufferGeometryUtils.estimateBytesUsed=d,THREE.BufferGeometryUtils.interleaveAttributes=f,THREE.BufferGeometryUtils.mergeBufferAttributes=h,THREE.BufferGeometryUtils.mergeBufferGeometries=u,THREE.BufferGeometryUtils.mergeVertices=m,THREE.BufferGeometryUtils.toTrianglesDrawMode=g})()},{}],64:[function(i,o,l){var a=i("layout-bmfont-text");i("inherits");var u=i("quad-indices"),h=i("three-buffer-vertex-data"),f=i("object-assign"),d=i("./lib/vertices"),m=i("./lib/utils");o.exports=function(v){return new g(v)};class g extends THREE.BufferGeometry{constructor(v){super(),typeof v=="string"&&(v={text:v}),this._opt=f({},v),v&&this.update(v)}update(v){if(typeof v=="string"&&(v={text:v}),v=f({},this._opt,v),!v.font)throw new TypeError("must specify a { font } in options");this.layout=a(v);var A=v.flipY!==!1,_=v.font,E=_.common.scaleW,w=_.common.scaleH,S=this.layout.glyphs.filter(function(N){var B=N.data;return B.width*B.height>0});this.visibleGlyphs=S;var T=d.positions(S),R=d.uvs(S,E,w,A),L=u({clockwise:!0,type:"uint16",count:S.length});if(h.index(this,L,1,"uint16"),h.attr(this,"position",T,2),h.attr(this,"uv",R,2),!v.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(v.multipage){var I=d.pages(S);h.attr(this,"page",I,1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var v=this.attributes.position.array,A=this.attributes.position.itemSize;if(!v||!A||v.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}m.computeSphere(v,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var v=this.boundingBox,A=this.attributes.position.array,_=this.attributes.position.itemSize;if(!A||!_||A.length<2){v.makeEmpty();return}m.computeBox(A,v)}}},{"./lib/utils":65,"./lib/vertices":66,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":67}],65:[function(i,o,l){var a=2,u={min:[0,0],max:[0,0]};function h(f){var d=f.length/a;u.min[0]=f[0],u.min[1]=f[1],u.max[0]=f[0],u.max[1]=f[1];for(var m=0;m<d;m++){var g=f[m*a+0],x=f[m*a+1];u.min[0]=Math.min(g,u.min[0]),u.min[1]=Math.min(x,u.min[1]),u.max[0]=Math.max(g,u.max[0]),u.max[1]=Math.max(x,u.max[1])}}o.exports.computeBox=function(f,d){h(f),d.min.set(u.min[0],u.min[1],0),d.max.set(u.max[0],u.max[1],0)},o.exports.computeSphere=function(f,d){h(f);var m=u.min[0],g=u.min[1],x=u.max[0],v=u.max[1],A=x-m,_=v-g,E=Math.sqrt(A*A+_*_);d.center.set(m+A/2,g+_/2,0),d.radius=E/2}},{}],66:[function(i,o,l){o.exports.pages=function(u){var h=new Float32Array(u.length*4*1),f=0;return u.forEach(function(d){var m=d.data.page||0;h[f++]=m,h[f++]=m,h[f++]=m,h[f++]=m}),h},o.exports.uvs=function(u,h,f,d){var m=new Float32Array(u.length*4*2),g=0;return u.forEach(function(x){var v=x.data,A=v.x+v.width,_=v.y+v.height,E=v.x/h,w=v.y/f,S=A/h,T=_/f;d&&(w=(f-v.y)/f,T=(f-_)/f),m[g++]=E,m[g++]=w,m[g++]=E,m[g++]=T,m[g++]=S,m[g++]=T,m[g++]=S,m[g++]=w}),m},o.exports.positions=function(u){var h=new Float32Array(u.length*4*2),f=0;return u.forEach(function(d){var m=d.data,g=d.position[0]+m.xoffset,x=d.position[1]+m.yoffset,v=m.width,A=m.height;h[f++]=g,h[f++]=x,h[f++]=g,h[f++]=x+A,h[f++]=g+v,h[f++]=x+A,h[f++]=g+v,h[f++]=x}),h}},{}],67:[function(i,o,l){var a=i("flatten-vertex-data");o.exports.attr=h,o.exports.index=u;function u(d,m,g,x){typeof g!="number"&&(g=1),typeof x!="string"&&(x="uint16");var v=!d.index&&typeof d.setIndex!="function",A=v?d.getAttribute("index"):d.index,_=f(A,m,g,x);_&&(v?d.addAttribute("index",_):d.index=_)}function h(d,m,g,x,v){if(typeof x!="number"&&(x=3),typeof v!="string"&&(v="float32"),Array.isArray(g)&&Array.isArray(g[0])&&g[0].length!==x)throw new Error("Nested vertex array has unexpected size; expected "+x+" but found "+g[0].length);var A=d.getAttribute(m),_=f(A,g,x,v);d.setAttribute(m,_)}function f(d,m,g,x){return m=m||[],m=a(m,x),d=new THREE.BufferAttribute(m,g),d.itemSize=g,d.needsUpdate=!0,d}},{"flatten-vertex-data":23}],68:[function(i,o,l){(function(a,u){var h=i("process/browser.js").nextTick,f=Function.prototype.apply,d=Array.prototype.slice,m={},g=0;l.setTimeout=function(){return new x(f.call(setTimeout,window,arguments),clearTimeout)},l.setInterval=function(){return new x(f.call(setInterval,window,arguments),clearInterval)},l.clearTimeout=l.clearInterval=function(v){v.close()};function x(v,A){this._id=v,this._clearFn=A}x.prototype.unref=x.prototype.ref=function(){},x.prototype.close=function(){this._clearFn.call(window,this._id)},l.enroll=function(v,A){clearTimeout(v._idleTimeoutId),v._idleTimeout=A},l.unenroll=function(v){clearTimeout(v._idleTimeoutId),v._idleTimeout=-1},l._unrefActive=l.active=function(v){clearTimeout(v._idleTimeoutId);var A=v._idleTimeout;A>=0&&(v._idleTimeoutId=setTimeout(function(){v._onTimeout&&v._onTimeout()},A))},l.setImmediate=typeof a=="function"?a:function(v){var A=g++,_=arguments.length<2?!1:d.call(arguments,1);return m[A]=!0,h(function(){m[A]&&(_?v.apply(null,_):v.call(null),l.clearImmediate(A))}),A},l.clearImmediate=typeof u=="function"?u:function(v){delete m[v]}}).call(this,i("timers").setImmediate,i("timers").clearImmediate)},{"process/browser.js":49,timers:68}],69:[function(i,o,l){(function(a){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(u,h){typeof l=="object"&&typeof o<"u"?o.exports=h():u.WebVRPolyfill=h()})(this,function(){var u=typeof window<"u"?window:typeof a<"u"?a:typeof self<"u"?self:{};function h(R){return R&&R.__esModule&&Object.prototype.hasOwnProperty.call(R,"default")?R.default:R}function f(R,L){return L={exports:{}},R(L,L.exports),L.exports}var d=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},m=function(L,I){for(var N=0,B=L.length;N<B;N++)I[N]=L[N]},g=function(L,I){for(var N in I)I.hasOwnProperty(N)&&(L[N]=I[N]);return L},x=f(function(R,L){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(I,N){R.exports=N()})(u,function(){var I=function(K,te){if(!(K instanceof te))throw new TypeError("Cannot call a class as a function")},N=function(){function K(te,fe){for(var _e=0;_e<fe.length;_e++){var Be=fe[_e];Be.enumerable=Be.enumerable||!1,Be.configurable=!0,"value"in Be&&(Be.writable=!0),Object.defineProperty(te,Be.key,Be)}}return function(te,fe,_e){return fe&&K(te.prototype,fe),_e&&K(te,_e),te}}(),B=function(){function K(te,fe){var _e=[],Be=!0,Ze=!1,lt=void 0;try{for(var qt=te[Symbol.iterator](),xt;!(Be=(xt=qt.next()).done)&&(_e.push(xt.value),!(fe&&_e.length===fe));Be=!0);}catch(pt){Ze=!0,lt=pt}finally{try{!Be&&qt.return&&qt.return()}finally{if(Ze)throw lt}}return _e}return function(te,fe){if(Array.isArray(te))return te;if(Symbol.iterator in Object(te))return K(te,fe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),H=.001,q=1,le=function(te,fe){return"data:"+te+","+encodeURIComponent(fe)},ne=function(te,fe,_e){return te+(fe-te)*_e},D=function(){var K=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return K}}(),O=function(){var K=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return K}}(),k=function(){var K=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return K}}(),z=function(){var K=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return K}}(),X=function(){var K=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),te=K?parseInt(K[1],10):null;return function(){return te}}(),Z=function(){var K=!1;return K=D()&&k()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return K}}(),ie=function(){var K=!1;if(X()===65){var te=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(te){var fe=te[1].split("."),_e=B(fe,4);_e[0],_e[1];var Be=_e[2],Ze=_e[3];K=parseInt(Be,10)===3325&&parseInt(Ze,10)<148}}return function(){return K}}(),se=function(){var K=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return K}}(),ue=function(){var te=window.orientation==90||window.orientation==-90;return se()?!te:te},ye=function(te){return!(isNaN(te)||te<=H||te>q)},Ce=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},ke=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Oe=function(te){if(O())return!1;if(te.requestFullscreen)te.requestFullscreen();else if(te.webkitRequestFullscreen)te.webkitRequestFullscreen();else if(te.mozRequestFullScreen)te.mozRequestFullScreen();else if(te.msRequestFullscreen)te.msRequestFullscreen();else return!1;return!0},Ne=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},He=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Qe=function(te,fe,_e,Be){var Ze=te.createShader(te.VERTEX_SHADER);te.shaderSource(Ze,fe),te.compileShader(Ze);var lt=te.createShader(te.FRAGMENT_SHADER);te.shaderSource(lt,_e),te.compileShader(lt);var qt=te.createProgram();te.attachShader(qt,Ze),te.attachShader(qt,lt);for(var xt in Be)te.bindAttribLocation(qt,Be[xt],xt);return te.linkProgram(qt),te.deleteShader(Ze),te.deleteShader(lt),qt},St=function(te,fe){for(var _e={},Be=te.getProgramParameter(fe,te.ACTIVE_UNIFORMS),Ze="",lt=0;lt<Be;lt++){var qt=te.getActiveUniform(fe,lt);Ze=qt.name.replace("[0]",""),_e[Ze]=te.getUniformLocation(fe,Ze)}return _e},bt=function(te,fe,_e,Be,Ze,lt,qt){var xt=1/(fe-_e),pt=1/(Be-Ze),oe=1/(lt-qt);return te[0]=-2*xt,te[1]=0,te[2]=0,te[3]=0,te[4]=0,te[5]=-2*pt,te[6]=0,te[7]=0,te[8]=0,te[9]=0,te[10]=2*oe,te[11]=0,te[12]=(fe+_e)*xt,te[13]=(Ze+Be)*pt,te[14]=(qt+lt)*oe,te[15]=1,te},Jt=function(){var te=!1;return function(fe){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(fe)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(fe.substr(0,4)))&&(te=!0)}(navigator.userAgent||navigator.vendor||window.opera),te},sn=function(te,fe){for(var _e in fe)fe.hasOwnProperty(_e)&&(te[_e]=fe[_e]);return te},Se=function(te){if(D()){var fe=te.style.width,_e=te.style.height;te.style.width=parseInt(fe)+1+"px",te.style.height=parseInt(_e)+"px",setTimeout(function(){te.style.width=fe,te.style.height=_e},100)}window.canvas=te},qe=function(){var K=Math.PI/180,te=Math.PI*.25;function fe(pt,oe,he,be){var Te=Math.tan(oe?oe.upDegrees*K:te),Ae=Math.tan(oe?oe.downDegrees*K:te),rt=Math.tan(oe?oe.leftDegrees*K:te),Mt=Math.tan(oe?oe.rightDegrees*K:te),Ft=2/(rt+Mt),en=2/(Te+Ae);return pt[0]=Ft,pt[1]=0,pt[2]=0,pt[3]=0,pt[4]=0,pt[5]=en,pt[6]=0,pt[7]=0,pt[8]=-((rt-Mt)*Ft*.5),pt[9]=(Te-Ae)*en*.5,pt[10]=be/(he-be),pt[11]=-1,pt[12]=0,pt[13]=0,pt[14]=be*he/(he-be),pt[15]=0,pt}function _e(pt,oe,he){var be=oe[0],Te=oe[1],Ae=oe[2],rt=oe[3],Mt=be+be,Ft=Te+Te,en=Ae+Ae,Mn=be*Mt,rn=be*Ft,hn=be*en,Sn=Te*Ft,Kn=Te*en,ei=Ae*en,bn=rt*Mt,ti=rt*Ft,xi=rt*en;return pt[0]=1-(Sn+ei),pt[1]=rn+xi,pt[2]=hn-ti,pt[3]=0,pt[4]=rn-xi,pt[5]=1-(Mn+ei),pt[6]=Kn+bn,pt[7]=0,pt[8]=hn+ti,pt[9]=Kn-bn,pt[10]=1-(Mn+Sn),pt[11]=0,pt[12]=he[0],pt[13]=he[1],pt[14]=he[2],pt[15]=1,pt}function Be(pt,oe,he){var be=he[0],Te=he[1],Ae=he[2],rt,Mt,Ft,en,Mn,rn,hn,Sn,Kn,ei,bn,ti;return oe===pt?(pt[12]=oe[0]*be+oe[4]*Te+oe[8]*Ae+oe[12],pt[13]=oe[1]*be+oe[5]*Te+oe[9]*Ae+oe[13],pt[14]=oe[2]*be+oe[6]*Te+oe[10]*Ae+oe[14],pt[15]=oe[3]*be+oe[7]*Te+oe[11]*Ae+oe[15]):(rt=oe[0],Mt=oe[1],Ft=oe[2],en=oe[3],Mn=oe[4],rn=oe[5],hn=oe[6],Sn=oe[7],Kn=oe[8],ei=oe[9],bn=oe[10],ti=oe[11],pt[0]=rt,pt[1]=Mt,pt[2]=Ft,pt[3]=en,pt[4]=Mn,pt[5]=rn,pt[6]=hn,pt[7]=Sn,pt[8]=Kn,pt[9]=ei,pt[10]=bn,pt[11]=ti,pt[12]=rt*be+Mn*Te+Kn*Ae+oe[12],pt[13]=Mt*be+rn*Te+ei*Ae+oe[13],pt[14]=Ft*be+hn*Te+bn*Ae+oe[14],pt[15]=en*be+Sn*Te+ti*Ae+oe[15]),pt}function Ze(pt,oe){var he=oe[0],be=oe[1],Te=oe[2],Ae=oe[3],rt=oe[4],Mt=oe[5],Ft=oe[6],en=oe[7],Mn=oe[8],rn=oe[9],hn=oe[10],Sn=oe[11],Kn=oe[12],ei=oe[13],bn=oe[14],ti=oe[15],xi=he*Mt-be*rt,Ti=he*Ft-Te*rt,qi=he*en-Ae*rt,rr=be*Ft-Te*Mt,Ei=be*en-Ae*Mt,Mr=Te*en-Ae*Ft,fi=Mn*ei-rn*Kn,Po=Mn*bn-hn*Kn,fo=Mn*ti-Sn*Kn,Ia=rn*bn-hn*ei,Bc=rn*ti-Sn*ei,Uc=hn*ti-Sn*bn,Pr=xi*Uc-Ti*Bc+qi*Ia+rr*fo-Ei*Po+Mr*fi;return Pr?(Pr=1/Pr,pt[0]=(Mt*Uc-Ft*Bc+en*Ia)*Pr,pt[1]=(Te*Bc-be*Uc-Ae*Ia)*Pr,pt[2]=(ei*Mr-bn*Ei+ti*rr)*Pr,pt[3]=(hn*Ei-rn*Mr-Sn*rr)*Pr,pt[4]=(Ft*fo-rt*Uc-en*Po)*Pr,pt[5]=(he*Uc-Te*fo+Ae*Po)*Pr,pt[6]=(bn*qi-Kn*Mr-ti*Ti)*Pr,pt[7]=(Mn*Mr-hn*qi+Sn*Ti)*Pr,pt[8]=(rt*Bc-Mt*fo+en*fi)*Pr,pt[9]=(be*fo-he*Bc-Ae*fi)*Pr,pt[10]=(Kn*Ei-ei*qi+ti*xi)*Pr,pt[11]=(rn*qi-Mn*Ei-Sn*xi)*Pr,pt[12]=(Mt*Po-rt*Ia-Ft*fi)*Pr,pt[13]=(he*Ia-be*Po+Te*fi)*Pr,pt[14]=(ei*Ti-Kn*rr-bn*xi)*Pr,pt[15]=(Mn*rr-rn*Ti+hn*xi)*Pr,pt):null}var lt=new Float32Array([0,0,0,1]),qt=new Float32Array([0,0,0]);function xt(pt,oe,he,be,Te,Ae){fe(pt,be||null,Ae.depthNear,Ae.depthFar);var rt=he.orientation||lt,Mt=he.position||qt;_e(oe,rt,Mt),Te&&Be(oe,oe,Te),Ze(oe,oe)}return function(pt,oe,he){return!pt||!oe?!1:(pt.pose=oe,pt.timestamp=oe.timestamp,xt(pt.leftProjectionMatrix,pt.leftViewMatrix,oe,he._getFieldOfView("left"),he._getEyeOffset("left"),he),xt(pt.rightProjectionMatrix,pt.rightViewMatrix,oe,he._getFieldOfView("right"),he._getEyeOffset("right"),he),!0)}}(),Ue=function(){var te=window.self!==window.top,fe=At(document.referrer),_e=At(window.location.href);return te&&fe!==_e},At=function(te){var fe,_e=te.indexOf("://");_e!==-1?fe=_e+3:fe=0;var Be=te.indexOf("/",fe);return Be===-1&&(Be=te.length),te.substring(0,Be)},tt=function(te){if(te.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var fe=2*Math.acos(te.w);return fe},pe=function(){var K={};return function(te,fe){K[te]===void 0&&(console.warn("webvr-polyfill: "+fe),K[te]=!0)}}(),ge=function(te,fe){var _e=fe?"Please use "+fe+" instead.":"";pe(te,te+" has been deprecated. This may not work on native WebVR displays. "+_e)};function Fe(K,te,fe){if(!te){fe(K);return}for(var _e=[],Be=null,Ze=0;Ze<te.length;++Ze){var lt=te[Ze];switch(lt){case K.TEXTURE_BINDING_2D:case K.TEXTURE_BINDING_CUBE_MAP:var qt=te[++Ze];if(qt<K.TEXTURE0||qt>K.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),_e.push(null,null);break}Be||(Be=K.getParameter(K.ACTIVE_TEXTURE)),K.activeTexture(qt),_e.push(K.getParameter(lt),null);break;case K.ACTIVE_TEXTURE:Be=K.getParameter(K.ACTIVE_TEXTURE),_e.push(null);break;default:_e.push(K.getParameter(lt));break}}fe(K);for(var Ze=0;Ze<te.length;++Ze){var lt=te[Ze],xt=_e[Ze];switch(lt){case K.ACTIVE_TEXTURE:break;case K.ARRAY_BUFFER_BINDING:K.bindBuffer(K.ARRAY_BUFFER,xt);break;case K.COLOR_CLEAR_VALUE:K.clearColor(xt[0],xt[1],xt[2],xt[3]);break;case K.COLOR_WRITEMASK:K.colorMask(xt[0],xt[1],xt[2],xt[3]);break;case K.CURRENT_PROGRAM:K.useProgram(xt);break;case K.ELEMENT_ARRAY_BUFFER_BINDING:K.bindBuffer(K.ELEMENT_ARRAY_BUFFER,xt);break;case K.FRAMEBUFFER_BINDING:K.bindFramebuffer(K.FRAMEBUFFER,xt);break;case K.RENDERBUFFER_BINDING:K.bindRenderbuffer(K.RENDERBUFFER,xt);break;case K.TEXTURE_BINDING_2D:var qt=te[++Ze];if(qt<K.TEXTURE0||qt>K.TEXTURE31)break;K.activeTexture(qt),K.bindTexture(K.TEXTURE_2D,xt);break;case K.TEXTURE_BINDING_CUBE_MAP:var qt=te[++Ze];if(qt<K.TEXTURE0||qt>K.TEXTURE31)break;K.activeTexture(qt),K.bindTexture(K.TEXTURE_CUBE_MAP,xt);break;case K.VIEWPORT:K.viewport(xt[0],xt[1],xt[2],xt[3]);break;case K.BLEND:case K.CULL_FACE:case K.DEPTH_TEST:case K.SCISSOR_TEST:case K.STENCIL_TEST:xt?K.enable(lt):K.disable(lt);break;default:console.log("No GL restore behavior for 0x"+lt.toString(16));break}Be&&K.activeTexture(Be)}}var Re=Fe,ce=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),ae=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function J(K,te,fe,_e){this.gl=K,this.cardboardUI=te,this.bufferScale=fe,this.dirtySubmitFrameBindings=_e,this.ctxAttribs=K.getContextAttributes(),this.instanceExt=K.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=K.drawingBufferWidth,this.bufferHeight=K.drawingBufferHeight,this.realBindFramebuffer=K.bindFramebuffer,this.realEnable=K.enable,this.realDisable=K.disable,this.realColorMask=K.colorMask,this.realClearColor=K.clearColor,this.realViewport=K.viewport,D()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(K.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(K.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=Qe(K,ce,ae,this.attribs),this.uniforms=St(K,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=K.createBuffer(),this.indexBuffer=K.createBuffer(),this.indexCount=0,this.renderTarget=K.createTexture(),this.framebuffer=K.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=K.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=K.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=K.createRenderbuffer()),this.patch(),this.onResize()}J.prototype.destroy=function(){var K=this.gl;this.unpatch(),K.deleteProgram(this.program),K.deleteBuffer(this.vertexBuffer),K.deleteBuffer(this.indexBuffer),K.deleteTexture(this.renderTarget),K.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&K.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&K.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&K.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},J.prototype.onResize=function(){var K=this.gl,te=this,fe=[K.RENDERBUFFER_BINDING,K.TEXTURE_BINDING_2D,K.TEXTURE0];Re(K,fe,function(_e){te.realBindFramebuffer.call(_e,_e.FRAMEBUFFER,null),te.scissorTest&&te.realDisable.call(_e,_e.SCISSOR_TEST),te.realColorMask.call(_e,!0,!0,!0,!0),te.realViewport.call(_e,0,0,_e.drawingBufferWidth,_e.drawingBufferHeight),te.realClearColor.call(_e,0,0,0,1),_e.clear(_e.COLOR_BUFFER_BIT),te.realBindFramebuffer.call(_e,_e.FRAMEBUFFER,te.framebuffer),_e.bindTexture(_e.TEXTURE_2D,te.renderTarget),_e.texImage2D(_e.TEXTURE_2D,0,te.ctxAttribs.alpha?_e.RGBA:_e.RGB,te.bufferWidth,te.bufferHeight,0,te.ctxAttribs.alpha?_e.RGBA:_e.RGB,_e.UNSIGNED_BYTE,null),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MAG_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_MIN_FILTER,_e.LINEAR),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_S,_e.CLAMP_TO_EDGE),_e.texParameteri(_e.TEXTURE_2D,_e.TEXTURE_WRAP_T,_e.CLAMP_TO_EDGE),_e.framebufferTexture2D(_e.FRAMEBUFFER,_e.COLOR_ATTACHMENT0,_e.TEXTURE_2D,te.renderTarget,0),te.ctxAttribs.depth&&te.ctxAttribs.stencil?(_e.bindRenderbuffer(_e.RENDERBUFFER,te.depthStencilBuffer),_e.renderbufferStorage(_e.RENDERBUFFER,_e.DEPTH_STENCIL,te.bufferWidth,te.bufferHeight),_e.framebufferRenderbuffer(_e.FRAMEBUFFER,_e.DEPTH_STENCIL_ATTACHMENT,_e.RENDERBUFFER,te.depthStencilBuffer)):te.ctxAttribs.depth?(_e.bindRenderbuffer(_e.RENDERBUFFER,te.depthBuffer),_e.renderbufferStorage(_e.RENDERBUFFER,_e.DEPTH_COMPONENT16,te.bufferWidth,te.bufferHeight),_e.framebufferRenderbuffer(_e.FRAMEBUFFER,_e.DEPTH_ATTACHMENT,_e.RENDERBUFFER,te.depthBuffer)):te.ctxAttribs.stencil&&(_e.bindRenderbuffer(_e.RENDERBUFFER,te.stencilBuffer),_e.renderbufferStorage(_e.RENDERBUFFER,_e.STENCIL_INDEX8,te.bufferWidth,te.bufferHeight),_e.framebufferRenderbuffer(_e.FRAMEBUFFER,_e.STENCIL_ATTACHMENT,_e.RENDERBUFFER,te.stencilBuffer)),!_e.checkFramebufferStatus(_e.FRAMEBUFFER)===_e.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),te.realBindFramebuffer.call(_e,_e.FRAMEBUFFER,te.lastBoundFramebuffer),te.scissorTest&&te.realEnable.call(_e,_e.SCISSOR_TEST),te.realColorMask.apply(_e,te.colorMask),te.realViewport.apply(_e,te.viewport),te.realClearColor.apply(_e,te.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},J.prototype.patch=function(){if(!this.isPatched){var K=this,te=this.gl.canvas,fe=this.gl;D()||(te.width=Ce()*this.bufferScale,te.height=ke()*this.bufferScale,Object.defineProperty(te,"width",{configurable:!0,enumerable:!0,get:function(){return K.bufferWidth},set:function(Be){K.bufferWidth=Be,K.realCanvasWidth.set.call(te,Be),K.onResize()}}),Object.defineProperty(te,"height",{configurable:!0,enumerable:!0,get:function(){return K.bufferHeight},set:function(Be){K.bufferHeight=Be,K.realCanvasHeight.set.call(te,Be),K.onResize()}})),this.lastBoundFramebuffer=fe.getParameter(fe.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(fe.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(_e,Be){K.lastBoundFramebuffer=Be||K.framebuffer,K.realBindFramebuffer.call(fe,_e,K.lastBoundFramebuffer)},this.cullFace=fe.getParameter(fe.CULL_FACE),this.depthTest=fe.getParameter(fe.DEPTH_TEST),this.blend=fe.getParameter(fe.BLEND),this.scissorTest=fe.getParameter(fe.SCISSOR_TEST),this.stencilTest=fe.getParameter(fe.STENCIL_TEST),fe.enable=function(_e){switch(_e){case fe.CULL_FACE:K.cullFace=!0;break;case fe.DEPTH_TEST:K.depthTest=!0;break;case fe.BLEND:K.blend=!0;break;case fe.SCISSOR_TEST:K.scissorTest=!0;break;case fe.STENCIL_TEST:K.stencilTest=!0;break}K.realEnable.call(fe,_e)},fe.disable=function(_e){switch(_e){case fe.CULL_FACE:K.cullFace=!1;break;case fe.DEPTH_TEST:K.depthTest=!1;break;case fe.BLEND:K.blend=!1;break;case fe.SCISSOR_TEST:K.scissorTest=!1;break;case fe.STENCIL_TEST:K.stencilTest=!1;break}K.realDisable.call(fe,_e)},this.colorMask=fe.getParameter(fe.COLOR_WRITEMASK),fe.colorMask=function(_e,Be,Ze,lt){K.colorMask[0]=_e,K.colorMask[1]=Be,K.colorMask[2]=Ze,K.colorMask[3]=lt,K.realColorMask.call(fe,_e,Be,Ze,lt)},this.clearColor=fe.getParameter(fe.COLOR_CLEAR_VALUE),fe.clearColor=function(_e,Be,Ze,lt){K.clearColor[0]=_e,K.clearColor[1]=Be,K.clearColor[2]=Ze,K.clearColor[3]=lt,K.realClearColor.call(fe,_e,Be,Ze,lt)},this.viewport=fe.getParameter(fe.VIEWPORT),fe.viewport=function(_e,Be,Ze,lt){K.viewport[0]=_e,K.viewport[1]=Be,K.viewport[2]=Ze,K.viewport[3]=lt,K.realViewport.call(fe,_e,Be,Ze,lt)},this.isPatched=!0,Se(te)}},J.prototype.unpatch=function(){if(!!this.isPatched){var K=this.gl,te=this.gl.canvas;D()||(Object.defineProperty(te,"width",this.realCanvasWidth),Object.defineProperty(te,"height",this.realCanvasHeight)),te.width=this.bufferWidth,te.height=this.bufferHeight,K.bindFramebuffer=this.realBindFramebuffer,K.enable=this.realEnable,K.disable=this.realDisable,K.colorMask=this.realColorMask,K.clearColor=this.realClearColor,K.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&K.bindFramebuffer(K.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){Se(te)},1)}},J.prototype.setTextureBounds=function(K,te){K||(K=[0,0,.5,1]),te||(te=[.5,0,.5,1]),this.viewportOffsetScale[0]=K[0],this.viewportOffsetScale[1]=K[1],this.viewportOffsetScale[2]=K[2],this.viewportOffsetScale[3]=K[3],this.viewportOffsetScale[4]=te[0],this.viewportOffsetScale[5]=te[1],this.viewportOffsetScale[6]=te[2],this.viewportOffsetScale[7]=te[3]},J.prototype.submitFrame=function(){var K=this.gl,te=this,fe=[];if(this.dirtySubmitFrameBindings||fe.push(K.CURRENT_PROGRAM,K.ARRAY_BUFFER_BINDING,K.ELEMENT_ARRAY_BUFFER_BINDING,K.TEXTURE_BINDING_2D,K.TEXTURE0),Re(K,fe,function(Be){te.realBindFramebuffer.call(Be,Be.FRAMEBUFFER,null);var Ze=0,lt=0;te.instanceExt&&(Ze=Be.getVertexAttrib(te.attribs.position,te.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),lt=Be.getVertexAttrib(te.attribs.texCoord,te.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),te.cullFace&&te.realDisable.call(Be,Be.CULL_FACE),te.depthTest&&te.realDisable.call(Be,Be.DEPTH_TEST),te.blend&&te.realDisable.call(Be,Be.BLEND),te.scissorTest&&te.realDisable.call(Be,Be.SCISSOR_TEST),te.stencilTest&&te.realDisable.call(Be,Be.STENCIL_TEST),te.realColorMask.call(Be,!0,!0,!0,!0),te.realViewport.call(Be,0,0,Be.drawingBufferWidth,Be.drawingBufferHeight),(te.ctxAttribs.alpha||D())&&(te.realClearColor.call(Be,0,0,0,1),Be.clear(Be.COLOR_BUFFER_BIT)),Be.useProgram(te.program),Be.bindBuffer(Be.ELEMENT_ARRAY_BUFFER,te.indexBuffer),Be.bindBuffer(Be.ARRAY_BUFFER,te.vertexBuffer),Be.enableVertexAttribArray(te.attribs.position),Be.enableVertexAttribArray(te.attribs.texCoord),Be.vertexAttribPointer(te.attribs.position,2,Be.FLOAT,!1,20,0),Be.vertexAttribPointer(te.attribs.texCoord,3,Be.FLOAT,!1,20,8),te.instanceExt&&(Ze!=0&&te.instanceExt.vertexAttribDivisorANGLE(te.attribs.position,0),lt!=0&&te.instanceExt.vertexAttribDivisorANGLE(te.attribs.texCoord,0)),Be.activeTexture(Be.TEXTURE0),Be.uniform1i(te.uniforms.diffuse,0),Be.bindTexture(Be.TEXTURE_2D,te.renderTarget),Be.uniform4fv(te.uniforms.viewportOffsetScale,te.viewportOffsetScale),Be.drawElements(Be.TRIANGLES,te.indexCount,Be.UNSIGNED_SHORT,0),te.cardboardUI&&te.cardboardUI.renderNoState(),te.realBindFramebuffer.call(te.gl,Be.FRAMEBUFFER,te.framebuffer),te.ctxAttribs.preserveDrawingBuffer||(te.realClearColor.call(Be,0,0,0,0),Be.clear(Be.COLOR_BUFFER_BIT)),te.dirtySubmitFrameBindings||te.realBindFramebuffer.call(Be,Be.FRAMEBUFFER,te.lastBoundFramebuffer),te.cullFace&&te.realEnable.call(Be,Be.CULL_FACE),te.depthTest&&te.realEnable.call(Be,Be.DEPTH_TEST),te.blend&&te.realEnable.call(Be,Be.BLEND),te.scissorTest&&te.realEnable.call(Be,Be.SCISSOR_TEST),te.stencilTest&&te.realEnable.call(Be,Be.STENCIL_TEST),te.realColorMask.apply(Be,te.colorMask),te.realViewport.apply(Be,te.viewport),(te.ctxAttribs.alpha||!te.ctxAttribs.preserveDrawingBuffer)&&te.realClearColor.apply(Be,te.clearColor),te.instanceExt&&(Ze!=0&&te.instanceExt.vertexAttribDivisorANGLE(te.attribs.position,Ze),lt!=0&&te.instanceExt.vertexAttribDivisorANGLE(te.attribs.texCoord,lt))}),D()){var _e=K.canvas;(_e.width!=te.bufferWidth||_e.height!=te.bufferHeight)&&(te.bufferWidth=_e.width,te.bufferHeight=_e.height,te.onResize())}},J.prototype.updateDeviceInfo=function(K){var te=this.gl,fe=this,_e=[te.ARRAY_BUFFER_BINDING,te.ELEMENT_ARRAY_BUFFER_BINDING];Re(te,_e,function(Be){var Ze=fe.computeMeshVertices_(fe.meshWidth,fe.meshHeight,K);if(Be.bindBuffer(Be.ARRAY_BUFFER,fe.vertexBuffer),Be.bufferData(Be.ARRAY_BUFFER,Ze,Be.STATIC_DRAW),!fe.indexCount){var lt=fe.computeMeshIndices_(fe.meshWidth,fe.meshHeight);Be.bindBuffer(Be.ELEMENT_ARRAY_BUFFER,fe.indexBuffer),Be.bufferData(Be.ELEMENT_ARRAY_BUFFER,lt,Be.STATIC_DRAW),fe.indexCount=lt.length}})},J.prototype.computeMeshVertices_=function(K,te,fe){for(var _e=new Float32Array(2*K*te*5),Be=fe.getLeftEyeVisibleTanAngles(),Ze=fe.getLeftEyeNoLensTanAngles(),lt=fe.getLeftEyeVisibleScreenRect(Ze),qt=0,xt=0;xt<2;xt++){for(var pt=0;pt<te;pt++)for(var oe=0;oe<K;oe++,qt++){var he=oe/(K-1),be=pt/(te-1),Te=he,Ae=be,rt=ne(Be[0],Be[2],he),Mt=ne(Be[3],Be[1],be),Ft=Math.sqrt(rt*rt+Mt*Mt),en=fe.distortion.distortInverse(Ft),Mn=rt*en/Ft,rn=Mt*en/Ft;he=(Mn-Ze[0])/(Ze[2]-Ze[0]),be=(rn-Ze[3])/(Ze[1]-Ze[3]),he=(lt.x+he*lt.width-.5)*2,be=(lt.y+be*lt.height-.5)*2,_e[qt*5+0]=he,_e[qt*5+1]=be,_e[qt*5+2]=Te,_e[qt*5+3]=Ae,_e[qt*5+4]=xt}var hn=Be[2]-Be[0];Be[0]=-(hn+Be[0]),Be[2]=hn-Be[2],hn=Ze[2]-Ze[0],Ze[0]=-(hn+Ze[0]),Ze[2]=hn-Ze[2],lt.x=1-(lt.x+lt.width)}return _e},J.prototype.computeMeshIndices_=function(K,te){for(var fe=new Uint16Array(2*(K-1)*(te-1)*6),_e=K/2,Be=te/2,Ze=0,lt=0,qt=0;qt<2;qt++)for(var xt=0;xt<te;xt++)for(var pt=0;pt<K;pt++,Ze++)pt==0||xt==0||(pt<=_e==xt<=Be?(fe[lt++]=Ze,fe[lt++]=Ze-K-1,fe[lt++]=Ze-K,fe[lt++]=Ze-K-1,fe[lt++]=Ze,fe[lt++]=Ze-1):(fe[lt++]=Ze-1,fe[lt++]=Ze-K,fe[lt++]=Ze,fe[lt++]=Ze-K,fe[lt++]=Ze-1,fe[lt++]=Ze-K-1));return fe},J.prototype.getOwnPropertyDescriptor_=function(K,te){var fe=Object.getOwnPropertyDescriptor(K,te);return(fe.get===void 0||fe.set===void 0)&&(fe.configurable=!0,fe.enumerable=!0,fe.get=function(){return this.getAttribute(te)},fe.set=function(_e){this.setAttribute(te,_e)}),fe};var G=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),$=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),me=Math.PI/180,Pe=60,ve=12,Le=20,wt=1,Ot=.75,_t=.3125,Ut=4,It=28,dn=1.5;function Un(K){this.gl=K,this.attribs={position:0},this.program=Qe(K,G,$,this.attribs),this.uniforms=St(K,this.program),this.vertexBuffer=K.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}Un.prototype.destroy=function(){var K=this.gl;this.listener&&K.canvas.removeEventListener("click",this.listener,!1),K.deleteProgram(this.program),K.deleteBuffer(this.vertexBuffer)},Un.prototype.listen=function(K,te){var fe=this.gl.canvas;this.listener=function(_e){var Be=fe.clientWidth/2,Ze=It*dn;_e.clientX>Be-Ze&&_e.clientX<Be+Ze&&_e.clientY>fe.clientHeight-Ze?K(_e):_e.clientX<Ze&&_e.clientY<Ze&&te(_e)},fe.addEventListener("click",this.listener,!1)},Un.prototype.onResize=function(){var K=this.gl,te=this,fe=[K.ARRAY_BUFFER_BINDING];Re(K,fe,function(_e){var Be=[],Ze=_e.drawingBufferWidth/2,lt=Math.max(screen.width,screen.height)*window.devicePixelRatio,qt=_e.drawingBufferWidth/lt,xt=qt*window.devicePixelRatio,pt=Ut*xt/2,oe=It*dn*xt,he=It*xt/2,be=(It*dn-It)*xt;Be.push(Ze-pt,oe),Be.push(Ze-pt,_e.drawingBufferHeight),Be.push(Ze+pt,oe),Be.push(Ze+pt,_e.drawingBufferHeight),te.gearOffset=Be.length/2;function Te(en,Mn){var rn=(90-en)*me,hn=Math.cos(rn),Sn=Math.sin(rn);Be.push(_t*hn*he+Ze,_t*Sn*he+he),Be.push(Mn*hn*he+Ze,Mn*Sn*he+he)}for(var Ae=0;Ae<=6;Ae++){var rt=Ae*Pe;Te(rt,wt),Te(rt+ve,wt),Te(rt+Le,Ot),Te(rt+(Pe-Le),Ot),Te(rt+(Pe-ve),wt)}te.gearVertexCount=Be.length/2-te.gearOffset,te.arrowOffset=Be.length/2;function Mt(en,Mn){Be.push(be+en,_e.drawingBufferHeight-be-Mn)}var Ft=pt/Math.sin(45*me);Mt(0,he),Mt(he,0),Mt(he+Ft,Ft),Mt(Ft,he+Ft),Mt(Ft,he-Ft),Mt(0,he),Mt(he,he*2),Mt(he+Ft,he*2-Ft),Mt(Ft,he-Ft),Mt(0,he),Mt(Ft,he-pt),Mt(It*xt,he-pt),Mt(Ft,he+pt),Mt(It*xt,he+pt),te.arrowVertexCount=Be.length/2-te.arrowOffset,_e.bindBuffer(_e.ARRAY_BUFFER,te.vertexBuffer),_e.bufferData(_e.ARRAY_BUFFER,new Float32Array(Be),_e.STATIC_DRAW)})},Un.prototype.render=function(){var K=this.gl,te=this,fe=[K.CULL_FACE,K.DEPTH_TEST,K.BLEND,K.SCISSOR_TEST,K.STENCIL_TEST,K.COLOR_WRITEMASK,K.VIEWPORT,K.CURRENT_PROGRAM,K.ARRAY_BUFFER_BINDING];Re(K,fe,function(_e){_e.disable(_e.CULL_FACE),_e.disable(_e.DEPTH_TEST),_e.disable(_e.BLEND),_e.disable(_e.SCISSOR_TEST),_e.disable(_e.STENCIL_TEST),_e.colorMask(!0,!0,!0,!0),_e.viewport(0,0,_e.drawingBufferWidth,_e.drawingBufferHeight),te.renderNoState()})},Un.prototype.renderNoState=function(){var K=this.gl;K.useProgram(this.program),K.bindBuffer(K.ARRAY_BUFFER,this.vertexBuffer),K.enableVertexAttribArray(this.attribs.position),K.vertexAttribPointer(this.attribs.position,2,K.FLOAT,!1,8,0),K.uniform4f(this.uniforms.color,1,1,1,1),bt(this.projMat,0,K.drawingBufferWidth,0,K.drawingBufferHeight,.1,1024),K.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),K.drawArrays(K.TRIANGLE_STRIP,0,4),K.drawArrays(K.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),K.drawArrays(K.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function $n(K){this.coefficients=K}$n.prototype.distortInverse=function(K){for(var te=0,fe=1,_e=K-this.distort(te);Math.abs(fe-te)>1e-4;){var Be=K-this.distort(fe),Ze=fe-Be*((fe-te)/(Be-_e));te=fe,fe=Ze,_e=Be}return fe},$n.prototype.distort=function(K){for(var te=K*K,fe=0,_e=0;_e<this.coefficients.length;_e++)fe=te*(fe+this.coefficients[_e]);return(fe+1)*K};var Je=Math.PI/180,Ve=180/Math.PI,nt=function(te,fe,_e){this.x=te||0,this.y=fe||0,this.z=_e||0};nt.prototype={constructor:nt,set:function(te,fe,_e){return this.x=te,this.y=fe,this.z=_e,this},copy:function(te){return this.x=te.x,this.y=te.y,this.z=te.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var te=this.length();if(te!==0){var fe=1/te;this.multiplyScalar(fe)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(te){this.x*=te,this.y*=te,this.z*=te},applyQuaternion:function(te){var fe=this.x,_e=this.y,Be=this.z,Ze=te.x,lt=te.y,qt=te.z,xt=te.w,pt=xt*fe+lt*Be-qt*_e,oe=xt*_e+qt*fe-Ze*Be,he=xt*Be+Ze*_e-lt*fe,be=-Ze*fe-lt*_e-qt*Be;return this.x=pt*xt+be*-Ze+oe*-qt-he*-lt,this.y=oe*xt+be*-lt+he*-Ze-pt*-qt,this.z=he*xt+be*-qt+pt*-lt-oe*-Ze,this},dot:function(te){return this.x*te.x+this.y*te.y+this.z*te.z},crossVectors:function(te,fe){var _e=te.x,Be=te.y,Ze=te.z,lt=fe.x,qt=fe.y,xt=fe.z;return this.x=Be*xt-Ze*qt,this.y=Ze*lt-_e*xt,this.z=_e*qt-Be*lt,this}};var yt=function(te,fe,_e,Be){this.x=te||0,this.y=fe||0,this.z=_e||0,this.w=Be!==void 0?Be:1};yt.prototype={constructor:yt,set:function(te,fe,_e,Be){return this.x=te,this.y=fe,this.z=_e,this.w=Be,this},copy:function(te){return this.x=te.x,this.y=te.y,this.z=te.z,this.w=te.w,this},setFromEulerXYZ:function(te,fe,_e){var Be=Math.cos(te/2),Ze=Math.cos(fe/2),lt=Math.cos(_e/2),qt=Math.sin(te/2),xt=Math.sin(fe/2),pt=Math.sin(_e/2);return this.x=qt*Ze*lt+Be*xt*pt,this.y=Be*xt*lt-qt*Ze*pt,this.z=Be*Ze*pt+qt*xt*lt,this.w=Be*Ze*lt-qt*xt*pt,this},setFromEulerYXZ:function(te,fe,_e){var Be=Math.cos(te/2),Ze=Math.cos(fe/2),lt=Math.cos(_e/2),qt=Math.sin(te/2),xt=Math.sin(fe/2),pt=Math.sin(_e/2);return this.x=qt*Ze*lt+Be*xt*pt,this.y=Be*xt*lt-qt*Ze*pt,this.z=Be*Ze*pt-qt*xt*lt,this.w=Be*Ze*lt+qt*xt*pt,this},setFromAxisAngle:function(te,fe){var _e=fe/2,Be=Math.sin(_e);return this.x=te.x*Be,this.y=te.y*Be,this.z=te.z*Be,this.w=Math.cos(_e),this},multiply:function(te){return this.multiplyQuaternions(this,te)},multiplyQuaternions:function(te,fe){var _e=te.x,Be=te.y,Ze=te.z,lt=te.w,qt=fe.x,xt=fe.y,pt=fe.z,oe=fe.w;return this.x=_e*oe+lt*qt+Be*pt-Ze*xt,this.y=Be*oe+lt*xt+Ze*qt-_e*pt,this.z=Ze*oe+lt*pt+_e*xt-Be*qt,this.w=lt*oe-_e*qt-Be*xt-Ze*pt,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var te=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return te===0?(this.x=0,this.y=0,this.z=0,this.w=1):(te=1/te,this.x=this.x*te,this.y=this.y*te,this.z=this.z*te,this.w=this.w*te),this},slerp:function(te,fe){if(fe===0)return this;if(fe===1)return this.copy(te);var _e=this.x,Be=this.y,Ze=this.z,lt=this.w,qt=lt*te.w+_e*te.x+Be*te.y+Ze*te.z;if(qt<0?(this.w=-te.w,this.x=-te.x,this.y=-te.y,this.z=-te.z,qt=-qt):this.copy(te),qt>=1)return this.w=lt,this.x=_e,this.y=Be,this.z=Ze,this;var xt=Math.acos(qt),pt=Math.sqrt(1-qt*qt);if(Math.abs(pt)<.001)return this.w=.5*(lt+this.w),this.x=.5*(_e+this.x),this.y=.5*(Be+this.y),this.z=.5*(Ze+this.z),this;var oe=Math.sin((1-fe)*xt)/pt,he=Math.sin(fe*xt)/pt;return this.w=lt*oe+this.w*he,this.x=_e*oe+this.x*he,this.y=Be*oe+this.y*he,this.z=Ze*oe+this.z*he,this},setFromUnitVectors:function(){var K,te,fe=1e-6;return function(_e,Be){return K===void 0&&(K=new nt),te=_e.dot(Be)+1,te<fe?(te=0,Math.abs(_e.x)>Math.abs(_e.z)?K.set(-_e.y,_e.x,0):K.set(0,-_e.z,_e.y)):K.crossVectors(_e,Be),this.x=K.x,this.y=K.y,this.z=K.z,this.w=te,this.normalize(),this}}()};function Wt(K){this.width=K.width||Ce(),this.height=K.height||ke(),this.widthMeters=K.widthMeters,this.heightMeters=K.heightMeters,this.bevelMeters=K.bevelMeters}var pn=new Wt({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),An=new Wt({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),mn={CardboardV1:new Bn({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new Bn({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Yn(K,te){this.viewer=mn.CardboardV2,this.updateDeviceParams(K),this.distortion=new $n(this.viewer.distortionCoefficients);for(var fe=0;fe<te.length;fe++){var _e=te[fe];mn[_e.id]=new Bn(_e)}}Yn.prototype.updateDeviceParams=function(K){this.device=this.determineDevice_(K)||this.device},Yn.prototype.getDevice=function(){return this.device},Yn.prototype.setViewer=function(K){this.viewer=K,this.distortion=new $n(this.viewer.distortionCoefficients)},Yn.prototype.determineDevice_=function(K){if(!K)return D()?(console.warn("Using fallback iOS device measurements."),An):(console.warn("Using fallback Android device measurements."),pn);var te=.0254,fe=te/K.xdpi,_e=te/K.ydpi,Be=Ce(),Ze=ke();return new Wt({widthMeters:fe*Be,heightMeters:_e*Ze,bevelMeters:K.bevelMm*.001})},Yn.prototype.getDistortedFieldOfViewLeftEye=function(){var K=this.viewer,te=this.device,fe=this.distortion,_e=K.screenLensDistance,Be=(te.widthMeters-K.interLensDistance)/2,Ze=K.interLensDistance/2,lt=K.baselineLensDistance-te.bevelMeters,qt=te.heightMeters-lt,xt=Ve*Math.atan(fe.distort(Be/_e)),pt=Ve*Math.atan(fe.distort(Ze/_e)),oe=Ve*Math.atan(fe.distort(lt/_e)),he=Ve*Math.atan(fe.distort(qt/_e));return{leftDegrees:Math.min(xt,K.fov),rightDegrees:Math.min(pt,K.fov),downDegrees:Math.min(oe,K.fov),upDegrees:Math.min(he,K.fov)}},Yn.prototype.getLeftEyeVisibleTanAngles=function(){var K=this.viewer,te=this.device,fe=this.distortion,_e=Math.tan(-Je*K.fov),Be=Math.tan(Je*K.fov),Ze=Math.tan(Je*K.fov),lt=Math.tan(-Je*K.fov),qt=te.widthMeters/4,xt=te.heightMeters/2,pt=K.baselineLensDistance-te.bevelMeters-xt,oe=K.interLensDistance/2-qt,he=-pt,be=K.screenLensDistance,Te=fe.distort((oe-qt)/be),Ae=fe.distort((he+xt)/be),rt=fe.distort((oe+qt)/be),Mt=fe.distort((he-xt)/be),Ft=new Float32Array(4);return Ft[0]=Math.max(_e,Te),Ft[1]=Math.min(Be,Ae),Ft[2]=Math.min(Ze,rt),Ft[3]=Math.max(lt,Mt),Ft},Yn.prototype.getLeftEyeNoLensTanAngles=function(){var K=this.viewer,te=this.device,fe=this.distortion,_e=new Float32Array(4),Be=fe.distortInverse(Math.tan(-Je*K.fov)),Ze=fe.distortInverse(Math.tan(Je*K.fov)),lt=fe.distortInverse(Math.tan(Je*K.fov)),qt=fe.distortInverse(Math.tan(-Je*K.fov)),xt=te.widthMeters/4,pt=te.heightMeters/2,oe=K.baselineLensDistance-te.bevelMeters-pt,he=K.interLensDistance/2-xt,be=-oe,Te=K.screenLensDistance,Ae=(he-xt)/Te,rt=(be+pt)/Te,Mt=(he+xt)/Te,Ft=(be-pt)/Te;return _e[0]=Math.max(Be,Ae),_e[1]=Math.min(Ze,rt),_e[2]=Math.min(lt,Mt),_e[3]=Math.max(qt,Ft),_e},Yn.prototype.getLeftEyeVisibleScreenRect=function(K){var te=this.viewer,fe=this.device,_e=te.screenLensDistance,Be=(fe.widthMeters-te.interLensDistance)/2,Ze=te.baselineLensDistance-fe.bevelMeters,lt=(K[0]*_e+Be)/fe.widthMeters,qt=(K[1]*_e+Ze)/fe.heightMeters,xt=(K[2]*_e+Be)/fe.widthMeters,pt=(K[3]*_e+Ze)/fe.heightMeters;return{x:lt,y:pt,width:xt-lt,height:qt-pt}},Yn.prototype.getFieldOfViewLeftEye=function(K){return K?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Yn.prototype.getFieldOfViewRightEye=function(K){var te=this.getFieldOfViewLeftEye(K);return{leftDegrees:te.rightDegrees,rightDegrees:te.leftDegrees,upDegrees:te.upDegrees,downDegrees:te.downDegrees}},Yn.prototype.getUndistortedFieldOfViewLeftEye=function(){var K=this.getUndistortedParams_();return{leftDegrees:Ve*Math.atan(K.outerDist),rightDegrees:Ve*Math.atan(K.innerDist),downDegrees:Ve*Math.atan(K.bottomDist),upDegrees:Ve*Math.atan(K.topDist)}},Yn.prototype.getUndistortedViewportLeftEye=function(){var K=this.getUndistortedParams_(),te=this.viewer,fe=this.device,_e=te.screenLensDistance,Be=fe.widthMeters/_e,Ze=fe.heightMeters/_e,lt=fe.width/Be,qt=fe.height/Ze,xt=Math.round((K.eyePosX-K.outerDist)*lt),pt=Math.round((K.eyePosY-K.bottomDist)*qt);return{x:xt,y:pt,width:Math.round((K.eyePosX+K.innerDist)*lt)-xt,height:Math.round((K.eyePosY+K.topDist)*qt)-pt}},Yn.prototype.getUndistortedParams_=function(){var K=this.viewer,te=this.device,fe=this.distortion,_e=K.screenLensDistance,Be=K.interLensDistance/2/_e,Ze=te.widthMeters/_e,lt=te.heightMeters/_e,qt=Ze/2-Be,xt=(K.baselineLensDistance-te.bevelMeters)/_e,pt=K.fov,oe=fe.distortInverse(Math.tan(Je*pt)),he=Math.min(qt,oe),be=Math.min(Be,oe),Te=Math.min(xt,oe),Ae=Math.min(lt-xt,oe);return{outerDist:he,innerDist:be,topDist:Ae,bottomDist:Te,eyePosX:qt,eyePosY:xt}};function Bn(K){this.id=K.id,this.label=K.label,this.fov=K.fov,this.interLensDistance=K.interLensDistance,this.baselineLensDistance=K.baselineLensDistance,this.screenLensDistance=K.screenLensDistance,this.distortionCoefficients=K.distortionCoefficients,this.inverseCoefficients=K.inverseCoefficients}Yn.Viewers=mn;var mi=1,Ii="2019-11-09T17:36:14Z",Si=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Gi={format:mi,last_updated:Ii,devices:Si};function er(K,te){if(this.dpdb=Gi,this.recalculateDeviceParams_(),K){this.onDeviceParamsUpdated=te;var fe=new XMLHttpRequest,_e=this;fe.open("GET",K,!0),fe.addEventListener("load",function(){_e.loading=!1,fe.status>=200&&fe.status<=299?(_e.dpdb=JSON.parse(fe.response),_e.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),fe.send()}}er.prototype.getDeviceParams=function(){return this.deviceParams},er.prototype.recalculateDeviceParams_=function(){var K=this.calcDeviceParams_();K?(this.deviceParams=K,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},er.prototype.calcDeviceParams_=function(){var K=this.dpdb;if(!K)return console.error("DPDB not available."),null;if(K.format!=1)return console.error("DPDB has unexpected format version."),null;if(!K.devices||!K.devices.length)return console.error("DPDB does not have a devices section."),null;var te=navigator.userAgent||navigator.vendor||window.opera,fe=Ce(),_e=ke();if(!K.devices)return console.error("DPDB has no devices section."),null;for(var Be=0;Be<K.devices.length;Be++){var Ze=K.devices[Be];if(!Ze.rules){console.warn("Device["+Be+"] has no rules section.");continue}if(Ze.type!="ios"&&Ze.type!="android"){console.warn("Device["+Be+"] has invalid type.");continue}if(D()==(Ze.type=="ios")){for(var lt=!1,qt=0;qt<Ze.rules.length;qt++){var xt=Ze.rules[qt];if(this.ruleMatches_(xt,te,fe,_e)){lt=!0;break}}if(!!lt){var pt=Ze.dpi[0]||Ze.dpi,oe=Ze.dpi[1]||Ze.dpi;return new is({xdpi:pt,ydpi:oe,bevelMm:Ze.bw})}}}return console.warn("No DPDB device match."),null},er.prototype.ruleMatches_=function(K,te,fe,_e){if(!K.ua&&!K.res||(K.ua&&K.ua.substring(0,2)==="SM"&&(K.ua=K.ua.substring(0,7)),K.ua&&te.indexOf(K.ua)<0))return!1;if(K.res){if(!K.res[0]||!K.res[1])return!1;var Be=K.res[0],Ze=K.res[1];if(Math.min(fe,_e)!=Math.min(Be,Ze)||Math.max(fe,_e)!=Math.max(Be,Ze))return!1}return!0};function is(K){this.xdpi=K.xdpi,this.ydpi=K.ydpi,this.bevelMm=K.bevelMm}function ze(K,te){this.set(K,te)}ze.prototype.set=function(K,te){this.sample=K,this.timestampS=te},ze.prototype.copy=function(K){this.set(K.sample,K.timestampS)};function at(K,te){this.kFilter=K,this.isDebug=te,this.currentAccelMeasurement=new ze,this.currentGyroMeasurement=new ze,this.previousGyroMeasurement=new ze,D()?this.filterQ=new yt(-1,0,0,1):this.filterQ=new yt(1,0,0,1),this.previousFilterQ=new yt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new yt,this.isOrientationInitialized=!1,this.estimatedGravity=new nt,this.measuredGravity=new nt,this.gyroIntegralQ=new yt}at.prototype.addAccelMeasurement=function(K,te){this.currentAccelMeasurement.set(K,te)},at.prototype.addGyroMeasurement=function(K,te){this.currentGyroMeasurement.set(K,te);var fe=te-this.previousGyroMeasurement.timestampS;ye(fe)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},at.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var K=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,te=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,K);this.gyroIntegralQ.multiply(te),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(te);var fe=new yt;fe.copy(this.filterQ),fe.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(fe),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var _e=new yt;_e.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),_e.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",Ve*tt(_e),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var Be=new yt;Be.copy(this.filterQ),Be.multiply(_e),this.filterQ.slerp(Be,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},at.prototype.getOrientation=function(){return this.filterQ},at.prototype.accelToQuaternion_=function(K){var te=new nt;te.copy(K),te.normalize();var fe=new yt;return fe.setFromUnitVectors(new nt(0,0,-1),te),fe.inverse(),fe},at.prototype.gyroToQuaternionDelta_=function(K,te){var fe=new yt,_e=new nt;return _e.copy(K),_e.normalize(),fe.setFromAxisAngle(_e,K.length()*te),fe};function Pt(K,te){this.predictionTimeS=K,this.isDebug=te,this.previousQ=new yt,this.previousTimestampS=null,this.deltaQ=new yt,this.outQ=new yt}Pt.prototype.getPrediction=function(K,te,fe){if(!this.previousTimestampS)return this.previousQ.copy(K),this.previousTimestampS=fe,K;var _e=new nt;_e.copy(te),_e.normalize();var Be=te.length();if(Be<Je*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(Ve*Be).toFixed(1)),this.outQ.copy(K),this.previousQ.copy(K),this.outQ;var Ze=Be*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(_e,Ze),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(K),this.previousTimestampS=fe,this.outQ};function ft(K,te,fe,_e){this.yawOnly=fe,this.accelerometer=new nt,this.gyroscope=new nt,this.filter=new at(K,_e),this.posePredictor=new Pt(te,_e),this.isFirefoxAndroid=z(),this.isIOS=D();var Be=X();this.isDeviceMotionInRadians=!this.isIOS&&Be&&Be<66,this.isWithoutDeviceMotion=ie()||Z(),this.filterToWorldQ=new yt,D()?this.filterToWorldQ.setFromAxisAngle(new nt(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new nt(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new yt,this.worldToScreenQ=new yt,this.originalPoseAdjustQ=new yt,this.originalPoseAdjustQ.setFromAxisAngle(new nt(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),ue()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new yt,this.orientationOut_=new Float32Array(4),this.start()}ft.prototype.getPosition=function(){return null},ft.prototype.getOrientation=function(){var K=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var Be=new yt().setFromAxisAngle(new nt(0,0,-1),0),Ze=new yt;return window.orientation===-90?Ze.setFromAxisAngle(new nt(0,1,0),Math.PI/-2):Ze.setFromAxisAngle(new nt(0,1,0),Math.PI/2),Be.multiply(Ze)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var Be=new yt;return Be.setFromAxisAngle(new nt(1,0,0),-Math.PI/2),Be}(),K=this._deviceOrientationQ;var fe=new yt;return fe.copy(K),fe.multiply(this.deviceOrientationFilterToWorldQ),fe.multiply(this.resetQ),fe.multiply(this.worldToScreenQ),fe.multiplyQuaternions(this.deviceOrientationFixQ,fe),this.yawOnly&&(fe.x=0,fe.z=0,fe.normalize()),this.orientationOut_[0]=fe.x,this.orientationOut_[1]=fe.y,this.orientationOut_[2]=fe.z,this.orientationOut_[3]=fe.w,this.orientationOut_}else{var te=this.filter.getOrientation();K=this.posePredictor.getPrediction(te,this.gyroscope,this.previousTimestampS)}var fe=new yt;return fe.copy(this.filterToWorldQ),fe.multiply(this.resetQ),fe.multiply(K),fe.multiply(this.worldToScreenQ),this.yawOnly&&(fe.x=0,fe.z=0,fe.normalize()),this.orientationOut_[0]=fe.x,this.orientationOut_[1]=fe.y,this.orientationOut_[2]=fe.z,this.orientationOut_[3]=fe.w,this.orientationOut_},ft.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),ue()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},ft.prototype.onDeviceOrientation_=function(K){this._deviceOrientationQ=this._deviceOrientationQ||new yt;var te=K.alpha,fe=K.beta,_e=K.gamma;te=(te||0)*Math.PI/180,fe=(fe||0)*Math.PI/180,_e=(_e||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(fe,te,-_e)},ft.prototype.onDeviceMotion_=function(K){this.updateDeviceMotion_(K)},ft.prototype.updateDeviceMotion_=function(K){var te=K.accelerationIncludingGravity,fe=K.rotationRate,_e=K.timeStamp/1e3,Be=_e-this.previousTimestampS;if(Be<0){pe("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=_e;return}else if(Be<=H||Be>q){pe("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=_e;return}this.accelerometer.set(-te.x,-te.y,-te.z),fe&&(se()?this.gyroscope.set(-fe.beta,fe.alpha,fe.gamma):this.gyroscope.set(fe.alpha,fe.beta,fe.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,_e)),this.filter.addAccelMeasurement(this.accelerometer,_e),this.previousTimestampS=_e},ft.prototype.onOrientationChange_=function(K){this.setScreenTransform_()},ft.prototype.onMessage_=function(K){var te=K.data;if(!(!te||!te.type)){var fe=te.type.toLowerCase();fe==="devicemotion"&&this.updateDeviceMotion_(te.deviceMotionEvent)}},ft.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new nt(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new nt(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},ft.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),D()&&Ue()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},ft.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var Ht=60,In=new nt(1,0,0),we=new nt(0,0,1),We=new yt;We.setFromAxisAngle(In,-Math.PI/2),We.multiply(new yt().setFromAxisAngle(we,Math.PI/2));var et=function(){function K(te){I(this,K),this.config=te,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new yt,this._outQ=new yt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return N(K,[{key:"init",value:function(){var fe=null;try{fe=new RelativeOrientationSensor({frequency:Ht,referenceFrame:"screen"}),fe.addEventListener("error",this._onSensorError)}catch(_e){this.errors.push(_e),_e.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):_e.name==="ReferenceError"?this.useDeviceMotion():console.error(_e)}fe&&(this.api="sensor",this.sensor=fe,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new ft(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var fe=this.sensor.quaternion;this._sensorQ.set(fe[0],fe[1],fe[2],fe[3]);var _e=this._outQ;return _e.copy(We),_e.multiply(this._sensorQ),this.config.YAW_ONLY&&(_e.x=_e.z=0,_e.normalize()),this._out[0]=_e.x,this._out[1]=_e.y,this._out[2]=_e.z,this._out[3]=_e.w,this._out}},{key:"_onSensorError",value:function(fe){this.errors.push(fe.error),fe.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):fe.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(fe.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),K}(),mt="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function ot(){this.loadIcon_();var K=document.createElement("div"),lt=K.style;lt.position="fixed",lt.top=0,lt.right=0,lt.bottom=0,lt.left=0,lt.backgroundColor="gray",lt.fontFamily="sans-serif",lt.zIndex=1e6;var te=document.createElement("img");te.src=this.icon;var lt=te.style;lt.marginLeft="25%",lt.marginTop="25%",lt.width="50%",K.appendChild(te);var fe=document.createElement("div"),lt=fe.style;lt.textAlign="center",lt.fontSize="16px",lt.lineHeight="24px",lt.margin="24px 25%",lt.width="50%",fe.innerHTML="Place your phone into your Cardboard viewer.",K.appendChild(fe);var _e=document.createElement("div"),lt=_e.style;lt.backgroundColor="#CFD8DC",lt.position="fixed",lt.bottom=0,lt.width="100%",lt.height="48px",lt.padding="14px 24px",lt.boxSizing="border-box",lt.color="#656A6B",K.appendChild(_e);var Be=document.createElement("div");Be.style.float="left",Be.innerHTML="No Cardboard viewer?";var Ze=document.createElement("a");Ze.href="https://www.google.com/get/cardboard/get-cardboard/",Ze.innerHTML="get one",Ze.target="_blank";var lt=Ze.style;lt.float="right",lt.fontWeight=600,lt.textTransform="uppercase",lt.borderLeft="1px solid gray",lt.paddingLeft="24px",lt.textDecoration="none",lt.color="#656A6B",_e.appendChild(Be),_e.appendChild(Ze),this.overlay=K,this.text=fe,this.hide()}ot.prototype.show=function(K){!K&&!this.overlay.parentElement?document.body.appendChild(this.overlay):K&&(this.overlay.parentElement&&this.overlay.parentElement!=K&&this.overlay.parentElement.removeChild(this.overlay),K.appendChild(this.overlay)),this.overlay.style.display="block";var te=this.overlay.querySelector("img"),fe=te.style;ue()?(fe.width="20%",fe.marginLeft="40%",fe.marginTop="3%"):(fe.width="50%",fe.marginLeft="25%",fe.marginTop="25%")},ot.prototype.hide=function(){this.overlay.style.display="none"},ot.prototype.showTemporarily=function(K,te){this.show(te),this.timer=setTimeout(this.hide.bind(this),K)},ot.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},ot.prototype.update=function(){this.disableShowTemporarily(),!ue()&&Jt()?this.show():this.hide()},ot.prototype.loadIcon_=function(){this.icon=le("image/svg+xml",mt)};var Tt="CardboardV1",zt="WEBVR_CARDBOARD_VIEWER",un="webvr-polyfill-viewer-selector";function tn(K){try{this.selectedKey=localStorage.getItem(zt)}catch(te){console.error("Failed to load viewer profile: %s",te)}this.selectedKey||(this.selectedKey=K||Tt),this.dialog=this.createDialog_(Yn.Viewers),this.root=null,this.onChangeCallbacks_=[]}tn.prototype.show=function(K){this.root=K,K.appendChild(this.dialog);var te=this.dialog.querySelector("#"+this.selectedKey);te.checked=!0,this.dialog.style.display="block"},tn.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},tn.prototype.getCurrentViewer=function(){return Yn.Viewers[this.selectedKey]},tn.prototype.getSelectedKey_=function(){var K=this.dialog.querySelector("input[name=field]:checked");return K?K.id:null},tn.prototype.onChange=function(K){this.onChangeCallbacks_.push(K)},tn.prototype.fireOnChange_=function(K){for(var te=0;te<this.onChangeCallbacks_.length;te++)this.onChangeCallbacks_[te](K)},tn.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Yn.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Yn.Viewers[this.selectedKey]);try{localStorage.setItem(zt,this.selectedKey)}catch(K){console.error("Failed to save viewer profile: %s",K)}this.hide()},tn.prototype.createDialog_=function(K){var te=document.createElement("div");te.classList.add(un),te.style.display="none";var fe=document.createElement("div"),Ze=fe.style;Ze.position="fixed",Ze.left=0,Ze.top=0,Ze.width="100%",Ze.height="100%",Ze.background="rgba(0, 0, 0, 0.3)",fe.addEventListener("click",this.hide.bind(this));var _e=280,Be=document.createElement("div"),Ze=Be.style;Ze.boxSizing="border-box",Ze.position="fixed",Ze.top="24px",Ze.left="50%",Ze.marginLeft=-_e/2+"px",Ze.width=_e+"px",Ze.padding="24px",Ze.overflow="hidden",Ze.background="#fafafa",Ze.fontFamily="'Roboto', sans-serif",Ze.boxShadow="0px 5px 20px #666",Be.appendChild(this.createH1_("Select your viewer"));for(var lt in K)Be.appendChild(this.createChoice_(lt,K[lt].label));return Be.appendChild(this.createButton_("Save",this.onSave_.bind(this))),te.appendChild(fe),te.appendChild(Be),te},tn.prototype.createH1_=function(K){var te=document.createElement("h1"),fe=te.style;return fe.color="black",fe.fontSize="20px",fe.fontWeight="bold",fe.marginTop=0,fe.marginBottom="24px",te.innerHTML=K,te},tn.prototype.createChoice_=function(K,te){var fe=document.createElement("div");fe.style.marginTop="8px",fe.style.color="black";var _e=document.createElement("input");_e.style.fontSize="30px",_e.setAttribute("id",K),_e.setAttribute("type","radio"),_e.setAttribute("value",K),_e.setAttribute("name","field");var Be=document.createElement("label");return Be.style.marginLeft="4px",Be.setAttribute("for",K),Be.innerHTML=te,fe.appendChild(_e),fe.appendChild(Be),fe},tn.prototype.createButton_=function(K,te){var fe=document.createElement("button");fe.innerHTML=K;var _e=fe.style;return _e.float="right",_e.textTransform="uppercase",_e.color="#1094f7",_e.fontSize="14px",_e.letterSpacing=0,_e.border=0,_e.background="none",_e.marginTop="16px",fe.addEventListener("click",te),fe};var Bt=typeof window<"u"?window:typeof u<"u"?u:typeof self<"u"?self:{};function fn(K){return K&&K.__esModule&&Object.prototype.hasOwnProperty.call(K,"default")?K.default:K}function ln(K,te){return te={exports:{}},K(te,te.exports),te.exports}var Jn=ln(function(K,te){(function(_e,Be){K.exports=Be()})(Bt,function(){return function(fe){var _e={};function Be(Ze){if(_e[Ze])return _e[Ze].exports;var lt=_e[Ze]={i:Ze,l:!1,exports:{}};return fe[Ze].call(lt.exports,lt,lt.exports,Be),lt.l=!0,lt.exports}return Be.m=fe,Be.c=_e,Be.d=function(Ze,lt,qt){Be.o(Ze,lt)||Object.defineProperty(Ze,lt,{configurable:!1,enumerable:!0,get:qt})},Be.n=function(Ze){var lt=Ze&&Ze.__esModule?function(){return Ze.default}:function(){return Ze};return Be.d(lt,"a",lt),lt},Be.o=function(Ze,lt){return Object.prototype.hasOwnProperty.call(Ze,lt)},Be.p="",Be(Be.s=0)}([function(fe,_e,Be){var Ze=function(){function oe(he,be){for(var Te=0;Te<be.length;Te++){var Ae=be[Te];Ae.enumerable=Ae.enumerable||!1,Ae.configurable=!0,"value"in Ae&&(Ae.writable=!0),Object.defineProperty(he,Ae.key,Ae)}}return function(he,be,Te){return be&&oe(he.prototype,be),Te&&oe(he,Te),he}}();function lt(oe,he){if(!(oe instanceof he))throw new TypeError("Cannot call a class as a function")}var qt=Be(1),xt=typeof navigator<"u"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,pt=function(){function oe(){lt(this,oe),xt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",qt),this.noSleepVideo.addEventListener("timeupdate",function(he){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return Ze(oe,[{key:"enable",value:function(){xt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){xt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),oe}();fe.exports=pt},function(fe,_e,Be){fe.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),hi=fn(Jn),di=1e3,ri=[0,0,.5,1],_i=[.5,0,.5,1],ki=window.requestAnimationFrame,Ni=window.cancelAnimationFrame;function Vn(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function gi(K){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:K.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:K.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:K.canPresent},maxLayers:{writable:!1,enumerable:!0,value:K.maxLayers},hasOrientation:{enumerable:!0,get:function(){return ge("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),K.hasOrientation}}})}function Xn(K){K=K||{};var te="wakelock"in K?K.wakelock:!0;this.isPolyfilled=!0,this.displayId=di++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return ge("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new gi({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,te&&Jt()&&(this.wakelock_=new hi)}Xn.prototype.getFrameData=function(K){return qe(K,this._getPose(),this)},Xn.prototype.getPose=function(){return ge("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Xn.prototype.resetPose=function(){return ge("VRDisplay.prototype.resetPose"),this._resetPose()},Xn.prototype.getImmediatePose=function(){return ge("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Xn.prototype.requestAnimationFrame=function(K){return ki(K)},Xn.prototype.cancelAnimationFrame=function(K){return Ni(K)},Xn.prototype.wrapForFullscreen=function(K){if(D())return K;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var te=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",te.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==K)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=K,this.originalParent_=K.parentElement,this.originalParent_||document.body.appendChild(K),!this.fullscreenWrapper_.parentElement){var fe=this.fullscreenElement_.parentElement;fe.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),fe.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var _e=this;function Be(){if(!!_e.fullscreenElement_){var Ze=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];_e.fullscreenElement_.setAttribute("style",Ze.join("; ")+";")}}return Be(),this.fullscreenWrapper_},Xn.prototype.removeFullscreenWrapper=function(){if(!!this.fullscreenElement_){var K=this.fullscreenElement_;this.fullscreenElementCachedStyle_?K.setAttribute("style",this.fullscreenElementCachedStyle_):K.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var te=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(K),this.originalParent_===te?te.insertBefore(K,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(K),te.removeChild(this.fullscreenWrapper_),K}},Xn.prototype.requestPresent=function(K){var te=this.isPresenting,fe=this;return K instanceof Array||(ge("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),K=[K]),new Promise(function(_e,Be){if(!fe.capabilities.canPresent){Be(new Error("VRDisplay is not capable of presenting."));return}if(K.length==0||K.length>fe.capabilities.maxLayers){Be(new Error("Invalid number of layers."));return}var Ze=K[0];if(!Ze.source){_e();return}var lt=Ze.leftBounds||ri,qt=Ze.rightBounds||_i;if(te){var xt=fe.layer_;xt.source!==Ze.source&&(xt.source=Ze.source);for(var pt=0;pt<4;pt++)xt.leftBounds[pt]=lt[pt],xt.rightBounds[pt]=qt[pt];fe.wrapForFullscreen(fe.layer_.source),fe.updatePresent_(),_e();return}if(fe.layer_={predistorted:Ze.predistorted,source:Ze.source,leftBounds:lt.slice(0),rightBounds:qt.slice(0)},fe.waitingForPresent_=!1,fe.layer_&&fe.layer_.source){var oe=fe.wrapForFullscreen(fe.layer_.source),he=function(){var Ae=He();fe.isPresenting=oe===Ae,fe.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(rt){console.error("screen.orientation.lock() failed due to",rt.message)}),fe.waitingForPresent_=!1,fe.beginPresent_(),_e()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),fe.removeFullscreenWrapper(),fe.disableWakeLock(),fe.endPresent_(),fe.removeFullscreenListeners_()),fe.fireVRDisplayPresentChange_()},be=function(){!fe.waitingForPresent_||(fe.removeFullscreenWrapper(),fe.removeFullscreenListeners_(),fe.disableWakeLock(),fe.waitingForPresent_=!1,fe.isPresenting=!1,Be(new Error("Unable to present.")))};fe.addFullscreenListeners_(oe,he,be),Oe(oe)?(fe.enableWakeLock(),fe.waitingForPresent_=!0):(D()||O())&&(fe.enableWakeLock(),fe.isPresenting=!0,fe.beginPresent_(),fe.fireVRDisplayPresentChange_(),_e())}!fe.waitingForPresent_&&!D()&&(Ne(),Be(new Error("Unable to present.")))})},Xn.prototype.exitPresent=function(){var K=this.isPresenting,te=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(fe,_e){K?(!Ne()&&D()&&(te.endPresent_(),te.fireVRDisplayPresentChange_()),O()&&(te.removeFullscreenWrapper(),te.removeFullscreenListeners_(),te.endPresent_(),te.fireVRDisplayPresentChange_()),fe()):_e(new Error("Was not presenting to VRDisplay."))})},Xn.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Xn.prototype.fireVRDisplayPresentChange_=function(){var K=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(K)},Xn.prototype.fireVRDisplayConnect_=function(){var K=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(K)},Xn.prototype.addFullscreenListeners_=function(K,te,fe){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=K,this.fullscreenChangeHandler_=te,this.fullscreenErrorHandler_=fe,te&&(document.fullscreenEnabled?K.addEventListener("fullscreenchange",te,!1):document.webkitFullscreenEnabled?K.addEventListener("webkitfullscreenchange",te,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",te,!1):document.msFullscreenEnabled&&K.addEventListener("msfullscreenchange",te,!1)),fe&&(document.fullscreenEnabled?K.addEventListener("fullscreenerror",fe,!1):document.webkitFullscreenEnabled?K.addEventListener("webkitfullscreenerror",fe,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",fe,!1):document.msFullscreenEnabled&&K.addEventListener("msfullscreenerror",fe,!1))},Xn.prototype.removeFullscreenListeners_=function(){if(!!this.fullscreenEventTarget_){var K=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var te=this.fullscreenChangeHandler_;K.removeEventListener("fullscreenchange",te,!1),K.removeEventListener("webkitfullscreenchange",te,!1),document.removeEventListener("mozfullscreenchange",te,!1),K.removeEventListener("msfullscreenchange",te,!1)}if(this.fullscreenErrorHandler_){var fe=this.fullscreenErrorHandler_;K.removeEventListener("fullscreenerror",fe,!1),K.removeEventListener("webkitfullscreenerror",fe,!1),document.removeEventListener("mozfullscreenerror",fe,!1),K.removeEventListener("msfullscreenerror",fe,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Xn.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Xn.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Xn.prototype.beginPresent_=function(){},Xn.prototype.endPresent_=function(){},Xn.prototype.submitFrame=function(K){},Xn.prototype.getEyeParameters=function(K){return null};var wr={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},Vi={LEFT:"left",RIGHT:"right"};function Wi(K){var te=sn({},wr);K=sn(te,K||{}),Xn.call(this,{wakelock:K.MOBILE_WAKE_LOCK}),this.config=K,this.displayName="Cardboard VRDisplay",this.capabilities=new gi({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new et(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new er(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Yn(this.dpdb_.getDeviceParams(),K.ADDITIONAL_VIEWERS),this.viewerSelector_=new tn(K.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new ot),D()&&window.addEventListener("resize",this.onResize_.bind(this))}return Wi.prototype=Object.create(Xn.prototype),Wi.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Wi.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Wi.prototype._getFieldOfView=function(K){var te;if(K==Vi.LEFT)te=this.deviceInfo_.getFieldOfViewLeftEye();else if(K==Vi.RIGHT)te=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",K),null;return te},Wi.prototype._getEyeOffset=function(K){var te;if(K==Vi.LEFT)te=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(K==Vi.RIGHT)te=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",K),null;return te},Wi.prototype.getEyeParameters=function(K){var te=this._getEyeOffset(K),fe=this._getFieldOfView(K),_e={offset:te,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(_e,"fieldOfView",{enumerable:!0,get:function(){return ge("VRFieldOfView","VRFrameData's projection matrices"),fe}}),_e},Wi.prototype.onDeviceParamsUpdated_=function(K){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(K),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Wi.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Wi.prototype.beginPresent_=function(){var K=this.layer_.source.getContext("webgl");K||(K=this.layer_.source.getContext("experimental-webgl")),K||(K=this.layer_.source.getContext("webgl2")),K&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(K.canvas.width=Ce()*this.bufferScale_,K.canvas.height=ke()*this.bufferScale_,this.cardboardUI_=new Un(K)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new Un(K)),this.distorter_=new J(K,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(te){this.viewerSelector_.show(this.layer_.source.parentElement),te.stopPropagation(),te.preventDefault()}.bind(this),function(te){this.exitPresent(),te.stopPropagation(),te.preventDefault()}.bind(this)),this.rotateInstructions_&&(ue()&&Jt()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Wi.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Wi.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Wi.prototype.submitFrame=function(K){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var te=this.layer_.source.getContext("webgl");te||(te=this.layer_.source.getContext("experimental-webgl")),te||(te=this.layer_.source.getContext("webgl2"));var fe=te.canvas;(fe.width!=this.lastWidth||fe.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=fe.width,this.lastHeight=fe.height,this.cardboardUI_.render()}},Wi.prototype.onOrientationChange_=function(K){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Wi.prototype.onResize_=function(K){if(this.layer_){var te=this.layer_.source.getContext("webgl");te||(te=this.layer_.source.getContext("experimental-webgl")),te||(te=this.layer_.source.getContext("webgl2"));var fe=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];te.canvas.setAttribute("style",fe.join("; ")+";"),Se(te.canvas)}},Wi.prototype.onViewerChanged_=function(K){this.deviceInfo_.setViewer(K),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Wi.prototype.fireVRDisplayDeviceParamsChange_=function(){var K=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(K)},Wi.VRFrameData=Vn,Wi.VRDisplay=Xn,Wi})}),v=h(x),A="0.10.12",_={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function E(R){this.config=g(g({},_),R),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&d())&&(this.enable(),this.getVRDisplays().then(function(L){L&&L[0]&&L[0].fireVRDisplayConnect_&&L[0].fireVRDisplayConnect_()}))}E.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(d()){var R=new v({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(R)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},E.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var R=this.native.VRFrameData,L=new this.native.VRFrameData,I=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(N){if(N instanceof R){I.call(this,N);return}I.call(this,L),N.pose=L.pose,m(L.leftProjectionMatrix,N.leftProjectionMatrix),m(L.rightProjectionMatrix,N.rightProjectionMatrix),m(L.leftViewMatrix,N.leftViewMatrix),m(L.rightViewMatrix,N.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=v.VRDisplay,window.VRFrameData=v.VRFrameData},E.prototype.getVRDisplays=function(){var R=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(L){return L.length>0?L:R.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},E.version=A,E.VRFrameData=v.VRFrameData,E.VRDisplay=v.VRDisplay;var w=Object.freeze({default:E}),S=w&&E||w;typeof u<"u"&&u.window&&(u.document||(u.document=u.window.document),u.navigator||(u.navigator=u.window.navigator));var T=S;return T})}).call(this,typeof ks<"u"?ks:typeof self<"u"?self:typeof window<"u"?window:{})},{}],70:[function(i,o,l){var a=/\n/,u=`
`,h=/\s/;o.exports=function(v,A){var _=o.exports.lines(v,A);return _.map(function(E){return v.substring(E.start,E.end)}).join(`
`)},o.exports.lines=function(A,_){if(_=_||{},_.width===0&&_.mode!=="nowrap")return[];A=A||"";var E=typeof _.width=="number"?_.width:Number.MAX_VALUE,w=Math.max(0,_.start||0),S=typeof _.end=="number"?_.end:A.length,T=_.mode,R=_.measure||x;return T==="pre"?m(R,A,w,S,E):g(R,A,w,S,E,T)};function f(v,A,_,E){var w=v.indexOf(A,_);return w===-1||w>E?E:w}function d(v){return h.test(v)}function m(v,A,_,E,w){for(var S=[],T=_,R=_;R<E&&R<A.length;R++){var L=A.charAt(R),I=a.test(L);if(I||R===E-1){var N=I?R:R+1,B=v(A,T,N,w);S.push(B),T=R+1}}return S}function g(v,A,_,E,w,S){var T=[],R=w;for(S==="nowrap"&&(R=Number.MAX_VALUE);_<E&&_<A.length;){for(var L=f(A,u,_,E);_<L&&d(A.charAt(_));)_++;var I=v(A,_,L,R),N=_+(I.end-I.start),B=N+u.length;if(N<L){for(;N>_&&!d(A.charAt(N));)N--;if(N===_)B>_+u.length&&B--,N=B;else for(B=N;N>_&&d(A.charAt(N-u.length));)N--}if(N>=_){var H=v(A,_,N,R);T.push(H)}_=B}return T}function x(v,A,_,E){var w=Math.min(E,_-A);return{start:A,end:A+w}}},{}],71:[function(i,o,l){var a=i("global/window"),u=i("is-function"),h=i("parse-headers"),f=i("xtend");o.exports=x,o.exports.default=x,x.XMLHttpRequest=a.XMLHttpRequest||_,x.XDomainRequest="withCredentials"in new x.XMLHttpRequest?x.XMLHttpRequest:a.XDomainRequest,d(["get","put","post","patch","head","delete"],function(E){x[E==="delete"?"del":E]=function(w,S,T){return S=g(w,S,T),S.method=E.toUpperCase(),v(S)}});function d(E,w){for(var S=0;S<E.length;S++)w(E[S])}function m(E){for(var w in E)if(E.hasOwnProperty(w))return!1;return!0}function g(E,w,S){var T=E;return u(w)?(S=w,typeof E=="string"&&(T={uri:E})):T=f(w,{uri:E}),T.callback=S,T}function x(E,w,S){return w=g(E,w,S),v(w)}function v(E){if(typeof E.callback>"u")throw new Error("callback argument missing");var w=!1,S=function(ie,se,ue){w||(w=!0,E.callback(ie,se,ue))};function T(){N.readyState===4&&setTimeout(I,0)}function R(){var Z=void 0;if(N.response?Z=N.response:Z=N.responseText||A(N),k)try{Z=JSON.parse(Z)}catch{}return Z}function L(Z){return clearTimeout(z),Z instanceof Error||(Z=new Error(""+(Z||"Unknown XMLHttpRequest Error"))),Z.statusCode=0,S(Z,X)}function I(){if(!H){var Z;clearTimeout(z),E.useXDR&&N.status===void 0?Z=200:Z=N.status===1223?204:N.status;var ie=X,se=null;return Z!==0?(ie={body:R(),statusCode:Z,method:le,headers:{},url:q,rawRequest:N},N.getAllResponseHeaders&&(ie.headers=h(N.getAllResponseHeaders()))):se=new Error("Internal XMLHttpRequest Error"),S(se,ie,ie.body)}}var N=E.xhr||null;N||(E.cors||E.useXDR?N=new x.XDomainRequest:N=new x.XMLHttpRequest);var B,H,q=N.url=E.uri||E.url,le=N.method=E.method||"GET",ne=E.body||E.data,D=N.headers=E.headers||{},O=!!E.sync,k=!1,z,X={body:void 0,headers:{},statusCode:0,method:le,url:q,rawRequest:N};if("json"in E&&E.json!==!1&&(k=!0,D.accept||D.Accept||(D.Accept="application/json"),le!=="GET"&&le!=="HEAD"&&(D["content-type"]||D["Content-Type"]||(D["Content-Type"]="application/json"),ne=JSON.stringify(E.json===!0?ne:E.json))),N.onreadystatechange=T,N.onload=I,N.onerror=L,N.onprogress=function(){},N.onabort=function(){H=!0},N.ontimeout=L,N.open(le,q,!O,E.username,E.password),O||(N.withCredentials=!!E.withCredentials),!O&&E.timeout>0&&(z=setTimeout(function(){if(!H){H=!0,N.abort("timeout");var Z=new Error("XMLHttpRequest timeout");Z.code="ETIMEDOUT",L(Z)}},E.timeout)),N.setRequestHeader)for(B in D)D.hasOwnProperty(B)&&N.setRequestHeader(B,D[B]);else if(E.headers&&!m(E.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in E&&(N.responseType=E.responseType),"beforeSend"in E&&typeof E.beforeSend=="function"&&E.beforeSend(N),N.send(ne||null),N}function A(E){try{if(E.responseType==="document")return E.responseXML;var w=E.responseXML&&E.responseXML.documentElement.nodeName==="parsererror";if(E.responseType===""&&!w)return E.responseXML}catch{}return null}function _(){}},{"global/window":27,"is-function":33,"parse-headers":47,xtend:73}],72:[function(i,o,l){o.exports=function(){return typeof self.DOMParser<"u"?function(u){var h=new self.DOMParser;return h.parseFromString(u,"application/xml")}:typeof self.ActiveXObject<"u"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(u){var h=new self.ActiveXObject("Microsoft.XMLDOM");return h.async="false",h.loadXML(u),h}:function(u){var h=document.createElement("div");return h.innerHTML=u,h}}()},{}],73:[function(i,o,l){o.exports=u;var a=Object.prototype.hasOwnProperty;function u(){for(var h={},f=0;f<arguments.length;f++){var d=arguments[f];for(var m in d)a.call(d,m)&&(h[m]=d[m])}return h}},{}],74:[function(i,o,l){o.exports={name:"aframe",version:"1.3.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 1.1.0 1.2.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.137.0","three-bmfont-text":"dmarcos/three-bmfont-text#21d017046216e318362c48abd1a48bddfb6e0733","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:">= 2.15.9"}}},{}],75:[function(i,o,l){var a=i("super-animejs"),u=i("../core/component").components,h=i("../core/component").registerComponent,f=i("../lib/three"),d=i("../utils"),m=new f.Color,g=new f.Color,x=d.entity.getComponentProperty,v=d.entity.setComponentProperty,A={},_="color",E="position",w="rotation",S="scale",T="components",R="object3D";o.exports.Component=h("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(D){return D===!0||D==="true"?!0:D===!1||D==="false"?!1:parseInt(D,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var D=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){D.animationIsPlaying=!1,D.el.emit("animationcomplete",D.eventDetail,!1),D.id&&D.el.emit("animationcomplete__"+D.id,D.eventDetail,!1)}}},update:function(D){var O=this.config,k=this.data;this.animationIsPlaying=!1,this.data.enabled&&(!k.property||(O.autoplay=!1,O.direction=k.dir,O.duration=k.dur,O.easing=k.easing,O.elasticity=k.elasticity,O.loop=k.loop,O.round=k.round,this.createAndStartAnimation()))},tick:function(D,O){!this.animationIsPlaying||(this.time+=O,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){!this.paused||(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var D=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=a(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!D.autoplay||D.startEvents&&D.startEvents.length)){if(D.delay){setTimeout(this.beginAnimation,D.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(!!this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=a(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var D=this.config,O=this.data,k=this.el,z,X,Z;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){z=O.from===""?H(k,O.property):O.from,Z=O.to,this.setColorConfig(z,Z),z=this.fromColor,Z=this.toColor,this.targetsArray.length=0,this.targetsArray.push(z),D.targets=this.targetsArray;for(X in Z)D[X]=Z[X];D.update=function(){var ie={};return function(se){var ue;ue=se.animatables[0].target,!(ue.r===ie.r&&ue.g===ie.g&&ue.b===ie.b)&&q(k,O.property,ue,O.type)}}()}},updateConfigForDefault:function(){var D=this.config,O=this.data,k=this.el,z,X,Z,ie;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(O.from===""?z=ne(O)?H(k,O.property):x(k,O.property):z=O.from,ie=O.to,Z=!isNaN(z||ie),Z?(z=parseFloat(z),ie=parseFloat(ie)):(z=z&&z.toString(),ie=ie&&ie.toString()),X=O.to==="true"||O.to==="false"||O.to===!0||O.to===!1,X&&(z=O.from==="true"||O.from===!0?1:0,ie=O.to==="true"||O.to===!0?1:0),this.targets.aframeProperty=z,D.targets=this.targets,D.aframeProperty=ie,D.update=function(){var se;return function(ue){var ye;ye=ue.animatables[0].target.aframeProperty,ye!==se&&(se=ye,X&&(ye=ye>=1),ne(O)?q(k,O.property,ye,O.type):v(k,O.property,ye))}}())},updateConfigForVector:function(){var D=this.config,O=this.data,k=this.el,z,X,Z;X=O.from!==""?d.coordinates.parse(O.from):x(k,O.property),Z=d.coordinates.parse(O.to),O.property===w&&(I(X),I(Z)),this.targetsArray.length=0,this.targetsArray.push(X),D.targets=this.targetsArray;for(z in Z)D[z]=Z[z];if(O.property===E||O.property===w||O.property===S){D.update=function(){var ie={};return function(se){var ue=se.animatables[0].target;O.property===S&&(ue.x=Math.max(1e-4,ue.x),ue.y=Math.max(1e-4,ue.y),ue.z=Math.max(1e-4,ue.z)),!(ue.x===ie.x&&ue.y===ie.y&&ue.z===ie.z)&&(ie.x=ue.x,ie.y=ue.y,ie.z=ue.z,k.object3D[O.property].set(ue.x,ue.y,ue.z))}}();return}D.update=function(){var ie={};return function(se){var ue=se.animatables[0].target;ue.x===ie.x&&ue.y===ie.y&&ue.z===ie.z||(ie.x=ue.x,ie.y=ue.y,ie.z=ue.z,v(k,O.property,ue))}}()},updateConfig:function(){var D;D=L(this.el,this.data.property),ne(this.data)&&this.data.type===_?this.updateConfigForRawColor():D==="vec2"||D==="vec3"||D==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(D){var O,k=this.data,z=this.el,X=this;return k.from!==""||!k.property.startsWith(T)||(O=le(k.property)[1],z.components[O])?!1:(z.addEventListener("componentinitialized",function Z(ie){ie.detail.name===O&&(D(),X.animation=a(X.config),z.removeEventListener("componentinitialized",Z))}),!0)},stopRelatedAnimations:function(){var D,O;for(O in this.el.components)D=this.el.components[O],O!==this.attrName&&D.name==="animation"&&(!D.animationIsPlaying||D.data.property===this.data.property&&(D.animationIsPlaying=!1))},addEventListeners:function(){var D=this.data,O=this.el;N(O,D.startEvents,this.onStartEvent),N(O,D.pauseEvents,this.pauseAnimation),N(O,D.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var D=this.data,O=this.el;B(O,D.startEvents,this.onStartEvent),B(O,D.pauseEvents,this.pauseAnimation),B(O,D.resumeEvents,this.resumeAnimation)},setColorConfig:function(D,O){m.set(D),g.set(O),D=this.fromColor,O=this.toColor,D.r=m.r,D.g=m.g,D.b=m.b,O.r=g.r,O.g=g.g,O.b=g.b}});function L(D,O){var k,z,X,Z;return X=O.split("."),z=X[0],Z=X[1],k=D.components[z]||u[z],!k||Z&&!k.schema[Z]?null:Z?k.schema[Z].type:k.schema.type}function I(D){D.x=f.Math.degToRad(D.x),D.y=f.Math.degToRad(D.y),D.z=f.Math.degToRad(D.z)}function N(D,O,k){var z;for(z=0;z<O.length;z++)D.addEventListener(O[z],k)}function B(D,O,k){var z;for(z=0;z<O.length;z++)D.removeEventListener(O[z],k)}function H(D,O){var k,z,X;for(z=le(O),X=D,k=0;k<z.length;k++)X=X[z[k]];if(X===void 0)throw console.log(D),new Error("[animation] property ("+O+") could not be found");return X}function q(D,O,k,z){var X,Z,ie,se;for(O.startsWith("object3D.rotation")&&(k=f.Math.degToRad(k)),Z=le(O),se=D,X=0;X<Z.length-1;X++)se=se[Z[X]];if(ie=Z[Z.length-1],z===_){"r"in se[ie]?(se[ie].r=k.r,se[ie].g=k.g,se[ie].b=k.b):(se[ie].x=k.r,se[ie].y=k.g,se[ie].z=k.b);return}se[ie]=k}function le(D){return D in A||(A[D]=D.split(".")),A[D]}function ne(D){return D.isRawProperty||D.property.startsWith(T)||D.property.startsWith(R)}},{"../core/component":136,"../lib/three":184,"../utils":212,"super-animejs":56}],76:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../lib/three");o.exports.Component=a("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var h,f=this.el;h=this.camera=new u.PerspectiveCamera,f.setObject3D("camera",h)},update:function(h){var f=this.data,d=this.camera;d.aspect=f.aspect||window.innerWidth/window.innerHeight,d.far=f.far,d.fov=f.fov,d.near=f.near,d.zoom=f.zoom,d.updateProjectionMatrix(),this.updateActiveCamera(h),this.updateSpectatorCamera(h)},updateActiveCamera:function(h){var f=this.data,d=this.el,m=this.system;h&&h.active===f.active||f.spectator||(f.active&&m.activeCameraEl!==d?m.setActiveCamera(d):!f.active&&m.activeCameraEl===d&&m.disableActiveCamera())},updateSpectatorCamera:function(h){var f=this.data,d=this.el,m=this.system;h&&h.spectator===f.spectator||(f.spectator&&m.spectatorCameraEl!==d?m.setSpectatorCamera(d):!f.spectator&&m.spectatorCameraEl===d&&m.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":136,"../lib/three":184}],77:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/"),h=u.bind,f={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},d={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},m={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},g={DOWN:["selectstart"],UP:["selectend"]},x="a-mouse-cursor-hover";o.exports.Component=a("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:u.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var v=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.updateCanvasBounds=u.debounce(function(){v.canvasBounds=v.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=h(this.onCursorDown,this),this.onCursorUp=h(this.onCursorUp,this),this.onIntersection=h(this.onIntersection,this),this.onIntersectionCleared=h(this.onIntersectionCleared,this),this.onMouseMove=h(this.onMouseMove,this),this.onEnterVR=h(this.onEnterVR,this)},update:function(v){this.data.rayOrigin!==v.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var v=this.el;v.removeState(d.HOVERING),v.removeState(d.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(d.HOVERED),this.removeEventListeners()},addEventListeners:function(){var v,A=this.data,_=this.el,E=this;function w(){v=_.sceneEl.canvas,!(A.downEvents.length||A.upEvents.length)&&(m.DOWN.forEach(function(S){v.addEventListener(S,E.onCursorDown)}),m.UP.forEach(function(S){v.addEventListener(S,E.onCursorUp)}))}v=_.sceneEl.canvas,v?w():_.sceneEl.addEventListener("render-target-loaded",w),A.downEvents.forEach(function(S){_.addEventListener(S,E.onCursorDown)}),A.upEvents.forEach(function(S){_.addEventListener(S,E.onCursorUp)}),_.addEventListener("raycaster-intersection",this.onIntersection),_.addEventListener("raycaster-closest-entity-changed",this.onIntersection),_.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),_.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),_.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var v,A=this.data,_=this.el,E=this;v=_.sceneEl.canvas,v&&!A.downEvents.length&&!A.upEvents.length&&(m.DOWN.forEach(function(w){v.removeEventListener(w,E.onCursorDown)}),m.UP.forEach(function(w){v.removeEventListener(w,E.onCursorUp)})),A.downEvents.forEach(function(w){_.removeEventListener(w,E.onCursorDown)}),A.upEvents.forEach(function(w){_.removeEventListener(w,E.onCursorUp)}),_.removeEventListener("raycaster-intersection",this.onIntersection),_.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),v.removeEventListener("mousemove",this.onMouseMove),v.removeEventListener("touchstart",this.onMouseMove),v.removeEventListener("touchmove",this.onMouseMove),_.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),_.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var v,A=this.el;v=A.sceneEl.canvas,v.removeEventListener("mousemove",this.onMouseMove),v.removeEventListener("touchmove",this.onMouseMove),A.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(v.addEventListener("mousemove",this.onMouseMove,!1),v.addEventListener("touchmove",this.onMouseMove,!1),A.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var v=new THREE.Vector3,A=new THREE.Vector2,_=new THREE.Vector3,E={origin:_,direction:v};return function(w){var S=this.canvasBounds,T=this.el.sceneEl.camera,R,L,I;T.parent.updateMatrixWorld(),w.type==="touchmove"||w.type==="touchstart"?L=w.touches.item(0):L=w,R=L.clientX-S.left,I=L.clientY-S.top,A.x=R/S.width*2-1,A.y=-(I/S.height)*2+1,T&&T.isPerspectiveCamera?(_.setFromMatrixPosition(T.matrixWorld),v.set(A.x,A.y,.5).unproject(T).sub(_).normalize()):T&&T.isOrthographicCamera?(_.set(A.x,A.y,(T.near+T.far)/(T.near-T.far)).unproject(T),v.set(0,0,-1).transformDirection(T.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+T.type),this.el.setAttribute("raycaster",E),w.type==="touchmove"&&w.preventDefault()}}(),onCursorDown:function(v){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&v.type==="touchstart"&&(this.onMouseMove(v),this.el.components.raycaster.checkIntersections(),v.preventDefault()),this.twoWayEmit(f.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(v){if(!!this.isCursorDown){this.isCursorDown=!1;var A=this.data;this.twoWayEmit(f.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(f.MOUSEUP,this.intersectedEventDetail)),(!A.fuse||A.rayOrigin==="mouse")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(f.CLICK),this.cursorDownEl=null,v.type==="touchend"&&v.preventDefault()}},onIntersection:function(v){var A,_=this.el,E,w,S;E=v.detail.els[0]===_?1:0,S=v.detail.intersections[E],w=v.detail.els[E],!!w&&this.intersectedEl!==w&&(this.intersectedEl&&(A=this.el.components.raycaster.getIntersection(this.intersectedEl),A&&A.distance<=S.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(w,S)))},onIntersectionCleared:function(v){var A=v.detail.clearedEls;A.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var v=this.el.sceneEl.xrSession,A=this;!v||this.data.rayOrigin!=="mouse"&&(g.DOWN.forEach(function(_){v.addEventListener(_,A.onCursorDown)}),g.UP.forEach(function(_){v.addEventListener(_,A.onCursorUp)}))},setIntersection:function(v,A){var _=this.el,E=this.data,w=this;this.intersectedEl!==v&&(this.intersectedEl=v,_.addState(d.HOVERING),v.addState(d.HOVERED),this.twoWayEmit(f.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(x),!(E.fuseTimeout===0||!E.fuse)&&(_.addState(d.FUSING),this.twoWayEmit(f.FUSING),this.fuseTimeout=setTimeout(function(){_.removeState(d.FUSING),w.twoWayEmit(f.CLICK)},E.fuseTimeout)))},clearCurrentIntersection:function(v){var A,_,E,w=this.el;!this.intersectedEl||(this.intersectedEl.removeState(d.HOVERED),w.removeState(d.HOVERING),w.removeState(d.FUSING),this.twoWayEmit(f.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(x),this.intersectedEl=null,clearTimeout(this.fuseTimeout),v!==!0&&(E=this.el.components.raycaster.intersections,E.length!==0&&(A=E[0].object.el===w?1:0,_=E[A],_&&this.setIntersection(_.object.el,_))))},twoWayEmit:function(v){var A=this.el,_=this.intersectedEl,E;E=this.el.components.raycaster.getIntersection(_),this.eventDetail.intersectedEl=_,this.eventDetail.intersection=E,A.emit(v,this.eventDetail),_&&(this.intersectedEventDetail.intersection=E,_.emit(v,this.intersectedEventDetail))}})},{"../core/component":136,"../utils/":212}],78:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g="https://cdn.aframe.io/controllers/google/",x=g+"vr_controller_daydream.obj",v=g+"vr_controller_daydream.mtl",A=i("../utils/").device.isWebXRAvailable,_="google-daydream",E="Daydream Controller",w=A?_:E,S={axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},T={axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]},R=A?T:S;o.exports.Component=a("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:R,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var L=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(I){m(I.detail.id,"down",L)},this.onButtonUp=function(I){m(I.detail.id,"up",L)},this.onButtonTouchStart=function(I){m(I.detail.id,"touchstart",L)},this.onButtonTouchEnd=function(I){m(I.detail.id,"touchend",L)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("model-loaded",this.onModelLoaded),L.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("model-loaded",this.onModelLoaded),L.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var L=this.el,I=this.data;L.setAttribute("tracked-controls",{armModel:I.armModel,hand:I.hand,idPrefix:w,id:w,orientationOffset:I.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:x,mtl:v})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(L){var I=L.detail.model,N;!this.data.model||(N=this.buttonMeshes={},N.menu=I.getObjectByName("AppButton_AppButton_Cylinder.004"),N.system=I.getObjectByName("HomeButton_HomeButton_Cylinder.005"),N.trackpad=I.getObjectByName("TouchPad_TouchPad_Cylinder.003"),N.touchpad=I.getObjectByName("TouchPad_TouchPad_Cylinder.003"),I.position.set(0,0,-.04))},onAxisMoved:function(L){d(this,this.mapping.axes,L)},onButtonChanged:function(L){var I=this.mapping.buttons[L.detail.id];!I||this.el.emit(I+"changed",L.detail.state)},updateModel:function(L,I){!this.data.model||this.updateButtonModel(L,I)},updateButtonModel:function(L,I){var N=this.buttonMeshes;if(!(!N||!N[L])){var B;switch(I){case"down":B=this.data.buttonHighlightColor;break;case"touchstart":B=this.data.buttonTouchedColor;break;default:B=this.data.buttonColor}N[L].material.color.set(B)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],79:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g=i("../utils/").device.isWebXRAvailable,x="https://cdn.aframe.io/controllers/samsung/",v=x+"gear_vr_controller.obj",A=x+"gear_vr_controller.mtl",_="samsung-gearvr",E="Gear VR",w=g?_:E,S={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},T={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},R=g?T:S;o.exports.Component=a("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:R,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var L=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(I){m(I.detail.id,"down",L)},this.onButtonUp=function(I){m(I.detail.id,"up",L)},this.onButtonTouchStart=function(I){m(I.detail.id,"touchstart",L)},this.onButtonTouchEnd=function(I){m(I.detail.id,"touchend",L)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var L=this.el;L.addEventListener("buttonchanged",this.onButtonChanged),L.addEventListener("buttondown",this.onButtonDown),L.addEventListener("buttonup",this.onButtonUp),L.addEventListener("touchstart",this.onButtonTouchStart),L.addEventListener("touchend",this.onButtonTouchEnd),L.addEventListener("model-loaded",this.onModelLoaded),L.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var L=this.el;L.removeEventListener("buttonchanged",this.onButtonChanged),L.removeEventListener("buttondown",this.onButtonDown),L.removeEventListener("buttonup",this.onButtonUp),L.removeEventListener("touchstart",this.onButtonTouchStart),L.removeEventListener("touchend",this.onButtonTouchEnd),L.removeEventListener("model-loaded",this.onModelLoaded),L.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,w,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var L=this.el,I=this.data;L.setAttribute("tracked-controls",{armModel:I.armModel,hand:I.hand,idPrefix:w,id:w,orientationOffset:I.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:v,mtl:A})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(L){var I=L.detail.model,N;!this.data.model||(N=this.buttonMeshes={},N.trigger=I.children[2],N.trackpad=I.children[1],N.touchpad=I.children[1])},onButtonChanged:function(L){var I=this.mapping.buttons[L.detail.id];!I||this.el.emit(I+"changed",L.detail.state)},onAxisMoved:function(L){d(this,this.mapping.axes,L)},updateModel:function(L,I){!this.data.model||this.updateButtonModel(L,I)},updateButtonModel:function(L,I){var N=this.buttonMeshes;if(!(!N||!N[L])){var B;switch(I){case"down":B=this.data.buttonHighlightColor;break;case"touchstart":B=this.data.buttonTouchedColor;break;default:B=this.data.buttonColor}N[L].material.color.set(B)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],80:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g="generic",x={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};o.exports.Component=a("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:x,bindMethods:function(){this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var v=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(A){m(A.detail.id,"down",v)},this.onButtonUp=function(A){m(A.detail.id,"up",v)},this.onButtonTouchStart=function(A){m(A.detail.id,"touchstart",v)},this.onButtonTouchEnd=function(A){m(A.detail.id,"touchend",v)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.el.addEventListener("controllerconnected",function(A){A.detail.name!==v.name&&(v.wasControllerConnected=!0,v.removeEventListeners(),v.removeControllersUpdateListener())})},addEventListeners:function(){var v=this.el;v.addEventListener("buttonchanged",this.onButtonChanged),v.addEventListener("buttondown",this.onButtonDown),v.addEventListener("buttonup",this.onButtonUp),v.addEventListener("touchstart",this.onButtonTouchStart),v.addEventListener("touchend",this.onButtonTouchEnd),v.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var v=this.el;v.removeEventListener("buttonchanged",this.onButtonChanged),v.removeEventListener("buttondown",this.onButtonDown),v.removeEventListener("buttonup",this.onButtonUp),v.removeEventListener("touchstart",this.onButtonTouchStart),v.removeEventListener("touchend",this.onButtonTouchEnd),v.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var v=this.data,A=v.hand?v.hand:void 0;f(this,g,{hand:A,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var v=this.el,A=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}v.setAttribute("tracked-controls",{hand:A.hand,idPrefix:g,orientationOffset:A.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(v){var A=this.mapping.buttons[v.detail.id];!A||this.el.emit(A+"changed",v.detail.state)},onAxisMoved:function(v){d(this,this.mapping.axes,v)},initDefaultModel:function(){var v=this.modelEl=document.createElement("a-entity");v.setAttribute("geometry",{primitive:"sphere",radius:.03}),v.setAttribute("material",{color:this.data.color}),this.el.appendChild(v)}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],81:[function(i,o,l){var a=i("../core/geometry").geometries,u=i("../core/geometry").geometryNames,h=i("../core/component").registerComponent,f=i("../lib/three"),d=new f.BufferGeometry;o.exports.Component=h("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:u,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(m){var g=this.data,x=this.el,v,A=this.system;this.geometry&&(A.unuseGeometry(m),this.geometry=null),this.geometry=A.getOrCreateGeometry(g),v=x.getObject3D("mesh"),v?v.geometry=this.geometry:(v=new f.Mesh,v.geometry=this.geometry,this.el.getAttribute("material")||(v.material=new f.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),x.setObject3D("mesh",v))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=d,this.geometry=null},updateSchema:function(m){var g=this.oldData&&this.oldData.primitive,x=m.primitive,v=a[x]&&a[x].schema;if(!v)throw new Error("Unknown geometry schema `"+x+"`");g&&g===x||this.extendSchema(v)}})},{"../core/component":136,"../core/geometry":137,"../lib/three":184}],82:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../lib/three"),h=i("../utils/"),f=h.debug("components:gltf-model:warn");o.exports.Component=a("gltf-model",{schema:{type:"model"},init:function(){var d=this,m=this.system.getDRACOLoader(),g=this.system.getMeshoptDecoder();this.model=null,this.loader=new u.GLTFLoader,m&&this.loader.setDRACOLoader(m),g?this.ready=g.then(function(x){d.loader.setMeshoptDecoder(x)}):this.ready=Promise.resolve()},update:function(){var d=this,m=this.el,g=this.data;!g||(this.remove(),this.ready.then(function(){d.loader.load(g,function(v){d.model=v.scene||v.scenes[0],d.model.animations=v.animations,m.setObject3D("mesh",d.model),m.emit("model-loaded",{format:"gltf",model:d.model})},void 0,function(v){var A=v&&v.message?v.message:"Failed to load glTF model";f(A),m.emit("model-error",{format:"gltf",src:g})})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}})},{"../core/component":136,"../lib/three":184,"../utils/":212}],83:[function(i,o,l){var a=i("../core/component").registerComponent,u={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},h={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},f={};f[h.fist]="grip",f[h.thumbUp]="pistol",f[h.point]="pointing",o.exports.Component=a("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var g=this,x=this.el;this.gesture=h.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){g.handleButton("grip","down")},this.onGripUp=function(){g.handleButton("grip","up")},this.onTrackpadDown=function(){g.handleButton("trackpad","down")},this.onTrackpadUp=function(){g.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){g.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){g.handleButton("trackpad","touchend")},this.onTriggerDown=function(){g.handleButton("trigger","down")},this.onTriggerUp=function(){g.handleButton("trigger","up")},this.onTriggerTouchStart=function(){g.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){g.handleButton("trigger","touchend")},this.onGripTouchStart=function(){g.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){g.handleButton("grip","touchend")},this.onThumbstickDown=function(){g.handleButton("thumbstick","down")},this.onThumbstickUp=function(){g.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){g.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){g.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){g.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){g.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){g.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){g.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),x.addEventListener("controllerconnected",this.onControllerConnected),x.addEventListener("controllerdisconnected",this.onControllerDisconnected),x.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(g,x){var v=this.el.getObject3D("mesh");!v||!v.mixer||v.mixer.update(x/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var g=this.el;g.addEventListener("gripdown",this.onGripDown),g.addEventListener("gripup",this.onGripUp),g.addEventListener("trackpaddown",this.onTrackpadDown),g.addEventListener("trackpadup",this.onTrackpadUp),g.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),g.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),g.addEventListener("triggerdown",this.onTriggerDown),g.addEventListener("triggerup",this.onTriggerUp),g.addEventListener("triggertouchstart",this.onTriggerTouchStart),g.addEventListener("triggertouchend",this.onTriggerTouchEnd),g.addEventListener("griptouchstart",this.onGripTouchStart),g.addEventListener("griptouchend",this.onGripTouchEnd),g.addEventListener("thumbstickdown",this.onThumbstickDown),g.addEventListener("thumbstickup",this.onThumbstickUp),g.addEventListener("abuttontouchstart",this.onAorXTouchStart),g.addEventListener("abuttontouchend",this.onAorXTouchEnd),g.addEventListener("bbuttontouchstart",this.onBorYTouchStart),g.addEventListener("bbuttontouchend",this.onBorYTouchEnd),g.addEventListener("xbuttontouchstart",this.onAorXTouchStart),g.addEventListener("xbuttontouchend",this.onAorXTouchEnd),g.addEventListener("ybuttontouchstart",this.onBorYTouchStart),g.addEventListener("ybuttontouchend",this.onBorYTouchEnd),g.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),g.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var g=this.el;g.removeEventListener("gripdown",this.onGripDown),g.removeEventListener("gripup",this.onGripUp),g.removeEventListener("trackpaddown",this.onTrackpadDown),g.removeEventListener("trackpadup",this.onTrackpadUp),g.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),g.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),g.removeEventListener("triggerdown",this.onTriggerDown),g.removeEventListener("triggerup",this.onTriggerUp),g.removeEventListener("triggertouchstart",this.onTriggerTouchStart),g.removeEventListener("triggertouchend",this.onTriggerTouchEnd),g.removeEventListener("griptouchstart",this.onGripTouchStart),g.removeEventListener("griptouchend",this.onGripTouchEnd),g.removeEventListener("thumbstickdown",this.onThumbstickDown),g.removeEventListener("thumbstickup",this.onThumbstickUp),g.removeEventListener("abuttontouchstart",this.onAorXTouchStart),g.removeEventListener("abuttontouchend",this.onAorXTouchEnd),g.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),g.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),g.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),g.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),g.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),g.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),g.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),g.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(g){var x,v=this.el,A=this.data.hand,_=this.data.handModelStyle,E=this.data.color,w=this;if(x={hand:A,model:!1},A!==g){var S=u[_+A.charAt(0).toUpperCase()+A.slice(1)];this.loader.load(S,function(T){var R=T.scene.children[0],L=A==="left"?Math.PI/2:-Math.PI/2;R.mixer=new THREE.AnimationMixer(R),w.clips=T.animations,v.setObject3D("mesh",R);var I=R.children[1].material;I.color=new THREE.Color(E),R.position.set(0,0,0),R.rotation.set(0,0,L),v.setAttribute("magicleap-controls",x),v.setAttribute("vive-controls",x),v.setAttribute("oculus-touch-controls",x),v.setAttribute("windows-motion-controls",x),v.setAttribute("hp-mixed-reality-controls",x)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(g,x){var v,A=x==="down",_=x==="touchstart";if(x.indexOf("touch")===0){if(_===this.touchedButtons[g])return;this.touchedButtons[g]=_}else{if(A===this.pressedButtons[g])return;this.pressedButtons[g]=A}v=this.gesture,this.gesture=this.determineGesture(),this.gesture!==v&&(this.animateGesture(this.gesture,v),this.emitGestureEvents(this.gesture,v))},determineGesture:function(){var g,x=this.pressedButtons.grip,v=this.pressedButtons.surface||this.touchedButtons.surface,A=this.pressedButtons.trackpad||this.touchedButtons.trackpad,_=this.pressedButtons.trigger||this.touchedButtons.trigger,E=this.touchedButtons.AorX||this.touchedButtons.BorY,w=m(this.el.components["tracked-controls"]);return w?x||_?g=h.fist:A&&(g=h.point):x?v||E||A?g=_?h.fist:h.point:g=_?h.thumbUp:h.pointThumb:_&&(g=h.hold),g},getClip:function(g){var x,v;for(v=0;v<this.clips.length;v++)if(x=this.clips[v],x.name===g)return x},animateGesture:function(g,x){if(g){this.playAnimation(g||h.open,x,!1);return}this.playAnimation(x,x,!0)},emitGestureEvents:function(g,x){var v=this.el,A;x!==g&&(A=d(x,!1),A&&v.emit(A),A=d(g,!0),A&&v.emit(A))},playAnimation:function(g,x,v){var A,_,E=this.el.getObject3D("mesh"),w;if(!!E){if(E.mixer.stopAllAction(),A=this.getClip(g),w=E.mixer.clipAction(A),w.clampWhenFinished=!0,w.loop=THREE.LoopRepeat,w.repetitions=0,w.timeScale=v?-1:1,w.time=v?A.duration:0,w.weight=1,!x||g===x){E.mixer.stopAllAction(),w.play();return}A=this.getClip(x),_=E.mixer.clipAction(A),_.weight=.15,_.play(),w.play(),_.crossFadeTo(w,.15,!0)}}});function d(g,x){var v;if(!!g){if(v=f[g],v==="grip")return v+(x?"close":"open");if(v==="point")return v+(x?"up":"down");if(v==="pointing"||v==="pistol")return v+(x?"start":"end")}}function m(g){var x=g&&g.controller,v=x&&(x.id&&x.id.indexOf("OpenVR ")===0||x.profiles&&x.profiles[0]&&x.profiles[0]==="htc-vive");return v}},{"../core/component":136}],84:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d="https://cdn.aframe.io/controllers/oculus-hands/v3/left.glb",m="https://cdn.aframe.io/controllers/oculus-hands/v3/right.glb",g={left:"b_l_",right:"b_r_"},x=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],v={wrist:"wrist","thumb-metacarpal":"thumb1","thumb-phalanx-proximal":"thumb2","thumb-phalanx-distal":"thumb3","thumb-tip":"thumb_null","index-finger-metacarpal":"index0","index-finger-phalanx-proximal":"index1","index-finger-phalanx-intermediate":"index2","index-finger-phalanx-distal":"index3","index-finger-tip":"index_null","middle-finger-metacarpal":"middle0","middle-finger-phalanx-proximal":"middle1","middle-finger-phalanx-intermediate":"middle2","middle-finger-phalanx-distal":"middle3","middle-finger-tip":"middle_null","ring-finger-metacarpal":"ring0","ring-finger-phalanx-proximal":"ring1","ring-finger-phalanx-intermediate":"ring2","ring-finger-phalanx-distal":"ring3","ring-finger-tip":"ring_null","pinky-finger-metacarpal":"pinky0","pinky-finger-phalanx-proximal":"pinky1","pinky-finger-phalanx-intermediate":"pinky2","pinky-finger-phalanx-distal":"pinky3","pinky-finger-tip":"pinky_null"},A=.015,_=.03,E=.5;o.exports.Component=a("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var w=0;w<this.jointEls.length;++w)this.jointEls[w].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var w=0;w<this.jointEls.length;++w)this.jointEls[w].object3D.visible=!1},init:function(){var w=this.el.sceneEl,S=w.getAttribute("webxr").optionalFeatures;S.push("hand-tracking"),w.setAttribute("webxr",{optionalFeatures:S}),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3},this.indexTipPosition=new THREE.Vector3,this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var w=this,S=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!S){var T=w.el.sceneEl.systems.webxr.sessionReferenceSpaceType;S.requestReferenceSpace(T).then(function(R){w.referenceSpace=R.getOffsetReferenceSpace(new XRRigidTransform({x:0,y:1.5,z:0}))}).catch(function(R){throw w.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(T,"tracked-controls-webxr uses reference space "+T),R})}},checkIfControllerPresent:function(){var w=this.data,S=w.hand?w.hand:void 0;f(this,"",{hand:S,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var w=this.el.sceneEl,S=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T=w.frame,R=this.el.components["tracked-controls-webxr"];!S||!T||!R||S.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),T.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(w){for(var S=this.bones,T=0;T<S.length;T++)if(S[T].name===w)return S[T];return null},updateHandMeshModel:function(){var w=this.el.sceneEl.frame,S=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T=this.referenceSpace;if(!(!S||!this.mesh||!T)){this.mesh.visible=!1;for(var R of S.hand.values()){var L,I,N;I=w.getJointPose(R,T),v[R.jointName]&&(L=this.getBone(g[this.data.hand]+v[R.jointName]),L!=null&&I&&(N=I.transform,this.mesh.visible=!0,L.position.copy(N.position).multiplyScalar(100),L.quaternion.set(N.orientation.x,N.orientation.y,N.orientation.z,N.orientation.w)))}}},updateHandDotsModel:function(){var w=this.el.sceneEl.frame,S=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,T=this.el.components["tracked-controls-webxr"],R=T.system.referenceSpace,L,I,N,B=0;for(var H of S.hand.values())L=this.jointEls[B++],I=L.object3D,N=w.getJointPose(H,R),L.object3D.visible=!!N,N&&(I.matrix.elements=N.transform.matrix,I.matrix.decompose(I.position,I.rotation,I.scale),L.setAttribute("scale",{x:N.radius,y:N.radius,z:N.radius}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var w=new THREE.Vector3;return function(){var S=this.el.sceneEl.frame,T=this.indexTipPosition,R=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,L=this.el.components["tracked-controls-webxr"],I=this.referenceSpace||L.system.referenceSpace,N=R.hand.get("index-finger-tip"),B=R.hand.get("thumb-tip");if(!(!N||!B)){var H=S.getJointPose(N,I),q=S.getJointPose(B,I);if(!(!H||!q)){w.copy(q.transform.position),T.copy(H.transform.position);var le=T.distanceTo(w);le<A&&this.isPinched===!1&&(this.isPinched=!0,this.pinchEventDetail.position.copy(T).lerp(w,E),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),le>_&&this.isPinched===!0&&(this.isPinched=!1,this.pinchEventDetail.position.copy(T).lerp(w,E),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(T).lerp(w,E),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),T.y+=1.5}}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var w=this.el,S=this.data;w.setAttribute("tracked-controls",{hand:S.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var w;this.checkIfControllerPresent(),w=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,!!this.el.getObject3D("mesh")&&(!w||!w.hand||!w.hand[0])&&(this.el.getObject3D("mesh").visible=!1)},initDefaultModel:function(){this.el.getObject3D("mesh")||(this.data.modelStyle==="dots"&&this.initDotsModel(),this.data.modelStyle==="mesh"&&this.initMeshHandModel())},initDotsModel:function(){if(this.jointEls.length===0)for(var w=0;w<x.length;++w){var S=this.jointEl=document.createElement("a-entity");S.setAttribute("geometry",{primitive:"sphere",radius:1}),S.setAttribute("material",{color:this.data.modelColor}),S.object3D.visible=!1,this.el.appendChild(S),this.jointEls.push(S)}},initMeshHandModel:function(){var w=this.data.hand==="left"?d:m;this.el.setAttribute("gltf-model",w)},onModelLoaded:function(){var w=this.mesh=this.el.getObject3D("mesh").children[0],S=this.skinnedMesh=w.children[30];!this.skinnedMesh||(this.bones=S.skeleton.bones,this.el.removeObject3D("mesh"),w.position.set(0,1.5,0),w.rotation.set(0,0,0),S.frustumCulled=!1,S.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",w))}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],85:[function(i,o,l){var a=i("../core/component").registerComponent;o.exports.Component=a("hide-on-enter-ar",{init:function(){var u=this;this.el.sceneEl.addEventListener("enter-vr",function(){u.el.sceneEl.is("ar-mode")&&(u.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){u.el.object3D.visible=!0})}})},{"../core/component":136}],86:[function(i,o,l){var a=i("../utils/bind"),u=i("../core/component").registerComponent,h=i("../lib/three"),f=i("../utils/tracked-controls"),d=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,x="hp-mixed-reality",v="https://cdn.aframe.io/controllers/hp/mixed-reality/",A={x:0,y:0,z:.06},_={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},E={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};o.exports.Component=u("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:E,init:function(){var w=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=a(this.onButtonChanged,this),this.onButtonDown=function(S){g(S.detail.id,"down",w,w.data.hand)},this.onButtonUp=function(S){g(S.detail.id,"up",w,w.data.hand)},this.onButtonTouchEnd=function(S){g(S.detail.id,"touchend",w,w.data.hand)},this.onButtonTouchStart=function(S){g(S.detail.id,"touchstart",w,w.data.hand)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var w=this.data;this.controllerIndex=w.hand==="right"?0:w.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=a(this.onModelLoaded,this),this.onControllersUpdate=a(this.onControllersUpdate,this),this.checkIfControllerPresent=a(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=a(this.removeControllersUpdateListener,this),this.onAxisMoved=a(this.onAxisMoved,this)},addEventListeners:function(){var w=this.el;w.addEventListener("buttonchanged",this.onButtonChanged),w.addEventListener("buttondown",this.onButtonDown),w.addEventListener("buttonup",this.onButtonUp),w.addEventListener("touchstart",this.onButtonTouchStart),w.addEventListener("touchend",this.onButtonTouchEnd),w.addEventListener("axismove",this.onAxisMoved),w.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var w=this.el;w.removeEventListener("buttonchanged",this.onButtonChanged),w.removeEventListener("buttondown",this.onButtonDown),w.removeEventListener("buttonup",this.onButtonUp),w.removeEventListener("touchstart",this.onButtonTouchStart),w.removeEventListener("touchend",this.onButtonTouchEnd),w.removeEventListener("axismove",this.onAxisMoved),w.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var w=this.data;d(this,x,{index:this.controllerIndex,hand:w.hand})},injectTrackedControls:function(){var w=this.el,S=this.data;w.setAttribute("tracked-controls",{idPrefix:x,hand:S.hand,controller:this.controllerIndex,orientationOffset:S.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",v+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(w){var S=this.mapping[this.data.hand].buttons[w.detail.id],T;!S||(S==="trigger"&&(T=w.detail.state.value,console.log("analog value of trigger press: "+T)),this.el.emit(S+"changed",w.detail.state))},onModelLoaded:function(w){var S=w.detail.model;!this.data.model||(S.position.copy(A),S.rotation.copy(_),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new h.Vector3(0,0,0)}))},onAxisMoved:function(w){m(this,this.mapping.axes,w)}})},{"../core/component":136,"../lib/three":184,"../utils/bind":206,"../utils/tracked-controls":221}],87:[function(i,o,l){i("./animation"),i("./camera"),i("./cursor"),i("./daydream-controls"),i("./gearvr-controls"),i("./geometry"),i("./generic-tracked-controller-controls"),i("./gltf-model"),i("./hand-tracking-controls"),i("./hand-controls"),i("./hide-on-enter-ar"),i("./hp-mixed-reality-controls"),i("./layer"),i("./laser-controls"),i("./light"),i("./line"),i("./link"),i("./look-controls"),i("./magicleap-controls"),i("./material"),i("./obj-model"),i("./oculus-go-controls"),i("./oculus-touch-controls"),i("./position"),i("./raycaster"),i("./rotation"),i("./scale"),i("./shadow"),i("./sound"),i("./text"),i("./tracked-controls"),i("./tracked-controls-webvr"),i("./tracked-controls-webxr"),i("./visible"),i("./valve-index-controls"),i("./vive-controls"),i("./vive-focus-controls"),i("./wasd-controls"),i("./windows-motion-controls"),i("./scene/ar-hit-test"),i("./scene/background"),i("./scene/debug"),i("./scene/device-orientation-permission-ui"),i("./scene/embedded"),i("./scene/inspector"),i("./scene/fog"),i("./scene/keyboard-shortcuts"),i("./scene/pool"),i("./scene/reflection"),i("./scene/screenshot"),i("./scene/stats"),i("./scene/vr-mode-ui")},{"./animation":75,"./camera":76,"./cursor":77,"./daydream-controls":78,"./gearvr-controls":79,"./generic-tracked-controller-controls":80,"./geometry":81,"./gltf-model":82,"./hand-controls":83,"./hand-tracking-controls":84,"./hide-on-enter-ar":85,"./hp-mixed-reality-controls":86,"./laser-controls":88,"./layer":89,"./light":90,"./line":91,"./link":92,"./look-controls":93,"./magicleap-controls":94,"./material":95,"./obj-model":96,"./oculus-go-controls":97,"./oculus-touch-controls":98,"./position":99,"./raycaster":100,"./rotation":101,"./scale":102,"./scene/ar-hit-test":103,"./scene/background":104,"./scene/debug":105,"./scene/device-orientation-permission-ui":106,"./scene/embedded":107,"./scene/fog":108,"./scene/inspector":109,"./scene/keyboard-shortcuts":110,"./scene/pool":111,"./scene/reflection":112,"./scene/screenshot":113,"./scene/stats":114,"./scene/vr-mode-ui":115,"./shadow":116,"./sound":117,"./text":118,"./tracked-controls":121,"./tracked-controls-webvr":119,"./tracked-controls-webxr":120,"./valve-index-controls":122,"./visible":123,"./vive-controls":124,"./vive-focus-controls":125,"./wasd-controls":126,"./windows-motion-controls":127}],88:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/");a("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var h=this.config,f=this.data,d=this.el,m=this,g={hand:f.hand,model:f.model};d.setAttribute("daydream-controls",g),d.setAttribute("gearvr-controls",g),d.setAttribute("hp-mixed-reality-controls",g),d.setAttribute("magicleap-controls",g),d.setAttribute("oculus-go-controls",g),d.setAttribute("oculus-touch-controls",g),d.setAttribute("valve-index-controls",g),d.setAttribute("vive-controls",g),d.setAttribute("vive-focus-controls",g),d.setAttribute("windows-motion-controls",g),d.setAttribute("generic-tracked-controller-controls",g),d.addEventListener("controllerconnected",x),d.addEventListener("controllerdisconnected",v),d.addEventListener("controllermodelready",function(A){x(A),m.modelReady=!0});function x(A){var _=h[A.detail.name];if(!!_){var E=u.extend({showLine:!0},_.raycaster||{});A.detail.rayOrigin&&(E.origin=A.detail.rayOrigin.origin,E.direction=A.detail.rayOrigin.direction,E.showLine=!0),A.detail.rayOrigin||!m.modelReady?d.setAttribute("raycaster",E):d.setAttribute("raycaster","showLine",!0),d.setAttribute("cursor",u.extend({fuse:!1},_.cursor))}}function v(){d.setAttribute("raycaster","showLine",!1)}},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":136,"../utils/":212}],89:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/"),h=u.debug("components:layer:warn");o.exports.Component=a("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var d=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=d.createFramebuffer();var m=this.el.sceneEl.getAttribute("webxr").requiredFeatures;m.push("layers"),this.el.sceneEl.getAttribute("webxr","requiredFeatures",m),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(d){this.data.src!==d.src&&this.updateSrc()},updateSrc:function(){var d=this.data.type;if(this.texture=void 0,d==="quad"){this.loadQuadImage();return}if(d==="monocubemap"||d==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var d,m=this.xrGLFactory,g=this.el.sceneEl.frame,x=this.data.src,v=this.data.type;this.visibilityChanged=!1,this.layer&&(v!=="monocubemap"&&v!=="stereocubemap"||(x.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,v==="monocubemap"?(d=m.getSubImage(this.layer,g),this.loadCubeMapImage(d.colorTexture,x,0)):(d=m.getSubImage(this.layer,g,"left"),this.loadCubeMapImage(d.colorTexture,x,0),d=m.getSubImage(this.layer,g,"right"),this.loadCubeMapImage(d.colorTexture,x,6))))},loadQuadImage:function(){var d=this.data.src,m=this;this.el.sceneEl.systems.material.loadTexture(d,{src:d},function(x){m.el.sceneEl.renderer.initTexture(x),m.texture=x,d.tagName==="VIDEO"&&setTimeout(function(){m.textureIsVideo=!0},1e3),m.layer&&(m.layer.height=m.data.height/2||m.texture.image.height/1e3,m.layer.width=m.data.width/2||m.texture.image.width/1e3,m.needsRedraw=!0),m.updateQuadPanel()})},preGenerateCubeMapTextures:function(d,m){this.data.type==="monocubemap"?this.generateCubeMapTextures(d,0,m):(this.generateCubeMapTextures(d,0,m),this.generateCubeMapTextures(d,6,m))},generateCubeMapTextures:function(d,m,g){for(var x=this.data,v=this.cubeFaceSize,A=Math.min(d.width,d.height),_=[],E,w,S=0;S<6;S++){var T=document.createElement("CANVAS");T.width=T.height=v;var R=T.getContext("2d");x.rotateCubemap&&(S===2||S===3)&&(R.save(),R.translate(v,v),R.rotate(Math.PI)),R.drawImage(d,(S+m)*A,0,A,A,0,0,v,v),R.restore(),g&&g(),_.push(T)}return x.rotateCubemap&&(E=_[0],w=_[1],_[0]=w,_[1]=E,E=_[4],w=_[5],_[4]=w,_[5]=E),g&&g(),_},loadCubeMapImage:function(d,m,g){var x=this.el.sceneEl.renderer.getContext(),v;x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,!1),x.bindTexture(x.TEXTURE_CUBE_MAP,d),!m.complete||this.loadingScreen?v=this.loadingScreenImages:v=this.generateCubeMapTextures(m,g);var A=0;v.forEach(function(_,E){x.texSubImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+E,0,0,0,x.RGBA,x.UNSIGNED_BYTE,_),A=x.getError()}),A!==0&&console.log("renderingError, WebGL Error Code: "+A),x.bindTexture(x.TEXTURE_CUBE_MAP,null)},tick:function(){!this.el.sceneEl.xrSession||(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var d=this,m=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(g){d.visibilityChanged=g.session.visibilityState!=="hidden"},m==="quad"){this.initQuadLayer();return}if(m==="monocubemap"||m==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var d=this.el.sceneEl,m=d.renderer.getContext(),g=this.xrGLFactory=new XRWebGLBinding(d.xrSession,m);!this.texture||(this.layer=g.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),d.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var d=this.data.src,m=this.el.sceneEl,g=m.renderer.getContext(),x=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE),v=this.cubeFaceSize=Math.min(x,Math.min(d.width,d.height)),A=this.xrGLFactory=new XRWebGLBinding(m.xrSession,g);this.layer=A.createCubeLayer({space:this.referenceSpace,viewPixelWidth:v,viewPixelHeight:v,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),m.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var d=this.cubeFaceSize,m=this.loadingScreenImages=[],g=0;g<6;g++){var x=document.createElement("CANVAS");x.width=x.height=d;var v=x.getContext("2d");x.width=x.height=d,v.fillStyle="black",v.fillRect(0,0,d,d),g!==2&&g!==3&&(v.translate(d,0),v.scale(-1,1),v.fillStyle="white",v.font="30px Arial",v.fillText("Loading",d/2,d/2)),m.push(x)}},destroyLayer:function(){!this.layer||(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(d){this.layerEnabled=d,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var d=this.quadPanelEl;this.quadPanelEl||(d=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(d)),d.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),d.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var d=this.el.sceneEl,m=this.el.sceneEl.renderer.getContext(),g=this.xrGLFactory.getSubImage(this.layer,d.frame),x=d.renderer.properties.get(this.texture).__webglTexture,v=m.getParameter(m.FRAMEBUFFER_BINDING);m.viewport(g.viewport.x,g.viewport.y,g.viewport.width,g.viewport.height),m.bindFramebuffer(m.FRAMEBUFFER,this.frameBuffer),m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,g.colorTexture,0),f(m,x,g,this.data.src),m.bindFramebuffer(m.FRAMEBUFFER,v)},updateTransform:function(){var d=this.el,m=this.position,g=this.quaternion;d.object3D.updateMatrixWorld(),m.setFromMatrixPosition(d.object3D.matrixWorld),g.setFromRotationMatrix(d.object3D.matrixWorld),this.layerEnabled||m.set(0,0,1e8),this.layer.transform=new XRRigidTransform(m,g)},onEnterVR:function(){var d=this.el.sceneEl,m=d.xrSession;if(!d.hasWebXR||!XRWebGLBinding||!m){h("The layer component requires WebXR and the layers API enabled");return}m.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(d){this.referenceSpace=d}});function f(d,m,g,x){var v=d.createFramebuffer();let A=g.viewport.x,_=g.viewport.y,E=g.viewport.x+g.viewport.width,w=g.viewport.y+g.viewport.height;x.tagName==="VIDEO"&&(d.bindTexture(d.TEXTURE_2D,m),d.texSubImage2D(d.TEXTURE_2D,0,0,0,x.width,x.height,d.RGB,d.UNSIGNED_BYTE,x)),d.bindFramebuffer(d.READ_FRAMEBUFFER,v),d.framebufferTexture2D(d.READ_FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,m,0),d.readBuffer(d.COLOR_ATTACHMENT0),d.blitFramebuffer(0,0,x.width,x.height,A,_,E,w,d.COLOR_BUFFER_BIT,d.NEAREST),d.bindFramebuffer(d.READ_FRAMEBUFFER,null),d.deleteFramebuffer(v)}},{"../core/component":136,"../utils/":212}],90:[function(i,o,l){var a=i("../utils/bind"),u=i("../utils"),h=u.diff,f=i("../utils/debug"),d=i("../core/component").registerComponent,m=i("../lib/three"),g=m.Math.degToRad,x=f("components:light:warn"),v=new m.CubeTextureLoader,A={};o.exports.Component=d("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var _=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(_)},update:function(_){var E=this.data,w=h(E,_),S=this.light,T=this.rendererSystem,R=this;if(S&&!("type"in w)){var L=!1;Object.keys(w).forEach(function(I){var N=E[I];switch(I){case"color":{S.color.set(N),T.applyColorCorrection(S.color);break}case"groundColor":{S.groundColor.set(N),T.applyColorCorrection(S.groundColor);break}case"angle":{S.angle=g(N);break}case"target":{N===null?(E.type==="spot"||E.type==="directional")&&(S.target=R.defaultTarget):N.hasLoaded?R.onSetTarget(N,S):N.addEventListener("loaded",a(R.onSetTarget,R,N,S));break}case"envMap":this.updateProbeMap(E,S);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":L||(R.updateShadow(),L=!0);break;default:S[I]=N}});return}this.setLight(this.data),this.updateShadow()},setLight:function(_){var E=this.el,w=this.getLight(_);w&&(this.light&&E.removeObject3D("light"),this.light=w,this.light.el=E,E.setObject3D("light",this.light),(_.type==="spot"||_.type==="directional"||_.type==="hemisphere")&&E.getObject3D("light").translateY(-1),_.type==="spot"&&(E.setObject3D("light-target",this.defaultTarget),E.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var _=this.el,E=this.data,w=this.light;w.castShadow=E.castShadow;var S=_.getObject3D("cameraHelper");if(E.shadowCameraVisible&&!S?_.setObject3D("cameraHelper",new m.CameraHelper(w.shadow.camera)):!E.shadowCameraVisible&&S&&_.removeObject3D("cameraHelper"),!E.castShadow)return w;w.shadow.bias=E.shadowBias,w.shadow.radius=E.shadowRadius,w.shadow.mapSize.height=E.shadowMapHeight,w.shadow.mapSize.width=E.shadowMapWidth,w.shadow.camera.near=E.shadowCameraNear,w.shadow.camera.far=E.shadowCameraFar,w.shadow.camera instanceof m.OrthographicCamera?(w.shadow.camera.top=E.shadowCameraTop,w.shadow.camera.right=E.shadowCameraRight,w.shadow.camera.bottom=E.shadowCameraBottom,w.shadow.camera.left=E.shadowCameraLeft):w.shadow.camera.fov=E.shadowCameraFov,w.shadow.camera.updateProjectionMatrix(),S&&S.update()},getLight:function(_){var E=_.angle,w=new m.Color(_.color);this.rendererSystem.applyColorCorrection(w),w=w.getHex();var S=_.decay,T=_.distance,R=new m.Color(_.groundColor);this.rendererSystem.applyColorCorrection(R),R=R.getHex();var L=_.intensity,I=_.type,N=_.target,B=null;switch(I.toLowerCase()){case"ambient":return new m.AmbientLight(w,L);case"directional":return B=new m.DirectionalLight(w,L),this.defaultTarget=B.target,N&&(N.hasLoaded?this.onSetTarget(N,B):N.addEventListener("loaded",a(this.onSetTarget,this,N,B))),B;case"hemisphere":return new m.HemisphereLight(w,R,L);case"point":return new m.PointLight(w,L,T,S);case"spot":return B=new m.SpotLight(w,L,T,g(E),_.penumbra,S),this.defaultTarget=B.target,N&&(N.hasLoaded?this.onSetTarget(N,B):N.addEventListener("loaded",a(this.onSetTarget,this,N,B))),B;case"probe":return B=new m.LightProbe,this.updateProbeMap(_,B),B;default:x("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",I)}},updateProbeMap:function(_,E){_.envMap||E.copy(new m.LightProbe),A[_.envMap]instanceof window.Promise&&A[_.envMap].then(function(w){E.copy(w)}),A[_.envMap]instanceof m.LightProbe&&E.copy(A[_.envMap]),A[_.envMap]=new window.Promise(function(w){u.srcLoader.validateCubemapSrc(_.envMap,function(T){v.load(T,function(R){var L=m.LightProbeGenerator.fromCubeTexture(R);A[_.envMap]=L,E.copy(L)})})})},onSetTarget:function(_,E){E.target=_.object3D},remove:function(){var _=this.el;_.removeObject3D("light"),_.getObject3D("cameraHelper")&&_.removeObject3D("cameraHelper")}})},{"../core/component":136,"../lib/three":184,"../utils":212,"../utils/bind":206,"../utils/debug":208}],91:[function(i,o,l){var a=i("../core/component").registerComponent;o.exports.Component=a("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var h=this.data,f,d;this.rendererSystem=this.el.sceneEl.systems.renderer,d=this.material=new THREE.LineBasicMaterial({color:h.color,opacity:h.opacity,transparent:h.opacity<1,visible:h.visible}),f=this.geometry=new THREE.BufferGeometry,f.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*3),3)),this.rendererSystem.applyColorCorrection(d.color),this.line=new THREE.Line(f,d),this.el.setObject3D(this.attrName,this.line)},update:function(h){var f=this.data,d=this.geometry,m=!1,g=this.material,x=d.attributes.position.array;u(f.start,h.start)||(x[0]=f.start.x,x[1]=f.start.y,x[2]=f.start.z,m=!0),u(f.end,h.end)||(x[3]=f.end.x,x[4]=f.end.y,x[5]=f.end.z,m=!0),m&&(d.attributes.position.needsUpdate=!0,d.computeBoundingSphere()),g.color.setStyle(f.color),this.rendererSystem.applyColorCorrection(g.color),g.opacity=f.opacity,g.transparent=f.opacity<1,g.visible=f.visible},remove:function(){this.el.removeObject3D("line",this.line)}});function u(h,f){return!h||!f?!1:h.x===f.x&&h.y===f.y&&h.z===f.z}},{"../core/component":136}],92:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../core/shader").registerShader,h=i("../lib/three");o.exports.Component=a("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new h.Quaternion,this.hiddenEls=[]},update:function(f){var d=this.data,m=this.el,g,x;!d.visualAspectEnabled||(this.initVisualAspect(),g=d.highlighted?d.highlightedColor:d.backgroundColor,x=d.highlighted?d.highlightedColor:d.borderColor,m.setAttribute("material","backgroundColor",g),m.setAttribute("material","strokeColor",x),d.on!==f.on&&this.updateEventListener(),f.peekMode!==void 0&&d.peekMode!==f.peekMode&&this.updatePeekMode(),!(!d.image||f.image===d.image)&&m.setAttribute("material","pano",typeof d.image=="string"?d.image:d.image.src))},updatePeekMode:function(){var f=this.el,d=this.sphereEl;this.data.peekMode?(this.hideAll(),f.getObject3D("mesh").visible=!1,d.setAttribute("visible",!0)):(this.showAll(),f.getObject3D("mesh").visible=!0,d.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var f=this.el;!f.isPlaying||(this.removeEventListener(),f.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var f=this.data.on;!f||this.el.removeEventListener(f,this.navigate)},initVisualAspect:function(){var f=this.el,d,m,g;!this.data.visualAspectEnabled||this.visualAspectInitialized||(g=this.textEl=this.textEl||document.createElement("a-entity"),m=this.sphereEl=this.sphereEl||document.createElement("a-entity"),d=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),f.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),f.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),g.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),g.setAttribute("position","0 1.5 0"),f.appendChild(g),d.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),d.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),d.setAttribute("rotation","0 180 0"),d.setAttribute("position","0 0 0"),d.setAttribute("visible",!1),f.appendChild(d),m.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),m.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),m.setAttribute("visible",!1),f.appendChild(m),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var f=new h.Vector3,d=new h.Vector3,m=new h.Quaternion,g=new h.Vector3;return function(){var x=this.el,v=x.object3D,A=x.sceneEl.camera,_,E,w=this.textEl;if(!!this.data.visualAspectEnabled)if(v.updateMatrixWorld(),A.parent.updateMatrixWorld(),A.updateMatrixWorld(),v.matrix.decompose(d,m,g),d.setFromMatrixPosition(v.matrixWorld),f.setFromMatrixPosition(A.matrixWorld),E=d.distanceTo(f),E>20)this.previousQuaternion||(this.quaternionClone.copy(m),this.previousQuaternion=this.quaternionClone),v.lookAt(f);else{if(_=this.calculateCameraPortalOrientation(),E<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;w.setAttribute("text","width",1.5),_<=0?(w.setAttribute("position","0 0 0.75"),w.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(w.setAttribute("position","0 0 -0.75"),w.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),x.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=_}else _<=0?w.setAttribute("rotation","0 180 0"):w.setAttribute("rotation","0 0 0"),w.setAttribute("text","width",5),w.setAttribute("position","0 1.5 0"),x.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(v.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var f=this.el,d=this.hiddenEls,m=this;d.length>0||f.sceneEl.object3D.traverse(function(g){g&&g.el&&g.el.hasAttribute("link-controls")||!g.el||g===f.sceneEl.object3D||g.el===f||g.el===m.sphereEl||g.el===f.sceneEl.cameraEl||g.el.getAttribute("visible")===!1||g.el===m.textEl||g.el===m.semiSphereEl||(g.el.setAttribute("visible",!1),d.push(g.el))})},showAll:function(){this.hiddenEls.forEach(function(f){f.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var f=new h.Matrix4,d=new h.Vector3,m=new h.Vector3(0,0,1),g=new h.Vector3(0,0,0);return function(){var x=this.el,v=x.sceneEl.camera;return d.set(0,0,0),m.set(0,0,1),g.set(0,0,0),x.object3D.matrixWorld.extractRotation(f),m.applyMatrix4(f),x.object3D.updateMatrixWorld(),x.object3D.localToWorld(g),v.parent.parent.updateMatrixWorld(),v.parent.updateMatrixWorld(),v.updateMatrixWorld(),v.localToWorld(d),d.sub(g).normalize(),m.normalize(),Math.sign(m.dot(d))}}(),remove:function(){this.removeEventListener()}}),u("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},{"../core/component":136,"../core/shader":146,"../lib/three":184}],93:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../lib/three"),h=i("../utils/"),f=h.bind,d=Math.PI/2;o.exports.Component=a("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new u.Vector3,this.hmdQuaternion=new u.Quaternion,this.magicWindowAbsoluteEuler=new u.Euler,this.magicWindowDeltaEuler=new u.Euler,this.position=new u.Vector3,this.magicWindowObject=new u.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new u.Vector3,rotation:new u.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var m,g=this.data;(h.device.isMobile()||h.device.isMobileDeviceRequestingDesktopSite())&&(m=this.magicWindowControls=new u.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent<"u"&&DeviceOrientationEvent.requestPermission&&(m.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?m.enabled=g.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){m.enabled=g.magicWindowTrackingEnabled})))},update:function(m){var g=this.data;g.enabled!==m.enabled&&this.updateGrabCursor(g.enabled),m&&!g.magicWindowTrackingEnabled&&m.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=g.magicWindowTrackingEnabled),m&&!g.pointerLockEnabled!==m.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(m){var g=this.data;!g.enabled||this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=f(this.onMouseDown,this),this.onMouseMove=f(this.onMouseMove,this),this.onMouseUp=f(this.onMouseUp,this),this.onTouchStart=f(this.onTouchStart,this),this.onTouchMove=f(this.onTouchMove,this),this.onTouchEnd=f(this.onTouchEnd,this),this.onEnterVR=f(this.onEnterVR,this),this.onExitVR=f(this.onExitVR,this),this.onPointerLockChange=f(this.onPointerLockChange,this),this.onPointerLockError=f(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new u.Object3D,this.yawObject=new u.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var m=this.el.sceneEl,g=m.canvas;if(!g){m.addEventListener("render-target-loaded",f(this.addEventListeners,this));return}g.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),g.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),m.addEventListener("enter-vr",this.onEnterVR),m.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var m=this.el.sceneEl,g=m&&m.canvas;!g||(g.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),g.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),m.removeEventListener("enter-vr",this.onEnterVR),m.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var m=this.el.object3D,g=this.pitchObject,x=this.yawObject,v=this.el.sceneEl;(v.is("vr-mode")||v.is("ar-mode"))&&v.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),m.rotation.x=this.magicWindowDeltaEuler.x+g.rotation.x,m.rotation.y=this.magicWindowDeltaEuler.y+x.rotation.y,m.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var m=this.magicWindowAbsoluteEuler,g=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),m.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&m.y!==0&&(this.previousMagicWindowYaw=m.y),this.previousMagicWindowYaw&&(g.x=m.x,g.y+=m.y-this.previousMagicWindowYaw,g.z=m.z,this.previousMagicWindowYaw=m.y))},onMouseMove:function(m){var g,x,v,A=this.pitchObject,_=this.previousMouseEvent,E=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(x=m.movementX||m.mozMovementX||0,v=m.movementY||m.mozMovementY||0):(x=m.screenX-_.screenX,v=m.screenY-_.screenY),this.previousMouseEvent.screenX=m.screenX,this.previousMouseEvent.screenY=m.screenY,g=this.data.reverseMouseDrag?1:-1,E.rotation.y+=x*.002*g,A.rotation.x+=v*.002*g,A.rotation.x=Math.max(-d,Math.min(d,A.rotation.x)))},onMouseDown:function(m){var g=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(g.is("vr-mode")||g.is("ar-mode"))&&g.checkHeadsetConnected())&&m.button===0){var x=g&&g.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=m.screenX,this.previousMouseEvent.screenY=m.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(x.requestPointerLock?x.requestPointerLock():x.mozRequestPointerLock&&x.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(m){m.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:m.touches[0].pageX,y:m.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(m){var g,x=this.el.sceneEl.canvas,v,A=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(v=2*Math.PI*(m.touches[0].pageX-this.touchStart.x)/x.clientWidth,g=this.data.reverseTouchDrag?1:-1,A.rotation.y-=v*.5*g,this.touchStart={x:m.touches[0].pageX,y:m.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var m=this.el.sceneEl;!m.checkHeadsetConnected()||(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),m.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){!this.el.sceneEl.checkHeadsetConnected()||(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(m){var g=this.el.sceneEl;function x(){g.canvas.classList.add("a-grab-cursor")}function v(){g.canvas.classList.remove("a-grab-cursor")}if(!g.canvas){m?g.addEventListener("render-target-loaded",x):g.addEventListener("render-target-loaded",v);return}if(m){x();return}v()},saveCameraPose:function(){var m=this.el;this.savedPose.position.copy(m.object3D.position),this.savedPose.rotation.copy(m.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var m=this.el,g=this.savedPose;!this.hasSavedPose||(m.object3D.position.copy(g.position),m.object3D.rotation.copy(g.rotation),this.hasSavedPose=!1)}})},{"../core/component":136,"../lib/three":184,"../utils/":212}],94:[function(i,o,l){var a=i("../utils/bind"),u=i("../core/component").registerComponent,h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g="magicleap",x="-one",v=g+x,A="https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb",_={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};o.exports.Component=u("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:_,init:function(){var E=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=a(this.onButtonChanged,this),this.onButtonDown=function(w){m(w.detail.id,"down",E)},this.onButtonUp=function(w){m(w.detail.id,"up",E)},this.onButtonTouchEnd=function(w){m(w.detail.id,"touchend",E)},this.onButtonTouchStart=function(w){m(w.detail.id,"touchstart",E)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var E=this.data;this.controllerIndex=E.hand==="right"?0:E.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=a(this.onModelLoaded,this),this.onControllersUpdate=a(this.onControllersUpdate,this),this.checkIfControllerPresent=a(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=a(this.removeControllersUpdateListener,this),this.onAxisMoved=a(this.onAxisMoved,this)},addEventListeners:function(){var E=this.el;E.addEventListener("buttonchanged",this.onButtonChanged),E.addEventListener("buttondown",this.onButtonDown),E.addEventListener("buttonup",this.onButtonUp),E.addEventListener("touchstart",this.onButtonTouchStart),E.addEventListener("touchend",this.onButtonTouchEnd),E.addEventListener("axismove",this.onAxisMoved),E.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var E=this.el;E.removeEventListener("buttonchanged",this.onButtonChanged),E.removeEventListener("buttondown",this.onButtonDown),E.removeEventListener("buttonup",this.onButtonUp),E.removeEventListener("touchstart",this.onButtonTouchStart),E.removeEventListener("touchend",this.onButtonTouchEnd),E.removeEventListener("axismove",this.onAxisMoved),E.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var E=this.data;f(this,v,{index:this.controllerIndex,hand:E.hand})},injectTrackedControls:function(){var E=this.el,w=this.data;E.setAttribute("tracked-controls",{idPrefix:v,hand:w.hand,controller:this.controllerIndex,orientationOffset:w.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",A)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(E){var w=this.mapping.buttons[E.detail.id],S;!w||(w==="trigger"&&(S=E.detail.state.value,console.log("analog value of trigger press: "+S)),this.el.emit(w+"changed",E.detail.state))},onModelLoaded:function(E){var w=E.detail.model;w.scale.set(.01,.01,.01)},onAxisMoved:function(E){d(this,this.mapping.axes,E)},updateModel:function(E,w){},setButtonColor:function(E,w){}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],95:[function(i,o,l){var a=i("../utils/"),u=i("../core/component"),h=i("../lib/three"),f=i("../core/shader"),d=a.debug("components:material:error"),m=u.registerComponent,g=f.shaders,x=f.shaderNames;o.exports.Component=m("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:x,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},init:function(){this.material=null},update:function(w){var S=this.data;(!this.shader||S.shader!==w.shader)&&this.updateShader(S.shader),this.shader.update(this.data),this.updateMaterial(w)},updateSchema:function(w){var S,T,R,L;T=w&&w.shader,S=this.oldData&&this.oldData.shader,L=T||S,R=g[L]&&g[L].schema,R||d("Unknown shader schema "+L),!(S&&T===S)&&(this.extendSchema(R),this.updateBehavior())},updateBehavior:function(){var w,S=this.el.sceneEl,T=this.schema,R=this,L;function I(N,B){var H;for(H in L)L[H]=N;R.shader.update(L)}this.tick=void 0,L={};for(w in T)T[w].type==="time"&&(this.tick=I,L[w]=!0);!S||(this.tick?S.addBehavior(this):S.removeBehavior(this))},updateShader:function(w){var S=this.data,T=g[w]&&g[w].Shader,R;if(!T)throw new Error("Unknown shader "+w);R=this.shader=new T,R.el=this.el,R.init(S),this.setMaterial(R.material),this.updateSchema(S)},updateMaterial:function(w){var S=this.data,T=this.material,R;T.alphaTest=S.alphaTest,T.depthTest=S.depthTest!==!1,T.depthWrite=S.depthWrite!==!1,T.opacity=S.opacity,T.flatShading=S.flatShading,T.side=v(S.side),T.transparent=S.transparent!==!1||S.opacity<1,T.vertexColors=A(S.vertexColors),T.visible=S.visible,T.blending=_(S.blending),T.dithering=S.dithering;for(R in w)break;R&&(w.alphaTest!==S.alphaTest||w.side!==S.side||w.vertexColors!==S.vertexColors)&&(T.needsUpdate=!0)},remove:function(){var w=new h.MeshBasicMaterial,S=this.material,T=this.el.getObject3D("mesh");T&&(T.material=w),E(S,this.system)},setMaterial:function(w){var S=this.el,T,R=this.system;this.material&&E(this.material,R),this.material=w,R.registerMaterial(w),T=S.getObject3D("mesh"),T?T.material=w:S.addEventListener("object3dset",function L(I){I.detail.type!=="mesh"||I.target!==S||(S.getObject3D("mesh").material=w,S.removeEventListener("object3dset",L))})}});function v(w){switch(w){case"back":return h.BackSide;case"double":return h.DoubleSide;default:return h.FrontSide}}function A(w){switch(w){case"face":return h.FaceColors;case"vertex":return h.VertexColors;default:return h.NoColors}}function _(w){switch(w){case"none":return h.NoBlending;case"additive":return h.AdditiveBlending;case"subtractive":return h.SubtractiveBlending;case"multiply":return h.MultiplyBlending;default:return h.NormalBlending}}function E(w,S){w.dispose(),S.unregisterMaterial(w)}},{"../core/component":136,"../core/shader":146,"../lib/three":184,"../utils/":212}],96:[function(i,o,l){var a=i("../utils/debug"),u=i("../core/component").registerComponent,h=i("../lib/three"),f=a("components:obj-model:warn");o.exports.Component=u("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var d=this;this.model=null,this.objLoader=new h.OBJLoader,this.mtlLoader=new h.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(m){!d.model||m.detail.name==="material"&&d.applyMaterial()})},update:function(){var d=this.data;!d.obj||(this.resetMesh(),this.loadObj(d.obj,d.mtl))},remove:function(){!this.model||this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(d,m){var g=this,x=this.el,v=this.mtlLoader,A=this.objLoader,_=this.el.sceneEl.systems.renderer,E=m.substr(0,m.lastIndexOf("/")+1);if(m){x.hasAttribute("material")&&f("Material component properties are ignored when a .MTL is provided"),v.setResourcePath(E),v.load(m,function(w){w.preload(),A.setMaterials(w),A.load(d,function(S){g.model=S,g.model.traverse(function(T){if(T.isMesh){var R=T.material;R.color&&_.applyColorCorrection(R.color),R.map&&_.applyColorCorrection(R.map),R.emissive&&_.applyColorCorrection(R.emissive),R.emissiveMap&&_.applyColorCorrection(R.emissiveMap)}}),x.setObject3D("mesh",S),x.emit("model-loaded",{format:"obj",model:S})})});return}A.load(d,function(S){g.model=S,g.applyMaterial(),x.setObject3D("mesh",S),x.emit("model-loaded",{format:"obj",model:S})})},applyMaterial:function(){var d=this.el.components.material;!d||this.model.traverse(function(m){m instanceof h.Mesh&&(m.material=d.material)})}})},{"../core/component":136,"../lib/three":184,"../utils/debug":208}],97:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g=i("../utils/").device.isWebXRAvailable,x="oculus-go",v="Oculus Go",A="https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf",_=g?x:v,E={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},w={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},S=g?w:E;o.exports.Component=a("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:S,bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var T=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(R){m(R.detail.id,"down",T)},this.onButtonUp=function(R){m(R.detail.id,"up",T)},this.onButtonTouchStart=function(R){m(R.detail.id,"touchstart",T)},this.onButtonTouchEnd=function(R){m(R.detail.id,"touchend",T)},this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var T=this.el;T.addEventListener("buttonchanged",this.onButtonChanged),T.addEventListener("buttondown",this.onButtonDown),T.addEventListener("buttonup",this.onButtonUp),T.addEventListener("touchstart",this.onButtonTouchStart),T.addEventListener("touchend",this.onButtonTouchEnd),T.addEventListener("model-loaded",this.onModelLoaded),T.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var T=this.el;T.removeEventListener("buttonchanged",this.onButtonChanged),T.removeEventListener("buttondown",this.onButtonDown),T.removeEventListener("buttonup",this.onButtonUp),T.removeEventListener("touchstart",this.onButtonTouchStart),T.removeEventListener("touchend",this.onButtonTouchEnd),T.removeEventListener("model-loaded",this.onModelLoaded),T.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,_,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var T=this.el,R=this.data;T.setAttribute("tracked-controls",{armModel:R.armModel,hand:R.hand,idPrefix:_,orientationOffset:R.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",A)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(T){var R=T.detail.model,L;!this.data.model||(L=this.buttonMeshes={},L.trigger=R.getObjectByName("oculus_go_button_trigger"),L.trackpad=R.getObjectByName("oculus_go_touchpad"),L.touchpad=R.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(T){var R=this.mapping.buttons[T.detail.id];!R||this.el.emit(R+"changed",T.detail.state)},onAxisMoved:function(T){d(this,this.mapping.axes,T)},updateModel:function(T,R){!this.data.model||this.updateButtonModel(T,R)},updateButtonModel:function(T,R){var L=this.buttonMeshes;if(!(!L||!L[T])){var I,N;switch(R){case"down":I=this.data.buttonHighlightColor;break;case"touchstart":I=this.data.buttonTouchedColor;break;default:I=this.data.buttonColor}N=L[T],N.material.color.set(I),this.rendererSystem.applyColorCorrection(N.material.color)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],98:[function(i,o,l){var a=i("../utils/bind"),u=i("../core/component").registerComponent,h=i("../lib/three"),f=i("../utils/tracked-controls"),d=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,x=i("../utils/").device.isWebXRAvailable,v="oculus-touch",A="Oculus Touch",_=x?v:A,E="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-",w={left:{modelUrl:E+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(-.005,.003,-.055),modelPivotRotation:new h.Euler(0,0,0)},right:{modelUrl:E+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(.005,.003,-.055),modelPivotRotation:new h.Euler(0,0,0)}},S={left:{modelUrl:E+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(-.005,.036,-.037),modelPivotRotation:new h.Euler(Math.PI/4.5,0,0)},right:{modelUrl:E+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new h.Vector3(.005,.036,-.037),modelPivotRotation:new h.Euler(Math.PI/4.5,0,0)}},T=x?S:w,R="oculus-touch",L={"oculus-touch":T,"oculus-touch-v2":{left:{modelUrl:E+"gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)},right:{modelUrl:E+"gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new h.Vector3(0,0,0),modelPivotRotation:new h.Euler(0,0,0)}},"oculus-touch-v3":{left:{modelUrl:E+"v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new h.Vector3(.01,-.01,.05),modelPivotRotation:new h.Euler(Math.PI/4,0,0)},right:{modelUrl:E+"v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new h.Vector3(-.01,-.01,.05),modelPivotRotation:new h.Euler(Math.PI/4,0,0)}}},I={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},N={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},B=x?N:I;o.exports.Component=u("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:B,bindMethods:function(){this.onModelLoaded=a(this.onModelLoaded,this),this.onControllersUpdate=a(this.onControllersUpdate,this),this.checkIfControllerPresent=a(this.checkIfControllerPresent,this),this.onAxisMoved=a(this.onAxisMoved,this)},init:function(){var H=this;this.onButtonChanged=a(this.onButtonChanged,this),this.onButtonDown=function(q){g(q.detail.id,"down",H,H.data.hand)},this.onButtonUp=function(q){g(q.detail.id,"up",H,H.data.hand)},this.onButtonTouchStart=function(q){g(q.detail.id,"touchstart",H,H.data.hand)},this.onButtonTouchEnd=function(q){g(q.detail.id,"touchend",H,H.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var H=this.el;H.addEventListener("buttonchanged",this.onButtonChanged),H.addEventListener("buttondown",this.onButtonDown),H.addEventListener("buttonup",this.onButtonUp),H.addEventListener("touchstart",this.onButtonTouchStart),H.addEventListener("touchend",this.onButtonTouchEnd),H.addEventListener("axismove",this.onAxisMoved),H.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var H=this.el;H.removeEventListener("buttonchanged",this.onButtonChanged),H.removeEventListener("buttondown",this.onButtonDown),H.removeEventListener("buttonup",this.onButtonUp),H.removeEventListener("touchstart",this.onButtonTouchStart),H.removeEventListener("touchend",this.onButtonTouchEnd),H.removeEventListener("axismove",this.onAxisMoved),H.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){d(this,_,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(H){var q=this.data,le;if(!!q.model){if(this.displayModel=L[q.controllerType]||L[R],q.controllerType==="auto"){var ne=this.el.sceneEl.systems["tracked-controls-webvr"];if(ne&&ne.vrDisplay){var D=ne.vrDisplay.displayName;/^Oculus Quest$/.test(D)&&(this.displayModel=L["oculus-touch-v2"])}else le=R,le=H.profiles.indexOf("oculus-touch-v2")!==-1?"oculus-touch-v2":le,le=H.profiles.indexOf("oculus-touch-v3")!==-1?"oculus-touch-v3":le,this.displayModel=L[le]}var O=this.displayModel[q.hand].modelUrl;this.el.setAttribute("gltf-model",O)}},injectTrackedControls:function(H){var q=this.data,le=v,ne=q.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",D=x?le:ne;this.el.setAttribute("tracked-controls",{id:D,hand:q.hand,orientationOffset:q.orientationOffset,handTrackingEnabled:!1}),this.loadModel(H)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(H){var q=this.mapping[this.data.hand].buttons[H.detail.id],le=this.buttonMeshes,ne;!q||((q==="trigger"||q==="grip")&&(ne=H.detail.state.value),le&&(q==="trigger"&&le.trigger&&(le.trigger.rotation.x=this.originalXRotationTrigger-ne*(Math.PI/26)),q==="grip"&&le.grip&&(le.grip.position.x=this.originalXPositionGrip+(this.data.hand==="left"?-1:1)*ne*.004)),this.el.emit(q+"changed",H.detail.state))},onModelLoaded:function(H){var q=this.controllerObject3D=H.detail.model,le;!this.data.model||(le=this.buttonMeshes={},le.grip=q.getObjectByName("buttonHand"),this.originalXPositionGrip=le.grip&&le.grip.position.x,le.thumbstick=q.getObjectByName("stick"),le.trigger=q.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=le.trigger&&le.trigger.rotation.x,le.xbutton=q.getObjectByName("buttonX"),le.abutton=q.getObjectByName("buttonA"),le.ybutton=q.getObjectByName("buttonY"),le.bbutton=q.getObjectByName("buttonB"),q.position.copy(this.displayModel[this.data.hand].modelPivotOffset),q.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin}))},onAxisMoved:function(H){m(this,this.mapping[this.data.hand].axes,H)},updateModel:function(H,q){!this.data.model||this.updateButtonModel(H,q)},updateButtonModel:function(H,q){var le,ne=q==="up"||q==="touchend"?this.data.buttonColor:q==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,D=this.buttonMeshes;!this.data.model||D&&D[H]&&(le=D[H],le.material.color.set(ne),this.rendererSystem.applyColorCorrection(le.material.color))}})},{"../core/component":136,"../lib/three":184,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],99:[function(i,o,l){var a=i("../core/component").registerComponent;o.exports.Component=a("position",{schema:{type:"vec3"},update:function(){var u=this.el.object3D,h=this.data;u.position.set(h.x,h.y,h.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":136}],100:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../lib/three"),h=i("../utils/"),f=h.debug("components:raycaster:warn"),d=/^[\w\s-.,[\]#]*$/,m={childList:!0,attributes:!0,subtree:!0},g={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};o.exports.Component=a("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new u.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new u.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new u.Vector3,this.otherLineEndVec3=new u.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(v){var A=this.data,_=this.el,E=this.raycaster;E.far=A.far,E.near=A.near,A.showLine&&(A.far!==v.far||A.origin!==v.origin||A.direction!==v.direction||!v.showLine)&&(this.unitLineEndVec3.copy(A.origin).add(A.direction).normalize(),this.drawLine()),!A.showLine&&v.showLine&&_.removeAttribute("line"),A.objects!==v.objects&&!d.test(A.objects)&&f('[raycaster] Selector "'+A.objects+'" may not update automatically with DOM changes.'),A.objects||f('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),A.autoRefresh!==v.autoRefresh&&_.isPlaying&&(A.autoRefresh?this.addEventListeners():this.removeEventListeners()),v.enabled&&!A.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){!this.data.autoRefresh||(this.observer.observe(this.el.sceneEl,m),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var v=this.data,A;A=v.objects?this.el.sceneEl.querySelectorAll(v.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(A),this.dirty=!1},tock:function(v){var A=this.data,_=this.prevCheckTime;!A.enabled||_&&v-_<A.interval||(this.prevCheckTime=v,this.checkIntersections())},checkIntersections:function(){var v=this.clearedIntersectedEls,A=this.el,_=this.data,E,w=this.intersectedEls,S,T=this.intersections,R=this.newIntersectedEls,L=this.newIntersections,I=this.prevIntersectedEls,N=this.rawIntersections;for(this.dirty&&this.refreshObjects(),x(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),N.length=0,this.raycaster.intersectObjects(this.objects,!0,N),T.length=0,w.length=0,E=0;E<N.length;E++)S=N[E],!(_.showLine&&S.object===A.getObject3D("line"))&&S.object.el&&(T.push(S),w.push(S.object.el));for(L.length=0,R.length=0,E=0;E<T.length;E++)I.indexOf(T[E].object.el)===-1&&(L.push(T[E]),R.push(T[E].object.el));for(v.length=0,E=0;E<I.length;E++)w.indexOf(I[E])===-1&&(I[E].emit(g.INTERSECT_CLEAR,this.intersectedClearedDetail),v.push(I[E]));for(v.length&&A.emit(g.INTERSECTION_CLEAR,this.intersectionClearedDetail),E=0;E<R.length;E++)R[E].emit(g.INTERSECT,this.intersectedDetail);L.length&&(this.intersectionDetail.els=R,this.intersectionDetail.intersections=L,A.emit(g.INTERSECTION,this.intersectionDetail)),(I.length===0&&T.length>0||I.length>0&&T.length===0||I.length&&T.length&&I[0]!==T[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=T,A.emit(g.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),_.showLine&&setTimeout(this.updateLine)},updateLine:function(){var v=this.el,A=this.intersections,_;A.length&&(A[0].object.el===v&&A[1]?_=A[1].distance:_=A[0].distance),this.drawLine(_)},getIntersection:function(v){var A,_;for(A=0;A<this.intersections.length;A++)if(_=this.intersections[A],_.object.el===v)return _;return null},updateOriginDirection:function(){var v=new u.Vector3,A=new u.Vector3;return function(){var E=this.el,w=this.data;if(w.useWorldCoordinates){this.raycaster.set(w.origin,w.direction);return}E.object3D.updateMatrixWorld(),A.setFromMatrixPosition(E.object3D.matrixWorld),(w.origin.x!==0||w.origin.y!==0||w.origin.z!==0)&&(A=E.object3D.localToWorld(A.copy(w.origin))),v.copy(w.direction).transformDirection(E.object3D.matrixWorld).normalize(),this.raycaster.set(A,v)}}(),drawLine:function(v){var A=this.data,_=this.el,E;E=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,v===void 0&&(v=A.far===1/0?1e3:A.far),this.lineData.start=A.origin,this.lineData.end=E.copy(this.unitLineEndVec3).multiplyScalar(v),this.lineData.color=A.lineColor,this.lineData.opacity=A.lineOpacity,_.setAttribute("line",this.lineData)},flattenObject3DMaps:function(v){var A,_,E=this.objects;for(E.length=0,_=0;_<v.length;_++)if(v[_].isEntity&&v[_].object3D)for(A in v[_].object3DMap)E.push(v[_].getObject3D(A));return E},clearAllIntersections:function(){var v;for(v=0;v<this.intersectedEls.length;v++)this.intersectedEls[v].emit(g.INTERSECT_CLEAR,this.intersectedClearedDetail);x(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(g.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function x(v,A){var _;for(v.length=A.length,_=0;_<A.length;_++)v[_]=A[_]}},{"../core/component":136,"../lib/three":184,"../utils/":212}],101:[function(i,o,l){var a=i("../lib/three").Math.degToRad,u=i("../core/component").registerComponent;o.exports.Component=u("rotation",{schema:{type:"vec3"},update:function(){var h=this.data,f=this.el.object3D;f.rotation.set(a(h.x),a(h.y),a(h.z)),f.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":136,"../lib/three":184}],102:[function(i,o,l){var a=i("../core/component").registerComponent,u=1e-5;o.exports.Component=a("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var h=this.data,f=this.el.object3D,d=h.x===0?u:h.x,m=h.y===0?u:h.y,g=h.z===0?u:h.z;f.scale.set(d,m,g)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":136}],103:[function(i,o,l){var a="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",u=i("../../core/component").registerComponent,h=i("../../lib/three"),f=21,d=function(){var v=new h.Quaternion,A=new h.Vector3;function _(E,w,S){w.position.copy(E.transform.position),w.quaternion.copy(E.transform.orientation),A.copy(S),v.copy(E.transform.orientation),A.applyQuaternion(v),w.position.sub(A)}return _}();d.tempFakePose={transform:{orientation:new h.Quaternion,position:new h.Vector3}};function m(v,A){this.renderer=v,this.xrHitTestSource=null,v.xr.addEventListener("sessionend",function(){this.xrHitTestSource=null}.bind(this)),v.xr.addEventListener("sessionstart",function(){this.sessionStart(A)}.bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(A)}m.prototype.previousFrameAnchors=new Set,m.prototype.anchorToObject3D=new Map;function g(v){console.warn(v.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}m.prototype.sessionStart=function(A){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){g({message:"No requestHitTestSource on the session."});return}A.space?this.session.requestHitTestSource(A).then(function(_){this.xrHitTestSource=_}.bind(this)).catch(g):A.profile&&this.session.requestHitTestSourceForTransientInput(A).then(function(_){this.xrHitTestSource=_,this.transient=!0}.bind(this)).catch(g)},m.prototype.anchorFromLastHitTestResult=function(v,A){var _=this.lastHitTest;if(!!_){var E={object3D:v,offset:A};Array.from(this.anchorToObject3D.entries()).forEach(function(w){var S=w[1].object3D,T=w[0];S===v&&(this.anchorToObject3D.delete(T),T.delete())}.bind(this)),_.createAnchor&&_.createAnchor().then(function(w){this.anchorToObject3D.set(w,E)}.bind(this)).catch(function(w){console.warn(w.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},m.prototype.doHit=function(A){if(!!this.renderer.xr.isPresenting){var _=this.renderer.xr.getReferenceSpace(),E=A.getViewerPose(_),w,S;if(this.xrHitTestSource&&E)return this.transient?(w=A.getHitTestResultsForTransientInput(this.xrHitTestSource),w.length>0?(S=w[0].results,S.length>0?(this.lastHitTest=S[0],S[0].getPose(_)):!1):!1):(w=A.getHitTestResults(this.xrHitTestSource),w.length>0?(this.lastHitTest=w[0],w[0].getPose(_)):!1)}},m.updateAnchorPoses=function(v,A){var _=v.trackedAnchors||m.prototype.previousFrameAnchors;m.prototype.previousFrameAnchors.forEach(function(E){_.has(E)||m.prototype.anchorToObject3D.delete(E)}),_.forEach(function(E){var w,S,T,R;try{w=v.getPose(E.anchorSpace,A)}catch{}w&&(S=m.prototype.anchorToObject3D.get(E),T=S.offset,R=S.object3D,d(w,R,T))})};var x;o.exports.Component=u("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:a,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(512*512*4),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new h.OrthographicCamera,this.orthoCam.layers.set(f),this.textureTarget=new h.WebGLRenderTarget(512,512,{}),this.basicMaterial=new h.MeshBasicMaterial({color:0,side:h.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new h.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var v=this.el.getAttribute("webxr"),A=v.optionalFeatures;(!A.includes("hit-test")||!A.includes("anchors"))&&(A.push("hit-test"),A.push("anchors"),this.el.setAttribute("webxr",v)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",function(){this.hitTest=null}.bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",function(){if(!!this.el.is("ar-mode")){var _=this.el.sceneEl.renderer,E=this.session=_.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,x||(x=new Map),E.requestReferenceSpace("viewer").then(function(T){this.hitTest=new m(_,{space:T}),x.set(T,this.hitTest),this.el.emit("ar-hit-test-start")}.bind(this));var w="generic-touchscreen",S=new m(_,{profile:w});E.addEventListener("selectstart",function(T){if(this.data.enabled===!0){var R=T.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:R,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),R.profiles[0]===w?this.hitTest=S:(this.hitTest=x.get(R)||new m(_,{space:R.targetRaySpace}),x.set(R,this.hitTest)))}}.bind(this)),E.addEventListener("selectend",function(T){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var R=T.inputSource,L;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(L=this.data.target.object3D,L&&(d.tempFakePose.transform.position.copy(this.bboxMesh.position),d.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),d(d.tempFakePose,L,this.bboxOffset),L.visible=!0,this.hitTest.anchorFromLastHitTestResult(L,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:R,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}.bind(this))}}.bind(this)),this.bboxOffset=new h.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(f),this.data.target.object3D.traverse(function(v){v.layers.enable(f)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var v=new h.PlaneGeometry(1,1),A=new h.MeshBasicMaterial({transparent:!0,color:16777215});v.rotateX(-Math.PI/2),v.rotateY(-Math.PI/2),this.bbox=new h.Box3,this.bboxMesh=new h.Mesh(v,A),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var v,A=this.el.sceneEl.renderer,_,E,w=A.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),_=A.getRenderTarget(),A.setRenderTarget(this.textureTarget),A.xr.enabled=!1,E=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,A.render(this.el.object3D,this.orthoCam),this.el.object3D.background=E,this.el.object3D.overrideMaterial=null,A.xr.enabled=w,A.setRenderTarget(_),A.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),v=this.context.getImageData(0,0,512,512);for(var S=0;S<512*512;S++)v.data[S*4+3]!==0&&v.data[S*4+3]!==255&&(v.data[S*4+3]=128);this.context.putImageData(v,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var v,A=this.el.sceneEl.frame,_=this.el.sceneEl.renderer;if(A&&m.updateAnchorPoses(A,_.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var E;this.textureCache.has(this.data.src)?E=this.textureCache.get(this.data.src):(E=new h.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,E)),this.bboxMesh.material.map=E,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(v=this.hitTest.doHit(A),v&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(v.transform.position),this.bboxMesh.quaternion.copy(v.transform.orientation)))}})},{"../../core/component":136,"../../lib/three":184}],104:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../core/component").components;o.exports.Component=a("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var h=this.data,f=this.el.object3D;h.transparent?f.background=null:f.background=new THREE.Color(h.color)},remove:function(){var h=this.data,f=this.el.object3D;if(h.transparent){f.background=null;return}f.background=u[this.name].schema.color.default}})},{"../../core/component":136}],105:[function(i,o,l){var a=i("../../core/component").registerComponent;o.exports.Component=a("debug",{schema:{default:!0}})},{"../../core/component":136}],106:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../utils/"),h=u.bind,f=i("../../constants/"),d="a-modal",m="a-dialog",g="a-dialog-text",x="a-dialog-text-container",v="a-dialog-buttons-container",A="a-dialog-button",_="a-dialog-allow-button",E="a-dialog-deny-button",w="a-dialog-ok-button";o.exports.Component=a("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var L=this;if(!!this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),typeof DeviceOrientationEvent>"u"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=h(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=h(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){L.devicePermissionDialogEl=S(L.data.denyButtonText,L.data.allowButtonText,L.data.deviceMotionMessage,L.onDeviceMotionDialogAllowClicked,L.onDeviceMotionDialogDenyClicked),L.el.appendChild(L.devicePermissionDialogEl)}).then(function(){L.el.emit("deviceorientationpermissiongranted"),L.permissionGranted=!0})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var L=this,I=T(L.data.cancelButtonText,L.data.httpsMessage,function(){L.el.removeChild(I)});this.el.appendChild(I)},onDeviceMotionDialogAllowClicked:function(){var L=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(I){I==="granted"?(L.el.emit("deviceorientationpermissiongranted"),L.permissionGranted=!0):L.el.emit("deviceorientationpermissionrejected"),L.remove()}).catch(console.error)}});function S(L,I,N,B,H){var q,le,ne;return q=document.createElement("div"),q.classList.add(v),le=document.createElement("button"),le.classList.add(A,E),le.setAttribute(f.AFRAME_INJECTED,""),le.innerHTML=L,q.appendChild(le),ne=document.createElement("button"),ne.classList.add(A,_),ne.setAttribute(f.AFRAME_INJECTED,""),ne.innerHTML=I,q.appendChild(ne),ne.addEventListener("click",function(D){D.stopPropagation(),B()}),le.addEventListener("click",function(D){D.stopPropagation(),H()}),R(N,q)}function T(L,I,N){var B,H;return B=document.createElement("div"),B.classList.add(v),H=document.createElement("button"),H.classList.add(A,w),H.setAttribute(f.AFRAME_INJECTED,""),H.innerHTML=L,B.appendChild(H),H.addEventListener("click",function(q){q.stopPropagation(),N()}),R(I,B)}function R(L,I){var N,B,H,q;return N=document.createElement("div"),N.classList.add(d),N.setAttribute(f.AFRAME_INJECTED,""),B=document.createElement("div"),B.className=m,B.setAttribute(f.AFRAME_INJECTED,""),N.appendChild(B),H=document.createElement("div"),H.classList.add(x),B.appendChild(H),q=document.createElement("div"),q.classList.add(g),q.innerHTML=L,H.appendChild(q),B.appendChild(I),N}},{"../../constants/":128,"../../core/component":136,"../../utils/":212}],107:[function(i,o,l){var a=i("../../core/component").registerComponent;o.exports.Component=a("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var u=this.el,h=u.querySelector(".a-enter-vr");this.data===!0?(h&&h.classList.add("embedded"),u.removeFullScreenStyles()):(h&&h.classList.remove("embedded"),u.addFullScreenStyles())}})},{"../../core/component":136}],108:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../lib/three"),h=i("../../utils/debug"),f=h("components:fog:warn");o.exports.Component=a("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var m=this.data,g=this.el,x=this.el.object3D.fog;if(!g.isScene){f("Fog component can only be applied to <a-scene>");return}if(!x||m.type!==x.name){g.object3D.fog=d(m),g.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(v){var A=m[v];v==="color"&&(A=new u.Color(A)),x[v]=A})},remove:function(){var m=this.el.object3D.fog;!m||(m.far=0,m.near=.1)}});function d(m){var g;return m.type==="exponential"?g=new u.FogExp2(m.color,m.density):g=new u.Fog(m.color,m.near,m.far),g.name=m.type,g}},{"../../core/component":136,"../../lib/three":184,"../../utils/debug":208}],109:[function(i,o,l){(function(a){var u=i("../../constants").AFRAME_INJECTED,h=i("../../../package"),f=i("../../core/component").registerComponent,d=i("../../utils/");function m(E){var w=E.split(".");return w[2]="x",w.join(".")}var g="https://aframe.io/aframe-inspector/dist/aframe-inspector.js",x="https://unpkg.com/aframe-inspector@"+m(h.version)+"/dist/aframe-inspector.min.js",v={}.INSPECTOR_VERSION==="dev"?g:x,A="Loading Inspector",_="Error loading Inspector";o.exports.Component=f("inspector",{schema:{url:{default:v}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var E;!this.firstPlay||(E=d.getUrlParameter("inspector"),E!=="false"&&!!E&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var E='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=A+E},remove:function(){this.removeEventListeners()},onKeydown:function(E){var w=E.keyCode===73&&(E.ctrlKey&&E.altKey||E.getModifierState("AltGraph"));!w||this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(E){E.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(E){var w=this,S;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(E);return}this.showLoader(),S=document.createElement("script"),S.src=this.data.url,S.setAttribute("data-name","aframe-inspector"),S.setAttribute(u,""),S.onload=function(){AFRAME.INSPECTOR.open(E),w.hideLoader(),w.removeEventListeners()},S.onerror=function(){w.loadingMessageEl.innerHTML=_},document.head.appendChild(S),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,i("_process"))},{"../../../package":74,"../../constants":128,"../../core/component":136,"../../utils/":212,_process:49}],110:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../utils/").shouldCaptureKeyEvent;o.exports.Component=a("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(h){var f=this.data;this.enterVREnabled=f.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(h){var f=this.el;!u(h)||(this.enterVREnabled&&h.keyCode===70&&f.enterVR(),this.enterVREnabled&&h.keyCode===27&&f.exitVR())}})},{"../../core/component":136,"../../utils/":212}],111:[function(i,o,l){var a=i("../../utils/debug"),u=i("../../core/component").registerComponent,h=a("components:pool:warn");o.exports.Component=u("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var f;for(this.availableEls=[],this.usedEls=[],this.data.mixin||h("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||h("Container "+this.data.container+" not found.")),this.container=this.container||this.el,f=0;f<this.data.size;++f)this.createEntity()},update:function(f){var d=this.data;(f.mixin!==d.mixin||f.size!==d.size)&&this.initPool()},createEntity:function(){var f;f=document.createElement("a-entity"),f.play=this.wrapPlay(f.play),f.setAttribute("mixin",this.data.mixin),f.object3D.visible=!1,f.pause(),this.container.appendChild(f),this.availableEls.push(f)},wrapPlay:function(f){var d=this.usedEls;return function(){d.indexOf(this)!==-1&&f.call(this)}},requestEntity:function(){var f;if(this.availableEls.length===0){if(this.data.dynamic===!1){h("Requested entity from empty pool: "+this.attrName);return}else h("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return f=this.availableEls.shift(),this.usedEls.push(f),f.object3D.visible=!0,f},returnEntity:function(f){var d=this.usedEls.indexOf(f);if(d===-1){h("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(d,1),this.availableEls.push(f),f.object3D.visible=!1,f.pause(),f}})},{"../../core/component":136,"../../utils/debug":208}],112:[function(i,o,l){var a=i("../../core/component").registerComponent;function u(h,f,d,m){var g=Math.max(h.primaryLightIntensity.x,Math.max(h.primaryLightIntensity.y,h.primaryLightIntensity.z));f.sh.fromArray(h.sphericalHarmonicsCoefficients),f.intensity=1,d&&(d.color.setRGB(h.primaryLightIntensity.x/g,h.primaryLightIntensity.y/g,h.primaryLightIntensity.z/g),d.intensity=g,m.copy(h.primaryLightDirection))}o.exports.Component=a("reflection",{schema:{directionalLight:{type:"selector"}},init:function(){var h=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var f=this.el.getAttribute("webxr"),d=f.optionalFeatures;d.includes("light-estimation")||(d.push("light-estimation"),this.el.setAttribute("webxr",f)),this.el.addEventListener("enter-vr",function(){var m=h.el.renderer,g=m.xr.getSession();g.requestLightProbe&&h.el.is("ar-mode")&&h.startLightProbe()}),this.el.addEventListener("exit-vr",function(){h.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var h=this.el.renderer,f=h.xr.getSession(),d=this,m=h.getContext();if(!this.probeLight){var g=document.createElement("a-light");g.setAttribute("type","probe"),g.setAttribute("intensity",0),this.el.appendChild(g),this.probeLight=g}switch(f.preferredReflectionFormat){case"srgba8":m.getExtension("EXT_sRGB");break;case"rgba16f":m.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(f,m),m.getExtension("EXT_sRGB"),m.getExtension("OES_texture_half_float"),f.requestLightProbe().then(function(x){d.xrLightProbe=x,x.addEventListener("reflectionchange",d.updateXRCubeMap.bind(d))}).catch(function(x){console.warn("Lighting estimation not supported: "+x.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var h=this.el.renderer,f=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(f){var d=h.properties.get(this.lightingEstimationTexture);d.__webglTexture=f,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var h=this.el.object3D,f=this.el.renderer,d=this.el.frame;if(d&&this.xrLightProbe){var m=d.getLightEstimate(this.xrLightProbe);m&&u(m,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(h.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(f,h),this.el.object3D.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&d&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.removeChild(this.probeLight)}})},{"../../core/component":136}],113:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../lib/three"),h=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),f=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);o.exports.Component=a("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var d=this.el,m=this;d.renderer?g():d.addEventListener("render-target-loaded",g);function g(){var x=d.renderer.getContext();!x||(m.cubeMapSize=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE),m.material=new u.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:h,fragmentShader:f,side:u.DoubleSide}),m.quad=new u.Mesh(new u.PlaneBufferGeometry(1,1),m.material),m.quad.visible=!1,m.camera=new u.OrthographicCamera(-1/2,1/2,1/2,-1/2,-1e4,1e4),m.canvas=document.createElement("canvas"),m.ctx=m.canvas.getContext("2d"),d.object3D.add(m.quad),m.onKeyDown=m.onKeyDown.bind(m))}},getRenderTarget:function(d,m){return new u.WebGLRenderTarget(d,m,{encoding:u.sRGBEncoding,minFilter:u.LinearFilter,magFilter:u.LinearFilter,wrapS:u.ClampToEdgeWrapping,wrapT:u.ClampToEdgeWrapping,format:u.RGBAFormat,type:u.UnsignedByteType})},resize:function(d,m){this.quad.scale.set(d,m,1),this.camera.left=-1*d/2,this.camera.right=d/2,this.camera.top=m/2,this.camera.bottom=-1*m/2,this.camera.updateProjectionMatrix(),this.canvas.width=d,this.canvas.height=m},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(d){var m=d.keyCode===83&&d.ctrlKey&&d.altKey;if(!(!this.data||!m)){var g=d.shiftKey?"equirectangular":"perspective";this.capture(g)}},setCapture:function(d){var m=this.el,g,x,v,A;return d==="perspective"?(this.quad.visible=!1,x=this.data.camera&&this.data.camera.components.camera.camera||m.camera,g={width:this.data.width,height:this.data.height}):(x=this.camera,A=new u.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:u.RGBFormat,generateMipmaps:!0,minFilter:u.LinearMipmapLinearFilter,encoding:u.sRGBEncoding}),v=new u.CubeCamera(m.camera.near,m.camera.far,A),m.camera.getWorldPosition(v.position),m.camera.getWorldQuaternion(v.quaternion),v.update(m.renderer,m.object3D),this.quad.material.uniforms.map.value=v.renderTarget.texture,g={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:x,size:g,projection:d}},capture:function(d){var m=this.el.renderer.xr.enabled,g=this.el.renderer,x;g.xr.enabled=!1,x=this.setCapture(d),this.renderCapture(x.camera,x.size,x.projection),this.saveCapture(),g.xr.enabled=m},getCanvas:function(d){var m=this.el.renderer.xr.enabled,g=this.el.renderer,x=this.setCapture(d);return g.xr.enabled=!1,this.renderCapture(x.camera,x.size,x.projection),g.xr.enabled=m,this.canvas},renderCapture:function(d,m,g){var x=this.el.renderer.autoClear,v=this.el,A,_,E,w=v.renderer;_=this.getRenderTarget(m.width,m.height),E=new Uint8Array(4*m.width*m.height),this.resize(m.width,m.height),w.autoClear=!0,w.clear(),w.setRenderTarget(_),w.render(v.object3D,d),w.autoClear=x,w.readRenderTargetPixels(_,0,0,m.width,m.height,E),w.setRenderTarget(null),g==="perspective"&&(E=this.flipPixelsVertically(E,m.width,m.height)),A=new ImageData(new Uint8ClampedArray(E),m.width,m.height),this.quad.visible=!1,this.ctx.putImageData(A,0,0)},flipPixelsVertically:function(d,m,g){for(var x=d.slice(0),v=0;v<m;++v)for(var A=0;A<g;++A)x[v*4+A*m*4]=d[v*4+(g-A)*m*4],x[v*4+1+A*m*4]=d[v*4+1+(g-A)*m*4],x[v*4+2+A*m*4]=d[v*4+2+(g-A)*m*4],x[v*4+3+A*m*4]=d[v*4+3+(g-A)*m*4];return x},saveCapture:function(){this.canvas.toBlob(function(d){var m="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",g=document.createElement("a"),x=URL.createObjectURL(d);g.href=x,g.setAttribute("download",m),g.innerHTML="downloading...",g.style.display="none",document.body.appendChild(g),setTimeout(function(){g.click(),document.body.removeChild(g)},1)},"image/png")}})},{"../../core/component":136,"../../lib/three":184}],114:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../../vendor/rStats"),h=i("../../utils");i("../../../vendor/rStats.extras"),i("../../lib/rStatsAframe");var f=window.aframeStats,d=h.bind,m="a-hidden",g=window.threeStats;o.exports.Component=a("stats",{schema:{default:!0},init:function(){var v=this.el;h.getUrlParameter("stats")!=="false"&&(this.stats=x(v),this.statsEl=document.querySelector(".rs-base"),this.hideBound=d(this.hide,this),this.showBound=d(this.show,this),v.addEventListener("enter-vr",this.hideBound),v.addEventListener("exit-vr",this.showBound))},update:function(){if(!!this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var v=this.stats;!v||(v("rAF").tick(),v("FPS").frame(),v().update())},hide:function(){this.statsEl.classList.add(m)},show:function(){this.statsEl.classList.remove(m)}});function x(v){var A=new g(v.renderer),_=new f(v),E=v.isMobile?[]:[A,_];return new u({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:E})}},{"../../../vendor/rStats":224,"../../../vendor/rStats.extras":223,"../../core/component":136,"../../lib/rStatsAframe":183,"../../utils":212}],115:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../constants/"),h=i("../../utils/"),f=h.bind,d="a-enter-vr",m="a-enter-ar",g="a-enter-vr-button",x="a-enter-ar-button",v="a-hidden",A="a-orientation-modal";o.exports.Component=a("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var T=this,R=this.el;h.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),R.addEventListener("enter-vr",this.updateEnterInterfaces),R.addEventListener("exit-vr",this.updateEnterInterfaces),R.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(L){L.data.type==="loaderReady"&&(T.insideLoader=!0,T.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=f(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=f(this.onEnterARButtonClick,this),this.onModalClick=f(this.onModalClick,this),this.toggleOrientationModalIfNeeded=f(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=f(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var T=this.data,R=this.el;if(!T.enabled||this.insideLoader||h.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(T.enterVRButton?(this.enterVREl=document.querySelector(T.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=_(this.onEnterVRButtonClick),R.appendChild(this.enterVREl)),T.enterARButton?(this.enterAREl=document.querySelector(T.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=E(this.onEnterARButtonClick),R.appendChild(this.enterAREl)),this.orientationModalEl=w(this.onModalClick),R.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(T){T&&T.parentNode&&T.parentNode.removeChild(T)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var T=this.el;!this.enterVREl||(T.is("vr-mode")?this.enterVREl.classList.add(v):this.enterVREl.classList.remove(v))},toggleEnterARButtonIfNeeded:function(){var T=this.el;!this.enterAREl||(T.is("vr-mode")||!h.device.checkARSupport()?this.enterAREl.classList.add(v):this.enterAREl.classList.remove(v))},toggleOrientationModalIfNeeded:function(){var T=this.el,R=this.orientationModalEl;!R||!T.isMobile||(!h.device.isLandscape()&&T.is("vr-mode")?R.classList.remove(v):R.classList.add(v))}});function _(T){var R,L;return L=document.createElement("div"),L.classList.add(d),L.setAttribute(u.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=g,R.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),R.setAttribute(u.AFRAME_INJECTED,""),h.device.isMobile()&&S(R),L.appendChild(R),R.addEventListener("click",function(I){T(),I.stopPropagation()}),L}function E(T){var R,L;return L=document.createElement("div"),L.classList.add(m),L.setAttribute(u.AFRAME_INJECTED,""),R=document.createElement("button"),R.className=x,R.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information."),R.setAttribute(u.AFRAME_INJECTED,""),h.device.isMobile()&&S(R),L.appendChild(R),R.addEventListener("click",function(I){T(),I.stopPropagation()}),L}function w(T){var R=document.createElement("div");R.className=A,R.classList.add(v),R.setAttribute(u.AFRAME_INJECTED,"");var L=document.createElement("button");return L.setAttribute(u.AFRAME_INJECTED,""),L.innerHTML="Exit VR",L.addEventListener("click",T),R.appendChild(L),R}function S(T){T.addEventListener("touchstart",function(){T.classList.remove("resethover")}),T.addEventListener("touchend",function(){T.classList.add("resethover")})}},{"../../constants/":128,"../../core/component":136,"../../utils/":212}],116:[function(i,o,l){var a=i("../core/component"),u=i("../lib/three"),h=i("../utils/bind"),f=a.registerComponent;o.exports.Component=f("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=h(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var d=this.data;this.updateDescendants(d.cast,d.receive)},remove:function(){var d=this.el;d.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(d,m){var g=this.el.sceneEl;this.el.object3D.traverse(function(x){if(x instanceof u.Mesh&&(x.castShadow=d,x.receiveShadow=m,g.hasLoaded&&x.material))for(var v=Array.isArray(x.material)?x.material:[x.material],A=0;A<v.length;A++)v[A].needsUpdate=!0})}})},{"../core/component":136,"../lib/three":184,"../utils/bind":206}],117:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/debug"),h=i("../lib/three"),f=u("components:sound:warn");o.exports.Component=a("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var d=this;this.listener=null,this.audioLoader=new h.AudioLoader,this.pool=new h.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){d.playSound()}},update:function(d){var m=this.data,g,x,v=m.src!==d.src;if(v){if(!m.src)return;this.setupSound()}for(g=0;g<this.pool.children.length;g++)x=this.pool.children[g],m.positional&&(x.setDistanceModel(m.distanceModel),x.setMaxDistance(m.maxDistance),x.setRefDistance(m.refDistance),x.setRolloffFactor(m.rolloffFactor)),x.setLoop(m.loop),x.setVolume(m.volume),x.isPaused=!1;if(m.on!==d.on&&this.updateEventListener(d.on),v){var A=this;this.loaded=!1,this.audioLoader.load(m.src,function(_){for(g=0;g<A.pool.children.length;g++)x=A.pool.children[g],x.setBuffer(_);A.loaded=!0,h.Cache.remove(m.src),(A.data.autoplay||A.mustPlay)&&A.playSound(),A.el.emit("sound-loaded",A.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var d,m;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(d=0;d<this.pool.children.length;d++)m=this.pool.children[d],m.disconnect()}catch{f("Audio source not properly disconnected")}},updateEventListener:function(d){var m=this.el;d&&m.removeEventListener(d,this.playSoundBound),m.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var d=this.el,m,g=d.sceneEl,x=this,v;this.pool.children.length>0&&(this.stopSound(),d.removeObject3D("sound"));var A=this.listener=g.audioListener||new h.AudioListener;for(g.audioListener=A,g.camera&&g.camera.add(A),g.addEventListener("camera-set-active",function(_){_.detail.cameraEl.getObject3D("camera").add(A)}),this.pool=new h.Group,m=0;m<this.data.poolSize;m++)v=this.data.positional?new h.PositionalAudio(A):new h.Audio(A),this.pool.add(v);for(d.setObject3D(this.attrName,this.pool),m=0;m<this.pool.children.length;m++)v=this.pool.children[m],v.onEnded=function(){this.isPlaying=!1,x.el.emit("sound-ended",x.evtDetail,!1)}},pauseSound:function(){var d,m;for(this.isPlaying=!1,d=0;d<this.pool.children.length;d++)m=this.pool.children[d],!(!m.source||!m.source.buffer||!m.isPlaying||m.isPaused)&&(m.isPaused=!0,m.pause())},playSound:function(d){var m,g,x;if(!this.loaded){f("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0;return}for(m=!1,this.isPlaying=!0,g=0;g<this.pool.children.length;g++)if(x=this.pool.children[g],!x.isPlaying&&x.buffer&&!m){d&&d(x),x.play(),x.isPaused=!1,m=!0;continue}if(!m){f("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1},stopSound:function(){var d,m;for(this.isPlaying=!1,d=0;d<this.pool.children.length;d++){if(m=this.pool.children[d],!m.source||!m.source.buffer)return;m.stop()}}})},{"../core/component":136,"../lib/three":184,"../utils/debug":208}],118:[function(i,o,l){var a=i("three-bmfont-text"),u=i("load-bmfont"),h=i("../core/component").registerComponent,f=i("../core/shader"),d=i("../lib/three"),m=i("../utils/"),g=m.debug("components:text:error"),x=f.shaders,v=m.debug("components:text:warn"),A=1,_=16,E="https://cdn.aframe.io/fonts/",w={aileronsemibold:E+"Aileron-Semibold.fnt",dejavu:E+"DejaVu-sdf.fnt",exo2bold:E+"Exo2Bold.fnt",exo2semibold:E+"Exo2SemiBold.fnt",kelsonsans:E+"KelsonSans.fnt",monoid:E+"Monoid.fnt",mozillavr:E+"mozillavr.fnt",roboto:E+"Roboto-msdf.json",sourcecodepro:E+"SourceCodePro.fnt"},S=["roboto"],T="roboto";o.exports.FONTS=w;var R=new O,L={},I={},N=/^\w+:/;o.exports.Component=h("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:T},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:x},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=a(),this.createOrUpdateMaterial()},update:function(k){var z=this.data,X=this.currentFont;if(I[z.font]?this.texture=I[z.font]:(this.texture=I[z.font]=new d.Texture,this.texture.anisotropy=_),this.createOrUpdateMaterial(),k.font!==z.font){this.updateFont();return}X&&(this.updateGeometry(this.geometry,X),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var k=this.data,z,X=this.material,Z,ie=this.shaderData,se;if(se=k.shader,S.indexOf(k.font)!==-1||k.font.indexOf("-msdf.")>=0?se="msdf":k.font in w&&S.indexOf(k.font)===-1&&(se="sdf"),z=(this.shaderObject&&this.shaderObject.name)!==se,ie.alphaTest=k.alphaTest,ie.color=k.color,ie.map=this.texture,ie.opacity=k.opacity,ie.side=B(k.side),ie.transparent=k.transparent,ie.negate=k.negate,!z){this.shaderObject.update(ie),X.transparent=ie.transparent,X.side=ie.side;return}Z=le(this.el,se,ie),this.material=Z.material,this.shaderObject=Z.shader,this.material.side=ie.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var k=this.data,z=this.el,X,Z=this.geometry,ie=this;k.font||v("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),X=this.lookupFont(k.font||T)||k.font,R.get(X,function(){return H(X,k.yOffset)}).then(function(ue){var ye;if(ue.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");L[X]||(ue.widthFactor=L[ue]=D(ue)),ie.currentFont=ue,ye=ie.getFontImageSrc(),R.get(ye,function(){return q(ye)}).then(function(Ce){var ke=ie.texture;ke.image=Ce,ke.needsUpdate=!0,I[k.font]=ke,ie.texture=ke,ie.initMesh(),ie.currentFont=ue,ie.updateGeometry(Z,ue),ie.updateLayout(),ie.mesh.visible=!0,z.emit("textfontset",{font:k.font,fontObj:ue})}).catch(function(Ce){g(Ce.message),g(Ce.stack)})}).catch(function(se){g(se.message),g(se.stack)})},initMesh:function(){this.mesh||(this.mesh=new d.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var k=this.lookupFont(this.data.font||T)||this.data.font,z=this.currentFont.pages[0];return z.match(N)&&z.indexOf("http")!==0?k.replace(/(\.fnt)|(\.json)/,".png"):d.LoaderUtils.extractUrlBase(k)+z},updateLayout:function(){var k,z,X=this.el,Z=this.data,ie=this.geometry,se,ue,ye,Ce=this.mesh,ke,Oe,Ne,He,Qe;if(!(!Ce||!ie.layout)){if(se=X.getAttribute("geometry"),Ne=Z.width||se&&se.width||A,ke=ne(Z.wrapPixels,Z.wrapCount,this.currentFont.widthFactor),Oe=Ne/ke,ye=ie.layout,ue=Oe*(ye.height+ye.descender),se&&se.primitive==="plane"&&(se.width||X.setAttribute("geometry","width",Ne),se.height||X.setAttribute("geometry","height",ue)),k=Z.anchor==="align"?Z.align:Z.anchor,k==="left")He=0;else if(k==="right")He=-1*ye.width;else if(k==="center")He=-1*ye.width/2;else throw new TypeError("Invalid text.anchor property value",k);if(z=Z.baseline,z==="bottom")Qe=0;else if(z==="top")Qe=-1*ye.height+ye.ascender;else if(z==="center")Qe=-1*ye.height/2;else throw new TypeError("Invalid text.baseline property value",z);Ce.position.x=He*Oe+Z.xOffset,Ce.position.y=Qe*Oe,Ce.position.z=Z.zOffset,Ce.scale.set(Oe,-1*Oe,Oe)}},lookupFont:function(k){return w[k]},updateGeometry:function(){var k={},z={},X=/\\n/g,Z=/\\t/g;return function(ie,se){var ue=this.data;z.font=se,z.lineHeight=ue.lineHeight&&isFinite(ue.lineHeight)?ue.lineHeight:se.common.lineHeight,z.text=ue.value.toString().replace(X,`
`).replace(Z,"	"),z.width=ne(ue.wrapPixels,ue.wrapCount,se.widthFactor),ie.update(m.extend(k,ue,z))}}()});function B(k){switch(k){case"back":return d.FrontSide;case"double":return d.DoubleSide;default:return d.BackSide}}function H(k,z){return new Promise(function(X,Z){u(k,function(ie,se){if(ie){g("Error loading font",k),Z(ie);return}k.indexOf("/Roboto-msdf.json")>=0&&(z=30),z&&se.chars.map(function(ye){ye.yoffset+=z}),X(se)})})}function q(k){return new Promise(function(z,X){new d.ImageLoader().load(k,function(Z){z(Z)},void 0,function(){g("Error loading font image",k),X(null)})})}function le(k,z,X){var Z,ie;return ie=new x[z].Shader,ie.el=k,ie.init(X),ie.update(X),Z=ie.material,Z.transparent=X.transparent,{material:Z,shader:ie}}function ne(k,z,X){return k||(.5+z)*X}function D(k){var z=0,X=0,Z=0;return k.chars.map(function(ie){z+=ie.xadvance,ie.id>=48&&ie.id<=57&&(Z++,X+=ie.xadvance)}),Z?X/Z:z/k.chars.length}function O(){var k=this.cache={};this.get=function(z,X){return z in k||(k[z]=X()),k[z]}}},{"../core/component":136,"../core/shader":146,"../lib/three":184,"../utils/":212,"load-bmfont":37,"three-bmfont-text":64}],119:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/tracked-controls"),h=i("../constants").DEFAULT_CAMERA_HEIGHT,f=i("../lib/three"),d=i("../constants").DEFAULT_HANDEDNESS,m={x:.175,y:-.3,z:-.03},g={x:0,y:0,z:-.175},x={touches:[]},v={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};o.exports.Component=a("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new f.Vector3,this.controllerQuaternion=new f.Quaternion,this.controllerEuler=new f.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(A,_){var E=this.el.getObject3D("mesh");E&&E.update&&E.update(_/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return h},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var A=this.data,_=u.findMatchingControllerWebVR(this.system.controllers,A.id,A.idPrefix,A.hand,A.controller);this.controller=_,this.el.components["tracked-controls"].controller=_,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(A){var _=this.controller,E=this.controllerEuler,w=this.controllerQuaternion,S=this.deltaControllerPosition,T,R,L,I,N;R=this.getHeadElement(),L=R.object3D,N=this.defaultUserHeight(),I=_.pose,T=(_?_.hand:void 0)||d,A.copy(L.position),S.set(m.x*(T==="left"?-1:T==="right"?1:0),m.y,m.z),S.multiplyScalar(N),S.applyAxisAngle(L.up,L.rotation.y),A.add(S),S.set(g.x,g.y,g.z),S.multiplyScalar(N),I.orientation?w.fromArray(I.orientation):w.copy(L.quaternion),E.setFromQuaternion(w),E.set(E.x,E.y,0),S.applyEuler(E),A.add(S)},updatePose:function(){var A=this.controller,_=this.data,E=this.el.object3D,w,S=this.system.vrDisplay,T;!A||(w=A.pose,w.position?E.position.fromArray(w.position):_.armModel&&this.applyArmModel(E.position),w.orientation&&E.quaternion.fromArray(w.orientation),S&&w.position&&(T=this.el.sceneEl.renderer.xr.getStandingMatrix(),E.matrix.compose(E.position,E.quaternion,E.scale),E.matrix.multiplyMatrices(T,E.matrix),E.matrix.decompose(E.position,E.quaternion,E.scale)),E.rotateX(this.data.orientationOffset.x*f.Math.DEG2RAD),E.rotateY(this.data.orientationOffset.y*f.Math.DEG2RAD),E.rotateZ(this.data.orientationOffset.z*f.Math.DEG2RAD))},updateButtons:function(){var A,_=this.controller,E;if(!!_){for(E=0;E<_.buttons.length;++E)this.buttonStates[E]||(this.buttonStates[E]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[E]||(this.buttonEventDetails[E]={id:E,state:this.buttonStates[E]}),A=_.buttons[E],this.handleButton(E,A);this.handleAxes()}},handleButton:function(A,_){var E;return E=this.handlePress(A,_)|this.handleTouch(A,_)|this.handleValue(A,_),E?(this.el.emit(v.BUTTONCHANGED,this.buttonEventDetails[A],!1),!0):!1},handleAxes:function(){var A=!1,_=this.controller.axes,E,w=this.axis,S=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),E=0;E<_.length;++E)S.push(w[E]!==_[E]),S[E]&&(A=!0);if(!A)return!1;for(this.axis.splice(0,this.axis.length),E=0;E<_.length;E++)this.axis.push(_[E]);return this.el.emit(v.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(A,_){var E,w=this.buttonStates[A];return _.pressed===w.pressed?!1:(E=_.pressed?v.BUTTONDOWN:v.BUTTONUP,this.el.emit(E,this.buttonEventDetails[A],!1),w.pressed=_.pressed,!0)},handleTouch:function(A,_){var E,w=this.buttonStates[A];return _.touched===w.touched?!1:(E=_.touched?v.TOUCHSTART:v.TOUCHEND,this.el.emit(E,this.buttonEventDetails[A],!1,x),w.touched=_.touched,!0)},handleValue:function(A,_){var E=this.buttonStates[A];return _.value===E.value?!1:(E.value=_.value,!0)}})},{"../constants":128,"../core/component":136,"../lib/three":184,"../utils/tracked-controls":221}],120:[function(i,o,l){var a=i("../utils/tracked-controls"),u=i("../core/component").registerComponent,h={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};o.exports.Component=u("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var f=this.el.sceneEl;this.updateController(),f.addEventListener("controllersupdated",this.updateController)},pause:function(){var f=this.el.sceneEl;f.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(f){return!(!this.controller||this.controller.gamepad||f.inputSource.handedness!=="none"&&f.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=a.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var f=this.el.sceneEl,d=this.controller,m=f.frame;!d||!f.frame||!this.system.referenceSpace||d.hand||(this.pose=m.getPose(d.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var f=this.el.object3D,d=this.pose;!d||(f.matrix.elements=d.transform.matrix,f.matrix.decompose(f.position,f.rotation,f.scale))},updateButtons:function(){var f,d,m=this.controller,g;if(!(!m||!m.gamepad)){for(g=m.gamepad,d=0;d<g.buttons.length;++d)this.buttonStates[d]||(this.buttonStates[d]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[d]||(this.buttonEventDetails[d]={id:d,state:this.buttonStates[d]}),f=g.buttons[d],this.handleButton(d,f);this.handleAxes()}},handleButton:function(f,d){var m;return m=this.handlePress(f,d)|this.handleTouch(f,d)|this.handleValue(f,d),m?(this.el.emit(h.BUTTONCHANGED,this.buttonEventDetails[f],!1),!0):!1},handleAxes:function(){var f=!1,d=this.controller.gamepad.axes,m,g=this.axis,x=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),m=0;m<d.length;++m)x.push(g[m]!==d[m]),x[m]&&(f=!0);if(!f)return!1;for(this.axis.splice(0,this.axis.length),m=0;m<d.length;m++)this.axis.push(d[m]);return this.el.emit(h.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(f,d){var m,g=this.buttonStates[f];return d.pressed===g.pressed?!1:(m=d.pressed?h.BUTTONDOWN:h.BUTTONUP,this.el.emit(m,this.buttonEventDetails[f],!1),g.pressed=d.pressed,!0)},handleTouch:function(f,d){var m,g=this.buttonStates[f];return d.touched===g.touched?!1:(m=d.touched?h.TOUCHSTART:h.TOUCHEND,this.el.emit(m,this.buttonEventDetails[f],!1),g.touched=d.touched,!0)},handleValue:function(f,d){var m=this.buttonStates[f];return d.value===m.value?!1:(m.value=d.value,!0)}})},{"../core/component":136,"../utils/tracked-controls":221}],121:[function(i,o,l){var a=i("../core/component").registerComponent;o.exports.Component=a("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var u=this.data,h=this.el;h.sceneEl.hasWebXR?h.setAttribute("tracked-controls-webxr",{id:u.id,hand:u.hand,index:u.controller,iterateControllerProfiles:u.iterateControllerProfiles,handTrackingEnabled:u.handTrackingEnabled}):h.setAttribute("tracked-controls-webvr",u)}})},{"../core/component":136}],122:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../lib/three"),f=i("../utils/tracked-controls"),d=f.checkControllerPresentAndSetup,m=f.emitIfAxesChanged,g=f.onButtonEvent,x="https://cdn.aframe.io/controllers/valve/index/valve-index-",v={left:x+"left.glb",right:x+"right.glb"},A="valve",_=i("../utils/").device.isWebXRAvailable,E={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},w={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},S={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},T={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},R=_?T:S,L=_?w:E;o.exports.Component=a("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var I=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(N){g(N.detail.id,"down",I)},this.onButtonUp=function(N){g(N.detail.id,"up",I)},this.onButtonTouchEnd=function(N){g(N.detail.id,"touchend",I)},this.onButtonTouchStart=function(N){g(N.detail.id,"touchstart",I)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var I=this.el;I.addEventListener("buttonchanged",this.onButtonChanged),I.addEventListener("buttondown",this.onButtonDown),I.addEventListener("buttonup",this.onButtonUp),I.addEventListener("touchend",this.onButtonTouchEnd),I.addEventListener("touchstart",this.onButtonTouchStart),I.addEventListener("model-loaded",this.onModelLoaded),I.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var I=this.el;I.removeEventListener("buttonchanged",this.onButtonChanged),I.removeEventListener("buttondown",this.onButtonDown),I.removeEventListener("buttonup",this.onButtonUp),I.removeEventListener("touchend",this.onButtonTouchEnd),I.removeEventListener("touchstart",this.onButtonTouchStart),I.removeEventListener("model-loaded",this.onModelLoaded),I.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var I=this.data,N=I.hand==="right"?0:I.hand==="left"?1:2;d(this,A,{index:N,iterateControllerProfiles:!0,hand:I.hand})},injectTrackedControls:function(){var I=this.el,N=this.data;I.setAttribute("tracked-controls",{idPrefix:A,controller:N.hand==="right"?1:N.hand==="left"?0:2,hand:N.hand,orientationOffset:N.orientationOffset}),this.loadModel()},loadModel:function(){var I=this.data;!I.model||this.el.setAttribute("gltf-model",""+v[I.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(I){var N=this.mapping.buttons[I.detail.id],B=this.buttonMeshes,H;!N||(N==="trigger"&&(H=I.detail.state.value,B&&B.trigger&&(B.trigger.rotation.x=this.triggerOriginalRotationX-H*(Math.PI/40))),this.el.emit(N+"changed",I.detail.state))},onModelLoaded:function(I){var N,B=I.detail.model,H=this;!this.data.model||(N=this.buttonMeshes={},N.grip={left:B.getObjectByName("leftgrip"),right:B.getObjectByName("rightgrip")},N.menu=B.getObjectByName("menubutton"),N.system=B.getObjectByName("systembutton"),N.trackpad=B.getObjectByName("touchpad"),N.trigger=B.getObjectByName("trigger"),this.triggerOriginalRotationX=N.trigger.rotation.x,Object.keys(N).forEach(function(q){H.setButtonColor(q,H.data.buttonColor)}),B.position.copy(L[this.data.hand]),B.rotation.copy(R[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new h.Vector3(0,0,0)}))},onAxisMoved:function(I){m(this,this.mapping.axes,I)},updateModel:function(I,N){var B,H;!this.data.model||(H=N.indexOf("touch")!==-1,!H&&(B=N==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(I,B)))},setButtonColor:function(I,N){}})},{"../core/component":136,"../lib/three":184,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],123:[function(i,o,l){var a=i("../core/component").registerComponent;o.exports.Component=a("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":136}],124:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g="https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",x="https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl",v=i("../utils/").device.isWebXRAvailable,A="htc-vive",_="OpenVR ",E=v?A:_,w={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},S={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},T=v?S:w;o.exports.Component=a("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:T,init:function(){var R=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(L){m(L.detail.id,"down",R)},this.onButtonUp=function(L){m(L.detail.id,"up",R)},this.onButtonTouchEnd=function(L){m(L.detail.id,"touchend",R)},this.onButtonTouchStart=function(L){m(L.detail.id,"touchstart",R)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var R=this.data;this.controllerIndex=R.hand==="right"?0:R.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},addEventListeners:function(){var R=this.el;R.addEventListener("buttonchanged",this.onButtonChanged),R.addEventListener("buttondown",this.onButtonDown),R.addEventListener("buttonup",this.onButtonUp),R.addEventListener("touchend",this.onButtonTouchEnd),R.addEventListener("touchstart",this.onButtonTouchStart),R.addEventListener("model-loaded",this.onModelLoaded),R.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var R=this.el;R.removeEventListener("buttonchanged",this.onButtonChanged),R.removeEventListener("buttondown",this.onButtonDown),R.removeEventListener("buttonup",this.onButtonUp),R.removeEventListener("touchend",this.onButtonTouchEnd),R.removeEventListener("touchstart",this.onButtonTouchStart),R.removeEventListener("model-loaded",this.onModelLoaded),R.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var R=this.data;f(this,E,{index:this.controllerIndex,hand:R.hand})},injectTrackedControls:function(){var R=this.el,L=this.data;R.setAttribute("tracked-controls",{idPrefix:E,hand:L.hand,controller:this.controllerIndex,orientationOffset:L.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:g,mtl:x})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(R){var L=this.mapping.buttons[R.detail.id],I=this.buttonMeshes,N;!L||(L==="trigger"&&(N=R.detail.state.value,I&&I.trigger&&(I.trigger.rotation.x=-N*(Math.PI/12))),this.el.emit(L+"changed",R.detail.state))},onModelLoaded:function(R){var L,I=R.detail.model,N=this;!this.data.model||(L=this.buttonMeshes={},L.grip={left:I.getObjectByName("leftgrip"),right:I.getObjectByName("rightgrip")},L.menu=I.getObjectByName("menubutton"),L.system=I.getObjectByName("systembutton"),L.trackpad=I.getObjectByName("touchpad"),L.trigger=I.getObjectByName("trigger"),Object.keys(L).forEach(function(B){N.setButtonColor(B,N.data.buttonColor)}),I.position.set(0,-.015,.04))},onAxisMoved:function(R){d(this,this.mapping.axes,R)},updateModel:function(R,L){var I,N;!this.data.model||(N=L.indexOf("touch")!==-1,!N&&(I=L==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(R,I)))},setButtonColor:function(R,L){var I=this.buttonMeshes,N=this.rendererSystem;if(!!I){if(R==="grip"){I.grip.left.material.color.set(L),I.grip.right.material.color.set(L),N.applyColorCorrection(I.grip.left.material.color),N.applyColorCorrection(I.grip.right.material.color);return}I[R].material.color.set(L),N.applyColorCorrection(I[R].material.color)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],125:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g="HTC Vive Focus",x="https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf";o.exports.Component=a("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=u(this.removeControllersUpdateListener,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var v=this;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(A){m(A.detail.id,"down",v)},this.onButtonUp=function(A){m(A.detail.id,"up",v)},this.onButtonTouchStart=function(A){m(A.detail.id,"touchstart",v)},this.onButtonTouchEnd=function(A){m(A.detail.id,"touchend",v)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var v=this.el;v.addEventListener("buttonchanged",this.onButtonChanged),v.addEventListener("buttondown",this.onButtonDown),v.addEventListener("buttonup",this.onButtonUp),v.addEventListener("touchstart",this.onButtonTouchStart),v.addEventListener("touchend",this.onButtonTouchEnd),v.addEventListener("model-loaded",this.onModelLoaded),v.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var v=this.el;v.removeEventListener("buttonchanged",this.onButtonChanged),v.removeEventListener("buttondown",this.onButtonDown),v.removeEventListener("buttonup",this.onButtonUp),v.removeEventListener("touchstart",this.onButtonTouchStart),v.removeEventListener("touchend",this.onButtonTouchEnd),v.removeEventListener("model-loaded",this.onModelLoaded),v.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){f(this,g,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var v=this.el,A=this.data;v.setAttribute("tracked-controls",{armModel:A.armModel,idPrefix:g,orientationOffset:A.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",x)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(v){var A=v.detail.model,_;!this.data.model||(_=this.buttonMeshes={},_.trigger=A.getObjectByName("BumperKey"),_.triggerPressed=A.getObjectByName("BumperKey_Press"),_.triggerPressed&&(_.triggerPressed.visible=!1),_.trackpad=A.getObjectByName("TouchPad"),_.trackpadPressed=A.getObjectByName("TouchPad_Press"),_.trackpadPressed&&(_.trackpadPressed.visible=!1))},onButtonChanged:function(v){var A=this.mapping.buttons[v.detail.id];!A||this.el.emit(A+"changed",v.detail.state)},onAxisMoved:function(v){d(this,this.mapping.axes,v)},updateModel:function(v,A){!this.data.model||this.updateButtonModel(v,A)},updateButtonModel:function(v,A){var _=this.buttonMeshes,E=v+"Pressed";if(!(!_||!_[v]||!_[E])){var w;switch(A){case"down":w=this.data.buttonHighlightColor;break;case"touchstart":w=this.data.buttonTouchedColor;break}w&&_[E].material.color.set(w),_[E].visible=!!w,_[v].visible=!w}}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],126:[function(i,o,l){var a=i("../constants").keyboardevent.KEYCODE_TO_CODE,u=i("../core/component").registerComponent,h=i("../lib/three"),f=i("../utils/"),d=f.bind,m=f.shouldCaptureKeyEvent,g=1e-5,x=.2,v=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];o.exports.Component=u("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new h.Vector3,this.onBlur=d(this.onBlur,this),this.onContextMenu=d(this.onContextMenu,this),this.onFocus=d(this.onFocus,this),this.onKeyDown=d(this.onKeyDown,this),this.onKeyUp=d(this.onKeyUp,this),this.onVisibilityChange=d(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(_,E){var w=this.data,S=this.el,T=this.velocity;!T[w.adAxis]&&!T[w.wsAxis]&&A(this.keys)||(E=E/1e3,this.updateVelocity(E),!(!T[w.adAxis]&&!T[w.wsAxis])&&S.object3D.position.add(this.getMovementVector(E)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(_){var E,w,S,T=this.data,R=this.keys,L=this.velocity,I,N;if(w=T.adAxis,I=T.wsAxis,_>x){L[w]=0,L[I]=0;return}var B=Math.pow(1/this.easing,_*60);L[w]!==0&&(L[w]=L[w]*B),L[I]!==0&&(L[I]=L[I]*B),Math.abs(L[w])<g&&(L[w]=0),Math.abs(L[I])<g&&(L[I]=0),T.enabled&&(E=T.acceleration,T.adEnabled&&(S=T.adInverted?-1:1,(R.KeyA||R.ArrowLeft)&&(L[w]-=S*E*_),(R.KeyD||R.ArrowRight)&&(L[w]+=S*E*_)),T.wsEnabled&&(N=T.wsInverted?-1:1,(R.KeyW||R.ArrowUp)&&(L[I]-=N*E*_),(R.KeyS||R.ArrowDown)&&(L[I]+=N*E*_)))},getMovementVector:function(){var _=new h.Vector3(0,0,0),E=new h.Euler(0,0,0,"YXZ");return function(w){var S=this.el.getAttribute("rotation"),T=this.velocity,R;return _.copy(T),_.multiplyScalar(w),S&&(R=this.data.fly?S.x:0,E.set(h.Math.degToRad(R),h.Math.degToRad(S.y),0),_.applyEuler(E)),_}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var _=Object.keys(this.keys),E=0;E<_.length;E++)delete this.keys[_[E]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(_){var E;!m(_)||(E=_.code||a[_.keyCode],v.indexOf(E)!==-1&&(this.keys[E]=!0))},onKeyUp:function(_){var E;E=_.code||a[_.keyCode],delete this.keys[E]}});function A(_){var E;for(E in _)return!1;return!0}},{"../constants":128,"../core/component":136,"../lib/three":184,"../utils/":212}],127:[function(i,o,l){var a=i("../core/component").registerComponent,u=i("../utils/bind"),h=i("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,d=h.emitIfAxesChanged,m=h.onButtonEvent,g=i("../utils/"),x=g.debug("components:windows-motion-controls:debug"),v=g.debug("components:windows-motion-controls:warn"),A=i("../constants").DEFAULT_HANDEDNESS,_="https://cdn.aframe.io/controllers/microsoft/",E={left:"left.glb",right:"right.glb",default:"universal.glb"},w=i("../utils/").device.isWebXRAvailable,S="windows-mixed-reality",T="Spatial Controller (Spatial Interaction Source) ",R=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,L=w?S:T,I={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},N={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},B=w?N:I;o.exports.Component=a("windows-motion-controls",{schema:{hand:{default:A},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:B,bindMethods:function(){this.onModelError=u(this.onModelError,this),this.onModelLoaded=u(this.onModelLoaded,this),this.onControllersUpdate=u(this.onControllersUpdate,this),this.checkIfControllerPresent=u(this.checkIfControllerPresent,this),this.onAxisMoved=u(this.onAxisMoved,this)},init:function(){var H=this,q=this.el;this.onButtonChanged=u(this.onButtonChanged,this),this.onButtonDown=function(le){m(le.detail.id,"down",H)},this.onButtonUp=function(le){m(le.detail.id,"up",H)},this.onButtonTouchStart=function(le){m(le.detail.id,"touchstart",H)},this.onButtonTouchEnd=function(le){m(le.detail.id,"touchend",H)},this.onControllerConnected=function(){H.setModelVisibility(!0)},this.onControllerDisconnected=function(){H.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},q.addEventListener("controllerconnected",this.onControllerConnected),q.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var H=this.el;H.addEventListener("buttonchanged",this.onButtonChanged),H.addEventListener("buttondown",this.onButtonDown),H.addEventListener("buttonup",this.onButtonUp),H.addEventListener("touchstart",this.onButtonTouchStart),H.addEventListener("touchend",this.onButtonTouchEnd),H.addEventListener("axismove",this.onAxisMoved),H.addEventListener("model-error",this.onModelError),H.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var H=this.el;H.removeEventListener("buttonchanged",this.onButtonChanged),H.removeEventListener("buttondown",this.onButtonDown),H.removeEventListener("buttonup",this.onButtonUp),H.removeEventListener("touchstart",this.onButtonTouchStart),H.removeEventListener("touchend",this.onButtonTouchEnd),H.removeEventListener("axismove",this.onAxisMoved),H.removeEventListener("model-error",this.onModelError),H.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,L,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var H=this.createControllerModelUrl();this.loadModel(H)},createControllerModelUrl:function(H){var q=this.el.components["tracked-controls"],le=q?q.controller:null,ne="default",D=this.data.hand,O;if(le&&!window.hasNativeWebXRImplementation&&(D=le.hand,!H)){var k=le.id.match(R);ne=k&&k[0]||ne}return O=E[D]||E.default,_+ne+"/"+O},injectTrackedControls:function(){var H=this.data;this.el.setAttribute("tracked-controls",{idPrefix:L,controller:H.pair,hand:H.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(H){var q=this.createControllerModelUrl(!0);H.detail.src!==q?(v("Failed to load controller model for device, attempting to load default."),this.loadModel(q)):v("Failed to load default controller model.")},loadModel:function(H){this.el.setAttribute("gltf-model","url("+H+")")},onModelLoaded:function(H){var q=this.controllerModel=H.detail.model,le=this.loadedMeshInfo,ne,D,O,k;if(x("Processing model"),le.buttonMeshes={},le.axisMeshes={},q){for(ne=0;ne<this.mapping.buttons.length;ne++){if(D=this.mapping.buttonMeshNames[this.mapping.buttons[ne]],!D){x("Skipping unknown button at index: "+ne+" with mapped name: "+this.mapping.buttons[ne]);continue}if(O=q.getObjectByName(D),!O){v("Missing button mesh with name: "+D);continue}k={index:ne,value:z(O,"VALUE"),pressed:z(O,"PRESSED"),unpressed:z(O,"UNPRESSED")},k.value&&k.pressed&&k.unpressed?le.buttonMeshes[this.mapping.buttons[ne]]=k:v("Missing button submesh under mesh with name: "+D+"(VALUE: "+!!k.value+", PRESSED: "+!!k.pressed+", UNPRESSED:"+!!k.unpressed+")")}for(ne=0;ne<this.mapping.axisMeshNames.length;ne++){if(D=this.mapping.axisMeshNames[ne],!D){x("Skipping unknown axis at index: "+ne);continue}if(O=q.getObjectByName(D),!O){v("Missing axis mesh with name: "+D);continue}k={index:ne,value:z(O,"VALUE"),min:z(O,"MIN"),max:z(O,"MAX")},k.value&&k.min&&k.max?le.axisMeshes[ne]=k:v("Missing axis submesh under mesh with name: "+D+"(VALUE: "+!!k.value+", MIN: "+!!k.min+", MAX:"+!!k.max+")")}this.calculateRayOriginFromMesh(q),this.setModelVisibility()}x("Model load complete.");function z(X,Z){for(var ie=0,se=X.children.length;ie<se;ie++){var ue=X.children[ie];if(ue&&ue.name===Z)return ue}}},calculateRayOriginFromMesh:function(){var H=new THREE.Quaternion;return function(q){var le;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,le=q.getObjectByName(this.mapping.pointingPoseMeshName),le){var ne=q.parent;ne&&(q.parent=null,q.updateMatrixWorld(!0),q.parent=ne),le.getWorldPosition(this.rayOrigin.origin),le.getWorldQuaternion(H),this.rayOrigin.direction.applyQuaternion(H),ne&&q.updateMatrixWorld(!0)}else x("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var H=new THREE.Quaternion;return function(q,le){var ne=this.loadedMeshInfo.axisMeshes[q];if(!!ne){var D=ne.min,O=ne.max,k=ne.value,z=le*.5+.5;k.setRotationFromQuaternion(H.copy(D.quaternion).slerp(O.quaternion,z)),k.position.lerpVectors(D.position,O.position,z)}}}(),lerpButtonTransform:function(){var H=new THREE.Quaternion;return function(q,le){var ne=this.loadedMeshInfo.buttonMeshes[q];if(!!ne){var D=ne.unpressed,O=ne.pressed,k=ne.value;k.setRotationFromQuaternion(H.copy(D.quaternion).slerp(O.quaternion,le)),k.position.lerpVectors(D.position,O.position,le)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(H){var q=this.mapping.buttons[H.detail.id];q&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(q,H.detail.state.value),this.el.emit(q+"changed",H.detail.state))},onAxisMoved:function(H){var q=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var le=0;le<q;le++)this.lerpAxisTransform(le,H.detail.axis[le]||0);d(this,this.mapping.axes,H)},setModelVisibility:function(H){var q=this.el.getObject3D("mesh");H=H!==void 0?H:this.modelVisible,this.modelVisible=H,q&&(q.visible=H)}})},{"../constants":128,"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],128:[function(i,o,l){o.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:i("./keyboardevent")}},{"./keyboardevent":129}],129:[function(i,o,l){o.exports={KEYCODE_TO_CODE:{38:"ArrowUp",37:"ArrowLeft",40:"ArrowDown",39:"ArrowRight",87:"KeyW",65:"KeyA",83:"KeyS",68:"KeyD"}}},{}],130:[function(i,o,l){var a=i("./a-node"),u=i("../utils/bind"),h=i("../utils/debug"),f=i("./a-register-element").registerElement,d=i("../lib/three"),m=new d.FileLoader,g=h("core:a-assets:warn");o.exports=f("a-assets",{prototype:Object.create(a.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=m,this.timeout=null}},attachedCallback:{value:function(){var S=this,T,R=[],L,I,N,B,H;if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(B=this.querySelectorAll("img"),T=0;T<B.length;T++)N=v(B[T]),R.push(new Promise(function(q,le){d.Cache.add(B[T].getAttribute("src"),N),N.onload=q,N.onerror=le}));for(I=this.querySelectorAll("audio, video"),T=0;T<I.length;T++)L=v(I[T]),!L.src&&!L.srcObject&&g("Audio/video asset has neither `src` nor `srcObject` attributes."),R.push(x(L));Promise.all(R).then(u(this.load,this)),H=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){S.hasLoaded||(g("Asset loading timed out in ",H,"ms"),S.emit("timeout"),S.load())},H)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){a.prototype.load.call(this,null,function(T){return T.isAssetItem&&T.hasAttribute("src")})}}})}),f("a-asset-item",{prototype:Object.create(a.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var S=this,T=this.getAttribute("src");m.setResponseType(this.getAttribute("response-type")||E(T)),m.load(T,function(L){S.data=L,setTimeout(function(){a.prototype.load.call(S)})},function(L){S.emit("progress",{loadedBytes:L.loaded,totalBytes:L.total,xhr:L})},function(L){S.emit("error",{xhr:L})})}}})});function x(S){if(!(!S.hasAttribute("autoplay")&&S.getAttribute("preload")!=="auto"))return new Promise(function(T,R){if(S.readyState===4)return T();if(S.error)return R();S.addEventListener("loadeddata",L,!1),S.addEventListener("progress",L,!1),S.addEventListener("error",R,!1);function L(){for(var I=0,N=0;N<S.buffered.length;N++)I+=S.buffered.end(N)-S.buffered.start(N);I>=S.duration&&(S.tagName==="VIDEO"&&d.Cache.add(S.getAttribute("src"),S),T())}})}function v(S){var T=A(S);return T.tagName&&T.tagName.toLowerCase()==="video"&&(T.setAttribute("playsinline",""),T.setAttribute("webkit-playsinline","")),T!==S&&(S.parentNode.appendChild(T),S.parentNode.removeChild(S)),T}function A(S){var T,R;return S.hasAttribute("crossorigin")||(R=S.getAttribute("src"),R!==null&&(R.indexOf("://")===-1||_(R)===window.location.host))?S:(g('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',R),S.crossOrigin="anonymous",T=S.cloneNode(!0),T)}function _(S){var T=S.indexOf("://")>-1?S.split("/")[2]:S.split("/")[0];return T.substring(0,T.indexOf(":"))}function E(S){var T=w(S),R=T.lastIndexOf(".");if(R>=0){var L=T.slice(R,S.search(/\?|#|$/));if(L===".glb")return"arraybuffer"}return"text"}o.exports.inferResponseType=E;function w(S){var T=document.createElement("a");T.href=S;var R=T.search.replace(/^\?/,""),L=S.replace(R,"").replace("?","");return L.substring(L.lastIndexOf("/")+1)}o.exports.getFileNameFromURL=w},{"../lib/three":184,"../utils/bind":206,"../utils/debug":208,"./a-node":134,"./a-register-element":135}],131:[function(i,o,l){var a=i("../utils/debug"),u=i("./a-register-element").registerElement,h=a("core:cubemap:warn");o.exports=u("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var f=this.querySelectorAll("[src]"),d,m=[];if(f.length===6){for(d=0;d<f.length;d++)m.push(f[d].getAttribute("src"));return m}h("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":208,"./a-register-element":135}],132:[function(i,o,l){var a=i("./a-node"),u=i("./component").components,h=i("./a-register-element").registerElement,f=i("../lib/three"),d=i("../utils/"),m,g=d.debug("core:a-entity:debug"),x=d.debug("core:a-entity:warn"),v="__",A=["position","rotation","scale","visible"],_={once:!0},E=Object.create(a.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new f.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(I,N,B){var H=this.components[I];if(H&&H.justInitialized&&B===""){delete H.justInitialized;return}!H&&B===null||this.setEntityAttribute(I,N,B)}},attachedCallback:{value:function(){var I,N=this.sceneEl,B=this;if(this.addToParent(),!this.isScene){if(!N){this.load();return}if(I=N.querySelector("a-assets"),I&&!I.hasLoaded){I.addEventListener("loaded",function(){B.load()});return}this.load()}}},detachedCallback:{value:function(){var I;if(!!this.parentEl){for(I in this.components)this.removeComponent(I,!1);this.isScene||(this.removeFromParent(),a.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(I){return this.object3DMap[I]}},setObject3D:{value:function(I,N){var B,H=this;if(!(N instanceof f.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");B=this.getObject3D(I),B&&this.object3D.remove(B),N.el=this,N.children.length&&N.traverse(function(le){le.el=H}),this.object3D.add(N),this.object3DMap[I]=N,this.emit("object3dset",{object:N,type:I})}},removeObject3D:{value:function(I){var N=this.getObject3D(I);if(!N){x("Tried to remove `Object3D` of type:",I,"which was not defined.");return}this.object3D.remove(N),delete this.object3DMap[I],this.emit("object3dremove",{type:I})}},getOrCreateObject3D:{value:function(I,N){var B=this.getObject3D(I);return!B&&N&&(B=new N,this.setObject3D(I,B)),x("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),B}},add:{value:function(I){if(!I.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(I.object3D),this.emit("child-attached",{el:I})}},addToParent:{value:function(){var I=this.parentEl=this.parentNode;!I||!I.add||this.attachedToParent||(I.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var I=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,I.emit("child-detached",{el:this})}},load:{value:function(){var I=this;this.hasLoaded||!this.parentEl||a.prototype.load.call(this,function(){!I.parentEl||(I.updateComponents(),(I.isScene||I.parentEl.isPlaying)&&I.play())})},writable:window.debug},remove:{value:function(I){I?this.object3D.remove(I.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var I=this.children,N=[],B=0;B<I.length;B++){var H=I[B];H instanceof m&&N.push(H)}return N}},initComponent:{value:function(I,N,B){var H,q,le,ne,D;if(le=d.split(I,v),ne=le[0],q=le.length>2?le.slice(1).join("__"):le[1],!!u[ne]&&(D=w(this,I)||N!==void 0,!(!D&&!B)&&!(I in this.components))){if(this.initComponentDependencies(ne),q&&!u[ne].multiple)throw new Error("Trying to initialize multiple components of type `"+ne+"`. There can only be one component of this type per entity.");H=new u[ne].Component(this,N,q),this.isPlaying&&H.play(),this.hasAttribute(I)||(H.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,I,"")),g("Component initialized: %s",I)}},writable:window.debug},initComponentDependencies:{value:function(I){var N=this,B=u[I],H,q;if(!!B&&(H=u[I].dependencies,!!H))for(q=0;q<H.length;q++)N.initComponent(H[q],window.HTMLElement.prototype.getAttribute.call(N,H[q])||void 0,!0)}},removeComponent:{value:function(I,N){var B;if(B=this.components[I],!!B){if(!B.initialized){this.addEventListener("componentinitialized",function H(q){q.detail.name===I&&(this.removeComponent(I,N),this.removeEventListener("componentinitialized",H))});return}B.pause(),B.remove(),N&&(B.destroy(),delete this.components[I]),this.emit("componentremoved",B.evtDetail,!1)}},writable:window.debug},updateComponents:{value:function(){var I,N,B,H,q=this.componentsToUpdate;if(!!this.hasLoaded){for(B=0;B<this.mixinEls.length;B++)for(H in this.mixinEls[B].componentCache)R(H)&&(q[H]=!0);if(this.getExtraComponents){N=this.getExtraComponents();for(H in N)R(H)&&(q[H]=!0)}for(B=0;B<this.attributes.length;++B)H=this.attributes[B].name,A.indexOf(H)===-1&&R(H)&&(q[H]=!0);for(B=0;B<A.length;B++)H=A[B],this.hasAttribute(H)&&this.updateComponent(H,this.getDOMAttribute(H));for(H in q)I=T(this.getDOMAttribute(H),N&&N[H]),this.updateComponent(H,I),delete q[H]}},writable:window.debug},updateComponent:{value:function(I,N,B){var H=this.components[I];if(H){if(N===null&&!w(this,I)){this.removeComponent(I,!0);return}H.updateProperties(N,B);return}this.initComponent(I,N,!1)}},removeAttribute:{value:function(I,N){var B=this.components[I];if(B&&N===void 0&&this.removeComponent(I,!0),B&&N!==void 0){B.resetProperty(N);return}I==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,I)}},play:{value:function(){var I,N,B;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(B in this.components)this.components[B].play();for(I=this.getChildEntities(),N=0;N<I.length;N++)I[N].play();this.emit("play")}},writable:!0},pause:{value:function(){var I,N,B;if(!!this.isPlaying){this.isPlaying=!1;for(B in this.components)this.components[B].pause();for(I=this.getChildEntities(),N=0;N<I.length;N++)I[N].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(I,N,B){if(u[I]||this.components[I]){this.updateComponent(I,B);return}if(I==="mixin"){if(B===this.computedMixinStr)return;this.mixinUpdate(B,N)}}},mixinUpdate:{value:function(){var I=[];return function(N,B){var H,q,le,ne,D=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){D.mixinUpdate(N,B)},_);return}for(B=B||this.getAttribute("mixin"),le=this.updateMixins(N,B),I.length=0,ne=0;ne<this.mixinEls.length;ne++)for(H in this.mixinEls[ne].componentCache)I.indexOf(H)===-1&&(this.components[H]?this.components[H].handleMixinUpdate():this.initComponent(H,null),I.push(H));for(ne=0;ne<le.oldMixinIds.length;ne++)if(q=document.getElementById(le.oldMixinIds[ne]),!!q)for(H in q.componentCache)I.indexOf(H)===-1&&this.components[H]&&(this.getDOMAttribute(H)?this.components[H].handleMixinUpdate():this.removeComponent(H,!0))}}()},setAttribute:{value:function(){var I={};return function(N,B,H){var q,le,ne,D,O,k;if(D=N.indexOf(v),ne=D>0?N.substring(0,D):N,!u[ne]){N==="mixin"&&this.mixinUpdate(B),a.prototype.setAttribute.call(this,N,B);return}if(!this.components[N]&&this.hasAttribute(N)&&this.updateComponent(N,window.HTMLElement.prototype.getAttribute.call(this,N)),typeof H<"u"&&typeof B=="string"&&B.length>0&&typeof d.styleParser.parse(B)=="string"){for(k in I)delete I[k];q=I,q[B]=H,le=!1}else q=B,le=H===!0;this.updateComponent(N,q,le),O=this.sceneEl&&this.sceneEl.getAttribute("debug"),O&&this.components[N].flushToDOM()}}(),writable:window.debug},flushToDOM:{value:function(I){var N=this.components,B,H=this.children,q,le;for(le in N)N[le].flushToDOM();if(!!I)for(q=0;q<H.length;++q)B=H[q],B.flushToDOM&&B.flushToDOM(I)}},getAttribute:{value:function(I){var N;return I==="position"?this.object3D.position:I==="rotation"?L(this):I==="scale"?this.object3D.scale:I==="visible"?this.object3D.visible:(N=this.components[I],N?N.data:window.HTMLElement.prototype.getAttribute.call(this,I))},writable:window.debug},getDOMAttribute:{value:function(I){var N=this.components[I];return N?N.attrValue:window.HTMLElement.prototype.getAttribute.call(this,I)},writable:window.debug},addState:{value:function(I){this.is(I)||(this.states.push(I),this.emit("stateadded",I))}},removeState:{value:function(I){var N=this.states.indexOf(I);N!==-1&&(this.states.splice(N,1),this.emit("stateremoved",I))}},is:{value:function(I){return this.states.indexOf(I)!==-1}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var I;if(this.parentNode){x("Entity can only be destroyed if detached from scenegraph.");return}for(I in this.components)this.components[I].destroy()}}});function w(I,N){return I.components[N]&&I.components[N].attrValue?!0:S(N,I.mixinEls)}function S(I,N){var B,H=!1;for(B=0;B<N.length&&(H=N[B].hasAttribute(I),!H);++B);return H}function T(I,N){return N?N.constructor===Object?d.extend(N,d.styleParser.parse(I||{})):I||N:I}function R(I){return I.indexOf(v)!==-1&&(I=d.split(I,v)[0]),!!u[I]}function L(I){var N=f.Math.radToDeg,B=I.object3D.rotation,H=I.rotationObj;return H.x=N(B.x),H.y=N(B.y),H.z=N(B.z),H}m=h("a-entity",{prototype:E}),o.exports=m},{"../lib/three":184,"../utils/":212,"./a-node":134,"./a-register-element":135,"./component":136}],133:[function(i,o,l){var a=i("./a-node"),u=i("./a-register-element").registerElement,h=i("./component").components,f=i("../utils"),d="__";o.exports=u("a-mixin",{prototype:Object.create(a.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(m,g,x){this.cacheAttribute(m,x),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(m,g){window.HTMLElement.prototype.setAttribute.call(this,m,g),this.cacheAttribute(m,g)}},cacheAttribute:{value:function(m,g){var x,v;v=f.split(m,d)[0],x=h[v],x&&(g===void 0&&(g=window.HTMLElement.prototype.getAttribute.call(this,m)),this.componentCache[m]=x.parseAttrValueForCache(g))}},getAttribute:{value:function(m){return this.componentCache[m]||window.HTMLElement.prototype.getAttribute.call(this,m)}},cacheAttributes:{value:function(){var m=this.attributes,g,x;for(x=0;x<m.length;x++)g=m[x].name,this.cacheAttribute(g)}},updateEntities:{value:function(){var m,g,x;if(!!this.sceneEl)for(g=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),x=0;x<g.length;x++)m=g[x],!(!m.hasLoaded||m.isMixin)&&m.mixinUpdate(this.id)}}})})},{"../utils":212,"./a-node":134,"./a-register-element":135,"./component":136}],134:[function(i,o,l){var a=i("./a-register-element").registerElement,u=i("./a-register-element").isNode,h=i("../utils/"),f=h.debug("core:a-node:warn"),d=h.debug("core:a-node:error");o.exports=a("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var m;this.sceneEl=this.closestScene(),this.sceneEl||f("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(m=this.getAttribute("mixin"),m&&this.updateMixins(m))},writable:window.debug},attributeChangedCallback:{value:function(m,g,x){x!==this.computedMixinStr&&m==="mixin"&&!this.isMixin&&this.updateMixins(x,g)}},closestScene:{value:function(){for(var g=this;g&&!g.isScene;)g=g.parentElement;return g}},closest:{value:function(g){for(var x=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,v=this;v&&!x.call(v,g);)v=v.parentElement;return v}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(m,g){var x,v,A=this;this.hasLoaded||(g=g||u,x=this.getChildren(),v=x.filter(g).map(function(_){return new Promise(function(w){if(_.hasLoaded)return w();_.addEventListener("loaded",w)})}),Promise.all(v).then(function(){A.hasLoaded=!0,m&&m(),A.emit("loaded",void 0,!1)}).catch(function(_){d("Failure loading node: ",_)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(){var m=[],g=[],x={};return function(v,A){var _,E,w;for(m.length=0,g.length=0,E=v?h.split(v.trim(),/\s+/):m,w=A?h.split(A.trim(),/\s+/):g,x.newMixinIds=E,x.oldMixinIds=w,_=0;_<w.length;_++)E.indexOf(w[_])===-1&&this.unregisterMixin(w[_]);for(this.computedMixinStr="",this.mixinEls.length=0,_=0;_<E.length;_++)this.registerMixin(document.getElementById(E[_]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),x}}()},registerMixin:{value:function(m){var g,x,v;if(!!m){if(v=m.getAttribute("mixin"),v)for(g=h.split(v.trim(),/\s+/),x=0;x<g.length;x++)this.registerMixin(document.getElementById(g[x]));this.computedMixinStr=this.computedMixinStr+" "+m.id,this.mixinEls.push(m)}}},setAttribute:{value:function(m,g){m==="mixin"&&this.updateMixins(g),window.HTMLElement.prototype.setAttribute.call(this,m,g)}},unregisterMixin:{value:function(m){var g,x=this.mixinEls,v;for(g=0;g<x.length;++g)if(v=x[g],m===v.id){x.splice(g,1);break}}},emit:{value:function(){var m={};return function(g,x,v,A){v===void 0&&(v=!0),m.bubbles=!!v,m.detail=x,A&&(m=h.extend({},A,m)),this.dispatchEvent(new CustomEvent(g,m))}}(),writable:window.debug}})})},{"../utils/":212,"./a-register-element":135}],135:[function(i,o,l){i("document-register-element");var a,u,h=o.exports.knownTags={};function f(A){h[A.toLowerCase()]=!0}o.exports.isNode=function(A){return A.tagName.toLowerCase()in h||A.isNode},o.exports.registerElement=function(A,_){var E=Object.getPrototypeOf(_.prototype),w=_,S=a&&E===a.prototype,T=u&&E===u.prototype;return(S||T)&&f(A),S&&(w=d(_.prototype),w={prototype:Object.create(E,w)}),T&&(w=m(_.prototype),w={prototype:Object.create(E,w)}),Object.getOwnPropertyNames(w.prototype).forEach(function(R){var L=w.prototype[R];typeof L=="function"&&(L.displayName=R)}),document.registerElement(A,w)};function d(A){var _={},E=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return g(_,E,A,a.prototype),v(A,_),_}function m(A){var _={},E=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],w=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return g(_,E,A,a.prototype),g(_,w,A,u.prototype),v(A,_),_}function g(A,_,E,w){_.forEach(function(S){x(A,S,E,w)})}o.exports.wrapMethods=g;function x(A,_,E,w){var S=E[_],T=w[_];!S||!T||S!==T&&(A[_]={value:function(){return T.apply(this,arguments),S.apply(this,arguments)},writable:window.debug})}function v(A,_){var E=Object.getOwnPropertyNames(A);E.forEach(function(w){var S;_[w]||(S=Object.getOwnPropertyDescriptor(A,w),_[w]={value:A[w],writable:S.writable})})}a=i("./a-node"),u=i("./a-entity")},{"./a-entity":132,"./a-node":134,"document-register-element":12}],136:[function(i,o,l){var a=i("./schema"),u=i("./scene/scenes"),h=i("./system"),f=i("../utils/"),d=o.exports.components={},m=a.parseProperties,g=a.parseProperty,x=a.process,v=a.isSingleProperty,A=a.stringifyProperties,_=a.stringifyProperty,E=f.styleParser,w=f.debug("core:component:warn"),S=document.currentScript,T=new RegExp("[A-Z]+"),R={},L=o.exports.Component=function(k,z,X){var Z=this;this.el=k,this.id=X,this.attrName=this.name+(X?"__"+X:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=v(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&D(g(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=R[this.name];const ie=this.events;this.events={},I(this,ie),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),f.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),f.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),f.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),f.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=f.throttleComponentChanged(function(){k.emit("componentchanged",Z.evtDetail,!1)},200),this.updateProperties(z)};L.prototype={schema:{},init:function(){},events:{},update:function(k){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(k,z){var X=this.schema;return this.isSingleProperty?g(k,X):m(E.parse(k),X,!0,this.name,z)},stringify:function(k){var z=this.schema;return typeof k=="string"?k:this.isSingleProperty?_(k,z):(k=A(k,z),E.stringify(k))},updateCachedAttrValue:function(k,z){var X,Z,ie;if(k!==void 0){if(k===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(k instanceof Object&&!(k instanceof window.HTMLElement)?(Z=this.objectPool.use(),X=f.extend(Z,k)):X=this.parseAttrValueForCache(k),this.isObjectBased&&!z&&this.attrValue)for(ie in this.attrValue)X[ie]===void 0&&(X[ie]=this.attrValue[ie]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),f.objectPool.clearObject(this.attrValue),this.attrValue=H(this.attrValue,X,this.isObjectBased),f.objectPool.clearObject(Z)}},parseAttrValueForCache:function(k){var z;return typeof k!="string"?k:(this.isSingleProperty?(z=this.schema.parse(k),typeof z=="string"&&(z=k)):(f.objectPool.clearObject(this.parsingAttrValue),z=E.parse(k,this.parsingAttrValue)),z)},flushToDOM:function(k){var z=k?this.data:this.attrValue;z!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(z))},updateProperties:function(k,z){var X=this.el;if(!X.hasLoaded){this.updateCachedAttrValue(k);return}k!==null&&(k=this.parseAttrValueForCache(k)),this.updateCachedAttrValue(k,z),this.initialized?(this.updateComponent(k,z),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var k=this.el,z;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!k.initializingComponents[this.name]&&(k.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete k.initializingComponents[this.name],this.oldData=H(this.oldData,this.data,this.isObjectBased),z=this.isObjectBased?this.objectPool.use():void 0,this.update(z),this.isObjectBased&&this.objectPool.recycle(z),k.isPlaying&&this.play(),k.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(k,z){var X,Z;if(z){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&g(k,this.schema),this.data=k;return}if(m(k,this.schema,!0,this.name),this.schemaChangeKeys.length){for(X in k)if(this.schema[X].schemaChange){Z=!0;break}}if(Z){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for(X in k)k[X]!==void 0&&(this.data[X]=k[X])},callUpdateHandler:function(){var k;this.previousOldData instanceof Object&&f.objectPool.clearObject(this.previousOldData),this.isObjectBased?B(this.previousOldData,this.oldData):this.previousOldData=this.oldData,k=!f.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!k)&&(this.oldData instanceof Object&&f.objectPool.clearObject(this.oldData),this.oldData=H(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(k){if(this.isObjectBased){if(!(k in this.attrValue))return;delete this.attrValue[k],this.data[k]=this.schema[k].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(k){var z;z=f.extend({},d[this.name].schema),f.extend(z,k),this.schema=x(z),this.el.emit("schemachanged",this.evtDetail)},buildData:function(k,z,X){var Z,ie,se,ue,ye,Ce=this.nextData,ke=this.schema,Oe,Ne=this.el.mixinEls,He;if(Z=k&&k.constructor===Array?k.length:k!=null,this.isObjectBased&&f.objectPool.clearObject(Ce),this.isSingleProperty)this.isObjectBased?ie=B(Ce,ke.default):ie=O(ke.default)?f.clone(ke.default):ke.default;else{He=!z&&this.attrValue,ie=He instanceof Object?B(Ce,He):Ce;for(ue in ke)se=ke[ue].default,ie[ue]===void 0&&(ie[ue]=O(se)?f.clone(se):se)}for(Oe=0;Oe<Ne.length;Oe++)ye=Ne[Oe].getAttribute(this.attrName),ye&&(ie=H(ie,ye,this.isObjectBased));if(Z){if(this.isSingleProperty)return D(k)?(B(this.parsingAttrValue,k),g(this.parsingAttrValue,ke)):g(k,ke);ie=H(ie,k,this.isObjectBased)}else if(this.isSingleProperty)return g(ie,ke);return m(ie,ke,void 0,this.name,X)},eventsAttach:function(){var k;this.eventsDetach();for(k in this.events)this.el.addEventListener(k,this.events[k])},eventsDetach:function(){var k;for(k in this.events)this.el.removeEventListener(k,this.events[k])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function I(k,z){var X;for(X in z)k.events[X]=z[X].bind(k)}if(window.debug)var N=o.exports.registrationOrderWarnings={};o.exports.registerComponent=function(k,z){var X,Z,ie={},se,ue;if(document.currentScript&&document.currentScript!==S&&u.forEach(function(Ce){Ce.hasLoaded||document.currentScript.compareDocumentPosition(Ce)!==Node.DOCUMENT_POSITION_FOLLOWING&&(w("The component `"+k+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(N[k]=!0))}),T.test(k)===!0&&w("The component name `"+k+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+k.toLowerCase()+"`"),k.indexOf("__")!==-1)throw new Error("The component name `"+k+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(z).forEach(function(ye){ie[ye]={value:z[ye],writable:!0}}),d[k])throw new Error("The component `"+k+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if(X=function(ye,Ce,ke){L.call(this,ye,Ce,ke)},X.prototype=Object.create(L.prototype,ie),X.prototype.name=k,X.prototype.isPositionRotationScale=k==="position"||k==="rotation"||k==="scale",X.prototype.constructor=X,X.prototype.system=h&&h.systems[k],X.prototype.play=ne(X.prototype.play),X.prototype.pause=le(X.prototype.pause),se=f.extend(x(X.prototype.schema,X.prototype.name)),ue=v(X.prototype.schema),!ue){X.prototype.schemaChangeKeys=[];for(Z in se)se[Z].schemaChange&&X.prototype.schemaChangeKeys.push(Z)}return R[k]=f.objectPool.createPool(),d[k]={Component:X,dependencies:X.prototype.dependencies,isSingleProp:ue,multiple:X.prototype.multiple,name:k,parse:X.prototype.parse,parseAttrValueForCache:X.prototype.parseAttrValueForCache,schema:se,stringify:X.prototype.stringify,type:X.prototype.type},X};function B(k,z){var X,Z;for(Z in z)z[Z]!==void 0&&(X=z[Z],k[Z]=O(X)?f.clone(X):X);return k}function H(k,z,X){var Z;if(X&&z.constructor===Object){for(Z in z)z[Z]!==void 0&&(z[Z]&&z[Z].constructor===Object?k[Z]=f.clone(z[Z]):k[Z]=z[Z]);return k}return z}function q(k){return k.tick||k.tock}function le(k){return function(){var X=this.el.sceneEl;!this.isPlaying||(k.call(this),this.isPlaying=!1,this.eventsDetach(),q(this)&&X.removeBehavior(this))}}function ne(k){return function(){var X=this.el.sceneEl,Z=this.el.isPlaying&&!this.isPlaying;!this.initialized||!Z||(k.call(this),this.isPlaying=!0,this.eventsAttach(),q(this)&&X.addBehavior(this))}}function D(k){return k&&k.constructor===Object&&!(k instanceof window.HTMLElement)}function O(k){return k&&(k.constructor===Object||k.constructor===Array)&&!(k instanceof window.HTMLElement)}},{"../utils/":212,"./scene/scenes":143,"./schema":145,"./system":147}],137:[function(i,o,l){var a=i("./schema"),u=a.process,h=o.exports.geometries={},f=o.exports.geometryNames=[],d=i("../lib/three"),m=o.exports.Geometry=function(){};m.prototype={schema:{},init:function(g){return this.geometry=new d.BufferGeometry,this.geometry},update:function(g){}},o.exports.registerGeometry=function(g,x){var v,A={};if(Object.keys(x).forEach(function(E){A[E]={value:x[E],writable:!0}}),h[g])throw new Error("The geometry `"+g+"` has been already registered");return v=function(){m.call(this)},v.prototype=Object.create(m.prototype,A),v.prototype.name=g,v.prototype.constructor=v,h[g]={Geometry:v,schema:u(v.prototype.schema)},f.push(g),v}},{"../lib/three":184,"./schema":145}],138:[function(i,o,l){var a=i("../utils/coordinates"),u=i("debug"),h=u("core:propertyTypes:warn"),f=u("core:propertyTypes:warn"),d=o.exports.propertyTypes={},m=/[,> .[\]:]/,g=/\url\((.+)\)/;x("audio","",_),x("array",[],v,A),x("asset","",_),x("boolean",!1,S),x("color","#FFF",E,w),x("int",0,T),x("number",0,R),x("map","",_),x("model","",_),x("selector",null,L,N),x("selectorAll",null,I,B),x("src","",H),x("string","",E,w),x("time",0,T),x("vec2",{x:0,y:0},q,a.stringify),x("vec3",{x:0,y:0,z:0},q,a.stringify),x("vec4",{x:0,y:0,z:0,w:1},q,a.stringify);function x(D,O,k,z){if("type"in d){h("Property type "+D+" is already registered.");return}d[D]={default:O,parse:k||E,stringify:z||w}}o.exports.registerPropertyType=x;function v(D){if(Array.isArray(D))return D;if(!D||typeof D!="string")return[];return D.split(",").map(O);function O(k){return k.trim()}}function A(D){return D.join(", ")}function _(D){var O,k;if(typeof D!="string")return D;if(k=D.match(g),k)return k[1];if(D.charAt(0)==="#"){if(O=document.getElementById(D.substring(1)),O)return O.tagName==="CANVAS"||O.tagName==="VIDEO"||O.tagName==="IMG"?O:O.getAttribute("src");f('"'+D+'" asset not found.');return}return D}function E(D){return D}function w(D){return D===null?"null":D.toString()}function S(D){return D!=="false"&&D!==!1}function T(D){return parseInt(D,10)}function R(D){return parseFloat(D,10)}function L(D){return D?typeof D!="string"?D:D[0]==="#"&&!m.test(D)?document.getElementById(D.substring(1)):document.querySelector(D):null}function I(D){return D?typeof D!="string"?D:Array.prototype.slice.call(document.querySelectorAll(D),0):null}function N(D){return D.getAttribute?"#"+D.getAttribute("id"):w(D)}function B(D){return D instanceof Array?D.map(function(O){return"#"+O.getAttribute("id")}).join(", "):w(D)}function H(D){return f("`src` property type is deprecated. Use `asset` instead."),_(D)}function q(D){return a.parse(D,this.default)}function le(D,O){return D==="audio"&&typeof O!="string"||D==="array"&&!Array.isArray(O)||D==="asset"&&typeof O!="string"||D==="boolean"&&typeof O!="boolean"||D==="color"&&typeof O!="string"||D==="int"&&typeof O!="number"||D==="number"&&typeof O!="number"||D==="map"&&typeof O!="string"||D==="model"&&typeof O!="string"||D==="selector"&&typeof O!="string"&&O!==null||D==="selectorAll"&&typeof O!="string"&&O!==null||D==="src"&&typeof O!="string"||D==="string"&&typeof O!="string"||D==="time"&&typeof O!="number"?!1:D==="vec2"?ne(O,2):D==="vec3"?ne(O,3):D==="vec4"?ne(O,4):!0}o.exports.isValidDefaultValue=le;function ne(D,O){if(D===null)return!0;if(typeof D!="object"||Object.keys(D).length!==O)return!1;var k=D.x,z=D.y,X=D.z,Z=D.w;return!(typeof k!="number"||typeof z!="number"||O>2&&typeof X!="number"||O>3&&typeof Z!="number")}o.exports.isValidDefaultCoordinate=ne},{"../utils/coordinates":207,debug:8}],139:[function(i,o,l){var a=i("./metaTags").inject,u=i("./wakelock"),h=i("./loadingScreen"),f=i("../a-register-element"),d=i("./scenes"),m=i("../system").systems,g=i("../../lib/three"),x=i("../../utils/"),v=i("../a-entity"),A=i("../a-node"),_=i("./postMessage"),E=x.bind,w=x.device.isIOS(),S=x.device.isMobile(),T=x.device.isWebXRAvailable,R=f.registerElement,L=x.debug("core:a-scene:warn");w&&i("../../utils/ios-orientationchange-blank-bug"),o.exports.AScene=R("a-scene",{prototype:Object.create(v.prototype,{createdCallback:{value:function(){this.clock=new g.Clock,this.isIOS=w,this.isMobile=S,this.hasWebXR=T,this.isAR=!1,this.isScene=!0,this.object3D=new g.Scene;var ne=this;this.object3D.onAfterRender=function(D,O,k){ne.isPlaying&&ne.tock(ne.time,ne.delta,k)},this.resize=E(this.resize,this),this.render=E(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui",""),this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var ne=this,D=this.hasAttribute("embedded");le(this),this.setupRenderer(),h.setup(this,N),this.resize(),D||this.addFullScreenStyles(),_(this),a(this),u(this),this.onVRPresentChangeBound=E(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){ne.enterVR()},this.exitVRBound=function(){ne.exitVR()},this.exitVRTrueBound=function(){ne.exitVR(!0)},this.pointerRestrictedBound=function(){ne.pointerRestricted()},this.pointerUnrestrictedBound=function(){ne.pointerUnrestricted()},T||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){ne.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){ne.enterVR()})}},attachedCallbackPostCamera:{value:function(){var ne,D=this;window.addEventListener("load",ne),window.addEventListener("resize",function(){D.isIOS?setTimeout(D.resize,100):D.resize()}),this.play(),d.push(this)},writable:window.debug},initSystems:{value:function(){var ne;this.initSystem("camera");for(ne in m)ne!=="camera"&&this.initSystem(ne)}},initSystem:{value:function(ne){this.systems[ne]||(this.systems[ne]=new m[ne](this),this.systemNames.push(ne))}},detachedCallback:{value:function(){var ne=d.indexOf(this);d.splice(ne,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.xr.dispose()}},addBehavior:{value:function(ne){var D,O=this.behaviors,k;for(k in O)!ne[k]||(D=this.behaviors[k],D.indexOf(ne)===-1&&D.push(ne))}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:x.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){var ne;if(!this.hasWebXR)throw ne="Failed to enter AR mode, WebXR not supported.",new Error(ne);if(!x.device.checkARSupport())throw ne="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(ne);return this.enterVR(!0)}},enterVR:{value:function(ne){var D=this,O,k=D.renderer.xr,z;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile)if(k.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var X=this.sceneEl.systems.webxr.sessionReferenceSpaceType;k.setReferenceSpaceType(X);var Z=ne?"immersive-ar":"immersive-vr";return z=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(Ce,ke){navigator.xr.requestSession(Z,z).then(function(Ne){D.xrSession=Ne,k.layersEnabled=z.requiredFeatures.indexOf("layers")!==-1,k.setSession(Ne),Ne.addEventListener("end",D.exitVRBound),ue(Ce)},function(Ne){var He=Z==="immersive-ar",Qe=He?"AR":"VR";throw new Error("Failed to enter "+Qe+" mode (`requestSession`) "+Ne)})})}else{if(O=x.device.getVRDisplay(),k.setDevice(O),O.isPresenting&&!window.hasNativeWebVRImplementation)return ue(),Promise.resolve();var ie=this.getAttribute("renderer"),se={highRefreshRate:ie.highRefreshRate,foveationLevel:ie.foveationLevel};return O.requestPresent([{source:this.canvas,attributes:se}]).then(ue,ye)}return ue(),Promise.resolve();function ue(Ce){var ke;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(ke=new CustomEvent("vrdisplaypresentchange",{detail:{display:x.device.getVRDisplay()}}),window.dispatchEvent(ke)),ne?D.addState("ar-mode"):D.addState("vr-mode"),D.emit("enter-vr",{target:D}),!T&&D.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),D.addFullScreenStyles(),!D.isMobile&&!D.checkHeadsetConnected()&&H(D.canvas),D.resize(),Ce&&Ce()}function ye(Ce){throw D.removeState("vr-mode"),Ce&&Ce.message?new Error("Failed to enter VR mode (`requestPresent`): "+Ce.message):new Error("Failed to enter VR mode (`requestPresent`).")}},writable:!0},exitVR:{value:function(){var ne=this,D,O=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(O.enabled=!1,D=x.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,O.setSession(null);else if(D.isPresenting)return D.exitPresent().then(k,z)}else q();return k(),Promise.resolve();function k(){ne.removeState("vr-mode"),ne.removeState("ar-mode"),ne.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),ne.hasAttribute("embedded")&&ne.removeFullScreenStyles(),ne.resize(),ne.isIOS&&x.forceCanvasResizeSafariMobile(ne.canvas),ne.renderer.setPixelRatio(window.devicePixelRatio),ne.emit("exit-vr",{target:ne})}function z(X){throw X&&X.message?new Error("Failed to exit VR mode (`exitPresent`): "+X.message):new Error("Failed to exit VR mode (`exitPresent`).")}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var ne=this.getPointerLockElement();ne&&ne!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var ne=this.getPointerLockElement();ne&&ne===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(ne){var D=ne.display||ne.detail.display;if(D&&D.isPresenting){this.enterVR();return}this.exitVR()}},getAttribute:{value:function(ne){var D=this.systems[ne];return D?D.data:v.prototype.getAttribute.call(this,ne)}},getComputedAttribute:{value:function(ne){L("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(ne)}},getDOMAttribute:{value:function(ne){var D=this.systems[ne];return D?D.data:v.prototype.getDOMAttribute.call(this,ne)}},setAttribute:{value:function(ne,D,O){var k=this.systems[ne];if(k){A.prototype.setAttribute.call(this,ne,D),k.updateProperties(D);return}v.prototype.setAttribute.call(this,ne,D,O)}},removeBehavior:{value:function(ne){var D,O,k=this.behaviors,z;for(O in k)!ne[O]||(D=this.behaviors[O],z=D.indexOf(ne),z!==-1&&D.splice(z,1))}},resize:{value:function(){var ne=this.camera,D=this.canvas,O,k,z,X=this.renderer.xr.isPresenting;k=this.renderer.xr.enabled&&X,!(!ne||!D||this.is("vr-mode")&&(this.isMobile||k))&&(O=this.getAttribute("embedded")&&!this.is("vr-mode"),z=N(D,O,this.maxCanvasSize,this.is("vr-mode")),ne.aspect=z.width/z.height,ne.updateProjectionMatrix(),this.renderer.setSize(z.width,z.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var ne=this,D,O,k,z;z={alpha:!0,antialias:!S,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(k=this.getAttribute("renderer"),O=x.styleParser.parse(k),O.precision&&(z.precision=O.precision+"p"),O.antialias&&O.antialias!=="auto"&&(z.antialias=O.antialias==="true"),O.logarithmicDepthBuffer&&O.logarithmicDepthBuffer!=="auto"&&(z.logarithmicDepthBuffer=O.logarithmicDepthBuffer==="true"),O.alpha&&(z.alpha=O.alpha==="true"),this.maxCanvasSize={width:O.maxCanvasWidth?parseInt(O.maxCanvasWidth):this.maxCanvasSize.width,height:O.maxCanvasHeight?parseInt(O.maxCanvasHeight):this.maxCanvasSize.height}),D=this.renderer=new g.WebGLRenderer(z),D.setPixelRatio(window.devicePixelRatio),D.sortObjects=!1,this.camera&&D.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){D.xr.setPoseTarget(ne.camera.el.object3D)})},writable:window.debug},play:{value:function(){var ne=this,D=this;if(this.renderStarted){v.prototype.play.call(this);return}this.addEventListener("loaded",function(){var O=this.renderer,k,z=this.renderer.xr;v.prototype.play.call(this),!D.renderStarted&&(D.resize(),D.renderer&&(window.performance&&window.performance.mark("render-started"),h.remove(),k=x.device.getVRDisplay(),k&&k.isPresenting&&(z.setDevice(k),z.enabled=!0,D.enterVR()),O.setAnimationLoop(this.render),D.renderStarted=!0,D.emit("renderstart")))}),setTimeout(function(){v.prototype.load.call(ne)})}},updateComponent:{value:function(ne){ne in m||v.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(ne,D){var O,k=this.systems;for(O=0;O<this.behaviors.tick.length;O++)!this.behaviors.tick[O].el.isPlaying||this.behaviors.tick[O].tick(ne,D);for(O=0;O<this.systemNames.length;O++)!k[this.systemNames[O]].tick||k[this.systemNames[O]].tick(ne,D)}},tock:{value:function(ne,D,O){var k,z=this.systems;for(k=0;k<this.behaviors.tock.length;k++)!this.behaviors.tock[k].el.isPlaying||this.behaviors.tock[k].tock(ne,D,O);for(k=0;k<this.systemNames.length;k++)!z[this.systemNames[k]].tock||z[this.systemNames[k]].tock(ne,D,O)}},render:{value:function(ne,D){var O=this.renderer;this.frame=D,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var k=null;this.is("ar-mode")&&(k=this.object3D.background,this.object3D.background=null),O.render(this.object3D,this.camera),k&&(this.object3D.background=k)},writable:!0}})});function I(ne,D){var O,k=window.devicePixelRatio;return!D||D.width===-1&&D.height===-1||ne.width*k<D.width&&ne.height*k<D.height||(O=ne.width/ne.height,ne.width*k>D.width&&D.width!==-1&&(ne.width=Math.round(D.width/k),ne.height=Math.round(D.width/O/k)),ne.height*k>D.height&&D.height!==-1&&(ne.height=Math.round(D.height/k),ne.width=Math.round(D.height*O/k))),ne}function N(ne,D,O,k){if(!ne.parentElement)return{height:0,width:0};if(D){var z;return z={height:ne.parentElement.offsetHeight,width:ne.parentElement.offsetWidth},I(z,O)}return B(O,k)}function B(ne,D){var O;return O={height:document.body.offsetHeight,width:document.body.offsetWidth},D?O:I(O,ne)}function H(ne){var D=ne.requestFullscreen||ne.webkitRequestFullscreen||ne.mozRequestFullScreen||ne.msRequestFullscreen;D.apply(ne,[{navigationUI:"hide"}])}function q(){var ne=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;!ne||(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function le(ne){var D;D=document.createElement("canvas"),D.classList.add("a-canvas"),D.dataset.aframeCanvas=!0,ne.appendChild(D),document.addEventListener("fullscreenchange",O),document.addEventListener("mozfullscreenchange",O),document.addEventListener("webkitfullscreenchange",O),document.addEventListener("MSFullscreenChange",O),D.addEventListener("touchmove",function(k){k.preventDefault()}),ne.canvas=D,ne.emit("render-target-loaded",{target:D}),setTimeout(E(ne.resize,ne),0);function O(){var k=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;k||ne.exitVR(),document.activeElement.blur(),document.body.focus()}}o.exports.setupCanvas=le},{"../../lib/three":184,"../../utils/":212,"../../utils/ios-orientationchange-blank-bug":213,"../a-entity":132,"../a-node":134,"../a-register-element":135,"../system":147,"./loadingScreen":140,"./metaTags":141,"./postMessage":142,"./scenes":143,"./wakelock":144}],140:[function(i,o,l){var a=i("../../utils/"),u=a.styleParser,h,f,d,m="loading-screen",g="a-loader-title";o.exports.setup=function(_,E){h=_,d=E;var w=h.hasAttribute(m)?u.parse(h.getAttribute(m)):void 0,S=w&&w.dotsColor||"white",T=w&&w.backgroundColor||"#24CAFF",R=w===void 0||w.enabled==="true"||w.enabled===void 0,L,I,N,B,H,q,le,ne,D,O;!R||(L=new THREE.Scene,I=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),N=new THREE.MeshBasicMaterial({color:S}),B=new THREE.Mesh(I,N),H=B.clone(),q=B.clone(),le=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),ne=new THREE.Clock,D=0,O=function(){h.renderer.render(L,le),D=ne.getElapsedTime()%4,B.visible=D>=1,H.visible=D>=2,q.visible=D>=3},L.background=new THREE.Color(T),L.add(le),B.position.set(-1,0,-15),H.position.set(0,0,-15),q.position.set(1,0,-15),le.add(B),le.add(H),le.add(q),v(),setTimeout(function(){h.hasLoaded||(x(le),f.style.display="block",window.addEventListener("resize",function(){x(le)}),h.renderer.setAnimationLoop(O))},200))},o.exports.remove=function(){window.removeEventListener("resize",x),f&&(f.style.display="none")};function x(A){var _=h.hasAttribute("embedded"),E=d(h.canvas,_,h.maxCanvasSize,h.is("vr-mode"));A.aspect=E.width/E.height,A.updateProjectionMatrix(),h.renderer.setSize(E.width,E.height,!1)}function v(){f=document.createElement("div"),f.className=g,f.innerHTML=document.title,f.style.display="none",h.appendChild(f)}},{"../../utils/":212}],141:[function(i,o,l){var a=i("../../constants/"),u=i("../../utils").extend,h=o.exports.MOBILE_HEAD_TAGS=[d({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),d({name:"mobile-web-app-capable",content:"yes"}),d({name:"theme-color",content:"black"})],f=[d({name:"apple-mobile-web-app-capable",content:"yes"}),d({name:"apple-mobile-web-app-status-bar-style",content:"black"}),m({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function d(x){return{tagName:"meta",attributes:x,exists:function(){return document.querySelector('meta[name="'+x.name+'"]')}}}function m(x){return{tagName:"link",attributes:x,exists:function(){return document.querySelector('link[rel="'+x.rel+'"]')}}}o.exports.inject=function(v){var A=document.head,_=A.querySelector("script"),E,w=[];return h.forEach(S),v.isIOS&&f.forEach(S),w;function S(T){!T||T.exists()||(E=g(T),E&&(_?_.parentNode.insertBefore(E,_):A.appendChild(E),w.push(E)))}};function g(x){if(!(!x||!x.tagName)){var v=document.createElement(x.tagName);return v.setAttribute(a.AFRAME_INJECTED,""),u(v,x.attributes)}}},{"../../constants/":128,"../../utils":212}],142:[function(i,o,l){var a=i("../../utils/bind"),u=i("../../utils/").isIframed;o.exports=function(d){!u()||window.addEventListener("message",a(h,d))};function h(f){var d=this;if(!!f.data)switch(f.data.type){case"vr":switch(f.data.data){case"enter":d.enterVR();break;case"exit":d.exitVR();break}}}},{"../../utils/":212,"../../utils/bind":206}],143:[function(i,o,l){o.exports=[]},{}],144:[function(i,o,l){var a=i("../../../vendor/wakelock/wakelock");o.exports=function(h){if(!!h.isMobile){var f=h.wakelock=new a;h.addEventListener("enter-vr",function(){f.request()}),h.addEventListener("exit-vr",function(){f.release()})}}},{"../../../vendor/wakelock/wakelock":227}],145:[function(i,o,l){var a=i("../utils/"),u=i("./propertyTypes"),h=a.debug,f=u.isValidDefaultValue,d=u.propertyTypes,m=h("core:schema:warn");function g(_){return"type"in _?typeof _.type=="string":"default"in _}o.exports.isSingleProperty=g,o.exports.process=function(_,E){var w;if(g(_))return x(_,E);for(w in _)_[w]=x(_[w],E);return _};function x(_,E){var w=_.default,S,T,R=_.type;return _.type?_.type==="bool"?R="boolean":_.type==="float"&&(R="number"):w!==void 0&&(typeof w=="boolean"||typeof w=="number")?R=typeof w:Array.isArray(w)?R="array":R="string",T=d[R],T||m("Unknown property type for component `"+E+"`: "+R),S=!!_.parse,_.parse=_.parse||T.parse,_.stringify=_.stringify||T.stringify,_.type=R,"default"in _?!S&&!f(R,w)&&m("Default value `"+w+"` does not match type `"+R+"` in component `"+E+"`"):_.default=T.default,_}o.exports.processPropertyDefinition=x,o.exports.parseProperties=function(){var _=[];return function(E,w,S,T,R){var L,I,N,B;_.length=0;for(I in S?E:w)S&&E[I]===void 0||_.push(I);if(E===null||typeof E!="object")return E;for(I in E)E[I]!==void 0&&!w[I]&&!R&&m("Unknown property `"+I+"` for component/system `"+T+"`.");for(L=0;L<_.length;L++){if(I=_[L],N=w[I],B=E[I],!w[I])return;E[I]=v(B,N)}return E}}();function v(_,E){return(_==null||_==="")&&(_=E.default,Array.isArray(_)&&(_=_.slice())),E.parse(_,E.default)}o.exports.parseProperty=v,o.exports.stringifyProperties=function(_,E){var w,S,T,R={},L;for(w in _)S=E[w],T=_[w],L=T,typeof L=="object"&&(L=A(T,S),S||m("Unknown component property: "+w)),R[w]=L;return R};function A(_,E){return typeof _!="object"?_:!E||_===null?JSON.stringify(_):E.stringify(_)}o.exports.stringifyProperty=A},{"../utils/":212,"./propertyTypes":138}],146:[function(i,o,l){var a=i("./schema"),u=a.process,h=o.exports.shaders={},f=o.exports.shaderNames=[],d=i("../lib/three"),m=i("../utils"),g={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},x=o.exports.Shader=function(){};x.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(v){return this.attributes=this.initVariables(v,"attribute"),this.uniforms=this.initVariables(v,"uniform"),this.material=new(this.raw?d.RawShaderMaterial:d.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(v,A){var _,E=this.schema,w={},S;for(_ in E)E[_].is===A&&(S=g[E[_].type],w[_]={type:S,value:void 0});return w},update:function(v){this.updateVariables(v,"attribute"),this.updateVariables(v,"uniform")},updateVariables:function(v,A){var _,E,w=this.schema,S;S=A==="uniform"?this.uniforms:this.attributes;for(_ in v)if(!(!w[_]||w[_].is!==A)){if(w[_].type==="map"){if(!S[_]||S[_].value===v[_])continue;E="_texture_"+_,this.setMapOnTextureLoad(S,_,E),m.material.updateMapMaterialFromData(E,_,this,v);continue}S[_].value=this.parseValue(w[_].type,v[_]),S[_].needsUpdate=!0}},parseValue:function(v,A){var _;switch(v){case"vec2":return new d.Vector2(A.x,A.y);case"vec3":return new d.Vector3(A.x,A.y,A.z);case"vec4":return new d.Vector4(A.x,A.y,A.z,A.w);case"color":return _=new d.Color(A),new d.Vector3(_.r,_.g,_.b);case"map":return d.ImageUtils.loadTexture(A);default:return A}},setMapOnTextureLoad:function(v,A,_){var E=this;this.el.addEventListener("materialtextureloaded",function(){v[A].value=E.material[_],v[A].needsUpdate=!0})}},o.exports.registerShader=function(v,A){var _,E={};if(Object.keys(A).forEach(function(w){E[w]={value:A[w],writable:!0}}),h[v])throw new Error("The shader "+v+" has been already registered");return _=function(){x.call(this)},_.prototype=Object.create(x.prototype,E),_.prototype.name=v,_.prototype.constructor=_,h[v]={Shader:_,schema:u(_.prototype.schema)},f.push(v),_}},{"../lib/three":184,"../utils":212,"./schema":145}],147:[function(i,o,l){var a=i("./component"),u=i("./schema"),h=i("../utils/"),f=u.parseProperties,d=u.parseProperty,m=u.process,g=u.isSingleProperty,x=h.styleParser,v=o.exports.systems={},A=o.exports.System=function(_){var E=a&&a.components[this.name];this.el=_,this.sceneEl=_,E&&(E.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};A.prototype={schema:{},init:function(){},update:function(_){},updateProperties:function(_){var E=this.data;!Object.keys(u).length||(this.buildData(_),this.update(E))},buildData:function(_){var E=this.schema;!Object.keys(E).length||(_=_||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),g(E)?this.data=d(_,E):this.data=f(x.parse(_)||{},E))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},o.exports.registerSystem=function(_,E){var w,S,T={},R=h.findAllScenes(document);if(Object.keys(E).forEach(function(L){T[L]={value:E[L],writable:!0}}),v[_])throw new Error("The system `"+_+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(S=function(L){A.call(this,L)},S.prototype=Object.create(A.prototype,T),S.prototype.name=_,S.prototype.constructor=S,S.prototype.schema=h.extend(m(S.prototype.schema)),v[_]=S,w=0;w<R.length;w++)R[w].initSystem(_)}},{"../utils/":212,"./component":136,"./schema":145}],148:[function(i,o,l){i("./pivot")},{"./pivot":149}],149:[function(i,o,l){var a=i("../../core/component").registerComponent,u=i("../../lib/three"),h=new u.Vector3,f=new u.Vector3;a("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var d=this.data,m=this.el,g=m.object3D.parent,x=m.object3D,v=new u.Group;h.copy(x.position),f.copy(x.rotation),g.remove(x),v.add(x),g.add(v),m.object3D=v,x.position.set(-1*d.x,-1*d.y,-1*d.z),v.position.set(d.x+h.x,d.y+h.y,d.z+h.z),v.rotation.copy(x.rotation),x.rotation.set(0,0,0)}})},{"../../core/component":136,"../../lib/three":184}],150:[function(i,o,l){var a=i("../../core/component").components,u=i("../../core/shader").shaders,h=i("../../utils/"),f={};Object.keys(a.material.schema).forEach(d),Object.keys(u.standard.schema).forEach(d);function d(m){var g=m.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();m==="fog"&&(g="material-fog"),m==="visible"&&(g="material-visible"),f[g]="material."+m}o.exports=function(){return{defaultComponents:{material:{}},mappings:h.extend({},f)}}},{"../../core/component":136,"../../core/shader":146,"../../utils/":212}],151:[function(i,o,l){i("./primitives/a-camera"),i("./primitives/a-cursor"),i("./primitives/a-curvedimage"),i("./primitives/a-gltf-model"),i("./primitives/a-image"),i("./primitives/a-light"),i("./primitives/a-link"),i("./primitives/a-obj-model"),i("./primitives/a-sky"),i("./primitives/a-sound"),i("./primitives/a-text"),i("./primitives/a-video"),i("./primitives/a-videosphere"),i("./primitives/meshPrimitives")},{"./primitives/a-camera":153,"./primitives/a-cursor":154,"./primitives/a-curvedimage":155,"./primitives/a-gltf-model":156,"./primitives/a-image":157,"./primitives/a-light":158,"./primitives/a-link":159,"./primitives/a-obj-model":160,"./primitives/a-sky":161,"./primitives/a-sound":162,"./primitives/a-text":163,"./primitives/a-video":164,"./primitives/a-videosphere":165,"./primitives/meshPrimitives":166}],152:[function(i,o,l){var a=i("../../core/a-entity"),u=i("../../core/component").components,h=i("../../core/a-register-element").registerElement,f=i("../../utils/"),d=f.debug,m=f.entity.setComponentProperty,g=d("extras:primitives:debug"),x=d("extras:primitives:warn"),v=o.exports.primitives={};o.exports.registerPrimitive=function(w,S){w=w.toLowerCase(),g("Registering <%s>",w),S.defaultAttributes&&x("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var T=h(w,{prototype:Object.create(a.prototype,{defaultComponentsFromPrimitive:{value:S.defaultComponents||S.defaultAttributes||{}},deprecated:{value:S.deprecated||null},deprecatedMappings:{value:S.deprecatedMappings||{}},mappings:{value:S.mappings||{}},createdCallback:{value:function(){S.deprecated&&console.warn(S.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var R=this.mappings,L=this;Object.keys(R).forEach(function(N){var B;N!==N.toLowerCase()&&x("Mapping keys should be specified in lower case. The mapping key "+N+" may not be recognized"),u[N]&&(B=R[N].replace(".","-"),R[B]=R[N],delete R[N],console.warn("The primitive "+L.tagName.toLowerCase()+" has a mapping collision. The attribute "+N+" has the same name as a registered component and has been renamed to "+B))})}},getExtraComponents:{value:function(){var R,L,I,N,B,H,q=this;for(L=f.clone(this.defaultComponentsFromPrimitive),B=this.getAttribute("mixin"),B&&(B=B.trim().split(" "),B.forEach(function(z){var X=q.sceneEl.querySelector("#"+z).componentCache;Object.keys(X).forEach(function(ie){L[ie]=le(L[ie],X[ie])})})),I=0;I<this.attributes.length;I++)if(R=this.attributes[I],N=this.mappings[R.name],N){H=f.entity.getComponentPropertyPath(N),H.constructor===Array?(L[H[0]]=L[H[0]]||{},L[H[0]][H[1]]=R.value.trim()):L[H]=R.value.trim();continue}return L;function le(k,z){return ne(k)?D(z):ne(z)?D(k):O(k)&&O(z)?f.extendDeep(k,z):D(z)}function ne(k){return typeof k>"u"}function D(k){return O(k)?f.extendDeep({},k):k}function O(k){return k!==null&&k.constructor===Object}}},attributeChangedCallback:{value:function(R,L,I){var N=this.mappings[R];R in this.deprecatedMappings&&console.warn(this.deprecatedMappings[R]),!(!R||!N)&&m(this,N,I)}}})});return v[w]=T,T};function A(E,w){var S=u[E].schema;Object.keys(S).map(function(T){var R=T.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();w[R]!==void 0&&(R=E+"-"+T),w[R]=E+"."+T})}function _(E,w,S){S=S||{},Object.keys(w).map(function(R){A(R,S)}),o.exports.registerPrimitive(E,f.extendDeep({},null,{defaultComponents:w,mappings:S}))}o.exports.definePrimitive=_},{"../../core/a-entity":132,"../../core/a-register-element":135,"../../core/component":136,"../../utils/":212}],153:[function(i,o,l){var a=i("../primitives").registerPrimitive;a("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":152}],154:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../primitives").registerPrimitive,h=i("../../../utils/");u("a-cursor",h.extendDeep({},a(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],155:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../primitives").registerPrimitive,h=i("../../../utils/");u("a-curvedimage",h.extendDeep({},a(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],156:[function(i,o,l){var a=i("../primitives").registerPrimitive;a("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":152}],157:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../primitives").registerPrimitive,h=i("../../../utils/");u("a-image",h.extendDeep({},a(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],158:[function(i,o,l){var a=i("../primitives").registerPrimitive;a("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap"}})},{"../primitives":152}],159:[function(i,o,l){var a=i("../primitives").registerPrimitive;a("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":152}],160:[function(i,o,l){var a=i("../getMeshMixin")(),u=i("../primitives").registerPrimitive,h=i("../../../utils/");u("a-obj-model",h.extendDeep({},a,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],161:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../primitives").registerPrimitive,h=i("../../../utils/"),f=i("./meshPrimitives");u("a-sky",h.extendDeep({},a(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:h.extendDeep({},f["a-sphere"].prototype.mappings)}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152,"./meshPrimitives":166}],162:[function(i,o,l){var a=i("../primitives").registerPrimitive;a("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":152}],163:[function(i,o,l){var a=i("../primitives").definePrimitive;a("a-text",{text:{anchor:"align",width:5}})},{"../primitives":152}],164:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../primitives").registerPrimitive,h=i("../../../utils/");u("a-video",h.extendDeep({},a(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],165:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../primitives").registerPrimitive,h=i("../../../utils/");u("a-videosphere",h.extendDeep({},a(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],166:[function(i,o,l){var a=i("../getMeshMixin"),u=i("../../../core/geometry").geometries,h=i("../../../core/geometry").geometryNames,f=i("../primitives").registerPrimitive,d=i("../../../utils/"),m=o.exports={};h.forEach(function(v){var A=u[v],_=g(v),E={};Object.keys(A.schema).forEach(function(R){E[g(R)]="geometry."+R});var w="a-"+_,S=f(w,d.extendDeep({},a(),{defaultComponents:{geometry:{primitive:v}},mappings:E}));m[w]=S});function g(x){return x.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{"../../../core/geometry":137,"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],167:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(h){this.geometry=new u.BoxGeometry(h.width,h.height,h.depth,h.segmentsWidth,h.segmentsHeight,h.segmentsDepth)}})},{"../core/geometry":137,"../lib/three":184}],168:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=u.Math.degToRad;a("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(f){this.geometry=new u.CircleGeometry(f.radius,f.segments,h(f.thetaStart),h(f.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],169:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=u.Math.degToRad;a("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(f){this.geometry=new u.CylinderGeometry(f.radiusTop,f.radiusBottom,f.height,f.segmentsRadial,f.segmentsHeight,f.openEnded,h(f.thetaStart),h(f.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],170:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=u.Math.degToRad;a("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(f){this.geometry=new u.CylinderGeometry(f.radius,f.radius,f.height,f.segmentsRadial,f.segmentsHeight,f.openEnded,h(f.thetaStart),h(f.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],171:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.DodecahedronGeometry(h.radius,h.detail)}})},{"../core/geometry":137,"../lib/three":184}],172:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.IcosahedronGeometry(h.radius,h.detail)}})},{"../core/geometry":137,"../lib/three":184}],173:[function(i,o,l){i("./box.js"),i("./circle.js"),i("./cone.js"),i("./cylinder.js"),i("./dodecahedron.js"),i("./icosahedron.js"),i("./octahedron.js"),i("./plane.js"),i("./ring.js"),i("./sphere.js"),i("./tetrahedron.js"),i("./torus.js"),i("./torusKnot.js"),i("./triangle.js")},{"./box.js":167,"./circle.js":168,"./cone.js":169,"./cylinder.js":170,"./dodecahedron.js":171,"./icosahedron.js":172,"./octahedron.js":174,"./plane.js":175,"./ring.js":176,"./sphere.js":177,"./tetrahedron.js":178,"./torus.js":179,"./torusKnot.js":180,"./triangle.js":181}],174:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.OctahedronGeometry(h.radius,h.detail)}})},{"../core/geometry":137,"../lib/three":184}],175:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(h){this.geometry=new u.PlaneGeometry(h.width,h.height,h.segmentsWidth,h.segmentsHeight)}})},{"../core/geometry":137,"../lib/three":184}],176:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=u.Math.degToRad;a("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(f){this.geometry=new u.RingGeometry(f.radiusInner,f.radiusOuter,f.segmentsTheta,f.segmentsPhi,h(f.thetaStart),h(f.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],177:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=u.Math.degToRad;a("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(f){this.geometry=new u.SphereGeometry(f.radius,f.segmentsWidth,f.segmentsHeight,h(f.phiStart),h(f.phiLength),h(f.thetaStart),h(f.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],178:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(h){this.geometry=new u.TetrahedronGeometry(h.radius,h.detail)}})},{"../core/geometry":137,"../lib/three":184}],179:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=u.Math.degToRad;a("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(f){this.geometry=new u.TorusGeometry(f.radius,f.radiusTubular*2,f.segmentsRadial,f.segmentsTubular,h(f.arc))}})},{"../core/geometry":137,"../lib/three":184}],180:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three");a("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(h){this.geometry=new u.TorusKnotGeometry(h.radius,h.radiusTubular*2,h.segmentsTubular,h.segmentsRadial,h.p,h.q)}})},{"../core/geometry":137,"../lib/three":184}],181:[function(i,o,l){var a=i("../core/geometry").registerGeometry,u=i("../lib/three"),h=new u.Quaternion,f=new u.Vector3(0,0,1),d=new u.Vector2,m=new u.Vector2,g=new u.Vector2;a("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(x){var v,A,_,E,w,S,T,R,L;_=new u.Triangle,_.a.set(x.vertexA.x,x.vertexA.y,x.vertexA.z),_.b.set(x.vertexB.x,x.vertexB.y,x.vertexB.z),_.c.set(x.vertexC.x,x.vertexC.y,x.vertexC.z),A=_.getNormal(new u.Vector3),h.setFromUnitVectors(A,f),E=_.a.clone().applyQuaternion(h),w=_.b.clone().applyQuaternion(h),S=_.c.clone().applyQuaternion(h),d.set(Math.min(E.x,w.x,S.x),Math.min(E.y,w.y,S.y)),m.set(Math.max(E.x,w.x,S.x),Math.max(E.y,w.y,S.y)),g.set(0,0).subVectors(m,d),E=new u.Vector2().subVectors(E,d).divide(g),w=new u.Vector2().subVectors(w,d).divide(g),S=new u.Vector2().subVectors(S,d).divide(g),v=this.geometry=new u.BufferGeometry,T=[_.a.x,_.a.y,_.a.z,_.b.x,_.b.y,_.b.z,_.c.x,_.c.y,_.c.z],R=[A.x,A.y,A.z,A.x,A.y,A.z,A.x,A.y,A.z],L=[E.x,E.y,w.x,w.y,S.x,S.y],v.setAttribute("position",new u.Float32BufferAttribute(T,3)),v.setAttribute("normal",new u.Float32BufferAttribute(R,3)),v.setAttribute("uv",new u.Float32BufferAttribute(L,2))}})},{"../core/geometry":137,"../lib/three":184}],182:[function(i,o,l){if(window.Promise=window.Promise||i("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var a=i("./utils/isIOSOlderThan10"),u=a(window.navigator.userAgent)?1/window.devicePixelRatio:1,h=i("webvr-polyfill"),f={BUFFER_SCALE:u,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new h(f)}var d=i("./utils/"),m=d.debug;d.isIE11&&(i("custom-event-polyfill"),i("../vendor/starts-with-polyfill"));var g=m("A-Frame:error"),x=m("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&x("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&g("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),i("present"),d.device.isBrowserEnvironment&&(i("./style/aframe.css"),i("./style/rStats.css"));var v=i("./core/scene/a-scene").AScene,A=i("./core/component").components,_=i("./core/component").registerComponent,E=i("./core/geometry").registerGeometry,w=i("./extras/primitives/primitives").registerPrimitive,S=i("./core/shader").registerShader,T=i("./core/system").registerSystem,R=i("./core/shader").shaders,L=i("./core/system").systems,I=window.THREE=i("./lib/three"),N=i("../package");i("./components/index"),i("./geometries/index"),i("./shaders/index"),i("./systems/index");var B=i("./core/a-node"),H=i("./core/a-entity");i("./core/a-assets"),i("./core/a-cubemap"),i("./core/a-mixin"),i("./extras/components/"),i("./extras/primitives/"),console.log("A-Frame Version: 1.3.0 (Date 2022-02-04, Commit #cc3516ce)"),console.log("THREE Version (https://github.com/supermedium/three.js):",N.dependencies["super-three"]),console.log("WebVR Polyfill Version:",N.dependencies["webvr-polyfill"]),o.exports=window.AFRAME={AComponent:i("./core/component").Component,AEntity:H,ANode:B,ANIME:i("super-animejs"),AScene:v,components:A,coreComponents:Object.keys(A),geometries:i("./core/geometry").geometries,registerComponent:_,registerElement:i("./core/a-register-element").registerElement,registerGeometry:E,registerPrimitive:w,registerShader:S,registerSystem:T,primitives:{getMeshMixin:i("./extras/primitives/getMeshMixin"),primitives:i("./extras/primitives/primitives").primitives},scenes:i("./core/scene/scenes"),schema:i("./core/schema"),shaders:R,systems:L,THREE:I,utils:d,version:N.version}},{"../package":74,"../vendor/starts-with-polyfill":225,"./components/index":87,"./core/a-assets":130,"./core/a-cubemap":131,"./core/a-entity":132,"./core/a-mixin":133,"./core/a-node":134,"./core/a-register-element":135,"./core/component":136,"./core/geometry":137,"./core/scene/a-scene":139,"./core/scene/scenes":143,"./core/schema":145,"./core/shader":146,"./core/system":147,"./extras/components/":148,"./extras/primitives/":151,"./extras/primitives/getMeshMixin":150,"./extras/primitives/primitives":152,"./geometries/index":173,"./lib/three":184,"./shaders/index":186,"./style/aframe.css":193,"./style/rStats.css":194,"./systems/index":198,"./utils/":212,"./utils/isIOSOlderThan10":215,"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":69}],183:[function(i,o,l){window.aframeStats=function(a){var u=null,h=a,f={te:{caption:"Entities"},lt:{caption:"Load Time"}},d=[{caption:"A-Frame",values:["te","lt"]}];function m(){u("te").set(g()),window.performance.getEntriesByName&&u("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function g(){var _=h.querySelectorAll("*");return Array.prototype.slice.call(_).filter(function(E){return E.isEntity}),_.length}function x(){}function v(){}function A(_){u=_}return{update:m,start:x,end:v,attach:A,values:f,groups:d,fractions:[]}},typeof o=="object"&&(o.exports={aframeStats:window.aframeStats})},{}],184:[function(i,o,l){(function(a){var u=a.THREE=i("super-three");u.TextureLoader&&(u.TextureLoader.prototype.crossOrigin="anonymous"),u.ImageLoader&&(u.ImageLoader.prototype.crossOrigin="anonymous"),u.Cache&&(u.Cache.enabled=!0),i("../../vendor/DeviceOrientationControls"),i("super-three/examples/js/loaders/DRACOLoader"),i("super-three/examples/js/loaders/GLTFLoader"),i("super-three/examples/js/loaders/OBJLoader"),i("super-three/examples/js/loaders/MTLLoader"),i("super-three/examples/js/utils/BufferGeometryUtils"),i("super-three/examples/js/lights/LightProbeGenerator"),u.DRACOLoader.prototype.crossOrigin="anonymous",u.GLTFLoader.prototype.crossOrigin="anonymous",u.MTLLoader.prototype.crossOrigin="anonymous",u.OBJLoader.prototype.crossOrigin="anonymous",o.exports=u}).call(this,typeof ks<"u"?ks:typeof self<"u"?self:typeof window<"u"?window:{})},{"../../vendor/DeviceOrientationControls":222,"super-three":57,"super-three/examples/js/lights/LightProbeGenerator":58,"super-three/examples/js/loaders/DRACOLoader":59,"super-three/examples/js/loaders/GLTFLoader":60,"super-three/examples/js/loaders/MTLLoader":61,"super-three/examples/js/loaders/OBJLoader":62,"super-three/examples/js/utils/BufferGeometryUtils":63}],185:[function(i,o,l){var a=i("../core/shader").registerShader,u=i("../lib/three"),h=i("../utils/");o.exports.Shader=a("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(d){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new u.Color},this.textureSrc=null,f(d,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new u.MeshBasicMaterial(this.materialData),h.material.updateMap(this,d)},update:function(d){this.updateMaterial(d),h.material.updateMap(this,d)},updateMaterial:function(d){var m;f(d,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(m in this.materialData)this.material[m]=this.materialData[m]}});function f(d,m){return m.color.set(d.color),m.fog=d.fog,m.wireframe=d.wireframe,m.wireframeLinewidth=d.wireframeLinewidth,m}},{"../core/shader":146,"../lib/three":184,"../utils/":212}],186:[function(i,o,l){i("./flat"),i("./standard"),i("./phong"),i("./sdf"),i("./msdf"),i("./ios10hls"),i("./shadow")},{"./flat":185,"./ios10hls":187,"./msdf":188,"./phong":189,"./sdf":190,"./shadow":191,"./standard":192}],187:[function(i,o,l){var a=i("../core/shader").registerShader;o.exports.Shader=a("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},{"../core/shader":146}],188:[function(i,o,l){var a=i("../core/shader").registerShader,u=!!document.createElement("canvas").getContext("webgl2"),h=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),f=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),d=u?f:h,m=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture2D(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),g=["#version 300 es","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),x=u?g:m;o.exports.Shader=a("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:d,fragmentShader:x})},{"../core/shader":146}],189:[function(i,o,l){var a=i("../core/shader").registerShader,u=i("../lib/three"),h=i("../utils/"),f=new u.CubeTextureLoader,d={};o.exports.Shader=a("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(g){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new u.Color,specular:new u.Color,emissive:new u.Color},this.textureSrc=null,m(g,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new u.MeshPhongMaterial(this.materialData),h.material.updateMap(this,g)},update:function(g){this.updateMaterial(g),h.material.updateMap(this,g),g.normalMap&&h.material.updateDistortionMap("normal",this,g),g.displacementMap&&h.material.updateDistortionMap("displacement",this,g),g.ambientOcclusionMap&&h.material.updateDistortionMap("ambientOcclusion",this,g),g.bump&&h.material.updateDistortionMap("bump",this,g),this.updateEnvMap(g)},updateMaterial:function(g){var x;m(g,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(x in this.materialData)this.material[x]=this.materialData[x]},updateEnvMap:function(g){var x=this,v=this.material,A=g.envMap,_=g.sphericalEnvMap,E=g.refract,w=this.el.sceneEl;if(!A&&!_||this.isLoadingEnvMap){Object.defineProperty(v,"envMap",{get:function(){return w.object3D.environment},set:function(S){delete this.envMap,this.envMap=S}}),v.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,delete v.envMap,_){this.el.sceneEl.systems.material.loadTexture(_,{src:_},function(T){x.isLoadingEnvMap=!1,T.mapping=E?u.EquirectangularRefractionMapping:u.EquirectangularReflectionMapping,v.envMap=T,h.material.handleTextureEvents(x.el,T),v.needsUpdate=!0});return}if(d[A]){d[A].then(function(S){x.isLoadingEnvMap=!1,v.envMap=S,h.material.handleTextureEvents(x.el,S),v.needsUpdate=!0});return}d[A]=new Promise(function(S){h.srcLoader.validateCubemapSrc(A,function(R){f.load(R,function(L){x.isLoadingEnvMap=!1,v.envMap=L,L.mapping=E?u.CubeRefractionMapping:u.CubeReflectionMapping,h.material.handleTextureEvents(x.el,L),S(L)})})})}});function m(g,x){switch(x.color.set(g.color),x.specular.set(g.emissive),x.emissive.set(g.emissive),x.emissiveIntensity=g.emissiveIntensity,x.fog=g.fog,x.transparent=g.transparent,x.wireframe=g.wireframe,x.wireframeLinewidth=g.wireframeLinewidth,x.shininess=g.shininess,x.flatShading=g.flatShading,x.wireframe=g.wireframe,x.wireframeLinewidth=g.wireframeLinewidth,x.reflectivity=g.reflectivity,x.refractionRatio=g.refractionRatio,g.combine){case"mix":x.combine=u.MixOperation;break;case"multiply":x.combine=u.MultiplyOperation;break;case"add":x.combine=u.AddOperation;break}return g.normalMap&&(x.normalScale=g.normalScale),g.ambientOcclusionMap&&(x.aoMapIntensity=g.ambientOcclusionMapIntensity),g.bumpMap&&(x.aoMapIntensity=g.bumpMapScale),g.displacementMap&&(x.displacementScale=g.displacementScale,x.displacementBias=g.displacementBias),x}},{"../core/shader":146,"../lib/three":184,"../utils/":212}],190:[function(i,o,l){var a=i("../core/shader").registerShader,u=!!document.createElement("canvas").getContext("webgl2"),h=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),f=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),d=u?f:h,m=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture2D(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture2D(map, box.xy).a, width)","        + contour(texture2D(map, box.zw).a, width)","        + contour(texture2D(map, box.xw).a, width)","        + contour(texture2D(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture2D(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  gl_FragColor = vec4(color, opacity * alpha);","}"].join(`
`),g=["#version 300 es","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`),x=u?g:m;o.exports.Shader=a("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:d,fragmentShader:x})},{"../core/shader":146}],191:[function(i,o,l){var a=i("../core/shader").registerShader,u=i("../lib/three");o.exports.Shader=a("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(h){this.rendererSystem=this.el.sceneEl.systems.renderer,this.material=new u.ShadowMaterial},update:function(h){this.material.opacity=h.opacity,this.material.alphaToCoverage=h.alphaToCoverage,this.material.transparent=h.transparent}})},{"../core/shader":146,"../lib/three":184}],192:[function(i,o,l){var a=i("../core/shader").registerShader,u=i("../lib/three"),h=i("../utils/"),f=new u.CubeTextureLoader,d={};o.exports.Shader=a("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(g){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new u.Color,emissive:new u.Color},m(g,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new u.MeshStandardMaterial(this.materialData),h.material.updateMap(this,g),g.normalMap&&h.material.updateDistortionMap("normal",this,g),g.displacementMap&&h.material.updateDistortionMap("displacement",this,g),g.ambientOcclusionMap&&h.material.updateDistortionMap("ambientOcclusion",this,g),g.metalnessMap&&h.material.updateDistortionMap("metalness",this,g),g.roughnessMap&&h.material.updateDistortionMap("roughness",this,g),this.updateEnvMap(g)},update:function(g){this.updateMaterial(g),h.material.updateMap(this,g),g.normalMap&&h.material.updateDistortionMap("normal",this,g),g.displacementMap&&h.material.updateDistortionMap("displacement",this,g),g.ambientOcclusionMap&&h.material.updateDistortionMap("ambientOcclusion",this,g),g.metalnessMap&&h.material.updateDistortionMap("metalness",this,g),g.roughnessMap&&h.material.updateDistortionMap("roughness",this,g),this.updateEnvMap(g)},updateMaterial:function(g){var x,v=this.material;m(g,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive);for(x in this.materialData)v[x]=this.materialData[x]},updateEnvMap:function(g){var x=this,v=this.material,A=g.envMap,_=g.sphericalEnvMap;if(!A&&!_||this.isLoadingEnvMap){v.envMap=null,v.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,_){this.el.sceneEl.systems.material.loadTexture(_,{src:_},function(w){x.isLoadingEnvMap=!1,w.mapping=u.EquirectangularReflectionMapping,v.envMap=w,h.material.handleTextureEvents(x.el,w),v.needsUpdate=!0});return}if(d[A]){d[A].then(function(E){x.isLoadingEnvMap=!1,v.envMap=E,h.material.handleTextureEvents(x.el,E),v.needsUpdate=!0});return}d[A]=new Promise(function(E){h.srcLoader.validateCubemapSrc(A,function(S){f.load(S,function(T){x.isLoadingEnvMap=!1,v.envMap=T,h.material.handleTextureEvents(x.el,T),E(T)})})})}});function m(g,x){return x.color.set(g.color),x.emissive.set(g.emissive),x.emissiveIntensity=g.emissiveIntensity,x.fog=g.fog,x.metalness=g.metalness,x.roughness=g.roughness,x.wireframe=g.wireframe,x.wireframeLinewidth=g.wireframeLinewidth,g.normalMap&&(x.normalScale=g.normalScale),g.ambientOcclusionMap&&(x.aoMapIntensity=g.ambientOcclusionMapIntensity),g.displacementMap&&(x.displacementScale=g.displacementScale,x.displacementBias=g.displacementBias),x}},{"../core/shader":146,"../lib/three":184,"../utils/":212}],193:[function(i,o,l){var a=`html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:"Insert phone into Cardboard holder.";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}.a-dom-overlay:not(.a-no-style){overflow:hidden;position:absolute;pointer-events:none;box-sizing:border-box;bottom:0;left:0;right:0;top:0;padding:1em}.a-dom-overlay:not(.a-no-style)>*{pointer-events:auto}`;i("browserify-css").createStyle(a,{href:"src/style/aframe.css"}),o.exports=a},{"browserify-css":4}],194:[function(i,o,l){var a=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";i("browserify-css").createStyle(a,{href:"src/style/rStats.css"}),o.exports=a},{"browserify-css":4}],195:[function(i,o,l){var a=i("../constants/"),u=i("../core/system").registerSystem,h="data-aframe-default-camera";o.exports.System=u("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var d,m,g=this.sceneEl,x=this;if(g.camera&&!g.camera.el.getAttribute("camera").spectator){g.emit("cameraready",{cameraEl:g.camera.el});return}if(d=g.querySelectorAll("a-camera, [camera]"),!d.length){this.createDefaultCamera();return}for(this.numUserCameras=d.length,m=0;m<d.length;m++)d[m].addEventListener("object3dset",function(v){v.detail.type==="camera"&&x.checkUserCamera(this)}),d[m].isNode?d[m].load():d[m].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(d){var m,g=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(m=d.getAttribute("camera"),!m.active||m.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,g.camera=d.getObject3D("camera"),g.emit("cameraready",{cameraEl:d})}},createDefaultCamera:function(){var d,m=this.sceneEl;d=document.createElement("a-entity"),d.setAttribute("camera",{active:!0}),d.setAttribute("position",{x:0,y:a.DEFAULT_CAMERA_HEIGHT,z:0}),d.setAttribute("wasd-controls",""),d.setAttribute("look-controls",""),d.setAttribute(a.AFRAME_INJECTED,""),d.addEventListener("object3dset",function(g){g.detail.type==="camera"&&(m.camera=g.detail.object,m.emit("cameraready",{cameraEl:d}))}),m.appendChild(d)},disableActiveCamera:function(){var d,m;d=this.sceneEl.querySelectorAll("[camera]"),m=d[d.length-1],m.setAttribute("camera","active",!0)},setActiveCamera:function(d){var m,g,x,v,A=this.activeCameraEl,_=this.sceneEl;if(v=d.getObject3D("camera"),!(!v||d===this.activeCameraEl)){var E=_.querySelector("["+h+"]"),w=E&&E.querySelector("[camera]");for(d!==w&&f(_),this.activeCameraEl=d,this.activeCameraEl.play(),_.camera=v,A&&A.setAttribute("camera","active",!1),g=_.querySelectorAll("[camera]"),x=0;x<g.length;x++)m=g[x],!(!m.isEntity||d===m)&&(m.setAttribute("camera","active",!1),m.pause());_.emit("camera-set-active",{cameraEl:d})}},setSpectatorCamera:function(d){var m,g=this.spectatorCameraEl,x=this.sceneEl,v;m=d.getObject3D("camera"),!(!m||d===this.spectatorCameraEl)&&(g&&g.setAttribute("camera","spectator",!1),v=this.spectatorCameraEl=d,x.addEventListener("enter-vr",this.wrapRender),x.addEventListener("exit-vr",this.unwrapRender),v.setAttribute("camera","active",!1),v.play(),x.emit("camera-set-spectator",{cameraEl:d}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){!this.originalRender||(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(d,m){var g,x=this.sceneEl,v;g=x.renderer.xr.enabled,this.originalRender.call(x.renderer,d,m),!(!this.spectatorCameraEl||x.isMobile||!g)&&(v=this.spectatorCameraEl.components.camera.camera,x.renderer.xr.enabled=!1,this.originalRender.call(x.renderer,d,v),x.renderer.xr.enabled=g)}});function f(d){var m,g=d.camera;!g||(m=d.querySelector("["+h+"]"),m&&d.removeChild(m))}},{"../constants/":128,"../core/system":147}],196:[function(i,o,l){var a=i("../core/geometry").geometries,u=i("../core/system").registerSystem;o.exports.System=u("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(m){var g=this.cache,x,v;return m.skipCache?h(m):(v=this.hash(m),x=g[v],d(this.cacheCount,v),x||(x=h(m),g[v]=x,x))},unuseGeometry:function(m){var g=this.cache,x=this.cacheCount,v,A;m.skipCache||(A=this.hash(m),g[A]&&(f(x,A),!(x[A]>0)&&(v=g[A],v.dispose(),delete g[A],delete x[A])))},hash:function(m){return JSON.stringify(m)}});function h(m){var g=m.primitive,x=a[g]&&a[g].Geometry,v=new x;if(!x)throw new Error("Unknown geometry `"+g+"`");return v.init(m),v.geometry}function f(m,g){m[g]--}function d(m,g){m[g]=m[g]===void 0?1:m[g]+1}},{"../core/geometry":137,"../core/system":147}],197:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../lib/three");function h(f){return new Promise(function(d,m){var g=document.createElement("script");document.body.appendChild(g),g.onload=d,g.onerror=m,g.async=!0,g.src=f})}o.exports.System=a("gltf-model",{schema:{dracoDecoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var f=this.data.dracoDecoderPath,d=this.data.meshoptDecoderPath;!this.dracoLoader&&f&&(this.dracoLoader=new u.DRACOLoader,this.dracoLoader.setDecoderPath(f)),!this.meshoptDecoder&&d&&(this.meshoptDecoder=h(d).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},{"../core/system":147,"../lib/three":184}],198:[function(i,o,l){i("./camera"),i("./geometry"),i("./gltf-model"),i("./light"),i("./material"),i("./renderer"),i("./shadow"),i("./tracked-controls-webvr"),i("./tracked-controls-webxr"),i("./webxr")},{"./camera":195,"./geometry":196,"./gltf-model":197,"./light":199,"./material":200,"./renderer":201,"./shadow":202,"./tracked-controls-webvr":203,"./tracked-controls-webxr":204,"./webxr":205}],199:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../utils/bind"),h=i("../constants/"),f="data-aframe-default-light";o.exports.System=a("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",u(this.setupDefaultLights,this))},registerLight:function(d){d.hasAttribute(f)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var d,m=this.sceneEl;if(!!this.defaultLights){d=document.querySelectorAll("["+f+"]");for(var g=0;g<d.length;g++)m.removeChild(d[g]);this.defaultLights=!1}},setupDefaultLights:function(){var d=this.sceneEl,m,g;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(m=document.createElement("a-entity"),m.setAttribute("light",{color:"#BBB",type:"ambient"}),m.setAttribute(f,""),m.setAttribute(h.AFRAME_INJECTED,""),d.appendChild(m),g=document.createElement("a-entity"),g.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),g.setAttribute("position",{x:-.5,y:1,z:1}),g.setAttribute(f,""),g.setAttribute(h.AFRAME_INJECTED,""),d.appendChild(g),this.defaultLights=!0)}})},{"../constants/":128,"../core/system":147,"../utils/bind":206}],200:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../lib/three"),h=i("../utils/"),f=i("../utils/material").isHLS,d=i("../utils/material").setTextureProperties,m=h.bind,g=h.debug,x=g("components:texture:error"),v=new u.TextureLoader,A=g("components:texture:warn");v.setCrossOrigin("anonymous"),o.exports.System=a("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",m(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(T,R,L){var I=this;if(T.tagName==="CANVAS"){this.loadCanvas(T,R,L);return}if(T.tagName==="VIDEO"){!T.src&&!T.srcObject&&!T.childElementCount&&A("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(T,R,L);return}h.srcLoader.validateSrc(T,N,B);function N(H){I.loadImage(H,R,L)}function B(H){I.loadVideo(H,R,L)}},loadImage:function(T,R,L){var I=this.hash(R),N=this.textureCache;if(N[I]){N[I].then(L);return}N[I]=E(T,R),N[I].then(L)},loadCanvas:function(T,R,L){var I;I=new u.CanvasTexture(T),d(I,R),L(I)},loadVideo:function(T,R,L){var I,N,B=this.textureCache,H,q;function le(ne){ne.texture.needsUpdate=!0,L(ne.texture,ne.videoEl)}if(typeof T!="string"){if(H=T,I=this.hashVideo(R,H),B[I]){B[I].then(le);return}S(H)}if(H=H||w(T,R.width,R.height),I=this.hashVideo(R,H),B[I]){B[I].then(le);return}N=new u.VideoTexture(H),N.minFilter=u.LinearFilter,d(N,R),this.sceneEl.isIOS&&f(H.src||H.getAttribute("src"),H.type||H.getAttribute("type"))&&(N.format=u.RGBAFormat,N.needsCorrectionBGRA=!0,N.flipY=!1,N.needsCorrectionFlipY=!0),q={texture:N,videoEl:H},B[I]=Promise.resolve(q),le(q)},hash:function(T){return T.src.tagName&&(T=h.extendDeep({},T),T.src=T.src.src),JSON.stringify(T)},hashVideo:function(T,R){return _(T,R)},registerMaterial:function(T){this.materials[T.uuid]=T},unregisterMaterial:function(T){delete this.materials[T.uuid];var R=this.textureCounts;Object.keys(T).filter(function(L){return T[L]&&T[L].isTexture}).forEach(function(L){R[T[L].uuid]--,R[T[L].uuid]<=0&&T[L].dispose()})},updateMaterials:function(T){var R=this.materials;Object.keys(R).forEach(function(L){R[L].needsUpdate=!0})},onMaterialTextureLoaded:function(T){this.textureCounts[T.detail.texture.uuid]||(this.textureCounts[T.detail.texture.uuid]=0),this.textureCounts[T.detail.texture.uuid]++}});function _(T,R){var L,I=R.getAttribute("id"),N,B;if(I)return I;for(N="",B=T||{},L=0;L<R.attributes.length;L++)B[R.attributes[L].name]=R.attributes[L].value;return Object.keys(B).sort().forEach(function(H){N+=H+":"+B[H]+";"}),N}function E(T,R){return new Promise(L);function L(I,N){var B=typeof T!="string";function H(q){d(q,R),q.needsUpdate=!0,I(q)}if(B){H(new u.Texture(T));return}v.load(T,H,function(){},function(q){x("`$s` could not be fetched (Error code: %s; Response: %s)",q.status,q.statusText)})}}function w(T,R,L){var I=document.createElement("video");return I.width=R,I.height=L,I.setAttribute("playsinline",""),I.setAttribute("webkit-playsinline",""),I.autoplay=!0,I.loop=!0,I.crossOrigin="anonymous",I.addEventListener("error",function(){A("`$s` is not a valid video",T)},!0),I.src=T,I}function S(T){return T.autoplay=T.hasAttribute("autoplay")&&T.getAttribute("autoplay")!=="false",T.controls=T.hasAttribute("controls")&&T.getAttribute("controls")!=="false",T.getAttribute("loop")==="false"&&T.removeAttribute("loop"),T.getAttribute("preload")==="false"&&(T.preload="none"),T.crossOrigin=T.crossOrigin||"anonymous",T.setAttribute("playsinline",""),T.setAttribute("webkit-playsinline",""),T}},{"../core/system":147,"../lib/three":184,"../utils/":212,"../utils/material":216}],201:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../utils/"),h=i("../lib/three"),f=u.debug,d=f("components:renderer:warn");o.exports.System=a("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:u.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var m=this.data,g=this.el,x=g.renderer;x.sortObjects=m.sortObjects,x.physicallyCorrectLights=m.physicallyCorrectLights,(m.colorManagement||m.gammaOutput)&&(x.outputEncoding=h.sRGBEncoding,m.gammaOutput&&d('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),g.hasAttribute("antialias")&&d('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),g.hasAttribute("logarithmicDepthBuffer")&&d('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(m){!this.data.colorManagement||!m||(m.isColor?m.convertSRGBToLinear():m.isTexture&&(m.encoding=h.sRGBEncoding))}})},{"../core/system":147,"../lib/three":184,"../utils/":212}],202:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../lib/three"),h={basic:u.BasicShadowMap,pcf:u.PCFShadowMap,pcfsoft:u.PCFSoftShadowMap};o.exports.System=a("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var f=this.sceneEl,d=this.data;this.shadowMapEnabled=!1,f.renderer&&(f.renderer.shadowMap.type=h[d.type],f.renderer.shadowMap.autoUpdate=d.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(f){f.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(f){var d=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&f,d&&(d.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":147,"../lib/three":184}],203:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../utils"),h=u.device.isWebXRAvailable;o.exports.System=a("tracked-controls-webvr",{init:function(){var f=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=u.throttle(this.updateControllerList,500,this),!h&&(!navigator.getVRDisplays||this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(d){d.length&&(f.vrDisplay=d[0])})}))},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var f=this.controllers,d,m,g,x;if(m=navigator.getGamepads&&navigator.getGamepads(),!!m){for(x=f.length,f.length=0,g=0;g<m.length;++g)d=m[g],d&&d.pose&&f.push(d);f.length!==x&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":147,"../utils":212}],204:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../utils");o.exports.System=a("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=u.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var h=this,f=this.el.xrSession;if(!f){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var d=h.el.sceneEl.systems.webxr.sessionReferenceSpaceType;f.requestReferenceSpace(d).then(function(m){h.referenceSpace=m}).catch(function(m){throw h.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(d,'tracked-controls-webxr uses reference space "'+d+'".'),m})},updateControllerList:function(){var h=this.el.xrSession,f=this.oldControllers,d;if(!h){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(!!h.inputSources){if(this.controllers=h.inputSources,this.oldControllersLength===this.controllers.length){var m=!0;for(d=0;d<this.controllers.length;++d)if(!(this.controllers[d]===f[d]&&this.controllers[d].gamepad===f[d].gamepad)){m=!1;break}if(m)return}for(f.length=0,d=0;d<this.controllers.length;d++)f.push(this.controllers[d]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":147,"../utils":212}],205:[function(i,o,l){var a=i("../core/system").registerSystem,u=i("../utils/"),h=u.debug("systems:webxr:warn");o.exports.System=a("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var f=this.data;this.sessionConfiguration={requiredFeatures:f.requiredFeatures,optionalFeatures:f.optionalFeatures},this.sessionReferenceSpaceType=f.referenceSpaceType,f.overlayElement&&(f.overlayElement.classList.remove("a-dom-overlay"),f.optionalFeatures.includes("dom-overlay")||(f.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",f)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:f.overlayElement},f.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(f){return!!(f==="viewer"||f==="local"||this.sessionConfiguration.requiredFeatures.includes(f)||this.sessionConfiguration.optionalFeatures.includes(f))},warnIfFeatureNotRequested:function(f,d){if(!this.wasFeatureRequested(f)){var m='Please add the feature "'+f+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;h((d?d+" ":"")+m)}}})},{"../core/system":147,"../utils/":212}],206:[function(i,o,l){o.exports=function(u,h){return function(f){return function(){var m=f.concat(Array.prototype.slice.call(arguments,0));return u.apply(h,m)}}(Array.prototype.slice.call(arguments,2))}},{}],207:[function(i,o,l){var a=i("./debug"),u=i("object-assign"),h=a("utils:coordinates:warn"),f=["x","y","z","w"],d=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;o.exports.regex=d;var m="object",g=/\s+/g;function x(E,w){var S,T,R,L,I,N,B,H,q;if(E&&E instanceof Object)return N=E.x===void 0?w&&w.x:E.x,B=E.y===void 0?w&&w.y:E.y,H=E.z===void 0?w&&w.z:E.z,q=E.w===void 0?w&&w.w:E.w,N!=null&&(E.x=_(N)),B!=null&&(E.y=_(B)),H!=null&&(E.z=_(H)),q!=null&&(E.w=_(q)),E;if(E==null)return typeof w===m?u({},w):w;for(S=E.trim().split(g),I={},L=0;L<f.length;L++)if(R=f[L],S[L])I[R]=parseFloat(S[L],10);else{if(T=w&&w[R],T===void 0)continue;I[R]=_(T)}return I}o.exports.parse=x;function v(E){var w;return typeof E!==m?E:(w=E.x+" "+E.y,E.z!=null&&(w+=" "+E.z),E.w!=null&&(w+=" "+E.w),w)}o.exports.stringify=v;function A(E){return d.test(E)}o.exports.isCoordinates=A,o.exports.isCoordinate=function(E){return h("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),A(E)};function _(E){return E!=null&&E.constructor===String?parseFloat(E,10):E}o.exports.toVector3=function(E){return new THREE.Vector3(E.x,E.y,E.z)}},{"./debug":208,"object-assign":39}],208:[function(i,o,l){(function(a){var u=i("debug"),h=i("object-assign"),f={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},d=function(A){var _=u(A);return _.color=g(A),_};h(d,u);function m(A){var _=A.split(":");return _[_.length-1]}function g(A){var _=m(A),E=f.colors&&f.colors[_];return E||null}function x(){try{return window.localStorage}catch{}}var v=x();v&&(parseInt(v.logs,10)||v.logs==="true")?d.enable("*"):d.enable("*:error,*:info,*:warn"),a.browser&&(window.logs=d),o.exports=d}).call(this,i("_process"))},{_process:49,debug:8,"object-assign":39}],209:[function(i,o,l){(function(a){var u=i("debug")("device:error"),h,f=!1,d=!1,m=o.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(B){var H;m||(H=document.createElement("canvas"),h=B.display,H.getContext("webgl",{}),h.requestPresent([{source:H}]).then(function(){},function(){}))}),m){var g=function(){var B=document.querySelector("a-scene");if(!B){window.addEventListener("DOMContentLoaded",g);return}B.hasLoaded?B.components["vr-mode-ui"].updateEnterInterfaces():B.addEventListener("loaded",g)},x=function(B){u("WebXR session support error: "+B.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(B){f=B,g()}).catch(x),navigator.xr.isSessionSupported("immersive-ar").then(function(B){d=B,g()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){f=!0,g()}).catch(x),navigator.xr.supportsSession("immersive-ar").then(function(){d=!0,g()}).catch(function(){})):u("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(B){var H=document.querySelector("a-scene");h=B.length&&B[0],H&&H.emit("displayconnected",{vrDisplay:h})});function v(){return h}o.exports.getVRDisplay=v;function A(){return f||d||!!v()}o.exports.checkHeadsetConnected=A;function _(){return d}o.exports.checkARSupport=_;var E=function(){var B=!1;return function(H){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(H)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(H.substr(0,4)))&&(B=!0),(S()||w()||N())&&(B=!0),I()&&(B=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return B}}();o.exports.isMobile=E;function w(B){var H=B||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(H)}o.exports.isTablet=w;function S(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}o.exports.isIOS=S;function T(){return!E()&&!I()&&window.orientation!==void 0}o.exports.isMobileDeviceRequestingDesktopSite=T;function R(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}o.exports.isOculusBrowser=R;function L(){return/(Mobile VR)/i.test(window.navigator.userAgent)}o.exports.isFirefoxReality=L;function I(){return R()||L()}o.exports.isMobileVR=I;function N(){return/R7 Build/.test(window.navigator.userAgent)}o.exports.isR7=N,o.exports.isLandscape=function(){var B=window.orientation;return N()&&(B+=90),B===90||B===-90},o.exports.isBrowserEnvironment=!!(!a||a.browser),o.exports.isNodeEnvironment=!o.exports.isBrowserEnvironment}).call(this,i("_process"))},{_process:49,debug:8}],210:[function(i,o,l){var a={};function u(h,f){return f=f||".",a[f]||(a[f]={}),h.indexOf(f)!==-1?a[f][h]=h.split(f):a[f][h]=h,a[f][h]}o.exports.getComponentPropertyPath=u,o.exports.propertyPathCache=a,o.exports.getComponentProperty=function(h,f,d){var m;return d=d||".",f.indexOf(d)!==-1?(m=u(f,d),m.constructor===String?h.getAttribute(m):h.getAttribute(m[0])[m[1]]):h.getAttribute(f)},o.exports.setComponentProperty=function(h,f,d,m){var g;if(m=m||".",f.indexOf(m)!==-1){g=u(f,m),g.constructor===String?h.setAttribute(g,d):h.setAttribute(g[0],g[1],d);return}h.setAttribute(f,d)}},{}],211:[function(i,o,l){o.exports=function(u){var h=u.style.width,f=u.style.height;u.style.width=parseInt(h,10)+1+"px",u.style.height=parseInt(f,10)+1+"px",setTimeout(function(){u.style.width=h,u.style.height=f},200)}},{}],212:[function(i,o,l){var a=i("./debug"),u=i("deep-assign"),h=i("./device"),f=i("object-assign"),d=i("./object-pool"),m=a("utils:warn");o.exports.bind=i("./bind"),o.exports.coordinates=i("./coordinates"),o.exports.debug=a,o.exports.device=h,o.exports.entity=i("./entity"),o.exports.forceCanvasResizeSafariMobile=i("./forceCanvasResizeSafariMobile"),o.exports.isIE11=i("./is-ie11"),o.exports.material=i("./material"),o.exports.objectPool=d,o.exports.split=i("./split").split,o.exports.styleParser=i("./styleParser"),o.exports.trackedControls=i("./tracked-controls"),o.exports.checkHeadsetConnected=function(){return m("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),h.checkHeadsetConnected(arguments)},o.exports.isGearVR=o.exports.device.isGearVR=function(){m("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},o.exports.isIOS=function(){return m("`utils.isIOS` has moved to `utils.device.isIOS`"),h.isIOS(arguments)},o.exports.isOculusGo=o.exports.device.isOculusGo=function(){m("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},o.exports.isMobile=function(){return m("`utils.isMobile has moved to `utils.device.isMobile`"),h.isMobile(arguments)},o.exports.throttle=function(x,v,A){var _;return A&&(x=o.exports.bind(x,A)),function(){var E=Date.now(),w=typeof _>"u"?v:E-_;(typeof _>"u"||w>=v)&&(_=E,x.apply(null,arguments))}},o.exports.throttleComponentChanged=function(x,v,A){var _,E;return A&&(x=o.exports.bind(x,A)),function(){var w=Date.now(),S=typeof _>"u"?v:w-_,T=arguments;typeof _>"u"||S>=v?(clearTimeout(E),_=w,x.apply(null,T)):(clearTimeout(E),E=setTimeout(function(){_=Date.now(),x.apply(this,T)},v-S))}},o.exports.throttleTick=function(x,v,A){var _;return A&&(x=o.exports.bind(x,A)),function(E,w){var S=typeof _>"u"?w:E-_;(typeof _>"u"||S>=v)&&(_=E,x(E,S))}},o.exports.debounce=function(x,v,A){var _;return function(){var E=this,w=arguments,S=function(){_=null,A||x.apply(E,w)},T=A&&!_;clearTimeout(_),_=setTimeout(S,v),T&&x.apply(E,w)}},o.exports.extend=f,o.exports.extendDeep=u,o.exports.clone=function(x){return JSON.parse(JSON.stringify(x))};var g=function(){var x=d.createPool(function(){return[]});return function(v,A){var _,E,w,S,T,R;if(v===void 0||A===void 0||v===null||A===null||!(v&&A&&v.constructor===Object&&A.constructor===Object||v.constructor===Array&&A.constructor===Array))return v===A;E=x.use(),w=x.use(),E.length=0,w.length=0;for(_ in v)E.push(_);for(_ in A)w.push(_);if(E.length!==w.length)return x.recycle(E),x.recycle(w),!1;for(S=0;S<E.length;++S)if(T=v[E[S]],R=A[E[S]],typeof T=="object"||typeof R=="object"||Array.isArray(T)&&Array.isArray(R)){if(T===R)continue;if(!g(T,R))return x.recycle(E),x.recycle(w),!1}else if(T!==R)return x.recycle(E),x.recycle(w),!1;return x.recycle(E),x.recycle(w),!0}}();o.exports.deepEqual=g,o.exports.diff=function(){var x=[];return function(v,A,_){var E,w,S,T,R,L,I;T=_||{},x.length=0;for(R in v)x.push(R);if(!A)return T;for(S in A)x.indexOf(S)===-1&&x.push(S);for(L=0;L<x.length;L++)R=x[L],E=v[R],w=A[R],I=E&&w&&E.constructor===Object&&w.constructor===Object,(I&&!g(E,w)||!I&&E!==w)&&(T[R]=w);return T}}(),o.exports.shouldCaptureKeyEvent=function(x){return x.metaKey?!1:document.activeElement===document.body},o.exports.splitString=function(x,v){typeof v>"u"&&(v=" ");var A=new RegExp(v,"g");return x=(x||"").replace(A,v),x.split(v)},o.exports.getElData=function(x,v){v=v||{};var A={};Object.keys(v).forEach(_);function _(E){x.hasAttribute(E)&&(A[E]=x.getAttribute(E))}return A},o.exports.getUrlParameter=function(x){x=x.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var v=new RegExp("[\\?&]"+x+"=([^&#]*)"),A=v.exec(location.search);return A===null?"":decodeURIComponent(A[1].replace(/\+/g," "))},o.exports.isIframed=function(){return window.top!==window.self},o.exports.findAllScenes=function(x){for(var v=[],A=x.getElementsByTagName("*"),_=0,E=A.length;_<E;_++)A[_].isScene&&v.push(A[_]);return v},o.exports.srcLoader=i("./src-loader")},{"./bind":206,"./coordinates":207,"./debug":208,"./device":209,"./entity":210,"./forceCanvasResizeSafariMobile":211,"./is-ie11":214,"./material":216,"./object-pool":217,"./split":218,"./src-loader":219,"./styleParser":220,"./tracked-controls":221,"deep-assign":10,"object-assign":39}],213:[function(i,o,l){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],214:[function(i,o,l){function a(){var u=-1,h=navigator.userAgent,f;return navigator.appName==="Microsoft Internet Explorer"?(f=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),f.exec(h)!=null&&(u=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(f=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),f.exec(h)!=null&&(u=parseFloat(RegExp.$1))),u}o.exports=a()===11},{}],215:[function(i,o,l){o.exports=function(u){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(u)}},{}],216:[function(i,o,l){var a=i("../lib/three"),u=["application/x-mpegurl","application/vnd.apple.mpegurl"],h=new Set(["emissiveMap","envMap","map","specularMap"]);function f(m,g){var x=g.offset||{x:0,y:0},v=g.repeat||{x:1,y:1},A=g.npot||!1;A&&(m.wrapS=a.ClampToEdgeWrapping,m.wrapT=a.ClampToEdgeWrapping,m.magFilter=a.LinearFilter,m.minFilter=a.LinearFilter),(v.x!==1||v.y!==1)&&(m.wrapS=a.RepeatWrapping,m.wrapT=a.RepeatWrapping,m.repeat.set(v.x,v.y)),(x.x!==0||x.y!==0)&&m.offset.set(x.x,x.y)}o.exports.setTextureProperties=f,o.exports.updateMapMaterialFromData=function(m,g,x,v){var A=x.el,_=x.material,E=A.sceneEl.systems.renderer,w=v[g];if(x.materialSrcs||(x.materialSrcs={}),!w){delete x.materialSrcs[m],T(null);return}if(w===x.materialSrcs[m]&&_[m]){f(_[m],v);return}x.materialSrcs[m]=w,w instanceof a.Texture?T(w):A.sceneEl.systems.material.loadTexture(w,{src:w,repeat:v.repeat,offset:v.offset,npot:v.npot},S);function S(R){x.materialSrcs[m]===w&&T(R)}function T(R){_[m]=R,R&&h.has(m)&&E.applyColorCorrection(R),_.needsUpdate=!0,d(A,R)}},o.exports.updateMap=function(m,g){return o.exports.updateMapMaterialFromData("map","src",m,g)},o.exports.updateDistortionMap=function(m,g,x){var v=m;m==="ambientOcclusion"&&(v="ao");var A=g.el,_=g.material,E=A.sceneEl.systems.renderer,w=x[m+"Map"],S={};if(S.src=w,S.offset=x[m+"TextureOffset"],S.repeat=x[m+"TextureRepeat"],S.wrap=x[m+"TextureWrap"],w){if(w===g[m+"TextureSrc"])return;g[m+"TextureSrc"]=w,A.sceneEl.systems.material.loadTexture(w,S,T);return}if(!_.map)return;T(null);function T(R){var L=v+"Map";_[L]=R,R&&h.has(L)&&E.applyColorCorrection(R),R&&f(R,x),_.needsUpdate=!0,d(A,R)}};function d(m,g){!g||(m.emit("materialtextureloaded",{src:g.image,texture:g}),!(!g.image||g.image.tagName!=="VIDEO")&&(g.image.addEventListener("loadeddata",function(){!m.components||!m.components.material||(g.needsCorrectionBGRA&&g.needsCorrectionFlipY&&["standard","flat"].indexOf(m.components.material.data.shader)!==-1&&m.setAttribute("material","shader","ios10hls"),m.emit("materialvideoloadeddata",{src:g.image,texture:g}))}),g.image.addEventListener("ended",function(){m.emit("materialvideoended",{src:g.image,texture:g})})))}o.exports.handleTextureEvents=d,o.exports.isHLS=function(m,g){return!!(g&&u.includes(g.toLowerCase())||m&&m.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":184}],217:[function(i,o,l){var a=Object.freeze(Object.create(null));function u(){return{}}o.exports.createPool=function(m){var g=[],x=null;m=m||u;function v(){var w;return(x===null||x===g.length)&&_(g.length||5),w=g[x],g[x++]=a,h(w),w}function A(w){if(w instanceof Object){if(x===null||x===-1){g[g.length]=w;return}g[--x]=w}}function _(w){var S,T;if(w=w===void 0?g.length:w,w>0&&x==null&&(x=0),w>0)for(S=g.length,g.length+=Number(w),T=S;T<g.length;T++)g[T]=m();return g.length}function E(){return g.length}return{grow:_,pool:g,recycle:A,size:E,use:v}};function h(d){var m;if(!(!d||d.constructor!==Object))for(m in d)d[m]=void 0}o.exports.clearObject=h;function f(d,m){var g;if(!(!d||d.constructor!==Object))for(g in d)g in m||delete d[g]}o.exports.removeUnusedKeys=f},{}],218:[function(i,o,l){o.exports.split=function(){var a={};return function(u,h){return h in a||(a[h]={}),u in a[h]||(a[h][u]=u.split(h)),a[h][u]}}()},{}],219:[function(i,o,l){var a=i("./debug"),u=a("utils:src-loader:warn");function h(v,A,_){m(v,function(w){if(w){A(v);return}_(v)})}function f(v,A){var _,E="",w,S,T=[];for(w=0;w<5;w++)E+="(url\\((?:[^\\)]+)\\),\\s*)";E+="(url\\((?:[^\\)]+)\\)\\s*)",S=v.match(new RegExp(E));function R(L){T.push(L),T.length===6&&A(T)}if(S){for(w=1;w<7;w++)h(d(S[w]),R);return}if(_=x(v),!!_){if(_.tagName==="A-CUBEMAP"&&_.srcs)return A(_.srcs);u('Selector "%s" does not point to <a-cubemap>',v)}}function d(v){var A=v.match(/\url\((.+)\)/);if(!!A)return A[1]}function m(v,A){var _;if(v.tagName){A(v.tagName==="IMG");return}_=new XMLHttpRequest,_.open("HEAD",v),_.addEventListener("load",function(E){var w;_.status>=200&&_.status<300?(w=_.getResponseHeader("Content-Type"),w==null?g(v,A):w.startsWith("image")?A(!0):A(!1)):g(v,A),_.abort()}),_.send()}function g(v,A){var _=new Image;_.addEventListener("load",E);function E(){A(!0)}_.addEventListener("error",w);function w(){A(!1)}_.src=v}function x(v){try{var A=document.querySelector(v);return A||u('No element was found matching the selector: "%s"',v),A}catch{u('"%s" is not a valid selector',v);return}}o.exports={parseUrl:d,validateSrc:h,validateCubemapSrc:f}},{"./debug":208}],220:[function(i,o,l){var a=/-([a-z])/g;o.exports.parse=function(x,v){var A;return typeof x!="string"||(A=d(x,v),A[""])?x:h(A)},o.exports.stringify=function(x){return typeof x=="string"?x:m(x)};function u(x){return x.replace(a,g)}o.exports.toCamelCase=u;function h(x){var v,A;for(A in x)v=u(A),A!==v&&(x[v]=x[A],delete x[A]);return x}o.exports.transformKeysToCamelCase=h;var f=function(){var x=[],v=/url\([^)]+$/;return function(_){var E="",w,S=0,T=";";for(x.length=0;S<_.length;){if(w=_.indexOf(T,S),w===-1&&(w=_.length),E+=_.substring(S,w),v.test(E)){E+=";",S=w+1;continue}x.push(E.trim()),E="",S=w+1}return x}}();function d(x,v){var A,_,E,w,S,T;for(v=v||{},A=f(x),_=0;_<A.length;_++)E=A[_],E&&(w=E.indexOf(":"),S=E.substr(0,w).trim(),T=E.substr(w+1).trim(),v[S]=T);return v}function m(x){var v,A=0,_=0,E="";for(v in x)A++;for(v in x)E+=v+": "+x[v],_<A-1&&(E+="; "),_++;return E}function g(x){return x[1].toUpperCase()}},{}],221:[function(i,o,l){var a=i("../constants").DEFAULT_HANDEDNESS,u=["x","y","z","w"],h=2;o.exports.checkControllerPresentAndSetup=function(x,v,A){var _=x.el,E,w=_.sceneEl.hasWebXR,S=w?d:f,T;if(E=S(x,v,A),T=!!E,x.controllerPresent&&!x.controllerEventsActive&&!w&&x.addEventListeners(),T===x.controllerPresent)return T;x.controllerPresent=T,T?(x.addEventListeners(),x.injectTrackedControls(E),_.emit("controllerconnected",{name:x.name,component:x})):(x.removeEventListeners(),_.emit("controllerdisconnected",{name:x.name,component:x}))};function f(x,v,A){var _,E=x.el.sceneEl,w,S=A.index||0;return!v||(w=E&&E.systems["tracked-controls-webvr"],!w)||(_=w.controllers,!_.length)?!1:!!m(_,null,v,A.hand,S)}function d(x,v,A){var _,E=x.el.sceneEl,w=E&&E.systems["tracked-controls-webxr"];return!w||(_=w.controllers,!_||!_.length)?!1:g(_,v,A.hand,A.index,A.iterateControllerProfiles,A.handTracking)}o.exports.isControllerPresentWebVR=f,o.exports.isControllerPresentWebXR=d;function m(x,v,A,_,E){var w,S,T=0,R=E>=0?E:0;for(S=0;S<x.length;S++)if(w=x[S],!(A&&!w.id.startsWith(A))&&!(!A&&w.id!==v)&&!(_&&w.hand&&_!==w.hand)){if(_&&!w.hand)R=h*E+(_===a?0:1);else return w;if(T===R)return w;++T}}function g(x,v,A,_,E,w){var S,T,R,L=!1,I,N;for(S=0;S<x.length;S++){if(R=x[S],N=R.profiles,w)L=R.hand;else if(E)for(T=0;T<N.length&&(L=N[T].startsWith(v),!L);T++);else L=N.length>0&&N[0].startsWith(v);if(!!L){if(I=R.handedness==="right"||R.handedness==="left",I){if(R.handedness===A)return x[S]}else if(S===_)return x[S]}}}o.exports.findMatchingControllerWebVR=m,o.exports.findMatchingControllerWebXR=g,o.exports.emitIfAxesChanged=function(x,v,A){var _,E,w,S,T;for(E in v){for(_=v[E],w=!1,T=0;T<_.length;T++)A.detail.changed[_[T]]&&(w=!0);if(!!w){for(S={},T=0;T<_.length;T++)S[u[T]]=A.detail.axis[_[T]];x.el.emit(E+"moved",S)}}},o.exports.onButtonEvent=function(x,v,A,_){var E=_?A.mapping[_]:A.mapping,w=E.buttons[x];A.el.emit(w+v),A.updateModel&&A.updateModel(w,v)}},{"../constants":128}],222:[function(i,o,l){THREE.DeviceOrientationControls=function(a){var u=this;this.object=a,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var h=function(m){u.deviceOrientation=m},f=function(){u.screenOrientation=window.orientation||0},d=function(){var m=new THREE.Vector3(0,0,1),g=new THREE.Euler,x=new THREE.Quaternion,v=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(A,_,E,w,S){g.set(E,_,-w,"YXZ"),A.setFromEuler(g),A.multiply(v),A.multiply(x.setFromAxisAngle(m,-S))}}();this.connect=function(){f(),window.addEventListener("orientationchange",f,!1),window.addEventListener("deviceorientation",h,!1),u.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",f,!1),window.removeEventListener("deviceorientation",h,!1),u.enabled=!1},this.update=function(){if(u.enabled!==!1){var m=u.deviceOrientation;if(m){var g=m.alpha?THREE.Math.degToRad(m.alpha)+u.alphaOffset:0,x=m.beta?THREE.Math.degToRad(m.beta):0,v=m.gamma?THREE.Math.degToRad(m.gamma):0,A=u.screenOrientation?THREE.Math.degToRad(u.screenOrientation):0;d(u.object.quaternion,g,x,v,A)}}},this.dispose=function(){u.disconnect()},this.connect()}},{}],223:[function(i,o,l){window.glStats=function(){var a=null,u=0,h=0,f=0,d=0,m=0,g=0,x=0;function v(L,I){return function(){I.apply(this,arguments),L.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=v(WebGLRenderingContext.prototype.drawArrays,function(){u++,arguments[0]==this.POINTS?g+=arguments[2]:m+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=v(WebGLRenderingContext.prototype.drawElements,function(){h++,d+=arguments[1]/3,m+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=v(WebGLRenderingContext.prototype.useProgram,function(){f++}),WebGLRenderingContext.prototype.bindTexture=v(WebGLRenderingContext.prototype.bindTexture,function(){x++});var A={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},_=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],E=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function w(){a("allcalls").set(u+h),a("drawElements").set(h),a("drawArrays").set(u),a("bindTexture").set(x),a("useProgram").set(f),a("glfaces").set(d),a("glvertices").set(m),a("glpoints").set(g)}function S(){u=0,h=0,f=0,d=0,m=0,g=0,x=0}function T(){}function R(L){a=L}return{update:w,start:S,end:T,attach:R,values:A,groups:_,fractions:E}},window.threeStats=function(a){var u=null,h={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},f=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],d=[];function m(){u("renderer.info.memory.geometries").set(a.info.memory.geometries),u("renderer.info.programs").set(a.info.programs.length),u("renderer.info.memory.textures").set(a.info.memory.textures),u("renderer.info.render.calls").set(a.info.render.calls),u("renderer.info.render.triangles").set(a.info.render.triangles),u("renderer.info.render.points").set(a.info.render.points)}function g(){}function x(){}function v(A){u=A}return{update:m,start:g,end:x,attach:v,values:h,groups:f,fractions:d}},window.BrowserStats=function(){var a=null,u=0,h=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var f={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},d=[{caption:"Browser",values:["memory","total"]}],m=[{base:"total",steps:["memory"]}],g=Math.log(1024);function x(w){var S=100,T=Math.floor(Math.log(w)/g);return Math.round(w*S/Math.pow(1024,T))/S}function v(){u=x(performance.memory.usedJSHeapSize),h=x(performance.memory.totalJSHeapSize),a("memory").set(u),a("total").set(h)}function A(){u=0}function _(){}function E(w){a=w}return{update:v,start:A,end:_,attach:E,values:f,groups:d,fractions:m}},typeof o=="object"&&(o.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],224:[function(i,o,l){(function(){"performance"in window||(window.performance={});var a=window.performance;if(!("now"in a)){var u=Date.now();a.timing&&a.timing.navigationStart&&(u=a.timing.navigationStart),a.now=function(){return Date.now()-u}}a.mark||(a.mark=function(){}),a.measure||(a.measure=function(){})})(),window.rStats=function(u){function h(H,q){for(var le=Object.keys(H),ne=0,D=le.length;ne<D;ne++)q(le[ne])}function f(H){var q=document.createElement("link");q.href=H,q.rel="stylesheet",q.type="text/css",document.getElementsByTagName("head")[0].appendChild(q)}var d=u||{},m=d.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],g="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",x=(d.CSSPath?d.CSSPath:"")+"rStats.css",v=d.css||[g,x];v.forEach(function(H){f(H)}),d.values||(d.values={});var A,_,E=10,w=200,S={};function T(H,q,le){var ne=le||{},D=document.createElement("canvas"),O=D.getContext("2d"),k=0,z=0,X=ne.color?ne.color:"#666666",Z=document.createElement("canvas"),ie=Z.getContext("2d");Z.width=1,Z.height=2*E,ie.fillStyle="#444444",ie.fillRect(0,0,1,2*E),ie.fillStyle=X,ie.fillRect(0,E,1,E),ie.fillStyle="#ffffff",ie.globalAlpha=.5,ie.fillRect(0,E,1,1),ie.globalAlpha=1;var se=document.createElement("canvas"),ue=se.getContext("2d");se.width=1,se.height=2*E,ue.fillStyle="#444444",ue.fillRect(0,0,1,2*E),ue.fillStyle="#b70000",ue.fillRect(0,E,1,E),ue.globalAlpha=.5,ue.fillStyle="#ffffff",ue.fillRect(0,E,1,1),ue.globalAlpha=1;function ye(){D.width=w,D.height=E,D.style.width=D.width+"px",D.style.height=D.height+"px",D.className="rs-canvas",H.appendChild(D),O.fillStyle="#444444",O.fillRect(0,0,D.width,D.height)}function Ce(ke,Oe){z+=(ke-z)*.1,k*=.99,z>k&&(k=z),O.drawImage(D,1,0,D.width-1,D.height,0,0,D.width-1,D.height),Oe?O.drawImage(se,D.width-1,D.height-z*D.height/k-E):O.drawImage(Z,D.width-1,D.height-z*D.height/k-E)}return ye(),{draw:Ce}}function R(H,q){var le=document.createElement("canvas"),ne=le.getContext("2d");function D(){le.width=w,le.height=E*q,le.style.width=le.width+"px",le.style.height=le.height+"px",le.className="rs-canvas",H.appendChild(le),ne.fillStyle="#444444",ne.fillRect(0,0,le.width,le.height)}function O(k){ne.drawImage(le,1,0,le.width-1,le.height,0,0,le.width-1,le.height);var z=0;h(k,function(X){var Z=k[X]*le.height;ne.fillStyle=m[X],ne.fillRect(le.width-1,z,1,Z),z+=Z})}return D(),{draw:O}}function L(H,q){var le=H,ne,D=0,O=0,k=0,z=0,X=performance.now(),Z=0,ie=document.createElement("div"),se=document.createElement("span"),ue=document.createElement("div"),ye=document.createTextNode(""),Ce=d?d.values[le.toLowerCase()]:null,ke=new T(ie,le,Ce),Oe=!1;se.className="rs-counter-id",se.textContent=Ce&&Ce.caption?Ce.caption:le,ue.className="rs-counter-value",ue.appendChild(ye),ie.appendChild(se),ie.appendChild(ue),q?q.div.appendChild(ie):_.appendChild(ie),ne=performance.now();function Ne(Se){if(Ce&&Ce.average){z+=Se,Z++;var qe=performance.now();qe-X>=(Ce.avgMs||1e3)&&(k=z/Z,z=0,X=qe,Z=0)}}function He(){ne=performance.now(),d.userTimingAPI&&performance.mark(le+"-start"),Oe=!0}function Qe(){D=performance.now()-ne,d.userTimingAPI&&(performance.mark(le+"-end"),Oe&&performance.measure(le,le+"-start",le+"-end")),Ne(D)}function St(){Qe(),He()}function bt(){var Se=Ce&&Ce.average?k:D;ye.nodeValue=Math.round(Se*100)/100;var qe=Ce&&(Ce.below&&D<Ce.below||Ce.over&&D>Ce.over);ke.draw(D,qe),ie.className=qe?"rs-counter-base alarm":"rs-counter-base"}function Jt(){var Se=performance.now(),qe=Se-ne;O++,qe>1e3&&(Ce&&Ce.interpolate===!1?D=O:D=O*1e3/qe,O=0,ne=Se,Ne(D))}function sn(Se){D=Se,Ne(D)}return{set:sn,start:He,tick:St,end:Qe,frame:Jt,value:function(){return D},draw:bt}}function I(H){var q=H.toLowerCase();if(q===void 0&&(q="default"),S[q])return S[q];var le=null;d&&d.groups&&h(d.groups,function(D){var O=d.groups[parseInt(D,10)];!le&&O.values.indexOf(q.toLowerCase())!==-1&&(le=O)});var ne=new L(q,le);return S[q]=ne,ne}function N(){if(d.plugins){d.values||(d.values={}),d.groups||(d.groups=[]),d.fractions||(d.fractions=[]);for(var H=0;H<d.plugins.length;H++)d.plugins[H].attach(I),h(d.plugins[H].values,function(q){d.values[q]=d.plugins[H].values[q]}),d.groups=d.groups.concat(d.plugins[H].groups),d.fractions=d.fractions.concat(d.plugins[H].fractions)}else d.plugins={};A=document.createElement("div"),A.className="rs-base",_=document.createElement("div"),_.className="rs-container",_.style.height="auto",A.appendChild(_),document.body.appendChild(A),d&&(d.groups&&h(d.groups,function(q){var le=d.groups[parseInt(q,10)],ne=document.createElement("div");ne.className="rs-group",le.div=ne;var D=document.createElement("h1");D.textContent=le.caption,D.addEventListener("click",function(O){this.classList.toggle("hidden"),O.preventDefault()}.bind(ne)),_.appendChild(D),_.appendChild(ne)}),d.fractions&&h(d.fractions,function(q){var le=d.fractions[parseInt(q,10)],ne=document.createElement("div");ne.className="rs-fraction";var D=document.createElement("div");D.className="rs-legend";var O=0;h(d.fractions[q].steps,function(z){var X=document.createElement("p");X.textContent=d.fractions[q].steps[z],X.style.color=m[O],D.appendChild(X),O++}),ne.appendChild(D),ne.style.height=O*E+"px",le.div=ne;var k=new R(ne,O);le.graph=k,_.appendChild(ne)}))}function B(){h(d.plugins,function(H){d.plugins[H].update()}),h(S,function(H){S[H].draw()}),d&&d.fractions&&h(d.fractions,function(H){var q=d.fractions[parseInt(H,10)],le=[],ne=S[q.base.toLowerCase()];ne&&(ne=ne.value(),h(d.fractions[H].steps,function(D){var O=d.fractions[H].steps[parseInt(D,10)].toLowerCase(),k=S[O];k&&le.push(k.value()/ne)})),q.graph.draw(le)})}return N(),function(H){return H?I(H):{element:A,update:B}}},typeof o=="object"&&(o.exports=window.rStats)},{}],225:[function(i,o,l){String.prototype.startsWith||(String.prototype.startsWith=function(a,u){return u=u||0,this.substr(u,a.length)===a})},{}],226:[function(i,o,l){var a={};a.base64=function(u,h){return"data:"+u+";base64,"+h},a.isMobile=function(){var u=!1;return function(h){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(h)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(h.substr(0,4)))&&(u=!0)}(navigator.userAgent||navigator.vendor||window.opera),u},a.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},a.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},a.appendQueryParameter=function(u,h,f){var d=u.indexOf("?")<0?"?":"&";return u+=d+h+"="+f,u},a.getQueryParameter=function(u){u=u.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var h=new RegExp("[\\?&]"+u+"=([^&#]*)"),f=h.exec(location.search);return f===null?"":decodeURIComponent(f[1].replace(/\+/g," "))},a.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},o.exports=a},{}],227:[function(i,o,l){var a=i("./util.js");function u(){var d=document.createElement("video");d.addEventListener("ended",function(){d.play()}),this.request=function(){d.paused&&(d.src=a.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),d.play())},this.release=function(){d.pause(),d.src=""}}function h(){var d=null;this.request=function(){d||(d=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){d&&(clearInterval(d),d=null)}}function f(){var d=navigator.userAgent||navigator.vendor||window.opera;return d.match(/iPhone/i)||d.match(/iPod/i)?h:u}o.exports=f()},{"./util.js":226}]},{},[182])(182)})})(_H);const bC=.1;AFRAME.registerComponent("checkpoint-controls",{schema:{enabled:{default:!0},mode:{default:"teleport",oneOf:["teleport","animate"]},animateSpeed:{default:3}},init:function(){this.active=!0,this.checkpoint=null,this.isNavMeshConstrained=!1,this.offset=new THREE.Vector3,this.position=new THREE.Vector3,this.targetPosition=new THREE.Vector3},play:function(){this.active=!0},pause:function(){this.active=!1},setCheckpoint:function(r){const n=this.el;if(!!this.active&&this.checkpoint!==r){if(this.checkpoint&&n.emit("navigation-end",{checkpoint:this.checkpoint}),this.checkpoint=r,this.sync(),this.position.distanceTo(this.targetPosition)<bC){this.checkpoint=null;return}n.emit("navigation-start",{checkpoint:r}),this.data.mode==="teleport"&&(this.el.setAttribute("position",this.targetPosition),this.checkpoint=null,n.emit("navigation-end",{checkpoint:r}),n.components["movement-controls"].updateNavLocation())}},isVelocityActive:function(){return!!(this.active&&this.checkpoint)},getVelocity:function(){if(!this.active)return;const r=this.data,n=this.offset,i=this.position,o=this.targetPosition,l=this.checkpoint;return this.sync(),i.distanceTo(o)<bC?(this.checkpoint=null,this.el.emit("navigation-end",{checkpoint:l}),n.set(0,0,0)):(n.setLength(r.animateSpeed),n)},sync:function(){const r=this.offset,n=this.position,i=this.targetPosition;n.copy(this.el.getAttribute("position")),this.checkpoint.object3D.getWorldPosition(i),i.add(this.checkpoint.components.checkpoint.getOffset()),r.copy(i).sub(n)}});var bH=Object.assign(function(){},{FACE_1:0,FACE_2:1,FACE_3:2,FACE_4:3,L_SHOULDER_1:4,R_SHOULDER_1:5,L_SHOULDER_2:6,R_SHOULDER_2:7,SELECT:8,START:9,DPAD_UP:12,DPAD_DOWN:13,DPAD_LEFT:14,DPAD_RIGHT:15,VENDOR:16});function EH(r,n,i){this.type=r,this.index=n,this.pressed=i.pressed,this.value=i.value}var AH=EH;const Hh=bH,fb=AH,Yl=.2,Ya={LEFT:"left",RIGHT:"right"},Ka={MOVEMENT:1,ROTATION:2};AFRAME.registerComponent("gamepad-controls",{GamepadButton:Hh,schema:{enabled:{default:!0},camera:{default:"[camera]",type:"selector"},rotationSensitivity:{default:2}},init:function(){const r=this.el.sceneEl;this.system=r.systems["tracked-controls-webxr"]||{controllers:[]},this.prevTime=window.performance.now(),this.buttons={};const n=this.el.object3D.rotation;this.pitch=new THREE.Object3D,this.pitch.rotation.x=THREE.Math.degToRad(n.x),this.yaw=new THREE.Object3D,this.yaw.position.y=10,this.yaw.rotation.y=THREE.Math.degToRad(n.y),this.yaw.add(this.pitch),this._lookVector=new THREE.Vector2,this._moveVector=new THREE.Vector2,this._dpadVector=new THREE.Vector2,r.addBehavior(this)},update:function(){this.tick()},tick:function(r,n){this.updateButtonState(),this.updateRotation(n)},remove:function(){},isVelocityActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const r=this._dpadVector,n=this._moveVector;this.getDpad(r),this.getJoystick(Ka.MOVEMENT,n);const i=r.x||n.x,o=r.y||n.y;return Math.abs(i)>Yl||Math.abs(o)>Yl},getVelocityDelta:function(){const r=this._dpadVector,n=this._moveVector;this.getDpad(r),this.getJoystick(Ka.MOVEMENT,n);const i=r.x||n.x,o=r.y||n.y,l=new THREE.Vector3;return Math.abs(i)>Yl&&(l.x+=i),Math.abs(o)>Yl&&(l.z+=o),l},isRotationActive:function(){if(!this.data.enabled||!this.isConnected())return!1;const r=this._lookVector;return this.getJoystick(Ka.ROTATION,r),Math.abs(r.x)>Yl||Math.abs(r.y)>Yl},updateRotation:function(r){if(!this.isRotationActive())return;const n=this.data,i=this.yaw,o=this.pitch,l=n.camera.components["look-controls"],a=l&&l.pitchObject&&l.yawObject;a&&(o.rotation.copy(l.pitchObject.rotation),i.rotation.copy(l.yawObject.rotation));const u=this._lookVector;this.getJoystick(Ka.ROTATION,u),Math.abs(u.x)<=Yl&&(u.x=0),Math.abs(u.y)<=Yl&&(u.y=0),u.multiplyScalar(n.rotationSensitivity*r/1e3),i.rotation.y-=u.x,o.rotation.x-=u.y,o.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,o.rotation.x)),n.camera.object3D.rotation.set(o.rotation.x,i.rotation.y,0),a&&(l.pitchObject.rotation.copy(o.rotation),l.yawObject.rotation.copy(i.rotation))},updateButtonState:function(){const r=this.getGamepad(Ya.RIGHT);if(this.data.enabled&&r)for(var n=0;n<r.buttons.length;n++)r.buttons[n].pressed&&!this.buttons[n]?this.emit(new fb("gamepadbuttondown",n,r.buttons[n])):!r.buttons[n].pressed&&this.buttons[n]&&this.emit(new fb("gamepadbuttonup",n,r.buttons[n])),this.buttons[n]=r.buttons[n].pressed;else Object.keys(this.buttons)&&(this.buttons={})},emit:function(r){this.el.emit(r.type,r),this.el.emit(r.type+":"+r.index,new fb(r.type,r.index,r))},getGamepad:function(){const r=[],n=[];return function(i){const o=this.el.sceneEl.components["proxy-controls"],l=o&&o.isConnected()&&o.getGamepad(0);if(l)return l;r.length=0;for(let u=0;u<this.system.controllers.length;u++){const h=this.system.controllers[u],f=h?h.gamepad:null;if(r.push(f),f&&f.handedness===i)return f}const a=navigator.getGamepads?navigator.getGamepads():n;for(let u=0;u<a.length;u++){const h=a[u];if(h&&h.hand===i)return h}return r[0]||a[0]}}(),getButton:function(r){return this.getGamepad(Ya.RIGHT).buttons[r]},getAxis:function(r){return this.getGamepad(r>1?Ya.RIGHT:Ya.LEFT).axes[r]},getJoystick:function(r,n){const i=this.getGamepad(r===Ka.MOVEMENT?Ya.LEFT:Ya.RIGHT);if(i.mapping==="xr-standard")switch(r){case Ka.MOVEMENT:return n.set(i.axes[2],i.axes[3]);case Ka.ROTATION:return n.set(i.axes[0],i.axes[1])}else switch(r){case Ka.MOVEMENT:return n.set(i.axes[0],i.axes[1]);case Ka.ROTATION:return n.set(i.axes[2],i.axes[3])}throw new Error('Unexpected joystick index "%d".',r)},getDpad:function(r){const n=this.getGamepad(Ya.LEFT);return n.buttons[Hh.DPAD_RIGHT]?r.set((n.buttons[Hh.DPAD_RIGHT].pressed?1:0)+(n.buttons[Hh.DPAD_LEFT].pressed?-1:0),(n.buttons[Hh.DPAD_UP].pressed?-1:0)+(n.buttons[Hh.DPAD_DOWN].pressed?1:0)):r.set(0,0)},isConnected:function(){const r=this.getGamepad(Ya.LEFT);return!!(r&&r.connected)},getID:function(){return this.getGamepad(Ya.LEFT).id}});(function(r){var n="KeyboardEvent"in r;n||(r.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),"DOM_KEY_LOCATION_STANDARD"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_STANDARD=0),"DOM_KEY_LOCATION_LEFT"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_LEFT=1),"DOM_KEY_LOCATION_RIGHT"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_RIGHT=2),"DOM_KEY_LOCATION_NUMPAD"in r.KeyboardEvent||(r.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD=3);var i=window.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,o=window.KeyboardEvent.DOM_KEY_LOCATION_LEFT,l=window.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,a=window.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function u(L,I){return String(L).indexOf(I)!==-1}var h=function(){return u(navigator.platform,"Win")?"win":u(navigator.platform,"Mac")?"mac":u(navigator.platform,"CrOS")?"cros":u(navigator.platform,"Linux")?"linux":u(navigator.userAgent,"iPad")||u(navigator.platform,"iPod")||u(navigator.platform,"iPhone")?"ios":""}(),f=function(){return u(navigator.userAgent,"Chrome/")?"chrome":u(navigator.vendor,"Apple")?"safari":u(navigator.userAgent,"MSIE")?"ie":u(navigator.userAgent,"Gecko/")?"moz":u(navigator.userAgent,"Opera/")?"opera":""}(),d=f+"-"+h;function m(L,I,N){(d===I||f===I||h===I)&&Object.keys(N).forEach(function(B){L[B]=N[B]})}function g(L,I){var N={};return Object.keys(L).forEach(function(B){var H=L[B];I in H&&(N[H[I]]=H)}),N}var x={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"HangulMode"},23:{code:"JunjaMode"},24:{code:"FinalMode"},25:{code:"KanjiMode"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"OSLeft",location:o},92:{code:"OSRight",location:l},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:a},97:{code:"Numpad1",keyCap:"1",location:a},98:{code:"Numpad2",keyCap:"2",location:a},99:{code:"Numpad3",keyCap:"3",location:a},100:{code:"Numpad4",keyCap:"4",location:a},101:{code:"Numpad5",keyCap:"5",location:a},102:{code:"Numpad6",keyCap:"6",location:a},103:{code:"Numpad7",keyCap:"7",location:a},104:{code:"Numpad8",keyCap:"8",location:a},105:{code:"Numpad9",keyCap:"9",location:a},106:{code:"NumpadMultiply",keyCap:"*",location:a},107:{code:"NumpadAdd",keyCap:"+",location:a},108:{code:"NumpadComma",keyCap:",",location:a},109:{code:"NumpadSubtract",keyCap:"-",location:a},110:{code:"NumpadDecimal",keyCap:".",location:a},111:{code:"NumpadDivide",keyCap:"/",location:a},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:a},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:o},161:{code:"ShiftRight",location:l},162:{code:"ControlLeft",location:o},163:{code:"ControlRight",location:l},164:{code:"AltLeft",location:o},165:{code:"AltRight",location:l},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"VolumeMute"},174:{code:"VolumeDown"},175:{code:"VolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};m(x,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:a},189:{code:"NumpadSubtract",keyCap:"-",location:a}}),m(x,"moz-mac",{12:{code:"NumLock",location:a},173:{code:"Minus",keyCap:"-"}}),m(x,"moz-win",{173:{code:"Minus",keyCap:"-"}}),m(x,"chrome-mac",{93:{code:"OSRight",location:l}}),m(x,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),m(x,"ios",{10:{code:"Enter",location:i}}),m(x,"safari-mac",{91:{code:"OSLeft",location:o},93:{code:"OSRight",location:l},229:{code:"KeyQ",keyCap:"Q"}});var v={};h==="cros"&&(v["U+00A0"]={code:"ShiftLeft",location:o},v["U+00A1"]={code:"ShiftRight",location:l},v["U+00A2"]={code:"ControlLeft",location:o},v["U+00A3"]={code:"ControlRight",location:l},v["U+00A4"]={code:"AltLeft",location:o},v["U+00A5"]={code:"AltRight",location:l}),d==="chrome-mac"&&(v["U+0010"]={code:"ContextMenu"}),d==="safari-mac"&&(v["U+0010"]={code:"ContextMenu"}),h==="ios"&&(v["U+0010"]={code:"Function"},v["U+001C"]={code:"ArrowLeft"},v["U+001D"]={code:"ArrowRight"},v["U+001E"]={code:"ArrowUp"},v["U+001F"]={code:"ArrowDown"},v["U+0001"]={code:"Home"},v["U+0004"]={code:"End"},v["U+000B"]={code:"PageUp"},v["U+000C"]={code:"PageDown"});var A=[];A[o]={16:{code:"ShiftLeft",location:o},17:{code:"ControlLeft",location:o},18:{code:"AltLeft",location:o}},A[l]={16:{code:"ShiftRight",location:l},17:{code:"ControlRight",location:l},18:{code:"AltRight",location:l}},A[a]={13:{code:"NumpadEnter",location:a}},m(A[a],"moz",{109:{code:"NumpadSubtract",location:a},107:{code:"NumpadAdd",location:a}}),m(A[o],"moz-mac",{224:{code:"OSLeft",location:o}}),m(A[l],"moz-mac",{224:{code:"OSRight",location:l}}),m(A[l],"moz-win",{91:{code:"OSRight",location:l}}),m(A[l],"mac",{93:{code:"OSRight",location:l}}),m(A[a],"chrome-mac",{12:{code:"NumLock",location:a}}),m(A[a],"safari-mac",{12:{code:"NumLock",location:a},187:{code:"NumpadAdd",location:a},189:{code:"NumpadSubtract",location:a},190:{code:"NumpadDecimal",location:a},191:{code:"NumpadDivide",location:a}});var _={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},OSLeft:{key:"OS"},OSRight:{key:"OS"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};m(_,"mac",{OSLeft:{key:"Meta"},OSRight:{key:"Meta"}});var E={Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},w=g(x,"code");try{var S=n&&"location"in new KeyboardEvent("")}catch{}function T(L){var I="keyCode"in L?L.keyCode:"which"in L?L.which:0,N=function(){if(S||"keyLocation"in L){var H=S?L.location:L.keyLocation;if(H&&I in A[H])return A[H][I]}return"keyIdentifier"in L&&L.keyIdentifier in v?v[L.keyIdentifier]:I in x?x[I]:null}();if(!N)return null;var B=function(){var H=_[N.code];return H?L.shiftKey&&"shiftKey"in H?H.shiftKey:H.key:N.code}();return{code:N.code,key:B,location:N.location,keyCap:N.keyCap}}function R(L,I){if(L=String(L),!w.hasOwnProperty(L))return"Undefined";if(I&&String(I).toLowerCase()!=="en-us")throw Error("Unsupported locale");var N=w[L];return N.keyCap||N.code||"Undefined"}"KeyboardEvent"in r&&"defineProperty"in Object&&function(){function L(N,B,H){B in N||Object.defineProperty(N,B,H)}if(L(KeyboardEvent.prototype,"code",{get:function(){var N=T(this);return N?N.code:""}}),"key"in KeyboardEvent.prototype){var I=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var N=I.get.call(this);return E.hasOwnProperty(N)?E[N]:N}})}L(KeyboardEvent.prototype,"key",{get:function(){var N=T(this);return N&&"key"in N?N.key:"Unidentified"}}),L(KeyboardEvent.prototype,"location",{get:function(){var N=T(this);return N&&"location"in N?N.location:i}}),L(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in r.KeyboardEvent||(r.KeyboardEvent.queryKeyCap=R),r.identifyKey=function(L){if(!("code"in L)){var I=T(L);L.code=I?I.code:"",L.key=I&&"key"in I?I.key:"Unidentified",L.location="location"in L?L.location:"keyLocation"in L?L.keyLocation:I&&"location"in I?I.location:i,L.locale=""}}})(window);const wH="__keyboard-controls-proxy",MH=window.KeyboardEvent;AFRAME.registerComponent("keyboard-controls",{schema:{enabled:{default:!0},debug:{default:!1}},init:function(){this.dVelocity=new THREE.Vector3,this.localKeys={},this.listeners={keydown:this.onKeyDown.bind(this),keyup:this.onKeyUp.bind(this),blur:this.onBlur.bind(this)},this.attachEventListeners()},isVelocityActive:function(){return this.data.enabled&&!!Object.keys(this.getKeys()).length},getVelocityDelta:function(){const r=this.data,n=this.getKeys();return this.dVelocity.set(0,0,0),r.enabled&&((n.KeyW||n.ArrowUp)&&(this.dVelocity.z-=1),(n.KeyA||n.ArrowLeft)&&(this.dVelocity.x-=1),(n.KeyS||n.ArrowDown)&&(this.dVelocity.z+=1),(n.KeyD||n.ArrowRight)&&(this.dVelocity.x+=1)),this.dVelocity.clone()},play:function(){this.attachEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.pause()},attachEventListeners:function(){window.addEventListener("keydown",this.listeners.keydown,!1),window.addEventListener("keyup",this.listeners.keyup,!1),window.addEventListener("blur",this.listeners.blur,!1)},removeEventListeners:function(){window.removeEventListener("keydown",this.listeners.keydown),window.removeEventListener("keyup",this.listeners.keyup),window.removeEventListener("blur",this.listeners.blur)},onKeyDown:function(r){AFRAME.utils.shouldCaptureKeyEvent(r)&&(this.localKeys[r.code]=!0,this.emit(r))},onKeyUp:function(r){AFRAME.utils.shouldCaptureKeyEvent(r)&&(delete this.localKeys[r.code],this.emit(r))},onBlur:function(){for(let r in this.localKeys)this.localKeys.hasOwnProperty(r)&&delete this.localKeys[r]},emit:function(r){wH in r&&this.el.emit(r.type,r),this.el.emit(r.type+":"+r.code,new MH(r.type,r)),this.data.debug&&console.log(r.type+":"+r.code)},isPressed:function(r){return r in this.getKeys()},getKeys:function(){return this.isProxied()?this.el.sceneEl.components["proxy-controls"].getKeyboard():this.localKeys},isProxied:function(){const r=this.el.sceneEl.components["proxy-controls"];return r&&r.isConnected()}});AFRAME.registerComponent("touch-controls",{schema:{enabled:{default:!0},reverseEnabled:{default:!0}},init:function(){this.dVelocity=new THREE.Vector3,this.bindMethods(),this.direction=0},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const r=this.el.sceneEl,n=r.canvas;if(!n){r.addEventListener("render-target-loaded",this.addEventListeners.bind(this));return}n.addEventListener("touchstart",this.onTouchStart),n.addEventListener("touchend",this.onTouchEnd)},removeEventListeners:function(){const r=this.el.sceneEl&&this.el.sceneEl.canvas;!r||(r.removeEventListener("touchstart",this.onTouchStart),r.removeEventListener("touchend",this.onTouchEnd))},isVelocityActive:function(){return this.data.enabled&&!!this.direction},getVelocityDelta:function(){return this.dVelocity.z=this.direction,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this)},onTouchStart:function(r){this.direction=-1,this.data.reverseEnabled&&r.touches.length===2&&(this.direction=1),r.preventDefault()},onTouchEnd:function(r){this.direction=0,r.preventDefault()}});const EC="-controls",SH=.2,TH=1e-5;AFRAME.registerComponent("movement-controls",{dependencies:["rotation"],schema:{enabled:{default:!0},controls:{default:["gamepad","trackpad","keyboard","touch"]},speed:{default:.3,min:0},fly:{default:!1},constrainToNavMesh:{default:!1},camera:{default:"[movement-controls] [camera]",type:"selector"}},init:function(){const r=this.el;this.velocityCtrl=null,this.velocity=new THREE.Vector3,this.heading=new THREE.Quaternion,this.navGroup=null,this.navNode=null,r.sceneEl.hasLoaded?this.injectControls():r.sceneEl.addEventListener("loaded",this.injectControls.bind(this))},update:function(r){const n=this.el,i=this.data,o=n.sceneEl.systems.nav;n.sceneEl.hasLoaded&&this.injectControls(),o&&i.constrainToNavMesh!==r.constrainToNavMesh&&(i.constrainToNavMesh?o.addAgent(this):o.removeAgent(this))},injectControls:function(){const r=this.data;var n;for(let i=0;i<r.controls.length;i++)n=r.controls[i]+EC,this.el.components[n]||this.el.setAttribute(n,"")},updateNavLocation:function(){this.navGroup=null,this.navNode=null},tick:function(){const r=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3;return function(o,l){if(!l)return;const a=this.el,u=this.data;if(!u.enabled)return;this.updateVelocityCtrl();const h=this.velocityCtrl,f=this.velocity;if(!!h)if(l/1e3>SH?f.set(0,0,0):this.updateVelocity(l),u.constrainToNavMesh&&h.isNavMeshConstrained!==!1){if(f.lengthSq()<TH)return;r.copy(a.object3D.position),n.copy(f).multiplyScalar(l/1e3).add(r);const d=a.sceneEl.systems.nav;this.navGroup=this.navGroup===null?d.getGroup(r):this.navGroup,this.navNode=this.navNode||d.getNode(r,this.navGroup),this.navNode=d.clampStep(r,n,this.navGroup,this.navNode,i),a.object3D.position.copy(i)}else a.hasAttribute("velocity")?a.setAttribute("velocity",f):(a.object3D.position.x+=f.x*l/1e3,a.object3D.position.y+=f.y*l/1e3,a.object3D.position.z+=f.z*l/1e3)}}(),updateVelocityCtrl:function(){const r=this.data;if(r.enabled){for(let n=0,i=r.controls.length;n<i;n++){const o=this.el.components[r.controls[n]+EC];if(o&&o.isVelocityActive()){this.velocityCtrl=o;return}}this.velocityCtrl=null}},updateVelocity:function(){const r=new THREE.Vector2,n=new THREE.Quaternion;return function(i){let o;const l=this.el,a=this.velocityCtrl,u=this.velocity,h=this.data;if(a)if(a.getVelocityDelta)o=a.getVelocityDelta(i);else if(a.getVelocity){u.copy(a.getVelocity());return}else if(a.getPositionDelta){u.copy(a.getPositionDelta(i).multiplyScalar(1e3/i));return}else throw new Error("Incompatible movement controls: ",a);if(l.hasAttribute("velocity")&&!h.constrainToNavMesh&&u.copy(this.el.getAttribute("velocity")),o&&h.enabled){const f=h.camera;n.copy(f.object3D.quaternion),n.premultiply(l.object3D.quaternion),o.applyQuaternion(n);const d=o.length();h.fly?(u.copy(o),u.multiplyScalar(this.data.speed*16.66667)):(r.set(o.x,o.z),r.setLength(d*this.data.speed*16.66667),u.x=r.x,u.z=r.y)}}}()});AFRAME.registerComponent("trackpad-controls",{schema:{enabled:{default:!0},enableNegX:{default:!0},enablePosX:{default:!0},enableNegZ:{default:!0},enablePosZ:{default:!0},mode:{default:"touch",oneOf:["swipe","touch","press"]}},init:function(){this.dVelocity=new THREE.Vector3,this.zVel=0,this.xVel=0,this.bindMethods()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.dVelocity.set(0,0,0)},remove:function(){this.pause()},addEventListeners:function(){const r=this.data,n=this.el.sceneEl;switch(n.addEventListener("axismove",this.onAxisMove),r.mode){case"swipe":case"touch":n.addEventListener("trackpadtouchstart",this.onTouchStart),n.addEventListener("trackpadtouchend",this.onTouchEnd);break;case"press":n.addEventListener("trackpaddown",this.onTouchStart),n.addEventListener("trackpadup",this.onTouchEnd);break}},removeEventListeners:function(){const r=this.el.sceneEl;r.removeEventListener("axismove",this.onAxisMove),r.removeEventListener("trackpadtouchstart",this.onTouchStart),r.removeEventListener("trackpadtouchend",this.onTouchEnd),r.removeEventListener("trackpaddown",this.onTouchStart),r.removeEventListener("trackpadup",this.onTouchEnd)},isVelocityActive:function(){return this.data.enabled&&this.isMoving},getVelocityDelta:function(){return this.dVelocity.z=this.isMoving?-this.zVel:1,this.dVelocity.x=this.isMoving?this.xVel:1,this.dVelocity.clone()},bindMethods:function(){this.onTouchStart=this.onTouchStart.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onAxisMove=this.onAxisMove.bind(this)},onTouchStart:function(r){switch(this.data.mode){case"swipe":this.canRecordAxis=!0,this.startingAxisData=[];break;case"touch":this.isMoving=!0;break;case"press":this.isMoving=!0;break}r.preventDefault()},onTouchEnd:function(r){this.data.mode=="swipe"&&(this.startingAxisData=[]),this.isMoving=!1,r.preventDefault()},onAxisMove:function(r){switch(this.data.mode){case"swipe":return this.handleSwipeAxis(r);case"touch":case"press":return this.handleTouchAxis(r)}},handleSwipeAxis:function(r){const n=this.data,i=r.detail.axis;if(this.startingAxisData.length===0&&this.canRecordAxis&&(this.canRecordAxis=!1,this.startingAxisData[0]=i[0],this.startingAxisData[1]=i[1]),this.startingAxisData.length>0){let o=0,l=0;n.enableNegX&&i[0]<this.startingAxisData[0]&&(o=-1),n.enablePosX&&i[0]>this.startingAxisData[0]&&(o=1),n.enablePosZ&&i[1]>this.startingAxisData[1]&&(l=-1),n.enableNegZ&&i[1]<this.startingAxisData[1]&&(l=1);const a=Math.abs(this.startingAxisData[1]-i[1]);Math.abs(this.startingAxisData[0]-i[0])>a?(this.zVel=0,this.xVel=o,this.isMoving=!0):(this.xVel=0,this.zVel=l,this.isMoving=!0)}},handleTouchAxis:function(r){const n=this.data,i=r.detail.axis;let o=0,l=0;n.enableNegX&&i[0]<0&&(o=-1),n.enablePosX&&i[0]>0&&(o=1),n.enablePosZ&&i[1]>0&&(l=-1),n.enableNegZ&&i[1]<0&&(l=1),Math.abs(i[0])>Math.abs(i[1])?(this.zVel=0,this.xVel=o):(this.xVel=0,this.zVel=l)}});const pb={once:THREE.LoopOnce,repeat:THREE.LoopRepeat,pingpong:THREE.LoopPingPong};AFRAME.registerComponent("animation-mixer",{schema:{clip:{default:"*"},duration:{default:0},clampWhenFinished:{default:!1,type:"boolean"},crossFadeDuration:{default:0},loop:{default:"repeat",oneOf:Object.keys(pb)},repetitions:{default:1/0,min:0},timeScale:{default:1}},init:function(){this.model=null,this.mixer=null,this.activeActions=[];const r=this.el.getObject3D("mesh");r?this.load(r):this.el.addEventListener("model-loaded",n=>{this.load(n.detail.model)})},load:function(r){const n=this.el;this.model=r,this.mixer=new THREE.AnimationMixer(r),this.mixer.addEventListener("loop",i=>{n.emit("animation-loop",{action:i.action,loopDelta:i.loopDelta})}),this.mixer.addEventListener("finished",i=>{n.emit("animation-finished",{action:i.action,direction:i.direction})}),this.data.clip&&this.update({})},remove:function(){this.mixer&&this.mixer.stopAllAction()},update:function(r){if(!r)return;const n=this.data,i=AFRAME.utils.diff(n,r);if("clip"in i){this.stopAction(),n.clip&&this.playAction();return}this.activeActions.forEach(o=>{"duration"in i&&n.duration&&o.setDuration(n.duration),"clampWhenFinished"in i&&(o.clampWhenFinished=n.clampWhenFinished),("loop"in i||"repetitions"in i)&&o.setLoop(pb[n.loop],n.repetitions),"timeScale"in i&&o.setEffectiveTimeScale(n.timeScale)})},stopAction:function(){const r=this.data;for(let n=0;n<this.activeActions.length;n++)r.crossFadeDuration?this.activeActions[n].fadeOut(r.crossFadeDuration):this.activeActions[n].stop();this.activeActions.length=0},playAction:function(){if(!this.mixer)return;const r=this.model,n=this.data,i=r.animations||(r.geometry||{}).animations||[];if(!i.length)return;const o=CH(n.clip);for(let l,a=0;l=i[a];a++)if(l.name.match(o)){const u=this.mixer.clipAction(l,r);u.enabled=!0,u.clampWhenFinished=n.clampWhenFinished,n.duration&&u.setDuration(n.duration),n.timeScale!==1&&u.setEffectiveTimeScale(n.timeScale),u.setLoop(pb[n.loop],n.repetitions).fadeIn(n.crossFadeDuration).play(),this.activeActions.push(u)}},tick:function(r,n){this.mixer&&!isNaN(n)&&this.mixer.update(n/1e3)}});function CH(r){return new RegExp("^"+r.split(/\*+/).map(RH).join(".*")+"$")}function RH(r){return r.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}var LH=THREE.ColladaLoader=function(r){this.manager=r!==void 0?r:THREE.DefaultLoadingManager};THREE.ColladaLoader.prototype={constructor:THREE.ColladaLoader,crossOrigin:"anonymous",load:function(r,n,i,o){var l=this,a=l.path===void 0?THREE.LoaderUtils.extractUrlBase(r):l.path,u=new THREE.FileLoader(l.manager);u.setPath(l.path),u.load(r,function(h){n(l.parse(h,a))},i,o)},setPath:function(r){return this.path=r,this},setResourcePath:function(r){return this.resourcePath=r,this},options:{set convertUpAxis(r){console.warn("THREE.ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},setCrossOrigin:function(r){return this.crossOrigin=r,this},parse:function(r,n){function i(oe,he){for(var be=[],Te=oe.childNodes,Ae=0,rt=Te.length;Ae<rt;Ae++){var Mt=Te[Ae];Mt.nodeName===he&&be.push(Mt)}return be}function o(oe){if(oe.length===0)return[];for(var he=oe.trim().split(/\s+/),be=new Array(he.length),Te=0,Ae=he.length;Te<Ae;Te++)be[Te]=he[Te];return be}function l(oe){if(oe.length===0)return[];for(var he=oe.trim().split(/\s+/),be=new Array(he.length),Te=0,Ae=he.length;Te<Ae;Te++)be[Te]=parseFloat(he[Te]);return be}function a(oe){if(oe.length===0)return[];for(var he=oe.trim().split(/\s+/),be=new Array(he.length),Te=0,Ae=he.length;Te<Ae;Te++)be[Te]=parseInt(he[Te]);return be}function u(oe){return oe.substring(1)}function h(){return"three_default_"+qt++}function f(oe){return Object.keys(oe).length===0}function d(oe){return{unit:m(i(oe,"unit")[0]),upAxis:g(i(oe,"up_axis")[0])}}function m(oe){return oe!==void 0&&oe.hasAttribute("meter")===!0?parseFloat(oe.getAttribute("meter")):1}function g(oe){return oe!==void 0?oe.textContent:"Y_UP"}function x(oe,he,be,Te){var Ae=i(oe,he)[0];if(Ae!==void 0)for(var rt=i(Ae,be),Mt=0;Mt<rt.length;Mt++)Te(rt[Mt])}function v(oe,he){for(var be in oe){var Te=oe[be];Te.build=he(oe[be])}}function A(oe,he){return oe.build!==void 0||(oe.build=he(oe)),oe.build}function _(oe){for(var he={sources:{},samplers:{},channels:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1){var rt;switch(Ae.nodeName){case"source":rt=Ae.getAttribute("id"),he.sources[rt]=Je(Ae);break;case"sampler":rt=Ae.getAttribute("id"),he.samplers[rt]=E(Ae);break;case"channel":rt=Ae.getAttribute("target"),he.channels[rt]=w(Ae);break;default:console.log(Ae)}}}xt.animations[oe.getAttribute("id")]=he}function E(oe){for(var he={inputs:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var rt=u(Ae.getAttribute("source")),Mt=Ae.getAttribute("semantic");he.inputs[Mt]=rt;break}}return he}function w(oe){var he={},be=oe.getAttribute("target"),Te=be.split("/"),Ae=Te.shift(),rt=Te.shift(),Mt=rt.indexOf("(")!==-1,Ft=rt.indexOf(".")!==-1;if(Ft)Te=rt.split("."),rt=Te.shift(),he.member=Te.shift();else if(Mt){var en=rt.split("(");rt=en.shift();for(var Mn=0;Mn<en.length;Mn++)en[Mn]=parseInt(en[Mn].replace(/\)/,""));he.indices=en}return he.id=Ae,he.sid=rt,he.arraySyntax=Mt,he.memberSyntax=Ft,he.sampler=u(oe.getAttribute("source")),he}function S(oe){var he=[],be=oe.channels,Te=oe.samplers,Ae=oe.sources;for(var rt in be)if(be.hasOwnProperty(rt)){var Mt=be[rt],Ft=Te[Mt.sampler],en=Ft.inputs.INPUT,Mn=Ft.inputs.OUTPUT,rn=Ae[en],hn=Ae[Mn],Sn=R(Mt,rn,hn);H(Sn,he)}return he}function T(oe){return A(xt.animations[oe],S)}function R(oe,he,be){var Te=xt.nodes[oe.id],Ae=ki(Te.id),rt=Te.transforms[oe.sid],Mt=Te.matrix.clone().transpose(),Ft,en,Mn,rn,hn,Sn,Kn={};switch(rt){case"matrix":for(Mn=0,rn=he.array.length;Mn<rn;Mn++)if(Ft=he.array[Mn],en=Mn*be.stride,Kn[Ft]===void 0&&(Kn[Ft]={}),oe.arraySyntax===!0){var ei=be.array[en],bn=oe.indices[0]+4*oe.indices[1];Kn[Ft][bn]=ei}else for(hn=0,Sn=be.stride;hn<Sn;hn++)Kn[Ft][hn]=be.array[en+hn];break;case"translate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',rt);break;case"rotate":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',rt);break;case"scale":console.warn('THREE.ColladaLoader: Animation transform type "%s" not yet implemented.',rt);break}var ti=L(Kn,Mt),xi={name:Ae.uuid,keyframes:ti};return xi}function L(oe,he){var be=[];for(var Te in oe)be.push({time:parseFloat(Te),value:oe[Te]});be.sort(rt);for(var Ae=0;Ae<16;Ae++)q(be,Ae,he.elements[Ae]);return be;function rt(Mt,Ft){return Mt.time-Ft.time}}var I=new THREE.Vector3,N=new THREE.Vector3,B=new THREE.Quaternion;function H(oe,he){for(var be=oe.keyframes,Te=oe.name,Ae=[],rt=[],Mt=[],Ft=[],en=0,Mn=be.length;en<Mn;en++){var rn=be[en],hn=rn.time,Sn=rn.value;zt.fromArray(Sn).transpose(),zt.decompose(I,B,N),Ae.push(hn),rt.push(I.x,I.y,I.z),Mt.push(B.x,B.y,B.z,B.w),Ft.push(N.x,N.y,N.z)}return rt.length>0&&he.push(new THREE.VectorKeyframeTrack(Te+".position",Ae,rt)),Mt.length>0&&he.push(new THREE.QuaternionKeyframeTrack(Te+".quaternion",Ae,Mt)),Ft.length>0&&he.push(new THREE.VectorKeyframeTrack(Te+".scale",Ae,Ft)),he}function q(oe,he,be){var Te,Ae=!0,rt,Mt;for(rt=0,Mt=oe.length;rt<Mt;rt++)Te=oe[rt],Te.value[he]===void 0?Te.value[he]=null:Ae=!1;if(Ae===!0)for(rt=0,Mt=oe.length;rt<Mt;rt++)Te=oe[rt],Te.value[he]=be;else le(oe,he)}function le(oe,he){for(var be,Te,Ae=0,rt=oe.length;Ae<rt;Ae++){var Mt=oe[Ae];if(Mt.value[he]===null){if(be=ne(oe,Ae,he),Te=D(oe,Ae,he),be===null){Mt.value[he]=Te.value[he];continue}if(Te===null){Mt.value[he]=be.value[he];continue}O(Mt,be,Te,he)}}}function ne(oe,he,be){for(;he>=0;){var Te=oe[he];if(Te.value[be]!==null)return Te;he--}return null}function D(oe,he,be){for(;he<oe.length;){var Te=oe[he];if(Te.value[be]!==null)return Te;he++}return null}function O(oe,he,be,Te){if(be.time-he.time===0){oe.value[Te]=he.value[Te];return}oe.value[Te]=(oe.time-he.time)*(be.value[Te]-he.value[Te])/(be.time-he.time)+he.value[Te]}function k(oe){for(var he={name:oe.getAttribute("id")||"default",start:parseFloat(oe.getAttribute("start")||0),end:parseFloat(oe.getAttribute("end")||0),animations:[]},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"instance_animation":he.animations.push(u(Ae.getAttribute("url")));break}}xt.clips[oe.getAttribute("id")]=he}function z(oe){for(var he=[],be=oe.name,Te=oe.end-oe.start||-1,Ae=oe.animations,rt=0,Mt=Ae.length;rt<Mt;rt++)for(var Ft=T(Ae[rt]),en=0,Mn=Ft.length;en<Mn;en++)he.push(Ft[en]);return new THREE.AnimationClip(be,Te,he)}function X(oe){return A(xt.clips[oe],z)}function Z(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"skin":he.id=u(Ae.getAttribute("source")),he.skin=ie(Ae);break;case"morph":he.id=u(Ae.getAttribute("source")),console.warn("THREE.ColladaLoader: Morph target animation not supported yet.");break}}xt.controllers[oe.getAttribute("id")]=he}function ie(oe){for(var he={sources:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"bind_shape_matrix":he.bindShapeMatrix=l(Ae.textContent);break;case"source":var rt=Ae.getAttribute("id");he.sources[rt]=Je(Ae);break;case"joints":he.joints=se(Ae);break;case"vertex_weights":he.vertexWeights=ue(Ae);break}}return he}function se(oe){for(var he={inputs:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var rt=Ae.getAttribute("semantic"),Mt=u(Ae.getAttribute("source"));he.inputs[rt]=Mt;break}}return he}function ue(oe){for(var he={inputs:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var rt=Ae.getAttribute("semantic"),Mt=u(Ae.getAttribute("source")),Ft=parseInt(Ae.getAttribute("offset"));he.inputs[rt]={id:Mt,offset:Ft};break;case"vcount":he.vcount=a(Ae.textContent);break;case"v":he.v=a(Ae.textContent);break}}return he}function ye(oe){var he={id:oe.id},be=xt.geometries[he.id];return oe.skin!==void 0&&(he.skin=Ce(oe.skin),be.sources.skinIndices=he.skin.indices,be.sources.skinWeights=he.skin.weights),he}function Ce(oe){var he=4,be={joints:[],indices:{array:[],stride:he},weights:{array:[],stride:he}},Te=oe.sources,Ae=oe.vertexWeights,rt=Ae.vcount,Mt=Ae.v,Ft=Ae.inputs.JOINT.offset,en=Ae.inputs.WEIGHT.offset,Mn=oe.sources[oe.joints.inputs.JOINT],rn=oe.sources[oe.joints.inputs.INV_BIND_MATRIX],hn=Te[Ae.inputs.WEIGHT.id].array,Sn=0,Kn,ei,bn;for(Kn=0,bn=rt.length;Kn<bn;Kn++){var ti=rt[Kn],xi=[];for(ei=0;ei<ti;ei++){var Ti=Mt[Sn+Ft],qi=Mt[Sn+en],rr=hn[qi];xi.push({index:Ti,weight:rr}),Sn+=2}for(xi.sort(Po),ei=0;ei<he;ei++){var Ei=xi[ei];Ei!==void 0?(be.indices.array.push(Ei.index),be.weights.array.push(Ei.weight)):(be.indices.array.push(0),be.weights.array.push(0))}}for(oe.bindShapeMatrix?be.bindMatrix=new THREE.Matrix4().fromArray(oe.bindShapeMatrix).transpose():be.bindMatrix=new THREE.Matrix4().identity(),Kn=0,bn=Mn.array.length;Kn<bn;Kn++){var Mr=Mn.array[Kn],fi=new THREE.Matrix4().fromArray(rn.array,Kn*rn.stride).transpose();be.joints.push({name:Mr,boneInverse:fi})}return be;function Po(fo,Ia){return Ia.weight-fo.weight}}function ke(oe){return A(xt.controllers[oe],ye)}function Oe(oe){var he={init_from:i(oe,"init_from")[0].textContent};xt.images[oe.getAttribute("id")]=he}function Ne(oe){return oe.build!==void 0?oe.build:oe.init_from}function He(oe){var he=xt.images[oe];return he!==void 0?A(he,Ne):(console.warn("THREE.ColladaLoader: Couldn't find image with ID:",oe),null)}function Qe(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"profile_COMMON":he.profile=St(Ae);break}}xt.effects[oe.getAttribute("id")]=he}function St(oe){for(var he={surfaces:{},samplers:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"newparam":bt(Ae,he);break;case"technique":he.technique=Se(Ae);break;case"extra":he.extra=ge(Ae);break}}return he}function bt(oe,he){for(var be=oe.getAttribute("sid"),Te=0,Ae=oe.childNodes.length;Te<Ae;Te++){var rt=oe.childNodes[Te];if(rt.nodeType===1)switch(rt.nodeName){case"surface":he.surfaces[be]=Jt(rt);break;case"sampler2D":he.samplers[be]=sn(rt);break}}}function Jt(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"init_from":he.init_from=Ae.textContent;break}}return he}function sn(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"source":he.source=Ae.textContent;break}}return he}function Se(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"constant":case"lambert":case"blinn":case"phong":he.type=Ae.nodeName,he.parameters=qe(Ae);break}}return he}function qe(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":he[Ae.nodeName]=Ue(Ae);break;case"transparent":he[Ae.nodeName]={opaque:Ae.getAttribute("opaque"),data:Ue(Ae)};break}}return he}function Ue(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"color":he[Ae.nodeName]=l(Ae.textContent);break;case"float":he[Ae.nodeName]=parseFloat(Ae.textContent);break;case"texture":he[Ae.nodeName]={id:Ae.getAttribute("texture"),extra:At(Ae)};break}}return he}function At(oe){for(var he={technique:{}},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"extra":tt(Ae,he);break}}return he}function tt(oe,he){for(var be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"technique":pe(Ae,he);break}}}function pe(oe,he){for(var be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":he.technique[Ae.nodeName]=parseFloat(Ae.textContent);break;case"wrapU":case"wrapV":Ae.textContent.toUpperCase()==="TRUE"?he.technique[Ae.nodeName]=1:Ae.textContent.toUpperCase()==="FALSE"?he.technique[Ae.nodeName]=0:he.technique[Ae.nodeName]=parseInt(Ae.textContent);break}}}function ge(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"technique":he.technique=Fe(Ae);break}}return he}function Fe(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"double_sided":he[Ae.nodeName]=parseInt(Ae.textContent);break}}return he}function Re(oe){return oe}function ce(oe){return A(xt.effects[oe],Re)}function ae(oe){for(var he={name:oe.getAttribute("name")},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"instance_effect":he.url=u(Ae.getAttribute("url"));break}}xt.materials[oe.getAttribute("id")]=he}function J(oe){var he,be=oe.slice((oe.lastIndexOf(".")-1>>>0)+2);switch(be=be.toLowerCase(),be){case"tga":he=Be;break;default:he=_e}return he}function G(oe){var he=ce(oe.url),be=he.profile.technique,Te=he.profile.extra,Ae;switch(be.type){case"phong":case"blinn":Ae=new THREE.MeshPhongMaterial;break;case"lambert":Ae=new THREE.MeshLambertMaterial;break;default:Ae=new THREE.MeshBasicMaterial;break}Ae.name=oe.name;function rt(Sn){var Kn=he.profile.samplers[Sn.id],ei=null;if(Kn!==void 0){var bn=he.profile.surfaces[Kn.source];ei=He(bn.init_from)}else console.warn("THREE.ColladaLoader: Undefined sampler. Access image directly (see #12530)."),ei=He(Sn.id);if(ei!==null){var ti=J(ei);if(ti!==void 0){var xi=ti.load(ei),Ti=Sn.extra;if(Ti!==void 0&&Ti.technique!==void 0&&f(Ti.technique)===!1){var qi=Ti.technique;xi.wrapS=qi.wrapU?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,xi.wrapT=qi.wrapV?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,xi.offset.set(qi.offsetU||0,qi.offsetV||0),xi.repeat.set(qi.repeatU||1,qi.repeatV||1)}else xi.wrapS=THREE.RepeatWrapping,xi.wrapT=THREE.RepeatWrapping;return xi}else return console.warn("THREE.ColladaLoader: Loader for texture %s not found.",ei),null}else return console.warn("THREE.ColladaLoader: Couldn't create texture with ID:",Sn.id),null}var Mt=be.parameters;for(var Ft in Mt){var en=Mt[Ft];switch(Ft){case"diffuse":en.color&&Ae.color.fromArray(en.color),en.texture&&(Ae.map=rt(en.texture));break;case"specular":en.color&&Ae.specular&&Ae.specular.fromArray(en.color),en.texture&&(Ae.specularMap=rt(en.texture));break;case"bump":en.texture&&(Ae.normalMap=rt(en.texture));break;case"ambient":en.texture&&(Ae.lightMap=rt(en.texture));break;case"shininess":en.float&&Ae.shininess&&(Ae.shininess=en.float);break;case"emission":en.color&&Ae.emissive&&Ae.emissive.fromArray(en.color),en.texture&&(Ae.emissiveMap=rt(en.texture));break}}var Mn=Mt.transparent,rn=Mt.transparency;if(rn===void 0&&Mn&&(rn={float:1}),Mn===void 0&&rn&&(Mn={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Mn&&rn)if(Mn.data.texture)Ae.transparent=!0;else{var hn=Mn.data.color;switch(Mn.opaque){case"A_ONE":Ae.opacity=hn[3]*rn.float;break;case"RGB_ZERO":Ae.opacity=1-hn[0]*rn.float;break;case"A_ZERO":Ae.opacity=1-hn[3]*rn.float;break;case"RGB_ONE":Ae.opacity=hn[0]*rn.float;break;default:console.warn('THREE.ColladaLoader: Invalid opaque type "%s" of transparent tag.',Mn.opaque)}Ae.opacity<1&&(Ae.transparent=!0)}return Te!==void 0&&Te.technique!==void 0&&Te.technique.double_sided===1&&(Ae.side=THREE.DoubleSide),Ae}function $(oe){return A(xt.materials[oe],G)}function me(oe){for(var he={name:oe.getAttribute("name")},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"optics":he.optics=Pe(Ae);break}}xt.cameras[oe.getAttribute("id")]=he}function Pe(oe){for(var he=0;he<oe.childNodes.length;he++){var be=oe.childNodes[he];switch(be.nodeName){case"technique_common":return ve(be)}}return{}}function ve(oe){for(var he={},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];switch(Te.nodeName){case"perspective":case"orthographic":he.technique=Te.nodeName,he.parameters=Le(Te);break}}return he}function Le(oe){for(var he={},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];switch(Te.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":he[Te.nodeName]=parseFloat(Te.textContent);break}}return he}function wt(oe){var he;switch(oe.optics.technique){case"perspective":he=new THREE.PerspectiveCamera(oe.optics.parameters.yfov,oe.optics.parameters.aspect_ratio,oe.optics.parameters.znear,oe.optics.parameters.zfar);break;case"orthographic":var be=oe.optics.parameters.ymag,Te=oe.optics.parameters.xmag,Ae=oe.optics.parameters.aspect_ratio;Te=Te===void 0?be*Ae:Te,be=be===void 0?Te/Ae:be,Te*=.5,be*=.5,he=new THREE.OrthographicCamera(-Te,Te,be,-be,oe.optics.parameters.znear,oe.optics.parameters.zfar);break;default:he=new THREE.PerspectiveCamera;break}return he.name=oe.name,he}function Ot(oe){var he=xt.cameras[oe];return he!==void 0?A(he,wt):(console.warn("THREE.ColladaLoader: Couldn't find camera with ID:",oe),null)}function _t(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"technique_common":he=Ut(Ae);break}}xt.lights[oe.getAttribute("id")]=he}function Ut(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"directional":case"point":case"spot":case"ambient":he.technique=Ae.nodeName,he.parameters=It(Ae)}}return he}function It(oe){for(var he={},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"color":var rt=l(Ae.textContent);he.color=new THREE.Color().fromArray(rt);break;case"falloff_angle":he.falloffAngle=parseFloat(Ae.textContent);break;case"quadratic_attenuation":var Mt=parseFloat(Ae.textContent);he.distance=Mt?Math.sqrt(1/Mt):0;break}}return he}function dn(oe){var he;switch(oe.technique){case"directional":he=new THREE.DirectionalLight;break;case"point":he=new THREE.PointLight;break;case"spot":he=new THREE.SpotLight;break;case"ambient":he=new THREE.AmbientLight;break}return oe.parameters.color&&he.color.copy(oe.parameters.color),oe.parameters.distance&&(he.distance=oe.parameters.distance),he}function Un(oe){var he=xt.lights[oe];return he!==void 0?A(he,dn):(console.warn("THREE.ColladaLoader: Couldn't find light with ID:",oe),null)}function $n(oe){var he={name:oe.getAttribute("name"),sources:{},vertices:{},primitives:[]},be=i(oe,"mesh")[0];if(be!==void 0){for(var Te=0;Te<be.childNodes.length;Te++){var Ae=be.childNodes[Te];if(Ae.nodeType===1){var rt=Ae.getAttribute("id");switch(Ae.nodeName){case"source":he.sources[rt]=Je(Ae);break;case"vertices":he.vertices=Ve(Ae);break;case"polygons":console.warn("THREE.ColladaLoader: Unsupported primitive type: ",Ae.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":he.primitives.push(nt(Ae));break;default:console.log(Ae)}}}xt.geometries[oe.getAttribute("id")]=he}}function Je(oe){for(var he={array:[],stride:3},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"float_array":he.array=l(Te.textContent);break;case"Name_array":he.array=o(Te.textContent);break;case"technique_common":var Ae=i(Te,"accessor")[0];Ae!==void 0&&(he.stride=parseInt(Ae.getAttribute("stride")));break}}return he}function Ve(oe){for(var he={},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];Te.nodeType===1&&(he[Te.getAttribute("semantic")]=u(Te.getAttribute("source")))}return he}function nt(oe){for(var he={type:oe.nodeName,material:oe.getAttribute("material"),count:parseInt(oe.getAttribute("count")),inputs:{},stride:0,hasUV:!1},be=0,Te=oe.childNodes.length;be<Te;be++){var Ae=oe.childNodes[be];if(Ae.nodeType===1)switch(Ae.nodeName){case"input":var rt=u(Ae.getAttribute("source")),Mt=Ae.getAttribute("semantic"),Ft=parseInt(Ae.getAttribute("offset")),en=parseInt(Ae.getAttribute("set")),Mn=en>0?Mt+en:Mt;he.inputs[Mn]={id:rt,offset:Ft},he.stride=Math.max(he.stride,Ft+1),Mt==="TEXCOORD"&&(he.hasUV=!0);break;case"vcount":he.vcount=a(Ae.textContent);break;case"p":he.p=a(Ae.textContent);break}}return he}function yt(oe){for(var he={},be=0;be<oe.length;be++){var Te=oe[be];he[Te.type]===void 0&&(he[Te.type]=[]),he[Te.type].push(Te)}return he}function Wt(oe){for(var he=0,be=0,Te=oe.length;be<Te;be++){var Ae=oe[be];Ae.hasUV===!0&&he++}he>0&&he<oe.length&&(oe.uvsNeedsFix=!0)}function pn(oe){var he={},be=oe.sources,Te=oe.vertices,Ae=oe.primitives;if(Ae.length===0)return{};var rt=yt(Ae);for(var Mt in rt){var Ft=rt[Mt];Wt(Ft),he[Mt]=An(Ft,be,Te)}return he}function An(oe,he,be){for(var Te={},Ae={array:[],stride:0},rt={array:[],stride:0},Mt={array:[],stride:0},Ft={array:[],stride:0},en={array:[],stride:0},Mn={array:[],stride:4},rn={array:[],stride:4},hn=new THREE.BufferGeometry,Sn=[],Kn=0,ei=0;ei<oe.length;ei++){var bn=oe[ei],ti=bn.inputs,xi=0;switch(bn.type){case"lines":case"linestrips":xi=bn.count*2;break;case"triangles":xi=bn.count*3;break;case"polylist":for(var Ti=0;Ti<bn.count;Ti++){var qi=bn.vcount[Ti];switch(qi){case 3:xi+=3;break;case 4:xi+=6;break;default:xi+=(qi-2)*3;break}}break;default:console.warn("THREE.ColladaLoader: Unknow primitive type:",bn.type)}hn.addGroup(Kn,xi,ei),Kn+=xi,bn.material&&Sn.push(bn.material);for(var rr in ti){var Ei=ti[rr];switch(rr){case"VERTEX":for(var Mr in be){var fi=be[Mr];switch(Mr){case"POSITION":var Po=Ae.array.length;if(mn(bn,he[fi],Ei.offset,Ae.array),Ae.stride=he[fi].stride,he.skinWeights&&he.skinIndices&&(mn(bn,he.skinIndices,Ei.offset,Mn.array),mn(bn,he.skinWeights,Ei.offset,rn.array)),bn.hasUV===!1&&oe.uvsNeedsFix===!0)for(var xi=(Ae.array.length-Po)/Ae.stride,fo=0;fo<xi;fo++)Mt.array.push(0,0);break;case"NORMAL":mn(bn,he[fi],Ei.offset,rt.array),rt.stride=he[fi].stride;break;case"COLOR":mn(bn,he[fi],Ei.offset,en.array),en.stride=he[fi].stride;break;case"TEXCOORD":mn(bn,he[fi],Ei.offset,Mt.array),Mt.stride=he[fi].stride;break;case"TEXCOORD1":mn(bn,he[fi],Ei.offset,Ft.array),Mt.stride=he[fi].stride;break;default:console.warn('THREE.ColladaLoader: Semantic "%s" not handled in geometry build process.',Mr)}}break;case"NORMAL":mn(bn,he[Ei.id],Ei.offset,rt.array),rt.stride=he[Ei.id].stride;break;case"COLOR":mn(bn,he[Ei.id],Ei.offset,en.array),en.stride=he[Ei.id].stride;break;case"TEXCOORD":mn(bn,he[Ei.id],Ei.offset,Mt.array),Mt.stride=he[Ei.id].stride;break;case"TEXCOORD1":mn(bn,he[Ei.id],Ei.offset,Ft.array),Ft.stride=he[Ei.id].stride;break}}}return Ae.array.length>0&&hn.addAttribute("position",new THREE.Float32BufferAttribute(Ae.array,Ae.stride)),rt.array.length>0&&hn.addAttribute("normal",new THREE.Float32BufferAttribute(rt.array,rt.stride)),en.array.length>0&&hn.addAttribute("color",new THREE.Float32BufferAttribute(en.array,en.stride)),Mt.array.length>0&&hn.addAttribute("uv",new THREE.Float32BufferAttribute(Mt.array,Mt.stride)),Ft.array.length>0&&hn.addAttribute("uv2",new THREE.Float32BufferAttribute(Ft.array,Ft.stride)),Mn.array.length>0&&hn.addAttribute("skinIndex",new THREE.Float32BufferAttribute(Mn.array,Mn.stride)),rn.array.length>0&&hn.addAttribute("skinWeight",new THREE.Float32BufferAttribute(rn.array,rn.stride)),Te.data=hn,Te.type=oe[0].type,Te.materialKeys=Sn,Te}function mn(oe,he,be,Te){var Ae=oe.p,rt=oe.stride,Mt=oe.vcount;function Ft(rr){for(var Ei=Ae[rr+be]*Mn,Mr=Ei+Mn;Ei<Mr;Ei++)Te.push(en[Ei])}var en=he.array,Mn=he.stride;if(oe.vcount!==void 0)for(var rn=0,hn=0,Sn=Mt.length;hn<Sn;hn++){var Kn=Mt[hn];if(Kn===4){var ei=rn+rt*0,bn=rn+rt*1,ti=rn+rt*2,xi=rn+rt*3;Ft(ei),Ft(bn),Ft(xi),Ft(bn),Ft(ti),Ft(xi)}else if(Kn===3){var ei=rn+rt*0,bn=rn+rt*1,ti=rn+rt*2;Ft(ei),Ft(bn),Ft(ti)}else if(Kn>4)for(var Ti=1,qi=Kn-2;Ti<=qi;Ti++){var ei=rn+rt*0,bn=rn+rt*Ti,ti=rn+rt*(Ti+1);Ft(ei),Ft(bn),Ft(ti)}rn+=rt*Kn}else for(var hn=0,Sn=Ae.length;hn<Sn;hn+=rt)Ft(hn)}function Yn(oe){return A(xt.geometries[oe],pn)}function Bn(oe){for(var he={name:oe.getAttribute("name")||"",joints:{},links:[]},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"technique_common":Si(Te,he);break}}xt.kinematicsModels[oe.getAttribute("id")]=he}function mi(oe){return oe.build!==void 0?oe.build:oe}function Ii(oe){return A(xt.kinematicsModels[oe],mi)}function Si(oe,he){for(var be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"joint":he.joints[Te.getAttribute("sid")]=Gi(Te);break;case"link":he.links.push(is(Te));break}}}function Gi(oe){for(var he,be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"prismatic":case"revolute":he=er(Te);break}}return he}function er(oe,be){for(var be={sid:oe.getAttribute("sid"),name:oe.getAttribute("name")||"",axis:new THREE.Vector3,limits:{min:0,max:0},type:oe.nodeName,static:!1,zeroPosition:0,middlePosition:0},Te=0;Te<oe.childNodes.length;Te++){var Ae=oe.childNodes[Te];if(Ae.nodeType===1)switch(Ae.nodeName){case"axis":var rt=l(Ae.textContent);be.axis.fromArray(rt);break;case"limits":var Mt=Ae.getElementsByTagName("max")[0],Ft=Ae.getElementsByTagName("min")[0];be.limits.max=parseFloat(Mt.textContent),be.limits.min=parseFloat(Ft.textContent);break}}return be.limits.min>=be.limits.max&&(be.static=!0),be.middlePosition=(be.limits.min+be.limits.max)/2,be}function is(oe){for(var he={sid:oe.getAttribute("sid"),name:oe.getAttribute("name")||"",attachments:[],transforms:[]},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"attachment_full":he.attachments.push(ze(Te));break;case"matrix":case"translate":case"rotate":he.transforms.push(at(Te));break}}return he}function ze(oe){for(var he={joint:oe.getAttribute("joint").split("/").pop(),transforms:[],links:[]},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"link":he.links.push(is(Te));break;case"matrix":case"translate":case"rotate":he.transforms.push(at(Te));break}}return he}function at(oe){var he={type:oe.nodeName},be=l(oe.textContent);switch(he.type){case"matrix":he.obj=new THREE.Matrix4,he.obj.fromArray(be).transpose();break;case"translate":he.obj=new THREE.Vector3,he.obj.fromArray(be);break;case"rotate":he.obj=new THREE.Vector3,he.obj.fromArray(be),he.angle=THREE.Math.degToRad(be[3]);break}return he}function Pt(oe){for(var he={name:oe.getAttribute("name")||"",rigidBodies:{}},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"rigid_body":he.rigidBodies[Te.getAttribute("name")]={},ft(Te,he.rigidBodies[Te.getAttribute("name")]);break}}xt.physicsModels[oe.getAttribute("id")]=he}function ft(oe,he){for(var be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"technique_common":Ht(Te,he);break}}}function Ht(oe,he){for(var be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"inertia":he.inertia=l(Te.textContent);break;case"mass":he.mass=l(Te.textContent)[0];break}}}function In(oe){for(var he={bindJointAxis:[]},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"bind_joint_axis":he.bindJointAxis.push(we(Te));break}}xt.kinematicsScenes[u(oe.getAttribute("url"))]=he}function we(oe){for(var he={target:oe.getAttribute("target").split("/").pop()},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"axis":var Ae=Te.getElementsByTagName("param")[0];he.axis=Ae.textContent;var rt=he.axis.split("inst_").pop().split("axis")[0];he.jointIndex=rt.substr(0,rt.length-1);break}}return he}function We(oe){return oe.build!==void 0?oe.build:oe}function et(oe){return A(xt.kinematicsScenes[oe],We)}function mt(){var oe=Object.keys(xt.kinematicsModels)[0],he=Object.keys(xt.kinematicsScenes)[0],be=Object.keys(xt.visualScenes)[0];if(oe===void 0||he===void 0)return;for(var Te=Ii(oe),Ae=et(he),rt=Xn(be),Mt=Ae.bindJointAxis,Ft={},en=0,Mn=Mt.length;en<Mn;en++){var rn=Mt[en],hn=K.querySelector('[sid="'+rn.target+'"]');if(hn){var Sn=hn.parentElement;Kn(rn.jointIndex,Sn)}}function Kn(bn,ti){var xi=ti.getAttribute("name"),Ti=Te.joints[bn];rt.traverse(function(qi){qi.name===xi&&(Ft[bn]={object:qi,transforms:ot(ti),joint:Ti,position:Ti.zeroPosition})})}var ei=new THREE.Matrix4;lt={joints:Te&&Te.joints,getJointValue:function(bn){var ti=Ft[bn];if(ti)return ti.position;console.warn("THREE.ColladaLoader: Joint "+bn+" doesn't exist.")},setJointValue:function(bn,ti){var xi=Ft[bn];if(xi){var Ti=xi.joint;if(ti>Ti.limits.max||ti<Ti.limits.min)console.warn("THREE.ColladaLoader: Joint "+bn+" value "+ti+" outside of limits (min: "+Ti.limits.min+", max: "+Ti.limits.max+").");else if(Ti.static)console.warn("THREE.ColladaLoader: Joint "+bn+" is static.");else{var qi=xi.object,rr=Ti.axis,Ei=xi.transforms;zt.identity();for(var Mr=0;Mr<Ei.length;Mr++){var fi=Ei[Mr];if(fi.sid&&fi.sid.indexOf(bn)!==-1)switch(Ti.type){case"revolute":zt.multiply(ei.makeRotationAxis(rr,THREE.Math.degToRad(ti)));break;case"prismatic":zt.multiply(ei.makeTranslation(rr.x*ti,rr.y*ti,rr.z*ti));break;default:console.warn("THREE.ColladaLoader: Unknown joint type: "+Ti.type);break}else switch(fi.type){case"matrix":zt.multiply(fi.obj);break;case"translate":zt.multiply(ei.makeTranslation(fi.obj.x,fi.obj.y,fi.obj.z));break;case"scale":zt.scale(fi.obj);break;case"rotate":zt.multiply(ei.makeRotationAxis(fi.obj,fi.angle));break}}qi.matrix.copy(zt),qi.matrix.decompose(qi.position,qi.quaternion,qi.scale),Ft[bn].position=ti}}else console.log("THREE.ColladaLoader: "+bn+" does not exist.")}}}function ot(oe){for(var he=[],be=K.querySelector('[id="'+oe.id+'"]'),Te=0;Te<be.childNodes.length;Te++){var Ae=be.childNodes[Te];if(Ae.nodeType===1)switch(Ae.nodeName){case"matrix":var Mt=l(Ae.textContent),rt=new THREE.Matrix4().fromArray(Mt).transpose();he.push({sid:Ae.getAttribute("sid"),type:Ae.nodeName,obj:rt});break;case"translate":case"scale":var Mt=l(Ae.textContent),Ft=new THREE.Vector3().fromArray(Mt);he.push({sid:Ae.getAttribute("sid"),type:Ae.nodeName,obj:Ft});break;case"rotate":var Mt=l(Ae.textContent),Ft=new THREE.Vector3().fromArray(Mt),en=THREE.Math.degToRad(Mt[3]);he.push({sid:Ae.getAttribute("sid"),type:Ae.nodeName,obj:Ft,angle:en});break}}return he}function Tt(oe){for(var he=oe.getElementsByTagName("node"),be=0;be<he.length;be++){var Te=he[be];Te.hasAttribute("id")===!1&&Te.setAttribute("id",h())}}var zt=new THREE.Matrix4,un=new THREE.Vector3;function tn(oe){for(var he={name:oe.getAttribute("name")||"",type:oe.getAttribute("type"),id:oe.getAttribute("id"),sid:oe.getAttribute("sid"),matrix:new THREE.Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];if(Te.nodeType===1)switch(Te.nodeName){case"node":he.nodes.push(Te.getAttribute("id")),tn(Te);break;case"instance_camera":he.instanceCameras.push(u(Te.getAttribute("url")));break;case"instance_controller":he.instanceControllers.push(Bt(Te));break;case"instance_light":he.instanceLights.push(u(Te.getAttribute("url")));break;case"instance_geometry":he.instanceGeometries.push(Bt(Te));break;case"instance_node":he.instanceNodes.push(u(Te.getAttribute("url")));break;case"matrix":var rt=l(Te.textContent);he.matrix.multiply(zt.fromArray(rt).transpose()),he.transforms[Te.getAttribute("sid")]=Te.nodeName;break;case"translate":var rt=l(Te.textContent);un.fromArray(rt),he.matrix.multiply(zt.makeTranslation(un.x,un.y,un.z)),he.transforms[Te.getAttribute("sid")]=Te.nodeName;break;case"rotate":var rt=l(Te.textContent),Ae=THREE.Math.degToRad(rt[3]);he.matrix.multiply(zt.makeRotationAxis(un.fromArray(rt),Ae)),he.transforms[Te.getAttribute("sid")]=Te.nodeName;break;case"scale":var rt=l(Te.textContent);he.matrix.scale(un.fromArray(rt)),he.transforms[Te.getAttribute("sid")]=Te.nodeName;break;case"extra":break;default:console.log(Te)}}return _i(he.id)?console.warn("THREE.ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",he.id):xt.nodes[he.id]=he,he}function Bt(oe){for(var he={id:u(oe.getAttribute("url")),materials:{},skeletons:[]},be=0;be<oe.childNodes.length;be++){var Te=oe.childNodes[be];switch(Te.nodeName){case"bind_material":for(var Ae=Te.getElementsByTagName("instance_material"),rt=0;rt<Ae.length;rt++){var Mt=Ae[rt],Ft=Mt.getAttribute("symbol"),en=Mt.getAttribute("target");he.materials[Ft]=u(en)}break;case"skeleton":he.skeletons.push(u(Te.textContent));break}}return he}function fn(oe,he){var be=[],Te=[],Ae,rt,Mt;for(Ae=0;Ae<oe.length;Ae++){var Ft=oe[Ae],en;if(_i(Ft))en=ki(Ft),ln(en,he,be);else if(gi(Ft))for(var Mn=xt.visualScenes[Ft],rn=Mn.children,rt=0;rt<rn.length;rt++){var hn=rn[rt];if(hn.type==="JOINT"){var en=ki(hn.id);ln(en,he,be)}}else console.error("THREE.ColladaLoader: Unable to find root bone of skeleton with ID:",Ft)}for(Ae=0;Ae<he.length;Ae++)for(rt=0;rt<be.length;rt++)if(Mt=be[rt],Mt.bone.name===he[Ae].name){Te[Ae]=Mt,Mt.processed=!0;break}for(Ae=0;Ae<be.length;Ae++)Mt=be[Ae],Mt.processed===!1&&(Te.push(Mt),Mt.processed=!0);var Sn=[],Kn=[];for(Ae=0;Ae<Te.length;Ae++)Mt=Te[Ae],Sn.push(Mt.bone),Kn.push(Mt.boneInverse);return new THREE.Skeleton(Sn,Kn)}function ln(oe,he,be){oe.traverse(function(Te){if(Te.isBone===!0){for(var Ae,rt=0;rt<he.length;rt++){var Mt=he[rt];if(Mt.name===Te.name){Ae=Mt.boneInverse;break}}Ae===void 0&&(Ae=new THREE.Matrix4),be.push({bone:Te,boneInverse:Ae,processed:!1})}})}function Jn(oe){for(var he=[],be=oe.matrix,Te=oe.nodes,Ae=oe.type,rt=oe.instanceCameras,Mt=oe.instanceControllers,Ft=oe.instanceLights,en=oe.instanceGeometries,Mn=oe.instanceNodes,rn=0,hn=Te.length;rn<hn;rn++)he.push(ki(Te[rn]));for(var rn=0,hn=rt.length;rn<hn;rn++){var Sn=Ot(rt[rn]);Sn!==null&&he.push(Sn.clone())}for(var rn=0,hn=Mt.length;rn<hn;rn++)for(var Kn=Mt[rn],ei=ke(Kn.id),bn=Yn(ei.id),ti=ri(bn,Kn.materials),xi=Kn.skeletons,Ti=ei.skin.joints,qi=fn(xi,Ti),rr=0,Ei=ti.length;rr<Ei;rr++){var fi=ti[rr];fi.isSkinnedMesh&&(fi.bind(qi,ei.skin.bindMatrix),fi.normalizeSkinWeights()),he.push(fi)}for(var rn=0,hn=Ft.length;rn<hn;rn++){var Mr=Un(Ft[rn]);Mr!==null&&he.push(Mr.clone())}for(var rn=0,hn=en.length;rn<hn;rn++)for(var Kn=en[rn],bn=Yn(Kn.id),ti=ri(bn,Kn.materials),rr=0,Ei=ti.length;rr<Ei;rr++)he.push(ti[rr]);for(var rn=0,hn=Mn.length;rn<hn;rn++)he.push(ki(Mn[rn]).clone());var fi;if(Te.length===0&&he.length===1)fi=he[0];else{fi=Ae==="JOINT"?new THREE.Bone:new THREE.Group;for(var rn=0;rn<he.length;rn++)fi.add(he[rn])}return fi.name===""&&(fi.name=Ae==="JOINT"?oe.sid:oe.name),fi.matrix.copy(be),fi.matrix.decompose(fi.position,fi.quaternion,fi.scale),fi}var hi=new THREE.MeshBasicMaterial({color:16711935});function di(oe,he){for(var be=[],Te=0,Ae=oe.length;Te<Ae;Te++){var rt=he[oe[Te]];rt===void 0?(console.warn("THREE.ColladaLoader: Material with key %s not found. Apply fallback material.",oe[Te]),be.push(hi)):be.push($(rt))}return be}function ri(oe,he){var be=[];for(var Te in oe){var Ae=oe[Te],rt=di(Ae.materialKeys,he);rt.length===0&&(Te==="lines"||Te==="linestrips"?rt.push(new THREE.LineBasicMaterial):rt.push(new THREE.MeshPhongMaterial));var Mt=Ae.data.attributes.skinIndex!==void 0;if(Mt)for(var Ft=0,en=rt.length;Ft<en;Ft++)rt[Ft].skinning=!0;var Mn=rt.length===1?rt[0]:rt,rn;switch(Te){case"lines":rn=new THREE.LineSegments(Ae.data,Mn);break;case"linestrips":rn=new THREE.Line(Ae.data,Mn);break;case"triangles":case"polylist":Mt?rn=new THREE.SkinnedMesh(Ae.data,Mn):rn=new THREE.Mesh(Ae.data,Mn);break}be.push(rn)}return be}function _i(oe){return xt.nodes[oe]!==void 0}function ki(oe){return A(xt.nodes[oe],Jn)}function Ni(oe){var he={name:oe.getAttribute("name"),children:[]};Tt(oe);for(var be=i(oe,"node"),Te=0;Te<be.length;Te++)he.children.push(tn(be[Te]));xt.visualScenes[oe.getAttribute("id")]=he}function Vn(oe){var he=new THREE.Group;he.name=oe.name;for(var be=oe.children,Te=0;Te<be.length;Te++){var Ae=be[Te];he.add(ki(Ae.id))}return he}function gi(oe){return xt.visualScenes[oe]!==void 0}function Xn(oe){return A(xt.visualScenes[oe],Vn)}function wr(oe){var he=i(oe,"instance_visual_scene")[0];return Xn(u(he.getAttribute("url")))}function Vi(){var oe=xt.clips;if(f(oe)===!0){if(f(xt.animations)===!1){var he=[];for(var be in xt.animations)for(var Te=T(be),Ae=0,rt=Te.length;Ae<rt;Ae++)he.push(Te[Ae]);Ze.push(new THREE.AnimationClip("default",-1,he))}}else for(var be in oe)Ze.push(X(be))}if(r.length===0)return{scene:new THREE.Scene};var Wi=new DOMParser().parseFromString(r,"application/xml"),K=i(Wi,"COLLADA")[0],te=K.getAttribute("version");console.log("THREE.ColladaLoader: File version",te);var fe=d(i(K,"asset")[0]),_e=new THREE.TextureLoader(this.manager);_e.setPath(this.resourcePath||n).setCrossOrigin(this.crossOrigin);var Be;THREE.TGALoader&&(Be=new THREE.TGALoader(this.manager),Be.setPath(this.resourcePath||n));var Ze=[],lt={},qt=0,xt={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};x(K,"library_animations","animation",_),x(K,"library_animation_clips","animation_clip",k),x(K,"library_controllers","controller",Z),x(K,"library_images","image",Oe),x(K,"library_effects","effect",Qe),x(K,"library_materials","material",ae),x(K,"library_cameras","camera",me),x(K,"library_lights","light",_t),x(K,"library_geometries","geometry",$n),x(K,"library_nodes","node",tn),x(K,"library_visual_scenes","visual_scene",Ni),x(K,"library_kinematics_models","kinematics_model",Bn),x(K,"library_physics_models","physics_model",Pt),x(K,"scene","instance_kinematics_scene",In),v(xt.animations,S),v(xt.clips,z),v(xt.controllers,ye),v(xt.images,Ne),v(xt.effects,Re),v(xt.materials,G),v(xt.cameras,wt),v(xt.lights,dn),v(xt.geometries,pn),v(xt.visualScenes,Vn),Vi(),mt();var pt=wr(i(K,"scene")[0]);return fe.upAxis==="Z_UP"&&pt.quaternion.setFromEuler(new THREE.Euler(-Math.PI/2,0,0)),pt.scale.multiplyScalar(fe.unit),{animations:Ze,kinematics:lt,library:xt,scene:pt}}};THREE.ColladaLoader=LH;AFRAME.registerComponent("collada-model-legacy",{schema:{type:"asset"},init:function(){this.model=null,this.loader=new THREE.ColladaLoader},update:function(){var r=this,n=this.el,i=this.data,o=this.el.sceneEl.systems.renderer;!i||(this.remove(),this.loader.load(i,function(l){r.model=l.scene,r.model.traverse(function(a){if(a.isMesh){var u=a.material;u.color&&o.applyColorCorrection(u.color),u.map&&o.applyColorCorrection(u.map),u.emissive&&o.applyColorCorrection(u.emissive),u.emissiveMap&&o.applyColorCorrection(u.emissiveMap)}}),n.setObject3D("mesh",r.model),n.emit("model-loaded",{format:"collada",model:r.model})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}});var PH=THREE.FBXLoader=function(){var r,n,i;function o(D){this.manager=D!==void 0?D:THREE.DefaultLoadingManager}o.prototype={constructor:o,crossOrigin:"anonymous",load:function(D,O,k,z){var X=this,Z=THREE.LoaderUtils.extractUrlBase(D),ie=new THREE.FileLoader(this.manager);ie.setResponseType("arraybuffer"),ie.load(D,function(se){try{var ue=X.parse(se,Z);O(ue)}catch(ye){setTimeout(function(){z&&z(ye),X.manager.itemError(D)},0)}},k,z)},setCrossOrigin:function(D){return this.crossOrigin=D,this},parse:function(D,O){if(g(D))r=new f().parse(D);else{var k=H(D);if(!x(k))throw new Error("THREE.FBXLoader: Unknown format.");if(v(k)<7e3)throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+v(k));r=new h().parse(k)}var z=new THREE.TextureLoader(this.manager).setPath(O).setCrossOrigin(this.crossOrigin);return new l(z).parse(r)}};function l(D){this.textureLoader=D}l.prototype={constructor:l,parse:function(){n=this.parseConnections();var D=this.parseImages(),O=this.parseTextures(D),k=this.parseMaterials(O),z=this.parseDeformers(),X=new a().parse(z);return this.parseScene(z,X,k),i},parseConnections:function(){var D=new Map;if("Connections"in r){var O=r.Connections.connections;O.forEach(function(k){var z=k[0],X=k[1],Z=k[2];D.has(z)||D.set(z,{parents:[],children:[]});var ie={ID:X,relationship:Z};D.get(z).parents.push(ie),D.has(X)||D.set(X,{parents:[],children:[]});var se={ID:z,relationship:Z};D.get(X).children.push(se)})}return D},parseImages:function(){var D={},O={};if("Video"in r.Objects){var k=r.Objects.Video;for(var z in k){var X=k[z],Z=parseInt(z);if(D[Z]=X.RelativeFilename||X.Filename,"Content"in X){var ie=X.Content instanceof ArrayBuffer&&X.Content.byteLength>0,se=typeof X.Content=="string"&&X.Content!=="";if(ie||se){var ue=this.parseImage(k[z]);O[X.RelativeFilename||X.Filename]=ue}}}}for(var Z in D){var ye=D[Z];O[ye]!==void 0?D[Z]=O[ye]:D[Z]=D[Z].split("\\").pop()}return D},parseImage:function(D){var O=D.Content,k=D.RelativeFilename||D.Filename,z=k.slice(k.lastIndexOf(".")+1).toLowerCase(),X;switch(z){case"bmp":X="image/bmp";break;case"jpg":case"jpeg":X="image/jpeg";break;case"png":X="image/png";break;case"tif":X="image/tiff";break;case"tga":if(typeof THREE.TGALoader!="function"){console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");return}else{THREE.Loader.Handlers.get(".tga")===null&&THREE.Loader.Handlers.add(/\.tga$/i,new THREE.TGALoader),X="image/tga";break}default:console.warn('FBXLoader: Image type "'+z+'" is not supported.');return}if(typeof O=="string")return"data:"+X+";base64,"+O;var Z=new Uint8Array(O);return window.URL.createObjectURL(new Blob([Z],{type:X}))},parseTextures:function(D){var O=new Map;if("Texture"in r.Objects){var k=r.Objects.Texture;for(var z in k){var X=this.parseTexture(k[z],D);O.set(parseInt(z),X)}}return O},parseTexture:function(D,O){var k=this.loadTexture(D,O);k.ID=D.id,k.name=D.attrName;var z=D.WrapModeU,X=D.WrapModeV,Z=z!==void 0?z.value:0,ie=X!==void 0?X.value:0;if(k.wrapS=Z===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,k.wrapT=ie===0?THREE.RepeatWrapping:THREE.ClampToEdgeWrapping,"Scaling"in D){var se=D.Scaling.value;k.repeat.x=se[0],k.repeat.y=se[1]}return k},loadTexture:function(D,O){var k,z=this.textureLoader.path,X=n.get(D.id).children;X!==void 0&&X.length>0&&O[X[0].ID]!==void 0&&(k=O[X[0].ID],(k.indexOf("blob:")===0||k.indexOf("data:")===0)&&this.textureLoader.setPath(void 0));var Z,ie=D.FileName.slice(-3).toLowerCase();if(ie==="tga"){var se=THREE.Loader.Handlers.get(".tga");se===null?(console.warn("FBXLoader: TGALoader not found, creating empty placeholder texture for",k),Z=new THREE.Texture):Z=se.load(k)}else ie==="psd"?(console.warn("FBXLoader: PSD textures are not supported, creating empty placeholder texture for",k),Z=new THREE.Texture):Z=this.textureLoader.load(k);return this.textureLoader.setPath(z),Z},parseMaterials:function(D){var O=new Map;if("Material"in r.Objects){var k=r.Objects.Material;for(var z in k){var X=this.parseMaterial(k[z],D);X!==null&&O.set(parseInt(z),X)}}return O},parseMaterial:function(D,O){var k=D.id,z=D.attrName,X=D.ShadingModel;if(typeof X=="object"&&(X=X.value),!n.has(k))return null;var Z=this.parseParameters(D,O,k),ie;switch(X.toLowerCase()){case"phong":ie=new THREE.MeshPhongMaterial;break;case"lambert":ie=new THREE.MeshLambertMaterial;break;default:console.warn('THREE.FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',X),ie=new THREE.MeshPhongMaterial({color:3342591});break}return ie.setValues(Z),ie.name=z,ie},parseParameters:function(D,O,k){var z={};D.BumpFactor&&(z.bumpScale=D.BumpFactor.value),D.Diffuse?z.color=new THREE.Color().fromArray(D.Diffuse.value):D.DiffuseColor&&D.DiffuseColor.type==="Color"&&(z.color=new THREE.Color().fromArray(D.DiffuseColor.value)),D.DisplacementFactor&&(z.displacementScale=D.DisplacementFactor.value),D.Emissive?z.emissive=new THREE.Color().fromArray(D.Emissive.value):D.EmissiveColor&&D.EmissiveColor.type==="Color"&&(z.emissive=new THREE.Color().fromArray(D.EmissiveColor.value)),D.EmissiveFactor&&(z.emissiveIntensity=parseFloat(D.EmissiveFactor.value)),D.Opacity&&(z.opacity=parseFloat(D.Opacity.value)),z.opacity<1&&(z.transparent=!0),D.ReflectionFactor&&(z.reflectivity=D.ReflectionFactor.value),D.Shininess&&(z.shininess=D.Shininess.value),D.Specular?z.specular=new THREE.Color().fromArray(D.Specular.value):D.SpecularColor&&D.SpecularColor.type==="Color"&&(z.specular=new THREE.Color().fromArray(D.SpecularColor.value));var X=this;return n.get(k).children.forEach(function(Z){var ie=Z.relationship;switch(ie){case"Bump":z.bumpMap=X.getTexture(O,Z.ID);break;case"DiffuseColor":z.map=X.getTexture(O,Z.ID);break;case"DisplacementColor":z.displacementMap=X.getTexture(O,Z.ID);break;case"EmissiveColor":z.emissiveMap=X.getTexture(O,Z.ID);break;case"NormalMap":z.normalMap=X.getTexture(O,Z.ID);break;case"ReflectionColor":z.envMap=X.getTexture(O,Z.ID),z.envMap.mapping=THREE.EquirectangularReflectionMapping;break;case"SpecularColor":z.specularMap=X.getTexture(O,Z.ID);break;case"TransparentColor":z.alphaMap=X.getTexture(O,Z.ID),z.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",ie);break}}),z},getTexture:function(D,O){return"LayeredTexture"in r.Objects&&O in r.Objects.LayeredTexture&&(console.warn("THREE.FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),O=n.get(O).children[0].ID),D.get(O)},parseDeformers:function(){var D={},O={};if("Deformer"in r.Objects){var k=r.Objects.Deformer;for(var z in k){var X=k[z],Z=n.get(parseInt(z));if(X.attrType==="Skin"){var ie=this.parseSkeleton(Z,k);ie.ID=z,Z.parents.length>1&&console.warn("THREE.FBXLoader: skeleton attached to more than one geometry is not supported."),ie.geometryID=Z.parents[0].ID,D[z]=ie}else if(X.attrType==="BlendShape"){var se={id:z};se.rawTargets=this.parseMorphTargets(Z,k),se.id=z,Z.parents.length>1&&console.warn("THREE.FBXLoader: morph target attached to more than one geometry is not supported."),O[z]=se}}}return{skeletons:D,morphTargets:O}},parseSkeleton:function(D,O){var k=[];return D.children.forEach(function(z){var X=O[z.ID];if(X.attrType==="Cluster"){var Z={ID:z.ID,indices:[],weights:[],transform:new THREE.Matrix4().fromArray(X.Transform.a),transformLink:new THREE.Matrix4().fromArray(X.TransformLink.a),linkMode:X.Mode};"Indexes"in X&&(Z.indices=X.Indexes.a,Z.weights=X.Weights.a),k.push(Z)}}),{rawBones:k,bones:[]}},parseMorphTargets:function(D,O){for(var k=[],z=0;z<D.children.length;z++){if(z===8){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var X=D.children[z],Z=O[X.ID],ie={name:Z.attrName,initialWeight:Z.DeformPercent,id:Z.id,fullWeights:Z.FullWeights.a};if(Z.attrType!=="BlendShapeChannel")return;var se=n.get(parseInt(X.ID));se.children.forEach(function(ue){ue.relationship===void 0&&(ie.geoID=ue.ID)}),k.push(ie)}return k},parseScene:function(D,O,k){i=new THREE.Group;var z=this.parseModels(D.skeletons,O,k),X=r.Objects.Model,Z=this;z.forEach(function(se){var ue=X[se.ID];Z.setLookAtProperties(se,ue);var ye=n.get(se.ID).parents;ye.forEach(function(Ce){var ke=z.get(Ce.ID);ke!==void 0&&ke.add(se)}),se.parent===null&&i.add(se)}),this.bindSkeleton(D.skeletons,O,z),this.createAmbientLight(),this.setupMorphMaterials();var ie=new u().parse();i.children.length===1&&i.children[0].isGroup&&(i.children[0].animations=ie,i=i.children[0]),i.animations=ie},parseModels:function(D,O,k){var z=new Map,X=r.Objects.Model;for(var Z in X){var ie=parseInt(Z),se=X[Z],ue=n.get(ie),ye=this.buildSkeleton(ue,D,ie,se.attrName);if(!ye){switch(se.attrType){case"Camera":ye=this.createCamera(ue);break;case"Light":ye=this.createLight(ue);break;case"Mesh":ye=this.createMesh(ue,O,k);break;case"NurbsCurve":ye=this.createCurve(ue,O);break;case"LimbNode":case"Null":default:ye=new THREE.Group;break}ye.name=THREE.PropertyBinding.sanitizeNodeName(se.attrName),ye.ID=ie}this.setModelTransforms(ye,se),z.set(ie,ye)}return z},buildSkeleton:function(D,O,k,z){var X=null;return D.parents.forEach(function(Z){for(var ie in O){var se=O[ie];se.rawBones.forEach(function(ue,ye){if(ue.ID===Z.ID){var Ce=X;X=new THREE.Bone,X.matrixWorld.copy(ue.transformLink),X.name=THREE.PropertyBinding.sanitizeNodeName(z),X.ID=k,se.bones[ye]=X,Ce!==null&&X.add(Ce)}})}}),X},createCamera:function(D){var O,k;if(D.children.forEach(function(ke){var Oe=r.Objects.NodeAttribute[ke.ID];Oe!==void 0&&(k=Oe)}),k===void 0)O=new THREE.Object3D;else{var z=0;k.CameraProjectionType!==void 0&&k.CameraProjectionType.value===1&&(z=1);var X=1;k.NearPlane!==void 0&&(X=k.NearPlane.value/1e3);var Z=1e3;k.FarPlane!==void 0&&(Z=k.FarPlane.value/1e3);var ie=window.innerWidth,se=window.innerHeight;k.AspectWidth!==void 0&&k.AspectHeight!==void 0&&(ie=k.AspectWidth.value,se=k.AspectHeight.value);var ue=ie/se,ye=45;k.FieldOfView!==void 0&&(ye=k.FieldOfView.value);var Ce=k.FocalLength?k.FocalLength.value:null;switch(z){case 0:O=new THREE.PerspectiveCamera(ye,ue,X,Z),Ce!==null&&O.setFocalLength(Ce);break;case 1:O=new THREE.OrthographicCamera(-ie/2,ie/2,se/2,-se/2,X,Z);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+z+"."),O=new THREE.Object3D;break}}return O},createLight:function(D){var O,k;if(D.children.forEach(function(Ce){var ke=r.Objects.NodeAttribute[Ce.ID];ke!==void 0&&(k=ke)}),k===void 0)O=new THREE.Object3D;else{var z;k.LightType===void 0?z=0:z=k.LightType.value;var X=16777215;k.Color!==void 0&&(X=new THREE.Color().fromArray(k.Color.value));var Z=k.Intensity===void 0?1:k.Intensity.value/100;k.CastLightOnObject!==void 0&&k.CastLightOnObject.value===0&&(Z=0);var ie=0;k.FarAttenuationEnd!==void 0&&(k.EnableFarAttenuation!==void 0&&k.EnableFarAttenuation.value===0?ie=0:ie=k.FarAttenuationEnd.value);var se=1;switch(z){case 0:O=new THREE.PointLight(X,Z,ie,se);break;case 1:O=new THREE.DirectionalLight(X,Z);break;case 2:var ue=Math.PI/3;k.InnerAngle!==void 0&&(ue=THREE.Math.degToRad(k.InnerAngle.value));var ye=0;k.OuterAngle!==void 0&&(ye=THREE.Math.degToRad(k.OuterAngle.value),ye=Math.max(ye,1)),O=new THREE.SpotLight(X,Z,ie,ue,ye,se);break;default:console.warn("THREE.FBXLoader: Unknown light type "+k.LightType.value+", defaulting to a THREE.PointLight."),O=new THREE.PointLight(X,Z);break}k.CastShadows!==void 0&&k.CastShadows.value===1&&(O.castShadow=!0)}return O},createMesh:function(D,O,k){var z,X=null,Z=null,ie=[];return D.children.forEach(function(se){O.has(se.ID)&&(X=O.get(se.ID)),k.has(se.ID)&&ie.push(k.get(se.ID))}),ie.length>1?Z=ie:ie.length>0?Z=ie[0]:(Z=new THREE.MeshPhongMaterial({color:13421772}),ie.push(Z)),"color"in X.attributes&&ie.forEach(function(se){se.vertexColors=THREE.VertexColors}),X.FBX_Deformer?(ie.forEach(function(se){se.skinning=!0}),z=new THREE.SkinnedMesh(X,Z)):z=new THREE.Mesh(X,Z),z},createCurve:function(D,O){var k=D.children.reduce(function(X,Z){return O.has(Z.ID)&&(X=O.get(Z.ID)),X},null),z=new THREE.LineBasicMaterial({color:3342591,linewidth:1});return new THREE.Line(k,z)},setModelTransforms:function(D,O){var k={};"RotationOrder"in O&&(k.eulerOrder=parseInt(O.RotationOrder.value)),"Lcl_Translation"in O&&(k.translation=O.Lcl_Translation.value),"RotationOffset"in O&&(k.rotationOffset=O.RotationOffset.value),"Lcl_Rotation"in O&&(k.rotation=O.Lcl_Rotation.value),"PreRotation"in O&&(k.preRotation=O.PreRotation.value),"PostRotation"in O&&(k.postRotation=O.PostRotation.value),"Lcl_Scaling"in O&&(k.scale=O.Lcl_Scaling.value);var z=I(k);D.applyMatrix(z)},setLookAtProperties:function(D,O){if("LookAtProperty"in O){var k=n.get(D.ID).children;k.forEach(function(z){if(z.relationship==="LookAtProperty"){var X=r.Objects.Model[z.ID];if("Lcl_Translation"in X){var Z=X.Lcl_Translation.value;D.target!==void 0?(D.target.position.fromArray(Z),i.add(D.target)):D.lookAt(new THREE.Vector3().fromArray(Z))}}})}},bindSkeleton:function(D,O,k){var z=this.parsePoseNodes();for(var X in D){var Z=D[X],ie=n.get(parseInt(Z.ID)).parents;ie.forEach(function(se){if(O.has(se.ID)){var ue=se.ID,ye=n.get(ue);ye.parents.forEach(function(Ce){if(k.has(Ce.ID)){var ke=k.get(Ce.ID);ke.bind(new THREE.Skeleton(Z.bones),z[Ce.ID])}})}})}},parsePoseNodes:function(){var D={};if("Pose"in r.Objects){var O=r.Objects.Pose;for(var k in O)if(O[k].attrType==="BindPose"){var z=O[k].PoseNode;Array.isArray(z)?z.forEach(function(X){D[X.Node]=new THREE.Matrix4().fromArray(X.Matrix.a)}):D[z.Node]=new THREE.Matrix4().fromArray(z.Matrix.a)}}return D},createAmbientLight:function(){if("GlobalSettings"in r&&"AmbientColor"in r.GlobalSettings){var D=r.GlobalSettings.AmbientColor.value,O=D[0],k=D[1],z=D[2];if(O!==0||k!==0||z!==0){var X=new THREE.Color(O,k,z);i.add(new THREE.AmbientLight(X,1))}}},setupMorphMaterials:function(){i.traverse(function(D){if(D.isMesh&&(D.geometry.morphAttributes.position||D.geometry.morphAttributes.normal)){var O=D.uuid,k=D.material.uuid,z=!1;i.traverse(function(X){X.isMesh&&X.material.uuid===k&&X.uuid!==O&&(z=!0)}),z===!0&&(D.material=D.material.clone()),D.material.morphTargets=!0}})}};function a(){}a.prototype={constructor:a,parse:function(D){var O=new Map;if("Geometry"in r.Objects){var k=r.Objects.Geometry;for(var z in k){var X=n.get(parseInt(z)),Z=this.parseGeometry(X,k[z],D);O.set(parseInt(z),Z)}}return O},parseGeometry:function(D,O,k){switch(O.attrType){case"Mesh":return this.parseMeshGeometry(D,O,k);case"NurbsCurve":return this.parseNurbsGeometry(O)}},parseMeshGeometry:function(D,O,k){var z=k.skeletons,X=k.morphTargets,Z=D.parents.map(function(ke){return r.Objects.Model[ke.ID]});if(Z.length!==0){var ie=D.children.reduce(function(ke,Oe){return z[Oe.ID]!==void 0&&(ke=z[Oe.ID]),ke},null),se=D.children.reduce(function(ke,Oe){return X[Oe.ID]!==void 0&&(ke=X[Oe.ID]),ke},null),ue=Z[0],ye={};"RotationOrder"in ue&&(ye.eulerOrder=ue.RotationOrder.value),"GeometricTranslation"in ue&&(ye.translation=ue.GeometricTranslation.value),"GeometricRotation"in ue&&(ye.rotation=ue.GeometricRotation.value),"GeometricScaling"in ue&&(ye.scale=ue.GeometricScaling.value);var Ce=I(ye);return this.genGeometry(O,ie,se,Ce)}},genGeometry:function(D,O,k,z){var X=new THREE.BufferGeometry;D.attrName&&(X.name=D.attrName);var Z=this.parseGeoNode(D,O),ie=this.genBuffers(Z),se=new THREE.Float32BufferAttribute(ie.vertex,3);if(z.applyToBufferAttribute(se),X.addAttribute("position",se),ie.colors.length>0&&X.addAttribute("color",new THREE.Float32BufferAttribute(ie.colors,3)),O&&(X.addAttribute("skinIndex",new THREE.Uint16BufferAttribute(ie.weightsIndices,4)),X.addAttribute("skinWeight",new THREE.Float32BufferAttribute(ie.vertexWeights,4)),X.FBX_Deformer=O),ie.normal.length>0){var ue=new THREE.Float32BufferAttribute(ie.normal,3),ye=new THREE.Matrix3().getNormalMatrix(z);ye.applyToBufferAttribute(ue),X.addAttribute("normal",ue)}if(ie.uvs.forEach(function(He,Qe){var St="uv"+(Qe+1).toString();Qe===0&&(St="uv"),X.addAttribute(St,new THREE.Float32BufferAttribute(ie.uvs[Qe],2))}),Z.material&&Z.material.mappingType!=="AllSame"){var Ce=ie.materialIndex[0],ke=0;if(ie.materialIndex.forEach(function(He,Qe){He!==Ce&&(X.addGroup(ke,Qe-ke,Ce),Ce=He,ke=Qe)}),X.groups.length>0){var Oe=X.groups[X.groups.length-1],Ne=Oe.start+Oe.count;Ne!==ie.materialIndex.length&&X.addGroup(Ne,ie.materialIndex.length-Ne,Ce)}X.groups.length===0&&X.addGroup(0,ie.materialIndex.length,ie.materialIndex[0])}return this.addMorphTargets(X,D,k,z),X},parseGeoNode:function(D,O){var k={};if(k.vertexPositions=D.Vertices!==void 0?D.Vertices.a:[],k.vertexIndices=D.PolygonVertexIndex!==void 0?D.PolygonVertexIndex.a:[],D.LayerElementColor&&(k.color=this.parseVertexColors(D.LayerElementColor[0])),D.LayerElementMaterial&&(k.material=this.parseMaterialIndices(D.LayerElementMaterial[0])),D.LayerElementNormal&&(k.normal=this.parseNormals(D.LayerElementNormal[0])),D.LayerElementUV){k.uv=[];for(var z=0;D.LayerElementUV[z];)k.uv.push(this.parseUVs(D.LayerElementUV[z])),z++}return k.weightTable={},O!==null&&(k.skeleton=O,O.rawBones.forEach(function(X,Z){X.indices.forEach(function(ie,se){k.weightTable[ie]===void 0&&(k.weightTable[ie]=[]),k.weightTable[ie].push({id:Z,weight:X.weights[se]})})})),k},genBuffers:function(D){var O={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},k=0,z=0,X=!1,Z=[],ie=[],se=[],ue=[],ye=[],Ce=[],ke=this;return D.vertexIndices.forEach(function(Oe,Ne){var He=!1;Oe<0&&(Oe=Oe^-1,He=!0);var Qe=[],St=[];if(Z.push(Oe*3,Oe*3+1,Oe*3+2),D.color){var bt=E(Ne,k,Oe,D.color);se.push(bt[0],bt[1],bt[2])}if(D.skeleton){if(D.weightTable[Oe]!==void 0&&D.weightTable[Oe].forEach(function(Ue){St.push(Ue.weight),Qe.push(Ue.id)}),St.length>4){X||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),X=!0);var Jt=[0,0,0,0],sn=[0,0,0,0];St.forEach(function(Ue,At){var tt=Ue,pe=Qe[At];sn.forEach(function(ge,Fe,Re){if(tt>ge){Re[Fe]=tt,tt=ge;var ce=Jt[Fe];Jt[Fe]=pe,pe=ce}})}),Qe=Jt,St=sn}for(;St.length<4;)St.push(0),Qe.push(0);for(var Se=0;Se<4;++Se)ye.push(St[Se]),Ce.push(Qe[Se])}if(D.normal){var bt=E(Ne,k,Oe,D.normal);ie.push(bt[0],bt[1],bt[2])}if(D.material&&D.material.mappingType!=="AllSame")var qe=E(Ne,k,Oe,D.material)[0];D.uv&&D.uv.forEach(function(Ue,At){var tt=E(Ne,k,Oe,Ue);ue[At]===void 0&&(ue[At]=[]),ue[At].push(tt[0]),ue[At].push(tt[1])}),z++,He&&(ke.genFace(O,D,Z,qe,ie,se,ue,ye,Ce,z),k++,z=0,Z=[],ie=[],se=[],ue=[],ye=[],Ce=[])}),O},genFace:function(D,O,k,z,X,Z,ie,se,ue,ye){for(var Ce=2;Ce<ye;Ce++)D.vertex.push(O.vertexPositions[k[0]]),D.vertex.push(O.vertexPositions[k[1]]),D.vertex.push(O.vertexPositions[k[2]]),D.vertex.push(O.vertexPositions[k[(Ce-1)*3]]),D.vertex.push(O.vertexPositions[k[(Ce-1)*3+1]]),D.vertex.push(O.vertexPositions[k[(Ce-1)*3+2]]),D.vertex.push(O.vertexPositions[k[Ce*3]]),D.vertex.push(O.vertexPositions[k[Ce*3+1]]),D.vertex.push(O.vertexPositions[k[Ce*3+2]]),O.skeleton&&(D.vertexWeights.push(se[0]),D.vertexWeights.push(se[1]),D.vertexWeights.push(se[2]),D.vertexWeights.push(se[3]),D.vertexWeights.push(se[(Ce-1)*4]),D.vertexWeights.push(se[(Ce-1)*4+1]),D.vertexWeights.push(se[(Ce-1)*4+2]),D.vertexWeights.push(se[(Ce-1)*4+3]),D.vertexWeights.push(se[Ce*4]),D.vertexWeights.push(se[Ce*4+1]),D.vertexWeights.push(se[Ce*4+2]),D.vertexWeights.push(se[Ce*4+3]),D.weightsIndices.push(ue[0]),D.weightsIndices.push(ue[1]),D.weightsIndices.push(ue[2]),D.weightsIndices.push(ue[3]),D.weightsIndices.push(ue[(Ce-1)*4]),D.weightsIndices.push(ue[(Ce-1)*4+1]),D.weightsIndices.push(ue[(Ce-1)*4+2]),D.weightsIndices.push(ue[(Ce-1)*4+3]),D.weightsIndices.push(ue[Ce*4]),D.weightsIndices.push(ue[Ce*4+1]),D.weightsIndices.push(ue[Ce*4+2]),D.weightsIndices.push(ue[Ce*4+3])),O.color&&(D.colors.push(Z[0]),D.colors.push(Z[1]),D.colors.push(Z[2]),D.colors.push(Z[(Ce-1)*3]),D.colors.push(Z[(Ce-1)*3+1]),D.colors.push(Z[(Ce-1)*3+2]),D.colors.push(Z[Ce*3]),D.colors.push(Z[Ce*3+1]),D.colors.push(Z[Ce*3+2])),O.material&&O.material.mappingType!=="AllSame"&&(D.materialIndex.push(z),D.materialIndex.push(z),D.materialIndex.push(z)),O.normal&&(D.normal.push(X[0]),D.normal.push(X[1]),D.normal.push(X[2]),D.normal.push(X[(Ce-1)*3]),D.normal.push(X[(Ce-1)*3+1]),D.normal.push(X[(Ce-1)*3+2]),D.normal.push(X[Ce*3]),D.normal.push(X[Ce*3+1]),D.normal.push(X[Ce*3+2])),O.uv&&O.uv.forEach(function(ke,Oe){D.uvs[Oe]===void 0&&(D.uvs[Oe]=[]),D.uvs[Oe].push(ie[Oe][0]),D.uvs[Oe].push(ie[Oe][1]),D.uvs[Oe].push(ie[Oe][(Ce-1)*2]),D.uvs[Oe].push(ie[Oe][(Ce-1)*2+1]),D.uvs[Oe].push(ie[Oe][Ce*2]),D.uvs[Oe].push(ie[Oe][Ce*2+1])})},addMorphTargets:function(D,O,k,z){if(k!==null){D.morphAttributes.position=[],D.morphAttributes.normal=[];var X=this;k.rawTargets.forEach(function(Z){var ie=r.Objects.Geometry[Z.geoID];ie!==void 0&&X.genMorphGeometry(D,O,ie,z)})}},genMorphGeometry:function(D,O,k,z){var X=new THREE.BufferGeometry;k.attrName&&(X.name=k.attrName);for(var Z=O.PolygonVertexIndex!==void 0?O.PolygonVertexIndex.a:[],ie=O.Vertices!==void 0?O.Vertices.a.slice():[],se=k.Vertices!==void 0?k.Vertices.a:[],ue=k.Indexes!==void 0?k.Indexes.a:[],ye=0;ye<ue.length;ye++){var Ce=ue[ye]*3;ie[Ce]+=se[ye*3],ie[Ce+1]+=se[ye*3+1],ie[Ce+2]+=se[ye*3+2]}var ke={vertexIndices:Z,vertexPositions:ie},Oe=this.genBuffers(ke),Ne=new THREE.Float32BufferAttribute(Oe.vertex,3);Ne.name=k.attrName,z.applyToBufferAttribute(Ne),D.morphAttributes.position.push(Ne)},parseNormals:function(D){var O=D.MappingInformationType,k=D.ReferenceInformationType,z=D.Normals.a,X=[];return k==="IndexToDirect"&&("NormalIndex"in D?X=D.NormalIndex.a:"NormalsIndex"in D&&(X=D.NormalsIndex.a)),{dataSize:3,buffer:z,indices:X,mappingType:O,referenceType:k}},parseUVs:function(D){var O=D.MappingInformationType,k=D.ReferenceInformationType,z=D.UV.a,X=[];return k==="IndexToDirect"&&(X=D.UVIndex.a),{dataSize:2,buffer:z,indices:X,mappingType:O,referenceType:k}},parseVertexColors:function(D){var O=D.MappingInformationType,k=D.ReferenceInformationType,z=D.Colors.a,X=[];return k==="IndexToDirect"&&(X=D.ColorIndex.a),{dataSize:4,buffer:z,indices:X,mappingType:O,referenceType:k}},parseMaterialIndices:function(D){var O=D.MappingInformationType,k=D.ReferenceInformationType;if(O==="NoMappingInformation")return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:k};for(var z=D.Materials.a,X=[],Z=0;Z<z.length;++Z)X.push(Z);return{dataSize:1,buffer:z,indices:X,mappingType:O,referenceType:k}},parseNurbsGeometry:function(D){if(THREE.NURBSCurve===void 0)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new THREE.BufferGeometry;var O=parseInt(D.Order);if(isNaN(O))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",D.Order,D.id),new THREE.BufferGeometry;for(var k=O-1,z=D.KnotVector.a,X=[],Z=D.Points.a,ie=0,se=Z.length;ie<se;ie+=4)X.push(new THREE.Vector4().fromArray(Z,ie));var ue,ye;if(D.Form==="Closed")X.push(X[0]);else if(D.Form==="Periodic"){ue=k,ye=z.length-1-ue;for(var ie=0;ie<k;++ie)X.push(X[ie])}var Ce=new THREE.NURBSCurve(k,z,X,ue,ye),ke=Ce.getPoints(X.length*7),Oe=new Float32Array(ke.length*3);ke.forEach(function(He,Qe){He.toArray(Oe,Qe*3)});var Ne=new THREE.BufferGeometry;return Ne.addAttribute("position",new THREE.BufferAttribute(Oe,3)),Ne}};function u(){}u.prototype={constructor:u,parse:function(){var D=[],O=this.parseClips();if(O===void 0)return D;for(var k in O){var z=O[k],X=this.addClip(z);D.push(X)}return D},parseClips:function(){if(r.Objects.AnimationCurve!==void 0){var D=this.parseAnimationCurveNodes();this.parseAnimationCurves(D);var O=this.parseAnimationLayers(D),k=this.parseAnimStacks(O);return k}},parseAnimationCurveNodes:function(){var D=r.Objects.AnimationCurveNode,O=new Map;for(var k in D){var z=D[k];if(z.attrName.match(/S|R|T|DeformPercent/)!==null){var X={id:z.id,attr:z.attrName,curves:{}};O.set(X.id,X)}}return O},parseAnimationCurves:function(D){var O=r.Objects.AnimationCurve;for(var k in O){var z={id:O[k].id,times:O[k].KeyTime.a.map(A),values:O[k].KeyValueFloat.a},X=n.get(z.id);if(X!==void 0){var Z=X.parents[0].ID,ie=X.parents[0].relationship;ie.match(/X/)?D.get(Z).curves.x=z:ie.match(/Y/)?D.get(Z).curves.y=z:ie.match(/Z/)?D.get(Z).curves.z=z:ie.match(/d|DeformPercent/)&&D.has(Z)&&(D.get(Z).curves.morph=z)}}},parseAnimationLayers:function(D){var O=r.Objects.AnimationLayer,k=new Map;for(var z in O){var X=[],Z=n.get(parseInt(z));if(Z!==void 0){var ie=Z.children,se=this;ie.forEach(function(ue,ye){if(D.has(ue.ID)){var Ce=D.get(ue.ID);if(Ce.curves.x!==void 0||Ce.curves.y!==void 0||Ce.curves.z!==void 0){if(X[ye]===void 0){var ke;n.get(ue.ID).parents.forEach(function(bt){bt.relationship!==void 0&&(ke=bt.ID)});var Oe=r.Objects.Model[ke.toString()],Ne={modelName:THREE.PropertyBinding.sanitizeNodeName(Oe.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1],transform:se.getModelAnimTransform(Oe)};"PreRotation"in Oe&&(Ne.preRotations=Oe.PreRotation.value),"PostRotation"in Oe&&(Ne.postRotations=Oe.PostRotation.value),X[ye]=Ne}X[ye][Ce.attr]=Ce}else if(Ce.curves.morph!==void 0){if(X[ye]===void 0){var He;n.get(ue.ID).parents.forEach(function(Se){Se.relationship!==void 0&&(He=Se.ID)});var Qe=n.get(He).parents[0].ID,St=n.get(Qe).parents[0].ID,ke=n.get(St).parents[0].ID,Oe=r.Objects.Model[ke],Ne={modelName:THREE.PropertyBinding.sanitizeNodeName(Oe.attrName),morphName:r.Objects.Deformer[He].attrName};X[ye]=Ne}X[ye][Ce.attr]=Ce}}}),k.set(parseInt(z),X)}}return k},getModelAnimTransform:function(D){var O={};return"RotationOrder"in D&&(O.eulerOrder=parseInt(D.RotationOrder.value)),"Lcl_Translation"in D&&(O.translation=D.Lcl_Translation.value),"RotationOffset"in D&&(O.rotationOffset=D.RotationOffset.value),"Lcl_Rotation"in D&&(O.rotation=D.Lcl_Rotation.value),"PreRotation"in D&&(O.preRotation=D.PreRotation.value),"PostRotation"in D&&(O.postRotation=D.PostRotation.value),"Lcl_Scaling"in D&&(O.scale=D.Lcl_Scaling.value),I(O)},parseAnimStacks:function(D){var O=r.Objects.AnimationStack,k={};for(var z in O){var X=n.get(parseInt(z)).children;X.length>1&&console.warn("THREE.FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var Z=D.get(X[0].ID);k[z]={name:O[z].attrName,layer:Z}}return k},addClip:function(D){var O=[],k=this;return D.layer.forEach(function(z){O=O.concat(k.generateTracks(z))}),new THREE.AnimationClip(D.name,-1,O)},generateTracks:function(D){var O=[],k=new THREE.Vector3,z=new THREE.Quaternion,X=new THREE.Vector3;if(D.transform&&D.transform.decompose(k,z,X),k=k.toArray(),z=new THREE.Euler().setFromQuaternion(z).toArray(),X=X.toArray(),D.T!==void 0&&Object.keys(D.T.curves).length>0){var Z=this.generateVectorTrack(D.modelName,D.T.curves,k,"position");Z!==void 0&&O.push(Z)}if(D.R!==void 0&&Object.keys(D.R.curves).length>0){var ie=this.generateRotationTrack(D.modelName,D.R.curves,z,D.preRotations,D.postRotations);ie!==void 0&&O.push(ie)}if(D.S!==void 0&&Object.keys(D.S.curves).length>0){var se=this.generateVectorTrack(D.modelName,D.S.curves,X,"scale");se!==void 0&&O.push(se)}if(D.DeformPercent!==void 0){var ue=this.generateMorphTrack(D);ue!==void 0&&O.push(ue)}return O},generateVectorTrack:function(D,O,k,z){var X=this.getTimesForAllAxes(O),Z=this.getKeyframeTrackValues(X,O,k);return new THREE.VectorKeyframeTrack(D+"."+z,X,Z)},generateRotationTrack:function(D,O,k,z,X){O.x!==void 0&&(this.interpolateRotations(O.x),O.x.values=O.x.values.map(THREE.Math.degToRad)),O.y!==void 0&&(this.interpolateRotations(O.y),O.y.values=O.y.values.map(THREE.Math.degToRad)),O.z!==void 0&&(this.interpolateRotations(O.z),O.z.values=O.z.values.map(THREE.Math.degToRad));var Z=this.getTimesForAllAxes(O),ie=this.getKeyframeTrackValues(Z,O,k);z!==void 0&&(z=z.map(THREE.Math.degToRad),z.push("ZYX"),z=new THREE.Euler().fromArray(z),z=new THREE.Quaternion().setFromEuler(z)),X!==void 0&&(X=X.map(THREE.Math.degToRad),X.push("ZYX"),X=new THREE.Euler().fromArray(X),X=new THREE.Quaternion().setFromEuler(X).inverse());for(var se=new THREE.Quaternion,ue=new THREE.Euler,ye=[],Ce=0;Ce<ie.length;Ce+=3)ue.set(ie[Ce],ie[Ce+1],ie[Ce+2],"ZYX"),se.setFromEuler(ue),z!==void 0&&se.premultiply(z),X!==void 0&&se.multiply(X),se.toArray(ye,Ce/3*4);return new THREE.QuaternionKeyframeTrack(D+".quaternion",Z,ye)},generateMorphTrack:function(D){var O=D.DeformPercent.curves.morph,k=O.values.map(function(X){return X/100}),z=i.getObjectByName(D.modelName).morphTargetDictionary[D.morphName];return new THREE.NumberKeyframeTrack(D.modelName+".morphTargetInfluences["+z+"]",O.times,k)},getTimesForAllAxes:function(D){var O=[];return D.x!==void 0&&(O=O.concat(D.x.times)),D.y!==void 0&&(O=O.concat(D.y.times)),D.z!==void 0&&(O=O.concat(D.z.times)),O=O.sort(function(k,z){return k-z}).filter(function(k,z,X){return X.indexOf(k)==z}),O},getKeyframeTrackValues:function(D,O,k){var z=k,X=[],Z=-1,ie=-1,se=-1;return D.forEach(function(ue){if(O.x&&(Z=O.x.times.indexOf(ue)),O.y&&(ie=O.y.times.indexOf(ue)),O.z&&(se=O.z.times.indexOf(ue)),Z!==-1){var ye=O.x.values[Z];X.push(ye),z[0]=ye}else X.push(z[0]);if(ie!==-1){var Ce=O.y.values[ie];X.push(Ce),z[1]=Ce}else X.push(z[1]);if(se!==-1){var ke=O.z.values[se];X.push(ke),z[2]=ke}else X.push(z[2])}),X},interpolateRotations:function(D){for(var O=1;O<D.values.length;O++){var k=D.values[O-1],z=D.values[O]-k,X=Math.abs(z);if(X>=180){for(var Z=X/180,ie=z/Z,se=k+ie,ue=D.times[O-1],ye=D.times[O]-ue,Ce=ye/Z,ke=ue+Ce,Oe=[],Ne=[];ke<D.times[O];)Oe.push(ke),ke+=Ce,Ne.push(se),se+=ie;D.times=ne(D.times,O,Oe),D.values=ne(D.values,O,Ne)}}}};function h(){}h.prototype={constructor:h,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(D){this.nodeStack.push(D),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(D,O){this.currentProp=D,this.currentPropName=O},parse:function(D){this.currentIndent=0,console.log("FBXTree: ",m),this.allNodes=new m,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var O=this,k=D.split(/[\r\n]+/);return k.forEach(function(z,X){var Z=z.match(/^[\s\t]*;/),ie=z.match(/^[\s\t]*$/);if(!(Z||ie)){var se=z.match("^\\t{"+O.currentIndent+"}(\\w+):(.*){",""),ue=z.match("^\\t{"+O.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),ye=z.match("^\\t{"+(O.currentIndent-1)+"}}");se?O.parseNodeBegin(z,se):ue?O.parseNodeProperty(z,ue,k[++X]):ye?O.popStack():z.match(/^[^\s\t}]/)&&O.parseNodePropertyContinued(z)}}),this.allNodes},parseNodeBegin:function(D,O){var k=O[1].trim().replace(/^"/,"").replace(/"$/,""),z=O[2].split(",").map(function(se){return se.trim().replace(/^"/,"").replace(/"$/,"")}),X={name:k},Z=this.parseNodeAttr(z),ie=this.getCurrentNode();this.currentIndent===0?this.allNodes.add(k,X):k in ie?(k==="PoseNode"?ie.PoseNode.push(X):ie[k].id!==void 0&&(ie[k]={},ie[k][ie[k].id]=ie[k]),Z.id!==""&&(ie[k][Z.id]=X)):typeof Z.id=="number"?(ie[k]={},ie[k][Z.id]=X):k!=="Properties70"&&(k==="PoseNode"?ie[k]=[X]:ie[k]=X),typeof Z.id=="number"&&(X.id=Z.id),Z.name!==""&&(X.attrName=Z.name),Z.type!==""&&(X.attrType=Z.type),this.pushStack(X)},parseNodeAttr:function(D){var O=D[0];D[0]!==""&&(O=parseInt(D[0]),isNaN(O)&&(O=D[0]));var k="",z="";return D.length>1&&(k=D[1].replace(/^(\w+)::/,""),z=D[2]),{id:O,name:k,type:z}},parseNodeProperty:function(D,O,k){var z=O[1].replace(/^"/,"").replace(/"$/,"").trim(),X=O[2].replace(/^"/,"").replace(/"$/,"").trim();z==="Content"&&X===","&&(X=k.replace(/"/g,"").replace(/,$/,"").trim());var Z=this.getCurrentNode(),ie=Z.name;if(ie==="Properties70"){this.parseNodeSpecialProperty(D,z,X);return}if(z==="C"){var se=X.split(",").slice(1),ue=parseInt(se[0]),ye=parseInt(se[1]),Ce=X.split(",").slice(3);Ce=Ce.map(function(ke){return ke.trim().replace(/^"/,"")}),z="connections",X=[ue,ye],q(X,Ce),Z[z]===void 0&&(Z[z]=[])}z==="Node"&&(Z.id=X),z in Z&&Array.isArray(Z[z])?Z[z].push(X):z!=="a"?Z[z]=X:Z.a=X,this.setCurrentProp(Z,z),z==="a"&&X.slice(-1)!==","&&(Z.a=B(X))},parseNodePropertyContinued:function(D){var O=this.getCurrentNode();O.a+=D,D.slice(-1)!==","&&(O.a=B(O.a))},parseNodeSpecialProperty:function(D,O,k){var z=k.split('",').map(function(ye){return ye.trim().replace(/^\"/,"").replace(/\s/,"_")}),X=z[0],Z=z[1],ie=z[2],se=z[3],ue=z[4];switch(Z){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":ue=parseFloat(ue);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":ue=B(ue);break}this.getPrevNode()[X]={type:Z,type2:ie,flag:se,value:ue},this.setCurrentProp(this.getPrevNode(),X)}};function f(){}f.prototype={constructor:f,parse:function(D){var O=new d(D);O.skip(23);var k=O.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+k);for(var z=new m;!this.endOfContent(O);){var X=this.parseNode(O,k);X!==null&&z.add(X.name,X)}return z},endOfContent:function(D){return D.size()%16===0?(D.getOffset()+160+16&-16)>=D.size():D.getOffset()+160+16>=D.size()},parseNode:function(D,O){var k={},z=O>=7500?D.getUint64():D.getUint32(),X=O>=7500?D.getUint64():D.getUint32();O>=7500?D.getUint64():D.getUint32();var Z=D.getUint8(),ie=D.getString(Z);if(z===0)return null;for(var se=[],ue=0;ue<X;ue++)se.push(this.parseProperty(D));var ye=se.length>0?se[0]:"",Ce=se.length>1?se[1]:"",ke=se.length>2?se[2]:"";for(k.singleProperty=X===1&&D.getOffset()===z;z>D.getOffset();){var Oe=this.parseNode(D,O);Oe!==null&&this.parseSubNode(ie,k,Oe)}return k.propertyList=se,typeof ye=="number"&&(k.id=ye),Ce!==""&&(k.attrName=Ce),ke!==""&&(k.attrType=ke),ie!==""&&(k.name=ie),k},parseSubNode:function(D,O,k){if(k.singleProperty===!0){var z=k.propertyList[0];Array.isArray(z)?(O[k.name]=k,k.a=z):O[k.name]=z}else if(D==="Connections"&&k.name==="C"){var X=[];k.propertyList.forEach(function(ke,Oe){Oe!==0&&X.push(ke)}),O.connections===void 0&&(O.connections=[]),O.connections.push(X)}else if(k.name==="Properties70"){var Z=Object.keys(k);Z.forEach(function(ke){O[ke]=k[ke]})}else if(D==="Properties70"&&k.name==="P"){var ie=k.propertyList[0],se=k.propertyList[1],ue=k.propertyList[2],ye=k.propertyList[3],Ce;ie.indexOf("Lcl ")===0&&(ie=ie.replace("Lcl ","Lcl_")),se.indexOf("Lcl ")===0&&(se=se.replace("Lcl ","Lcl_")),se==="Color"||se==="ColorRGB"||se==="Vector"||se==="Vector3D"||se.indexOf("Lcl_")===0?Ce=[k.propertyList[4],k.propertyList[5],k.propertyList[6]]:Ce=k.propertyList[4],O[ie]={type:se,type2:ue,flag:ye,value:Ce}}else O[k.name]===void 0?typeof k.id=="number"?(O[k.name]={},O[k.name][k.id]=k):O[k.name]=k:k.name==="PoseNode"?(Array.isArray(O[k.name])||(O[k.name]=[O[k.name]]),O[k.name].push(k)):O[k.name][k.id]===void 0&&(O[k.name][k.id]=k)},parseProperty:function(D){var O=D.getString(1);switch(O){case"C":return D.getBoolean();case"D":return D.getFloat64();case"F":return D.getFloat32();case"I":return D.getInt32();case"L":return D.getInt64();case"R":var k=D.getUint32();return D.getArrayBuffer(k);case"S":var k=D.getUint32();return D.getString(k);case"Y":return D.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var z=D.getUint32(),X=D.getUint32(),Z=D.getUint32();if(X===0)switch(O){case"b":case"c":return D.getBooleanArray(z);case"d":return D.getFloat64Array(z);case"f":return D.getFloat32Array(z);case"i":return D.getInt32Array(z);case"l":return D.getInt64Array(z)}typeof Zlib>"u"&&console.error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var ie=new Zlib.Inflate(new Uint8Array(D.getArrayBuffer(Z))),se=new d(ie.decompress().buffer);switch(O){case"b":case"c":return se.getBooleanArray(z);case"d":return se.getFloat64Array(z);case"f":return se.getFloat32Array(z);case"i":return se.getInt32Array(z);case"l":return se.getInt64Array(z)}default:throw new Error("THREE.FBXLoader: Unknown property type "+O)}}};function d(D,O){this.dv=new DataView(D),this.offset=0,this.littleEndian=O!==void 0?O:!0}d.prototype={constructor:d,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(D){this.offset+=D},getBoolean:function(){return(this.getUint8()&1)===1},getBooleanArray:function(D){for(var O=[],k=0;k<D;k++)O.push(this.getBoolean());return O},getUint8:function(){var D=this.dv.getUint8(this.offset);return this.offset+=1,D},getInt16:function(){var D=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,D},getInt32:function(){var D=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,D},getInt32Array:function(D){for(var O=[],k=0;k<D;k++)O.push(this.getInt32());return O},getUint32:function(){var D=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,D},getInt64:function(){var D,O;return this.littleEndian?(D=this.getUint32(),O=this.getUint32()):(O=this.getUint32(),D=this.getUint32()),O&2147483648?(O=~O&4294967295,D=~D&4294967295,D===4294967295&&(O=O+1&4294967295),D=D+1&4294967295,-(O*4294967296+D)):O*4294967296+D},getInt64Array:function(D){for(var O=[],k=0;k<D;k++)O.push(this.getInt64());return O},getUint64:function(){var D,O;return this.littleEndian?(D=this.getUint32(),O=this.getUint32()):(O=this.getUint32(),D=this.getUint32()),O*4294967296+D},getFloat32:function(){var D=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,D},getFloat32Array:function(D){for(var O=[],k=0;k<D;k++)O.push(this.getFloat32());return O},getFloat64:function(){var D=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,D},getFloat64Array:function(D){for(var O=[],k=0;k<D;k++)O.push(this.getFloat64());return O},getArrayBuffer:function(D){var O=this.dv.buffer.slice(this.offset,this.offset+D);return this.offset+=D,O},getString:function(D){for(var O=[],k=0;k<D;k++)O[k]=this.getUint8();var z=O.indexOf(0);return z>=0&&(O=O.slice(0,z)),THREE.LoaderUtils.decodeText(new Uint8Array(O))}};function m(){}m.prototype={constructor:m,add:function(D,O){this[D]=O}};function g(D){var O="Kaydara FBX Binary  \0";return D.byteLength>=O.length&&O===H(D,0,O.length)}function x(D){var O=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],k=0;function z(ie){var se=D[ie-1];return D=D.slice(k+ie),k++,se}for(var X=0;X<O.length;++X){var Z=z(1);if(Z===O[X])return!1}return!0}function v(D){var O=/FBXVersion: (\d+)/,k=D.match(O);if(k){var z=parseInt(k[1]);return z}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function A(D){return D/46186158e3}var _=[];function E(D,O,k,z){var X;switch(z.mappingType){case"ByPolygonVertex":X=D;break;case"ByPolygon":X=O;break;case"ByVertice":X=k;break;case"AllSame":X=z.indices[0];break;default:console.warn("THREE.FBXLoader: unknown attribute mapping type "+z.mappingType)}z.referenceType==="IndexToDirect"&&(X=z.indices[X]);var Z=X*z.dataSize,ie=Z+z.dataSize;return le(_,z.buffer,Z,ie)}var w=new THREE.Matrix4,S=new THREE.Euler,T=new THREE.Vector3,R=new THREE.Vector3,L=new THREE.Matrix4;function I(D){var O=new THREE.Matrix4;R.set(0,0,0),L.identity();var k=D.eulerOrder?N(D.eulerOrder):N(0);if(D.translation&&R.fromArray(D.translation),D.rotationOffset&&R.add(T.fromArray(D.rotationOffset)),D.rotation){var z=D.rotation.map(THREE.Math.degToRad);z.push(k),L.makeRotationFromEuler(S.fromArray(z))}if(D.preRotation){var z=D.preRotation.map(THREE.Math.degToRad);z.push(k),w.makeRotationFromEuler(S.fromArray(z)),L.premultiply(w)}if(D.postRotation){var z=D.postRotation.map(THREE.Math.degToRad);z.push(k),w.makeRotationFromEuler(S.fromArray(z)),w.getInverse(w),L.multiply(w)}return D.scale&&O.scale(T.fromArray(D.scale)),O.setPosition(R),O.multiply(L),O}function N(D){var O=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return D===6?(console.warn("THREE.FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),O[0]):O[D]}function B(D){var O=D.split(",").map(function(k){return parseFloat(k)});return O}function H(D,O,k){return O===void 0&&(O=0),k===void 0&&(k=D.byteLength),THREE.LoaderUtils.decodeText(new Uint8Array(D,O,k))}function q(D,O){for(var k=0,z=D.length,X=O.length;k<X;k++,z++)D[z]=O[k]}function le(D,O,k,z){for(var X=k,Z=0;X<z;X++,Z++)D[Z]=O[X];return D}function ne(D,O,k){return D.slice(0,O).concat(k).concat(D.slice(O))}return o}();THREE.FBXLoader=PH;AFRAME.registerComponent("fbx-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){const r=this.data;if(!r.src)return;this.remove();const n=new THREE.FBXLoader;r.crossorigin&&n.setCrossOrigin(r.crossorigin),n.load(r.src,this.load.bind(this))},load:function(r){this.model=r,this.el.setObject3D("mesh",r),this.el.emit("model-loaded",{format:"fbx",model:r})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});function DH(){return"script_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function OH(r,n){var i=document.createElement("script");return i.type="text/javascript",i.async=!0,i.id=n,i.src=r,i}function mb(r){const n=document.getElementById(r),i=n.parentNode;try{i&&i.removeChild(n)}catch{}}function IH(r){const n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(r,n)}function kH(r,n,i){return new i(function(o,l){const a=n.timeout||5e3,u=DH(),h=OH(r,u),f=setTimeout(function(){l(new Error("Script request to "+r+" timed out")),mb(u)},a),d=function(m){clearTimeout(m)};h.addEventListener("load",function(m){o({ok:!0}),d(f),mb(u)}),h.addEventListener("error",function(m){l(new Error("Script request to "+r+" failed "+m)),d(f),mb(u)}),IH(h)})}function NH(r){return r=r||{},function(n,i){return i=i||{},kH(n,i,r.Promise||Promise)}}var FH=NH;const BH=FH(),UH="https://cdn.jsdelivr.net/gh/mrdoob/three.js@r86/examples/js/loaders/GLTFLoader.js",zH=function(){let r;return function(){return r=r||BH(UH),r}}();AFRAME.registerComponent("gltf-model-legacy",{schema:{type:"model"},init:function(){this.model=null,this.loader=null,this.loaderPromise=zH().then(()=>{this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("Anonymous")})},update:function(){const r=this,n=this.el,i=this.data;!i||(this.remove(),this.loaderPromise.then(()=>{this.loader.load(i,function(l){r.model=l.scene,r.model.animations=l.animations,n.setObject3D("mesh",r.model),n.emit("model-loaded",{format:"gltf",model:r.model})})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}});AFRAME.registerComponent("object-model",{schema:{src:{type:"asset"},crossorigin:{default:""}},init:function(){this.model=null},update:function(){let r;const n=this.data;!n.src||(this.remove(),r=new THREE.ObjectLoader,n.crossorigin&&r.setCrossOrigin(n.crossorigin),r.load(n.src,i=>{i.traverse(o=>{o instanceof THREE.SkinnedMesh&&o.material&&(o.material.skinning=!!(o.geometry&&o.geometry.bones||[]).length)}),this.load(i)}))},load:function(r){this.model=r,this.el.setObject3D("mesh",r),this.el.emit("model-loaded",{format:"json",model:r})},remove:function(){this.model&&this.el.removeObject3D("mesh")}});AFRAME.registerComponent("checkpoint",{schema:{offset:{default:{x:0,y:0,z:0},type:"vec3"}},init:function(){this.active=!1,this.targetEl=null,this.fire=this.fire.bind(this),this.offset=new THREE.Vector3},update:function(){this.offset.copy(this.data.offset)},play:function(){this.el.addEventListener("click",this.fire)},pause:function(){this.el.removeEventListener("click",this.fire)},remove:function(){this.pause()},fire:function(){const r=this.el.sceneEl.querySelector("[checkpoint-controls]");if(!r)throw new Error("No `checkpoint-controls` component found.");r.components["checkpoint-controls"].setCheckpoint(this.el)},getOffset:function(){return this.offset.copy(this.data.offset)}});function HH(r){return r?Array.isArray(r)?r:r.materials?r.materials:[r]:[]}function rp(r,n,i,o){!r||(n=n||[],r.traverse(l=>{if(!l.isMesh)return;HH(l.material).forEach(u=>{u&&!("envMap"in u)||n.length&&n.indexOf(u.name)===-1||(u.envMap=i,u.reflectivity=o,u.needsUpdate=!0)})}))}AFRAME.registerComponent("cube-env-map",{multiple:!0,schema:{path:{default:""},extension:{default:"jpg",oneOf:["jpg","png"]},format:{default:"RGBFormat",oneOf:["RGBFormat","RGBAFormat"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},init:function(){const r=this.data;this.texture=new THREE.CubeTextureLoader().load([r.path+"posx."+r.extension,r.path+"negx."+r.extension,r.path+"posy."+r.extension,r.path+"negy."+r.extension,r.path+"posz."+r.extension,r.path+"negz."+r.extension]),this.texture.format=THREE[r.format],this.object3dsetHandler=()=>{const n=this.el.getObject3D("mesh"),i=this.data;rp(n,i.materials,this.texture,i.reflectivity)},this.el.addEventListener("object3dset",this.object3dsetHandler)},update:function(r){const n=this.data,i=this.el.getObject3D("mesh");let o=[],l=[];if(n.materials.length&&(r.materials?(o=n.materials.filter(a=>!r.materials.includes(a)),l=r.materials.filter(a=>!n.materials.includes(a))):o=n.materials),o.length&&rp(i,o,this.texture,n.reflectivity),l.length&&rp(i,l,null,1),r.materials&&n.reflectivity!==r.reflectivity){const a=n.materials.filter(u=>r.materials.includes(u));a.length&&rp(i,a,this.texture,n.reflectivity)}this.data.enableBackground&&!r.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&r.enableBackground&&this.setBackground(null)},remove:function(){this.el.removeEventListener("object3dset",this.object3dsetHandler);const r=this.el.getObject3D("mesh"),n=this.data;rp(r,n.materials,null,1),n.enableBackground&&this.setBackground(null)},setBackground:function(r){this.el.sceneEl.object3D.background=r}});AFRAME.registerComponent("grab",{init:function(){this.system=this.el.sceneEl.systems.physics,this.GRABBED_STATE="grabbed",this.grabbing=!1,this.hitEl=null,this.physics=this.el.sceneEl.systems.physics,this.constraint=null,this.onHit=this.onHit.bind(this),this.onGripOpen=this.onGripOpen.bind(this),this.onGripClose=this.onGripClose.bind(this)},play:function(){const r=this.el;r.addEventListener("hit",this.onHit),r.addEventListener("gripdown",this.onGripClose),r.addEventListener("gripup",this.onGripOpen),r.addEventListener("trackpaddown",this.onGripClose),r.addEventListener("trackpadup",this.onGripOpen),r.addEventListener("triggerdown",this.onGripClose),r.addEventListener("triggerup",this.onGripOpen)},pause:function(){const r=this.el;r.removeEventListener("hit",this.onHit),r.removeEventListener("gripdown",this.onGripClose),r.removeEventListener("gripup",this.onGripOpen),r.removeEventListener("trackpaddown",this.onGripClose),r.removeEventListener("trackpadup",this.onGripOpen),r.removeEventListener("triggerdown",this.onGripClose),r.removeEventListener("triggerup",this.onGripOpen)},onGripClose:function(){this.grabbing=!0},onGripOpen:function(){const r=this.hitEl;this.grabbing=!1,r&&(r.removeState(this.GRABBED_STATE),this.hitEl=void 0,this.system.removeConstraint(this.constraint),this.constraint=null)},onHit:function(r){const n=r.detail.el;!n||n.is(this.GRABBED_STATE)||!this.grabbing||this.hitEl||(n.addState(this.GRABBED_STATE),this.hitEl=n,this.constraint=new CANNON.LockConstraint(this.el.body,n.body),this.system.addConstraint(this.constraint))}});const GH=-9.8,VH=-15;AFRAME.registerComponent("jump-ability",{dependencies:["velocity"],schema:{on:{default:"keydown:Space gamepadbuttondown:0"},playerHeight:{default:1.764},maxJumps:{default:1},distance:{default:5},debug:{default:!1}},init:function(){this.velocity=0,this.numJumps=0;const r=this.beginJump.bind(this),n=this.data.on.split(" ");this.bindings={};for(let i=0;i<n.length;i++)this.bindings[n[i]]=r,this.el.addEventListener(n[i],r);this.bindings.collide=this.onCollide.bind(this),this.el.addEventListener("collide",this.bindings.collide)},remove:function(){for(var r in this.bindings)this.bindings.hasOwnProperty(r)&&(this.el.removeEventListener(r,this.bindings[r]),delete this.bindings[r]);this.el.removeEventListener("collide",this.bindings.collide),delete this.bindings.collide},beginJump:function(){if(this.numJumps<this.data.maxJumps){const r=this.data,n=Math.sqrt(-2*r.distance*(GH+VH)),i=this.el.getAttribute("velocity");this.el.setAttribute("velocity",{x:i.x,y:n,z:i.z}),this.numJumps++,this.el.emit("jumpstart")}},onCollide:function(){this.numJumps>0&&this.el.emit("jumpend"),this.numJumps=0}});const AC=1e-6;AFRAME.registerComponent("kinematic-body",{dependencies:["velocity"],schema:{mass:{default:5},radius:{default:1.3},linearDamping:{default:.05},enableSlopes:{default:!0},enableJumps:{default:!1}},init:function(){this.system=this.el.sceneEl.systems.physics,this.system.addComponent(this);const r=this.el,n=this.data,i=new CANNON.Vec3().copy(r.object3D.getWorldPosition(new THREE.Vector3));this.body=new CANNON.Body({material:this.system.getMaterial("staticMaterial"),position:i,mass:n.mass,linearDamping:n.linearDamping,fixedRotation:!0}),this.body.addShape(new CANNON.Sphere(n.radius),new CANNON.Vec3(0,n.radius,0)),this.body.el=this.el,this.el.body=this.body,this.system.addBody(this.body),r.hasAttribute("wasd-controls")&&console.warn("[kinematic-body] Not compatible with wasd-controls, use movement-controls.")},remove:function(){this.system.removeBody(this.body),this.system.removeComponent(this),delete this.el.body},beforeStep:function(r,n){if(!n)return;const i=this.el,o=this.data,l=this.body;o.enableJumps||l.velocity.set(0,0,0),l.position.copy(i.getAttribute("position"))},step:function(){const r=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Vector3;return function(l,a){if(!a)return;let u=this.body,h=this.data,f=!1,d,m=-1/0,g,x=this.system.getContacts();a=Math.min(a,this.system.data.maxInterval*1e3),o.set(0,0,0),r.copy(this.el.getAttribute("velocity")),u.velocity.copy(r);for(var v=0,A;A=x[v];v++)if(!!A.enabled){if(u.id===A.bi.id)A.ni.negate(i);else if(u.id===A.bj.id)i.copy(A.ni);else continue;f=u.velocity.dot(i)<-AC,f&&i.y<=.5?r.projectOnPlane(i):i.y>.5&&(d=u.id===A.bi.id?Math.abs(A.rj.y+A.bj.position.y):Math.abs(A.ri.y+A.bi.position.y),d>m&&(m=d,o.copy(i),g=u.id===A.bi.id?A.bj:A.bi))}n.copy(r).normalize(),g&&(!h.enableJumps||n.y<.5)?(h.enableSlopes?o.y<1-AC&&o.copy(this.raycastToGround(g,o)):o.set(0,1,0),r.projectOnPlane(o)):this.system.driver.world&&r.add(this.system.driver.world.gravity.scale(a*4/1e3)),u.velocity.copy(r),this.el.setAttribute("velocity",u.velocity),this.el.setAttribute("position",u.position)}}(),raycastToGround:function(r,n){let i,o,l=this.body.position,a=this.body.position.clone();return i=new CANNON.Ray(l,a),i._updateDirection(),i.intersectBody(r),i.hasHit?(o=i.result.hitNormalWorld,Math.abs(o.y)>Math.abs(n.y)?o:n):n}});AFRAME.registerComponent("mesh-smooth",{init:function(){this.el.addEventListener("model-loaded",r=>{r.detail.model.traverse(n=>{n.isMesh&&n.geometry.computeVertexNormals()})})}});AFRAME.registerComponent("normal-material",{init:function(){this.material=new THREE.MeshNormalMaterial({flatShading:!0}),this.applyMaterial=this.applyMaterial.bind(this),this.el.addEventListener("object3dset",this.applyMaterial)},remove:function(){this.el.removeEventListener("object3dset",this.applyMaterial)},applyMaterial:function(){this.el.object3D.traverse(r=>{r.isMesh&&(r.material=this.material)})}});AFRAME.registerComponent("sphere-collider",{schema:{objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},remove:function(){this.pause()},play:function(){const r=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(r,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){const r=this.data;let n;r.objects?n=this.el.sceneEl.querySelectorAll(r.objects):n=this.el.sceneEl.children,this.els=Array.prototype.slice.call(n)},tick:function(){const r=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Vector3,l=new THREE.Box3,a=new Map;return function(){const u=this.el,h=this.data,f=u.getObject3D("mesh"),d=[];let m;if(!f)return;a.clear(),u.object3D.getWorldPosition(r),u.object3D.getWorldScale(i),m=h.radius*x(i),this.els.forEach(g),d.sort((v,A)=>a.get(v)>a.get(A)?1:-1).forEach(this.handleHit),d.length===0&&u.emit("hit",{el:null}),this.collisions.filter(v=>!a.has(v)).forEach(this.handleHitEnd),this.collisions=d;function g(v){let A,_,E,w;!v.isEntity||(_=v.getObject3D("mesh"),_&&(l.setFromObject(_).getSize(o),w=Math.max(o.x,o.y,o.z)/2,A=Math.sqrt(2*w*w),l.getCenter(n),A&&(E=r.distanceTo(n),E<A+m&&(d.push(v),a.set(v,E)))))}function x(v){return Math.max.apply(null,v.toArray())}}}(),handleHit:function(r){r.emit("hit"),r.addState(this.data.state),this.el.emit("hit",{el:r})},handleHitEnd:function(r){r.emit("hitend"),r.removeState(this.data.state),this.el.emit("hitend",{el:r})}});AFRAME.registerComponent("nav-mesh",{init:function(){this.system=this.el.sceneEl.systems.nav,this.hasLoadedNavMesh=!1,this.el.addEventListener("object3dset",this.loadNavMesh.bind(this))},play:function(){this.hasLoadedNavMesh||this.loadNavMesh()},loadNavMesh:function(){const r=this.el.getObject3D("mesh"),n=this.el.sceneEl.object3D;if(!r)return;let i;if(r.traverse(l=>{l.isMesh&&(i=l)}),!i)return;const o=i.geometry.isBufferGeometry?new THREE.Geometry().fromBufferGeometry(i.geometry):i.geometry.clone();n.updateMatrixWorld(),o.applyMatrix(i.matrixWorld),this.system.setNavMeshGeometry(o),this.hasLoadedNavMesh=!0}});AFRAME.registerComponent("nav-agent",{schema:{destination:{type:"vec3"},active:{default:!1},speed:{default:2}},init:function(){this.system=this.el.sceneEl.systems.nav,this.system.addAgent(this),this.group=null,this.path=[],this.raycaster=new THREE.Raycaster},remove:function(){this.system.removeAgent(this)},update:function(){this.path.length=0},updateNavLocation:function(){this.group=null,this.path=[]},tick:function(){const r=new THREE.Vector3,n=new THREE.Vector3,i=new THREE.Vector3;return function(o,l){const a=this.el,u=this.data,h=this.raycaster,f=u.speed*l/1e3;if(!u.active)return;if(!this.path.length){const A=this.el.object3D.position;this.group=this.group||this.system.getGroup(A),this.path=this.system.getPath(A,r.copy(u.destination),this.group)||[],a.emit("navigation-start")}if(!this.path.length){console.warn("[nav] Unable to find path to %o.",u.destination),this.el.setAttribute("nav-agent",{active:!1}),a.emit("navigation-end");return}const d=a.object3D.position,m=this.path[0];n.subVectors(m,d);const g=n.length();let x;if(g<f){if(this.path.shift(),!this.path.length){this.el.setAttribute("nav-agent",{active:!1}),a.emit("navigation-end");return}i.copy(d),x=this.path[0]}else i.copy(n.setLength(f)).add(d),x=m;x.y=d.y,a.object3D.lookAt(x),h.ray.origin.copy(i),h.ray.origin.y+=1.5,h.ray.direction.y=-1;const v=h.intersectObject(this.system.getNavMesh());v.length?(n.subVectors(v[0].point,d),d.add(n.setLength(f))):d.copy(i)}}()});var Ki=function(){};Ki.computeCentroids=function(r){var n,i,o;for(n=0,i=r.faces.length;n<i;n++)(o=r.faces[n]).centroid=new THREE.Vector3(0,0,0),o.centroid.add(r.vertices[o.a]),o.centroid.add(r.vertices[o.b]),o.centroid.add(r.vertices[o.c]),o.centroid.divideScalar(3)},Ki.roundNumber=function(r,n){return Number(r.toFixed(n))},Ki.sample=function(r){return r[Math.floor(Math.random()*r.length)]},Ki.mergeVertexIds=function(r,n){var i=[];if(r.forEach(function(f){n.indexOf(f)>=0&&i.push(f)}),i.length<2)return[];i.includes(r[0])&&i.includes(r[r.length-1])&&r.push(r.shift()),i.includes(n[0])&&i.includes(n[n.length-1])&&n.push(n.shift()),i=[],r.forEach(function(f){n.includes(f)&&i.push(f)});for(var o=i[1],l=i[0],a=r.slice();a[0]!==o;)a.push(a.shift());for(var u=0,h=n.slice();h[0]!==l;)if(h.push(h.shift()),u++>10)throw new Error("Unexpected state");return h.shift(),h.pop(),a=a.concat(h)},Ki.setPolygonCentroid=function(r,n){var i=new THREE.Vector3,o=n.vertices;r.vertexIds.forEach(function(l){i.add(o[l])}),i.divideScalar(r.vertexIds.length),r.centroid.copy(i)},Ki.cleanPolygon=function(r,n){for(var i=[],o=n.vertices,l=0;l<r.vertexIds.length;l++){var a,u,h,f=o[r.vertexIds[l]];l===0?(a=r.vertexIds[1],u=r.vertexIds[r.vertexIds.length-1]):l===r.vertexIds.length-1?(a=r.vertexIds[0],u=r.vertexIds[r.vertexIds.length-2]):(a=r.vertexIds[l+1],u=r.vertexIds[l-1]),h=o[u];var d=o[a].clone().sub(f),m=h.clone().sub(f),g=d.angleTo(m);if(g>Math.PI-.01&&g<Math.PI+.01){var x=[];r.neighbours.forEach(function(v){v.vertexIds.includes(r.vertexIds[l])||x.push(v)}),r.neighbours=x}else i.push(r.vertexIds[l])}r.vertexIds=i,this.setPolygonCentroid(r,n)},Ki.isConvex=function(r,n){var i=n.vertices;if(r.vertexIds.length<3)return!1;for(var o=!0,l=[],a=0;a<r.vertexIds.length;a++){var u,h,f=i[r.vertexIds[a]];a===0?(u=i[r.vertexIds[1]],h=i[r.vertexIds[r.vertexIds.length-1]]):a===r.vertexIds.length-1?(u=i[r.vertexIds[0]],h=i[r.vertexIds[r.vertexIds.length-2]]):(u=i[r.vertexIds[a+1]],h=i[r.vertexIds[a-1]]);var d=u.clone().sub(f),m=h.clone().sub(f),g=d.angleTo(m);if(g===Math.PI||g===0)return!1;var x=d.cross(m).y;l.push(x)}return l.forEach(function(v){v===0&&(o=!1)}),l.forEach(l[0]>0?function(v){v<0&&(o=!1)}:function(v){v>0&&(o=!1)}),o},Ki.distanceToSquared=function(r,n){var i=r.x-n.x,o=r.y-n.y,l=r.z-n.z;return i*i+o*o+l*l},Ki.isPointInPoly=function(r,n){for(var i=!1,o=-1,l=r.length,a=l-1;++o<l;a=o)(r[o].z<=n.z&&n.z<r[a].z||r[a].z<=n.z&&n.z<r[o].z)&&n.x<(r[a].x-r[o].x)*(n.z-r[o].z)/(r[a].z-r[o].z)+r[o].x&&(i=!i);return i},Ki.isVectorInPolygon=function(r,n,i){var o=1e5,l=-1e5,a=[];return n.vertexIds.forEach(function(u){o=Math.min(i[u].y,o),l=Math.max(i[u].y,l),a.push(i[u])}),!!(r.y<l+.5&&r.y>o-.5&&this.isPointInPoly(a,r))},Ki.triarea2=function(r,n,i){return(i.x-r.x)*(n.z-r.z)-(n.x-r.x)*(i.z-r.z)},Ki.vequal=function(r,n){return this.distanceToSquared(r,n)<1e-5};var sc=function(r){this.content=[],this.scoreFunction=r};sc.prototype.push=function(r){this.content.push(r),this.sinkDown(this.content.length-1)},sc.prototype.pop=function(){var r=this.content[0],n=this.content.pop();return this.content.length>0&&(this.content[0]=n,this.bubbleUp(0)),r},sc.prototype.remove=function(r){var n=this.content.indexOf(r),i=this.content.pop();n!==this.content.length-1&&(this.content[n]=i,this.scoreFunction(i)<this.scoreFunction(r)?this.sinkDown(n):this.bubbleUp(n))},sc.prototype.size=function(){return this.content.length},sc.prototype.rescoreElement=function(r){this.sinkDown(this.content.indexOf(r))},sc.prototype.sinkDown=function(r){for(var n=this.content[r];r>0;){var i=(r+1>>1)-1,o=this.content[i];if(!(this.scoreFunction(n)<this.scoreFunction(o)))break;this.content[i]=n,this.content[r]=o,r=i}},sc.prototype.bubbleUp=function(r){for(var n=this.content.length,i=this.content[r],o=this.scoreFunction(i);;){var l=r+1<<1,a=l-1,u=null,h=void 0;if(a<n&&(h=this.scoreFunction(this.content[a]))<o&&(u=a),l<n&&this.scoreFunction(this.content[l])<(u===null?o:h)&&(u=l),u===null)break;this.content[r]=this.content[u],this.content[u]=i,r=u}};var mu=function(){};mu.init=function(r){for(var n=0;n<r.length;n++){var i=r[n];i.f=0,i.g=0,i.h=0,i.cost=1,i.visited=!1,i.closed=!1,i.parent=null}},mu.cleanUp=function(r){for(var n=0;n<r.length;n++){var i=r[n];delete i.f,delete i.g,delete i.h,delete i.cost,delete i.visited,delete i.closed,delete i.parent}},mu.heap=function(){return new sc(function(r){return r.f})},mu.search=function(r,n,i){this.init(r);var o=this.heap();for(o.push(n);o.size()>0;){var l=o.pop();if(l===i){for(var a=l,u=[];a.parent;)u.push(a),a=a.parent;return this.cleanUp(u),u.reverse()}l.closed=!0;for(var h=this.neighbours(r,l),f=0,d=h.length;f<d;f++){var m=h[f];if(!m.closed){var g=l.g+m.cost,x=m.visited;if(!x||g<m.g){if(m.visited=!0,m.parent=l,!m.centroid||!i.centroid)throw new Error("Unexpected state");m.h=m.h||this.heuristic(m.centroid,i.centroid),m.g=g,m.f=m.g+m.h,x?o.rescoreElement(m):o.push(m)}}}}return[]},mu.heuristic=function(r,n){return Ki.distanceToSquared(r,n)},mu.neighbours=function(r,n){for(var i=[],o=0;o<n.neighbours.length;o++)i.push(r[n.neighbours[o]]);return i};var WH=1,gu=function(){};gu.buildZone=function(r){var n=this,i=this._buildNavigationMesh(r),o={};i.vertices.forEach(function(u){u.x=Ki.roundNumber(u.x,2),u.y=Ki.roundNumber(u.y,2),u.z=Ki.roundNumber(u.z,2)}),o.vertices=i.vertices;var l=this._buildPolygonGroups(i);o.groups=[];var a=function(u,h){for(var f=0;f<u.length;f++)if(h===u[f])return f};return l.forEach(function(u){var h=[];u.forEach(function(f){var d=f.neighbours.map(function(g){return a(u,g)}),m=f.neighbours.map(function(g){return n._getSharedVerticesInOrder(f,g)});f.centroid.x=Ki.roundNumber(f.centroid.x,2),f.centroid.y=Ki.roundNumber(f.centroid.y,2),f.centroid.z=Ki.roundNumber(f.centroid.z,2),h.push({id:a(u,f),neighbours:d,vertexIds:f.vertexIds,centroid:f.centroid,portals:m})}),o.groups.push(h)}),o},gu._buildNavigationMesh=function(r){return Ki.computeCentroids(r),r.mergeVertices(),this._buildPolygonsFromGeometry(r)},gu._buildPolygonGroups=function(r){var n=[],i=0,o=function(l){l.neighbours.forEach(function(a){a.group===void 0&&(a.group=l.group,o(a))})};return r.polygons.forEach(function(l){l.group===void 0&&(l.group=i++,o(l)),n[l.group]||(n[l.group]=[]),n[l.group].push(l)}),n},gu._buildPolygonNeighbours=function(r,n,i){var o=new Set,l=i.get(r.vertexIds[0]),a=i.get(r.vertexIds[1]),u=i.get(r.vertexIds[2]);l.forEach(function(h){(a.has(h)||u.has(h))&&o.add(n.polygons[h])}),a.forEach(function(h){u.has(h)&&o.add(n.polygons[h])}),r.neighbours=Array.from(o)},gu._buildPolygonsFromGeometry=function(r){for(var n=this,i=[],o=r.vertices,l=r.faceVertexUvs,a=new Map,u=0;u<o.length;u++)a.set(u,new Set);r.faces.forEach(function(f){i.push({id:WH++,vertexIds:[f.a,f.b,f.c],centroid:f.centroid,normal:f.normal,neighbours:[]}),a.get(f.a).add(i.length-1),a.get(f.b).add(i.length-1),a.get(f.c).add(i.length-1)});var h={polygons:i,vertices:o,faceVertexUvs:l};return i.forEach(function(f){n._buildPolygonNeighbours(f,h,a)}),h},gu._getSharedVerticesInOrder=function(r,n){var i=r.vertexIds,o=n.vertexIds,l=new Set;if(i.forEach(function(u){o.includes(u)&&l.add(u)}),l.size<2)return[];l.has(i[0])&&l.has(i[i.length-1])&&i.push(i.shift()),l.has(o[0])&&l.has(o[o.length-1])&&o.push(o.shift());var a=[];return i.forEach(function(u){o.includes(u)&&a.push(u)}),a};var OE=function(){this.portals=[]};OE.prototype.push=function(r,n){n===void 0&&(n=r),this.portals.push({left:r,right:n})},OE.prototype.stringPull=function(){var r,n,i,o=this.portals,l=[],a=0,u=0,h=0;n=o[0].left,i=o[0].right,l.push(r=o[0].left);for(var f=1;f<o.length;f++){var d=o[f].left,m=o[f].right;if(Ki.triarea2(r,i,m)<=0){if(!(Ki.vequal(r,i)||Ki.triarea2(r,n,m)>0)){l.push(n),n=r=n,i=r,u=a=u,h=a,f=a;continue}i=m,h=f}if(Ki.triarea2(r,n,d)>=0){if(!(Ki.vequal(r,n)||Ki.triarea2(r,i,d)<0)){l.push(i),n=r=i,i=r,u=a=h,h=a,f=a;continue}n=d,u=f}}return l.length!==0&&Ki.vequal(l[l.length-1],o[o.length-1].left)||l.push(o[o.length-1].left),this.path=l,l};var gb,vb,cu,yb,xb,Cv,oc=function(){this.zones={}};oc.createZone=function(r){return gu.buildZone(r)},oc.prototype.setZoneData=function(r,n){this.zones[r]=n},oc.prototype.getGroup=function(r,n){if(!this.zones[r])return null;var i=null,o=Math.pow(50,2);return this.zones[r].groups.forEach(function(l,a){l.forEach(function(u){var h=Ki.distanceToSquared(u.centroid,n);h<o&&(i=a,o=h)})}),i},oc.prototype.getRandomNode=function(r,n,i,o){if(!this.zones[r])return new THREE.Vector3;i=i||null,o=o||0;var l=[];return this.zones[r].groups[n].forEach(function(a){i&&o?Ki.distanceToSquared(i,a.centroid)<o*o&&l.push(a.centroid):l.push(a.centroid)}),Ki.sample(l)||new THREE.Vector3},oc.prototype.getClosestNode=function(r,n,i,o){o===void 0&&(o=!1);var l=this.zones[n].vertices,a=null,u=1/0;return this.zones[n].groups[i].forEach(function(h){var f=Ki.distanceToSquared(h.centroid,r);f<u&&(!o||Ki.isVectorInPolygon(r,h,l))&&(a=h,u=f)}),a},oc.prototype.findPath=function(r,n,i,o){var l=this.zones[i].groups[o],a=this.zones[i].vertices,u=this.getClosestNode(r,i,o),h=this.getClosestNode(n,i,o,!0);if(!u||!h)return null;var f=mu.search(l,u,h),d=function(_,E){for(var w=0;w<_.neighbours.length;w++)if(_.neighbours[w]===E.id)return _.portals[w]},m=new OE;m.push(r);for(var g=0;g<f.length;g++){var x=f[g+1];if(x){var v=d(f[g],x);m.push(a[v[0]],a[v[1]])}}m.push(n),m.stringPull();var A=m.path.map(function(_){return new THREE.Vector3(_.x,_.y,_.z)});return A.shift(),A},oc.prototype.clampStep=(cu=new THREE.Vector3,yb=new THREE.Plane,xb=new THREE.Triangle,Cv=new THREE.Vector3,function(r,n,i,o,l,a){var u=this.zones[o].vertices,h=this.zones[o].groups[l],f=[i],d={};d[i.id]=0,gb=void 0,Cv.set(0,0,0),vb=1/0,yb.setFromCoplanarPoints(u[i.vertexIds[0]],u[i.vertexIds[1]],u[i.vertexIds[2]]),yb.projectPoint(n,cu),n.copy(cu);for(var m=f.pop();m;m=f.pop()){xb.set(u[m.vertexIds[0]],u[m.vertexIds[1]],u[m.vertexIds[2]]),xb.closestPointToPoint(n,cu),cu.distanceToSquared(n)<vb&&(gb=m,Cv.copy(cu),vb=cu.distanceToSquared(n));var g=d[m];if(!(g>2))for(var x=0;x<m.neighbours.length;x++){var v=h[m.neighbours[x]];v.id in d||(f.push(v),d[v.id]=g+1)}}return a.copy(Cv),gb});const jH=Object.freeze(Object.defineProperty({__proto__:null,Pathfinding:oc},Symbol.toStringTag,{value:"Module"})),$H=MA(jH),{Pathfinding:ZD}=$H,sp=new ZD,op="level";AFRAME.registerSystem("nav",{init:function(){this.navMesh=null,this.agents=new Set},setNavMeshGeometry:function(r){this.navMesh=new THREE.Mesh(r),sp.setZoneData(op,ZD.createZone(r)),Array.from(this.agents).forEach(n=>n.updateNavLocation())},getNavMesh:function(){return this.navMesh},addAgent:function(r){this.agents.add(r)},removeAgent:function(r){this.agents.delete(r)},getPath:function(r,n,i){return this.navMesh?sp.findPath(r,n,op,i):null},getGroup:function(r){return this.navMesh?sp.getGroup(op,r):null},getNode:function(r,n){return this.navMesh?sp.getClosestNode(r,op,n,!0):null},clampStep:function(r,n,i,o,l){if(this.navMesh){if(!o)return l.copy(n),this.getNode(n,i)}else return l.copy(n),null;return sp.clampStep(r,n,o,op,i,l)}});AFRAME.registerPrimitive("a-grid",{defaultComponents:{geometry:{primitive:"plane",width:75,height:75},rotation:{x:-90,y:0,z:0},material:{src:"url(https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v1.16.3/assets/grid.png)",repeat:"75 75"}},mappings:{width:"geometry.width",height:"geometry.height",src:"material.src"}});var JD={exports:{}},Gt=JD.exports={VERSION:"0.1.1",PI:Math.PI,TAU:2*Math.PI,DEG_TO_RAD:.0174532925,RAD_TO_DEG:57.2957795,SQRT3:Math.sqrt(3),TILE:"tile",ENT:"entity",STR:"structure",HEX:"hex",SQR:"square",ABS:"abstract"};Gt.Board=function(r,n){if(!r)throw new Error("You must pass in a grid system for the board to use.");this.tiles=[],this.tileGroup=null,this.group=new THREE.Object3D,this.grid=null,this.overlay=null,this.finder=new Gt.AStarFinder(n),Gt.Loader.init(),this.setGrid(r)},Gt.Board.prototype={setEntityOnTile:function(r,n){var i=this.grid.cellToPixel(n.cell);r.position.copy(i),r.position.y+=r.heightOffset||0,r.tile&&(r.tile.entity=null),r.tile=n,n.entity=r},addTile:function(r){var n=this.tiles.indexOf(r);n===-1&&(this.tiles.push(r),this.snapTileToGrid(r),r.position.y=0,this.tileGroup.add(r.mesh),this.grid.add(r.cell),r.cell.tile=r)},removeTile:function(r){if(r){var n=this.tiles.indexOf(r);this.grid.remove(r.cell),n!==-1&&this.tiles.splice(n,1),r.dispose()}},removeAllTiles:function(){if(this.tileGroup)for(var r=this.tileGroup.children,n=0;n<r.length;n++)this.tileGroup.remove(r[n])},getTileAtCell:function(r){var n=this.grid.cellToHash(r);return r.tile||(typeof this.grid.cells[n]<"u"?this.grid.cells[n].tile:null)},snapToGrid:function(r){var n=this.grid.pixelToCell(r);r.copy(this.grid.cellToPixel(n))},snapTileToGrid:function(r){if(r.cell)r.position.copy(this.grid.cellToPixel(r.cell));else{var n=this.grid.pixelToCell(r.position);r.position.copy(this.grid.cellToPixel(n))}return r},getRandomTile:function(){var r=Gt.Tools.randomInt(0,this.tiles.length-1);return this.tiles[r]},findPath:function(r,n,i){return this.finder.findPath(r.cell,n.cell,i,this.grid)},setGrid:function(r){this.group.remove(this.tileGroup),this.grid&&r!==this.grid&&(this.removeAllTiles(),this.tiles.forEach(function(n){this.grid.remove(n.cell),n.dispose()}),this.grid.dispose()),this.grid=r,this.tiles=[],this.tileGroup=new THREE.Object3D,this.group.add(this.tileGroup)},generateOverlay:function(r){var n=new THREE.LineBasicMaterial({color:0,opacity:.3});this.overlay&&this.group.remove(this.overlay),this.overlay=new THREE.Object3D,this.grid.generateOverlay(r,this.overlay,n),this.group.add(this.overlay)},generateTilemap:function(r){this.reset();var n=this.grid.generateTiles(r);this.tiles=n,this.tileGroup=new THREE.Object3D;for(var i=0;i<n.length;i++)this.tileGroup.add(n[i].mesh);this.group.add(this.tileGroup)},reset:function(){this.removeAllTiles(),this.tileGroup&&this.group.remove(this.tileGroup)}},Gt.Board.prototype.constructor=Gt.Board,Gt.Cell=function(r,n,i,o){this.q=r||0,this.r=n||0,this.s=i||0,this.h=o||1,this.tile=null,this.userData={},this.walkable=!0,this._calcCost=0,this._priority=0,this._visited=!1,this._parent=null,this.uniqueID=Gt.LinkedList.generateID()},Gt.Cell.prototype={set:function(r,n,i){return this.q=r,this.r=n,this.s=i,this},copy:function(r){return this.q=r.q,this.r=r.r,this.s=r.s,this.h=r.h,this.tile=r.tile||null,this.userData=r.userData||{},this.walkable=r.walkable,this},add:function(r){return this.q+=r.q,this.r+=r.r,this.s+=r.s,this},equals:function(r){return this.q===r.q&&this.r===r.r&&this.s===r.s}},Gt.Cell.prototype.constructor=Gt.Cell,Gt.HexGrid=function(r){r=r||{},this.type=Gt.HEX,this.size=5,this.cellSize=typeof r.cellSize>"u"?10:r.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var n,i=[];for(n=0;6>n;n++)i.push(this._createVertex(n));for(this.cellShape=new THREE.Shape,this.cellShape.moveTo(i[0].x,i[0].y),n=1;6>n;n++)this.cellShape.lineTo(i[n].x,i[n].y);this.cellShape.lineTo(i[0].x,i[0].y),this.cellShape.autoClose=!0,this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=i,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._cellWidth=2*this.cellSize,this._cellLength=.5*Gt.SQRT3*this._cellWidth,this._hashDelimeter=".",this._directions=[new Gt.Cell(1,-1,0),new Gt.Cell(1,0,-1),new Gt.Cell(0,1,-1),new Gt.Cell(-1,1,0),new Gt.Cell(-1,0,1),new Gt.Cell(0,-1,1)],this._diagonals=[new Gt.Cell(2,-1,-1),new Gt.Cell(1,1,-2),new Gt.Cell(-1,2,-1),new Gt.Cell(-2,1,1),new Gt.Cell(-1,-1,2),new Gt.Cell(1,-2,1)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new Gt.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},Gt.HexGrid.TWO_THIRDS=2/3,Gt.HexGrid.prototype={cellToPixel:function(r){return this._vec3.x=r.q*this._cellWidth*.75,this._vec3.y=r.h,this._vec3.z=-((r.s-r.r)*this._cellLength*.5),this._vec3},pixelToCell:function(r){var n=r.x*(Gt.HexGrid.TWO_THIRDS/this.cellSize),i=(-r.x/3+Gt.SQRT3/3*r.z)/this.cellSize;return this._cel.set(n,i,-n-i),this._cubeRound(this._cel)},getCellAt:function(r){var n=r.x*(Gt.HexGrid.TWO_THIRDS/this.cellSize),i=(-r.x/3+Gt.SQRT3/3*r.z)/this.cellSize;return this._cel.set(n,i,-n-i),this._cubeRound(this._cel),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(r,n,i){var o,l,a=this._directions.length;for(this._list.length=0,o=0;a>o;o++)this._cel.copy(r),this._cel.add(this._directions[o]),l=this.cells[this.cellToHash(this._cel)],!l||i&&!i(r,l)||this._list.push(l);if(n)for(o=0;a>o;o++)this._cel.copy(r),this._cel.add(this._diagonals[o]),l=this.cells[this.cellToHash(this._cel)],!l||i&&!i(r,l)||this._list.push(l);return this._list},getRandomCell:function(){var r,n=0,i=Gt.Tools.randomInt(0,this.numCells);for(r in this.cells){if(n===i)return this.cells[r];n++}return this.cells[r]},cellToHash:function(r){return r.q+this._hashDelimeter+r.r+this._hashDelimeter+r.s},distance:function(r,n){var i=Math.max(Math.abs(r.q-n.q),Math.abs(r.r-n.r),Math.abs(r.s-n.s));return i+=n.h-r.h},clearPath:function(){var r,n;for(r in this.cells)n=this.cells[r],n._calcCost=0,n._priority=0,n._parent=null,n._visited=!1},traverse:function(r){var n;for(n in this.cells)r(this.cells[n])},generateTile:function(r,n,i){var o=Math.abs(r.h);1>o&&(o=1);var l=this._geoCache[o];l||(this.extrudeSettings.amount=o,l=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[o]=l);var a=new Gt.Tile({size:this.cellSize,scale:n,cell:r,geometry:l,material:i});return r.tile=a,a},generateTiles:function(r){r=r||{};var n=[],i={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};i=Gt.Tools.merge(i,r),this.cellSize=i.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*Gt.SQRT3*this._cellWidth,this.autogenerated=!0,this.extrudeSettings=i.extrudeSettings;var o,l,a;for(o in this.cells)a=this.cells[o],l=this.generateTile(a,i.tileScale,i.material),l.position.copy(this.cellToPixel(a)),l.position.y=0,n.push(l);return n},generateTilePoly:function(r){r||(r=new THREE.MeshBasicMaterial({color:2405631}));var n=new THREE.Mesh(this.cellShapeGeo,r);return this._vec3.set(1,0,0),n.rotateOnAxis(this._vec3,Gt.PI/2),n},generate:function(r){r=r||{},this.size=typeof r.size>"u"?this.size:r.size;var n,i,o,l;for(n=-this.size;n<this.size+1;n++)for(i=-this.size;i<this.size+1;i++)o=-n-i,Math.abs(n)<=this.size&&Math.abs(i)<=this.size&&Math.abs(o)<=this.size&&(l=new Gt.Cell(n,i,o),this.add(l))},generateOverlay:function(r,n,i){var o,l,a,u=this.cellShape.createPointsGeometry();for(o=-r;r+1>o;o++)for(l=-r;r+1>l;l++)if(a=-o-l,Math.abs(o)<=r&&Math.abs(l)<=r&&Math.abs(a)<=r){this._cel.set(o,l,a);var h=new THREE.Line(u,i);h.position.copy(this.cellToPixel(this._cel)),h.rotation.x=90*Gt.DEG_TO_RAD,n.add(h)}},add:function(r){var n=this.cellToHash(r);if(!this.cells[n])return this.cells[n]=r,this.numCells++,r},remove:function(r){var n=this.cellToHash(r);this.cells[n]&&(delete this.cells[n],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(r,n,i){var o=this;Gt.Tools.getJSON({url:r,callback:function(l){o.fromJSON(l),n.call(i||null,l)},cache:!1,scope:o})},fromJSON:function(r){var n,i,o=r.cells;for(this.cells={},this.numCells=0,this.size=r.size,this.cellSize=r.cellSize,this._cellWidth=2*this.cellSize,this._cellLength=.5*Gt.SQRT3*this._cellWidth,this.extrudeSettings=r.extrudeSettings,this.autogenerated=r.autogenerated,n=0;n<o.length;n++)i=new Gt.Cell,i.copy(o[n]),this.add(i)},toJSON:function(){var r,n,i={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},o=[];for(n in this.cells)r=this.cells[n],o.push({q:r.q,r:r.r,s:r.s,h:r.h,walkable:r.walkable,userData:r.userData});return i.cells=o,i},_createVertex:function(r){var n=Gt.TAU/6*r;return new THREE.Vector3(this.cellSize*Math.cos(n),this.cellSize*Math.sin(n),0)},_cubeRound:function(r){var n=Math.round(r.q),i=Math.round(r.r),o=Math.round(r.s),l=Math.abs(n-r.q),a=Math.abs(i-r.r),u=Math.abs(o-r.s);return l>a&&l>u?n=-i-o:a>u?i=-n-o:o=-n-i,this._cel.set(n,i,o)}},Gt.HexGrid.prototype.constructor=Gt.HexGrid,Gt.SqrGrid=function(r){r=r||{},this.type=Gt.SQR,this.size=5,this.cellSize=typeof r.cellSize>"u"?10:r.cellSize,this.cells={},this.numCells=0,this.extrudeSettings=null,this.autogenerated=!1;var n=[];n.push(new THREE.Vector3),n.push(new THREE.Vector3(-this.cellSize,this.cellSize)),n.push(new THREE.Vector3(this.cellSize,this.cellSize)),n.push(new THREE.Vector3(this.cellSize,-this.cellSize)),this.cellShape=new THREE.Shape,this.cellShape.moveTo(-this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,this.cellSize),this.cellShape.lineTo(this.cellSize,-this.cellSize),this.cellShape.lineTo(-this.cellSize,-this.cellSize),this.cellGeo=new THREE.Geometry,this.cellGeo.vertices=n,this.cellGeo.verticesNeedUpdate=!0,this.cellShapeGeo=new THREE.ShapeGeometry(this.cellShape),this._fullCellSize=2*this.cellSize,this._hashDelimeter=".",this._directions=[new Gt.Cell(1,0,0),new Gt.Cell(0,-1,0),new Gt.Cell(-1,0,0),new Gt.Cell(0,1,0)],this._diagonals=[new Gt.Cell(-1,-1,0),new Gt.Cell(-1,1,0),new Gt.Cell(1,1,0),new Gt.Cell(1,-1,0)],this._list=[],this._vec3=new THREE.Vector3,this._cel=new Gt.Cell,this._conversionVec=new THREE.Vector3,this._geoCache=[],this._matCache=[]},Gt.SqrGrid.prototype={cellToPixel:function(r){return this._vec3.x=r.q*this._fullCellSize,this._vec3.y=r.h,this._vec3.z=r.r*this._fullCellSize,this._vec3},pixelToCell:function(r){var n=Math.round(r.x/this._fullCellSize),i=Math.round(r.z/this._fullCellSize);return this._cel.set(n,i,0)},getCellAt:function(r){var n=Math.round(r.x/this._fullCellSize),i=Math.round(r.z/this._fullCellSize);return this._cel.set(n,i),this.cells[this.cellToHash(this._cel)]},getNeighbors:function(r,n,i){var o,l,a=this._directions.length;for(this._list.length=0,o=0;a>o;o++)this._cel.copy(r),this._cel.add(this._directions[o]),l=this.cells[this.cellToHash(this._cel)],!l||i&&!i(r,l)||this._list.push(l);if(n)for(o=0;a>o;o++)this._cel.copy(r),this._cel.add(this._diagonals[o]),l=this.cells[this.cellToHash(this._cel)],!l||i&&!i(r,l)||this._list.push(l);return this._list},getRandomCell:function(){var r,n=0,i=Gt.Tools.randomInt(0,this.numCells);for(r in this.cells){if(n===i)return this.cells[r];n++}return this.cells[r]},cellToHash:function(r){return r.q+this._hashDelimeter+r.r},distance:function(r,n){var i=Math.max(Math.abs(r.q-n.q),Math.abs(r.r-n.r));return i+=n.h-r.h},clearPath:function(){var r,n;for(r in this.cells)n=this.cells[r],n._calcCost=0,n._priority=0,n._parent=null,n._visited=!1},traverse:function(r){var n;for(n in this.cells)r(this.cells[n])},generateTile:function(r,n,i){var o=Math.abs(r.h);1>o&&(o=1);var l=this._geoCache[o];l||(this.extrudeSettings.amount=o,l=new THREE.ExtrudeGeometry(this.cellShape,this.extrudeSettings),this._geoCache[o]=l);var a=new Gt.Tile({size:this.cellSize,scale:n,cell:r,geometry:l,material:i});return r.tile=a,a},generateTiles:function(r){r=r||{};var n=[],i={tileScale:.95,cellSize:this.cellSize,material:null,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5}};i=Gt.Tools.merge(i,r),this.cellSize=i.cellSize,this._fullCellSize=2*this.cellSize,this.autogenerated=!0,this.extrudeSettings=i.extrudeSettings;var o,l,a;for(o in this.cells)a=this.cells[o],l=this.generateTile(a,i.tileScale,i.material),l.position.copy(this.cellToPixel(a)),l.position.y=0,n.push(l);return n},generateTilePoly:function(r){r||(r=new THREE.MeshBasicMaterial({color:2405631}));var n=new THREE.Mesh(this.cellShapeGeo,r);return this._vec3.set(1,0,0),n.rotateOnAxis(this._vec3,Gt.PI/2),n},generate:function(r){r=r||{},this.size=typeof r.size>"u"?this.size:r.size;var n,i,o,l=Math.ceil(this.size/2);for(n=-l;l>n;n++)for(i=-l;l>i;i++)o=new Gt.Cell(n,i+1),this.add(o)},generateOverlay:function(r,n,i){var o,l,a=Math.ceil(r/2);for(o=-a;a>o;o++)for(l=-a;a>l;l++){this._cel.set(o,l);var u=new THREE.Line(this.cellGeo,i);u.position.copy(this.cellToPixel(this._cel)),u.rotation.x=90*Gt.DEG_TO_RAD,n.add(u)}},add:function(r){var n=this.cellToHash(r);if(!this.cells[n])return this.cells[n]=r,this.numCells++,r},remove:function(r){var n=this.cellToHash(r);this.cells[n]&&(delete this.cells[n],this.numCells--)},dispose:function(){this.cells=null,this.numCells=0,this.cellShape=null,this.cellGeo.dispose(),this.cellGeo=null,this.cellShapeGeo.dispose(),this.cellShapeGeo=null,this._list=null,this._vec3=null,this._conversionVec=null,this._geoCache=null,this._matCache=null},load:function(r,n,i){Gt.Tools.getJSON({url:r,callback:function(o){this.fromJSON(o),n.call(i||null,o)},cache:!1,scope:this})},fromJSON:function(r){var n,i,o=r.cells;for(this.cells={},this.numCells=0,this.size=r.size,this.cellSize=r.cellSize,this._fullCellSize=2*this.cellSize,this.extrudeSettings=r.extrudeSettings,this.autogenerated=r.autogenerated,n=0;n<o.length;n++)i=new Gt.Cell,i.copy(o[n]),this.add(i)},toJSON:function(){var r,n,i={size:this.size,cellSize:this.cellSize,extrudeSettings:this.extrudeSettings,autogenerated:this.autogenerated},o=[];for(n in this.cells)r=this.cells[n],o.push({q:r.q,r:r.r,s:r.s,h:r.h,walkable:r.walkable,userData:r.userData});return i.cells=o,i}},Gt.SqrGrid.prototype.constructor=Gt.SqrGrid,Gt.Tile=function(r){r=r||{};var n={cell:null,geometry:null,material:null};if(n=Gt.Tools.merge(n,r),!n.cell||!n.geometry)throw new Error("Missing vg.Tile configuration");this.cell=n.cell,this.cell.tile&&this.cell.tile!==this&&this.cell.tile.dispose(),this.cell.tile=this,this.uniqueID=Gt.Tools.generateID(),this.geometry=n.geometry,this.material=n.material,this.material||(this.material=new THREE.MeshPhongMaterial({color:Gt.Tools.randomizeRGB("30, 30, 30",13)})),this.objectType=Gt.TILE,this.entity=null,this.userData={},this.selected=!1,this.highlight="0x0084cc",this.mesh=new THREE.Mesh(this.geometry,this.material),this.mesh.userData.structure=this,this.position=this.mesh.position,this.rotation=this.mesh.rotation,this.rotation.x=-90*Gt.DEG_TO_RAD,this.mesh.scale.set(n.scale,n.scale,1),this.material.emissive?this._emissive=this.material.emissive.getHex():this._emissive=null},Gt.Tile.prototype={select:function(){return this.material.emissive&&this.material.emissive.setHex(this.highlight),this.selected=!0,this},deselect:function(){return this._emissive!==null&&this.material.emissive&&this.material.emissive.setHex(this._emissive),this.selected=!1,this},toggle:function(){return this.selected?this.deselect():this.select(),this},dispose:function(){this.cell&&this.cell.tile&&(this.cell.tile=null),this.cell=null,this.position=null,this.rotation=null,this.mesh.parent&&this.mesh.parent.remove(this.mesh),this.mesh.userData.structure=null,this.mesh=null,this.material=null,this.userData=null,this.entity=null,this.geometry=null,this._emissive=null}},Gt.Tile.prototype.constructor=Gt.Tile,function(){var r=function(){this.obj=null,this.next=null,this.prev=null,this.free=!0},n=function(){this.first=null,this.last=null,this.length=0,this.objToNodeMap={},this.uniqueID=Date.now()+""+Math.floor(1e3*Math.random()),this.sortArray=[]};n.generateID=function(){return Math.random().toString(36).slice(2)+Date.now()},n.prototype={getNode:function(i){return this.objToNodeMap[i.uniqueID]},addNode:function(i){var o=new r;if(!i.uniqueID)try{i.uniqueID=n.generateID()}catch{return console.error("[LinkedList.addNode] obj passed is immutable: cannot attach necessary identifier"),null}return o.obj=i,o.free=!1,this.objToNodeMap[i.uniqueID]=o,o},swapObjects:function(i,o){this.objToNodeMap[i.obj.uniqueID]=null,this.objToNodeMap[o.uniqueID]=i,i.obj=o},add:function(i){var o=this.objToNodeMap[i.uniqueID];if(o){if(o.free===!1)return;o.obj=i,o.free=!1,o.next=null,o.prev=null}else o=this.addNode(i);if(this.first){if(!this.last)throw new Error("[LinkedList.add] No last in the list -- that shouldn't happen here");this.last.next=o,o.prev=this.last,this.last=o,o.next=null}else this.first=o,this.last=o,o.next=null,o.prev=null;this.length++,this.showDebug&&this.dump("after add")},has:function(i){return!!this.objToNodeMap[i.uniqueID]},moveUp:function(i){this.dump("before move up");var o=this.getNode(i);if(!o)throw"Oops, trying to move an object that isn't in the list";if(o.prev){var l=o.prev,a=l.prev;o==this.last&&(this.last=l);var u=o.next;a&&(a.next=o),o.next=l,o.prev=l.prev,l.next=u,l.prev=o,this.first==l&&(this.first=o)}},moveDown:function(i){var o=this.getNode(i);if(!o)throw"Oops, trying to move an object that isn't in the list";if(o.next){var l=o.next;this.moveUp(l.obj),this.last==l&&(this.last=o)}},sort:function(i){var o,l,a=this.sortArray,u=this.first;for(a.length=0;u;)a.push(u.obj),u=u.next;for(this.clear(),a.sort(i),l=a.length,o=0;l>o;o++)this.add(a[o])},remove:function(i){var o=this.getNode(i);return!o||o.free?!1:(o.prev&&(o.prev.next=o.next),o.next&&(o.next.prev=o.prev),o.prev||(this.first=o.next),o.next||(this.last=o.prev),o.free=!0,o.prev=null,o.next=null,this.length--,!0)},shift:function(){var i=this.first;return this.length===0?null:(i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),this.first=i.next,i.next||(this.last=null),i.free=!0,i.prev=null,i.next=null,this.length--,i.obj)},pop:function(){var i=this.last;return this.length===0?null:(i.prev&&(i.prev.next=i.next),i.next&&(i.next.prev=i.prev),this.last=i.prev,i.prev||(this.first=null),i.free=!0,i.prev=null,i.next=null,this.length--,i.obj)},concat:function(i){for(var o=i.first;o;)this.add(o.obj),o=o.next},clear:function(){for(var i=this.first;i;)i.free=!0,i=i.next;this.first=null,this.length=0},dispose:function(){for(var i=this.first;i;)i.obj=null,i=i.next;this.first=null,this.objToNodeMap=null},dump:function(i){console.log("===================="+i+"=====================");for(var o=this.first;o;)console.log("{"+o.obj.toString()+"} previous="+(o.prev?o.prev.obj:"NULL")),o=o.next();console.log("==================================="),console.log("Last: {"+(this.last?this.last.obj:"NULL")+"} First: {"+(this.first?this.first.obj:"NULL")+"}")}},n.prototype.constructor=n,Gt.LinkedList=n}(),function(){var r=function(i,o,l,a,u){this._listener=o,this.isOnce=l,this.context=a,this.signal=i,this._priority=u||0};r.prototype={active:!0,params:null,execute:function(i){var o,l;return this.active&&this._listener&&(l=this.params?this.params.concat(i):i,o=this._listener.apply(this.context,l),this.isOnce&&this.detach()),o},detach:function(){return this.isBound()?this.signal.remove(this._listener,this.context):null},isBound:function(){return!!this.signal&&!!this._listener},_destroy:function(){delete this.signal,delete this._listener,delete this.context},toString:function(){return"[SignalBinding isOnce:"+this.isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},r.prototype.constructor=r;var n=function(){this._bindings=[],this._prevParams=null;var i=this;this.dispatch=function(){n.prototype.dispatch.apply(i,arguments)}};n.prototype={memorize:!1,_shouldPropagate:!0,active:!0,validateListener:function(i,o){if(typeof i!="function")throw new Error("Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",o))},_registerListener:function(i,o,l,a){var u,h=this._indexOfListener(i,l);if(h!==-1){if(u=this._bindings[h],u.isOnce!==o)throw new Error("You cannot add"+(o?"":"Once")+"() then add"+(o?"Once":"")+"() the same listener without removing the relationship first.")}else u=new r(this,i,o,l,a),this._addBinding(u);return this.memorize&&this._prevParams&&u.execute(this._prevParams),u},_addBinding:function(i){var o=this._bindings.length;do o--;while(this._bindings[o]&&i._priority<=this._bindings[o]._priority);this._bindings.splice(o+1,0,i)},_indexOfListener:function(i,o){for(var l,a=this._bindings.length;a--;)if(l=this._bindings[a],l._listener===i&&l.context===o)return a;return-1},has:function(i,o){return this._indexOfListener(i,o)!==-1},add:function(i,o,l){return this.validateListener(i,"add"),this._registerListener(i,!1,o,l)},addOnce:function(i,o,l){return this.validateListener(i,"addOnce"),this._registerListener(i,!0,o,l)},remove:function(i,o){this.validateListener(i,"remove");var l=this._indexOfListener(i,o);return l!==-1&&(this._bindings[l]._destroy(),this._bindings.splice(l,1)),i},removeAll:function(i){typeof i>"u"&&(i=null);for(var o=this._bindings.length;o--;)i?this._bindings[o].context===i&&(this._bindings[o]._destroy(),this._bindings.splice(o,1)):this._bindings[o]._destroy();i||(this._bindings.length=0)},getNumListeners:function(){return this._bindings.length},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active){var i,o=Array.prototype.slice.call(arguments),l=this._bindings.length;if(this.memorize&&(this._prevParams=o),l){i=this._bindings.slice(),this._shouldPropagate=!0;do l--;while(i[l]&&this._shouldPropagate&&i[l].execute(o)!==!1)}}},forget:function(){this._prevParams=null},dispose:function(){this.removeAll(),delete this._bindings,delete this._prevParams},toString:function(){return"[Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},n.prototype.constructor=n,Gt.Signal=n}(),Gt.AStarFinder=function(r){r=r||{};var n={allowDiagonal:!1,heuristicFilter:null};n=Gt.Tools.merge(n,r),this.allowDiagonal=n.allowDiagonal,this.heuristicFilter=n.heuristicFilter,this.list=new Gt.LinkedList},Gt.AStarFinder.prototype={findPath:function(r,n,i,o){var l,a,u,h,f,d;for(i=i||this.heuristicFilter,o.clearPath(),this.list.clear(),this.list.add(r);this.list.length>0;){if(this.list.sort(this.compare),l=this.list.shift(),l._visited=!0,l===n)return Gt.PathUtil.backtrace(n);for(u=o.getNeighbors(l,this.allowDiagonal,i),f=0,d=u.length;d>f;f++)if(h=u[f],h.walkable&&(a=l._calcCost+o.distance(l,h),!h._visited||a<h._calcCost)){if(h._visited=!0,h._parent=l,h._calcCost=a,h._priority=a+o.distance(n,h),h===n)return Gt.PathUtil.backtrace(n);this.list.add(h)}}return null},compare:function(r,n){return r._priority-n._priority}},Gt.AStarFinder.prototype.constructor=Gt.AStarFinder,Gt.PathUtil={backtrace:function(r){for(var n=[r];r._parent;)r=r._parent,n.push(r);return n.reverse()},biBacktrace:function(r,n){var i=this.backtrace(r),o=this.backtrace(n);return i.concat(o.reverse())},pathLength:function(r){var n,i,o,l,a,u=0;for(n=1;n<r.length;++n)i=r[n-1],o=r[n],l=i[0]-o[0],a=i[1]-o[1],u+=Math.sqrt(l*l+a*a);return u},interpolate:function(r,n,i,o){var l,a,u,h,f,d,m=Math.abs,g=[];for(u=m(i-r),h=m(o-n),l=i>r?1:-1,a=o>n?1:-1,f=u-h;r!==i||n!==o;)g.push([r,n]),d=2*f,d>-h&&(f-=h,r+=l),u>d&&(f+=u,n+=a);return g},expandPath:function(r){var n,i,o,l,a,u,h=[],f=r.length;if(2>f)return h;for(a=0;f-1>a;++a)for(n=r[a],i=r[a+1],o=this.interpolate(n[0],n[1],i[0],i[1]),l=o.length,u=0;l-1>u;++u)h.push(o[u]);return h.push(r[f-1]),h},smoothenPath:function(r,n){var i,o,l,a,u,h,f,d,m,g,x,v,A=n.length,_=n[0][0],E=n[0][1],w=n[A-1][0],S=n[A-1][1];for(i=_,o=E,u=[[i,o]],f=2;A>f;++f){for(m=n[f],l=m[0],a=m[1],g=this.interpolate(i,o,l,a),v=!1,d=1;d<g.length;++d)if(x=g[d],!r.isWalkableAt(x[0],x[1])){v=!0;break}v&&(h=n[f-1],u.push(h),i=h[0],o=h[1])}return u.push([w,S]),u},compressPath:function(r){if(r.length<3)return r;var n,i,o,l,a,u,h=[],f=r[0][0],d=r[0][1],m=r[1][0],g=r[1][1],x=m-f,v=g-d;for(a=Math.sqrt(x*x+v*v),x/=a,v/=a,h.push([f,d]),u=2;u<r.length;u++)n=m,i=g,o=x,l=v,m=r[u][0],g=r[u][1],x=m-n,v=g-i,a=Math.sqrt(x*x+v*v),x/=a,v/=a,(x!==o||v!==l)&&h.push([n,i]);return h.push([m,g]),h}},Gt.Loader={manager:null,imageLoader:null,crossOrigin:!1,init:function(r){this.crossOrigin=r||!1,this.manager=new THREE.LoadingManager(function(){},function(){},function(){console.warn("Error loading images")}),this.imageLoader=new THREE.ImageLoader(this.manager),this.imageLoader.crossOrigin=r},loadTexture:function(r,n,i,o){var l=new THREE.Texture(null,n);return this.imageLoader.load(r,function(a){l.image=a,l.needsUpdate=!0,i&&i(l)},null,function(a){o&&o(a)}),l.sourceFile=r,l}},Gt.MouseCaster=function(r,n,i){this.down=!1,this.rightDown=!1,this.pickedObject=null,this.selectedObject=null,this.allHits=null,this.active=!0,this.shift=!1,this.ctrl=!1,this.wheel=0,this.position=new THREE.Vector3,this.screenPosition=new THREE.Vector2,this.signal=new Gt.Signal,this.group=r,this._camera=n,this._raycaster=new THREE.Raycaster,this._preventDefault=!1,i=i||document,i.addEventListener("mousemove",this._onDocumentMouseMove.bind(this),!1),i.addEventListener("mousedown",this._onDocumentMouseDown.bind(this),!1),i.addEventListener("mouseup",this._onDocumentMouseUp.bind(this),!1),i.addEventListener("mousewheel",this._onMouseWheel.bind(this),!1),i.addEventListener("DOMMouseScroll",this._onMouseWheel.bind(this),!1)},Gt.MouseCaster.OVER="over",Gt.MouseCaster.OUT="out",Gt.MouseCaster.DOWN="down",Gt.MouseCaster.UP="up",Gt.MouseCaster.CLICK="click",Gt.MouseCaster.WHEEL="wheel",Gt.MouseCaster.prototype={update:function(){if(this.active){this._raycaster.setFromCamera(this.screenPosition,this._camera);var r,n,i=this._raycaster.intersectObject(this.group,!0);i.length>0?(r=i[0],n=r.object.userData.structure,this.pickedObject!=n&&(this.pickedObject&&this.signal.dispatch(Gt.MouseCaster.OUT,this.pickedObject),this.pickedObject=n,this.selectedObject=null,this.signal.dispatch(Gt.MouseCaster.OVER,this.pickedObject)),this.position.copy(r.point),this.screenPosition.z=r.distance):(this.pickedObject&&this.signal.dispatch(Gt.MouseCaster.OUT,this.pickedObject),this.pickedObject=null,this.selectedObject=null),this.allHits=i}},preventDefault:function(){this._preventDefault=!0},_onDocumentMouseDown:function(r){return r=r||window.event,r.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.pickedObject&&(this.selectedObject=this.pickedObject),this.shift=r.shiftKey,this.ctrl=r.ctrlKey,this.down=r.which===1,this.rightDown=r.which===3,void this.signal.dispatch(Gt.MouseCaster.DOWN,this.pickedObject))},_onDocumentMouseUp:function(r){return r.preventDefault(),this._preventDefault?(this._preventDefault=!1,!1):(this.shift=r.shiftKey,this.ctrl=r.ctrlKey,this.signal.dispatch(Gt.MouseCaster.UP,this.pickedObject),this.selectedObject&&this.pickedObject&&this.selectedObject.uniqueID===this.pickedObject.uniqueID&&this.signal.dispatch(Gt.MouseCaster.CLICK,this.pickedObject),this.down=r.which===1?!1:this.down,void(this.rightDown=r.which===3?!1:this.rightDown))},_onDocumentMouseMove:function(r){r.preventDefault(),this.screenPosition.x=r.clientX/window.innerWidth*2-1,this.screenPosition.y=2*-(r.clientY/window.innerHeight)+1},_onMouseWheel:function(r){if(this.active){r.preventDefault(),r.stopPropagation();var n=0;r.wheelDelta!==void 0?n=r.wheelDelta:r.detail!==void 0&&(n=-r.detail),n>0?this.wheel++:this.wheel--,this.signal.dispatch(Gt.MouseCaster.WHEEL,this.wheel)}}},Gt.MouseCaster.prototype.constructor=Gt.MouseCaster,Gt.Scene=function(r,n){var i={element:document.body,alpha:!0,antialias:!0,clearColor:"#fff",sortObjects:!1,fog:null,light:new THREE.DirectionalLight(16777215),lightPosition:null,cameraType:"PerspectiveCamera",cameraPosition:null,orthoZoom:4},o={minDistance:100,maxDistance:1e3,zoomSpeed:2,noZoom:!1};if(i=Gt.Tools.merge(i,r),typeof n!="boolean"&&(o=Gt.Tools.merge(o,n)),this.renderer=new THREE.WebGLRenderer({alpha:i.alpha,antialias:i.antialias}),this.renderer.setClearColor(i.clearColor,0),this.renderer.sortObjects=i.sortObjects,this.width=window.innerWidth,this.height=window.innerHeight,this.orthoZoom=i.orthoZoom,this.container=new THREE.Scene,this.container.fog=i.fog,this.container.add(new THREE.AmbientLight(14540253)),i.lightPosition||i.light.position.set(-1,1,-1).normalize(),this.container.add(i.light),i.cameraType==="OrthographicCamera"){var l=window.innerWidth/this.orthoZoom,a=window.innerHeight/this.orthoZoom;this.camera=new THREE.OrthographicCamera(l/-2,l/2,a/2,a/-2,1,5e3)}else this.camera=new THREE.PerspectiveCamera(50,this.width/this.height,1,5e3);this.contolled=!!n,this.contolled&&(this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.minDistance=o.minDistance,this.controls.maxDistance=o.maxDistance,this.controls.zoomSpeed=o.zoomSpeed,this.controls.noZoom=o.noZoom),i.cameraPosition&&this.camera.position.copy(i.cameraPosition),window.addEventListener("resize",function(){if(this.width=window.innerWidth,this.height=window.innerHeight,this.camera.type==="OrthographicCamera"){var u=this.width/this.orthoZoom,h=this.height/this.orthoZoom;this.camera.left=u/-2,this.camera.right=u/2,this.camera.top=h/2,this.camera.bottom=h/-2}else this.camera.aspect=this.width/this.height;this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)}.bind(this),!1),this.attachTo(i.element)},Gt.Scene.prototype={attachTo:function(r){r.style.width=this.width+"px",r.style.height=this.height+"px",this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),r.appendChild(this.renderer.domElement)},add:function(r){this.container.add(r)},remove:function(r){this.container.remove(r)},render:function(){this.contolled&&this.controls.update(),this.renderer.render(this.container,this.camera)},updateOrthoZoom:function(){if(this.orthoZoom<=0)return void(this.orthoZoom=0);var r=this.width/this.orthoZoom,n=this.height/this.orthoZoom;this.camera.left=r/-2,this.camera.right=r/2,this.camera.top=n/2,this.camera.bottom=n/-2,this.camera.updateProjectionMatrix()},focusOn:function(r){this.camera.lookAt(r.position)}},Gt.Scene.prototype.constructor=Gt.Scene,Gt.SelectionManager=function(r){this.mouse=r,this.onSelect=new Gt.Signal,this.onDeselect=new Gt.Signal,this.selected=null,this.toggleSelection=!1,this.mouse.signal.add(this.onMouse,this)},Gt.SelectionManager.prototype={select:function(r,n){r&&(n=n||!0,this.selected!==r&&this.clearSelection(n),r.selected?this.toggleSelection&&(n&&this.onDeselect.dispatch(r),r.deselect()):r.select(),this.selected=r,n&&this.onSelect.dispatch(r))},clearSelection:function(r){r=r||!0,this.selected&&(r&&this.onDeselect.dispatch(this.selected),this.selected.deselect()),this.selected=null},onMouse:function(r,n){switch(r){case Gt.MouseCaster.DOWN:n||this.clearSelection();break;case Gt.MouseCaster.CLICK:this.select(n)}}},Gt.SelectionManager.prototype.constructor=Gt.SelectionManager,Gt.Tools={clamp:function(r,n,i){return Math.max(n,Math.min(i,r))},sign:function(r){return r&&r/Math.abs(r)},random:function(r,n){return arguments.length===1?Math.random()*r-.5*r:Math.random()*(n-r)+r},randomInt:function(r,n){return arguments.length===1?Math.random()*r-.5*r|0:Math.random()*(n-r+1)+r|0},normalize:function(r,n,i){return(r-n)/(i-n)},getShortRotation:function(r){return r%=this.TAU,r>this.PI?r-=this.TAU:r<-this.PI&&(r+=this.TAU),r},generateID:function(){return Math.random().toString(36).slice(2)+Date.now()},isPlainObject:function(r){if(typeof r!="object"||r.nodeType||r===r.window)return!1;try{if(r.constructor&&!Object.prototype.hasOwnProperty.call(r.constructor.prototype,"isPrototypeOf"))return!1}catch{return!1}return!0},merge:function(r,n){var i=this,o=Array.isArray(n),l=o&&[]||{};return o?(r=r||[],l=l.concat(r),n.forEach(function(a,u){typeof l[u]>"u"?l[u]=a:i.isPlainObject(a)?l[u]=i.merge(r[u],a):r.indexOf(a)===-1&&l.push(a)}),l):(r&&i.isPlainObject(r)&&Object.keys(r).forEach(function(a){l[a]=r[a]}),Object.keys(n).forEach(function(a){n[a]&&i.isPlainObject(n[a])&&r[a]?l[a]=i.merge(r[a],n[a]):l[a]=n[a]}),l)},now:function(){return window.nwf?window.nwf.system.Performance.elapsedTime:window.performance.now()},empty:function(r){for(;r.lastChild;)r.removeChild(r.lastChild)},radixSort:function(r,n,i,o){if(n=n||0,i=i||r.length,o=o||31,!(n>=i-1||0>o)){for(var l=n,a=i,u=1<<o;a>l;)if(r[l]&u){--a;var h=r[l];r[l]=r[a],r[a]=h}else++l;this.radixSort(r,n,a,o-1),this.radixSort(r,a,i,o-1)}},randomizeRGB:function(r,n){var i,o,l=r.split(","),a="rgb(";for(n=this.randomInt(n),i=0;3>i;i++)o=parseInt(l[i])+n,0>o?o=0:o>255&&(o=255),a+=o+",";return a=a.substring(0,a.length-1),a+=")"},getJSON:function(r){var n=new XMLHttpRequest,i=typeof r.cache>"u"?!1:r.cache,o=i?r.url:r.url+"?t="+Math.floor(1e4*Math.random())+Date.now();n.onreadystatechange=function(){if(this.status===200){var l=null;try{l=JSON.parse(this.responseText)}catch{return}return void r.callback.call(r.scope||null,l)}this.status!==0&&console.warn("[Tools.getJSON] Error: "+this.status+" ("+this.statusText+") :: "+r.url)},n.open("GET",o,!0),n.setRequestHeader("Accept","application/json"),n.setRequestHeader("Content-Type","application/json"),n.send("")}};var XH={size:5,cellSize:10,extrudeSettings:{amount:1,bevelEnabled:!0,bevelSegments:1,steps:1,bevelSize:.5,bevelThickness:.5},autogenerated:!0,cells:[{q:-1,r:0,s:1,h:1,walkable:!0,userData:{}},{q:0,r:-1,s:1,h:1,walkable:!0,userData:{}},{q:0,r:0,s:0,h:1,walkable:!0,userData:{}},{q:1,r:-1,s:0,h:1,walkable:!0,userData:{}},{q:-1,r:1,s:0,h:0,walkable:!0,userData:{}},{q:0,r:1,s:-1,h:0,walkable:!0,userData:{}},{q:1,r:0,s:-1,h:0,walkable:!0,userData:{}}]};const wC=JD.exports,qH=XH;AFRAME.registerPrimitive("a-hexgrid",{defaultComponents:{hexgrid:{}},mappings:{src:"hexgrid.src"}});AFRAME.registerComponent("hexgrid",{dependencies:["material"],schema:{src:{type:"asset"}},init:function(){const r=this.data;r.src?fetch(r.src).then(n=>n.json()).then(n=>this.addMesh(n)):this.addMesh(qH)},addMesh:function(r){const n=new wC.HexGrid;n.fromJSON(r);const i=new wC.Board(n);i.generateTilemap(),this.el.setObject3D("mesh",i.group),this.addMaterial()},addMaterial:function(){const n=(this.el.components.material||{}).material;!n||this.el.object3D.traverse(i=>{i.isMesh&&(i.material=n)})},remove:function(){this.el.removeObject3D("mesh")}});AFRAME.registerPrimitive("a-ocean",{defaultComponents:{ocean:{},rotation:{x:-90,y:0,z:0}},mappings:{width:"ocean.width",depth:"ocean.depth",density:"ocean.density",amplitude:"ocean.amplitude",amplitudeVariance:"ocean.amplitudeVariance",speed:"ocean.speed",speedVariance:"ocean.speedVariance",color:"ocean.color",opacity:"ocean.opacity"}});AFRAME.registerComponent("ocean",{schema:{width:{default:10,min:0},depth:{default:10,min:0},density:{default:10},amplitude:{default:.1},amplitudeVariance:{default:.3},speed:{default:1},speedVariance:{default:2},color:{default:"#7AD2F7",type:"color"},opacity:{default:.8}},play:function(){const r=this.el,n=this.data;let i=r.components.material;const o=new THREE.PlaneGeometry(n.width,n.depth,n.density,n.density);o.mergeVertices(),this.waves=[];for(let l,a=0,u=o.vertices.length;a<u;a++)l=o.vertices[a],this.waves.push({z:l.z,ang:Math.random()*Math.PI*2,amp:n.amplitude+Math.random()*n.amplitudeVariance,speed:(n.speed+Math.random()*n.speedVariance)/1e3});i||(i={},i.material=new THREE.MeshPhongMaterial({color:n.color,transparent:n.opacity<1,opacity:n.opacity,shading:THREE.FlatShading})),this.mesh=new THREE.Mesh(o,i.material),r.setObject3D("mesh",this.mesh)},remove:function(){this.el.removeObject3D("mesh")},tick:function(r,n){if(!n)return;const i=this.mesh.geometry.vertices;for(let o,l,a=0;o=i[a];a++)l=this.waves[a],o.z=l.z+Math.sin(l.ang)*l.amp,l.ang+=l.speed*n;this.mesh.geometry.verticesNeedUpdate=!0}});AFRAME.registerPrimitive("a-tube",{defaultComponents:{tube:{}},mappings:{path:"tube.path",segments:"tube.segments",radius:"tube.radius","radial-segments":"tube.radialSegments",closed:"tube.closed"}});AFRAME.registerComponent("tube",{schema:{path:{default:[]},segments:{default:64},radius:{default:1},radialSegments:{default:8},closed:{default:!1}},init:function(){const r=this.el,n=this.data;let i=r.components.material;if(!n.path.length){console.error("[a-tube] `path` property expected but not found.");return}const o=new THREE.CatmullRomCurve3(n.path.map(function(a){return a=a.split(" "),new THREE.Vector3(Number(a[0]),Number(a[1]),Number(a[2]))})),l=new THREE.TubeGeometry(o,n.segments,n.radius,n.radialSegments,n.closed);i||(i={},i.material=new THREE.MeshPhongMaterial),this.mesh=new THREE.Mesh(l,i.material),this.el.setObject3D("mesh",this.mesh)},update:function(r){!Object.keys(r).length||(this.remove(),this.init())},remove:function(){this.mesh&&this.el.removeObject3D("mesh")}});var Wn=function(r){return r instanceof Function?r:typeof r=="string"?function(n){return n[r]}:function(n){return r}};const YH=Object.freeze(Object.defineProperty({__proto__:null,default:Wn},Symbol.toStringTag,{value:"Module"})),KH=MA(YH);/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const _w="148",Aa={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Gh={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},QH=0,MC=1,ZH=2,eO=1,JH=2,Pp=3,zu=0,ro=1,bw=2,Rv=3,wc=0,Nd=1,SC=2,TC=3,CC=4,eG=5,cd=100,tG=101,nG=102,RC=103,LC=104,iG=200,rG=201,sG=202,oG=203,tO=204,nO=205,aG=206,lG=207,cG=208,uG=209,hG=210,dG=0,fG=1,pG=2,IE=3,mG=4,gG=5,vG=6,yG=7,Ew=0,xG=1,_G=2,gl=0,bG=1,EG=2,AG=3,wG=4,MG=5,iO=300,Xd=301,qd=302,kE=303,NE=304,Wy=306,FE=1e3,qo=1001,BE=1002,Ss=1003,PC=1004,_b=1005,xo=1006,SG=1007,vm=1008,Hu=1009,TG=1010,CG=1011,rO=1012,RG=1013,Au=1014,wu=1015,ym=1016,LG=1017,PG=1018,Fd=1020,DG=1021,OG=1022,Yo=1023,IG=1024,kG=1025,Pu=1026,Yd=1027,NG=1028,FG=1029,BG=1030,UG=1031,zG=1033,bb=33776,Eb=33777,Ab=33778,wb=33779,DC=35840,OC=35841,IC=35842,kC=35843,HG=36196,NC=37492,FC=37496,BC=37808,UC=37809,zC=37810,HC=37811,GC=37812,VC=37813,WC=37814,jC=37815,$C=37816,XC=37817,qC=37818,YC=37819,KC=37820,QC=37821,ZC=36492,Gu=3e3,pr=3001,GG=3200,VG=3201,sO=0,WG=1,Ea="srgb",xm="srgb-linear",Mb=7680,jG=519,JC=35044,e3="300 es",UE=1035;class ra{addEventListener(n,i){this._listeners===void 0&&(this._listeners={});const o=this._listeners;o[n]===void 0&&(o[n]=[]),o[n].indexOf(i)===-1&&o[n].push(i)}hasEventListener(n,i){if(this._listeners===void 0)return!1;const o=this._listeners;return o[n]!==void 0&&o[n].indexOf(i)!==-1}removeEventListener(n,i){if(this._listeners===void 0)return;const l=this._listeners[n];if(l!==void 0){const a=l.indexOf(i);a!==-1&&l.splice(a,1)}}dispatchEvent(n){if(this._listeners===void 0)return;const o=this._listeners[n.type];if(o!==void 0){n.target=this;const l=o.slice(0);for(let a=0,u=l.length;a<u;a++)l[a].call(this,n);n.target=null}}}const ms=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],Sb=Math.PI/180,t3=180/Math.PI;function Im(){const r=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0,o=Math.random()*4294967295|0;return(ms[r&255]+ms[r>>8&255]+ms[r>>16&255]+ms[r>>24&255]+"-"+ms[n&255]+ms[n>>8&255]+"-"+ms[n>>16&15|64]+ms[n>>24&255]+"-"+ms[i&63|128]+ms[i>>8&255]+"-"+ms[i>>16&255]+ms[i>>24&255]+ms[o&255]+ms[o>>8&255]+ms[o>>16&255]+ms[o>>24&255]).toLowerCase()}function ys(r,n,i){return Math.max(n,Math.min(i,r))}function $G(r,n){return(r%n+n)%n}function Tb(r,n,i){return(1-i)*r+i*n}function n3(r){return(r&r-1)===0&&r!==0}function zE(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function Lv(r,n){switch(n.constructor){case Float32Array:return r;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function Qs(r,n){switch(n.constructor){case Float32Array:return r;case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}class Rn{constructor(n=0,i=0){Rn.prototype.isVector2=!0,this.x=n,this.y=i}get width(){return this.x}set width(n){this.x=n}get height(){return this.y}set height(n){this.y=n}set(n,i){return this.x=n,this.y=i,this}setScalar(n){return this.x=n,this.y=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setComponent(n,i){switch(n){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y)}copy(n){return this.x=n.x,this.y=n.y,this}add(n){return this.x+=n.x,this.y+=n.y,this}addScalar(n){return this.x+=n,this.y+=n,this}addVectors(n,i){return this.x=n.x+i.x,this.y=n.y+i.y,this}addScaledVector(n,i){return this.x+=n.x*i,this.y+=n.y*i,this}sub(n){return this.x-=n.x,this.y-=n.y,this}subScalar(n){return this.x-=n,this.y-=n,this}subVectors(n,i){return this.x=n.x-i.x,this.y=n.y-i.y,this}multiply(n){return this.x*=n.x,this.y*=n.y,this}multiplyScalar(n){return this.x*=n,this.y*=n,this}divide(n){return this.x/=n.x,this.y/=n.y,this}divideScalar(n){return this.multiplyScalar(1/n)}applyMatrix3(n){const i=this.x,o=this.y,l=n.elements;return this.x=l[0]*i+l[3]*o+l[6],this.y=l[1]*i+l[4]*o+l[7],this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this}clamp(n,i){return this.x=Math.max(n.x,Math.min(i.x,this.x)),this.y=Math.max(n.y,Math.min(i.y,this.y)),this}clampScalar(n,i){return this.x=Math.max(n,Math.min(i,this.x)),this.y=Math.max(n,Math.min(i,this.y)),this}clampLength(n,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(n,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(n){return this.x*n.x+this.y*n.y}cross(n){return this.x*n.y-this.y*n.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const i=this.x-n.x,o=this.y-n.y;return i*i+o*o}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,i){return this.x+=(n.x-this.x)*i,this.y+=(n.y-this.y)*i,this}lerpVectors(n,i,o){return this.x=n.x+(i.x-n.x)*o,this.y=n.y+(i.y-n.y)*o,this}equals(n){return n.x===this.x&&n.y===this.y}fromArray(n,i=0){return this.x=n[i],this.y=n[i+1],this}toArray(n=[],i=0){return n[i]=this.x,n[i+1]=this.y,n}fromBufferAttribute(n,i){return this.x=n.getX(i),this.y=n.getY(i),this}rotateAround(n,i){const o=Math.cos(i),l=Math.sin(i),a=this.x-n.x,u=this.y-n.y;return this.x=a*o-u*l+n.x,this.y=a*l+u*o+n.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class no{constructor(){no.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1]}set(n,i,o,l,a,u,h,f,d){const m=this.elements;return m[0]=n,m[1]=l,m[2]=h,m[3]=i,m[4]=a,m[5]=f,m[6]=o,m[7]=u,m[8]=d,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(n){const i=this.elements,o=n.elements;return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],this}extractBasis(n,i,o){return n.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),o.setFromMatrix3Column(this,2),this}setFromMatrix4(n){const i=n.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(n){return this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,i){const o=n.elements,l=i.elements,a=this.elements,u=o[0],h=o[3],f=o[6],d=o[1],m=o[4],g=o[7],x=o[2],v=o[5],A=o[8],_=l[0],E=l[3],w=l[6],S=l[1],T=l[4],R=l[7],L=l[2],I=l[5],N=l[8];return a[0]=u*_+h*S+f*L,a[3]=u*E+h*T+f*I,a[6]=u*w+h*R+f*N,a[1]=d*_+m*S+g*L,a[4]=d*E+m*T+g*I,a[7]=d*w+m*R+g*N,a[2]=x*_+v*S+A*L,a[5]=x*E+v*T+A*I,a[8]=x*w+v*R+A*N,this}multiplyScalar(n){const i=this.elements;return i[0]*=n,i[3]*=n,i[6]*=n,i[1]*=n,i[4]*=n,i[7]*=n,i[2]*=n,i[5]*=n,i[8]*=n,this}determinant(){const n=this.elements,i=n[0],o=n[1],l=n[2],a=n[3],u=n[4],h=n[5],f=n[6],d=n[7],m=n[8];return i*u*m-i*h*d-o*a*m+o*h*f+l*a*d-l*u*f}invert(){const n=this.elements,i=n[0],o=n[1],l=n[2],a=n[3],u=n[4],h=n[5],f=n[6],d=n[7],m=n[8],g=m*u-h*d,x=h*f-m*a,v=d*a-u*f,A=i*g+o*x+l*v;if(A===0)return this.set(0,0,0,0,0,0,0,0,0);const _=1/A;return n[0]=g*_,n[1]=(l*d-m*o)*_,n[2]=(h*o-l*u)*_,n[3]=x*_,n[4]=(m*i-l*f)*_,n[5]=(l*a-h*i)*_,n[6]=v*_,n[7]=(o*f-d*i)*_,n[8]=(u*i-o*a)*_,this}transpose(){let n;const i=this.elements;return n=i[1],i[1]=i[3],i[3]=n,n=i[2],i[2]=i[6],i[6]=n,n=i[5],i[5]=i[7],i[7]=n,this}getNormalMatrix(n){return this.setFromMatrix4(n).invert().transpose()}transposeIntoArray(n){const i=this.elements;return n[0]=i[0],n[1]=i[3],n[2]=i[6],n[3]=i[1],n[4]=i[4],n[5]=i[7],n[6]=i[2],n[7]=i[5],n[8]=i[8],this}setUvTransform(n,i,o,l,a,u,h){const f=Math.cos(a),d=Math.sin(a);return this.set(o*f,o*d,-o*(f*u+d*h)+u+n,-l*d,l*f,-l*(-d*u+f*h)+h+i,0,0,1),this}scale(n,i){return this.premultiply(Cb.makeScale(n,i)),this}rotate(n){return this.premultiply(Cb.makeRotation(-n)),this}translate(n,i){return this.premultiply(Cb.makeTranslation(n,i)),this}makeTranslation(n,i){return this.set(1,0,n,0,1,i,0,0,1),this}makeRotation(n){const i=Math.cos(n),o=Math.sin(n);return this.set(i,-o,0,o,i,0,0,0,1),this}makeScale(n,i){return this.set(n,0,0,0,i,0,0,0,1),this}equals(n){const i=this.elements,o=n.elements;for(let l=0;l<9;l++)if(i[l]!==o[l])return!1;return!0}fromArray(n,i=0){for(let o=0;o<9;o++)this.elements[o]=n[o+i];return this}toArray(n=[],i=0){const o=this.elements;return n[i]=o[0],n[i+1]=o[1],n[i+2]=o[2],n[i+3]=o[3],n[i+4]=o[4],n[i+5]=o[5],n[i+6]=o[6],n[i+7]=o[7],n[i+8]=o[8],n}clone(){return new this.constructor().fromArray(this.elements)}}const Cb=new no;function oO(r){for(let n=r.length-1;n>=0;--n)if(r[n]>=65535)return!0;return!1}function _m(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function Du(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function L0(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}const Rb={[Ea]:{[xm]:Du},[xm]:{[Ea]:L0}},As={legacyMode:!0,get workingColorSpace(){return xm},set workingColorSpace(r){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(r,n,i){if(this.legacyMode||n===i||!n||!i)return r;if(Rb[n]&&Rb[n][i]!==void 0){const o=Rb[n][i];return r.r=o(r.r),r.g=o(r.g),r.b=o(r.b),r}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(r,n){return this.convert(r,this.workingColorSpace,n)},toWorkingColorSpace:function(r,n){return this.convert(r,n,this.workingColorSpace)}},aO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vr={r:0,g:0,b:0},zo={h:0,s:0,l:0},Pv={h:0,s:0,l:0};function Lb(r,n,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?r+(n-r)*6*i:i<1/2?n:i<2/3?r+(n-r)*6*(2/3-i):r}function Dv(r,n){return n.r=r.r,n.g=r.g,n.b=r.b,n}class Ji{constructor(n,i,o){return this.isColor=!0,this.r=1,this.g=1,this.b=1,i===void 0&&o===void 0?this.set(n):this.setRGB(n,i,o)}set(n){return n&&n.isColor?this.copy(n):typeof n=="number"?this.setHex(n):typeof n=="string"&&this.setStyle(n),this}setScalar(n){return this.r=n,this.g=n,this.b=n,this}setHex(n,i=Ea){return n=Math.floor(n),this.r=(n>>16&255)/255,this.g=(n>>8&255)/255,this.b=(n&255)/255,As.toWorkingColorSpace(this,i),this}setRGB(n,i,o,l=As.workingColorSpace){return this.r=n,this.g=i,this.b=o,As.toWorkingColorSpace(this,l),this}setHSL(n,i,o,l=As.workingColorSpace){if(n=$G(n,1),i=ys(i,0,1),o=ys(o,0,1),i===0)this.r=this.g=this.b=o;else{const a=o<=.5?o*(1+i):o+i-o*i,u=2*o-a;this.r=Lb(u,a,n+1/3),this.g=Lb(u,a,n),this.b=Lb(u,a,n-1/3)}return As.toWorkingColorSpace(this,l),this}setStyle(n,i=Ea){function o(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+n+" will be ignored.")}let l;if(l=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(n)){let a;const u=l[1],h=l[2];switch(u){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(255,parseInt(a[1],10))/255,this.g=Math.min(255,parseInt(a[2],10))/255,this.b=Math.min(255,parseInt(a[3],10))/255,As.toWorkingColorSpace(this,i),o(a[4]),this;if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h))return this.r=Math.min(100,parseInt(a[1],10))/100,this.g=Math.min(100,parseInt(a[2],10))/100,this.b=Math.min(100,parseInt(a[3],10))/100,As.toWorkingColorSpace(this,i),o(a[4]),this;break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(h)){const f=parseFloat(a[1])/360,d=parseFloat(a[2])/100,m=parseFloat(a[3])/100;return o(a[4]),this.setHSL(f,d,m,i)}break}}else if(l=/^\#([A-Fa-f\d]+)$/.exec(n)){const a=l[1],u=a.length;if(u===3)return this.r=parseInt(a.charAt(0)+a.charAt(0),16)/255,this.g=parseInt(a.charAt(1)+a.charAt(1),16)/255,this.b=parseInt(a.charAt(2)+a.charAt(2),16)/255,As.toWorkingColorSpace(this,i),this;if(u===6)return this.r=parseInt(a.charAt(0)+a.charAt(1),16)/255,this.g=parseInt(a.charAt(2)+a.charAt(3),16)/255,this.b=parseInt(a.charAt(4)+a.charAt(5),16)/255,As.toWorkingColorSpace(this,i),this}return n&&n.length>0?this.setColorName(n,i):this}setColorName(n,i=Ea){const o=aO[n.toLowerCase()];return o!==void 0?this.setHex(o,i):console.warn("THREE.Color: Unknown color "+n),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(n){return this.r=n.r,this.g=n.g,this.b=n.b,this}copySRGBToLinear(n){return this.r=Du(n.r),this.g=Du(n.g),this.b=Du(n.b),this}copyLinearToSRGB(n){return this.r=L0(n.r),this.g=L0(n.g),this.b=L0(n.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(n=Ea){return As.fromWorkingColorSpace(Dv(this,Vr),n),ys(Vr.r*255,0,255)<<16^ys(Vr.g*255,0,255)<<8^ys(Vr.b*255,0,255)<<0}getHexString(n=Ea){return("000000"+this.getHex(n).toString(16)).slice(-6)}getHSL(n,i=As.workingColorSpace){As.fromWorkingColorSpace(Dv(this,Vr),i);const o=Vr.r,l=Vr.g,a=Vr.b,u=Math.max(o,l,a),h=Math.min(o,l,a);let f,d;const m=(h+u)/2;if(h===u)f=0,d=0;else{const g=u-h;switch(d=m<=.5?g/(u+h):g/(2-u-h),u){case o:f=(l-a)/g+(l<a?6:0);break;case l:f=(a-o)/g+2;break;case a:f=(o-l)/g+4;break}f/=6}return n.h=f,n.s=d,n.l=m,n}getRGB(n,i=As.workingColorSpace){return As.fromWorkingColorSpace(Dv(this,Vr),i),n.r=Vr.r,n.g=Vr.g,n.b=Vr.b,n}getStyle(n=Ea){return As.fromWorkingColorSpace(Dv(this,Vr),n),n!==Ea?`color(${n} ${Vr.r} ${Vr.g} ${Vr.b})`:`rgb(${Vr.r*255|0},${Vr.g*255|0},${Vr.b*255|0})`}offsetHSL(n,i,o){return this.getHSL(zo),zo.h+=n,zo.s+=i,zo.l+=o,this.setHSL(zo.h,zo.s,zo.l),this}add(n){return this.r+=n.r,this.g+=n.g,this.b+=n.b,this}addColors(n,i){return this.r=n.r+i.r,this.g=n.g+i.g,this.b=n.b+i.b,this}addScalar(n){return this.r+=n,this.g+=n,this.b+=n,this}sub(n){return this.r=Math.max(0,this.r-n.r),this.g=Math.max(0,this.g-n.g),this.b=Math.max(0,this.b-n.b),this}multiply(n){return this.r*=n.r,this.g*=n.g,this.b*=n.b,this}multiplyScalar(n){return this.r*=n,this.g*=n,this.b*=n,this}lerp(n,i){return this.r+=(n.r-this.r)*i,this.g+=(n.g-this.g)*i,this.b+=(n.b-this.b)*i,this}lerpColors(n,i,o){return this.r=n.r+(i.r-n.r)*o,this.g=n.g+(i.g-n.g)*o,this.b=n.b+(i.b-n.b)*o,this}lerpHSL(n,i){this.getHSL(zo),n.getHSL(Pv);const o=Tb(zo.h,Pv.h,i),l=Tb(zo.s,Pv.s,i),a=Tb(zo.l,Pv.l,i);return this.setHSL(o,l,a),this}equals(n){return n.r===this.r&&n.g===this.g&&n.b===this.b}fromArray(n,i=0){return this.r=n[i],this.g=n[i+1],this.b=n[i+2],this}toArray(n=[],i=0){return n[i]=this.r,n[i+1]=this.g,n[i+2]=this.b,n}fromBufferAttribute(n,i){return this.r=n.getX(i),this.g=n.getY(i),this.b=n.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}Ji.NAMES=aO;let Vh;class lO{static getDataURL(n){if(/^data:/i.test(n.src)||typeof HTMLCanvasElement>"u")return n.src;let i;if(n instanceof HTMLCanvasElement)i=n;else{Vh===void 0&&(Vh=_m("canvas")),Vh.width=n.width,Vh.height=n.height;const o=Vh.getContext("2d");n instanceof ImageData?o.putImageData(n,0,0):o.drawImage(n,0,0,n.width,n.height),i=Vh}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",n),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(n){if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap){const i=_m("canvas");i.width=n.width,i.height=n.height;const o=i.getContext("2d");o.drawImage(n,0,0,n.width,n.height);const l=o.getImageData(0,0,n.width,n.height),a=l.data;for(let u=0;u<a.length;u++)a[u]=Du(a[u]/255)*255;return o.putImageData(l,0,0),i}else if(n.data){const i=n.data.slice(0);for(let o=0;o<i.length;o++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[o]=Math.floor(Du(i[o]/255)*255):i[o]=Du(i[o]);return{data:i,width:n.width,height:n.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),n}}class cO{constructor(n=null){this.isSource=!0,this.uuid=Im(),this.data=n,this.version=0}set needsUpdate(n){n===!0&&this.version++}toJSON(n){const i=n===void 0||typeof n=="string";if(!i&&n.images[this.uuid]!==void 0)return n.images[this.uuid];const o={uuid:this.uuid,url:""},l=this.data;if(l!==null){let a;if(Array.isArray(l)){a=[];for(let u=0,h=l.length;u<h;u++)l[u].isDataTexture?a.push(Pb(l[u].image)):a.push(Pb(l[u]))}else a=Pb(l);o.url=a}return i||(n.images[this.uuid]=o),o}}function Pb(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?lO.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let XG=0;class Gs extends ra{constructor(n=Gs.DEFAULT_IMAGE,i=Gs.DEFAULT_MAPPING,o=qo,l=qo,a=xo,u=vm,h=Yo,f=Hu,d=Gs.DEFAULT_ANISOTROPY,m=Gu){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:XG++}),this.uuid=Im(),this.name="",this.source=new cO(n),this.mipmaps=[],this.mapping=i,this.wrapS=o,this.wrapT=l,this.magFilter=a,this.minFilter=u,this.anisotropy=d,this.format=h,this.internalFormat=null,this.type=f,this.offset=new Rn(0,0),this.repeat=new Rn(1,1),this.center=new Rn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new no,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=m,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(n){this.source.data=n}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(n){return this.name=n.name,this.source=n.source,this.mipmaps=n.mipmaps.slice(0),this.mapping=n.mapping,this.wrapS=n.wrapS,this.wrapT=n.wrapT,this.magFilter=n.magFilter,this.minFilter=n.minFilter,this.anisotropy=n.anisotropy,this.format=n.format,this.internalFormat=n.internalFormat,this.type=n.type,this.offset.copy(n.offset),this.repeat.copy(n.repeat),this.center.copy(n.center),this.rotation=n.rotation,this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrix.copy(n.matrix),this.generateMipmaps=n.generateMipmaps,this.premultiplyAlpha=n.premultiplyAlpha,this.flipY=n.flipY,this.unpackAlignment=n.unpackAlignment,this.encoding=n.encoding,this.userData=JSON.parse(JSON.stringify(n.userData)),this.needsUpdate=!0,this}toJSON(n){const i=n===void 0||typeof n=="string";if(!i&&n.textures[this.uuid]!==void 0)return n.textures[this.uuid];const o={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(n).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(o.userData=this.userData),i||(n.textures[this.uuid]=o),o}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(n){if(this.mapping!==iO)return n;if(n.applyMatrix3(this.matrix),n.x<0||n.x>1)switch(this.wrapS){case FE:n.x=n.x-Math.floor(n.x);break;case qo:n.x=n.x<0?0:1;break;case BE:Math.abs(Math.floor(n.x)%2)===1?n.x=Math.ceil(n.x)-n.x:n.x=n.x-Math.floor(n.x);break}if(n.y<0||n.y>1)switch(this.wrapT){case FE:n.y=n.y-Math.floor(n.y);break;case qo:n.y=n.y<0?0:1;break;case BE:Math.abs(Math.floor(n.y)%2)===1?n.y=Math.ceil(n.y)-n.y:n.y=n.y-Math.floor(n.y);break}return this.flipY&&(n.y=1-n.y),n}set needsUpdate(n){n===!0&&(this.version++,this.source.needsUpdate=!0)}}Gs.DEFAULT_IMAGE=null;Gs.DEFAULT_MAPPING=iO;Gs.DEFAULT_ANISOTROPY=1;class ts{constructor(n=0,i=0,o=0,l=1){ts.prototype.isVector4=!0,this.x=n,this.y=i,this.z=o,this.w=l}get width(){return this.z}set width(n){this.z=n}get height(){return this.w}set height(n){this.w=n}set(n,i,o,l){return this.x=n,this.y=i,this.z=o,this.w=l,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this.w=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setW(n){return this.w=n,this}setComponent(n,i){switch(n){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=n.w!==void 0?n.w:1,this}add(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this.w+=n.w,this}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this.w+=n,this}addVectors(n,i){return this.x=n.x+i.x,this.y=n.y+i.y,this.z=n.z+i.z,this.w=n.w+i.w,this}addScaledVector(n,i){return this.x+=n.x*i,this.y+=n.y*i,this.z+=n.z*i,this.w+=n.w*i,this}sub(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this.w-=n.w,this}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this.w-=n,this}subVectors(n,i){return this.x=n.x-i.x,this.y=n.y-i.y,this.z=n.z-i.z,this.w=n.w-i.w,this}multiply(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this.w*=n.w,this}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this}applyMatrix4(n){const i=this.x,o=this.y,l=this.z,a=this.w,u=n.elements;return this.x=u[0]*i+u[4]*o+u[8]*l+u[12]*a,this.y=u[1]*i+u[5]*o+u[9]*l+u[13]*a,this.z=u[2]*i+u[6]*o+u[10]*l+u[14]*a,this.w=u[3]*i+u[7]*o+u[11]*l+u[15]*a,this}divideScalar(n){return this.multiplyScalar(1/n)}setAxisAngleFromQuaternion(n){this.w=2*Math.acos(n.w);const i=Math.sqrt(1-n.w*n.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=n.x/i,this.y=n.y/i,this.z=n.z/i),this}setAxisAngleFromRotationMatrix(n){let i,o,l,a;const f=n.elements,d=f[0],m=f[4],g=f[8],x=f[1],v=f[5],A=f[9],_=f[2],E=f[6],w=f[10];if(Math.abs(m-x)<.01&&Math.abs(g-_)<.01&&Math.abs(A-E)<.01){if(Math.abs(m+x)<.1&&Math.abs(g+_)<.1&&Math.abs(A+E)<.1&&Math.abs(d+v+w-3)<.1)return this.set(1,0,0,0),this;i=Math.PI;const T=(d+1)/2,R=(v+1)/2,L=(w+1)/2,I=(m+x)/4,N=(g+_)/4,B=(A+E)/4;return T>R&&T>L?T<.01?(o=0,l=.707106781,a=.707106781):(o=Math.sqrt(T),l=I/o,a=N/o):R>L?R<.01?(o=.707106781,l=0,a=.707106781):(l=Math.sqrt(R),o=I/l,a=B/l):L<.01?(o=.707106781,l=.707106781,a=0):(a=Math.sqrt(L),o=N/a,l=B/a),this.set(o,l,a,i),this}let S=Math.sqrt((E-A)*(E-A)+(g-_)*(g-_)+(x-m)*(x-m));return Math.abs(S)<.001&&(S=1),this.x=(E-A)/S,this.y=(g-_)/S,this.z=(x-m)/S,this.w=Math.acos((d+v+w-1)/2),this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this.w=Math.min(this.w,n.w),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this.w=Math.max(this.w,n.w),this}clamp(n,i){return this.x=Math.max(n.x,Math.min(i.x,this.x)),this.y=Math.max(n.y,Math.min(i.y,this.y)),this.z=Math.max(n.z,Math.min(i.z,this.z)),this.w=Math.max(n.w,Math.min(i.w,this.w)),this}clampScalar(n,i){return this.x=Math.max(n,Math.min(i,this.x)),this.y=Math.max(n,Math.min(i,this.y)),this.z=Math.max(n,Math.min(i,this.z)),this.w=Math.max(n,Math.min(i,this.w)),this}clampLength(n,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(n,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,i){return this.x+=(n.x-this.x)*i,this.y+=(n.y-this.y)*i,this.z+=(n.z-this.z)*i,this.w+=(n.w-this.w)*i,this}lerpVectors(n,i,o){return this.x=n.x+(i.x-n.x)*o,this.y=n.y+(i.y-n.y)*o,this.z=n.z+(i.z-n.z)*o,this.w=n.w+(i.w-n.w)*o,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z&&n.w===this.w}fromArray(n,i=0){return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this.w=n[i+3],this}toArray(n=[],i=0){return n[i]=this.x,n[i+1]=this.y,n[i+2]=this.z,n[i+3]=this.w,n}fromBufferAttribute(n,i){return this.x=n.getX(i),this.y=n.getY(i),this.z=n.getZ(i),this.w=n.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Tc extends ra{constructor(n=1,i=1,o={}){super(),this.isWebGLRenderTarget=!0,this.width=n,this.height=i,this.depth=1,this.scissor=new ts(0,0,n,i),this.scissorTest=!1,this.viewport=new ts(0,0,n,i);const l={width:n,height:i,depth:1};this.texture=new Gs(l,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=o.generateMipmaps!==void 0?o.generateMipmaps:!1,this.texture.internalFormat=o.internalFormat!==void 0?o.internalFormat:null,this.texture.minFilter=o.minFilter!==void 0?o.minFilter:xo,this.depthBuffer=o.depthBuffer!==void 0?o.depthBuffer:!0,this.stencilBuffer=o.stencilBuffer!==void 0?o.stencilBuffer:!1,this.depthTexture=o.depthTexture!==void 0?o.depthTexture:null,this.samples=o.samples!==void 0?o.samples:0}setSize(n,i,o=1){(this.width!==n||this.height!==i||this.depth!==o)&&(this.width=n,this.height=i,this.depth=o,this.texture.image.width=n,this.texture.image.height=i,this.texture.image.depth=o,this.dispose()),this.viewport.set(0,0,n,i),this.scissor.set(0,0,n,i)}clone(){return new this.constructor().copy(this)}copy(n){this.width=n.width,this.height=n.height,this.depth=n.depth,this.viewport.copy(n.viewport),this.texture=n.texture.clone(),this.texture.isRenderTargetTexture=!0;const i=Object.assign({},n.texture.image);return this.texture.source=new cO(i),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,n.depthTexture!==null&&(this.depthTexture=n.depthTexture.clone()),this.samples=n.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class uO extends Gs{constructor(n=null,i=1,o=1,l=1){super(null),this.isDataArrayTexture=!0,this.image={data:n,width:i,height:o,depth:l},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=qo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class qG extends Gs{constructor(n=null,i=1,o=1,l=1){super(null),this.isData3DTexture=!0,this.image={data:n,width:i,height:o,depth:l},this.magFilter=Ss,this.minFilter=Ss,this.wrapR=qo,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ia{constructor(n=0,i=0,o=0,l=1){this.isQuaternion=!0,this._x=n,this._y=i,this._z=o,this._w=l}static slerpFlat(n,i,o,l,a,u,h){let f=o[l+0],d=o[l+1],m=o[l+2],g=o[l+3];const x=a[u+0],v=a[u+1],A=a[u+2],_=a[u+3];if(h===0){n[i+0]=f,n[i+1]=d,n[i+2]=m,n[i+3]=g;return}if(h===1){n[i+0]=x,n[i+1]=v,n[i+2]=A,n[i+3]=_;return}if(g!==_||f!==x||d!==v||m!==A){let E=1-h;const w=f*x+d*v+m*A+g*_,S=w>=0?1:-1,T=1-w*w;if(T>Number.EPSILON){const L=Math.sqrt(T),I=Math.atan2(L,w*S);E=Math.sin(E*I)/L,h=Math.sin(h*I)/L}const R=h*S;if(f=f*E+x*R,d=d*E+v*R,m=m*E+A*R,g=g*E+_*R,E===1-h){const L=1/Math.sqrt(f*f+d*d+m*m+g*g);f*=L,d*=L,m*=L,g*=L}}n[i]=f,n[i+1]=d,n[i+2]=m,n[i+3]=g}static multiplyQuaternionsFlat(n,i,o,l,a,u){const h=o[l],f=o[l+1],d=o[l+2],m=o[l+3],g=a[u],x=a[u+1],v=a[u+2],A=a[u+3];return n[i]=h*A+m*g+f*v-d*x,n[i+1]=f*A+m*x+d*g-h*v,n[i+2]=d*A+m*v+h*x-f*g,n[i+3]=m*A-h*g-f*x-d*v,n}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get w(){return this._w}set w(n){this._w=n,this._onChangeCallback()}set(n,i,o,l){return this._x=n,this._y=i,this._z=o,this._w=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(n){return this._x=n.x,this._y=n.y,this._z=n.z,this._w=n.w,this._onChangeCallback(),this}setFromEuler(n,i){const o=n._x,l=n._y,a=n._z,u=n._order,h=Math.cos,f=Math.sin,d=h(o/2),m=h(l/2),g=h(a/2),x=f(o/2),v=f(l/2),A=f(a/2);switch(u){case"XYZ":this._x=x*m*g+d*v*A,this._y=d*v*g-x*m*A,this._z=d*m*A+x*v*g,this._w=d*m*g-x*v*A;break;case"YXZ":this._x=x*m*g+d*v*A,this._y=d*v*g-x*m*A,this._z=d*m*A-x*v*g,this._w=d*m*g+x*v*A;break;case"ZXY":this._x=x*m*g-d*v*A,this._y=d*v*g+x*m*A,this._z=d*m*A+x*v*g,this._w=d*m*g-x*v*A;break;case"ZYX":this._x=x*m*g-d*v*A,this._y=d*v*g+x*m*A,this._z=d*m*A-x*v*g,this._w=d*m*g+x*v*A;break;case"YZX":this._x=x*m*g+d*v*A,this._y=d*v*g+x*m*A,this._z=d*m*A-x*v*g,this._w=d*m*g-x*v*A;break;case"XZY":this._x=x*m*g-d*v*A,this._y=d*v*g-x*m*A,this._z=d*m*A+x*v*g,this._w=d*m*g+x*v*A;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+u)}return i!==!1&&this._onChangeCallback(),this}setFromAxisAngle(n,i){const o=i/2,l=Math.sin(o);return this._x=n.x*l,this._y=n.y*l,this._z=n.z*l,this._w=Math.cos(o),this._onChangeCallback(),this}setFromRotationMatrix(n){const i=n.elements,o=i[0],l=i[4],a=i[8],u=i[1],h=i[5],f=i[9],d=i[2],m=i[6],g=i[10],x=o+h+g;if(x>0){const v=.5/Math.sqrt(x+1);this._w=.25/v,this._x=(m-f)*v,this._y=(a-d)*v,this._z=(u-l)*v}else if(o>h&&o>g){const v=2*Math.sqrt(1+o-h-g);this._w=(m-f)/v,this._x=.25*v,this._y=(l+u)/v,this._z=(a+d)/v}else if(h>g){const v=2*Math.sqrt(1+h-o-g);this._w=(a-d)/v,this._x=(l+u)/v,this._y=.25*v,this._z=(f+m)/v}else{const v=2*Math.sqrt(1+g-o-h);this._w=(u-l)/v,this._x=(a+d)/v,this._y=(f+m)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(n,i){let o=n.dot(i)+1;return o<Number.EPSILON?(o=0,Math.abs(n.x)>Math.abs(n.z)?(this._x=-n.y,this._y=n.x,this._z=0,this._w=o):(this._x=0,this._y=-n.z,this._z=n.y,this._w=o)):(this._x=n.y*i.z-n.z*i.y,this._y=n.z*i.x-n.x*i.z,this._z=n.x*i.y-n.y*i.x,this._w=o),this.normalize()}angleTo(n){return 2*Math.acos(Math.abs(ys(this.dot(n),-1,1)))}rotateTowards(n,i){const o=this.angleTo(n);if(o===0)return this;const l=Math.min(1,i/o);return this.slerp(n,l),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(n){return this._x*n._x+this._y*n._y+this._z*n._z+this._w*n._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let n=this.length();return n===0?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this._onChangeCallback(),this}multiply(n){return this.multiplyQuaternions(this,n)}premultiply(n){return this.multiplyQuaternions(n,this)}multiplyQuaternions(n,i){const o=n._x,l=n._y,a=n._z,u=n._w,h=i._x,f=i._y,d=i._z,m=i._w;return this._x=o*m+u*h+l*d-a*f,this._y=l*m+u*f+a*h-o*d,this._z=a*m+u*d+o*f-l*h,this._w=u*m-o*h-l*f-a*d,this._onChangeCallback(),this}slerp(n,i){if(i===0)return this;if(i===1)return this.copy(n);const o=this._x,l=this._y,a=this._z,u=this._w;let h=u*n._w+o*n._x+l*n._y+a*n._z;if(h<0?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,h=-h):this.copy(n),h>=1)return this._w=u,this._x=o,this._y=l,this._z=a,this;const f=1-h*h;if(f<=Number.EPSILON){const v=1-i;return this._w=v*u+i*this._w,this._x=v*o+i*this._x,this._y=v*l+i*this._y,this._z=v*a+i*this._z,this.normalize(),this._onChangeCallback(),this}const d=Math.sqrt(f),m=Math.atan2(d,h),g=Math.sin((1-i)*m)/d,x=Math.sin(i*m)/d;return this._w=u*g+this._w*x,this._x=o*g+this._x*x,this._y=l*g+this._y*x,this._z=a*g+this._z*x,this._onChangeCallback(),this}slerpQuaternions(n,i,o){return this.copy(n).slerp(i,o)}random(){const n=Math.random(),i=Math.sqrt(1-n),o=Math.sqrt(n),l=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(i*Math.cos(l),o*Math.sin(a),o*Math.cos(a),i*Math.sin(l))}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._w===this._w}fromArray(n,i=0){return this._x=n[i],this._y=n[i+1],this._z=n[i+2],this._w=n[i+3],this._onChangeCallback(),this}toArray(n=[],i=0){return n[i]=this._x,n[i+1]=this._y,n[i+2]=this._z,n[i+3]=this._w,n}fromBufferAttribute(n,i){return this._x=n.getX(i),this._y=n.getY(i),this._z=n.getZ(i),this._w=n.getW(i),this}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class it{constructor(n=0,i=0,o=0){it.prototype.isVector3=!0,this.x=n,this.y=i,this.z=o}set(n,i,o){return o===void 0&&(o=this.z),this.x=n,this.y=i,this.z=o,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setComponent(n,i){switch(n){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this}add(n){return this.x+=n.x,this.y+=n.y,this.z+=n.z,this}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this}addVectors(n,i){return this.x=n.x+i.x,this.y=n.y+i.y,this.z=n.z+i.z,this}addScaledVector(n,i){return this.x+=n.x*i,this.y+=n.y*i,this.z+=n.z*i,this}sub(n){return this.x-=n.x,this.y-=n.y,this.z-=n.z,this}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this}subVectors(n,i){return this.x=n.x-i.x,this.y=n.y-i.y,this.z=n.z-i.z,this}multiply(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this}multiplyVectors(n,i){return this.x=n.x*i.x,this.y=n.y*i.y,this.z=n.z*i.z,this}applyEuler(n){return this.applyQuaternion(i3.setFromEuler(n))}applyAxisAngle(n,i){return this.applyQuaternion(i3.setFromAxisAngle(n,i))}applyMatrix3(n){const i=this.x,o=this.y,l=this.z,a=n.elements;return this.x=a[0]*i+a[3]*o+a[6]*l,this.y=a[1]*i+a[4]*o+a[7]*l,this.z=a[2]*i+a[5]*o+a[8]*l,this}applyNormalMatrix(n){return this.applyMatrix3(n).normalize()}applyMatrix4(n){const i=this.x,o=this.y,l=this.z,a=n.elements,u=1/(a[3]*i+a[7]*o+a[11]*l+a[15]);return this.x=(a[0]*i+a[4]*o+a[8]*l+a[12])*u,this.y=(a[1]*i+a[5]*o+a[9]*l+a[13])*u,this.z=(a[2]*i+a[6]*o+a[10]*l+a[14])*u,this}applyQuaternion(n){const i=this.x,o=this.y,l=this.z,a=n.x,u=n.y,h=n.z,f=n.w,d=f*i+u*l-h*o,m=f*o+h*i-a*l,g=f*l+a*o-u*i,x=-a*i-u*o-h*l;return this.x=d*f+x*-a+m*-h-g*-u,this.y=m*f+x*-u+g*-a-d*-h,this.z=g*f+x*-h+d*-u-m*-a,this}project(n){return this.applyMatrix4(n.matrixWorldInverse).applyMatrix4(n.projectionMatrix)}unproject(n){return this.applyMatrix4(n.projectionMatrixInverse).applyMatrix4(n.matrixWorld)}transformDirection(n){const i=this.x,o=this.y,l=this.z,a=n.elements;return this.x=a[0]*i+a[4]*o+a[8]*l,this.y=a[1]*i+a[5]*o+a[9]*l,this.z=a[2]*i+a[6]*o+a[10]*l,this.normalize()}divide(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z,this}divideScalar(n){return this.multiplyScalar(1/n)}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this}clamp(n,i){return this.x=Math.max(n.x,Math.min(i.x,this.x)),this.y=Math.max(n.y,Math.min(i.y,this.y)),this.z=Math.max(n.z,Math.min(i.z,this.z)),this}clampScalar(n,i){return this.x=Math.max(n,Math.min(i,this.x)),this.y=Math.max(n,Math.min(i,this.y)),this.z=Math.max(n,Math.min(i,this.z)),this}clampLength(n,i){const o=this.length();return this.divideScalar(o||1).multiplyScalar(Math.max(n,Math.min(i,o)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,i){return this.x+=(n.x-this.x)*i,this.y+=(n.y-this.y)*i,this.z+=(n.z-this.z)*i,this}lerpVectors(n,i,o){return this.x=n.x+(i.x-n.x)*o,this.y=n.y+(i.y-n.y)*o,this.z=n.z+(i.z-n.z)*o,this}cross(n){return this.crossVectors(this,n)}crossVectors(n,i){const o=n.x,l=n.y,a=n.z,u=i.x,h=i.y,f=i.z;return this.x=l*f-a*h,this.y=a*u-o*f,this.z=o*h-l*u,this}projectOnVector(n){const i=n.lengthSq();if(i===0)return this.set(0,0,0);const o=n.dot(this)/i;return this.copy(n).multiplyScalar(o)}projectOnPlane(n){return Db.copy(this).projectOnVector(n),this.sub(Db)}reflect(n){return this.sub(Db.copy(n).multiplyScalar(2*this.dot(n)))}angleTo(n){const i=Math.sqrt(this.lengthSq()*n.lengthSq());if(i===0)return Math.PI/2;const o=this.dot(n)/i;return Math.acos(ys(o,-1,1))}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const i=this.x-n.x,o=this.y-n.y,l=this.z-n.z;return i*i+o*o+l*l}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)+Math.abs(this.z-n.z)}setFromSpherical(n){return this.setFromSphericalCoords(n.radius,n.phi,n.theta)}setFromSphericalCoords(n,i,o){const l=Math.sin(i)*n;return this.x=l*Math.sin(o),this.y=Math.cos(i)*n,this.z=l*Math.cos(o),this}setFromCylindrical(n){return this.setFromCylindricalCoords(n.radius,n.theta,n.y)}setFromCylindricalCoords(n,i,o){return this.x=n*Math.sin(i),this.y=o,this.z=n*Math.cos(i),this}setFromMatrixPosition(n){const i=n.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(n){const i=this.setFromMatrixColumn(n,0).length(),o=this.setFromMatrixColumn(n,1).length(),l=this.setFromMatrixColumn(n,2).length();return this.x=i,this.y=o,this.z=l,this}setFromMatrixColumn(n,i){return this.fromArray(n.elements,i*4)}setFromMatrix3Column(n,i){return this.fromArray(n.elements,i*3)}setFromEuler(n){return this.x=n._x,this.y=n._y,this.z=n._z,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z}fromArray(n,i=0){return this.x=n[i],this.y=n[i+1],this.z=n[i+2],this}toArray(n=[],i=0){return n[i]=this.x,n[i+1]=this.y,n[i+2]=this.z,n}fromBufferAttribute(n,i){return this.x=n.getX(i),this.y=n.getY(i),this.z=n.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const n=(Math.random()-.5)*2,i=Math.random()*Math.PI*2,o=Math.sqrt(1-n**2);return this.x=o*Math.cos(i),this.y=o*Math.sin(i),this.z=n,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Db=new it,i3=new ia;class qu{constructor(n=new it(1/0,1/0,1/0),i=new it(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=n,this.max=i}set(n,i){return this.min.copy(n),this.max.copy(i),this}setFromArray(n){let i=1/0,o=1/0,l=1/0,a=-1/0,u=-1/0,h=-1/0;for(let f=0,d=n.length;f<d;f+=3){const m=n[f],g=n[f+1],x=n[f+2];m<i&&(i=m),g<o&&(o=g),x<l&&(l=x),m>a&&(a=m),g>u&&(u=g),x>h&&(h=x)}return this.min.set(i,o,l),this.max.set(a,u,h),this}setFromBufferAttribute(n){let i=1/0,o=1/0,l=1/0,a=-1/0,u=-1/0,h=-1/0;for(let f=0,d=n.count;f<d;f++){const m=n.getX(f),g=n.getY(f),x=n.getZ(f);m<i&&(i=m),g<o&&(o=g),x<l&&(l=x),m>a&&(a=m),g>u&&(u=g),x>h&&(h=x)}return this.min.set(i,o,l),this.max.set(a,u,h),this}setFromPoints(n){this.makeEmpty();for(let i=0,o=n.length;i<o;i++)this.expandByPoint(n[i]);return this}setFromCenterAndSize(n,i){const o=uu.copy(i).multiplyScalar(.5);return this.min.copy(n).sub(o),this.max.copy(n).add(o),this}setFromObject(n,i=!1){return this.makeEmpty(),this.expandByObject(n,i)}clone(){return new this.constructor().copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(n){return this.isEmpty()?n.set(0,0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}expandByObject(n,i=!1){n.updateWorldMatrix(!1,!1);const o=n.geometry;if(o!==void 0)if(i&&o.attributes!=null&&o.attributes.position!==void 0){const a=o.attributes.position;for(let u=0,h=a.count;u<h;u++)uu.fromBufferAttribute(a,u).applyMatrix4(n.matrixWorld),this.expandByPoint(uu)}else o.boundingBox===null&&o.computeBoundingBox(),Ob.copy(o.boundingBox),Ob.applyMatrix4(n.matrixWorld),this.union(Ob);const l=n.children;for(let a=0,u=l.length;a<u;a++)this.expandByObject(l[a],i);return this}containsPoint(n){return!(n.x<this.min.x||n.x>this.max.x||n.y<this.min.y||n.y>this.max.y||n.z<this.min.z||n.z>this.max.z)}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y&&this.min.z<=n.min.z&&n.max.z<=this.max.z}getParameter(n,i){return i.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y),(n.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(n){return!(n.max.x<this.min.x||n.min.x>this.max.x||n.max.y<this.min.y||n.min.y>this.max.y||n.max.z<this.min.z||n.min.z>this.max.z)}intersectsSphere(n){return this.clampPoint(n.center,uu),uu.distanceToSquared(n.center)<=n.radius*n.radius}intersectsPlane(n){let i,o;return n.normal.x>0?(i=n.normal.x*this.min.x,o=n.normal.x*this.max.x):(i=n.normal.x*this.max.x,o=n.normal.x*this.min.x),n.normal.y>0?(i+=n.normal.y*this.min.y,o+=n.normal.y*this.max.y):(i+=n.normal.y*this.max.y,o+=n.normal.y*this.min.y),n.normal.z>0?(i+=n.normal.z*this.min.z,o+=n.normal.z*this.max.z):(i+=n.normal.z*this.max.z,o+=n.normal.z*this.min.z),i<=-n.constant&&o>=-n.constant}intersectsTriangle(n){if(this.isEmpty())return!1;this.getCenter(ap),Ov.subVectors(this.max,ap),Wh.subVectors(n.a,ap),jh.subVectors(n.b,ap),$h.subVectors(n.c,ap),Kl.subVectors(jh,Wh),Ql.subVectors($h,jh),hu.subVectors(Wh,$h);let i=[0,-Kl.z,Kl.y,0,-Ql.z,Ql.y,0,-hu.z,hu.y,Kl.z,0,-Kl.x,Ql.z,0,-Ql.x,hu.z,0,-hu.x,-Kl.y,Kl.x,0,-Ql.y,Ql.x,0,-hu.y,hu.x,0];return!Ib(i,Wh,jh,$h,Ov)||(i=[1,0,0,0,1,0,0,0,1],!Ib(i,Wh,jh,$h,Ov))?!1:(Iv.crossVectors(Kl,Ql),i=[Iv.x,Iv.y,Iv.z],Ib(i,Wh,jh,$h,Ov))}clampPoint(n,i){return i.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return uu.copy(n).clamp(this.min,this.max).sub(n).length()}getBoundingSphere(n){return this.getCenter(n.center),n.radius=this.getSize(uu).length()*.5,n}intersect(n){return this.min.max(n.min),this.max.min(n.max),this.isEmpty()&&this.makeEmpty(),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}applyMatrix4(n){return this.isEmpty()?this:(Qa[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),Qa[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),Qa[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),Qa[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),Qa[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),Qa[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),Qa[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),Qa[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(Qa),this)}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}}const Qa=[new it,new it,new it,new it,new it,new it,new it,new it],uu=new it,Ob=new qu,Wh=new it,jh=new it,$h=new it,Kl=new it,Ql=new it,hu=new it,ap=new it,Ov=new it,Iv=new it,du=new it;function Ib(r,n,i,o,l){for(let a=0,u=r.length-3;a<=u;a+=3){du.fromArray(r,a);const h=l.x*Math.abs(du.x)+l.y*Math.abs(du.y)+l.z*Math.abs(du.z),f=n.dot(du),d=i.dot(du),m=o.dot(du);if(Math.max(-Math.max(f,d,m),Math.min(f,d,m))>h)return!1}return!0}const YG=new qu,lp=new it,kb=new it;class jy{constructor(n=new it,i=-1){this.center=n,this.radius=i}set(n,i){return this.center.copy(n),this.radius=i,this}setFromPoints(n,i){const o=this.center;i!==void 0?o.copy(i):YG.setFromPoints(n).getCenter(o);let l=0;for(let a=0,u=n.length;a<u;a++)l=Math.max(l,o.distanceToSquared(n[a]));return this.radius=Math.sqrt(l),this}copy(n){return this.center.copy(n.center),this.radius=n.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(n){return n.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(n){return n.distanceTo(this.center)-this.radius}intersectsSphere(n){const i=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=i*i}intersectsBox(n){return n.intersectsSphere(this)}intersectsPlane(n){return Math.abs(n.distanceToPoint(this.center))<=this.radius}clampPoint(n,i){const o=this.center.distanceToSquared(n);return i.copy(n),o>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(n){return this.isEmpty()?(n.makeEmpty(),n):(n.set(this.center,this.center),n.expandByScalar(this.radius),n)}applyMatrix4(n){return this.center.applyMatrix4(n),this.radius=this.radius*n.getMaxScaleOnAxis(),this}translate(n){return this.center.add(n),this}expandByPoint(n){if(this.isEmpty())return this.center.copy(n),this.radius=0,this;lp.subVectors(n,this.center);const i=lp.lengthSq();if(i>this.radius*this.radius){const o=Math.sqrt(i),l=(o-this.radius)*.5;this.center.addScaledVector(lp,l/o),this.radius+=l}return this}union(n){return n.isEmpty()?this:this.isEmpty()?(this.copy(n),this):(this.center.equals(n.center)===!0?this.radius=Math.max(this.radius,n.radius):(kb.subVectors(n.center,this.center).setLength(n.radius),this.expandByPoint(lp.copy(n.center).add(kb)),this.expandByPoint(lp.copy(n.center).sub(kb))),this)}equals(n){return n.center.equals(this.center)&&n.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Za=new it,Nb=new it,kv=new it,Zl=new it,Fb=new it,Nv=new it,Bb=new it;class Aw{constructor(n=new it,i=new it(0,0,-1)){this.origin=n,this.direction=i}set(n,i){return this.origin.copy(n),this.direction.copy(i),this}copy(n){return this.origin.copy(n.origin),this.direction.copy(n.direction),this}at(n,i){return i.copy(this.direction).multiplyScalar(n).add(this.origin)}lookAt(n){return this.direction.copy(n).sub(this.origin).normalize(),this}recast(n){return this.origin.copy(this.at(n,Za)),this}closestPointToPoint(n,i){i.subVectors(n,this.origin);const o=i.dot(this.direction);return o<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(o).add(this.origin)}distanceToPoint(n){return Math.sqrt(this.distanceSqToPoint(n))}distanceSqToPoint(n){const i=Za.subVectors(n,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(n):(Za.copy(this.direction).multiplyScalar(i).add(this.origin),Za.distanceToSquared(n))}distanceSqToSegment(n,i,o,l){Nb.copy(n).add(i).multiplyScalar(.5),kv.copy(i).sub(n).normalize(),Zl.copy(this.origin).sub(Nb);const a=n.distanceTo(i)*.5,u=-this.direction.dot(kv),h=Zl.dot(this.direction),f=-Zl.dot(kv),d=Zl.lengthSq(),m=Math.abs(1-u*u);let g,x,v,A;if(m>0)if(g=u*f-h,x=u*h-f,A=a*m,g>=0)if(x>=-A)if(x<=A){const _=1/m;g*=_,x*=_,v=g*(g+u*x+2*h)+x*(u*g+x+2*f)+d}else x=a,g=Math.max(0,-(u*x+h)),v=-g*g+x*(x+2*f)+d;else x=-a,g=Math.max(0,-(u*x+h)),v=-g*g+x*(x+2*f)+d;else x<=-A?(g=Math.max(0,-(-u*a+h)),x=g>0?-a:Math.min(Math.max(-a,-f),a),v=-g*g+x*(x+2*f)+d):x<=A?(g=0,x=Math.min(Math.max(-a,-f),a),v=x*(x+2*f)+d):(g=Math.max(0,-(u*a+h)),x=g>0?a:Math.min(Math.max(-a,-f),a),v=-g*g+x*(x+2*f)+d);else x=u>0?-a:a,g=Math.max(0,-(u*x+h)),v=-g*g+x*(x+2*f)+d;return o&&o.copy(this.direction).multiplyScalar(g).add(this.origin),l&&l.copy(kv).multiplyScalar(x).add(Nb),v}intersectSphere(n,i){Za.subVectors(n.center,this.origin);const o=Za.dot(this.direction),l=Za.dot(Za)-o*o,a=n.radius*n.radius;if(l>a)return null;const u=Math.sqrt(a-l),h=o-u,f=o+u;return h<0&&f<0?null:h<0?this.at(f,i):this.at(h,i)}intersectsSphere(n){return this.distanceSqToPoint(n.center)<=n.radius*n.radius}distanceToPlane(n){const i=n.normal.dot(this.direction);if(i===0)return n.distanceToPoint(this.origin)===0?0:null;const o=-(this.origin.dot(n.normal)+n.constant)/i;return o>=0?o:null}intersectPlane(n,i){const o=this.distanceToPlane(n);return o===null?null:this.at(o,i)}intersectsPlane(n){const i=n.distanceToPoint(this.origin);return i===0||n.normal.dot(this.direction)*i<0}intersectBox(n,i){let o,l,a,u,h,f;const d=1/this.direction.x,m=1/this.direction.y,g=1/this.direction.z,x=this.origin;return d>=0?(o=(n.min.x-x.x)*d,l=(n.max.x-x.x)*d):(o=(n.max.x-x.x)*d,l=(n.min.x-x.x)*d),m>=0?(a=(n.min.y-x.y)*m,u=(n.max.y-x.y)*m):(a=(n.max.y-x.y)*m,u=(n.min.y-x.y)*m),o>u||a>l||((a>o||isNaN(o))&&(o=a),(u<l||isNaN(l))&&(l=u),g>=0?(h=(n.min.z-x.z)*g,f=(n.max.z-x.z)*g):(h=(n.max.z-x.z)*g,f=(n.min.z-x.z)*g),o>f||h>l)||((h>o||o!==o)&&(o=h),(f<l||l!==l)&&(l=f),l<0)?null:this.at(o>=0?o:l,i)}intersectsBox(n){return this.intersectBox(n,Za)!==null}intersectTriangle(n,i,o,l,a){Fb.subVectors(i,n),Nv.subVectors(o,n),Bb.crossVectors(Fb,Nv);let u=this.direction.dot(Bb),h;if(u>0){if(l)return null;h=1}else if(u<0)h=-1,u=-u;else return null;Zl.subVectors(this.origin,n);const f=h*this.direction.dot(Nv.crossVectors(Zl,Nv));if(f<0)return null;const d=h*this.direction.dot(Fb.cross(Zl));if(d<0||f+d>u)return null;const m=-h*Zl.dot(Bb);return m<0?null:this.at(m/u,a)}applyMatrix4(n){return this.origin.applyMatrix4(n),this.direction.transformDirection(n),this}equals(n){return n.origin.equals(this.origin)&&n.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Er{constructor(){Er.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}set(n,i,o,l,a,u,h,f,d,m,g,x,v,A,_,E){const w=this.elements;return w[0]=n,w[4]=i,w[8]=o,w[12]=l,w[1]=a,w[5]=u,w[9]=h,w[13]=f,w[2]=d,w[6]=m,w[10]=g,w[14]=x,w[3]=v,w[7]=A,w[11]=_,w[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Er().fromArray(this.elements)}copy(n){const i=this.elements,o=n.elements;return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],this}copyPosition(n){const i=this.elements,o=n.elements;return i[12]=o[12],i[13]=o[13],i[14]=o[14],this}setFromMatrix3(n){const i=n.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(n,i,o){return n.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),o.setFromMatrixColumn(this,2),this}makeBasis(n,i,o){return this.set(n.x,i.x,o.x,0,n.y,i.y,o.y,0,n.z,i.z,o.z,0,0,0,0,1),this}extractRotation(n){const i=this.elements,o=n.elements,l=1/Xh.setFromMatrixColumn(n,0).length(),a=1/Xh.setFromMatrixColumn(n,1).length(),u=1/Xh.setFromMatrixColumn(n,2).length();return i[0]=o[0]*l,i[1]=o[1]*l,i[2]=o[2]*l,i[3]=0,i[4]=o[4]*a,i[5]=o[5]*a,i[6]=o[6]*a,i[7]=0,i[8]=o[8]*u,i[9]=o[9]*u,i[10]=o[10]*u,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(n){const i=this.elements,o=n.x,l=n.y,a=n.z,u=Math.cos(o),h=Math.sin(o),f=Math.cos(l),d=Math.sin(l),m=Math.cos(a),g=Math.sin(a);if(n.order==="XYZ"){const x=u*m,v=u*g,A=h*m,_=h*g;i[0]=f*m,i[4]=-f*g,i[8]=d,i[1]=v+A*d,i[5]=x-_*d,i[9]=-h*f,i[2]=_-x*d,i[6]=A+v*d,i[10]=u*f}else if(n.order==="YXZ"){const x=f*m,v=f*g,A=d*m,_=d*g;i[0]=x+_*h,i[4]=A*h-v,i[8]=u*d,i[1]=u*g,i[5]=u*m,i[9]=-h,i[2]=v*h-A,i[6]=_+x*h,i[10]=u*f}else if(n.order==="ZXY"){const x=f*m,v=f*g,A=d*m,_=d*g;i[0]=x-_*h,i[4]=-u*g,i[8]=A+v*h,i[1]=v+A*h,i[5]=u*m,i[9]=_-x*h,i[2]=-u*d,i[6]=h,i[10]=u*f}else if(n.order==="ZYX"){const x=u*m,v=u*g,A=h*m,_=h*g;i[0]=f*m,i[4]=A*d-v,i[8]=x*d+_,i[1]=f*g,i[5]=_*d+x,i[9]=v*d-A,i[2]=-d,i[6]=h*f,i[10]=u*f}else if(n.order==="YZX"){const x=u*f,v=u*d,A=h*f,_=h*d;i[0]=f*m,i[4]=_-x*g,i[8]=A*g+v,i[1]=g,i[5]=u*m,i[9]=-h*m,i[2]=-d*m,i[6]=v*g+A,i[10]=x-_*g}else if(n.order==="XZY"){const x=u*f,v=u*d,A=h*f,_=h*d;i[0]=f*m,i[4]=-g,i[8]=d*m,i[1]=x*g+_,i[5]=u*m,i[9]=v*g-A,i[2]=A*g-v,i[6]=h*m,i[10]=_*g+x}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(n){return this.compose(KG,n,QG)}lookAt(n,i,o){const l=this.elements;return Zs.subVectors(n,i),Zs.lengthSq()===0&&(Zs.z=1),Zs.normalize(),Jl.crossVectors(o,Zs),Jl.lengthSq()===0&&(Math.abs(o.z)===1?Zs.x+=1e-4:Zs.z+=1e-4,Zs.normalize(),Jl.crossVectors(o,Zs)),Jl.normalize(),Fv.crossVectors(Zs,Jl),l[0]=Jl.x,l[4]=Fv.x,l[8]=Zs.x,l[1]=Jl.y,l[5]=Fv.y,l[9]=Zs.y,l[2]=Jl.z,l[6]=Fv.z,l[10]=Zs.z,this}multiply(n){return this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,i){const o=n.elements,l=i.elements,a=this.elements,u=o[0],h=o[4],f=o[8],d=o[12],m=o[1],g=o[5],x=o[9],v=o[13],A=o[2],_=o[6],E=o[10],w=o[14],S=o[3],T=o[7],R=o[11],L=o[15],I=l[0],N=l[4],B=l[8],H=l[12],q=l[1],le=l[5],ne=l[9],D=l[13],O=l[2],k=l[6],z=l[10],X=l[14],Z=l[3],ie=l[7],se=l[11],ue=l[15];return a[0]=u*I+h*q+f*O+d*Z,a[4]=u*N+h*le+f*k+d*ie,a[8]=u*B+h*ne+f*z+d*se,a[12]=u*H+h*D+f*X+d*ue,a[1]=m*I+g*q+x*O+v*Z,a[5]=m*N+g*le+x*k+v*ie,a[9]=m*B+g*ne+x*z+v*se,a[13]=m*H+g*D+x*X+v*ue,a[2]=A*I+_*q+E*O+w*Z,a[6]=A*N+_*le+E*k+w*ie,a[10]=A*B+_*ne+E*z+w*se,a[14]=A*H+_*D+E*X+w*ue,a[3]=S*I+T*q+R*O+L*Z,a[7]=S*N+T*le+R*k+L*ie,a[11]=S*B+T*ne+R*z+L*se,a[15]=S*H+T*D+R*X+L*ue,this}multiplyScalar(n){const i=this.elements;return i[0]*=n,i[4]*=n,i[8]*=n,i[12]*=n,i[1]*=n,i[5]*=n,i[9]*=n,i[13]*=n,i[2]*=n,i[6]*=n,i[10]*=n,i[14]*=n,i[3]*=n,i[7]*=n,i[11]*=n,i[15]*=n,this}determinant(){const n=this.elements,i=n[0],o=n[4],l=n[8],a=n[12],u=n[1],h=n[5],f=n[9],d=n[13],m=n[2],g=n[6],x=n[10],v=n[14],A=n[3],_=n[7],E=n[11],w=n[15];return A*(+a*f*g-l*d*g-a*h*x+o*d*x+l*h*v-o*f*v)+_*(+i*f*v-i*d*x+a*u*x-l*u*v+l*d*m-a*f*m)+E*(+i*d*g-i*h*v-a*u*g+o*u*v+a*h*m-o*d*m)+w*(-l*h*m-i*f*g+i*h*x+l*u*g-o*u*x+o*f*m)}transpose(){const n=this.elements;let i;return i=n[1],n[1]=n[4],n[4]=i,i=n[2],n[2]=n[8],n[8]=i,i=n[6],n[6]=n[9],n[9]=i,i=n[3],n[3]=n[12],n[12]=i,i=n[7],n[7]=n[13],n[13]=i,i=n[11],n[11]=n[14],n[14]=i,this}setPosition(n,i,o){const l=this.elements;return n.isVector3?(l[12]=n.x,l[13]=n.y,l[14]=n.z):(l[12]=n,l[13]=i,l[14]=o),this}invert(){const n=this.elements,i=n[0],o=n[1],l=n[2],a=n[3],u=n[4],h=n[5],f=n[6],d=n[7],m=n[8],g=n[9],x=n[10],v=n[11],A=n[12],_=n[13],E=n[14],w=n[15],S=g*E*d-_*x*d+_*f*v-h*E*v-g*f*w+h*x*w,T=A*x*d-m*E*d-A*f*v+u*E*v+m*f*w-u*x*w,R=m*_*d-A*g*d+A*h*v-u*_*v-m*h*w+u*g*w,L=A*g*f-m*_*f-A*h*x+u*_*x+m*h*E-u*g*E,I=i*S+o*T+l*R+a*L;if(I===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const N=1/I;return n[0]=S*N,n[1]=(_*x*a-g*E*a-_*l*v+o*E*v+g*l*w-o*x*w)*N,n[2]=(h*E*a-_*f*a+_*l*d-o*E*d-h*l*w+o*f*w)*N,n[3]=(g*f*a-h*x*a-g*l*d+o*x*d+h*l*v-o*f*v)*N,n[4]=T*N,n[5]=(m*E*a-A*x*a+A*l*v-i*E*v-m*l*w+i*x*w)*N,n[6]=(A*f*a-u*E*a-A*l*d+i*E*d+u*l*w-i*f*w)*N,n[7]=(u*x*a-m*f*a+m*l*d-i*x*d-u*l*v+i*f*v)*N,n[8]=R*N,n[9]=(A*g*a-m*_*a-A*o*v+i*_*v+m*o*w-i*g*w)*N,n[10]=(u*_*a-A*h*a+A*o*d-i*_*d-u*o*w+i*h*w)*N,n[11]=(m*h*a-u*g*a-m*o*d+i*g*d+u*o*v-i*h*v)*N,n[12]=L*N,n[13]=(m*_*l-A*g*l+A*o*x-i*_*x-m*o*E+i*g*E)*N,n[14]=(A*h*l-u*_*l-A*o*f+i*_*f+u*o*E-i*h*E)*N,n[15]=(u*g*l-m*h*l+m*o*f-i*g*f-u*o*x+i*h*x)*N,this}scale(n){const i=this.elements,o=n.x,l=n.y,a=n.z;return i[0]*=o,i[4]*=l,i[8]*=a,i[1]*=o,i[5]*=l,i[9]*=a,i[2]*=o,i[6]*=l,i[10]*=a,i[3]*=o,i[7]*=l,i[11]*=a,this}getMaxScaleOnAxis(){const n=this.elements,i=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=n[4]*n[4]+n[5]*n[5]+n[6]*n[6],l=n[8]*n[8]+n[9]*n[9]+n[10]*n[10];return Math.sqrt(Math.max(i,o,l))}makeTranslation(n,i,o){return this.set(1,0,0,n,0,1,0,i,0,0,1,o,0,0,0,1),this}makeRotationX(n){const i=Math.cos(n),o=Math.sin(n);return this.set(1,0,0,0,0,i,-o,0,0,o,i,0,0,0,0,1),this}makeRotationY(n){const i=Math.cos(n),o=Math.sin(n);return this.set(i,0,o,0,0,1,0,0,-o,0,i,0,0,0,0,1),this}makeRotationZ(n){const i=Math.cos(n),o=Math.sin(n);return this.set(i,-o,0,0,o,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(n,i){const o=Math.cos(i),l=Math.sin(i),a=1-o,u=n.x,h=n.y,f=n.z,d=a*u,m=a*h;return this.set(d*u+o,d*h-l*f,d*f+l*h,0,d*h+l*f,m*h+o,m*f-l*u,0,d*f-l*h,m*f+l*u,a*f*f+o,0,0,0,0,1),this}makeScale(n,i,o){return this.set(n,0,0,0,0,i,0,0,0,0,o,0,0,0,0,1),this}makeShear(n,i,o,l,a,u){return this.set(1,o,a,0,n,1,u,0,i,l,1,0,0,0,0,1),this}compose(n,i,o){const l=this.elements,a=i._x,u=i._y,h=i._z,f=i._w,d=a+a,m=u+u,g=h+h,x=a*d,v=a*m,A=a*g,_=u*m,E=u*g,w=h*g,S=f*d,T=f*m,R=f*g,L=o.x,I=o.y,N=o.z;return l[0]=(1-(_+w))*L,l[1]=(v+R)*L,l[2]=(A-T)*L,l[3]=0,l[4]=(v-R)*I,l[5]=(1-(x+w))*I,l[6]=(E+S)*I,l[7]=0,l[8]=(A+T)*N,l[9]=(E-S)*N,l[10]=(1-(x+_))*N,l[11]=0,l[12]=n.x,l[13]=n.y,l[14]=n.z,l[15]=1,this}decompose(n,i,o){const l=this.elements;let a=Xh.set(l[0],l[1],l[2]).length();const u=Xh.set(l[4],l[5],l[6]).length(),h=Xh.set(l[8],l[9],l[10]).length();this.determinant()<0&&(a=-a),n.x=l[12],n.y=l[13],n.z=l[14],Ho.copy(this);const d=1/a,m=1/u,g=1/h;return Ho.elements[0]*=d,Ho.elements[1]*=d,Ho.elements[2]*=d,Ho.elements[4]*=m,Ho.elements[5]*=m,Ho.elements[6]*=m,Ho.elements[8]*=g,Ho.elements[9]*=g,Ho.elements[10]*=g,i.setFromRotationMatrix(Ho),o.x=a,o.y=u,o.z=h,this}makePerspective(n,i,o,l,a,u){const h=this.elements,f=2*a/(i-n),d=2*a/(o-l),m=(i+n)/(i-n),g=(o+l)/(o-l),x=-(u+a)/(u-a),v=-2*u*a/(u-a);return h[0]=f,h[4]=0,h[8]=m,h[12]=0,h[1]=0,h[5]=d,h[9]=g,h[13]=0,h[2]=0,h[6]=0,h[10]=x,h[14]=v,h[3]=0,h[7]=0,h[11]=-1,h[15]=0,this}makeOrthographic(n,i,o,l,a,u){const h=this.elements,f=1/(i-n),d=1/(o-l),m=1/(u-a),g=(i+n)*f,x=(o+l)*d,v=(u+a)*m;return h[0]=2*f,h[4]=0,h[8]=0,h[12]=-g,h[1]=0,h[5]=2*d,h[9]=0,h[13]=-x,h[2]=0,h[6]=0,h[10]=-2*m,h[14]=-v,h[3]=0,h[7]=0,h[11]=0,h[15]=1,this}equals(n){const i=this.elements,o=n.elements;for(let l=0;l<16;l++)if(i[l]!==o[l])return!1;return!0}fromArray(n,i=0){for(let o=0;o<16;o++)this.elements[o]=n[o+i];return this}toArray(n=[],i=0){const o=this.elements;return n[i]=o[0],n[i+1]=o[1],n[i+2]=o[2],n[i+3]=o[3],n[i+4]=o[4],n[i+5]=o[5],n[i+6]=o[6],n[i+7]=o[7],n[i+8]=o[8],n[i+9]=o[9],n[i+10]=o[10],n[i+11]=o[11],n[i+12]=o[12],n[i+13]=o[13],n[i+14]=o[14],n[i+15]=o[15],n}}const Xh=new it,Ho=new Er,KG=new it(0,0,0),QG=new it(1,1,1),Jl=new it,Fv=new it,Zs=new it,r3=new Er,s3=new ia;class km{constructor(n=0,i=0,o=0,l=km.DefaultOrder){this.isEuler=!0,this._x=n,this._y=i,this._z=o,this._order=l}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get order(){return this._order}set order(n){this._order=n,this._onChangeCallback()}set(n,i,o,l=this._order){return this._x=n,this._y=i,this._z=o,this._order=l,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(n){return this._x=n._x,this._y=n._y,this._z=n._z,this._order=n._order,this._onChangeCallback(),this}setFromRotationMatrix(n,i=this._order,o=!0){const l=n.elements,a=l[0],u=l[4],h=l[8],f=l[1],d=l[5],m=l[9],g=l[2],x=l[6],v=l[10];switch(i){case"XYZ":this._y=Math.asin(ys(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,v),this._z=Math.atan2(-u,a)):(this._x=Math.atan2(x,d),this._z=0);break;case"YXZ":this._x=Math.asin(-ys(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(h,v),this._z=Math.atan2(f,d)):(this._y=Math.atan2(-g,a),this._z=0);break;case"ZXY":this._x=Math.asin(ys(x,-1,1)),Math.abs(x)<.9999999?(this._y=Math.atan2(-g,v),this._z=Math.atan2(-u,d)):(this._y=0,this._z=Math.atan2(f,a));break;case"ZYX":this._y=Math.asin(-ys(g,-1,1)),Math.abs(g)<.9999999?(this._x=Math.atan2(x,v),this._z=Math.atan2(f,a)):(this._x=0,this._z=Math.atan2(-u,d));break;case"YZX":this._z=Math.asin(ys(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,d),this._y=Math.atan2(-g,a)):(this._x=0,this._y=Math.atan2(h,v));break;case"XZY":this._z=Math.asin(-ys(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(x,d),this._y=Math.atan2(h,a)):(this._x=Math.atan2(-m,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,o===!0&&this._onChangeCallback(),this}setFromQuaternion(n,i,o){return r3.makeRotationFromQuaternion(n),this.setFromRotationMatrix(r3,i,o)}setFromVector3(n,i=this._order){return this.set(n.x,n.y,n.z,i)}reorder(n){return s3.setFromEuler(this),this.setFromQuaternion(s3,n)}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._order===this._order}fromArray(n){return this._x=n[0],this._y=n[1],this._z=n[2],n[3]!==void 0&&(this._order=n[3]),this._onChangeCallback(),this}toArray(n=[],i=0){return n[i]=this._x,n[i+1]=this._y,n[i+2]=this._z,n[i+3]=this._order,n}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}km.DefaultOrder="XYZ";km.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class ww{constructor(){this.mask=1}set(n){this.mask=(1<<n|0)>>>0}enable(n){this.mask|=1<<n|0}enableAll(){this.mask=-1}toggle(n){this.mask^=1<<n|0}disable(n){this.mask&=~(1<<n|0)}disableAll(){this.mask=0}test(n){return(this.mask&n.mask)!==0}isEnabled(n){return(this.mask&(1<<n|0))!==0}}let ZG=0;const o3=new it,qh=new ia,Ja=new Er,Bv=new it,cp=new it,JG=new it,eV=new ia,a3=new it(1,0,0),l3=new it(0,1,0),c3=new it(0,0,1),tV={type:"added"},u3={type:"removed"};class ls extends ra{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:ZG++}),this.uuid=Im(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ls.DefaultUp.clone();const n=new it,i=new km,o=new ia,l=new it(1,1,1);function a(){o.setFromEuler(i,!1)}function u(){i.setFromQuaternion(o,void 0,!1)}i._onChange(a),o._onChange(u),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:o},scale:{configurable:!0,enumerable:!0,value:l},modelViewMatrix:{value:new Er},normalMatrix:{value:new no}}),this.matrix=new Er,this.matrixWorld=new Er,this.matrixAutoUpdate=ls.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=ls.DefaultMatrixWorldAutoUpdate,this.layers=new ww,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(n){return this.quaternion.premultiply(n),this}setRotationFromAxisAngle(n,i){this.quaternion.setFromAxisAngle(n,i)}setRotationFromEuler(n){this.quaternion.setFromEuler(n,!0)}setRotationFromMatrix(n){this.quaternion.setFromRotationMatrix(n)}setRotationFromQuaternion(n){this.quaternion.copy(n)}rotateOnAxis(n,i){return qh.setFromAxisAngle(n,i),this.quaternion.multiply(qh),this}rotateOnWorldAxis(n,i){return qh.setFromAxisAngle(n,i),this.quaternion.premultiply(qh),this}rotateX(n){return this.rotateOnAxis(a3,n)}rotateY(n){return this.rotateOnAxis(l3,n)}rotateZ(n){return this.rotateOnAxis(c3,n)}translateOnAxis(n,i){return o3.copy(n).applyQuaternion(this.quaternion),this.position.add(o3.multiplyScalar(i)),this}translateX(n){return this.translateOnAxis(a3,n)}translateY(n){return this.translateOnAxis(l3,n)}translateZ(n){return this.translateOnAxis(c3,n)}localToWorld(n){return this.updateWorldMatrix(!0,!1),n.applyMatrix4(this.matrixWorld)}worldToLocal(n){return this.updateWorldMatrix(!0,!1),n.applyMatrix4(Ja.copy(this.matrixWorld).invert())}lookAt(n,i,o){n.isVector3?Bv.copy(n):Bv.set(n,i,o);const l=this.parent;this.updateWorldMatrix(!0,!1),cp.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ja.lookAt(cp,Bv,this.up):Ja.lookAt(Bv,cp,this.up),this.quaternion.setFromRotationMatrix(Ja),l&&(Ja.extractRotation(l.matrixWorld),qh.setFromRotationMatrix(Ja),this.quaternion.premultiply(qh.invert()))}add(n){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(n.parent!==null&&n.parent.remove(n),n.parent=this,this.children.push(n),n.dispatchEvent(tV)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)}remove(n){if(arguments.length>1){for(let o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}const i=this.children.indexOf(n);return i!==-1&&(n.parent=null,this.children.splice(i,1),n.dispatchEvent(u3)),this}removeFromParent(){const n=this.parent;return n!==null&&n.remove(this),this}clear(){for(let n=0;n<this.children.length;n++){const i=this.children[n];i.parent=null,i.dispatchEvent(u3)}return this.children.length=0,this}attach(n){return this.updateWorldMatrix(!0,!1),Ja.copy(this.matrixWorld).invert(),n.parent!==null&&(n.parent.updateWorldMatrix(!0,!1),Ja.multiply(n.parent.matrixWorld)),n.applyMatrix4(Ja),this.add(n),n.updateWorldMatrix(!1,!0),this}getObjectById(n){return this.getObjectByProperty("id",n)}getObjectByName(n){return this.getObjectByProperty("name",n)}getObjectByProperty(n,i){if(this[n]===i)return this;for(let o=0,l=this.children.length;o<l;o++){const u=this.children[o].getObjectByProperty(n,i);if(u!==void 0)return u}}getObjectsByProperty(n,i){let o=[];this[n]===i&&o.push(this);for(let l=0,a=this.children.length;l<a;l++){const u=this.children[l].getObjectsByProperty(n,i);u.length>0&&(o=o.concat(u))}return o}getWorldPosition(n){return this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cp,n,JG),n}getWorldScale(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(cp,eV,n),n}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return n.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(n){n(this);const i=this.children;for(let o=0,l=i.length;o<l;o++)i[o].traverse(n)}traverseVisible(n){if(this.visible===!1)return;n(this);const i=this.children;for(let o=0,l=i.length;o<l;o++)i[o].traverseVisible(n)}traverseAncestors(n){const i=this.parent;i!==null&&(n(i),i.traverseAncestors(n))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);const i=this.children;for(let o=0,l=i.length;o<l;o++){const a=i[o];(a.matrixWorldAutoUpdate===!0||n===!0)&&a.updateMatrixWorld(n)}}updateWorldMatrix(n,i){const o=this.parent;if(n===!0&&o!==null&&o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),i===!0){const l=this.children;for(let a=0,u=l.length;a<u;a++){const h=l[a];h.matrixWorldAutoUpdate===!0&&h.updateWorldMatrix(!1,!0)}}}toJSON(n){const i=n===void 0||typeof n=="string",o={};i&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},o.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const l={};l.uuid=this.uuid,l.type=this.type,this.name!==""&&(l.name=this.name),this.castShadow===!0&&(l.castShadow=!0),this.receiveShadow===!0&&(l.receiveShadow=!0),this.visible===!1&&(l.visible=!1),this.frustumCulled===!1&&(l.frustumCulled=!1),this.renderOrder!==0&&(l.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(l.userData=this.userData),l.layers=this.layers.mask,l.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(l.matrixAutoUpdate=!1),this.isInstancedMesh&&(l.type="InstancedMesh",l.count=this.count,l.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(l.instanceColor=this.instanceColor.toJSON()));function a(h,f){return h[f.uuid]===void 0&&(h[f.uuid]=f.toJSON(n)),f.uuid}if(this.isScene)this.background&&(this.background.isColor?l.background=this.background.toJSON():this.background.isTexture&&(l.background=this.background.toJSON(n).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(l.environment=this.environment.toJSON(n).uuid);else if(this.isMesh||this.isLine||this.isPoints){l.geometry=a(n.geometries,this.geometry);const h=this.geometry.parameters;if(h!==void 0&&h.shapes!==void 0){const f=h.shapes;if(Array.isArray(f))for(let d=0,m=f.length;d<m;d++){const g=f[d];a(n.shapes,g)}else a(n.shapes,f)}}if(this.isSkinnedMesh&&(l.bindMode=this.bindMode,l.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(n.skeletons,this.skeleton),l.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const h=[];for(let f=0,d=this.material.length;f<d;f++)h.push(a(n.materials,this.material[f]));l.material=h}else l.material=a(n.materials,this.material);if(this.children.length>0){l.children=[];for(let h=0;h<this.children.length;h++)l.children.push(this.children[h].toJSON(n).object)}if(this.animations.length>0){l.animations=[];for(let h=0;h<this.animations.length;h++){const f=this.animations[h];l.animations.push(a(n.animations,f))}}if(i){const h=u(n.geometries),f=u(n.materials),d=u(n.textures),m=u(n.images),g=u(n.shapes),x=u(n.skeletons),v=u(n.animations),A=u(n.nodes);h.length>0&&(o.geometries=h),f.length>0&&(o.materials=f),d.length>0&&(o.textures=d),m.length>0&&(o.images=m),g.length>0&&(o.shapes=g),x.length>0&&(o.skeletons=x),v.length>0&&(o.animations=v),A.length>0&&(o.nodes=A)}return o.object=l,o;function u(h){const f=[];for(const d in h){const m=h[d];delete m.metadata,f.push(m)}return f}}clone(n){return new this.constructor().copy(this,n)}copy(n,i=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=n.matrixWorldAutoUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.userData=JSON.parse(JSON.stringify(n.userData)),i===!0)for(let o=0;o<n.children.length;o++){const l=n.children[o];this.add(l.clone())}return this}}ls.DefaultUp=new it(0,1,0);ls.DefaultMatrixAutoUpdate=!0;ls.DefaultMatrixWorldAutoUpdate=!0;const Go=new it,el=new it,Ub=new it,tl=new it,Yh=new it,Kh=new it,h3=new it,zb=new it,Hb=new it,Gb=new it;class cl{constructor(n=new it,i=new it,o=new it){this.a=n,this.b=i,this.c=o}static getNormal(n,i,o,l){l.subVectors(o,i),Go.subVectors(n,i),l.cross(Go);const a=l.lengthSq();return a>0?l.multiplyScalar(1/Math.sqrt(a)):l.set(0,0,0)}static getBarycoord(n,i,o,l,a){Go.subVectors(l,i),el.subVectors(o,i),Ub.subVectors(n,i);const u=Go.dot(Go),h=Go.dot(el),f=Go.dot(Ub),d=el.dot(el),m=el.dot(Ub),g=u*d-h*h;if(g===0)return a.set(-2,-1,-1);const x=1/g,v=(d*f-h*m)*x,A=(u*m-h*f)*x;return a.set(1-v-A,A,v)}static containsPoint(n,i,o,l){return this.getBarycoord(n,i,o,l,tl),tl.x>=0&&tl.y>=0&&tl.x+tl.y<=1}static getUV(n,i,o,l,a,u,h,f){return this.getBarycoord(n,i,o,l,tl),f.set(0,0),f.addScaledVector(a,tl.x),f.addScaledVector(u,tl.y),f.addScaledVector(h,tl.z),f}static isFrontFacing(n,i,o,l){return Go.subVectors(o,i),el.subVectors(n,i),Go.cross(el).dot(l)<0}set(n,i,o){return this.a.copy(n),this.b.copy(i),this.c.copy(o),this}setFromPointsAndIndices(n,i,o,l){return this.a.copy(n[i]),this.b.copy(n[o]),this.c.copy(n[l]),this}setFromAttributeAndIndices(n,i,o,l){return this.a.fromBufferAttribute(n,i),this.b.fromBufferAttribute(n,o),this.c.fromBufferAttribute(n,l),this}clone(){return new this.constructor().copy(this)}copy(n){return this.a.copy(n.a),this.b.copy(n.b),this.c.copy(n.c),this}getArea(){return Go.subVectors(this.c,this.b),el.subVectors(this.a,this.b),Go.cross(el).length()*.5}getMidpoint(n){return n.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(n){return cl.getNormal(this.a,this.b,this.c,n)}getPlane(n){return n.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(n,i){return cl.getBarycoord(n,this.a,this.b,this.c,i)}getUV(n,i,o,l,a){return cl.getUV(n,this.a,this.b,this.c,i,o,l,a)}containsPoint(n){return cl.containsPoint(n,this.a,this.b,this.c)}isFrontFacing(n){return cl.isFrontFacing(this.a,this.b,this.c,n)}intersectsBox(n){return n.intersectsTriangle(this)}closestPointToPoint(n,i){const o=this.a,l=this.b,a=this.c;let u,h;Yh.subVectors(l,o),Kh.subVectors(a,o),zb.subVectors(n,o);const f=Yh.dot(zb),d=Kh.dot(zb);if(f<=0&&d<=0)return i.copy(o);Hb.subVectors(n,l);const m=Yh.dot(Hb),g=Kh.dot(Hb);if(m>=0&&g<=m)return i.copy(l);const x=f*g-m*d;if(x<=0&&f>=0&&m<=0)return u=f/(f-m),i.copy(o).addScaledVector(Yh,u);Gb.subVectors(n,a);const v=Yh.dot(Gb),A=Kh.dot(Gb);if(A>=0&&v<=A)return i.copy(a);const _=v*d-f*A;if(_<=0&&d>=0&&A<=0)return h=d/(d-A),i.copy(o).addScaledVector(Kh,h);const E=m*A-v*g;if(E<=0&&g-m>=0&&v-A>=0)return h3.subVectors(a,l),h=(g-m)/(g-m+(v-A)),i.copy(l).addScaledVector(h3,h);const w=1/(E+_+x);return u=_*w,h=x*w,i.copy(o).addScaledVector(Yh,u).addScaledVector(Kh,h)}equals(n){return n.a.equals(this.a)&&n.b.equals(this.b)&&n.c.equals(this.c)}}let nV=0;class uf extends ra{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:nV++}),this.uuid=Im(),this.name="",this.type="Material",this.blending=Nd,this.side=zu,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=tO,this.blendDst=nO,this.blendEquation=cd,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=IE,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=jG,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Mb,this.stencilZFail=Mb,this.stencilZPass=Mb,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(n){this._alphaTest>0!=n>0&&this.version++,this._alphaTest=n}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(n){if(n!==void 0)for(const i in n){const o=n[i];if(o===void 0){console.warn("THREE.Material: '"+i+"' parameter is undefined.");continue}const l=this[i];if(l===void 0){console.warn("THREE."+this.type+": '"+i+"' is not a property of this material.");continue}l&&l.isColor?l.set(o):l&&l.isVector3&&o&&o.isVector3?l.copy(o):this[i]=o}}toJSON(n){const i=n===void 0||typeof n=="string";i&&(n={textures:{},images:{}});const o={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.color&&this.color.isColor&&(o.color=this.color.getHex()),this.roughness!==void 0&&(o.roughness=this.roughness),this.metalness!==void 0&&(o.metalness=this.metalness),this.sheen!==void 0&&(o.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(o.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(o.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(o.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(o.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(o.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(o.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(o.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(o.shininess=this.shininess),this.clearcoat!==void 0&&(o.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(o.clearcoatMap=this.clearcoatMap.toJSON(n).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(o.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(n).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(o.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(n).uuid,o.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(o.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(o.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(o.iridescenceMap=this.iridescenceMap.toJSON(n).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(o.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(n).uuid),this.map&&this.map.isTexture&&(o.map=this.map.toJSON(n).uuid),this.matcap&&this.matcap.isTexture&&(o.matcap=this.matcap.toJSON(n).uuid),this.alphaMap&&this.alphaMap.isTexture&&(o.alphaMap=this.alphaMap.toJSON(n).uuid),this.lightMap&&this.lightMap.isTexture&&(o.lightMap=this.lightMap.toJSON(n).uuid,o.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(o.aoMap=this.aoMap.toJSON(n).uuid,o.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(o.bumpMap=this.bumpMap.toJSON(n).uuid,o.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(o.normalMap=this.normalMap.toJSON(n).uuid,o.normalMapType=this.normalMapType,o.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(o.displacementMap=this.displacementMap.toJSON(n).uuid,o.displacementScale=this.displacementScale,o.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(o.roughnessMap=this.roughnessMap.toJSON(n).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(o.metalnessMap=this.metalnessMap.toJSON(n).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(o.emissiveMap=this.emissiveMap.toJSON(n).uuid),this.specularMap&&this.specularMap.isTexture&&(o.specularMap=this.specularMap.toJSON(n).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(o.specularIntensityMap=this.specularIntensityMap.toJSON(n).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(o.specularColorMap=this.specularColorMap.toJSON(n).uuid),this.envMap&&this.envMap.isTexture&&(o.envMap=this.envMap.toJSON(n).uuid,this.combine!==void 0&&(o.combine=this.combine)),this.envMapIntensity!==void 0&&(o.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(o.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(o.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(o.gradientMap=this.gradientMap.toJSON(n).uuid),this.transmission!==void 0&&(o.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(o.transmissionMap=this.transmissionMap.toJSON(n).uuid),this.thickness!==void 0&&(o.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(o.thicknessMap=this.thicknessMap.toJSON(n).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(o.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(o.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(o.size=this.size),this.shadowSide!==null&&(o.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(o.sizeAttenuation=this.sizeAttenuation),this.blending!==Nd&&(o.blending=this.blending),this.side!==zu&&(o.side=this.side),this.vertexColors&&(o.vertexColors=!0),this.opacity<1&&(o.opacity=this.opacity),this.transparent===!0&&(o.transparent=this.transparent),o.depthFunc=this.depthFunc,o.depthTest=this.depthTest,o.depthWrite=this.depthWrite,o.colorWrite=this.colorWrite,o.stencilWrite=this.stencilWrite,o.stencilWriteMask=this.stencilWriteMask,o.stencilFunc=this.stencilFunc,o.stencilRef=this.stencilRef,o.stencilFuncMask=this.stencilFuncMask,o.stencilFail=this.stencilFail,o.stencilZFail=this.stencilZFail,o.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(o.rotation=this.rotation),this.polygonOffset===!0&&(o.polygonOffset=!0),this.polygonOffsetFactor!==0&&(o.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(o.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(o.linewidth=this.linewidth),this.dashSize!==void 0&&(o.dashSize=this.dashSize),this.gapSize!==void 0&&(o.gapSize=this.gapSize),this.scale!==void 0&&(o.scale=this.scale),this.dithering===!0&&(o.dithering=!0),this.alphaTest>0&&(o.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(o.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(o.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(o.wireframe=this.wireframe),this.wireframeLinewidth>1&&(o.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(o.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(o.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(o.flatShading=this.flatShading),this.visible===!1&&(o.visible=!1),this.toneMapped===!1&&(o.toneMapped=!1),this.fog===!1&&(o.fog=!1),Object.keys(this.userData).length>0&&(o.userData=this.userData);function l(a){const u=[];for(const h in a){const f=a[h];delete f.metadata,u.push(f)}return u}if(i){const a=l(n.textures),u=l(n.images);a.length>0&&(o.textures=a),u.length>0&&(o.images=u)}return o}clone(){return new this.constructor().copy(this)}copy(n){this.name=n.name,this.blending=n.blending,this.side=n.side,this.vertexColors=n.vertexColors,this.opacity=n.opacity,this.transparent=n.transparent,this.blendSrc=n.blendSrc,this.blendDst=n.blendDst,this.blendEquation=n.blendEquation,this.blendSrcAlpha=n.blendSrcAlpha,this.blendDstAlpha=n.blendDstAlpha,this.blendEquationAlpha=n.blendEquationAlpha,this.depthFunc=n.depthFunc,this.depthTest=n.depthTest,this.depthWrite=n.depthWrite,this.stencilWriteMask=n.stencilWriteMask,this.stencilFunc=n.stencilFunc,this.stencilRef=n.stencilRef,this.stencilFuncMask=n.stencilFuncMask,this.stencilFail=n.stencilFail,this.stencilZFail=n.stencilZFail,this.stencilZPass=n.stencilZPass,this.stencilWrite=n.stencilWrite;const i=n.clippingPlanes;let o=null;if(i!==null){const l=i.length;o=new Array(l);for(let a=0;a!==l;++a)o[a]=i[a].clone()}return this.clippingPlanes=o,this.clipIntersection=n.clipIntersection,this.clipShadows=n.clipShadows,this.shadowSide=n.shadowSide,this.colorWrite=n.colorWrite,this.precision=n.precision,this.polygonOffset=n.polygonOffset,this.polygonOffsetFactor=n.polygonOffsetFactor,this.polygonOffsetUnits=n.polygonOffsetUnits,this.dithering=n.dithering,this.alphaTest=n.alphaTest,this.alphaToCoverage=n.alphaToCoverage,this.premultipliedAlpha=n.premultipliedAlpha,this.visible=n.visible,this.toneMapped=n.toneMapped,this.userData=JSON.parse(JSON.stringify(n.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(n){n===!0&&this.version++}}class Mw extends uf{constructor(n){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Ji(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ew,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.fog=n.fog,this}}const Ur=new it,Uv=new Rn;class ta{constructor(n,i,o=!1){if(Array.isArray(n))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=n,this.itemSize=i,this.count=n!==void 0?n.length/i:0,this.normalized=o,this.usage=JC,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(n){n===!0&&this.version++}setUsage(n){return this.usage=n,this}copy(n){return this.name=n.name,this.array=new n.array.constructor(n.array),this.itemSize=n.itemSize,this.count=n.count,this.normalized=n.normalized,this.usage=n.usage,this}copyAt(n,i,o){n*=this.itemSize,o*=i.itemSize;for(let l=0,a=this.itemSize;l<a;l++)this.array[n+l]=i.array[o+l];return this}copyArray(n){return this.array.set(n),this}applyMatrix3(n){if(this.itemSize===2)for(let i=0,o=this.count;i<o;i++)Uv.fromBufferAttribute(this,i),Uv.applyMatrix3(n),this.setXY(i,Uv.x,Uv.y);else if(this.itemSize===3)for(let i=0,o=this.count;i<o;i++)Ur.fromBufferAttribute(this,i),Ur.applyMatrix3(n),this.setXYZ(i,Ur.x,Ur.y,Ur.z);return this}applyMatrix4(n){for(let i=0,o=this.count;i<o;i++)Ur.fromBufferAttribute(this,i),Ur.applyMatrix4(n),this.setXYZ(i,Ur.x,Ur.y,Ur.z);return this}applyNormalMatrix(n){for(let i=0,o=this.count;i<o;i++)Ur.fromBufferAttribute(this,i),Ur.applyNormalMatrix(n),this.setXYZ(i,Ur.x,Ur.y,Ur.z);return this}transformDirection(n){for(let i=0,o=this.count;i<o;i++)Ur.fromBufferAttribute(this,i),Ur.transformDirection(n),this.setXYZ(i,Ur.x,Ur.y,Ur.z);return this}set(n,i=0){return this.array.set(n,i),this}getX(n){let i=this.array[n*this.itemSize];return this.normalized&&(i=Lv(i,this.array)),i}setX(n,i){return this.normalized&&(i=Qs(i,this.array)),this.array[n*this.itemSize]=i,this}getY(n){let i=this.array[n*this.itemSize+1];return this.normalized&&(i=Lv(i,this.array)),i}setY(n,i){return this.normalized&&(i=Qs(i,this.array)),this.array[n*this.itemSize+1]=i,this}getZ(n){let i=this.array[n*this.itemSize+2];return this.normalized&&(i=Lv(i,this.array)),i}setZ(n,i){return this.normalized&&(i=Qs(i,this.array)),this.array[n*this.itemSize+2]=i,this}getW(n){let i=this.array[n*this.itemSize+3];return this.normalized&&(i=Lv(i,this.array)),i}setW(n,i){return this.normalized&&(i=Qs(i,this.array)),this.array[n*this.itemSize+3]=i,this}setXY(n,i,o){return n*=this.itemSize,this.normalized&&(i=Qs(i,this.array),o=Qs(o,this.array)),this.array[n+0]=i,this.array[n+1]=o,this}setXYZ(n,i,o,l){return n*=this.itemSize,this.normalized&&(i=Qs(i,this.array),o=Qs(o,this.array),l=Qs(l,this.array)),this.array[n+0]=i,this.array[n+1]=o,this.array[n+2]=l,this}setXYZW(n,i,o,l,a){return n*=this.itemSize,this.normalized&&(i=Qs(i,this.array),o=Qs(o,this.array),l=Qs(l,this.array),a=Qs(a,this.array)),this.array[n+0]=i,this.array[n+1]=o,this.array[n+2]=l,this.array[n+3]=a,this}onUpload(n){return this.onUploadCallback=n,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const n={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(n.name=this.name),this.usage!==JC&&(n.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(n.updateRange=this.updateRange),n}copyColorsArray(){console.error("THREE.BufferAttribute: copyColorsArray() was removed in r144.")}copyVector2sArray(){console.error("THREE.BufferAttribute: copyVector2sArray() was removed in r144.")}copyVector3sArray(){console.error("THREE.BufferAttribute: copyVector3sArray() was removed in r144.")}copyVector4sArray(){console.error("THREE.BufferAttribute: copyVector4sArray() was removed in r144.")}}class hO extends ta{constructor(n,i,o){super(new Uint16Array(n),i,o)}}class dO extends ta{constructor(n,i,o){super(new Uint32Array(n),i,o)}}class $r extends ta{constructor(n,i,o){super(new Float32Array(n),i,o)}}let iV=0;const mo=new Er,Vb=new ls,Qh=new it,Js=new qu,up=new qu,Jr=new it;class ho extends ra{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:iV++}),this.uuid=Im(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(n){return Array.isArray(n)?this.index=new(oO(n)?dO:hO)(n,1):this.index=n,this}getAttribute(n){return this.attributes[n]}setAttribute(n,i){return this.attributes[n]=i,this}deleteAttribute(n){return delete this.attributes[n],this}hasAttribute(n){return this.attributes[n]!==void 0}addGroup(n,i,o=0){this.groups.push({start:n,count:i,materialIndex:o})}clearGroups(){this.groups=[]}setDrawRange(n,i){this.drawRange.start=n,this.drawRange.count=i}applyMatrix4(n){const i=this.attributes.position;i!==void 0&&(i.applyMatrix4(n),i.needsUpdate=!0);const o=this.attributes.normal;if(o!==void 0){const a=new no().getNormalMatrix(n);o.applyNormalMatrix(a),o.needsUpdate=!0}const l=this.attributes.tangent;return l!==void 0&&(l.transformDirection(n),l.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(n){return mo.makeRotationFromQuaternion(n),this.applyMatrix4(mo),this}rotateX(n){return mo.makeRotationX(n),this.applyMatrix4(mo),this}rotateY(n){return mo.makeRotationY(n),this.applyMatrix4(mo),this}rotateZ(n){return mo.makeRotationZ(n),this.applyMatrix4(mo),this}translate(n,i,o){return mo.makeTranslation(n,i,o),this.applyMatrix4(mo),this}scale(n,i,o){return mo.makeScale(n,i,o),this.applyMatrix4(mo),this}lookAt(n){return Vb.lookAt(n),Vb.updateMatrix(),this.applyMatrix4(Vb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Qh).negate(),this.translate(Qh.x,Qh.y,Qh.z),this}setFromPoints(n){const i=[];for(let o=0,l=n.length;o<l;o++){const a=n[o];i.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new $r(i,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new qu);const n=this.attributes.position,i=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new it(-1/0,-1/0,-1/0),new it(1/0,1/0,1/0));return}if(n!==void 0){if(this.boundingBox.setFromBufferAttribute(n),i)for(let o=0,l=i.length;o<l;o++){const a=i[o];Js.setFromBufferAttribute(a),this.morphTargetsRelative?(Jr.addVectors(this.boundingBox.min,Js.min),this.boundingBox.expandByPoint(Jr),Jr.addVectors(this.boundingBox.max,Js.max),this.boundingBox.expandByPoint(Jr)):(this.boundingBox.expandByPoint(Js.min),this.boundingBox.expandByPoint(Js.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new jy);const n=this.attributes.position,i=this.morphAttributes.position;if(n&&n.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new it,1/0);return}if(n){const o=this.boundingSphere.center;if(Js.setFromBufferAttribute(n),i)for(let a=0,u=i.length;a<u;a++){const h=i[a];up.setFromBufferAttribute(h),this.morphTargetsRelative?(Jr.addVectors(Js.min,up.min),Js.expandByPoint(Jr),Jr.addVectors(Js.max,up.max),Js.expandByPoint(Jr)):(Js.expandByPoint(up.min),Js.expandByPoint(up.max))}Js.getCenter(o);let l=0;for(let a=0,u=n.count;a<u;a++)Jr.fromBufferAttribute(n,a),l=Math.max(l,o.distanceToSquared(Jr));if(i)for(let a=0,u=i.length;a<u;a++){const h=i[a],f=this.morphTargetsRelative;for(let d=0,m=h.count;d<m;d++)Jr.fromBufferAttribute(h,d),f&&(Qh.fromBufferAttribute(n,d),Jr.add(Qh)),l=Math.max(l,o.distanceToSquared(Jr))}this.boundingSphere.radius=Math.sqrt(l),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const n=this.index,i=this.attributes;if(n===null||i.position===void 0||i.normal===void 0||i.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const o=n.array,l=i.position.array,a=i.normal.array,u=i.uv.array,h=l.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new ta(new Float32Array(4*h),4));const f=this.getAttribute("tangent").array,d=[],m=[];for(let q=0;q<h;q++)d[q]=new it,m[q]=new it;const g=new it,x=new it,v=new it,A=new Rn,_=new Rn,E=new Rn,w=new it,S=new it;function T(q,le,ne){g.fromArray(l,q*3),x.fromArray(l,le*3),v.fromArray(l,ne*3),A.fromArray(u,q*2),_.fromArray(u,le*2),E.fromArray(u,ne*2),x.sub(g),v.sub(g),_.sub(A),E.sub(A);const D=1/(_.x*E.y-E.x*_.y);!isFinite(D)||(w.copy(x).multiplyScalar(E.y).addScaledVector(v,-_.y).multiplyScalar(D),S.copy(v).multiplyScalar(_.x).addScaledVector(x,-E.x).multiplyScalar(D),d[q].add(w),d[le].add(w),d[ne].add(w),m[q].add(S),m[le].add(S),m[ne].add(S))}let R=this.groups;R.length===0&&(R=[{start:0,count:o.length}]);for(let q=0,le=R.length;q<le;++q){const ne=R[q],D=ne.start,O=ne.count;for(let k=D,z=D+O;k<z;k+=3)T(o[k+0],o[k+1],o[k+2])}const L=new it,I=new it,N=new it,B=new it;function H(q){N.fromArray(a,q*3),B.copy(N);const le=d[q];L.copy(le),L.sub(N.multiplyScalar(N.dot(le))).normalize(),I.crossVectors(B,le);const D=I.dot(m[q])<0?-1:1;f[q*4]=L.x,f[q*4+1]=L.y,f[q*4+2]=L.z,f[q*4+3]=D}for(let q=0,le=R.length;q<le;++q){const ne=R[q],D=ne.start,O=ne.count;for(let k=D,z=D+O;k<z;k+=3)H(o[k+0]),H(o[k+1]),H(o[k+2])}}computeVertexNormals(){const n=this.index,i=this.getAttribute("position");if(i!==void 0){let o=this.getAttribute("normal");if(o===void 0)o=new ta(new Float32Array(i.count*3),3),this.setAttribute("normal",o);else for(let x=0,v=o.count;x<v;x++)o.setXYZ(x,0,0,0);const l=new it,a=new it,u=new it,h=new it,f=new it,d=new it,m=new it,g=new it;if(n)for(let x=0,v=n.count;x<v;x+=3){const A=n.getX(x+0),_=n.getX(x+1),E=n.getX(x+2);l.fromBufferAttribute(i,A),a.fromBufferAttribute(i,_),u.fromBufferAttribute(i,E),m.subVectors(u,a),g.subVectors(l,a),m.cross(g),h.fromBufferAttribute(o,A),f.fromBufferAttribute(o,_),d.fromBufferAttribute(o,E),h.add(m),f.add(m),d.add(m),o.setXYZ(A,h.x,h.y,h.z),o.setXYZ(_,f.x,f.y,f.z),o.setXYZ(E,d.x,d.y,d.z)}else for(let x=0,v=i.count;x<v;x+=3)l.fromBufferAttribute(i,x+0),a.fromBufferAttribute(i,x+1),u.fromBufferAttribute(i,x+2),m.subVectors(u,a),g.subVectors(l,a),m.cross(g),o.setXYZ(x+0,m.x,m.y,m.z),o.setXYZ(x+1,m.x,m.y,m.z),o.setXYZ(x+2,m.x,m.y,m.z);this.normalizeNormals(),o.needsUpdate=!0}}merge(){return console.error("THREE.BufferGeometry.merge() has been removed. Use THREE.BufferGeometryUtils.mergeBufferGeometries() instead."),this}normalizeNormals(){const n=this.attributes.normal;for(let i=0,o=n.count;i<o;i++)Jr.fromBufferAttribute(n,i),Jr.normalize(),n.setXYZ(i,Jr.x,Jr.y,Jr.z)}toNonIndexed(){function n(h,f){const d=h.array,m=h.itemSize,g=h.normalized,x=new d.constructor(f.length*m);let v=0,A=0;for(let _=0,E=f.length;_<E;_++){h.isInterleavedBufferAttribute?v=f[_]*h.data.stride+h.offset:v=f[_]*m;for(let w=0;w<m;w++)x[A++]=d[v++]}return new ta(x,m,g)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const i=new ho,o=this.index.array,l=this.attributes;for(const h in l){const f=l[h],d=n(f,o);i.setAttribute(h,d)}const a=this.morphAttributes;for(const h in a){const f=[],d=a[h];for(let m=0,g=d.length;m<g;m++){const x=d[m],v=n(x,o);f.push(v)}i.morphAttributes[h]=f}i.morphTargetsRelative=this.morphTargetsRelative;const u=this.groups;for(let h=0,f=u.length;h<f;h++){const d=u[h];i.addGroup(d.start,d.count,d.materialIndex)}return i}toJSON(){const n={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),Object.keys(this.userData).length>0&&(n.userData=this.userData),this.parameters!==void 0){const f=this.parameters;for(const d in f)f[d]!==void 0&&(n[d]=f[d]);return n}n.data={attributes:{}};const i=this.index;i!==null&&(n.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});const o=this.attributes;for(const f in o){const d=o[f];n.data.attributes[f]=d.toJSON(n.data)}const l={};let a=!1;for(const f in this.morphAttributes){const d=this.morphAttributes[f],m=[];for(let g=0,x=d.length;g<x;g++){const v=d[g];m.push(v.toJSON(n.data))}m.length>0&&(l[f]=m,a=!0)}a&&(n.data.morphAttributes=l,n.data.morphTargetsRelative=this.morphTargetsRelative);const u=this.groups;u.length>0&&(n.data.groups=JSON.parse(JSON.stringify(u)));const h=this.boundingSphere;return h!==null&&(n.data.boundingSphere={center:h.center.toArray(),radius:h.radius}),n}clone(){return new this.constructor().copy(this)}copy(n){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const i={};this.name=n.name;const o=n.index;o!==null&&this.setIndex(o.clone(i));const l=n.attributes;for(const d in l){const m=l[d];this.setAttribute(d,m.clone(i))}const a=n.morphAttributes;for(const d in a){const m=[],g=a[d];for(let x=0,v=g.length;x<v;x++)m.push(g[x].clone(i));this.morphAttributes[d]=m}this.morphTargetsRelative=n.morphTargetsRelative;const u=n.groups;for(let d=0,m=u.length;d<m;d++){const g=u[d];this.addGroup(g.start,g.count,g.materialIndex)}const h=n.boundingBox;h!==null&&(this.boundingBox=h.clone());const f=n.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=n.drawRange.start,this.drawRange.count=n.drawRange.count,this.userData=n.userData,n.parameters!==void 0&&(this.parameters=Object.assign({},n.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const d3=new Er,Zh=new Aw,Wb=new jy,hp=new it,dp=new it,fp=new it,jb=new it,zv=new it,Hv=new Rn,Gv=new Rn,Vv=new Rn,$b=new it,Wv=new it;class Zo extends ls{constructor(n=new ho,i=new Mw){super(),this.isMesh=!0,this.type="Mesh",this.geometry=n,this.material=i,this.updateMorphTargets()}copy(n,i){return super.copy(n,i),n.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=n.morphTargetInfluences.slice()),n.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},n.morphTargetDictionary)),this.material=n.material,this.geometry=n.geometry,this}updateMorphTargets(){const i=this.geometry.morphAttributes,o=Object.keys(i);if(o.length>0){const l=i[o[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=l.length;a<u;a++){const h=l[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=a}}}}getVertexPosition(n,i){const o=this.geometry,l=o.attributes.position,a=o.morphAttributes.position,u=o.morphTargetsRelative;i.fromBufferAttribute(l,n);const h=this.morphTargetInfluences;if(a&&h){zv.set(0,0,0);for(let f=0,d=a.length;f<d;f++){const m=h[f],g=a[f];m!==0&&(jb.fromBufferAttribute(g,n),u?zv.addScaledVector(jb,m):zv.addScaledVector(jb.sub(i),m))}i.add(zv)}return this.isSkinnedMesh&&this.boneTransform(n,i),i}raycast(n,i){const o=this.geometry,l=this.material,a=this.matrixWorld;if(l===void 0||(o.boundingSphere===null&&o.computeBoundingSphere(),Wb.copy(o.boundingSphere),Wb.applyMatrix4(a),n.ray.intersectsSphere(Wb)===!1)||(d3.copy(a).invert(),Zh.copy(n.ray).applyMatrix4(d3),o.boundingBox!==null&&Zh.intersectsBox(o.boundingBox)===!1))return;let u;const h=o.index,f=o.attributes.position,d=o.attributes.uv,m=o.attributes.uv2,g=o.groups,x=o.drawRange;if(h!==null)if(Array.isArray(l))for(let v=0,A=g.length;v<A;v++){const _=g[v],E=l[_.materialIndex],w=Math.max(_.start,x.start),S=Math.min(h.count,Math.min(_.start+_.count,x.start+x.count));for(let T=w,R=S;T<R;T+=3){const L=h.getX(T),I=h.getX(T+1),N=h.getX(T+2);u=jv(this,E,n,Zh,d,m,L,I,N),u&&(u.faceIndex=Math.floor(T/3),u.face.materialIndex=_.materialIndex,i.push(u))}}else{const v=Math.max(0,x.start),A=Math.min(h.count,x.start+x.count);for(let _=v,E=A;_<E;_+=3){const w=h.getX(_),S=h.getX(_+1),T=h.getX(_+2);u=jv(this,l,n,Zh,d,m,w,S,T),u&&(u.faceIndex=Math.floor(_/3),i.push(u))}}else if(f!==void 0)if(Array.isArray(l))for(let v=0,A=g.length;v<A;v++){const _=g[v],E=l[_.materialIndex],w=Math.max(_.start,x.start),S=Math.min(f.count,Math.min(_.start+_.count,x.start+x.count));for(let T=w,R=S;T<R;T+=3){const L=T,I=T+1,N=T+2;u=jv(this,E,n,Zh,d,m,L,I,N),u&&(u.faceIndex=Math.floor(T/3),u.face.materialIndex=_.materialIndex,i.push(u))}}else{const v=Math.max(0,x.start),A=Math.min(f.count,x.start+x.count);for(let _=v,E=A;_<E;_+=3){const w=_,S=_+1,T=_+2;u=jv(this,l,n,Zh,d,m,w,S,T),u&&(u.faceIndex=Math.floor(_/3),i.push(u))}}}}function rV(r,n,i,o,l,a,u,h){let f;if(n.side===ro?f=o.intersectTriangle(u,a,l,!0,h):f=o.intersectTriangle(l,a,u,n.side===zu,h),f===null)return null;Wv.copy(h),Wv.applyMatrix4(r.matrixWorld);const d=i.ray.origin.distanceTo(Wv);return d<i.near||d>i.far?null:{distance:d,point:Wv.clone(),object:r}}function jv(r,n,i,o,l,a,u,h,f){r.getVertexPosition(u,hp),r.getVertexPosition(h,dp),r.getVertexPosition(f,fp);const d=rV(r,n,i,o,hp,dp,fp,$b);if(d){l&&(Hv.fromBufferAttribute(l,u),Gv.fromBufferAttribute(l,h),Vv.fromBufferAttribute(l,f),d.uv=cl.getUV($b,hp,dp,fp,Hv,Gv,Vv,new Rn)),a&&(Hv.fromBufferAttribute(a,u),Gv.fromBufferAttribute(a,h),Vv.fromBufferAttribute(a,f),d.uv2=cl.getUV($b,hp,dp,fp,Hv,Gv,Vv,new Rn));const m={a:u,b:h,c:f,normal:new it,materialIndex:0};cl.getNormal(hp,dp,fp,m.normal),d.face=m}return d}class Nm extends ho{constructor(n=1,i=1,o=1,l=1,a=1,u=1){super(),this.type="BoxGeometry",this.parameters={width:n,height:i,depth:o,widthSegments:l,heightSegments:a,depthSegments:u};const h=this;l=Math.floor(l),a=Math.floor(a),u=Math.floor(u);const f=[],d=[],m=[],g=[];let x=0,v=0;A("z","y","x",-1,-1,o,i,n,u,a,0),A("z","y","x",1,-1,o,i,-n,u,a,1),A("x","z","y",1,1,n,o,i,l,u,2),A("x","z","y",1,-1,n,o,-i,l,u,3),A("x","y","z",1,-1,n,i,o,l,a,4),A("x","y","z",-1,-1,n,i,-o,l,a,5),this.setIndex(f),this.setAttribute("position",new $r(d,3)),this.setAttribute("normal",new $r(m,3)),this.setAttribute("uv",new $r(g,2));function A(_,E,w,S,T,R,L,I,N,B,H){const q=R/N,le=L/B,ne=R/2,D=L/2,O=I/2,k=N+1,z=B+1;let X=0,Z=0;const ie=new it;for(let se=0;se<z;se++){const ue=se*le-D;for(let ye=0;ye<k;ye++){const Ce=ye*q-ne;ie[_]=Ce*S,ie[E]=ue*T,ie[w]=O,d.push(ie.x,ie.y,ie.z),ie[_]=0,ie[E]=0,ie[w]=I>0?1:-1,m.push(ie.x,ie.y,ie.z),g.push(ye/N),g.push(1-se/B),X+=1}}for(let se=0;se<B;se++)for(let ue=0;ue<N;ue++){const ye=x+ue+k*se,Ce=x+ue+k*(se+1),ke=x+(ue+1)+k*(se+1),Oe=x+(ue+1)+k*se;f.push(ye,Ce,Oe),f.push(Ce,ke,Oe),Z+=6}h.addGroup(v,Z,H),v+=Z,x+=X}}static fromJSON(n){return new Nm(n.width,n.height,n.depth,n.widthSegments,n.heightSegments,n.depthSegments)}}function Kd(r){const n={};for(const i in r){n[i]={};for(const o in r[i]){const l=r[i][o];l&&(l.isColor||l.isMatrix3||l.isMatrix4||l.isVector2||l.isVector3||l.isVector4||l.isTexture||l.isQuaternion)?n[i][o]=l.clone():Array.isArray(l)?n[i][o]=l.slice():n[i][o]=l}}return n}function ws(r){const n={};for(let i=0;i<r.length;i++){const o=Kd(r[i]);for(const l in o)n[l]=o[l]}return n}function sV(r){const n=[];for(let i=0;i<r.length;i++)n.push(r[i].clone());return n}function fO(r){return r.getRenderTarget()===null&&r.outputEncoding===pr?Ea:xm}const pO={clone:Kd,merge:ws};var oV=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,aV=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ml extends uf{constructor(n){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=oV,this.fragmentShader=aV,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,n!==void 0&&this.setValues(n)}copy(n){return super.copy(n),this.fragmentShader=n.fragmentShader,this.vertexShader=n.vertexShader,this.uniforms=Kd(n.uniforms),this.uniformsGroups=sV(n.uniformsGroups),this.defines=Object.assign({},n.defines),this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.fog=n.fog,this.lights=n.lights,this.clipping=n.clipping,this.extensions=Object.assign({},n.extensions),this.glslVersion=n.glslVersion,this}toJSON(n){const i=super.toJSON(n);i.glslVersion=this.glslVersion,i.uniforms={};for(const l in this.uniforms){const u=this.uniforms[l].value;u&&u.isTexture?i.uniforms[l]={type:"t",value:u.toJSON(n).uuid}:u&&u.isColor?i.uniforms[l]={type:"c",value:u.getHex()}:u&&u.isVector2?i.uniforms[l]={type:"v2",value:u.toArray()}:u&&u.isVector3?i.uniforms[l]={type:"v3",value:u.toArray()}:u&&u.isVector4?i.uniforms[l]={type:"v4",value:u.toArray()}:u&&u.isMatrix3?i.uniforms[l]={type:"m3",value:u.toArray()}:u&&u.isMatrix4?i.uniforms[l]={type:"m4",value:u.toArray()}:i.uniforms[l]={value:u}}Object.keys(this.defines).length>0&&(i.defines=this.defines),i.vertexShader=this.vertexShader,i.fragmentShader=this.fragmentShader;const o={};for(const l in this.extensions)this.extensions[l]===!0&&(o[l]=!0);return Object.keys(o).length>0&&(i.extensions=o),i}}class mO extends ls{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Er,this.projectionMatrix=new Er,this.projectionMatrixInverse=new Er}copy(n,i){return super.copy(n,i),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const i=this.matrixWorld.elements;return n.set(-i[8],-i[9],-i[10]).normalize()}updateMatrixWorld(n){super.updateMatrixWorld(n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(n,i){super.updateWorldMatrix(n,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class _o extends mO{constructor(n=50,i=1,o=.1,l=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=n,this.zoom=1,this.near=o,this.far=l,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(n,i){return super.copy(n,i),this.fov=n.fov,this.zoom=n.zoom,this.near=n.near,this.far=n.far,this.focus=n.focus,this.aspect=n.aspect,this.view=n.view===null?null:Object.assign({},n.view),this.filmGauge=n.filmGauge,this.filmOffset=n.filmOffset,this}setFocalLength(n){const i=.5*this.getFilmHeight()/n;this.fov=t3*2*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){const n=Math.tan(Sb*.5*this.fov);return .5*this.getFilmHeight()/n}getEffectiveFOV(){return t3*2*Math.atan(Math.tan(Sb*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(n,i,o,l,a,u){this.aspect=n/i,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=i,this.view.offsetX=o,this.view.offsetY=l,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=this.near;let i=n*Math.tan(Sb*.5*this.fov)/this.zoom,o=2*i,l=this.aspect*o,a=-.5*l;const u=this.view;if(this.view!==null&&this.view.enabled){const f=u.fullWidth,d=u.fullHeight;a+=u.offsetX*l/f,i-=u.offsetY*o/d,l*=u.width/f,o*=u.height/d}const h=this.filmOffset;h!==0&&(a+=n*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+l,i,i-o,n,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const i=super.toJSON(n);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,this.view!==null&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}}const Jh=-90,ed=1;class lV extends ls{constructor(n,i,o){super(),this.type="CubeCamera",this.renderTarget=o;const l=new _o(Jh,ed,n,i);l.layers=this.layers,l.up.set(0,1,0),l.lookAt(1,0,0),this.add(l);const a=new _o(Jh,ed,n,i);a.layers=this.layers,a.up.set(0,1,0),a.lookAt(-1,0,0),this.add(a);const u=new _o(Jh,ed,n,i);u.layers=this.layers,u.up.set(0,0,-1),u.lookAt(0,1,0),this.add(u);const h=new _o(Jh,ed,n,i);h.layers=this.layers,h.up.set(0,0,1),h.lookAt(0,-1,0),this.add(h);const f=new _o(Jh,ed,n,i);f.layers=this.layers,f.up.set(0,1,0),f.lookAt(0,0,1),this.add(f);const d=new _o(Jh,ed,n,i);d.layers=this.layers,d.up.set(0,1,0),d.lookAt(0,0,-1),this.add(d)}update(n,i){this.parent===null&&this.updateMatrixWorld();const o=this.renderTarget,[l,a,u,h,f,d]=this.children,m=n.getRenderTarget(),g=n.toneMapping,x=n.xr.enabled;n.toneMapping=gl,n.xr.enabled=!1;const v=o.texture.generateMipmaps;o.texture.generateMipmaps=!1,n.setRenderTarget(o,0),n.render(i,l),n.setRenderTarget(o,1),n.render(i,a),n.setRenderTarget(o,2),n.render(i,u),n.setRenderTarget(o,3),n.render(i,h),n.setRenderTarget(o,4),n.render(i,f),o.texture.generateMipmaps=v,n.setRenderTarget(o,5),n.render(i,d),n.setRenderTarget(m),n.toneMapping=g,n.xr.enabled=x,o.texture.needsPMREMUpdate=!0}}class gO extends Gs{constructor(n,i,o,l,a,u,h,f,d,m){n=n!==void 0?n:[],i=i!==void 0?i:Xd,super(n,i,o,l,a,u,h,f,d,m),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(n){this.image=n}}class cV extends Tc{constructor(n=1,i={}){super(n,n,i),this.isWebGLCubeRenderTarget=!0;const o={width:n,height:n,depth:1},l=[o,o,o,o,o,o];this.texture=new gO(l,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:xo}fromEquirectangularTexture(n,i){this.texture.type=i.type,this.texture.encoding=i.encoding,this.texture.generateMipmaps=i.generateMipmaps,this.texture.minFilter=i.minFilter,this.texture.magFilter=i.magFilter;const o={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},l=new Nm(5,5,5),a=new Ml({name:"CubemapFromEquirect",uniforms:Kd(o.uniforms),vertexShader:o.vertexShader,fragmentShader:o.fragmentShader,side:ro,blending:wc});a.uniforms.tEquirect.value=i;const u=new Zo(l,a),h=i.minFilter;return i.minFilter===vm&&(i.minFilter=xo),new lV(1,10,this).update(n,u),i.minFilter=h,u.geometry.dispose(),u.material.dispose(),this}clear(n,i,o,l){const a=n.getRenderTarget();for(let u=0;u<6;u++)n.setRenderTarget(this,u),n.clear(i,o,l);n.setRenderTarget(a)}}const Xb=new it,uV=new it,hV=new no;class cc{constructor(n=new it(1,0,0),i=0){this.isPlane=!0,this.normal=n,this.constant=i}set(n,i){return this.normal.copy(n),this.constant=i,this}setComponents(n,i,o,l){return this.normal.set(n,i,o),this.constant=l,this}setFromNormalAndCoplanarPoint(n,i){return this.normal.copy(n),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(n,i,o){const l=Xb.subVectors(o,i).cross(uV.subVectors(n,i)).normalize();return this.setFromNormalAndCoplanarPoint(l,n),this}copy(n){return this.normal.copy(n.normal),this.constant=n.constant,this}normalize(){const n=1/this.normal.length();return this.normal.multiplyScalar(n),this.constant*=n,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(n){return this.normal.dot(n)+this.constant}distanceToSphere(n){return this.distanceToPoint(n.center)-n.radius}projectPoint(n,i){return i.copy(this.normal).multiplyScalar(-this.distanceToPoint(n)).add(n)}intersectLine(n,i){const o=n.delta(Xb),l=this.normal.dot(o);if(l===0)return this.distanceToPoint(n.start)===0?i.copy(n.start):null;const a=-(n.start.dot(this.normal)+this.constant)/l;return a<0||a>1?null:i.copy(o).multiplyScalar(a).add(n.start)}intersectsLine(n){const i=this.distanceToPoint(n.start),o=this.distanceToPoint(n.end);return i<0&&o>0||o<0&&i>0}intersectsBox(n){return n.intersectsPlane(this)}intersectsSphere(n){return n.intersectsPlane(this)}coplanarPoint(n){return n.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(n,i){const o=i||hV.getNormalMatrix(n),l=this.coplanarPoint(Xb).applyMatrix4(n),a=this.normal.applyMatrix3(o).normalize();return this.constant=-l.dot(a),this}translate(n){return this.constant-=n.dot(this.normal),this}equals(n){return n.normal.equals(this.normal)&&n.constant===this.constant}clone(){return new this.constructor().copy(this)}}const td=new jy,$v=new it;class Sw{constructor(n=new cc,i=new cc,o=new cc,l=new cc,a=new cc,u=new cc){this.planes=[n,i,o,l,a,u]}set(n,i,o,l,a,u){const h=this.planes;return h[0].copy(n),h[1].copy(i),h[2].copy(o),h[3].copy(l),h[4].copy(a),h[5].copy(u),this}copy(n){const i=this.planes;for(let o=0;o<6;o++)i[o].copy(n.planes[o]);return this}setFromProjectionMatrix(n){const i=this.planes,o=n.elements,l=o[0],a=o[1],u=o[2],h=o[3],f=o[4],d=o[5],m=o[6],g=o[7],x=o[8],v=o[9],A=o[10],_=o[11],E=o[12],w=o[13],S=o[14],T=o[15];return i[0].setComponents(h-l,g-f,_-x,T-E).normalize(),i[1].setComponents(h+l,g+f,_+x,T+E).normalize(),i[2].setComponents(h+a,g+d,_+v,T+w).normalize(),i[3].setComponents(h-a,g-d,_-v,T-w).normalize(),i[4].setComponents(h-u,g-m,_-A,T-S).normalize(),i[5].setComponents(h+u,g+m,_+A,T+S).normalize(),this}intersectsObject(n){const i=n.geometry;return i.boundingSphere===null&&i.computeBoundingSphere(),td.copy(i.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(td)}intersectsSprite(n){return td.center.set(0,0,0),td.radius=.7071067811865476,td.applyMatrix4(n.matrixWorld),this.intersectsSphere(td)}intersectsSphere(n){const i=this.planes,o=n.center,l=-n.radius;for(let a=0;a<6;a++)if(i[a].distanceToPoint(o)<l)return!1;return!0}intersectsBox(n){const i=this.planes;for(let o=0;o<6;o++){const l=i[o];if($v.x=l.normal.x>0?n.max.x:n.min.x,$v.y=l.normal.y>0?n.max.y:n.min.y,$v.z=l.normal.z>0?n.max.z:n.min.z,l.distanceToPoint($v)<0)return!1}return!0}containsPoint(n){const i=this.planes;for(let o=0;o<6;o++)if(i[o].distanceToPoint(n)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function vO(){let r=null,n=!1,i=null,o=null;function l(a,u){i(a,u),o=r.requestAnimationFrame(l)}return{start:function(){n!==!0&&i!==null&&(o=r.requestAnimationFrame(l),n=!0)},stop:function(){r.cancelAnimationFrame(o),n=!1},setAnimationLoop:function(a){i=a},setContext:function(a){r=a}}}function dV(r,n){const i=n.isWebGL2,o=new WeakMap;function l(d,m){const g=d.array,x=d.usage,v=r.createBuffer();r.bindBuffer(m,v),r.bufferData(m,g,x),d.onUploadCallback();let A;if(g instanceof Float32Array)A=5126;else if(g instanceof Uint16Array)if(d.isFloat16BufferAttribute)if(i)A=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else A=5123;else if(g instanceof Int16Array)A=5122;else if(g instanceof Uint32Array)A=5125;else if(g instanceof Int32Array)A=5124;else if(g instanceof Int8Array)A=5120;else if(g instanceof Uint8Array)A=5121;else if(g instanceof Uint8ClampedArray)A=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+g);return{buffer:v,type:A,bytesPerElement:g.BYTES_PER_ELEMENT,version:d.version}}function a(d,m,g){const x=m.array,v=m.updateRange;r.bindBuffer(g,d),v.count===-1?r.bufferSubData(g,0,x):(i?r.bufferSubData(g,v.offset*x.BYTES_PER_ELEMENT,x,v.offset,v.count):r.bufferSubData(g,v.offset*x.BYTES_PER_ELEMENT,x.subarray(v.offset,v.offset+v.count)),v.count=-1),m.onUploadCallback()}function u(d){return d.isInterleavedBufferAttribute&&(d=d.data),o.get(d)}function h(d){d.isInterleavedBufferAttribute&&(d=d.data);const m=o.get(d);m&&(r.deleteBuffer(m.buffer),o.delete(d))}function f(d,m){if(d.isGLBufferAttribute){const x=o.get(d);(!x||x.version<d.version)&&o.set(d,{buffer:d.buffer,type:d.type,bytesPerElement:d.elementSize,version:d.version});return}d.isInterleavedBufferAttribute&&(d=d.data);const g=o.get(d);g===void 0?o.set(d,l(d,m)):g.version<d.version&&(a(g.buffer,d,m),g.version=d.version)}return{get:u,remove:h,update:f}}class Tw extends ho{constructor(n=1,i=1,o=1,l=1){super(),this.type="PlaneGeometry",this.parameters={width:n,height:i,widthSegments:o,heightSegments:l};const a=n/2,u=i/2,h=Math.floor(o),f=Math.floor(l),d=h+1,m=f+1,g=n/h,x=i/f,v=[],A=[],_=[],E=[];for(let w=0;w<m;w++){const S=w*x-u;for(let T=0;T<d;T++){const R=T*g-a;A.push(R,-S,0),_.push(0,0,1),E.push(T/h),E.push(1-w/f)}}for(let w=0;w<f;w++)for(let S=0;S<h;S++){const T=S+d*w,R=S+d*(w+1),L=S+1+d*(w+1),I=S+1+d*w;v.push(T,R,I),v.push(R,L,I)}this.setIndex(v),this.setAttribute("position",new $r(A,3)),this.setAttribute("normal",new $r(_,3)),this.setAttribute("uv",new $r(E,2))}static fromJSON(n){return new Tw(n.width,n.height,n.widthSegments,n.heightSegments)}}var fV=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,pV=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mV=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,gV=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,vV=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,yV=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xV="vec3 transformed = vec3( position );",_V=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bV=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
	vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = mix( F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,EV=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			 return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float R21 = R12;
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,AV=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = dFdx( surf_pos.xyz );
		vec3 vSigmaY = dFdy( surf_pos.xyz );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,wV=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,MV=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,SV=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,TV=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,CV=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,RV=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,LV=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,PV=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,DV=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,OV=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_v0 0.339
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_v1 0.276
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_v4 0.046
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_v5 0.016
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_v6 0.0038
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,IV=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,kV=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,NV=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,FV=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,BV=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,UV="gl_FragColor = linearToOutputTexel( gl_FragColor );",zV=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,HV=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,GV=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,VV=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,WV=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,jV=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,$V=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,XV=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,qV=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,YV=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,KV=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,QV=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,ZV=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,JV=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,e7=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,t7=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,n7=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,i7=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,r7=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,s7=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,o7=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,a7=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,l7=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,c7=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometry.viewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,u7=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,h7=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,d7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,f7=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,p7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,m7=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,g7=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,v7=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,y7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,x7=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,_7=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,b7=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,E7=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,A7=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,w7=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,M7=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,S7=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,T7=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,C7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,R7=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,L7=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,P7=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,D7=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,O7=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,I7=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,k7=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,N7=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,F7=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,B7=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,U7=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,z7=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,H7=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,G7=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,V7=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,W7=`#if NUM_SPOT_LIGHT_COORDS > 0
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
  uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,j7=`#if NUM_SPOT_LIGHT_COORDS > 0
  uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
  varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,$7=`#if defined( USE_SHADOWMAP ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_COORDS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,X7=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,q7=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Y7=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,K7=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Q7=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Z7=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,J7=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,e9=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,t9=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,n9=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmission.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, material.transmission );
#endif`,i9=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,r9=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,s9=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,o9=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,a9=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,l9=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,c9=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,u9=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const h9=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,d9=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,f9=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,p9=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,m9=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,g9=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,v9=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,y9=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,x9=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,_9=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,b9=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,E9=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,A9=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,w9=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,M9=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,S9=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,T9=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,C9=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,R9=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,L9=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,P9=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,D9=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,O9=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,I9=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,k9=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,N9=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,F9=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,B9=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,U9=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,z9=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,H9=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,G9=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,V9=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,W9=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Li={alphamap_fragment:fV,alphamap_pars_fragment:pV,alphatest_fragment:mV,alphatest_pars_fragment:gV,aomap_fragment:vV,aomap_pars_fragment:yV,begin_vertex:xV,beginnormal_vertex:_V,bsdfs:bV,iridescence_fragment:EV,bumpmap_pars_fragment:AV,clipping_planes_fragment:wV,clipping_planes_pars_fragment:MV,clipping_planes_pars_vertex:SV,clipping_planes_vertex:TV,color_fragment:CV,color_pars_fragment:RV,color_pars_vertex:LV,color_vertex:PV,common:DV,cube_uv_reflection_fragment:OV,defaultnormal_vertex:IV,displacementmap_pars_vertex:kV,displacementmap_vertex:NV,emissivemap_fragment:FV,emissivemap_pars_fragment:BV,encodings_fragment:UV,encodings_pars_fragment:zV,envmap_fragment:HV,envmap_common_pars_fragment:GV,envmap_pars_fragment:VV,envmap_pars_vertex:WV,envmap_physical_pars_fragment:n7,envmap_vertex:jV,fog_vertex:$V,fog_pars_vertex:XV,fog_fragment:qV,fog_pars_fragment:YV,gradientmap_pars_fragment:KV,lightmap_fragment:QV,lightmap_pars_fragment:ZV,lights_lambert_fragment:JV,lights_lambert_pars_fragment:e7,lights_pars_begin:t7,lights_toon_fragment:i7,lights_toon_pars_fragment:r7,lights_phong_fragment:s7,lights_phong_pars_fragment:o7,lights_physical_fragment:a7,lights_physical_pars_fragment:l7,lights_fragment_begin:c7,lights_fragment_maps:u7,lights_fragment_end:h7,logdepthbuf_fragment:d7,logdepthbuf_pars_fragment:f7,logdepthbuf_pars_vertex:p7,logdepthbuf_vertex:m7,map_fragment:g7,map_pars_fragment:v7,map_particle_fragment:y7,map_particle_pars_fragment:x7,metalnessmap_fragment:_7,metalnessmap_pars_fragment:b7,morphcolor_vertex:E7,morphnormal_vertex:A7,morphtarget_pars_vertex:w7,morphtarget_vertex:M7,normal_fragment_begin:S7,normal_fragment_maps:T7,normal_pars_fragment:C7,normal_pars_vertex:R7,normal_vertex:L7,normalmap_pars_fragment:P7,clearcoat_normal_fragment_begin:D7,clearcoat_normal_fragment_maps:O7,clearcoat_pars_fragment:I7,iridescence_pars_fragment:k7,output_fragment:N7,packing:F7,premultiplied_alpha_fragment:B7,project_vertex:U7,dithering_fragment:z7,dithering_pars_fragment:H7,roughnessmap_fragment:G7,roughnessmap_pars_fragment:V7,shadowmap_pars_fragment:W7,shadowmap_pars_vertex:j7,shadowmap_vertex:$7,shadowmask_pars_fragment:X7,skinbase_vertex:q7,skinning_pars_vertex:Y7,skinning_vertex:K7,skinnormal_vertex:Q7,specularmap_fragment:Z7,specularmap_pars_fragment:J7,tonemapping_fragment:e9,tonemapping_pars_fragment:t9,transmission_fragment:n9,transmission_pars_fragment:i9,uv_pars_fragment:r9,uv_pars_vertex:s9,uv_vertex:o9,uv2_pars_fragment:a9,uv2_pars_vertex:l9,uv2_vertex:c9,worldpos_vertex:u9,background_vert:h9,background_frag:d9,backgroundCube_vert:f9,backgroundCube_frag:p9,cube_vert:m9,cube_frag:g9,depth_vert:v9,depth_frag:y9,distanceRGBA_vert:x9,distanceRGBA_frag:_9,equirect_vert:b9,equirect_frag:E9,linedashed_vert:A9,linedashed_frag:w9,meshbasic_vert:M9,meshbasic_frag:S9,meshlambert_vert:T9,meshlambert_frag:C9,meshmatcap_vert:R9,meshmatcap_frag:L9,meshnormal_vert:P9,meshnormal_frag:D9,meshphong_vert:O9,meshphong_frag:I9,meshphysical_vert:k9,meshphysical_frag:N9,meshtoon_vert:F9,meshtoon_frag:B9,points_vert:U9,points_frag:z9,shadow_vert:H9,shadow_frag:G9,sprite_vert:V9,sprite_frag:W9},_n={common:{diffuse:{value:new Ji(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new no},uv2Transform:{value:new no},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Rn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ji(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ji(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new no}},sprite:{diffuse:{value:new Ji(16777215)},opacity:{value:1},center:{value:new Rn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new no}}},wa={basic:{uniforms:ws([_n.common,_n.specularmap,_n.envmap,_n.aomap,_n.lightmap,_n.fog]),vertexShader:Li.meshbasic_vert,fragmentShader:Li.meshbasic_frag},lambert:{uniforms:ws([_n.common,_n.specularmap,_n.envmap,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.fog,_n.lights,{emissive:{value:new Ji(0)}}]),vertexShader:Li.meshlambert_vert,fragmentShader:Li.meshlambert_frag},phong:{uniforms:ws([_n.common,_n.specularmap,_n.envmap,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.fog,_n.lights,{emissive:{value:new Ji(0)},specular:{value:new Ji(1118481)},shininess:{value:30}}]),vertexShader:Li.meshphong_vert,fragmentShader:Li.meshphong_frag},standard:{uniforms:ws([_n.common,_n.envmap,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.roughnessmap,_n.metalnessmap,_n.fog,_n.lights,{emissive:{value:new Ji(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Li.meshphysical_vert,fragmentShader:Li.meshphysical_frag},toon:{uniforms:ws([_n.common,_n.aomap,_n.lightmap,_n.emissivemap,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.gradientmap,_n.fog,_n.lights,{emissive:{value:new Ji(0)}}]),vertexShader:Li.meshtoon_vert,fragmentShader:Li.meshtoon_frag},matcap:{uniforms:ws([_n.common,_n.bumpmap,_n.normalmap,_n.displacementmap,_n.fog,{matcap:{value:null}}]),vertexShader:Li.meshmatcap_vert,fragmentShader:Li.meshmatcap_frag},points:{uniforms:ws([_n.points,_n.fog]),vertexShader:Li.points_vert,fragmentShader:Li.points_frag},dashed:{uniforms:ws([_n.common,_n.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Li.linedashed_vert,fragmentShader:Li.linedashed_frag},depth:{uniforms:ws([_n.common,_n.displacementmap]),vertexShader:Li.depth_vert,fragmentShader:Li.depth_frag},normal:{uniforms:ws([_n.common,_n.bumpmap,_n.normalmap,_n.displacementmap,{opacity:{value:1}}]),vertexShader:Li.meshnormal_vert,fragmentShader:Li.meshnormal_frag},sprite:{uniforms:ws([_n.sprite,_n.fog]),vertexShader:Li.sprite_vert,fragmentShader:Li.sprite_frag},background:{uniforms:{uvTransform:{value:new no},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Li.background_vert,fragmentShader:Li.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Li.backgroundCube_vert,fragmentShader:Li.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Li.cube_vert,fragmentShader:Li.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Li.equirect_vert,fragmentShader:Li.equirect_frag},distanceRGBA:{uniforms:ws([_n.common,_n.displacementmap,{referencePosition:{value:new it},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Li.distanceRGBA_vert,fragmentShader:Li.distanceRGBA_frag},shadow:{uniforms:ws([_n.lights,_n.fog,{color:{value:new Ji(0)},opacity:{value:1}}]),vertexShader:Li.shadow_vert,fragmentShader:Li.shadow_frag}};wa.physical={uniforms:ws([wa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Rn(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new Ji(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Rn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Ji(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Ji(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Li.meshphysical_vert,fragmentShader:Li.meshphysical_frag};const Xv={r:0,b:0,g:0};function j9(r,n,i,o,l,a,u){const h=new Ji(0);let f=a===!0?0:1,d,m,g=null,x=0,v=null;function A(E,w){let S=!1,T=w.isScene===!0?w.background:null;T&&T.isTexture&&(T=(w.backgroundBlurriness>0?i:n).get(T));const R=r.xr,L=R.getSession&&R.getSession();L&&L.environmentBlendMode==="additive"&&(T=null),T===null?_(h,f):T&&T.isColor&&(_(T,1),S=!0),(r.autoClear||S)&&r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil),T&&(T.isCubeTexture||T.mapping===Wy)?(m===void 0&&(m=new Zo(new Nm(1,1,1),new Ml({name:"BackgroundCubeMaterial",uniforms:Kd(wa.backgroundCube.uniforms),vertexShader:wa.backgroundCube.vertexShader,fragmentShader:wa.backgroundCube.fragmentShader,side:ro,depthTest:!1,depthWrite:!1,fog:!1})),m.geometry.deleteAttribute("normal"),m.geometry.deleteAttribute("uv"),m.onBeforeRender=function(I,N,B){this.matrixWorld.copyPosition(B.matrixWorld)},Object.defineProperty(m.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),l.update(m)),m.material.uniforms.envMap.value=T,m.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,m.material.uniforms.backgroundBlurriness.value=w.backgroundBlurriness,m.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,m.material.toneMapped=T.encoding!==pr,(g!==T||x!==T.version||v!==r.toneMapping)&&(m.material.needsUpdate=!0,g=T,x=T.version,v=r.toneMapping),m.layers.enableAll(),E.unshift(m,m.geometry,m.material,0,0,null)):T&&T.isTexture&&(d===void 0&&(d=new Zo(new Tw(2,2),new Ml({name:"BackgroundMaterial",uniforms:Kd(wa.background.uniforms),vertexShader:wa.background.vertexShader,fragmentShader:wa.background.fragmentShader,side:zu,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),Object.defineProperty(d.material,"map",{get:function(){return this.uniforms.t2D.value}}),l.update(d)),d.material.uniforms.t2D.value=T,d.material.uniforms.backgroundIntensity.value=w.backgroundIntensity,d.material.toneMapped=T.encoding!==pr,T.matrixAutoUpdate===!0&&T.updateMatrix(),d.material.uniforms.uvTransform.value.copy(T.matrix),(g!==T||x!==T.version||v!==r.toneMapping)&&(d.material.needsUpdate=!0,g=T,x=T.version,v=r.toneMapping),d.layers.enableAll(),E.unshift(d,d.geometry,d.material,0,0,null))}function _(E,w){E.getRGB(Xv,fO(r)),o.buffers.color.setClear(Xv.r,Xv.g,Xv.b,w,u)}return{getClearColor:function(){return h},setClearColor:function(E,w=1){h.set(E),f=w,_(h,f)},getClearAlpha:function(){return f},setClearAlpha:function(E){f=E,_(h,f)},render:A}}function $9(r,n,i,o){const l=r.getParameter(34921),a=o.isWebGL2?null:n.get("OES_vertex_array_object"),u=o.isWebGL2||a!==null,h={},f=E(null);let d=f,m=!1;function g(O,k,z,X,Z){let ie=!1;if(u){const se=_(X,z,k);d!==se&&(d=se,v(d.object)),ie=w(O,X,z,Z),ie&&S(O,X,z,Z)}else{const se=k.wireframe===!0;(d.geometry!==X.id||d.program!==z.id||d.wireframe!==se)&&(d.geometry=X.id,d.program=z.id,d.wireframe=se,ie=!0)}Z!==null&&i.update(Z,34963),(ie||m)&&(m=!1,B(O,k,z,X),Z!==null&&r.bindBuffer(34963,i.get(Z).buffer))}function x(){return o.isWebGL2?r.createVertexArray():a.createVertexArrayOES()}function v(O){return o.isWebGL2?r.bindVertexArray(O):a.bindVertexArrayOES(O)}function A(O){return o.isWebGL2?r.deleteVertexArray(O):a.deleteVertexArrayOES(O)}function _(O,k,z){const X=z.wireframe===!0;let Z=h[O.id];Z===void 0&&(Z={},h[O.id]=Z);let ie=Z[k.id];ie===void 0&&(ie={},Z[k.id]=ie);let se=ie[X];return se===void 0&&(se=E(x()),ie[X]=se),se}function E(O){const k=[],z=[],X=[];for(let Z=0;Z<l;Z++)k[Z]=0,z[Z]=0,X[Z]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:k,enabledAttributes:z,attributeDivisors:X,object:O,attributes:{},index:null}}function w(O,k,z,X){const Z=d.attributes,ie=k.attributes;let se=0;const ue=z.getAttributes();for(const ye in ue)if(ue[ye].location>=0){const ke=Z[ye];let Oe=ie[ye];if(Oe===void 0&&(ye==="instanceMatrix"&&O.instanceMatrix&&(Oe=O.instanceMatrix),ye==="instanceColor"&&O.instanceColor&&(Oe=O.instanceColor)),ke===void 0||ke.attribute!==Oe||Oe&&ke.data!==Oe.data)return!0;se++}return d.attributesNum!==se||d.index!==X}function S(O,k,z,X){const Z={},ie=k.attributes;let se=0;const ue=z.getAttributes();for(const ye in ue)if(ue[ye].location>=0){let ke=ie[ye];ke===void 0&&(ye==="instanceMatrix"&&O.instanceMatrix&&(ke=O.instanceMatrix),ye==="instanceColor"&&O.instanceColor&&(ke=O.instanceColor));const Oe={};Oe.attribute=ke,ke&&ke.data&&(Oe.data=ke.data),Z[ye]=Oe,se++}d.attributes=Z,d.attributesNum=se,d.index=X}function T(){const O=d.newAttributes;for(let k=0,z=O.length;k<z;k++)O[k]=0}function R(O){L(O,0)}function L(O,k){const z=d.newAttributes,X=d.enabledAttributes,Z=d.attributeDivisors;z[O]=1,X[O]===0&&(r.enableVertexAttribArray(O),X[O]=1),Z[O]!==k&&((o.isWebGL2?r:n.get("ANGLE_instanced_arrays"))[o.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](O,k),Z[O]=k)}function I(){const O=d.newAttributes,k=d.enabledAttributes;for(let z=0,X=k.length;z<X;z++)k[z]!==O[z]&&(r.disableVertexAttribArray(z),k[z]=0)}function N(O,k,z,X,Z,ie){o.isWebGL2===!0&&(z===5124||z===5125)?r.vertexAttribIPointer(O,k,z,Z,ie):r.vertexAttribPointer(O,k,z,X,Z,ie)}function B(O,k,z,X){if(o.isWebGL2===!1&&(O.isInstancedMesh||X.isInstancedBufferGeometry)&&n.get("ANGLE_instanced_arrays")===null)return;T();const Z=X.attributes,ie=z.getAttributes(),se=k.defaultAttributeValues;for(const ue in ie){const ye=ie[ue];if(ye.location>=0){let Ce=Z[ue];if(Ce===void 0&&(ue==="instanceMatrix"&&O.instanceMatrix&&(Ce=O.instanceMatrix),ue==="instanceColor"&&O.instanceColor&&(Ce=O.instanceColor)),Ce!==void 0){const ke=Ce.normalized,Oe=Ce.itemSize,Ne=i.get(Ce);if(Ne===void 0)continue;const He=Ne.buffer,Qe=Ne.type,St=Ne.bytesPerElement;if(Ce.isInterleavedBufferAttribute){const bt=Ce.data,Jt=bt.stride,sn=Ce.offset;if(bt.isInstancedInterleavedBuffer){for(let Se=0;Se<ye.locationSize;Se++)L(ye.location+Se,bt.meshPerAttribute);O.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=bt.meshPerAttribute*bt.count)}else for(let Se=0;Se<ye.locationSize;Se++)R(ye.location+Se);r.bindBuffer(34962,He);for(let Se=0;Se<ye.locationSize;Se++)N(ye.location+Se,Oe/ye.locationSize,Qe,ke,Jt*St,(sn+Oe/ye.locationSize*Se)*St)}else{if(Ce.isInstancedBufferAttribute){for(let bt=0;bt<ye.locationSize;bt++)L(ye.location+bt,Ce.meshPerAttribute);O.isInstancedMesh!==!0&&X._maxInstanceCount===void 0&&(X._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let bt=0;bt<ye.locationSize;bt++)R(ye.location+bt);r.bindBuffer(34962,He);for(let bt=0;bt<ye.locationSize;bt++)N(ye.location+bt,Oe/ye.locationSize,Qe,ke,Oe*St,Oe/ye.locationSize*bt*St)}}else if(se!==void 0){const ke=se[ue];if(ke!==void 0)switch(ke.length){case 2:r.vertexAttrib2fv(ye.location,ke);break;case 3:r.vertexAttrib3fv(ye.location,ke);break;case 4:r.vertexAttrib4fv(ye.location,ke);break;default:r.vertexAttrib1fv(ye.location,ke)}}}}I()}function H(){ne();for(const O in h){const k=h[O];for(const z in k){const X=k[z];for(const Z in X)A(X[Z].object),delete X[Z];delete k[z]}delete h[O]}}function q(O){if(h[O.id]===void 0)return;const k=h[O.id];for(const z in k){const X=k[z];for(const Z in X)A(X[Z].object),delete X[Z];delete k[z]}delete h[O.id]}function le(O){for(const k in h){const z=h[k];if(z[O.id]===void 0)continue;const X=z[O.id];for(const Z in X)A(X[Z].object),delete X[Z];delete z[O.id]}}function ne(){D(),m=!0,d!==f&&(d=f,v(d.object))}function D(){f.geometry=null,f.program=null,f.wireframe=!1}return{setup:g,reset:ne,resetDefaultState:D,dispose:H,releaseStatesOfGeometry:q,releaseStatesOfProgram:le,initAttributes:T,enableAttribute:R,disableUnusedAttributes:I}}function X9(r,n,i,o){const l=o.isWebGL2;let a;function u(d){a=d}function h(d,m){r.drawArrays(a,d,m),i.update(m,a,1)}function f(d,m,g){if(g===0)return;let x,v;if(l)x=r,v="drawArraysInstanced";else if(x=n.get("ANGLE_instanced_arrays"),v="drawArraysInstancedANGLE",x===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[v](a,d,m,g),i.update(m,a,g)}this.setMode=u,this.render=h,this.renderInstances=f}function q9(r,n,i){let o;function l(){if(o!==void 0)return o;if(n.has("EXT_texture_filter_anisotropic")===!0){const N=n.get("EXT_texture_filter_anisotropic");o=r.getParameter(N.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else o=0;return o}function a(N){if(N==="highp"){if(r.getShaderPrecisionFormat(35633,36338).precision>0&&r.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";N="mediump"}return N==="mediump"&&r.getShaderPrecisionFormat(35633,36337).precision>0&&r.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const u=typeof WebGL2RenderingContext<"u"&&r instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&r instanceof WebGL2ComputeRenderingContext;let h=i.precision!==void 0?i.precision:"highp";const f=a(h);f!==h&&(console.warn("THREE.WebGLRenderer:",h,"not supported, using",f,"instead."),h=f);const d=u||n.has("WEBGL_draw_buffers"),m=i.logarithmicDepthBuffer===!0,g=r.getParameter(34930),x=r.getParameter(35660),v=r.getParameter(3379),A=r.getParameter(34076),_=r.getParameter(34921),E=r.getParameter(36347),w=r.getParameter(36348),S=r.getParameter(36349),T=x>0,R=u||n.has("OES_texture_float"),L=T&&R,I=u?r.getParameter(36183):0;return{isWebGL2:u,drawBuffers:d,getMaxAnisotropy:l,getMaxPrecision:a,precision:h,logarithmicDepthBuffer:m,maxTextures:g,maxVertexTextures:x,maxTextureSize:v,maxCubemapSize:A,maxAttributes:_,maxVertexUniforms:E,maxVaryings:w,maxFragmentUniforms:S,vertexTextures:T,floatFragmentTextures:R,floatVertexTextures:L,maxSamples:I}}function Y9(r){const n=this;let i=null,o=0,l=!1,a=!1;const u=new cc,h=new no,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(g,x,v){const A=g.length!==0||x||o!==0||l;return l=x,i=m(g,v,0),o=g.length,A},this.beginShadows=function(){a=!0,m(null)},this.endShadows=function(){a=!1,d()},this.setState=function(g,x,v){const A=g.clippingPlanes,_=g.clipIntersection,E=g.clipShadows,w=r.get(g);if(!l||A===null||A.length===0||a&&!E)a?m(null):d();else{const S=a?0:o,T=S*4;let R=w.clippingState||null;f.value=R,R=m(A,x,T,v);for(let L=0;L!==T;++L)R[L]=i[L];w.clippingState=R,this.numIntersection=_?this.numPlanes:0,this.numPlanes+=S}};function d(){f.value!==i&&(f.value=i,f.needsUpdate=o>0),n.numPlanes=o,n.numIntersection=0}function m(g,x,v,A){const _=g!==null?g.length:0;let E=null;if(_!==0){if(E=f.value,A!==!0||E===null){const w=v+_*4,S=x.matrixWorldInverse;h.getNormalMatrix(S),(E===null||E.length<w)&&(E=new Float32Array(w));for(let T=0,R=v;T!==_;++T,R+=4)u.copy(g[T]).applyMatrix4(S,h),u.normal.toArray(E,R),E[R+3]=u.constant}f.value=E,f.needsUpdate=!0}return n.numPlanes=_,n.numIntersection=0,E}}function K9(r){let n=new WeakMap;function i(u,h){return h===kE?u.mapping=Xd:h===NE&&(u.mapping=qd),u}function o(u){if(u&&u.isTexture&&u.isRenderTargetTexture===!1){const h=u.mapping;if(h===kE||h===NE)if(n.has(u)){const f=n.get(u).texture;return i(f,u.mapping)}else{const f=u.image;if(f&&f.height>0){const d=new cV(f.height/2);return d.fromEquirectangularTexture(r,u),n.set(u,d),u.addEventListener("dispose",l),i(d.texture,u.mapping)}else return null}}return u}function l(u){const h=u.target;h.removeEventListener("dispose",l);const f=n.get(h);f!==void 0&&(n.delete(h),f.dispose())}function a(){n=new WeakMap}return{get:o,dispose:a}}class Cw extends mO{constructor(n=-1,i=1,o=1,l=-1,a=.1,u=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=n,this.right=i,this.top=o,this.bottom=l,this.near=a,this.far=u,this.updateProjectionMatrix()}copy(n,i){return super.copy(n,i),this.left=n.left,this.right=n.right,this.top=n.top,this.bottom=n.bottom,this.near=n.near,this.far=n.far,this.zoom=n.zoom,this.view=n.view===null?null:Object.assign({},n.view),this}setViewOffset(n,i,o,l,a,u){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=i,this.view.offsetX=o,this.view.offsetY=l,this.view.width=a,this.view.height=u,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),o=(this.right+this.left)/2,l=(this.top+this.bottom)/2;let a=o-n,u=o+n,h=l+i,f=l-i;if(this.view!==null&&this.view.enabled){const d=(this.right-this.left)/this.view.fullWidth/this.zoom,m=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=d*this.view.offsetX,u=a+d*this.view.width,h-=m*this.view.offsetY,f=h-m*this.view.height}this.projectionMatrix.makeOrthographic(a,u,h,f,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const i=super.toJSON(n);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,this.view!==null&&(i.object.view=Object.assign({},this.view)),i}}const Md=4,f3=[.125,.215,.35,.446,.526,.582],yu=20,qb=new Cw,p3=new Ji;let Yb=null;const vu=(1+Math.sqrt(5))/2,nd=1/vu,m3=[new it(1,1,1),new it(-1,1,1),new it(1,1,-1),new it(-1,1,-1),new it(0,vu,nd),new it(0,vu,-nd),new it(nd,0,vu),new it(-nd,0,vu),new it(vu,nd,0),new it(-vu,nd,0)];class g3{constructor(n){this._renderer=n,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(n,i=0,o=.1,l=100){Yb=this._renderer.getRenderTarget(),this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(n,o,l,a),i>0&&this._blur(a,0,0,i),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(n,i=null){return this._fromTexture(n,i)}fromCubemap(n,i=null){return this._fromTexture(n,i)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=x3(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=y3(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(n){this._lodMax=Math.floor(Math.log2(n)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let n=0;n<this._lodPlanes.length;n++)this._lodPlanes[n].dispose()}_cleanup(n){this._renderer.setRenderTarget(Yb),n.scissorTest=!1,qv(n,0,0,n.width,n.height)}_fromTexture(n,i){n.mapping===Xd||n.mapping===qd?this._setSize(n.image.length===0?16:n.image[0].width||n.image[0].image.width):this._setSize(n.image.width/4),Yb=this._renderer.getRenderTarget();const o=i||this._allocateTargets();return this._textureToCubeUV(n,o),this._applyPMREM(o),this._cleanup(o),o}_allocateTargets(){const n=3*Math.max(this._cubeSize,112),i=4*this._cubeSize,o={magFilter:xo,minFilter:xo,generateMipmaps:!1,type:ym,format:Yo,encoding:Gu,depthBuffer:!1},l=v3(n,i,o);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=v3(n,i,o);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=Q9(a)),this._blurMaterial=Z9(a,n,i)}return l}_compileMaterial(n){const i=new Zo(this._lodPlanes[0],n);this._renderer.compile(i,qb)}_sceneToCubeUV(n,i,o,l){const h=new _o(90,1,i,o),f=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],m=this._renderer,g=m.autoClear,x=m.toneMapping;m.getClearColor(p3),m.toneMapping=gl,m.autoClear=!1;const v=new Mw({name:"PMREM.Background",side:ro,depthWrite:!1,depthTest:!1}),A=new Zo(new Nm,v);let _=!1;const E=n.background;E?E.isColor&&(v.color.copy(E),n.background=null,_=!0):(v.color.copy(p3),_=!0);for(let w=0;w<6;w++){const S=w%3;S===0?(h.up.set(0,f[w],0),h.lookAt(d[w],0,0)):S===1?(h.up.set(0,0,f[w]),h.lookAt(0,d[w],0)):(h.up.set(0,f[w],0),h.lookAt(0,0,d[w]));const T=this._cubeSize;qv(l,S*T,w>2?T:0,T,T),m.setRenderTarget(l),_&&m.render(A,h),m.render(n,h)}A.geometry.dispose(),A.material.dispose(),m.toneMapping=x,m.autoClear=g,n.background=E}_textureToCubeUV(n,i){const o=this._renderer,l=n.mapping===Xd||n.mapping===qd;l?(this._cubemapMaterial===null&&(this._cubemapMaterial=x3()),this._cubemapMaterial.uniforms.flipEnvMap.value=n.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=y3());const a=l?this._cubemapMaterial:this._equirectMaterial,u=new Zo(this._lodPlanes[0],a),h=a.uniforms;h.envMap.value=n;const f=this._cubeSize;qv(i,0,0,3*f,2*f),o.setRenderTarget(i),o.render(u,qb)}_applyPMREM(n){const i=this._renderer,o=i.autoClear;i.autoClear=!1;for(let l=1;l<this._lodPlanes.length;l++){const a=Math.sqrt(this._sigmas[l]*this._sigmas[l]-this._sigmas[l-1]*this._sigmas[l-1]),u=m3[(l-1)%m3.length];this._blur(n,l-1,l,a,u)}i.autoClear=o}_blur(n,i,o,l,a){const u=this._pingPongRenderTarget;this._halfBlur(n,u,i,o,l,"latitudinal",a),this._halfBlur(u,n,o,o,l,"longitudinal",a)}_halfBlur(n,i,o,l,a,u,h){const f=this._renderer,d=this._blurMaterial;u!=="latitudinal"&&u!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const m=3,g=new Zo(this._lodPlanes[l],d),x=d.uniforms,v=this._sizeLods[o]-1,A=isFinite(a)?Math.PI/(2*v):2*Math.PI/(2*yu-1),_=a/A,E=isFinite(a)?1+Math.floor(m*_):yu;E>yu&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${yu}`);const w=[];let S=0;for(let N=0;N<yu;++N){const B=N/_,H=Math.exp(-B*B/2);w.push(H),N===0?S+=H:N<E&&(S+=2*H)}for(let N=0;N<w.length;N++)w[N]=w[N]/S;x.envMap.value=n.texture,x.samples.value=E,x.weights.value=w,x.latitudinal.value=u==="latitudinal",h&&(x.poleAxis.value=h);const{_lodMax:T}=this;x.dTheta.value=A,x.mipInt.value=T-o;const R=this._sizeLods[l],L=3*R*(l>T-Md?l-T+Md:0),I=4*(this._cubeSize-R);qv(i,L,I,3*R,2*R),f.setRenderTarget(i),f.render(g,qb)}}function Q9(r){const n=[],i=[],o=[];let l=r;const a=r-Md+1+f3.length;for(let u=0;u<a;u++){const h=Math.pow(2,l);i.push(h);let f=1/h;u>r-Md?f=f3[u-r+Md-1]:u===0&&(f=0),o.push(f);const d=1/(h-2),m=-d,g=1+d,x=[m,m,g,m,g,g,m,m,g,g,m,g],v=6,A=6,_=3,E=2,w=1,S=new Float32Array(_*A*v),T=new Float32Array(E*A*v),R=new Float32Array(w*A*v);for(let I=0;I<v;I++){const N=I%3*2/3-1,B=I>2?0:-1,H=[N,B,0,N+2/3,B,0,N+2/3,B+1,0,N,B,0,N+2/3,B+1,0,N,B+1,0];S.set(H,_*A*I),T.set(x,E*A*I);const q=[I,I,I,I,I,I];R.set(q,w*A*I)}const L=new ho;L.setAttribute("position",new ta(S,_)),L.setAttribute("uv",new ta(T,E)),L.setAttribute("faceIndex",new ta(R,w)),n.push(L),l>Md&&l--}return{lodPlanes:n,sizeLods:i,sigmas:o}}function v3(r,n,i){const o=new Tc(r,n,i);return o.texture.mapping=Wy,o.texture.name="PMREM.cubeUv",o.scissorTest=!0,o}function qv(r,n,i,o,l){r.viewport.set(n,i,o,l),r.scissor.set(n,i,o,l)}function Z9(r,n,i){const o=new Float32Array(yu),l=new it(0,1,0);return new Ml({name:"SphericalGaussianBlur",defines:{n:yu,CUBEUV_TEXEL_WIDTH:1/n,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:o},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:l}},vertexShader:Rw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:wc,depthTest:!1,depthWrite:!1})}function y3(){return new Ml({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:Rw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:wc,depthTest:!1,depthWrite:!1})}function x3(){return new Ml({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:Rw(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:wc,depthTest:!1,depthWrite:!1})}function Rw(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function J9(r){let n=new WeakMap,i=null;function o(h){if(h&&h.isTexture){const f=h.mapping,d=f===kE||f===NE,m=f===Xd||f===qd;if(d||m)if(h.isRenderTargetTexture&&h.needsPMREMUpdate===!0){h.needsPMREMUpdate=!1;let g=n.get(h);return i===null&&(i=new g3(r)),g=d?i.fromEquirectangular(h,g):i.fromCubemap(h,g),n.set(h,g),g.texture}else{if(n.has(h))return n.get(h).texture;{const g=h.image;if(d&&g&&g.height>0||m&&g&&l(g)){i===null&&(i=new g3(r));const x=d?i.fromEquirectangular(h):i.fromCubemap(h);return n.set(h,x),h.addEventListener("dispose",a),x.texture}else return null}}}return h}function l(h){let f=0;const d=6;for(let m=0;m<d;m++)h[m]!==void 0&&f++;return f===d}function a(h){const f=h.target;f.removeEventListener("dispose",a);const d=n.get(f);d!==void 0&&(n.delete(f),d.dispose())}function u(){n=new WeakMap,i!==null&&(i.dispose(),i=null)}return{get:o,dispose:u}}function eW(r){const n={};function i(o){if(n[o]!==void 0)return n[o];let l;switch(o){case"WEBGL_depth_texture":l=r.getExtension("WEBGL_depth_texture")||r.getExtension("MOZ_WEBGL_depth_texture")||r.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":l=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":l=r.getExtension("WEBGL_compressed_texture_s3tc")||r.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":l=r.getExtension("WEBGL_compressed_texture_pvrtc")||r.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:l=r.getExtension(o)}return n[o]=l,l}return{has:function(o){return i(o)!==null},init:function(o){o.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(o){const l=i(o);return l===null&&console.warn("THREE.WebGLRenderer: "+o+" extension not supported."),l}}}function tW(r,n,i,o){const l={},a=new WeakMap;function u(g){const x=g.target;x.index!==null&&n.remove(x.index);for(const A in x.attributes)n.remove(x.attributes[A]);x.removeEventListener("dispose",u),delete l[x.id];const v=a.get(x);v&&(n.remove(v),a.delete(x)),o.releaseStatesOfGeometry(x),x.isInstancedBufferGeometry===!0&&delete x._maxInstanceCount,i.memory.geometries--}function h(g,x){return l[x.id]===!0||(x.addEventListener("dispose",u),l[x.id]=!0,i.memory.geometries++),x}function f(g){const x=g.attributes;for(const A in x)n.update(x[A],34962);const v=g.morphAttributes;for(const A in v){const _=v[A];for(let E=0,w=_.length;E<w;E++)n.update(_[E],34962)}}function d(g){const x=[],v=g.index,A=g.attributes.position;let _=0;if(v!==null){const S=v.array;_=v.version;for(let T=0,R=S.length;T<R;T+=3){const L=S[T+0],I=S[T+1],N=S[T+2];x.push(L,I,I,N,N,L)}}else{const S=A.array;_=A.version;for(let T=0,R=S.length/3-1;T<R;T+=3){const L=T+0,I=T+1,N=T+2;x.push(L,I,I,N,N,L)}}const E=new(oO(x)?dO:hO)(x,1);E.version=_;const w=a.get(g);w&&n.remove(w),a.set(g,E)}function m(g){const x=a.get(g);if(x){const v=g.index;v!==null&&x.version<v.version&&d(g)}else d(g);return a.get(g)}return{get:h,update:f,getWireframeAttribute:m}}function nW(r,n,i,o){const l=o.isWebGL2;let a;function u(x){a=x}let h,f;function d(x){h=x.type,f=x.bytesPerElement}function m(x,v){r.drawElements(a,v,h,x*f),i.update(v,a,1)}function g(x,v,A){if(A===0)return;let _,E;if(l)_=r,E="drawElementsInstanced";else if(_=n.get("ANGLE_instanced_arrays"),E="drawElementsInstancedANGLE",_===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}_[E](a,v,h,x*f,A),i.update(v,a,A)}this.setMode=u,this.setIndex=d,this.render=m,this.renderInstances=g}function iW(r){const n={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};function o(a,u,h){switch(i.calls++,u){case 4:i.triangles+=h*(a/3);break;case 1:i.lines+=h*(a/2);break;case 3:i.lines+=h*(a-1);break;case 2:i.lines+=h*a;break;case 0:i.points+=h*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",u);break}}function l(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}return{memory:n,render:i,programs:null,autoReset:!0,reset:l,update:o}}function rW(r,n){return r[0]-n[0]}function sW(r,n){return Math.abs(n[1])-Math.abs(r[1])}function oW(r,n,i){const o={},l=new Float32Array(8),a=new WeakMap,u=new ts,h=[];for(let d=0;d<8;d++)h[d]=[d,0];function f(d,m,g,x){const v=d.morphTargetInfluences;if(n.isWebGL2===!0){const _=m.morphAttributes.position||m.morphAttributes.normal||m.morphAttributes.color,E=_!==void 0?_.length:0;let w=a.get(m);if(w===void 0||w.count!==E){let z=function(){O.dispose(),a.delete(m),m.removeEventListener("dispose",z)};var A=z;w!==void 0&&w.texture.dispose();const R=m.morphAttributes.position!==void 0,L=m.morphAttributes.normal!==void 0,I=m.morphAttributes.color!==void 0,N=m.morphAttributes.position||[],B=m.morphAttributes.normal||[],H=m.morphAttributes.color||[];let q=0;R===!0&&(q=1),L===!0&&(q=2),I===!0&&(q=3);let le=m.attributes.position.count*q,ne=1;le>n.maxTextureSize&&(ne=Math.ceil(le/n.maxTextureSize),le=n.maxTextureSize);const D=new Float32Array(le*ne*4*E),O=new uO(D,le,ne,E);O.type=wu,O.needsUpdate=!0;const k=q*4;for(let X=0;X<E;X++){const Z=N[X],ie=B[X],se=H[X],ue=le*ne*4*X;for(let ye=0;ye<Z.count;ye++){const Ce=ye*k;R===!0&&(u.fromBufferAttribute(Z,ye),D[ue+Ce+0]=u.x,D[ue+Ce+1]=u.y,D[ue+Ce+2]=u.z,D[ue+Ce+3]=0),L===!0&&(u.fromBufferAttribute(ie,ye),D[ue+Ce+4]=u.x,D[ue+Ce+5]=u.y,D[ue+Ce+6]=u.z,D[ue+Ce+7]=0),I===!0&&(u.fromBufferAttribute(se,ye),D[ue+Ce+8]=u.x,D[ue+Ce+9]=u.y,D[ue+Ce+10]=u.z,D[ue+Ce+11]=se.itemSize===4?u.w:1)}}w={count:E,texture:O,size:new Rn(le,ne)},a.set(m,w),m.addEventListener("dispose",z)}let S=0;for(let R=0;R<v.length;R++)S+=v[R];const T=m.morphTargetsRelative?1:1-S;x.getUniforms().setValue(r,"morphTargetBaseInfluence",T),x.getUniforms().setValue(r,"morphTargetInfluences",v),x.getUniforms().setValue(r,"morphTargetsTexture",w.texture,i),x.getUniforms().setValue(r,"morphTargetsTextureSize",w.size)}else{const _=v===void 0?0:v.length;let E=o[m.id];if(E===void 0||E.length!==_){E=[];for(let L=0;L<_;L++)E[L]=[L,0];o[m.id]=E}for(let L=0;L<_;L++){const I=E[L];I[0]=L,I[1]=v[L]}E.sort(sW);for(let L=0;L<8;L++)L<_&&E[L][1]?(h[L][0]=E[L][0],h[L][1]=E[L][1]):(h[L][0]=Number.MAX_SAFE_INTEGER,h[L][1]=0);h.sort(rW);const w=m.morphAttributes.position,S=m.morphAttributes.normal;let T=0;for(let L=0;L<8;L++){const I=h[L],N=I[0],B=I[1];N!==Number.MAX_SAFE_INTEGER&&B?(w&&m.getAttribute("morphTarget"+L)!==w[N]&&m.setAttribute("morphTarget"+L,w[N]),S&&m.getAttribute("morphNormal"+L)!==S[N]&&m.setAttribute("morphNormal"+L,S[N]),l[L]=B,T+=B):(w&&m.hasAttribute("morphTarget"+L)===!0&&m.deleteAttribute("morphTarget"+L),S&&m.hasAttribute("morphNormal"+L)===!0&&m.deleteAttribute("morphNormal"+L),l[L]=0)}const R=m.morphTargetsRelative?1:1-T;x.getUniforms().setValue(r,"morphTargetBaseInfluence",R),x.getUniforms().setValue(r,"morphTargetInfluences",l)}}return{update:f}}function aW(r,n,i,o){let l=new WeakMap;function a(f){const d=o.render.frame,m=f.geometry,g=n.get(f,m);return l.get(g)!==d&&(n.update(g),l.set(g,d)),f.isInstancedMesh&&(f.hasEventListener("dispose",h)===!1&&f.addEventListener("dispose",h),i.update(f.instanceMatrix,34962),f.instanceColor!==null&&i.update(f.instanceColor,34962)),g}function u(){l=new WeakMap}function h(f){const d=f.target;d.removeEventListener("dispose",h),i.remove(d.instanceMatrix),d.instanceColor!==null&&i.remove(d.instanceColor)}return{update:a,dispose:u}}const yO=new Gs,xO=new uO,_O=new qG,bO=new gO,_3=[],b3=[],E3=new Float32Array(16),A3=new Float32Array(9),w3=new Float32Array(4);function hf(r,n,i){const o=r[0];if(o<=0||o>0)return r;const l=n*i;let a=_3[l];if(a===void 0&&(a=new Float32Array(l),_3[l]=a),n!==0){o.toArray(a,0);for(let u=1,h=0;u!==n;++u)h+=i,r[u].toArray(a,h)}return a}function Xr(r,n){if(r.length!==n.length)return!1;for(let i=0,o=r.length;i<o;i++)if(r[i]!==n[i])return!1;return!0}function qr(r,n){for(let i=0,o=n.length;i<o;i++)r[i]=n[i]}function $y(r,n){let i=b3[n];i===void 0&&(i=new Int32Array(n),b3[n]=i);for(let o=0;o!==n;++o)i[o]=r.allocateTextureUnit();return i}function lW(r,n){const i=this.cache;i[0]!==n&&(r.uniform1f(this.addr,n),i[0]=n)}function cW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y)&&(r.uniform2f(this.addr,n.x,n.y),i[0]=n.x,i[1]=n.y);else{if(Xr(i,n))return;r.uniform2fv(this.addr,n),qr(i,n)}}function uW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y||i[2]!==n.z)&&(r.uniform3f(this.addr,n.x,n.y,n.z),i[0]=n.x,i[1]=n.y,i[2]=n.z);else if(n.r!==void 0)(i[0]!==n.r||i[1]!==n.g||i[2]!==n.b)&&(r.uniform3f(this.addr,n.r,n.g,n.b),i[0]=n.r,i[1]=n.g,i[2]=n.b);else{if(Xr(i,n))return;r.uniform3fv(this.addr,n),qr(i,n)}}function hW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y||i[2]!==n.z||i[3]!==n.w)&&(r.uniform4f(this.addr,n.x,n.y,n.z,n.w),i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=n.w);else{if(Xr(i,n))return;r.uniform4fv(this.addr,n),qr(i,n)}}function dW(r,n){const i=this.cache,o=n.elements;if(o===void 0){if(Xr(i,n))return;r.uniformMatrix2fv(this.addr,!1,n),qr(i,n)}else{if(Xr(i,o))return;w3.set(o),r.uniformMatrix2fv(this.addr,!1,w3),qr(i,o)}}function fW(r,n){const i=this.cache,o=n.elements;if(o===void 0){if(Xr(i,n))return;r.uniformMatrix3fv(this.addr,!1,n),qr(i,n)}else{if(Xr(i,o))return;A3.set(o),r.uniformMatrix3fv(this.addr,!1,A3),qr(i,o)}}function pW(r,n){const i=this.cache,o=n.elements;if(o===void 0){if(Xr(i,n))return;r.uniformMatrix4fv(this.addr,!1,n),qr(i,n)}else{if(Xr(i,o))return;E3.set(o),r.uniformMatrix4fv(this.addr,!1,E3),qr(i,o)}}function mW(r,n){const i=this.cache;i[0]!==n&&(r.uniform1i(this.addr,n),i[0]=n)}function gW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y)&&(r.uniform2i(this.addr,n.x,n.y),i[0]=n.x,i[1]=n.y);else{if(Xr(i,n))return;r.uniform2iv(this.addr,n),qr(i,n)}}function vW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y||i[2]!==n.z)&&(r.uniform3i(this.addr,n.x,n.y,n.z),i[0]=n.x,i[1]=n.y,i[2]=n.z);else{if(Xr(i,n))return;r.uniform3iv(this.addr,n),qr(i,n)}}function yW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y||i[2]!==n.z||i[3]!==n.w)&&(r.uniform4i(this.addr,n.x,n.y,n.z,n.w),i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=n.w);else{if(Xr(i,n))return;r.uniform4iv(this.addr,n),qr(i,n)}}function xW(r,n){const i=this.cache;i[0]!==n&&(r.uniform1ui(this.addr,n),i[0]=n)}function _W(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y)&&(r.uniform2ui(this.addr,n.x,n.y),i[0]=n.x,i[1]=n.y);else{if(Xr(i,n))return;r.uniform2uiv(this.addr,n),qr(i,n)}}function bW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y||i[2]!==n.z)&&(r.uniform3ui(this.addr,n.x,n.y,n.z),i[0]=n.x,i[1]=n.y,i[2]=n.z);else{if(Xr(i,n))return;r.uniform3uiv(this.addr,n),qr(i,n)}}function EW(r,n){const i=this.cache;if(n.x!==void 0)(i[0]!==n.x||i[1]!==n.y||i[2]!==n.z||i[3]!==n.w)&&(r.uniform4ui(this.addr,n.x,n.y,n.z,n.w),i[0]=n.x,i[1]=n.y,i[2]=n.z,i[3]=n.w);else{if(Xr(i,n))return;r.uniform4uiv(this.addr,n),qr(i,n)}}function AW(r,n,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(r.uniform1i(this.addr,l),o[0]=l),i.setTexture2D(n||yO,l)}function wW(r,n,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(r.uniform1i(this.addr,l),o[0]=l),i.setTexture3D(n||_O,l)}function MW(r,n,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(r.uniform1i(this.addr,l),o[0]=l),i.setTextureCube(n||bO,l)}function SW(r,n,i){const o=this.cache,l=i.allocateTextureUnit();o[0]!==l&&(r.uniform1i(this.addr,l),o[0]=l),i.setTexture2DArray(n||xO,l)}function TW(r){switch(r){case 5126:return lW;case 35664:return cW;case 35665:return uW;case 35666:return hW;case 35674:return dW;case 35675:return fW;case 35676:return pW;case 5124:case 35670:return mW;case 35667:case 35671:return gW;case 35668:case 35672:return vW;case 35669:case 35673:return yW;case 5125:return xW;case 36294:return _W;case 36295:return bW;case 36296:return EW;case 35678:case 36198:case 36298:case 36306:case 35682:return AW;case 35679:case 36299:case 36307:return wW;case 35680:case 36300:case 36308:case 36293:return MW;case 36289:case 36303:case 36311:case 36292:return SW}}function CW(r,n){r.uniform1fv(this.addr,n)}function RW(r,n){const i=hf(n,this.size,2);r.uniform2fv(this.addr,i)}function LW(r,n){const i=hf(n,this.size,3);r.uniform3fv(this.addr,i)}function PW(r,n){const i=hf(n,this.size,4);r.uniform4fv(this.addr,i)}function DW(r,n){const i=hf(n,this.size,4);r.uniformMatrix2fv(this.addr,!1,i)}function OW(r,n){const i=hf(n,this.size,9);r.uniformMatrix3fv(this.addr,!1,i)}function IW(r,n){const i=hf(n,this.size,16);r.uniformMatrix4fv(this.addr,!1,i)}function kW(r,n){r.uniform1iv(this.addr,n)}function NW(r,n){r.uniform2iv(this.addr,n)}function FW(r,n){r.uniform3iv(this.addr,n)}function BW(r,n){r.uniform4iv(this.addr,n)}function UW(r,n){r.uniform1uiv(this.addr,n)}function zW(r,n){r.uniform2uiv(this.addr,n)}function HW(r,n){r.uniform3uiv(this.addr,n)}function GW(r,n){r.uniform4uiv(this.addr,n)}function VW(r,n,i){const o=this.cache,l=n.length,a=$y(i,l);Xr(o,a)||(r.uniform1iv(this.addr,a),qr(o,a));for(let u=0;u!==l;++u)i.setTexture2D(n[u]||yO,a[u])}function WW(r,n,i){const o=this.cache,l=n.length,a=$y(i,l);Xr(o,a)||(r.uniform1iv(this.addr,a),qr(o,a));for(let u=0;u!==l;++u)i.setTexture3D(n[u]||_O,a[u])}function jW(r,n,i){const o=this.cache,l=n.length,a=$y(i,l);Xr(o,a)||(r.uniform1iv(this.addr,a),qr(o,a));for(let u=0;u!==l;++u)i.setTextureCube(n[u]||bO,a[u])}function $W(r,n,i){const o=this.cache,l=n.length,a=$y(i,l);Xr(o,a)||(r.uniform1iv(this.addr,a),qr(o,a));for(let u=0;u!==l;++u)i.setTexture2DArray(n[u]||xO,a[u])}function XW(r){switch(r){case 5126:return CW;case 35664:return RW;case 35665:return LW;case 35666:return PW;case 35674:return DW;case 35675:return OW;case 35676:return IW;case 5124:case 35670:return kW;case 35667:case 35671:return NW;case 35668:case 35672:return FW;case 35669:case 35673:return BW;case 5125:return UW;case 36294:return zW;case 36295:return HW;case 36296:return GW;case 35678:case 36198:case 36298:case 36306:case 35682:return VW;case 35679:case 36299:case 36307:return WW;case 35680:case 36300:case 36308:case 36293:return jW;case 36289:case 36303:case 36311:case 36292:return $W}}class qW{constructor(n,i,o){this.id=n,this.addr=o,this.cache=[],this.setValue=TW(i.type)}}class YW{constructor(n,i,o){this.id=n,this.addr=o,this.cache=[],this.size=i.size,this.setValue=XW(i.type)}}class KW{constructor(n){this.id=n,this.seq=[],this.map={}}setValue(n,i,o){const l=this.seq;for(let a=0,u=l.length;a!==u;++a){const h=l[a];h.setValue(n,i[h.id],o)}}}const Kb=/(\w+)(\])?(\[|\.)?/g;function M3(r,n){r.seq.push(n),r.map[n.id]=n}function QW(r,n,i){const o=r.name,l=o.length;for(Kb.lastIndex=0;;){const a=Kb.exec(o),u=Kb.lastIndex;let h=a[1];const f=a[2]==="]",d=a[3];if(f&&(h=h|0),d===void 0||d==="["&&u+2===l){M3(i,d===void 0?new qW(h,r,n):new YW(h,r,n));break}else{let g=i.map[h];g===void 0&&(g=new KW(h),M3(i,g)),i=g}}}class P0{constructor(n,i){this.seq=[],this.map={};const o=n.getProgramParameter(i,35718);for(let l=0;l<o;++l){const a=n.getActiveUniform(i,l),u=n.getUniformLocation(i,a.name);QW(a,u,this)}}setValue(n,i,o,l){const a=this.map[i];a!==void 0&&a.setValue(n,o,l)}setOptional(n,i,o){const l=i[o];l!==void 0&&this.setValue(n,o,l)}static upload(n,i,o,l){for(let a=0,u=i.length;a!==u;++a){const h=i[a],f=o[h.id];f.needsUpdate!==!1&&h.setValue(n,f.value,l)}}static seqWithValue(n,i){const o=[];for(let l=0,a=n.length;l!==a;++l){const u=n[l];u.id in i&&o.push(u)}return o}}function S3(r,n,i){const o=r.createShader(n);return r.shaderSource(o,i),r.compileShader(o),o}let ZW=0;function JW(r,n){const i=r.split(`
`),o=[],l=Math.max(n-6,0),a=Math.min(n+6,i.length);for(let u=l;u<a;u++){const h=u+1;o.push(`${h===n?">":" "} ${h}: ${i[u]}`)}return o.join(`
`)}function ej(r){switch(r){case Gu:return["Linear","( value )"];case pr:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",r),["Linear","( value )"]}}function T3(r,n,i){const o=r.getShaderParameter(n,35713),l=r.getShaderInfoLog(n).trim();if(o&&l==="")return"";const a=/ERROR: 0:(\d+)/.exec(l);if(a){const u=parseInt(a[1]);return i.toUpperCase()+`

`+l+`

`+JW(r.getShaderSource(n),u)}else return l}function tj(r,n){const i=ej(n);return"vec4 "+r+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}function nj(r,n){let i;switch(n){case bG:i="Linear";break;case EG:i="Reinhard";break;case AG:i="OptimizedCineon";break;case wG:i="ACESFilmic";break;case MG:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",n),i="Linear"}return"vec3 "+r+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}function ij(r){return[r.extensionDerivatives||!!r.envMapCubeUVHeight||r.bumpMap||r.tangentSpaceNormalMap||r.clearcoatNormalMap||r.flatShading||r.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(r.extensionFragDepth||r.logarithmicDepthBuffer)&&r.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",r.extensionDrawBuffers&&r.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(r.extensionShaderTextureLOD||r.envMap||r.transmission)&&r.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Dp).join(`
`)}function rj(r){const n=[];for(const i in r){const o=r[i];o!==!1&&n.push("#define "+i+" "+o)}return n.join(`
`)}function sj(r,n){const i={},o=r.getProgramParameter(n,35721);for(let l=0;l<o;l++){const a=r.getActiveAttrib(n,l),u=a.name;let h=1;a.type===35674&&(h=2),a.type===35675&&(h=3),a.type===35676&&(h=4),i[u]={type:a.type,location:r.getAttribLocation(n,u),locationSize:h}}return i}function Dp(r){return r!==""}function C3(r,n){const i=n.numSpotLightShadows+n.numSpotLightMaps-n.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,n.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,n.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function R3(r,n){return r.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}const oj=/^[ \t]*#include +<([\w\d./]+)>/gm;function HE(r){return r.replace(oj,aj)}function aj(r,n){const i=Li[n];if(i===void 0)throw new Error("Can not resolve #include <"+n+">");return HE(i)}const lj=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function L3(r){return r.replace(lj,cj)}function cj(r,n,i,o){let l="";for(let a=parseInt(n);a<parseInt(i);a++)l+=o.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return l}function P3(r){let n="precision "+r.precision+` float;
precision `+r.precision+" int;";return r.precision==="highp"?n+=`
#define HIGH_PRECISION`:r.precision==="mediump"?n+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(n+=`
#define LOW_PRECISION`),n}function uj(r){let n="SHADOWMAP_TYPE_BASIC";return r.shadowMapType===eO?n="SHADOWMAP_TYPE_PCF":r.shadowMapType===JH?n="SHADOWMAP_TYPE_PCF_SOFT":r.shadowMapType===Pp&&(n="SHADOWMAP_TYPE_VSM"),n}function hj(r){let n="ENVMAP_TYPE_CUBE";if(r.envMap)switch(r.envMapMode){case Xd:case qd:n="ENVMAP_TYPE_CUBE";break;case Wy:n="ENVMAP_TYPE_CUBE_UV";break}return n}function dj(r){let n="ENVMAP_MODE_REFLECTION";if(r.envMap)switch(r.envMapMode){case qd:n="ENVMAP_MODE_REFRACTION";break}return n}function fj(r){let n="ENVMAP_BLENDING_NONE";if(r.envMap)switch(r.combine){case Ew:n="ENVMAP_BLENDING_MULTIPLY";break;case xG:n="ENVMAP_BLENDING_MIX";break;case _G:n="ENVMAP_BLENDING_ADD";break}return n}function pj(r){const n=r.envMapCubeUVHeight;if(n===null)return null;const i=Math.log2(n)-2,o=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,i),7*16)),texelHeight:o,maxMip:i}}function mj(r,n,i,o){const l=r.getContext(),a=i.defines;let u=i.vertexShader,h=i.fragmentShader;const f=uj(i),d=hj(i),m=dj(i),g=fj(i),x=pj(i),v=i.isWebGL2?"":ij(i),A=rj(a),_=l.createProgram();let E,w,S=i.glslVersion?"#version "+i.glslVersion+`
`:"";i.isRawShaderMaterial?(E=[A].filter(Dp).join(`
`),E.length>0&&(E+=`
`),w=[v,A].filter(Dp).join(`
`),w.length>0&&(w+=`
`)):(E=[P3(i),"#define SHADER_NAME "+i.shaderName,A,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+m:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+f:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Dp).join(`
`),w=[v,P3(i),"#define SHADER_NAME "+i.shaderName,A,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+d:"",i.envMap?"#define "+m:"",i.envMap?"#define "+g:"",x?"#define CUBEUV_TEXEL_WIDTH "+x.texelWidth:"",x?"#define CUBEUV_TEXEL_HEIGHT "+x.texelHeight:"",x?"#define CUBEUV_MAX_MIP "+x.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",i.specularColorMap?"#define USE_SPECULARCOLORMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEENCOLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+f:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==gl?"#define TONE_MAPPING":"",i.toneMapping!==gl?Li.tonemapping_pars_fragment:"",i.toneMapping!==gl?nj("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",Li.encodings_pars_fragment,tj("linearToOutputTexel",i.outputEncoding),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Dp).join(`
`)),u=HE(u),u=C3(u,i),u=R3(u,i),h=HE(h),h=C3(h,i),h=R3(h,i),u=L3(u),h=L3(h),i.isWebGL2&&i.isRawShaderMaterial!==!0&&(S=`#version 300 es
`,E=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,w=["#define varying in",i.glslVersion===e3?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===e3?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+w);const T=S+E+u,R=S+w+h,L=S3(l,35633,T),I=S3(l,35632,R);if(l.attachShader(_,L),l.attachShader(_,I),i.index0AttributeName!==void 0?l.bindAttribLocation(_,0,i.index0AttributeName):i.morphTargets===!0&&l.bindAttribLocation(_,0,"position"),l.linkProgram(_),r.debug.checkShaderErrors){const H=l.getProgramInfoLog(_).trim(),q=l.getShaderInfoLog(L).trim(),le=l.getShaderInfoLog(I).trim();let ne=!0,D=!0;if(l.getProgramParameter(_,35714)===!1){ne=!1;const O=T3(l,L,"vertex"),k=T3(l,I,"fragment");console.error("THREE.WebGLProgram: Shader Error "+l.getError()+" - VALIDATE_STATUS "+l.getProgramParameter(_,35715)+`

Program Info Log: `+H+`
`+O+`
`+k)}else H!==""?console.warn("THREE.WebGLProgram: Program Info Log:",H):(q===""||le==="")&&(D=!1);D&&(this.diagnostics={runnable:ne,programLog:H,vertexShader:{log:q,prefix:E},fragmentShader:{log:le,prefix:w}})}l.deleteShader(L),l.deleteShader(I);let N;this.getUniforms=function(){return N===void 0&&(N=new P0(l,_)),N};let B;return this.getAttributes=function(){return B===void 0&&(B=sj(l,_)),B},this.destroy=function(){o.releaseStatesOfProgram(this),l.deleteProgram(_),this.program=void 0},this.name=i.shaderName,this.id=ZW++,this.cacheKey=n,this.usedTimes=1,this.program=_,this.vertexShader=L,this.fragmentShader=I,this}let gj=0;class vj{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(n){const i=n.vertexShader,o=n.fragmentShader,l=this._getShaderStage(i),a=this._getShaderStage(o),u=this._getShaderCacheForMaterial(n);return u.has(l)===!1&&(u.add(l),l.usedTimes++),u.has(a)===!1&&(u.add(a),a.usedTimes++),this}remove(n){const i=this.materialCache.get(n);for(const o of i)o.usedTimes--,o.usedTimes===0&&this.shaderCache.delete(o.code);return this.materialCache.delete(n),this}getVertexShaderID(n){return this._getShaderStage(n.vertexShader).id}getFragmentShaderID(n){return this._getShaderStage(n.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(n){const i=this.materialCache;let o=i.get(n);return o===void 0&&(o=new Set,i.set(n,o)),o}_getShaderStage(n){const i=this.shaderCache;let o=i.get(n);return o===void 0&&(o=new yj(n),i.set(n,o)),o}}class yj{constructor(n){this.id=gj++,this.code=n,this.usedTimes=0}}function xj(r,n,i,o,l,a,u){const h=new ww,f=new vj,d=[],m=l.isWebGL2,g=l.logarithmicDepthBuffer,x=l.vertexTextures;let v=l.precision;const A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function _(B,H,q,le,ne){const D=le.fog,O=ne.geometry,k=B.isMeshStandardMaterial?le.environment:null,z=(B.isMeshStandardMaterial?i:n).get(B.envMap||k),X=!!z&&z.mapping===Wy?z.image.height:null,Z=A[B.type];B.precision!==null&&(v=l.getMaxPrecision(B.precision),v!==B.precision&&console.warn("THREE.WebGLProgram.getParameters:",B.precision,"not supported, using",v,"instead."));const ie=O.morphAttributes.position||O.morphAttributes.normal||O.morphAttributes.color,se=ie!==void 0?ie.length:0;let ue=0;O.morphAttributes.position!==void 0&&(ue=1),O.morphAttributes.normal!==void 0&&(ue=2),O.morphAttributes.color!==void 0&&(ue=3);let ye,Ce,ke,Oe;if(Z){const Jt=wa[Z];ye=Jt.vertexShader,Ce=Jt.fragmentShader}else ye=B.vertexShader,Ce=B.fragmentShader,f.update(B),ke=f.getVertexShaderID(B),Oe=f.getFragmentShaderID(B);const Ne=r.getRenderTarget(),He=B.alphaTest>0,Qe=B.clearcoat>0,St=B.iridescence>0;return{isWebGL2:m,shaderID:Z,shaderName:B.type,vertexShader:ye,fragmentShader:Ce,defines:B.defines,customVertexShaderID:ke,customFragmentShaderID:Oe,isRawShaderMaterial:B.isRawShaderMaterial===!0,glslVersion:B.glslVersion,precision:v,instancing:ne.isInstancedMesh===!0,instancingColor:ne.isInstancedMesh===!0&&ne.instanceColor!==null,supportsVertexTextures:x,outputEncoding:Ne===null?r.outputEncoding:Ne.isXRRenderTarget===!0?Ne.texture.encoding:Gu,map:!!B.map,matcap:!!B.matcap,envMap:!!z,envMapMode:z&&z.mapping,envMapCubeUVHeight:X,lightMap:!!B.lightMap,aoMap:!!B.aoMap,emissiveMap:!!B.emissiveMap,bumpMap:!!B.bumpMap,normalMap:!!B.normalMap,objectSpaceNormalMap:B.normalMapType===WG,tangentSpaceNormalMap:B.normalMapType===sO,decodeVideoTexture:!!B.map&&B.map.isVideoTexture===!0&&B.map.encoding===pr,clearcoat:Qe,clearcoatMap:Qe&&!!B.clearcoatMap,clearcoatRoughnessMap:Qe&&!!B.clearcoatRoughnessMap,clearcoatNormalMap:Qe&&!!B.clearcoatNormalMap,iridescence:St,iridescenceMap:St&&!!B.iridescenceMap,iridescenceThicknessMap:St&&!!B.iridescenceThicknessMap,displacementMap:!!B.displacementMap,roughnessMap:!!B.roughnessMap,metalnessMap:!!B.metalnessMap,specularMap:!!B.specularMap,specularIntensityMap:!!B.specularIntensityMap,specularColorMap:!!B.specularColorMap,opaque:B.transparent===!1&&B.blending===Nd,alphaMap:!!B.alphaMap,alphaTest:He,gradientMap:!!B.gradientMap,sheen:B.sheen>0,sheenColorMap:!!B.sheenColorMap,sheenRoughnessMap:!!B.sheenRoughnessMap,transmission:B.transmission>0,transmissionMap:!!B.transmissionMap,thicknessMap:!!B.thicknessMap,combine:B.combine,vertexTangents:!!B.normalMap&&!!O.attributes.tangent,vertexColors:B.vertexColors,vertexAlphas:B.vertexColors===!0&&!!O.attributes.color&&O.attributes.color.itemSize===4,vertexUvs:!!B.map||!!B.bumpMap||!!B.normalMap||!!B.specularMap||!!B.alphaMap||!!B.emissiveMap||!!B.roughnessMap||!!B.metalnessMap||!!B.clearcoatMap||!!B.clearcoatRoughnessMap||!!B.clearcoatNormalMap||!!B.iridescenceMap||!!B.iridescenceThicknessMap||!!B.displacementMap||!!B.transmissionMap||!!B.thicknessMap||!!B.specularIntensityMap||!!B.specularColorMap||!!B.sheenColorMap||!!B.sheenRoughnessMap,uvsVertexOnly:!(!!B.map||!!B.bumpMap||!!B.normalMap||!!B.specularMap||!!B.alphaMap||!!B.emissiveMap||!!B.roughnessMap||!!B.metalnessMap||!!B.clearcoatNormalMap||!!B.iridescenceMap||!!B.iridescenceThicknessMap||B.transmission>0||!!B.transmissionMap||!!B.thicknessMap||!!B.specularIntensityMap||!!B.specularColorMap||B.sheen>0||!!B.sheenColorMap||!!B.sheenRoughnessMap)&&!!B.displacementMap,fog:!!D,useFog:B.fog===!0,fogExp2:D&&D.isFogExp2,flatShading:!!B.flatShading,sizeAttenuation:B.sizeAttenuation,logarithmicDepthBuffer:g,skinning:ne.isSkinnedMesh===!0,morphTargets:O.morphAttributes.position!==void 0,morphNormals:O.morphAttributes.normal!==void 0,morphColors:O.morphAttributes.color!==void 0,morphTargetsCount:se,morphTextureStride:ue,numDirLights:H.directional.length,numPointLights:H.point.length,numSpotLights:H.spot.length,numSpotLightMaps:H.spotLightMap.length,numRectAreaLights:H.rectArea.length,numHemiLights:H.hemi.length,numDirLightShadows:H.directionalShadowMap.length,numPointLightShadows:H.pointShadowMap.length,numSpotLightShadows:H.spotShadowMap.length,numSpotLightShadowsWithMaps:H.numSpotLightShadowsWithMaps,numClippingPlanes:u.numPlanes,numClipIntersection:u.numIntersection,dithering:B.dithering,shadowMapEnabled:r.shadowMap.enabled&&q.length>0,shadowMapType:r.shadowMap.type,toneMapping:B.toneMapped?r.toneMapping:gl,physicallyCorrectLights:r.physicallyCorrectLights,premultipliedAlpha:B.premultipliedAlpha,doubleSided:B.side===bw,flipSided:B.side===ro,useDepthPacking:!!B.depthPacking,depthPacking:B.depthPacking||0,index0AttributeName:B.index0AttributeName,extensionDerivatives:B.extensions&&B.extensions.derivatives,extensionFragDepth:B.extensions&&B.extensions.fragDepth,extensionDrawBuffers:B.extensions&&B.extensions.drawBuffers,extensionShaderTextureLOD:B.extensions&&B.extensions.shaderTextureLOD,rendererExtensionFragDepth:m||o.has("EXT_frag_depth"),rendererExtensionDrawBuffers:m||o.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:m||o.has("EXT_shader_texture_lod"),customProgramCacheKey:B.customProgramCacheKey()}}function E(B){const H=[];if(B.shaderID?H.push(B.shaderID):(H.push(B.customVertexShaderID),H.push(B.customFragmentShaderID)),B.defines!==void 0)for(const q in B.defines)H.push(q),H.push(B.defines[q]);return B.isRawShaderMaterial===!1&&(w(H,B),S(H,B),H.push(r.outputEncoding)),H.push(B.customProgramCacheKey),H.join()}function w(B,H){B.push(H.precision),B.push(H.outputEncoding),B.push(H.envMapMode),B.push(H.envMapCubeUVHeight),B.push(H.combine),B.push(H.vertexUvs),B.push(H.fogExp2),B.push(H.sizeAttenuation),B.push(H.morphTargetsCount),B.push(H.morphAttributeCount),B.push(H.numDirLights),B.push(H.numPointLights),B.push(H.numSpotLights),B.push(H.numSpotLightMaps),B.push(H.numHemiLights),B.push(H.numRectAreaLights),B.push(H.numDirLightShadows),B.push(H.numPointLightShadows),B.push(H.numSpotLightShadows),B.push(H.numSpotLightShadowsWithMaps),B.push(H.shadowMapType),B.push(H.toneMapping),B.push(H.numClippingPlanes),B.push(H.numClipIntersection),B.push(H.depthPacking)}function S(B,H){h.disableAll(),H.isWebGL2&&h.enable(0),H.supportsVertexTextures&&h.enable(1),H.instancing&&h.enable(2),H.instancingColor&&h.enable(3),H.map&&h.enable(4),H.matcap&&h.enable(5),H.envMap&&h.enable(6),H.lightMap&&h.enable(7),H.aoMap&&h.enable(8),H.emissiveMap&&h.enable(9),H.bumpMap&&h.enable(10),H.normalMap&&h.enable(11),H.objectSpaceNormalMap&&h.enable(12),H.tangentSpaceNormalMap&&h.enable(13),H.clearcoat&&h.enable(14),H.clearcoatMap&&h.enable(15),H.clearcoatRoughnessMap&&h.enable(16),H.clearcoatNormalMap&&h.enable(17),H.iridescence&&h.enable(18),H.iridescenceMap&&h.enable(19),H.iridescenceThicknessMap&&h.enable(20),H.displacementMap&&h.enable(21),H.specularMap&&h.enable(22),H.roughnessMap&&h.enable(23),H.metalnessMap&&h.enable(24),H.gradientMap&&h.enable(25),H.alphaMap&&h.enable(26),H.alphaTest&&h.enable(27),H.vertexColors&&h.enable(28),H.vertexAlphas&&h.enable(29),H.vertexUvs&&h.enable(30),H.vertexTangents&&h.enable(31),H.uvsVertexOnly&&h.enable(32),B.push(h.mask),h.disableAll(),H.fog&&h.enable(0),H.useFog&&h.enable(1),H.flatShading&&h.enable(2),H.logarithmicDepthBuffer&&h.enable(3),H.skinning&&h.enable(4),H.morphTargets&&h.enable(5),H.morphNormals&&h.enable(6),H.morphColors&&h.enable(7),H.premultipliedAlpha&&h.enable(8),H.shadowMapEnabled&&h.enable(9),H.physicallyCorrectLights&&h.enable(10),H.doubleSided&&h.enable(11),H.flipSided&&h.enable(12),H.useDepthPacking&&h.enable(13),H.dithering&&h.enable(14),H.specularIntensityMap&&h.enable(15),H.specularColorMap&&h.enable(16),H.transmission&&h.enable(17),H.transmissionMap&&h.enable(18),H.thicknessMap&&h.enable(19),H.sheen&&h.enable(20),H.sheenColorMap&&h.enable(21),H.sheenRoughnessMap&&h.enable(22),H.decodeVideoTexture&&h.enable(23),H.opaque&&h.enable(24),B.push(h.mask)}function T(B){const H=A[B.type];let q;if(H){const le=wa[H];q=pO.clone(le.uniforms)}else q=B.uniforms;return q}function R(B,H){let q;for(let le=0,ne=d.length;le<ne;le++){const D=d[le];if(D.cacheKey===H){q=D,++q.usedTimes;break}}return q===void 0&&(q=new mj(r,H,B,a),d.push(q)),q}function L(B){if(--B.usedTimes===0){const H=d.indexOf(B);d[H]=d[d.length-1],d.pop(),B.destroy()}}function I(B){f.remove(B)}function N(){f.dispose()}return{getParameters:_,getProgramCacheKey:E,getUniforms:T,acquireProgram:R,releaseProgram:L,releaseShaderCache:I,programs:d,dispose:N}}function _j(){let r=new WeakMap;function n(a){let u=r.get(a);return u===void 0&&(u={},r.set(a,u)),u}function i(a){r.delete(a)}function o(a,u,h){r.get(a)[u]=h}function l(){r=new WeakMap}return{get:n,remove:i,update:o,dispose:l}}function bj(r,n){return r.groupOrder!==n.groupOrder?r.groupOrder-n.groupOrder:r.renderOrder!==n.renderOrder?r.renderOrder-n.renderOrder:r.material.id!==n.material.id?r.material.id-n.material.id:r.z!==n.z?r.z-n.z:r.id-n.id}function D3(r,n){return r.groupOrder!==n.groupOrder?r.groupOrder-n.groupOrder:r.renderOrder!==n.renderOrder?r.renderOrder-n.renderOrder:r.z!==n.z?n.z-r.z:r.id-n.id}function O3(){const r=[];let n=0;const i=[],o=[],l=[];function a(){n=0,i.length=0,o.length=0,l.length=0}function u(g,x,v,A,_,E){let w=r[n];return w===void 0?(w={id:g.id,object:g,geometry:x,material:v,groupOrder:A,renderOrder:g.renderOrder,z:_,group:E},r[n]=w):(w.id=g.id,w.object=g,w.geometry=x,w.material=v,w.groupOrder=A,w.renderOrder=g.renderOrder,w.z=_,w.group=E),n++,w}function h(g,x,v,A,_,E){const w=u(g,x,v,A,_,E);v.transmission>0?o.push(w):v.transparent===!0?l.push(w):i.push(w)}function f(g,x,v,A,_,E){const w=u(g,x,v,A,_,E);v.transmission>0?o.unshift(w):v.transparent===!0?l.unshift(w):i.unshift(w)}function d(g,x){i.length>1&&i.sort(g||bj),o.length>1&&o.sort(x||D3),l.length>1&&l.sort(x||D3)}function m(){for(let g=n,x=r.length;g<x;g++){const v=r[g];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:i,transmissive:o,transparent:l,init:a,push:h,unshift:f,finish:m,sort:d}}function Ej(){let r=new WeakMap;function n(o,l){const a=r.get(o);let u;return a===void 0?(u=new O3,r.set(o,[u])):l>=a.length?(u=new O3,a.push(u)):u=a[l],u}function i(){r=new WeakMap}return{get:n,dispose:i}}function Aj(){const r={};return{get:function(n){if(r[n.id]!==void 0)return r[n.id];let i;switch(n.type){case"DirectionalLight":i={direction:new it,color:new Ji};break;case"SpotLight":i={position:new it,direction:new it,color:new Ji,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new it,color:new Ji,distance:0,decay:0};break;case"HemisphereLight":i={direction:new it,skyColor:new Ji,groundColor:new Ji};break;case"RectAreaLight":i={color:new Ji,position:new it,halfWidth:new it,halfHeight:new it};break}return r[n.id]=i,i}}}function wj(){const r={};return{get:function(n){if(r[n.id]!==void 0)return r[n.id];let i;switch(n.type){case"DirectionalLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rn};break;case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rn};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Rn,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[n.id]=i,i}}}let Mj=0;function Sj(r,n){return(n.castShadow?2:0)-(r.castShadow?2:0)+(n.map?1:0)-(r.map?1:0)}function Tj(r,n){const i=new Aj,o=wj(),l={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let m=0;m<9;m++)l.probe.push(new it);const a=new it,u=new Er,h=new Er;function f(m,g){let x=0,v=0,A=0;for(let le=0;le<9;le++)l.probe[le].set(0,0,0);let _=0,E=0,w=0,S=0,T=0,R=0,L=0,I=0,N=0,B=0;m.sort(Sj);const H=g!==!0?Math.PI:1;for(let le=0,ne=m.length;le<ne;le++){const D=m[le],O=D.color,k=D.intensity,z=D.distance,X=D.shadow&&D.shadow.map?D.shadow.map.texture:null;if(D.isAmbientLight)x+=O.r*k*H,v+=O.g*k*H,A+=O.b*k*H;else if(D.isLightProbe)for(let Z=0;Z<9;Z++)l.probe[Z].addScaledVector(D.sh.coefficients[Z],k);else if(D.isDirectionalLight){const Z=i.get(D);if(Z.color.copy(D.color).multiplyScalar(D.intensity*H),D.castShadow){const ie=D.shadow,se=o.get(D);se.shadowBias=ie.bias,se.shadowNormalBias=ie.normalBias,se.shadowRadius=ie.radius,se.shadowMapSize=ie.mapSize,l.directionalShadow[_]=se,l.directionalShadowMap[_]=X,l.directionalShadowMatrix[_]=D.shadow.matrix,R++}l.directional[_]=Z,_++}else if(D.isSpotLight){const Z=i.get(D);Z.position.setFromMatrixPosition(D.matrixWorld),Z.color.copy(O).multiplyScalar(k*H),Z.distance=z,Z.coneCos=Math.cos(D.angle),Z.penumbraCos=Math.cos(D.angle*(1-D.penumbra)),Z.decay=D.decay,l.spot[w]=Z;const ie=D.shadow;if(D.map&&(l.spotLightMap[N]=D.map,N++,ie.updateMatrices(D),D.castShadow&&B++),l.spotLightMatrix[w]=ie.matrix,D.castShadow){const se=o.get(D);se.shadowBias=ie.bias,se.shadowNormalBias=ie.normalBias,se.shadowRadius=ie.radius,se.shadowMapSize=ie.mapSize,l.spotShadow[w]=se,l.spotShadowMap[w]=X,I++}w++}else if(D.isRectAreaLight){const Z=i.get(D);Z.color.copy(O).multiplyScalar(k),Z.halfWidth.set(D.width*.5,0,0),Z.halfHeight.set(0,D.height*.5,0),l.rectArea[S]=Z,S++}else if(D.isPointLight){const Z=i.get(D);if(Z.color.copy(D.color).multiplyScalar(D.intensity*H),Z.distance=D.distance,Z.decay=D.decay,D.castShadow){const ie=D.shadow,se=o.get(D);se.shadowBias=ie.bias,se.shadowNormalBias=ie.normalBias,se.shadowRadius=ie.radius,se.shadowMapSize=ie.mapSize,se.shadowCameraNear=ie.camera.near,se.shadowCameraFar=ie.camera.far,l.pointShadow[E]=se,l.pointShadowMap[E]=X,l.pointShadowMatrix[E]=D.shadow.matrix,L++}l.point[E]=Z,E++}else if(D.isHemisphereLight){const Z=i.get(D);Z.skyColor.copy(D.color).multiplyScalar(k*H),Z.groundColor.copy(D.groundColor).multiplyScalar(k*H),l.hemi[T]=Z,T++}}S>0&&(n.isWebGL2||r.has("OES_texture_float_linear")===!0?(l.rectAreaLTC1=_n.LTC_FLOAT_1,l.rectAreaLTC2=_n.LTC_FLOAT_2):r.has("OES_texture_half_float_linear")===!0?(l.rectAreaLTC1=_n.LTC_HALF_1,l.rectAreaLTC2=_n.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),l.ambient[0]=x,l.ambient[1]=v,l.ambient[2]=A;const q=l.hash;(q.directionalLength!==_||q.pointLength!==E||q.spotLength!==w||q.rectAreaLength!==S||q.hemiLength!==T||q.numDirectionalShadows!==R||q.numPointShadows!==L||q.numSpotShadows!==I||q.numSpotMaps!==N)&&(l.directional.length=_,l.spot.length=w,l.rectArea.length=S,l.point.length=E,l.hemi.length=T,l.directionalShadow.length=R,l.directionalShadowMap.length=R,l.pointShadow.length=L,l.pointShadowMap.length=L,l.spotShadow.length=I,l.spotShadowMap.length=I,l.directionalShadowMatrix.length=R,l.pointShadowMatrix.length=L,l.spotLightMatrix.length=I+N-B,l.spotLightMap.length=N,l.numSpotLightShadowsWithMaps=B,q.directionalLength=_,q.pointLength=E,q.spotLength=w,q.rectAreaLength=S,q.hemiLength=T,q.numDirectionalShadows=R,q.numPointShadows=L,q.numSpotShadows=I,q.numSpotMaps=N,l.version=Mj++)}function d(m,g){let x=0,v=0,A=0,_=0,E=0;const w=g.matrixWorldInverse;for(let S=0,T=m.length;S<T;S++){const R=m[S];if(R.isDirectionalLight){const L=l.directional[x];L.direction.setFromMatrixPosition(R.matrixWorld),a.setFromMatrixPosition(R.target.matrixWorld),L.direction.sub(a),L.direction.transformDirection(w),x++}else if(R.isSpotLight){const L=l.spot[A];L.position.setFromMatrixPosition(R.matrixWorld),L.position.applyMatrix4(w),L.direction.setFromMatrixPosition(R.matrixWorld),a.setFromMatrixPosition(R.target.matrixWorld),L.direction.sub(a),L.direction.transformDirection(w),A++}else if(R.isRectAreaLight){const L=l.rectArea[_];L.position.setFromMatrixPosition(R.matrixWorld),L.position.applyMatrix4(w),h.identity(),u.copy(R.matrixWorld),u.premultiply(w),h.extractRotation(u),L.halfWidth.set(R.width*.5,0,0),L.halfHeight.set(0,R.height*.5,0),L.halfWidth.applyMatrix4(h),L.halfHeight.applyMatrix4(h),_++}else if(R.isPointLight){const L=l.point[v];L.position.setFromMatrixPosition(R.matrixWorld),L.position.applyMatrix4(w),v++}else if(R.isHemisphereLight){const L=l.hemi[E];L.direction.setFromMatrixPosition(R.matrixWorld),L.direction.transformDirection(w),E++}}}return{setup:f,setupView:d,state:l}}function I3(r,n){const i=new Tj(r,n),o=[],l=[];function a(){o.length=0,l.length=0}function u(g){o.push(g)}function h(g){l.push(g)}function f(g){i.setup(o,g)}function d(g){i.setupView(o,g)}return{init:a,state:{lightsArray:o,shadowsArray:l,lights:i},setupLights:f,setupLightsView:d,pushLight:u,pushShadow:h}}function Cj(r,n){let i=new WeakMap;function o(a,u=0){const h=i.get(a);let f;return h===void 0?(f=new I3(r,n),i.set(a,[f])):u>=h.length?(f=new I3(r,n),h.push(f)):f=h[u],f}function l(){i=new WeakMap}return{get:o,dispose:l}}class Rj extends uf{constructor(n){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=GG,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(n)}copy(n){return super.copy(n),this.depthPacking=n.depthPacking,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this}}class Lj extends uf{constructor(n){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new it,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(n)}copy(n){return super.copy(n),this.referencePosition.copy(n.referencePosition),this.nearDistance=n.nearDistance,this.farDistance=n.farDistance,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this}}const Pj=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Dj=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Oj(r,n,i){let o=new Sw;const l=new Rn,a=new Rn,u=new ts,h=new Rj({depthPacking:VG}),f=new Lj,d={},m=i.maxTextureSize,g={0:ro,1:zu,2:bw},x=new Ml({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Rn},radius:{value:4}},vertexShader:Pj,fragmentShader:Dj}),v=x.clone();v.defines.HORIZONTAL_PASS=1;const A=new ho;A.setAttribute("position",new ta(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const _=new Zo(A,x),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=eO,this.render=function(R,L,I){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||R.length===0)return;const N=r.getRenderTarget(),B=r.getActiveCubeFace(),H=r.getActiveMipmapLevel(),q=r.state;q.setBlending(wc),q.buffers.color.setClear(1,1,1,1),q.buffers.depth.setTest(!0),q.setScissorTest(!1);for(let le=0,ne=R.length;le<ne;le++){const D=R[le],O=D.shadow;if(O===void 0){console.warn("THREE.WebGLShadowMap:",D,"has no shadow.");continue}if(O.autoUpdate===!1&&O.needsUpdate===!1)continue;l.copy(O.mapSize);const k=O.getFrameExtents();if(l.multiply(k),a.copy(O.mapSize),(l.x>m||l.y>m)&&(l.x>m&&(a.x=Math.floor(m/k.x),l.x=a.x*k.x,O.mapSize.x=a.x),l.y>m&&(a.y=Math.floor(m/k.y),l.y=a.y*k.y,O.mapSize.y=a.y)),O.map===null){const X=this.type!==Pp?{minFilter:Ss,magFilter:Ss}:{};O.map=new Tc(l.x,l.y,X),O.map.texture.name=D.name+".shadowMap",O.camera.updateProjectionMatrix()}r.setRenderTarget(O.map),r.clear();const z=O.getViewportCount();for(let X=0;X<z;X++){const Z=O.getViewport(X);u.set(a.x*Z.x,a.y*Z.y,a.x*Z.z,a.y*Z.w),q.viewport(u),O.updateMatrices(D,X),o=O.getFrustum(),T(L,I,O.camera,D,this.type)}O.isPointLightShadow!==!0&&this.type===Pp&&w(O,I),O.needsUpdate=!1}E.needsUpdate=!1,r.setRenderTarget(N,B,H)};function w(R,L){const I=n.update(_);x.defines.VSM_SAMPLES!==R.blurSamples&&(x.defines.VSM_SAMPLES=R.blurSamples,v.defines.VSM_SAMPLES=R.blurSamples,x.needsUpdate=!0,v.needsUpdate=!0),R.mapPass===null&&(R.mapPass=new Tc(l.x,l.y)),x.uniforms.shadow_pass.value=R.map.texture,x.uniforms.resolution.value=R.mapSize,x.uniforms.radius.value=R.radius,r.setRenderTarget(R.mapPass),r.clear(),r.renderBufferDirect(L,null,I,x,_,null),v.uniforms.shadow_pass.value=R.mapPass.texture,v.uniforms.resolution.value=R.mapSize,v.uniforms.radius.value=R.radius,r.setRenderTarget(R.map),r.clear(),r.renderBufferDirect(L,null,I,v,_,null)}function S(R,L,I,N,B,H){let q=null;const le=I.isPointLight===!0?R.customDistanceMaterial:R.customDepthMaterial;if(le!==void 0)q=le;else if(q=I.isPointLight===!0?f:h,r.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){const ne=q.uuid,D=L.uuid;let O=d[ne];O===void 0&&(O={},d[ne]=O);let k=O[D];k===void 0&&(k=q.clone(),O[D]=k),q=k}return q.visible=L.visible,q.wireframe=L.wireframe,H===Pp?q.side=L.shadowSide!==null?L.shadowSide:L.side:q.side=L.shadowSide!==null?L.shadowSide:g[L.side],q.alphaMap=L.alphaMap,q.alphaTest=L.alphaTest,q.map=L.map,q.clipShadows=L.clipShadows,q.clippingPlanes=L.clippingPlanes,q.clipIntersection=L.clipIntersection,q.displacementMap=L.displacementMap,q.displacementScale=L.displacementScale,q.displacementBias=L.displacementBias,q.wireframeLinewidth=L.wireframeLinewidth,q.linewidth=L.linewidth,I.isPointLight===!0&&q.isMeshDistanceMaterial===!0&&(q.referencePosition.setFromMatrixPosition(I.matrixWorld),q.nearDistance=N,q.farDistance=B),q}function T(R,L,I,N,B){if(R.visible===!1)return;if(R.layers.test(L.layers)&&(R.isMesh||R.isLine||R.isPoints)&&(R.castShadow||R.receiveShadow&&B===Pp)&&(!R.frustumCulled||o.intersectsObject(R))){R.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,R.matrixWorld);const le=n.update(R),ne=R.material;if(Array.isArray(ne)){const D=le.groups;for(let O=0,k=D.length;O<k;O++){const z=D[O],X=ne[z.materialIndex];if(X&&X.visible){const Z=S(R,X,N,I.near,I.far,B);r.renderBufferDirect(I,null,le,Z,R,z)}}}else if(ne.visible){const D=S(R,ne,N,I.near,I.far,B);r.renderBufferDirect(I,null,le,D,R,null)}}const q=R.children;for(let le=0,ne=q.length;le<ne;le++)T(q[le],L,I,N,B)}}function Ij(r,n,i){const o=i.isWebGL2;function l(){let Je=!1;const Ve=new ts;let nt=null;const yt=new ts(0,0,0,0);return{setMask:function(Wt){nt!==Wt&&!Je&&(r.colorMask(Wt,Wt,Wt,Wt),nt=Wt)},setLocked:function(Wt){Je=Wt},setClear:function(Wt,pn,An,mn,Yn){Yn===!0&&(Wt*=mn,pn*=mn,An*=mn),Ve.set(Wt,pn,An,mn),yt.equals(Ve)===!1&&(r.clearColor(Wt,pn,An,mn),yt.copy(Ve))},reset:function(){Je=!1,nt=null,yt.set(-1,0,0,0)}}}function a(){let Je=!1,Ve=null,nt=null,yt=null;return{setTest:function(Wt){Wt?He(2929):Qe(2929)},setMask:function(Wt){Ve!==Wt&&!Je&&(r.depthMask(Wt),Ve=Wt)},setFunc:function(Wt){if(nt!==Wt){switch(Wt){case dG:r.depthFunc(512);break;case fG:r.depthFunc(519);break;case pG:r.depthFunc(513);break;case IE:r.depthFunc(515);break;case mG:r.depthFunc(514);break;case gG:r.depthFunc(518);break;case vG:r.depthFunc(516);break;case yG:r.depthFunc(517);break;default:r.depthFunc(515)}nt=Wt}},setLocked:function(Wt){Je=Wt},setClear:function(Wt){yt!==Wt&&(r.clearDepth(Wt),yt=Wt)},reset:function(){Je=!1,Ve=null,nt=null,yt=null}}}function u(){let Je=!1,Ve=null,nt=null,yt=null,Wt=null,pn=null,An=null,mn=null,Yn=null;return{setTest:function(Bn){Je||(Bn?He(2960):Qe(2960))},setMask:function(Bn){Ve!==Bn&&!Je&&(r.stencilMask(Bn),Ve=Bn)},setFunc:function(Bn,mi,Ii){(nt!==Bn||yt!==mi||Wt!==Ii)&&(r.stencilFunc(Bn,mi,Ii),nt=Bn,yt=mi,Wt=Ii)},setOp:function(Bn,mi,Ii){(pn!==Bn||An!==mi||mn!==Ii)&&(r.stencilOp(Bn,mi,Ii),pn=Bn,An=mi,mn=Ii)},setLocked:function(Bn){Je=Bn},setClear:function(Bn){Yn!==Bn&&(r.clearStencil(Bn),Yn=Bn)},reset:function(){Je=!1,Ve=null,nt=null,yt=null,Wt=null,pn=null,An=null,mn=null,Yn=null}}}const h=new l,f=new a,d=new u,m=new WeakMap,g=new WeakMap;let x={},v={},A=new WeakMap,_=[],E=null,w=!1,S=null,T=null,R=null,L=null,I=null,N=null,B=null,H=!1,q=null,le=null,ne=null,D=null,O=null;const k=r.getParameter(35661);let z=!1,X=0;const Z=r.getParameter(7938);Z.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(Z)[1]),z=X>=1):Z.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(Z)[1]),z=X>=2);let ie=null,se={};const ue=r.getParameter(3088),ye=r.getParameter(2978),Ce=new ts().fromArray(ue),ke=new ts().fromArray(ye);function Oe(Je,Ve,nt){const yt=new Uint8Array(4),Wt=r.createTexture();r.bindTexture(Je,Wt),r.texParameteri(Je,10241,9728),r.texParameteri(Je,10240,9728);for(let pn=0;pn<nt;pn++)r.texImage2D(Ve+pn,0,6408,1,1,0,6408,5121,yt);return Wt}const Ne={};Ne[3553]=Oe(3553,3553,1),Ne[34067]=Oe(34067,34069,6),h.setClear(0,0,0,1),f.setClear(1),d.setClear(0),He(2929),f.setFunc(IE),At(!1),tt(MC),He(2884),qe(wc);function He(Je){x[Je]!==!0&&(r.enable(Je),x[Je]=!0)}function Qe(Je){x[Je]!==!1&&(r.disable(Je),x[Je]=!1)}function St(Je,Ve){return v[Je]!==Ve?(r.bindFramebuffer(Je,Ve),v[Je]=Ve,o&&(Je===36009&&(v[36160]=Ve),Je===36160&&(v[36009]=Ve)),!0):!1}function bt(Je,Ve){let nt=_,yt=!1;if(Je)if(nt=A.get(Ve),nt===void 0&&(nt=[],A.set(Ve,nt)),Je.isWebGLMultipleRenderTargets){const Wt=Je.texture;if(nt.length!==Wt.length||nt[0]!==36064){for(let pn=0,An=Wt.length;pn<An;pn++)nt[pn]=36064+pn;nt.length=Wt.length,yt=!0}}else nt[0]!==36064&&(nt[0]=36064,yt=!0);else nt[0]!==1029&&(nt[0]=1029,yt=!0);yt&&(i.isWebGL2?r.drawBuffers(nt):n.get("WEBGL_draw_buffers").drawBuffersWEBGL(nt))}function Jt(Je){return E!==Je?(r.useProgram(Je),E=Je,!0):!1}const sn={[cd]:32774,[tG]:32778,[nG]:32779};if(o)sn[RC]=32775,sn[LC]=32776;else{const Je=n.get("EXT_blend_minmax");Je!==null&&(sn[RC]=Je.MIN_EXT,sn[LC]=Je.MAX_EXT)}const Se={[iG]:0,[rG]:1,[sG]:768,[tO]:770,[hG]:776,[cG]:774,[aG]:772,[oG]:769,[nO]:771,[uG]:775,[lG]:773};function qe(Je,Ve,nt,yt,Wt,pn,An,mn){if(Je===wc){w===!0&&(Qe(3042),w=!1);return}if(w===!1&&(He(3042),w=!0),Je!==eG){if(Je!==S||mn!==H){if((T!==cd||I!==cd)&&(r.blendEquation(32774),T=cd,I=cd),mn)switch(Je){case Nd:r.blendFuncSeparate(1,771,1,771);break;case SC:r.blendFunc(1,1);break;case TC:r.blendFuncSeparate(0,769,0,1);break;case CC:r.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Je);break}else switch(Je){case Nd:r.blendFuncSeparate(770,771,1,771);break;case SC:r.blendFunc(770,1);break;case TC:r.blendFuncSeparate(0,769,0,1);break;case CC:r.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Je);break}R=null,L=null,N=null,B=null,S=Je,H=mn}return}Wt=Wt||Ve,pn=pn||nt,An=An||yt,(Ve!==T||Wt!==I)&&(r.blendEquationSeparate(sn[Ve],sn[Wt]),T=Ve,I=Wt),(nt!==R||yt!==L||pn!==N||An!==B)&&(r.blendFuncSeparate(Se[nt],Se[yt],Se[pn],Se[An]),R=nt,L=yt,N=pn,B=An),S=Je,H=!1}function Ue(Je,Ve){Je.side===bw?Qe(2884):He(2884);let nt=Je.side===ro;Ve&&(nt=!nt),At(nt),Je.blending===Nd&&Je.transparent===!1?qe(wc):qe(Je.blending,Je.blendEquation,Je.blendSrc,Je.blendDst,Je.blendEquationAlpha,Je.blendSrcAlpha,Je.blendDstAlpha,Je.premultipliedAlpha),f.setFunc(Je.depthFunc),f.setTest(Je.depthTest),f.setMask(Je.depthWrite),h.setMask(Je.colorWrite);const yt=Je.stencilWrite;d.setTest(yt),yt&&(d.setMask(Je.stencilWriteMask),d.setFunc(Je.stencilFunc,Je.stencilRef,Je.stencilFuncMask),d.setOp(Je.stencilFail,Je.stencilZFail,Je.stencilZPass)),ge(Je.polygonOffset,Je.polygonOffsetFactor,Je.polygonOffsetUnits),Je.alphaToCoverage===!0?He(32926):Qe(32926)}function At(Je){q!==Je&&(Je?r.frontFace(2304):r.frontFace(2305),q=Je)}function tt(Je){Je!==QH?(He(2884),Je!==le&&(Je===MC?r.cullFace(1029):Je===ZH?r.cullFace(1028):r.cullFace(1032))):Qe(2884),le=Je}function pe(Je){Je!==ne&&(z&&r.lineWidth(Je),ne=Je)}function ge(Je,Ve,nt){Je?(He(32823),(D!==Ve||O!==nt)&&(r.polygonOffset(Ve,nt),D=Ve,O=nt)):Qe(32823)}function Fe(Je){Je?He(3089):Qe(3089)}function Re(Je){Je===void 0&&(Je=33984+k-1),ie!==Je&&(r.activeTexture(Je),ie=Je)}function ce(Je,Ve,nt){nt===void 0&&(ie===null?nt=33984+k-1:nt=ie);let yt=se[nt];yt===void 0&&(yt={type:void 0,texture:void 0},se[nt]=yt),(yt.type!==Je||yt.texture!==Ve)&&(ie!==nt&&(r.activeTexture(nt),ie=nt),r.bindTexture(Je,Ve||Ne[Je]),yt.type=Je,yt.texture=Ve)}function ae(){const Je=se[ie];Je!==void 0&&Je.type!==void 0&&(r.bindTexture(Je.type,null),Je.type=void 0,Je.texture=void 0)}function J(){try{r.compressedTexImage2D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function G(){try{r.compressedTexImage3D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function $(){try{r.texSubImage2D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function me(){try{r.texSubImage3D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function Pe(){try{r.compressedTexSubImage2D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function ve(){try{r.compressedTexSubImage3D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function Le(){try{r.texStorage2D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function wt(){try{r.texStorage3D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function Ot(){try{r.texImage2D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function _t(){try{r.texImage3D.apply(r,arguments)}catch(Je){console.error("THREE.WebGLState:",Je)}}function Ut(Je){Ce.equals(Je)===!1&&(r.scissor(Je.x,Je.y,Je.z,Je.w),Ce.copy(Je))}function It(Je){ke.equals(Je)===!1&&(r.viewport(Je.x,Je.y,Je.z,Je.w),ke.copy(Je))}function dn(Je,Ve){let nt=g.get(Ve);nt===void 0&&(nt=new WeakMap,g.set(Ve,nt));let yt=nt.get(Je);yt===void 0&&(yt=r.getUniformBlockIndex(Ve,Je.name),nt.set(Je,yt))}function Un(Je,Ve){const yt=g.get(Ve).get(Je);m.get(Ve)!==yt&&(r.uniformBlockBinding(Ve,yt,Je.__bindingPointIndex),m.set(Ve,yt))}function $n(){r.disable(3042),r.disable(2884),r.disable(2929),r.disable(32823),r.disable(3089),r.disable(2960),r.disable(32926),r.blendEquation(32774),r.blendFunc(1,0),r.blendFuncSeparate(1,0,1,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(513),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(519,0,4294967295),r.stencilOp(7680,7680,7680),r.clearStencil(0),r.cullFace(1029),r.frontFace(2305),r.polygonOffset(0,0),r.activeTexture(33984),r.bindFramebuffer(36160,null),o===!0&&(r.bindFramebuffer(36009,null),r.bindFramebuffer(36008,null)),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),x={},ie=null,se={},v={},A=new WeakMap,_=[],E=null,w=!1,S=null,T=null,R=null,L=null,I=null,N=null,B=null,H=!1,q=null,le=null,ne=null,D=null,O=null,Ce.set(0,0,r.canvas.width,r.canvas.height),ke.set(0,0,r.canvas.width,r.canvas.height),h.reset(),f.reset(),d.reset()}return{buffers:{color:h,depth:f,stencil:d},enable:He,disable:Qe,bindFramebuffer:St,drawBuffers:bt,useProgram:Jt,setBlending:qe,setMaterial:Ue,setFlipSided:At,setCullFace:tt,setLineWidth:pe,setPolygonOffset:ge,setScissorTest:Fe,activeTexture:Re,bindTexture:ce,unbindTexture:ae,compressedTexImage2D:J,compressedTexImage3D:G,texImage2D:Ot,texImage3D:_t,updateUBOMapping:dn,uniformBlockBinding:Un,texStorage2D:Le,texStorage3D:wt,texSubImage2D:$,texSubImage3D:me,compressedTexSubImage2D:Pe,compressedTexSubImage3D:ve,scissor:Ut,viewport:It,reset:$n}}function kj(r,n,i,o,l,a,u){const h=l.isWebGL2,f=l.maxTextures,d=l.maxCubemapSize,m=l.maxTextureSize,g=l.maxSamples,x=n.has("WEBGL_multisampled_render_to_texture")?n.get("WEBGL_multisampled_render_to_texture"):null,v=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),A=new WeakMap;let _;const E=new WeakMap;let w=!1;try{w=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function S(ce,ae){return w?new OffscreenCanvas(ce,ae):_m("canvas")}function T(ce,ae,J,G){let $=1;if((ce.width>G||ce.height>G)&&($=G/Math.max(ce.width,ce.height)),$<1||ae===!0)if(typeof HTMLImageElement<"u"&&ce instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&ce instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&ce instanceof ImageBitmap){const me=ae?zE:Math.floor,Pe=me($*ce.width),ve=me($*ce.height);_===void 0&&(_=S(Pe,ve));const Le=J?S(Pe,ve):_;return Le.width=Pe,Le.height=ve,Le.getContext("2d").drawImage(ce,0,0,Pe,ve),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ce.width+"x"+ce.height+") to ("+Pe+"x"+ve+")."),Le}else return"data"in ce&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ce.width+"x"+ce.height+")."),ce;return ce}function R(ce){return n3(ce.width)&&n3(ce.height)}function L(ce){return h?!1:ce.wrapS!==qo||ce.wrapT!==qo||ce.minFilter!==Ss&&ce.minFilter!==xo}function I(ce,ae){return ce.generateMipmaps&&ae&&ce.minFilter!==Ss&&ce.minFilter!==xo}function N(ce){r.generateMipmap(ce)}function B(ce,ae,J,G,$=!1){if(h===!1)return ae;if(ce!==null){if(r[ce]!==void 0)return r[ce];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ce+"'")}let me=ae;return ae===6403&&(J===5126&&(me=33326),J===5131&&(me=33325),J===5121&&(me=33321)),ae===33319&&(J===5126&&(me=33328),J===5131&&(me=33327),J===5121&&(me=33323)),ae===6408&&(J===5126&&(me=34836),J===5131&&(me=34842),J===5121&&(me=G===pr&&$===!1?35907:32856),J===32819&&(me=32854),J===32820&&(me=32855)),(me===33325||me===33326||me===33327||me===33328||me===34842||me===34836)&&n.get("EXT_color_buffer_float"),me}function H(ce,ae,J){return I(ce,J)===!0||ce.isFramebufferTexture&&ce.minFilter!==Ss&&ce.minFilter!==xo?Math.log2(Math.max(ae.width,ae.height))+1:ce.mipmaps!==void 0&&ce.mipmaps.length>0?ce.mipmaps.length:ce.isCompressedTexture&&Array.isArray(ce.image)?ae.mipmaps.length:1}function q(ce){return ce===Ss||ce===PC||ce===_b?9728:9729}function le(ce){const ae=ce.target;ae.removeEventListener("dispose",le),D(ae),ae.isVideoTexture&&A.delete(ae)}function ne(ce){const ae=ce.target;ae.removeEventListener("dispose",ne),k(ae)}function D(ce){const ae=o.get(ce);if(ae.__webglInit===void 0)return;const J=ce.source,G=E.get(J);if(G){const $=G[ae.__cacheKey];$.usedTimes--,$.usedTimes===0&&O(ce),Object.keys(G).length===0&&E.delete(J)}o.remove(ce)}function O(ce){const ae=o.get(ce);r.deleteTexture(ae.__webglTexture);const J=ce.source,G=E.get(J);delete G[ae.__cacheKey],u.memory.textures--}function k(ce){const ae=ce.texture,J=o.get(ce),G=o.get(ae);if(G.__webglTexture!==void 0&&(r.deleteTexture(G.__webglTexture),u.memory.textures--),ce.depthTexture&&ce.depthTexture.dispose(),ce.isWebGLCubeRenderTarget)for(let $=0;$<6;$++)r.deleteFramebuffer(J.__webglFramebuffer[$]),J.__webglDepthbuffer&&r.deleteRenderbuffer(J.__webglDepthbuffer[$]);else{if(r.deleteFramebuffer(J.__webglFramebuffer),J.__webglDepthbuffer&&r.deleteRenderbuffer(J.__webglDepthbuffer),J.__webglMultisampledFramebuffer&&r.deleteFramebuffer(J.__webglMultisampledFramebuffer),J.__webglColorRenderbuffer)for(let $=0;$<J.__webglColorRenderbuffer.length;$++)J.__webglColorRenderbuffer[$]&&r.deleteRenderbuffer(J.__webglColorRenderbuffer[$]);J.__webglDepthRenderbuffer&&r.deleteRenderbuffer(J.__webglDepthRenderbuffer)}if(ce.isWebGLMultipleRenderTargets)for(let $=0,me=ae.length;$<me;$++){const Pe=o.get(ae[$]);Pe.__webglTexture&&(r.deleteTexture(Pe.__webglTexture),u.memory.textures--),o.remove(ae[$])}o.remove(ae),o.remove(ce)}let z=0;function X(){z=0}function Z(){const ce=z;return ce>=f&&console.warn("THREE.WebGLTextures: Trying to use "+ce+" texture units while this GPU supports only "+f),z+=1,ce}function ie(ce){const ae=[];return ae.push(ce.wrapS),ae.push(ce.wrapT),ae.push(ce.wrapR||0),ae.push(ce.magFilter),ae.push(ce.minFilter),ae.push(ce.anisotropy),ae.push(ce.internalFormat),ae.push(ce.format),ae.push(ce.type),ae.push(ce.generateMipmaps),ae.push(ce.premultiplyAlpha),ae.push(ce.flipY),ae.push(ce.unpackAlignment),ae.push(ce.encoding),ae.join()}function se(ce,ae){const J=o.get(ce);if(ce.isVideoTexture&&Fe(ce),ce.isRenderTargetTexture===!1&&ce.version>0&&J.__version!==ce.version){const G=ce.image;if(G===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(G.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Qe(J,ce,ae);return}}i.bindTexture(3553,J.__webglTexture,33984+ae)}function ue(ce,ae){const J=o.get(ce);if(ce.version>0&&J.__version!==ce.version){Qe(J,ce,ae);return}i.bindTexture(35866,J.__webglTexture,33984+ae)}function ye(ce,ae){const J=o.get(ce);if(ce.version>0&&J.__version!==ce.version){Qe(J,ce,ae);return}i.bindTexture(32879,J.__webglTexture,33984+ae)}function Ce(ce,ae){const J=o.get(ce);if(ce.version>0&&J.__version!==ce.version){St(J,ce,ae);return}i.bindTexture(34067,J.__webglTexture,33984+ae)}const ke={[FE]:10497,[qo]:33071,[BE]:33648},Oe={[Ss]:9728,[PC]:9984,[_b]:9986,[xo]:9729,[SG]:9985,[vm]:9987};function Ne(ce,ae,J){if(J?(r.texParameteri(ce,10242,ke[ae.wrapS]),r.texParameteri(ce,10243,ke[ae.wrapT]),(ce===32879||ce===35866)&&r.texParameteri(ce,32882,ke[ae.wrapR]),r.texParameteri(ce,10240,Oe[ae.magFilter]),r.texParameteri(ce,10241,Oe[ae.minFilter])):(r.texParameteri(ce,10242,33071),r.texParameteri(ce,10243,33071),(ce===32879||ce===35866)&&r.texParameteri(ce,32882,33071),(ae.wrapS!==qo||ae.wrapT!==qo)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),r.texParameteri(ce,10240,q(ae.magFilter)),r.texParameteri(ce,10241,q(ae.minFilter)),ae.minFilter!==Ss&&ae.minFilter!==xo&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),n.has("EXT_texture_filter_anisotropic")===!0){const G=n.get("EXT_texture_filter_anisotropic");if(ae.magFilter===Ss||ae.minFilter!==_b&&ae.minFilter!==vm||ae.type===wu&&n.has("OES_texture_float_linear")===!1||h===!1&&ae.type===ym&&n.has("OES_texture_half_float_linear")===!1)return;(ae.anisotropy>1||o.get(ae).__currentAnisotropy)&&(r.texParameterf(ce,G.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ae.anisotropy,l.getMaxAnisotropy())),o.get(ae).__currentAnisotropy=ae.anisotropy)}}function He(ce,ae){let J=!1;ce.__webglInit===void 0&&(ce.__webglInit=!0,ae.addEventListener("dispose",le));const G=ae.source;let $=E.get(G);$===void 0&&($={},E.set(G,$));const me=ie(ae);if(me!==ce.__cacheKey){$[me]===void 0&&($[me]={texture:r.createTexture(),usedTimes:0},u.memory.textures++,J=!0),$[me].usedTimes++;const Pe=$[ce.__cacheKey];Pe!==void 0&&($[ce.__cacheKey].usedTimes--,Pe.usedTimes===0&&O(ae)),ce.__cacheKey=me,ce.__webglTexture=$[me].texture}return J}function Qe(ce,ae,J){let G=3553;(ae.isDataArrayTexture||ae.isCompressedArrayTexture)&&(G=35866),ae.isData3DTexture&&(G=32879);const $=He(ce,ae),me=ae.source;i.bindTexture(G,ce.__webglTexture,33984+J);const Pe=o.get(me);if(me.version!==Pe.__version||$===!0){i.activeTexture(33984+J),r.pixelStorei(37440,ae.flipY),r.pixelStorei(37441,ae.premultiplyAlpha),r.pixelStorei(3317,ae.unpackAlignment),r.pixelStorei(37443,0);const ve=L(ae)&&R(ae.image)===!1;let Le=T(ae.image,ve,!1,m);Le=Re(ae,Le);const wt=R(Le)||h,Ot=a.convert(ae.format,ae.encoding);let _t=a.convert(ae.type),Ut=B(ae.internalFormat,Ot,_t,ae.encoding,ae.isVideoTexture);Ne(G,ae,wt);let It;const dn=ae.mipmaps,Un=h&&ae.isVideoTexture!==!0,$n=Pe.__version===void 0||$===!0,Je=H(ae,Le,wt);if(ae.isDepthTexture)Ut=6402,h?ae.type===wu?Ut=36012:ae.type===Au?Ut=33190:ae.type===Fd?Ut=35056:Ut=33189:ae.type===wu&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ae.format===Pu&&Ut===6402&&ae.type!==rO&&ae.type!==Au&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ae.type=Au,_t=a.convert(ae.type)),ae.format===Yd&&Ut===6402&&(Ut=34041,ae.type!==Fd&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ae.type=Fd,_t=a.convert(ae.type))),$n&&(Un?i.texStorage2D(3553,1,Ut,Le.width,Le.height):i.texImage2D(3553,0,Ut,Le.width,Le.height,0,Ot,_t,null));else if(ae.isDataTexture)if(dn.length>0&&wt){Un&&$n&&i.texStorage2D(3553,Je,Ut,dn[0].width,dn[0].height);for(let Ve=0,nt=dn.length;Ve<nt;Ve++)It=dn[Ve],Un?i.texSubImage2D(3553,Ve,0,0,It.width,It.height,Ot,_t,It.data):i.texImage2D(3553,Ve,Ut,It.width,It.height,0,Ot,_t,It.data);ae.generateMipmaps=!1}else Un?($n&&i.texStorage2D(3553,Je,Ut,Le.width,Le.height),i.texSubImage2D(3553,0,0,0,Le.width,Le.height,Ot,_t,Le.data)):i.texImage2D(3553,0,Ut,Le.width,Le.height,0,Ot,_t,Le.data);else if(ae.isCompressedTexture)if(ae.isCompressedArrayTexture){Un&&$n&&i.texStorage3D(35866,Je,Ut,dn[0].width,dn[0].height,Le.depth);for(let Ve=0,nt=dn.length;Ve<nt;Ve++)It=dn[Ve],ae.format!==Yo?Ot!==null?Un?i.compressedTexSubImage3D(35866,Ve,0,0,0,It.width,It.height,Le.depth,Ot,It.data,0,0):i.compressedTexImage3D(35866,Ve,Ut,It.width,It.height,Le.depth,0,It.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Un?i.texSubImage3D(35866,Ve,0,0,0,It.width,It.height,Le.depth,Ot,_t,It.data):i.texImage3D(35866,Ve,Ut,It.width,It.height,Le.depth,0,Ot,_t,It.data)}else{Un&&$n&&i.texStorage2D(3553,Je,Ut,dn[0].width,dn[0].height);for(let Ve=0,nt=dn.length;Ve<nt;Ve++)It=dn[Ve],ae.format!==Yo?Ot!==null?Un?i.compressedTexSubImage2D(3553,Ve,0,0,It.width,It.height,Ot,It.data):i.compressedTexImage2D(3553,Ve,Ut,It.width,It.height,0,It.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Un?i.texSubImage2D(3553,Ve,0,0,It.width,It.height,Ot,_t,It.data):i.texImage2D(3553,Ve,Ut,It.width,It.height,0,Ot,_t,It.data)}else if(ae.isDataArrayTexture)Un?($n&&i.texStorage3D(35866,Je,Ut,Le.width,Le.height,Le.depth),i.texSubImage3D(35866,0,0,0,0,Le.width,Le.height,Le.depth,Ot,_t,Le.data)):i.texImage3D(35866,0,Ut,Le.width,Le.height,Le.depth,0,Ot,_t,Le.data);else if(ae.isData3DTexture)Un?($n&&i.texStorage3D(32879,Je,Ut,Le.width,Le.height,Le.depth),i.texSubImage3D(32879,0,0,0,0,Le.width,Le.height,Le.depth,Ot,_t,Le.data)):i.texImage3D(32879,0,Ut,Le.width,Le.height,Le.depth,0,Ot,_t,Le.data);else if(ae.isFramebufferTexture){if($n)if(Un)i.texStorage2D(3553,Je,Ut,Le.width,Le.height);else{let Ve=Le.width,nt=Le.height;for(let yt=0;yt<Je;yt++)i.texImage2D(3553,yt,Ut,Ve,nt,0,Ot,_t,null),Ve>>=1,nt>>=1}}else if(dn.length>0&&wt){Un&&$n&&i.texStorage2D(3553,Je,Ut,dn[0].width,dn[0].height);for(let Ve=0,nt=dn.length;Ve<nt;Ve++)It=dn[Ve],Un?i.texSubImage2D(3553,Ve,0,0,Ot,_t,It):i.texImage2D(3553,Ve,Ut,Ot,_t,It);ae.generateMipmaps=!1}else Un?($n&&i.texStorage2D(3553,Je,Ut,Le.width,Le.height),i.texSubImage2D(3553,0,0,0,Ot,_t,Le)):i.texImage2D(3553,0,Ut,Ot,_t,Le);I(ae,wt)&&N(G),Pe.__version=me.version,ae.onUpdate&&ae.onUpdate(ae)}ce.__version=ae.version}function St(ce,ae,J){if(ae.image.length!==6)return;const G=He(ce,ae),$=ae.source;i.bindTexture(34067,ce.__webglTexture,33984+J);const me=o.get($);if($.version!==me.__version||G===!0){i.activeTexture(33984+J),r.pixelStorei(37440,ae.flipY),r.pixelStorei(37441,ae.premultiplyAlpha),r.pixelStorei(3317,ae.unpackAlignment),r.pixelStorei(37443,0);const Pe=ae.isCompressedTexture||ae.image[0].isCompressedTexture,ve=ae.image[0]&&ae.image[0].isDataTexture,Le=[];for(let Ve=0;Ve<6;Ve++)!Pe&&!ve?Le[Ve]=T(ae.image[Ve],!1,!0,d):Le[Ve]=ve?ae.image[Ve].image:ae.image[Ve],Le[Ve]=Re(ae,Le[Ve]);const wt=Le[0],Ot=R(wt)||h,_t=a.convert(ae.format,ae.encoding),Ut=a.convert(ae.type),It=B(ae.internalFormat,_t,Ut,ae.encoding),dn=h&&ae.isVideoTexture!==!0,Un=me.__version===void 0||G===!0;let $n=H(ae,wt,Ot);Ne(34067,ae,Ot);let Je;if(Pe){dn&&Un&&i.texStorage2D(34067,$n,It,wt.width,wt.height);for(let Ve=0;Ve<6;Ve++){Je=Le[Ve].mipmaps;for(let nt=0;nt<Je.length;nt++){const yt=Je[nt];ae.format!==Yo?_t!==null?dn?i.compressedTexSubImage2D(34069+Ve,nt,0,0,yt.width,yt.height,_t,yt.data):i.compressedTexImage2D(34069+Ve,nt,It,yt.width,yt.height,0,yt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):dn?i.texSubImage2D(34069+Ve,nt,0,0,yt.width,yt.height,_t,Ut,yt.data):i.texImage2D(34069+Ve,nt,It,yt.width,yt.height,0,_t,Ut,yt.data)}}}else{Je=ae.mipmaps,dn&&Un&&(Je.length>0&&$n++,i.texStorage2D(34067,$n,It,Le[0].width,Le[0].height));for(let Ve=0;Ve<6;Ve++)if(ve){dn?i.texSubImage2D(34069+Ve,0,0,0,Le[Ve].width,Le[Ve].height,_t,Ut,Le[Ve].data):i.texImage2D(34069+Ve,0,It,Le[Ve].width,Le[Ve].height,0,_t,Ut,Le[Ve].data);for(let nt=0;nt<Je.length;nt++){const Wt=Je[nt].image[Ve].image;dn?i.texSubImage2D(34069+Ve,nt+1,0,0,Wt.width,Wt.height,_t,Ut,Wt.data):i.texImage2D(34069+Ve,nt+1,It,Wt.width,Wt.height,0,_t,Ut,Wt.data)}}else{dn?i.texSubImage2D(34069+Ve,0,0,0,_t,Ut,Le[Ve]):i.texImage2D(34069+Ve,0,It,_t,Ut,Le[Ve]);for(let nt=0;nt<Je.length;nt++){const yt=Je[nt];dn?i.texSubImage2D(34069+Ve,nt+1,0,0,_t,Ut,yt.image[Ve]):i.texImage2D(34069+Ve,nt+1,It,_t,Ut,yt.image[Ve])}}}I(ae,Ot)&&N(34067),me.__version=$.version,ae.onUpdate&&ae.onUpdate(ae)}ce.__version=ae.version}function bt(ce,ae,J,G,$){const me=a.convert(J.format,J.encoding),Pe=a.convert(J.type),ve=B(J.internalFormat,me,Pe,J.encoding);o.get(ae).__hasExternalTextures||($===32879||$===35866?i.texImage3D($,0,ve,ae.width,ae.height,ae.depth,0,me,Pe,null):i.texImage2D($,0,ve,ae.width,ae.height,0,me,Pe,null)),i.bindFramebuffer(36160,ce),ge(ae)?x.framebufferTexture2DMultisampleEXT(36160,G,$,o.get(J).__webglTexture,0,pe(ae)):($===3553||$>=34069&&$<=34074)&&r.framebufferTexture2D(36160,G,$,o.get(J).__webglTexture,0),i.bindFramebuffer(36160,null)}function Jt(ce,ae,J){if(r.bindRenderbuffer(36161,ce),ae.depthBuffer&&!ae.stencilBuffer){let G=33189;if(J||ge(ae)){const $=ae.depthTexture;$&&$.isDepthTexture&&($.type===wu?G=36012:$.type===Au&&(G=33190));const me=pe(ae);ge(ae)?x.renderbufferStorageMultisampleEXT(36161,me,G,ae.width,ae.height):r.renderbufferStorageMultisample(36161,me,G,ae.width,ae.height)}else r.renderbufferStorage(36161,G,ae.width,ae.height);r.framebufferRenderbuffer(36160,36096,36161,ce)}else if(ae.depthBuffer&&ae.stencilBuffer){const G=pe(ae);J&&ge(ae)===!1?r.renderbufferStorageMultisample(36161,G,35056,ae.width,ae.height):ge(ae)?x.renderbufferStorageMultisampleEXT(36161,G,35056,ae.width,ae.height):r.renderbufferStorage(36161,34041,ae.width,ae.height),r.framebufferRenderbuffer(36160,33306,36161,ce)}else{const G=ae.isWebGLMultipleRenderTargets===!0?ae.texture:[ae.texture];for(let $=0;$<G.length;$++){const me=G[$],Pe=a.convert(me.format,me.encoding),ve=a.convert(me.type),Le=B(me.internalFormat,Pe,ve,me.encoding),wt=pe(ae);J&&ge(ae)===!1?r.renderbufferStorageMultisample(36161,wt,Le,ae.width,ae.height):ge(ae)?x.renderbufferStorageMultisampleEXT(36161,wt,Le,ae.width,ae.height):r.renderbufferStorage(36161,Le,ae.width,ae.height)}}r.bindRenderbuffer(36161,null)}function sn(ce,ae){if(ae&&ae.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(36160,ce),!(ae.depthTexture&&ae.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!o.get(ae.depthTexture).__webglTexture||ae.depthTexture.image.width!==ae.width||ae.depthTexture.image.height!==ae.height)&&(ae.depthTexture.image.width=ae.width,ae.depthTexture.image.height=ae.height,ae.depthTexture.needsUpdate=!0),se(ae.depthTexture,0);const G=o.get(ae.depthTexture).__webglTexture,$=pe(ae);if(ae.depthTexture.format===Pu)ge(ae)?x.framebufferTexture2DMultisampleEXT(36160,36096,3553,G,0,$):r.framebufferTexture2D(36160,36096,3553,G,0);else if(ae.depthTexture.format===Yd)ge(ae)?x.framebufferTexture2DMultisampleEXT(36160,33306,3553,G,0,$):r.framebufferTexture2D(36160,33306,3553,G,0);else throw new Error("Unknown depthTexture format")}function Se(ce){const ae=o.get(ce),J=ce.isWebGLCubeRenderTarget===!0;if(ce.depthTexture&&!ae.__autoAllocateDepthBuffer){if(J)throw new Error("target.depthTexture not supported in Cube render targets");sn(ae.__webglFramebuffer,ce)}else if(J){ae.__webglDepthbuffer=[];for(let G=0;G<6;G++)i.bindFramebuffer(36160,ae.__webglFramebuffer[G]),ae.__webglDepthbuffer[G]=r.createRenderbuffer(),Jt(ae.__webglDepthbuffer[G],ce,!1)}else i.bindFramebuffer(36160,ae.__webglFramebuffer),ae.__webglDepthbuffer=r.createRenderbuffer(),Jt(ae.__webglDepthbuffer,ce,!1);i.bindFramebuffer(36160,null)}function qe(ce,ae,J){const G=o.get(ce);ae!==void 0&&bt(G.__webglFramebuffer,ce,ce.texture,36064,3553),J!==void 0&&Se(ce)}function Ue(ce){const ae=ce.texture,J=o.get(ce),G=o.get(ae);ce.addEventListener("dispose",ne),ce.isWebGLMultipleRenderTargets!==!0&&(G.__webglTexture===void 0&&(G.__webglTexture=r.createTexture()),G.__version=ae.version,u.memory.textures++);const $=ce.isWebGLCubeRenderTarget===!0,me=ce.isWebGLMultipleRenderTargets===!0,Pe=R(ce)||h;if($){J.__webglFramebuffer=[];for(let ve=0;ve<6;ve++)J.__webglFramebuffer[ve]=r.createFramebuffer()}else{if(J.__webglFramebuffer=r.createFramebuffer(),me)if(l.drawBuffers){const ve=ce.texture;for(let Le=0,wt=ve.length;Le<wt;Le++){const Ot=o.get(ve[Le]);Ot.__webglTexture===void 0&&(Ot.__webglTexture=r.createTexture(),u.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(h&&ce.samples>0&&ge(ce)===!1){const ve=me?ae:[ae];J.__webglMultisampledFramebuffer=r.createFramebuffer(),J.__webglColorRenderbuffer=[],i.bindFramebuffer(36160,J.__webglMultisampledFramebuffer);for(let Le=0;Le<ve.length;Le++){const wt=ve[Le];J.__webglColorRenderbuffer[Le]=r.createRenderbuffer(),r.bindRenderbuffer(36161,J.__webglColorRenderbuffer[Le]);const Ot=a.convert(wt.format,wt.encoding),_t=a.convert(wt.type),Ut=B(wt.internalFormat,Ot,_t,wt.encoding,ce.isXRRenderTarget===!0),It=pe(ce);r.renderbufferStorageMultisample(36161,It,Ut,ce.width,ce.height),r.framebufferRenderbuffer(36160,36064+Le,36161,J.__webglColorRenderbuffer[Le])}r.bindRenderbuffer(36161,null),ce.depthBuffer&&(J.__webglDepthRenderbuffer=r.createRenderbuffer(),Jt(J.__webglDepthRenderbuffer,ce,!0)),i.bindFramebuffer(36160,null)}}if($){i.bindTexture(34067,G.__webglTexture),Ne(34067,ae,Pe);for(let ve=0;ve<6;ve++)bt(J.__webglFramebuffer[ve],ce,ae,36064,34069+ve);I(ae,Pe)&&N(34067),i.unbindTexture()}else if(me){const ve=ce.texture;for(let Le=0,wt=ve.length;Le<wt;Le++){const Ot=ve[Le],_t=o.get(Ot);i.bindTexture(3553,_t.__webglTexture),Ne(3553,Ot,Pe),bt(J.__webglFramebuffer,ce,Ot,36064+Le,3553),I(Ot,Pe)&&N(3553)}i.unbindTexture()}else{let ve=3553;(ce.isWebGL3DRenderTarget||ce.isWebGLArrayRenderTarget)&&(h?ve=ce.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(ve,G.__webglTexture),Ne(ve,ae,Pe),bt(J.__webglFramebuffer,ce,ae,36064,ve),I(ae,Pe)&&N(ve),i.unbindTexture()}ce.depthBuffer&&Se(ce)}function At(ce){const ae=R(ce)||h,J=ce.isWebGLMultipleRenderTargets===!0?ce.texture:[ce.texture];for(let G=0,$=J.length;G<$;G++){const me=J[G];if(I(me,ae)){const Pe=ce.isWebGLCubeRenderTarget?34067:3553,ve=o.get(me).__webglTexture;i.bindTexture(Pe,ve),N(Pe),i.unbindTexture()}}}function tt(ce){if(h&&ce.samples>0&&ge(ce)===!1){const ae=ce.isWebGLMultipleRenderTargets?ce.texture:[ce.texture],J=ce.width,G=ce.height;let $=16384;const me=[],Pe=ce.stencilBuffer?33306:36096,ve=o.get(ce),Le=ce.isWebGLMultipleRenderTargets===!0;if(Le)for(let wt=0;wt<ae.length;wt++)i.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064+wt,36161,null),i.bindFramebuffer(36160,ve.__webglFramebuffer),r.framebufferTexture2D(36009,36064+wt,3553,null,0);i.bindFramebuffer(36008,ve.__webglMultisampledFramebuffer),i.bindFramebuffer(36009,ve.__webglFramebuffer);for(let wt=0;wt<ae.length;wt++){me.push(36064+wt),ce.depthBuffer&&me.push(Pe);const Ot=ve.__ignoreDepthValues!==void 0?ve.__ignoreDepthValues:!1;if(Ot===!1&&(ce.depthBuffer&&($|=256),ce.stencilBuffer&&($|=1024)),Le&&r.framebufferRenderbuffer(36008,36064,36161,ve.__webglColorRenderbuffer[wt]),Ot===!0&&(r.invalidateFramebuffer(36008,[Pe]),r.invalidateFramebuffer(36009,[Pe])),Le){const _t=o.get(ae[wt]).__webglTexture;r.framebufferTexture2D(36009,36064,3553,_t,0)}r.blitFramebuffer(0,0,J,G,0,0,J,G,$,9728),v&&r.invalidateFramebuffer(36008,me)}if(i.bindFramebuffer(36008,null),i.bindFramebuffer(36009,null),Le)for(let wt=0;wt<ae.length;wt++){i.bindFramebuffer(36160,ve.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(36160,36064+wt,36161,ve.__webglColorRenderbuffer[wt]);const Ot=o.get(ae[wt]).__webglTexture;i.bindFramebuffer(36160,ve.__webglFramebuffer),r.framebufferTexture2D(36009,36064+wt,3553,Ot,0)}i.bindFramebuffer(36009,ve.__webglMultisampledFramebuffer)}}function pe(ce){return Math.min(g,ce.samples)}function ge(ce){const ae=o.get(ce);return h&&ce.samples>0&&n.has("WEBGL_multisampled_render_to_texture")===!0&&ae.__useRenderToTexture!==!1}function Fe(ce){const ae=u.render.frame;A.get(ce)!==ae&&(A.set(ce,ae),ce.update())}function Re(ce,ae){const J=ce.encoding,G=ce.format,$=ce.type;return ce.isCompressedTexture===!0||ce.isVideoTexture===!0||ce.format===UE||J!==Gu&&(J===pr?h===!1?n.has("EXT_sRGB")===!0&&G===Yo?(ce.format=UE,ce.minFilter=xo,ce.generateMipmaps=!1):ae=lO.sRGBToLinear(ae):(G!==Yo||$!==Hu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",J)),ae}this.allocateTextureUnit=Z,this.resetTextureUnits=X,this.setTexture2D=se,this.setTexture2DArray=ue,this.setTexture3D=ye,this.setTextureCube=Ce,this.rebindTextures=qe,this.setupRenderTarget=Ue,this.updateRenderTargetMipmap=At,this.updateMultisampleRenderTarget=tt,this.setupDepthRenderbuffer=Se,this.setupFrameBufferTexture=bt,this.useMultisampledRTT=ge}function Nj(r,n,i){const o=i.isWebGL2;function l(a,u=null){let h;if(a===Hu)return 5121;if(a===LG)return 32819;if(a===PG)return 32820;if(a===TG)return 5120;if(a===CG)return 5122;if(a===rO)return 5123;if(a===RG)return 5124;if(a===Au)return 5125;if(a===wu)return 5126;if(a===ym)return o?5131:(h=n.get("OES_texture_half_float"),h!==null?h.HALF_FLOAT_OES:null);if(a===DG)return 6406;if(a===Yo)return 6408;if(a===IG)return 6409;if(a===kG)return 6410;if(a===Pu)return 6402;if(a===Yd)return 34041;if(a===OG)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(a===UE)return h=n.get("EXT_sRGB"),h!==null?h.SRGB_ALPHA_EXT:null;if(a===NG)return 6403;if(a===FG)return 36244;if(a===BG)return 33319;if(a===UG)return 33320;if(a===zG)return 36249;if(a===bb||a===Eb||a===Ab||a===wb)if(u===pr)if(h=n.get("WEBGL_compressed_texture_s3tc_srgb"),h!==null){if(a===bb)return h.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(a===Eb)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(a===Ab)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(a===wb)return h.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(h=n.get("WEBGL_compressed_texture_s3tc"),h!==null){if(a===bb)return h.COMPRESSED_RGB_S3TC_DXT1_EXT;if(a===Eb)return h.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(a===Ab)return h.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(a===wb)return h.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(a===DC||a===OC||a===IC||a===kC)if(h=n.get("WEBGL_compressed_texture_pvrtc"),h!==null){if(a===DC)return h.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(a===OC)return h.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(a===IC)return h.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(a===kC)return h.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(a===HG)return h=n.get("WEBGL_compressed_texture_etc1"),h!==null?h.COMPRESSED_RGB_ETC1_WEBGL:null;if(a===NC||a===FC)if(h=n.get("WEBGL_compressed_texture_etc"),h!==null){if(a===NC)return u===pr?h.COMPRESSED_SRGB8_ETC2:h.COMPRESSED_RGB8_ETC2;if(a===FC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:h.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(a===BC||a===UC||a===zC||a===HC||a===GC||a===VC||a===WC||a===jC||a===$C||a===XC||a===qC||a===YC||a===KC||a===QC)if(h=n.get("WEBGL_compressed_texture_astc"),h!==null){if(a===BC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:h.COMPRESSED_RGBA_ASTC_4x4_KHR;if(a===UC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:h.COMPRESSED_RGBA_ASTC_5x4_KHR;if(a===zC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:h.COMPRESSED_RGBA_ASTC_5x5_KHR;if(a===HC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:h.COMPRESSED_RGBA_ASTC_6x5_KHR;if(a===GC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:h.COMPRESSED_RGBA_ASTC_6x6_KHR;if(a===VC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:h.COMPRESSED_RGBA_ASTC_8x5_KHR;if(a===WC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:h.COMPRESSED_RGBA_ASTC_8x6_KHR;if(a===jC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:h.COMPRESSED_RGBA_ASTC_8x8_KHR;if(a===$C)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:h.COMPRESSED_RGBA_ASTC_10x5_KHR;if(a===XC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:h.COMPRESSED_RGBA_ASTC_10x6_KHR;if(a===qC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:h.COMPRESSED_RGBA_ASTC_10x8_KHR;if(a===YC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:h.COMPRESSED_RGBA_ASTC_10x10_KHR;if(a===KC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:h.COMPRESSED_RGBA_ASTC_12x10_KHR;if(a===QC)return u===pr?h.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:h.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(a===ZC)if(h=n.get("EXT_texture_compression_bptc"),h!==null){if(a===ZC)return u===pr?h.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:h.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return a===Fd?o?34042:(h=n.get("WEBGL_depth_texture"),h!==null?h.UNSIGNED_INT_24_8_WEBGL:null):r[a]!==void 0?r[a]:null}return{convert:l}}class Fj extends _o{constructor(n=[]){super(),this.isArrayCamera=!0,this.cameras=n}}class Sd extends ls{constructor(){super(),this.isGroup=!0,this.type="Group"}}const Bj={type:"move"};class Qb{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Sd,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Sd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new it,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new it),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Sd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new it,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new it),this._grip}dispatchEvent(n){return this._targetRay!==null&&this._targetRay.dispatchEvent(n),this._grip!==null&&this._grip.dispatchEvent(n),this._hand!==null&&this._hand.dispatchEvent(n),this}connect(n){if(n&&n.hand){const i=this._hand;if(i)for(const o of n.hand.values())this._getHandJoint(i,o)}return this.dispatchEvent({type:"connected",data:n}),this}disconnect(n){return this.dispatchEvent({type:"disconnected",data:n}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(n,i,o){let l=null,a=null,u=null;const h=this._targetRay,f=this._grip,d=this._hand;if(n&&i.session.visibilityState!=="visible-blurred"){if(d&&n.hand){u=!0;for(const _ of n.hand.values()){const E=i.getJointPose(_,o),w=this._getHandJoint(d,_);E!==null&&(w.matrix.fromArray(E.transform.matrix),w.matrix.decompose(w.position,w.rotation,w.scale),w.jointRadius=E.radius),w.visible=E!==null}const m=d.joints["index-finger-tip"],g=d.joints["thumb-tip"],x=m.position.distanceTo(g.position),v=.02,A=.005;d.inputState.pinching&&x>v+A?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:n.handedness,target:this})):!d.inputState.pinching&&x<=v-A&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:n.handedness,target:this}))}else f!==null&&n.gripSpace&&(a=i.getPose(n.gripSpace,o),a!==null&&(f.matrix.fromArray(a.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),a.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(a.linearVelocity)):f.hasLinearVelocity=!1,a.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(a.angularVelocity)):f.hasAngularVelocity=!1));h!==null&&(l=i.getPose(n.targetRaySpace,o),l===null&&a!==null&&(l=a),l!==null&&(h.matrix.fromArray(l.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),l.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(l.linearVelocity)):h.hasLinearVelocity=!1,l.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(l.angularVelocity)):h.hasAngularVelocity=!1,this.dispatchEvent(Bj)))}return h!==null&&(h.visible=l!==null),f!==null&&(f.visible=a!==null),d!==null&&(d.visible=u!==null),this}_getHandJoint(n,i){if(n.joints[i.jointName]===void 0){const o=new Sd;o.matrixAutoUpdate=!1,o.visible=!1,n.joints[i.jointName]=o,n.add(o)}return n.joints[i.jointName]}}class Uj extends Gs{constructor(n,i,o,l,a,u,h,f,d,m){if(m=m!==void 0?m:Pu,m!==Pu&&m!==Yd)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");o===void 0&&m===Pu&&(o=Au),o===void 0&&m===Yd&&(o=Fd),super(null,l,a,u,h,f,m,o,d),this.isDepthTexture=!0,this.image={width:n,height:i},this.magFilter=h!==void 0?h:Ss,this.minFilter=f!==void 0?f:Ss,this.flipY=!1,this.generateMipmaps=!1}}class zj extends ra{constructor(n,i){super();const o=this;let l=null,a=1,u=null,h="local-floor",f=null,d=null,m=null,g=null,x=null,v=null;const A=i.getContextAttributes();let _=null,E=null;const w=[],S=[],T=new Set,R=new Map,L=new _o;L.layers.enable(1),L.viewport=new ts;const I=new _o;I.layers.enable(2),I.viewport=new ts;const N=[L,I],B=new Fj;B.layers.enable(1),B.layers.enable(2);let H=null,q=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(ue){let ye=w[ue];return ye===void 0&&(ye=new Qb,w[ue]=ye),ye.getTargetRaySpace()},this.getControllerGrip=function(ue){let ye=w[ue];return ye===void 0&&(ye=new Qb,w[ue]=ye),ye.getGripSpace()},this.getHand=function(ue){let ye=w[ue];return ye===void 0&&(ye=new Qb,w[ue]=ye),ye.getHandSpace()};function le(ue){const ye=S.indexOf(ue.inputSource);if(ye===-1)return;const Ce=w[ye];Ce!==void 0&&Ce.dispatchEvent({type:ue.type,data:ue.inputSource})}function ne(){l.removeEventListener("select",le),l.removeEventListener("selectstart",le),l.removeEventListener("selectend",le),l.removeEventListener("squeeze",le),l.removeEventListener("squeezestart",le),l.removeEventListener("squeezeend",le),l.removeEventListener("end",ne),l.removeEventListener("inputsourceschange",D);for(let ue=0;ue<w.length;ue++){const ye=S[ue];ye!==null&&(S[ue]=null,w[ue].disconnect(ye))}H=null,q=null,n.setRenderTarget(_),x=null,g=null,m=null,l=null,E=null,se.stop(),o.isPresenting=!1,o.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(ue){a=ue,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ue){h=ue,o.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f||u},this.setReferenceSpace=function(ue){f=ue},this.getBaseLayer=function(){return g!==null?g:x},this.getBinding=function(){return m},this.getFrame=function(){return v},this.getSession=function(){return l},this.setSession=async function(ue){if(l=ue,l!==null){if(_=n.getRenderTarget(),l.addEventListener("select",le),l.addEventListener("selectstart",le),l.addEventListener("selectend",le),l.addEventListener("squeeze",le),l.addEventListener("squeezestart",le),l.addEventListener("squeezeend",le),l.addEventListener("end",ne),l.addEventListener("inputsourceschange",D),A.xrCompatible!==!0&&await i.makeXRCompatible(),l.renderState.layers===void 0||n.capabilities.isWebGL2===!1){const ye={antialias:l.renderState.layers===void 0?A.antialias:!0,alpha:A.alpha,depth:A.depth,stencil:A.stencil,framebufferScaleFactor:a};x=new XRWebGLLayer(l,i,ye),l.updateRenderState({baseLayer:x}),E=new Tc(x.framebufferWidth,x.framebufferHeight,{format:Yo,type:Hu,encoding:n.outputEncoding,stencilBuffer:A.stencil})}else{let ye=null,Ce=null,ke=null;A.depth&&(ke=A.stencil?35056:33190,ye=A.stencil?Yd:Pu,Ce=A.stencil?Fd:Au);const Oe={colorFormat:32856,depthFormat:ke,scaleFactor:a};m=new XRWebGLBinding(l,i),g=m.createProjectionLayer(Oe),l.updateRenderState({layers:[g]}),E=new Tc(g.textureWidth,g.textureHeight,{format:Yo,type:Hu,depthTexture:new Uj(g.textureWidth,g.textureHeight,Ce,void 0,void 0,void 0,void 0,void 0,void 0,ye),stencilBuffer:A.stencil,encoding:n.outputEncoding,samples:A.antialias?4:0});const Ne=n.properties.get(E);Ne.__ignoreDepthValues=g.ignoreDepthValues}E.isXRRenderTarget=!0,this.setFoveation(1),f=null,u=await l.requestReferenceSpace(h),se.setContext(l),se.start(),o.isPresenting=!0,o.dispatchEvent({type:"sessionstart"})}};function D(ue){for(let ye=0;ye<ue.removed.length;ye++){const Ce=ue.removed[ye],ke=S.indexOf(Ce);ke>=0&&(S[ke]=null,w[ke].disconnect(Ce))}for(let ye=0;ye<ue.added.length;ye++){const Ce=ue.added[ye];let ke=S.indexOf(Ce);if(ke===-1){for(let Ne=0;Ne<w.length;Ne++)if(Ne>=S.length){S.push(Ce),ke=Ne;break}else if(S[Ne]===null){S[Ne]=Ce,ke=Ne;break}if(ke===-1)break}const Oe=w[ke];Oe&&Oe.connect(Ce)}}const O=new it,k=new it;function z(ue,ye,Ce){O.setFromMatrixPosition(ye.matrixWorld),k.setFromMatrixPosition(Ce.matrixWorld);const ke=O.distanceTo(k),Oe=ye.projectionMatrix.elements,Ne=Ce.projectionMatrix.elements,He=Oe[14]/(Oe[10]-1),Qe=Oe[14]/(Oe[10]+1),St=(Oe[9]+1)/Oe[5],bt=(Oe[9]-1)/Oe[5],Jt=(Oe[8]-1)/Oe[0],sn=(Ne[8]+1)/Ne[0],Se=He*Jt,qe=He*sn,Ue=ke/(-Jt+sn),At=Ue*-Jt;ye.matrixWorld.decompose(ue.position,ue.quaternion,ue.scale),ue.translateX(At),ue.translateZ(Ue),ue.matrixWorld.compose(ue.position,ue.quaternion,ue.scale),ue.matrixWorldInverse.copy(ue.matrixWorld).invert();const tt=He+Ue,pe=Qe+Ue,ge=Se-At,Fe=qe+(ke-At),Re=St*Qe/pe*tt,ce=bt*Qe/pe*tt;ue.projectionMatrix.makePerspective(ge,Fe,Re,ce,tt,pe)}function X(ue,ye){ye===null?ue.matrixWorld.copy(ue.matrix):ue.matrixWorld.multiplyMatrices(ye.matrixWorld,ue.matrix),ue.matrixWorldInverse.copy(ue.matrixWorld).invert()}this.updateCamera=function(ue){if(l===null)return;B.near=I.near=L.near=ue.near,B.far=I.far=L.far=ue.far,(H!==B.near||q!==B.far)&&(l.updateRenderState({depthNear:B.near,depthFar:B.far}),H=B.near,q=B.far);const ye=ue.parent,Ce=B.cameras;X(B,ye);for(let Oe=0;Oe<Ce.length;Oe++)X(Ce[Oe],ye);B.matrixWorld.decompose(B.position,B.quaternion,B.scale),ue.matrix.copy(B.matrix),ue.matrix.decompose(ue.position,ue.quaternion,ue.scale);const ke=ue.children;for(let Oe=0,Ne=ke.length;Oe<Ne;Oe++)ke[Oe].updateMatrixWorld(!0);Ce.length===2?z(B,L,I):B.projectionMatrix.copy(L.projectionMatrix)},this.getCamera=function(){return B},this.getFoveation=function(){if(g!==null)return g.fixedFoveation;if(x!==null)return x.fixedFoveation},this.setFoveation=function(ue){g!==null&&(g.fixedFoveation=ue),x!==null&&x.fixedFoveation!==void 0&&(x.fixedFoveation=ue)},this.getPlanes=function(){return T};let Z=null;function ie(ue,ye){if(d=ye.getViewerPose(f||u),v=ye,d!==null){const Ce=d.views;x!==null&&(n.setRenderTargetFramebuffer(E,x.framebuffer),n.setRenderTarget(E));let ke=!1;Ce.length!==B.cameras.length&&(B.cameras.length=0,ke=!0);for(let Oe=0;Oe<Ce.length;Oe++){const Ne=Ce[Oe];let He=null;if(x!==null)He=x.getViewport(Ne);else{const St=m.getViewSubImage(g,Ne);He=St.viewport,Oe===0&&(n.setRenderTargetTextures(E,St.colorTexture,g.ignoreDepthValues?void 0:St.depthStencilTexture),n.setRenderTarget(E))}let Qe=N[Oe];Qe===void 0&&(Qe=new _o,Qe.layers.enable(Oe),Qe.viewport=new ts,N[Oe]=Qe),Qe.matrix.fromArray(Ne.transform.matrix),Qe.projectionMatrix.fromArray(Ne.projectionMatrix),Qe.viewport.set(He.x,He.y,He.width,He.height),Oe===0&&B.matrix.copy(Qe.matrix),ke===!0&&B.cameras.push(Qe)}}for(let Ce=0;Ce<w.length;Ce++){const ke=S[Ce],Oe=w[Ce];ke!==null&&Oe!==void 0&&Oe.update(ke,ye,f||u)}if(Z&&Z(ue,ye),ye.detectedPlanes){o.dispatchEvent({type:"planesdetected",data:ye.detectedPlanes});let Ce=null;for(const ke of T)ye.detectedPlanes.has(ke)||(Ce===null&&(Ce=[]),Ce.push(ke));if(Ce!==null)for(const ke of Ce)T.delete(ke),R.delete(ke),o.dispatchEvent({type:"planeremoved",data:ke});for(const ke of ye.detectedPlanes)if(!T.has(ke))T.add(ke),R.set(ke,ye.lastChangedTime),o.dispatchEvent({type:"planeadded",data:ke});else{const Oe=R.get(ke);ke.lastChangedTime>Oe&&(R.set(ke,ke.lastChangedTime),o.dispatchEvent({type:"planechanged",data:ke}))}}v=null}const se=new vO;se.setAnimationLoop(ie),this.setAnimationLoop=function(ue){Z=ue},this.dispose=function(){}}}function Hj(r,n){function i(_,E){E.color.getRGB(_.fogColor.value,fO(r)),E.isFog?(_.fogNear.value=E.near,_.fogFar.value=E.far):E.isFogExp2&&(_.fogDensity.value=E.density)}function o(_,E,w,S,T){E.isMeshBasicMaterial||E.isMeshLambertMaterial?l(_,E):E.isMeshToonMaterial?(l(_,E),m(_,E)):E.isMeshPhongMaterial?(l(_,E),d(_,E)):E.isMeshStandardMaterial?(l(_,E),g(_,E),E.isMeshPhysicalMaterial&&x(_,E,T)):E.isMeshMatcapMaterial?(l(_,E),v(_,E)):E.isMeshDepthMaterial?l(_,E):E.isMeshDistanceMaterial?(l(_,E),A(_,E)):E.isMeshNormalMaterial?l(_,E):E.isLineBasicMaterial?(a(_,E),E.isLineDashedMaterial&&u(_,E)):E.isPointsMaterial?h(_,E,w,S):E.isSpriteMaterial?f(_,E):E.isShadowMaterial?(_.color.value.copy(E.color),_.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}function l(_,E){_.opacity.value=E.opacity,E.color&&_.diffuse.value.copy(E.color),E.emissive&&_.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(_.map.value=E.map),E.alphaMap&&(_.alphaMap.value=E.alphaMap),E.bumpMap&&(_.bumpMap.value=E.bumpMap,_.bumpScale.value=E.bumpScale,E.side===ro&&(_.bumpScale.value*=-1)),E.displacementMap&&(_.displacementMap.value=E.displacementMap,_.displacementScale.value=E.displacementScale,_.displacementBias.value=E.displacementBias),E.emissiveMap&&(_.emissiveMap.value=E.emissiveMap),E.normalMap&&(_.normalMap.value=E.normalMap,_.normalScale.value.copy(E.normalScale),E.side===ro&&_.normalScale.value.negate()),E.specularMap&&(_.specularMap.value=E.specularMap),E.alphaTest>0&&(_.alphaTest.value=E.alphaTest);const w=n.get(E).envMap;if(w&&(_.envMap.value=w,_.flipEnvMap.value=w.isCubeTexture&&w.isRenderTargetTexture===!1?-1:1,_.reflectivity.value=E.reflectivity,_.ior.value=E.ior,_.refractionRatio.value=E.refractionRatio),E.lightMap){_.lightMap.value=E.lightMap;const R=r.physicallyCorrectLights!==!0?Math.PI:1;_.lightMapIntensity.value=E.lightMapIntensity*R}E.aoMap&&(_.aoMap.value=E.aoMap,_.aoMapIntensity.value=E.aoMapIntensity);let S;E.map?S=E.map:E.specularMap?S=E.specularMap:E.displacementMap?S=E.displacementMap:E.normalMap?S=E.normalMap:E.bumpMap?S=E.bumpMap:E.roughnessMap?S=E.roughnessMap:E.metalnessMap?S=E.metalnessMap:E.alphaMap?S=E.alphaMap:E.emissiveMap?S=E.emissiveMap:E.clearcoatMap?S=E.clearcoatMap:E.clearcoatNormalMap?S=E.clearcoatNormalMap:E.clearcoatRoughnessMap?S=E.clearcoatRoughnessMap:E.iridescenceMap?S=E.iridescenceMap:E.iridescenceThicknessMap?S=E.iridescenceThicknessMap:E.specularIntensityMap?S=E.specularIntensityMap:E.specularColorMap?S=E.specularColorMap:E.transmissionMap?S=E.transmissionMap:E.thicknessMap?S=E.thicknessMap:E.sheenColorMap?S=E.sheenColorMap:E.sheenRoughnessMap&&(S=E.sheenRoughnessMap),S!==void 0&&(S.isWebGLRenderTarget&&(S=S.texture),S.matrixAutoUpdate===!0&&S.updateMatrix(),_.uvTransform.value.copy(S.matrix));let T;E.aoMap?T=E.aoMap:E.lightMap&&(T=E.lightMap),T!==void 0&&(T.isWebGLRenderTarget&&(T=T.texture),T.matrixAutoUpdate===!0&&T.updateMatrix(),_.uv2Transform.value.copy(T.matrix))}function a(_,E){_.diffuse.value.copy(E.color),_.opacity.value=E.opacity}function u(_,E){_.dashSize.value=E.dashSize,_.totalSize.value=E.dashSize+E.gapSize,_.scale.value=E.scale}function h(_,E,w,S){_.diffuse.value.copy(E.color),_.opacity.value=E.opacity,_.size.value=E.size*w,_.scale.value=S*.5,E.map&&(_.map.value=E.map),E.alphaMap&&(_.alphaMap.value=E.alphaMap),E.alphaTest>0&&(_.alphaTest.value=E.alphaTest);let T;E.map?T=E.map:E.alphaMap&&(T=E.alphaMap),T!==void 0&&(T.matrixAutoUpdate===!0&&T.updateMatrix(),_.uvTransform.value.copy(T.matrix))}function f(_,E){_.diffuse.value.copy(E.color),_.opacity.value=E.opacity,_.rotation.value=E.rotation,E.map&&(_.map.value=E.map),E.alphaMap&&(_.alphaMap.value=E.alphaMap),E.alphaTest>0&&(_.alphaTest.value=E.alphaTest);let w;E.map?w=E.map:E.alphaMap&&(w=E.alphaMap),w!==void 0&&(w.matrixAutoUpdate===!0&&w.updateMatrix(),_.uvTransform.value.copy(w.matrix))}function d(_,E){_.specular.value.copy(E.specular),_.shininess.value=Math.max(E.shininess,1e-4)}function m(_,E){E.gradientMap&&(_.gradientMap.value=E.gradientMap)}function g(_,E){_.roughness.value=E.roughness,_.metalness.value=E.metalness,E.roughnessMap&&(_.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(_.metalnessMap.value=E.metalnessMap),n.get(E).envMap&&(_.envMapIntensity.value=E.envMapIntensity)}function x(_,E,w){_.ior.value=E.ior,E.sheen>0&&(_.sheenColor.value.copy(E.sheenColor).multiplyScalar(E.sheen),_.sheenRoughness.value=E.sheenRoughness,E.sheenColorMap&&(_.sheenColorMap.value=E.sheenColorMap),E.sheenRoughnessMap&&(_.sheenRoughnessMap.value=E.sheenRoughnessMap)),E.clearcoat>0&&(_.clearcoat.value=E.clearcoat,_.clearcoatRoughness.value=E.clearcoatRoughness,E.clearcoatMap&&(_.clearcoatMap.value=E.clearcoatMap),E.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap.value=E.clearcoatRoughnessMap),E.clearcoatNormalMap&&(_.clearcoatNormalScale.value.copy(E.clearcoatNormalScale),_.clearcoatNormalMap.value=E.clearcoatNormalMap,E.side===ro&&_.clearcoatNormalScale.value.negate())),E.iridescence>0&&(_.iridescence.value=E.iridescence,_.iridescenceIOR.value=E.iridescenceIOR,_.iridescenceThicknessMinimum.value=E.iridescenceThicknessRange[0],_.iridescenceThicknessMaximum.value=E.iridescenceThicknessRange[1],E.iridescenceMap&&(_.iridescenceMap.value=E.iridescenceMap),E.iridescenceThicknessMap&&(_.iridescenceThicknessMap.value=E.iridescenceThicknessMap)),E.transmission>0&&(_.transmission.value=E.transmission,_.transmissionSamplerMap.value=w.texture,_.transmissionSamplerSize.value.set(w.width,w.height),E.transmissionMap&&(_.transmissionMap.value=E.transmissionMap),_.thickness.value=E.thickness,E.thicknessMap&&(_.thicknessMap.value=E.thicknessMap),_.attenuationDistance.value=E.attenuationDistance,_.attenuationColor.value.copy(E.attenuationColor)),_.specularIntensity.value=E.specularIntensity,_.specularColor.value.copy(E.specularColor),E.specularIntensityMap&&(_.specularIntensityMap.value=E.specularIntensityMap),E.specularColorMap&&(_.specularColorMap.value=E.specularColorMap)}function v(_,E){E.matcap&&(_.matcap.value=E.matcap)}function A(_,E){_.referencePosition.value.copy(E.referencePosition),_.nearDistance.value=E.nearDistance,_.farDistance.value=E.farDistance}return{refreshFogUniforms:i,refreshMaterialUniforms:o}}function Gj(r,n,i,o){let l={},a={},u=[];const h=i.isWebGL2?r.getParameter(35375):0;function f(S,T){const R=T.program;o.uniformBlockBinding(S,R)}function d(S,T){let R=l[S.id];R===void 0&&(A(S),R=m(S),l[S.id]=R,S.addEventListener("dispose",E));const L=T.program;o.updateUBOMapping(S,L);const I=n.render.frame;a[S.id]!==I&&(x(S),a[S.id]=I)}function m(S){const T=g();S.__bindingPointIndex=T;const R=r.createBuffer(),L=S.__size,I=S.usage;return r.bindBuffer(35345,R),r.bufferData(35345,L,I),r.bindBuffer(35345,null),r.bindBufferBase(35345,T,R),R}function g(){for(let S=0;S<h;S++)if(u.indexOf(S)===-1)return u.push(S),S;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function x(S){const T=l[S.id],R=S.uniforms,L=S.__cache;r.bindBuffer(35345,T);for(let I=0,N=R.length;I<N;I++){const B=R[I];if(v(B,I,L)===!0){const H=B.__offset,q=Array.isArray(B.value)?B.value:[B.value];let le=0;for(let ne=0;ne<q.length;ne++){const D=q[ne],O=_(D);typeof D=="number"?(B.__data[0]=D,r.bufferSubData(35345,H+le,B.__data)):D.isMatrix3?(B.__data[0]=D.elements[0],B.__data[1]=D.elements[1],B.__data[2]=D.elements[2],B.__data[3]=D.elements[0],B.__data[4]=D.elements[3],B.__data[5]=D.elements[4],B.__data[6]=D.elements[5],B.__data[7]=D.elements[0],B.__data[8]=D.elements[6],B.__data[9]=D.elements[7],B.__data[10]=D.elements[8],B.__data[11]=D.elements[0]):(D.toArray(B.__data,le),le+=O.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(35345,H,B.__data)}}r.bindBuffer(35345,null)}function v(S,T,R){const L=S.value;if(R[T]===void 0){if(typeof L=="number")R[T]=L;else{const I=Array.isArray(L)?L:[L],N=[];for(let B=0;B<I.length;B++)N.push(I[B].clone());R[T]=N}return!0}else if(typeof L=="number"){if(R[T]!==L)return R[T]=L,!0}else{const I=Array.isArray(R[T])?R[T]:[R[T]],N=Array.isArray(L)?L:[L];for(let B=0;B<I.length;B++){const H=I[B];if(H.equals(N[B])===!1)return H.copy(N[B]),!0}}return!1}function A(S){const T=S.uniforms;let R=0;const L=16;let I=0;for(let N=0,B=T.length;N<B;N++){const H=T[N],q={boundary:0,storage:0},le=Array.isArray(H.value)?H.value:[H.value];for(let ne=0,D=le.length;ne<D;ne++){const O=le[ne],k=_(O);q.boundary+=k.boundary,q.storage+=k.storage}if(H.__data=new Float32Array(q.storage/Float32Array.BYTES_PER_ELEMENT),H.__offset=R,N>0){I=R%L;const ne=L-I;I!==0&&ne-q.boundary<0&&(R+=L-I,H.__offset=R)}R+=q.storage}return I=R%L,I>0&&(R+=L-I),S.__size=R,S.__cache={},this}function _(S){const T={boundary:0,storage:0};return typeof S=="number"?(T.boundary=4,T.storage=4):S.isVector2?(T.boundary=8,T.storage=8):S.isVector3||S.isColor?(T.boundary=16,T.storage=12):S.isVector4?(T.boundary=16,T.storage=16):S.isMatrix3?(T.boundary=48,T.storage=48):S.isMatrix4?(T.boundary=64,T.storage=64):S.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",S),T}function E(S){const T=S.target;T.removeEventListener("dispose",E);const R=u.indexOf(T.__bindingPointIndex);u.splice(R,1),r.deleteBuffer(l[T.id]),delete l[T.id],delete a[T.id]}function w(){for(const S in l)r.deleteBuffer(l[S]);u=[],l={},a={}}return{bind:f,update:d,dispose:w}}function Vj(){const r=_m("canvas");return r.style.display="block",r}function EO(r={}){this.isWebGLRenderer=!0;const n=r.canvas!==void 0?r.canvas:Vj(),i=r.context!==void 0?r.context:null,o=r.depth!==void 0?r.depth:!0,l=r.stencil!==void 0?r.stencil:!0,a=r.antialias!==void 0?r.antialias:!1,u=r.premultipliedAlpha!==void 0?r.premultipliedAlpha:!0,h=r.preserveDrawingBuffer!==void 0?r.preserveDrawingBuffer:!1,f=r.powerPreference!==void 0?r.powerPreference:"default",d=r.failIfMajorPerformanceCaveat!==void 0?r.failIfMajorPerformanceCaveat:!1;let m;i!==null?m=i.getContextAttributes().alpha:m=r.alpha!==void 0?r.alpha:!1;let g=null,x=null;const v=[],A=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Gu,this.physicallyCorrectLights=!1,this.toneMapping=gl,this.toneMappingExposure=1;const _=this;let E=!1,w=0,S=0,T=null,R=-1,L=null;const I=new ts,N=new ts;let B=null,H=n.width,q=n.height,le=1,ne=null,D=null;const O=new ts(0,0,H,q),k=new ts(0,0,H,q);let z=!1;const X=new Sw;let Z=!1,ie=!1,se=null;const ue=new Er,ye=new Rn,Ce=new it,ke={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Oe(){return T===null?le:1}let Ne=i;function He(ze,at){for(let Pt=0;Pt<ze.length;Pt++){const ft=ze[Pt],Ht=n.getContext(ft,at);if(Ht!==null)return Ht}return null}try{const ze={alpha:!0,depth:o,stencil:l,antialias:a,premultipliedAlpha:u,preserveDrawingBuffer:h,powerPreference:f,failIfMajorPerformanceCaveat:d};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${_w}`),n.addEventListener("webglcontextlost",Ut,!1),n.addEventListener("webglcontextrestored",It,!1),n.addEventListener("webglcontextcreationerror",dn,!1),Ne===null){const at=["webgl2","webgl","experimental-webgl"];if(_.isWebGL1Renderer===!0&&at.shift(),Ne=He(at,ze),Ne===null)throw He(at)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Ne.getShaderPrecisionFormat===void 0&&(Ne.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ze){throw console.error("THREE.WebGLRenderer: "+ze.message),ze}let Qe,St,bt,Jt,sn,Se,qe,Ue,At,tt,pe,ge,Fe,Re,ce,ae,J,G,$,me,Pe,ve,Le,wt;function Ot(){Qe=new eW(Ne),St=new q9(Ne,Qe,r),Qe.init(St),ve=new Nj(Ne,Qe,St),bt=new Ij(Ne,Qe,St),Jt=new iW,sn=new _j,Se=new kj(Ne,Qe,bt,sn,St,ve,Jt),qe=new K9(_),Ue=new J9(_),At=new dV(Ne,St),Le=new $9(Ne,Qe,At,St),tt=new tW(Ne,At,Jt,Le),pe=new aW(Ne,tt,At,Jt),$=new oW(Ne,St,Se),ae=new Y9(sn),ge=new xj(_,qe,Ue,Qe,St,Le,ae),Fe=new Hj(_,sn),Re=new Ej,ce=new Cj(Qe,St),G=new j9(_,qe,Ue,bt,pe,m,u),J=new Oj(_,pe,St),wt=new Gj(Ne,Jt,St,bt),me=new X9(Ne,Qe,Jt,St),Pe=new nW(Ne,Qe,Jt,St),Jt.programs=ge.programs,_.capabilities=St,_.extensions=Qe,_.properties=sn,_.renderLists=Re,_.shadowMap=J,_.state=bt,_.info=Jt}Ot();const _t=new zj(_,Ne);this.xr=_t,this.getContext=function(){return Ne},this.getContextAttributes=function(){return Ne.getContextAttributes()},this.forceContextLoss=function(){const ze=Qe.get("WEBGL_lose_context");ze&&ze.loseContext()},this.forceContextRestore=function(){const ze=Qe.get("WEBGL_lose_context");ze&&ze.restoreContext()},this.getPixelRatio=function(){return le},this.setPixelRatio=function(ze){ze!==void 0&&(le=ze,this.setSize(H,q,!1))},this.getSize=function(ze){return ze.set(H,q)},this.setSize=function(ze,at,Pt){if(_t.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}H=ze,q=at,n.width=Math.floor(ze*le),n.height=Math.floor(at*le),Pt!==!1&&(n.style.width=ze+"px",n.style.height=at+"px"),this.setViewport(0,0,ze,at)},this.getDrawingBufferSize=function(ze){return ze.set(H*le,q*le).floor()},this.setDrawingBufferSize=function(ze,at,Pt){H=ze,q=at,le=Pt,n.width=Math.floor(ze*Pt),n.height=Math.floor(at*Pt),this.setViewport(0,0,ze,at)},this.getCurrentViewport=function(ze){return ze.copy(I)},this.getViewport=function(ze){return ze.copy(O)},this.setViewport=function(ze,at,Pt,ft){ze.isVector4?O.set(ze.x,ze.y,ze.z,ze.w):O.set(ze,at,Pt,ft),bt.viewport(I.copy(O).multiplyScalar(le).floor())},this.getScissor=function(ze){return ze.copy(k)},this.setScissor=function(ze,at,Pt,ft){ze.isVector4?k.set(ze.x,ze.y,ze.z,ze.w):k.set(ze,at,Pt,ft),bt.scissor(N.copy(k).multiplyScalar(le).floor())},this.getScissorTest=function(){return z},this.setScissorTest=function(ze){bt.setScissorTest(z=ze)},this.setOpaqueSort=function(ze){ne=ze},this.setTransparentSort=function(ze){D=ze},this.getClearColor=function(ze){return ze.copy(G.getClearColor())},this.setClearColor=function(){G.setClearColor.apply(G,arguments)},this.getClearAlpha=function(){return G.getClearAlpha()},this.setClearAlpha=function(){G.setClearAlpha.apply(G,arguments)},this.clear=function(ze=!0,at=!0,Pt=!0){let ft=0;ze&&(ft|=16384),at&&(ft|=256),Pt&&(ft|=1024),Ne.clear(ft)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",Ut,!1),n.removeEventListener("webglcontextrestored",It,!1),n.removeEventListener("webglcontextcreationerror",dn,!1),Re.dispose(),ce.dispose(),sn.dispose(),qe.dispose(),Ue.dispose(),pe.dispose(),Le.dispose(),wt.dispose(),ge.dispose(),_t.dispose(),_t.removeEventListener("sessionstart",yt),_t.removeEventListener("sessionend",Wt),se&&(se.dispose(),se=null),pn.stop()};function Ut(ze){ze.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),E=!0}function It(){console.log("THREE.WebGLRenderer: Context Restored."),E=!1;const ze=Jt.autoReset,at=J.enabled,Pt=J.autoUpdate,ft=J.needsUpdate,Ht=J.type;Ot(),Jt.autoReset=ze,J.enabled=at,J.autoUpdate=Pt,J.needsUpdate=ft,J.type=Ht}function dn(ze){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ze.statusMessage)}function Un(ze){const at=ze.target;at.removeEventListener("dispose",Un),$n(at)}function $n(ze){Je(ze),sn.remove(ze)}function Je(ze){const at=sn.get(ze).programs;at!==void 0&&(at.forEach(function(Pt){ge.releaseProgram(Pt)}),ze.isShaderMaterial&&ge.releaseShaderCache(ze))}this.renderBufferDirect=function(ze,at,Pt,ft,Ht,In){at===null&&(at=ke);const we=Ht.isMesh&&Ht.matrixWorld.determinant()<0,We=Gi(ze,at,Pt,ft,Ht);bt.setMaterial(ft,we);let et=Pt.index,mt=1;ft.wireframe===!0&&(et=tt.getWireframeAttribute(Pt),mt=2);const ot=Pt.drawRange,Tt=Pt.attributes.position;let zt=ot.start*mt,un=(ot.start+ot.count)*mt;In!==null&&(zt=Math.max(zt,In.start*mt),un=Math.min(un,(In.start+In.count)*mt)),et!==null?(zt=Math.max(zt,0),un=Math.min(un,et.count)):Tt!=null&&(zt=Math.max(zt,0),un=Math.min(un,Tt.count));const tn=un-zt;if(tn<0||tn===1/0)return;Le.setup(Ht,ft,We,Pt,et);let Bt,fn=me;if(et!==null&&(Bt=At.get(et),fn=Pe,fn.setIndex(Bt)),Ht.isMesh)ft.wireframe===!0?(bt.setLineWidth(ft.wireframeLinewidth*Oe()),fn.setMode(1)):fn.setMode(4);else if(Ht.isLine){let ln=ft.linewidth;ln===void 0&&(ln=1),bt.setLineWidth(ln*Oe()),Ht.isLineSegments?fn.setMode(1):Ht.isLineLoop?fn.setMode(2):fn.setMode(3)}else Ht.isPoints?fn.setMode(0):Ht.isSprite&&fn.setMode(4);if(Ht.isInstancedMesh)fn.renderInstances(zt,tn,Ht.count);else if(Pt.isInstancedBufferGeometry){const ln=Pt._maxInstanceCount!==void 0?Pt._maxInstanceCount:1/0,Jn=Math.min(Pt.instanceCount,ln);fn.renderInstances(zt,tn,Jn)}else fn.render(zt,tn)},this.compile=function(ze,at){function Pt(ft,Ht,In){ft.transparent===!0&&ft.side===Rv?(ft.side=ro,ft.needsUpdate=!0,Ii(ft,Ht,In),ft.side=zu,ft.needsUpdate=!0,Ii(ft,Ht,In),ft.side=Rv):Ii(ft,Ht,In)}x=ce.get(ze),x.init(),A.push(x),ze.traverseVisible(function(ft){ft.isLight&&ft.layers.test(at.layers)&&(x.pushLight(ft),ft.castShadow&&x.pushShadow(ft))}),x.setupLights(_.physicallyCorrectLights),ze.traverse(function(ft){const Ht=ft.material;if(Ht)if(Array.isArray(Ht))for(let In=0;In<Ht.length;In++){const we=Ht[In];Pt(we,ze,ft)}else Pt(Ht,ze,ft)}),A.pop(),x=null};let Ve=null;function nt(ze){Ve&&Ve(ze)}function yt(){pn.stop()}function Wt(){pn.start()}const pn=new vO;pn.setAnimationLoop(nt),typeof self<"u"&&pn.setContext(self),this.setAnimationLoop=function(ze){Ve=ze,_t.setAnimationLoop(ze),ze===null?pn.stop():pn.start()},_t.addEventListener("sessionstart",yt),_t.addEventListener("sessionend",Wt),this.render=function(ze,at){if(at!==void 0&&at.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(E===!0)return;ze.matrixWorldAutoUpdate===!0&&ze.updateMatrixWorld(),at.parent===null&&at.matrixWorldAutoUpdate===!0&&at.updateMatrixWorld(),_t.enabled===!0&&_t.isPresenting===!0&&(_t.cameraAutoUpdate===!0&&_t.updateCamera(at),at=_t.getCamera()),ze.isScene===!0&&ze.onBeforeRender(_,ze,at,T),x=ce.get(ze,A.length),x.init(),A.push(x),ue.multiplyMatrices(at.projectionMatrix,at.matrixWorldInverse),X.setFromProjectionMatrix(ue),ie=this.localClippingEnabled,Z=ae.init(this.clippingPlanes,ie,at),g=Re.get(ze,v.length),g.init(),v.push(g),An(ze,at,0,_.sortObjects),g.finish(),_.sortObjects===!0&&g.sort(ne,D),Z===!0&&ae.beginShadows();const Pt=x.state.shadowsArray;if(J.render(Pt,ze,at),Z===!0&&ae.endShadows(),this.info.autoReset===!0&&this.info.reset(),G.render(g,ze),x.setupLights(_.physicallyCorrectLights),at.isArrayCamera){const ft=at.cameras;for(let Ht=0,In=ft.length;Ht<In;Ht++){const we=ft[Ht];mn(g,ze,we,we.viewport)}}else mn(g,ze,at);T!==null&&(Se.updateMultisampleRenderTarget(T),Se.updateRenderTargetMipmap(T)),ze.isScene===!0&&ze.onAfterRender(_,ze,at),Le.resetDefaultState(),R=-1,L=null,A.pop(),A.length>0?x=A[A.length-1]:x=null,v.pop(),v.length>0?g=v[v.length-1]:g=null};function An(ze,at,Pt,ft){if(ze.visible===!1)return;if(ze.layers.test(at.layers)){if(ze.isGroup)Pt=ze.renderOrder;else if(ze.isLOD)ze.autoUpdate===!0&&ze.update(at);else if(ze.isLight)x.pushLight(ze),ze.castShadow&&x.pushShadow(ze);else if(ze.isSprite){if(!ze.frustumCulled||X.intersectsSprite(ze)){ft&&Ce.setFromMatrixPosition(ze.matrixWorld).applyMatrix4(ue);const we=pe.update(ze),We=ze.material;We.visible&&g.push(ze,we,We,Pt,Ce.z,null)}}else if((ze.isMesh||ze.isLine||ze.isPoints)&&(ze.isSkinnedMesh&&ze.skeleton.frame!==Jt.render.frame&&(ze.skeleton.update(),ze.skeleton.frame=Jt.render.frame),!ze.frustumCulled||X.intersectsObject(ze))){ft&&Ce.setFromMatrixPosition(ze.matrixWorld).applyMatrix4(ue);const we=pe.update(ze),We=ze.material;if(Array.isArray(We)){const et=we.groups;for(let mt=0,ot=et.length;mt<ot;mt++){const Tt=et[mt],zt=We[Tt.materialIndex];zt&&zt.visible&&g.push(ze,we,zt,Pt,Ce.z,Tt)}}else We.visible&&g.push(ze,we,We,Pt,Ce.z,null)}}const In=ze.children;for(let we=0,We=In.length;we<We;we++)An(In[we],at,Pt,ft)}function mn(ze,at,Pt,ft){const Ht=ze.opaque,In=ze.transmissive,we=ze.transparent;x.setupLightsView(Pt),In.length>0&&Yn(Ht,at,Pt),ft&&bt.viewport(I.copy(ft)),Ht.length>0&&Bn(Ht,at,Pt),In.length>0&&Bn(In,at,Pt),we.length>0&&Bn(we,at,Pt),bt.buffers.depth.setTest(!0),bt.buffers.depth.setMask(!0),bt.buffers.color.setMask(!0),bt.setPolygonOffset(!1)}function Yn(ze,at,Pt){const ft=St.isWebGL2;se===null&&(se=new Tc(1,1,{generateMipmaps:!0,type:Qe.has("EXT_color_buffer_half_float")?ym:Hu,minFilter:vm,samples:ft&&a===!0?4:0})),_.getDrawingBufferSize(ye),ft?se.setSize(ye.x,ye.y):se.setSize(zE(ye.x),zE(ye.y));const Ht=_.getRenderTarget();_.setRenderTarget(se),_.clear();const In=_.toneMapping;_.toneMapping=gl,Bn(ze,at,Pt),_.toneMapping=In,Se.updateMultisampleRenderTarget(se),Se.updateRenderTargetMipmap(se),_.setRenderTarget(Ht)}function Bn(ze,at,Pt){const ft=at.isScene===!0?at.overrideMaterial:null;for(let Ht=0,In=ze.length;Ht<In;Ht++){const we=ze[Ht],We=we.object,et=we.geometry,mt=ft===null?we.material:ft,ot=we.group;We.layers.test(Pt.layers)&&mi(We,at,Pt,et,mt,ot)}}function mi(ze,at,Pt,ft,Ht,In){ze.onBeforeRender(_,at,Pt,ft,Ht,In),ze.modelViewMatrix.multiplyMatrices(Pt.matrixWorldInverse,ze.matrixWorld),ze.normalMatrix.getNormalMatrix(ze.modelViewMatrix),Ht.onBeforeRender(_,at,Pt,ft,ze,In),Ht.transparent===!0&&Ht.side===Rv?(Ht.side=ro,Ht.needsUpdate=!0,_.renderBufferDirect(Pt,at,ft,Ht,ze,In),Ht.side=zu,Ht.needsUpdate=!0,_.renderBufferDirect(Pt,at,ft,Ht,ze,In),Ht.side=Rv):_.renderBufferDirect(Pt,at,ft,Ht,ze,In),ze.onAfterRender(_,at,Pt,ft,Ht,In)}function Ii(ze,at,Pt){at.isScene!==!0&&(at=ke);const ft=sn.get(ze),Ht=x.state.lights,In=x.state.shadowsArray,we=Ht.state.version,We=ge.getParameters(ze,Ht.state,In,at,Pt),et=ge.getProgramCacheKey(We);let mt=ft.programs;ft.environment=ze.isMeshStandardMaterial?at.environment:null,ft.fog=at.fog,ft.envMap=(ze.isMeshStandardMaterial?Ue:qe).get(ze.envMap||ft.environment),mt===void 0&&(ze.addEventListener("dispose",Un),mt=new Map,ft.programs=mt);let ot=mt.get(et);if(ot!==void 0){if(ft.currentProgram===ot&&ft.lightsStateVersion===we)return Si(ze,We),ot}else We.uniforms=ge.getUniforms(ze),ze.onBuild(Pt,We,_),ze.onBeforeCompile(We,_),ot=ge.acquireProgram(We,et),mt.set(et,ot),ft.uniforms=We.uniforms;const Tt=ft.uniforms;(!ze.isShaderMaterial&&!ze.isRawShaderMaterial||ze.clipping===!0)&&(Tt.clippingPlanes=ae.uniform),Si(ze,We),ft.needsLights=is(ze),ft.lightsStateVersion=we,ft.needsLights&&(Tt.ambientLightColor.value=Ht.state.ambient,Tt.lightProbe.value=Ht.state.probe,Tt.directionalLights.value=Ht.state.directional,Tt.directionalLightShadows.value=Ht.state.directionalShadow,Tt.spotLights.value=Ht.state.spot,Tt.spotLightShadows.value=Ht.state.spotShadow,Tt.rectAreaLights.value=Ht.state.rectArea,Tt.ltc_1.value=Ht.state.rectAreaLTC1,Tt.ltc_2.value=Ht.state.rectAreaLTC2,Tt.pointLights.value=Ht.state.point,Tt.pointLightShadows.value=Ht.state.pointShadow,Tt.hemisphereLights.value=Ht.state.hemi,Tt.directionalShadowMap.value=Ht.state.directionalShadowMap,Tt.directionalShadowMatrix.value=Ht.state.directionalShadowMatrix,Tt.spotShadowMap.value=Ht.state.spotShadowMap,Tt.spotLightMatrix.value=Ht.state.spotLightMatrix,Tt.spotLightMap.value=Ht.state.spotLightMap,Tt.pointShadowMap.value=Ht.state.pointShadowMap,Tt.pointShadowMatrix.value=Ht.state.pointShadowMatrix);const zt=ot.getUniforms(),un=P0.seqWithValue(zt.seq,Tt);return ft.currentProgram=ot,ft.uniformsList=un,ot}function Si(ze,at){const Pt=sn.get(ze);Pt.outputEncoding=at.outputEncoding,Pt.instancing=at.instancing,Pt.skinning=at.skinning,Pt.morphTargets=at.morphTargets,Pt.morphNormals=at.morphNormals,Pt.morphColors=at.morphColors,Pt.morphTargetsCount=at.morphTargetsCount,Pt.numClippingPlanes=at.numClippingPlanes,Pt.numIntersection=at.numClipIntersection,Pt.vertexAlphas=at.vertexAlphas,Pt.vertexTangents=at.vertexTangents,Pt.toneMapping=at.toneMapping}function Gi(ze,at,Pt,ft,Ht){at.isScene!==!0&&(at=ke),Se.resetTextureUnits();const In=at.fog,we=ft.isMeshStandardMaterial?at.environment:null,We=T===null?_.outputEncoding:T.isXRRenderTarget===!0?T.texture.encoding:Gu,et=(ft.isMeshStandardMaterial?Ue:qe).get(ft.envMap||we),mt=ft.vertexColors===!0&&!!Pt.attributes.color&&Pt.attributes.color.itemSize===4,ot=!!ft.normalMap&&!!Pt.attributes.tangent,Tt=!!Pt.morphAttributes.position,zt=!!Pt.morphAttributes.normal,un=!!Pt.morphAttributes.color,tn=ft.toneMapped?_.toneMapping:gl,Bt=Pt.morphAttributes.position||Pt.morphAttributes.normal||Pt.morphAttributes.color,fn=Bt!==void 0?Bt.length:0,ln=sn.get(ft),Jn=x.state.lights;if(Z===!0&&(ie===!0||ze!==L)){const Xn=ze===L&&ft.id===R;ae.setState(ft,ze,Xn)}let hi=!1;ft.version===ln.__version?(ln.needsLights&&ln.lightsStateVersion!==Jn.state.version||ln.outputEncoding!==We||Ht.isInstancedMesh&&ln.instancing===!1||!Ht.isInstancedMesh&&ln.instancing===!0||Ht.isSkinnedMesh&&ln.skinning===!1||!Ht.isSkinnedMesh&&ln.skinning===!0||ln.envMap!==et||ft.fog===!0&&ln.fog!==In||ln.numClippingPlanes!==void 0&&(ln.numClippingPlanes!==ae.numPlanes||ln.numIntersection!==ae.numIntersection)||ln.vertexAlphas!==mt||ln.vertexTangents!==ot||ln.morphTargets!==Tt||ln.morphNormals!==zt||ln.morphColors!==un||ln.toneMapping!==tn||St.isWebGL2===!0&&ln.morphTargetsCount!==fn)&&(hi=!0):(hi=!0,ln.__version=ft.version);let di=ln.currentProgram;hi===!0&&(di=Ii(ft,at,Ht));let ri=!1,_i=!1,ki=!1;const Ni=di.getUniforms(),Vn=ln.uniforms;if(bt.useProgram(di.program)&&(ri=!0,_i=!0,ki=!0),ft.id!==R&&(R=ft.id,_i=!0),ri||L!==ze){if(Ni.setValue(Ne,"projectionMatrix",ze.projectionMatrix),St.logarithmicDepthBuffer&&Ni.setValue(Ne,"logDepthBufFC",2/(Math.log(ze.far+1)/Math.LN2)),L!==ze&&(L=ze,_i=!0,ki=!0),ft.isShaderMaterial||ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshStandardMaterial||ft.envMap){const Xn=Ni.map.cameraPosition;Xn!==void 0&&Xn.setValue(Ne,Ce.setFromMatrixPosition(ze.matrixWorld))}(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial)&&Ni.setValue(Ne,"isOrthographic",ze.isOrthographicCamera===!0),(ft.isMeshPhongMaterial||ft.isMeshToonMaterial||ft.isMeshLambertMaterial||ft.isMeshBasicMaterial||ft.isMeshStandardMaterial||ft.isShaderMaterial||ft.isShadowMaterial||Ht.isSkinnedMesh)&&Ni.setValue(Ne,"viewMatrix",ze.matrixWorldInverse)}if(Ht.isSkinnedMesh){Ni.setOptional(Ne,Ht,"bindMatrix"),Ni.setOptional(Ne,Ht,"bindMatrixInverse");const Xn=Ht.skeleton;Xn&&(St.floatVertexTextures?(Xn.boneTexture===null&&Xn.computeBoneTexture(),Ni.setValue(Ne,"boneTexture",Xn.boneTexture,Se),Ni.setValue(Ne,"boneTextureSize",Xn.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const gi=Pt.morphAttributes;if((gi.position!==void 0||gi.normal!==void 0||gi.color!==void 0&&St.isWebGL2===!0)&&$.update(Ht,Pt,ft,di),(_i||ln.receiveShadow!==Ht.receiveShadow)&&(ln.receiveShadow=Ht.receiveShadow,Ni.setValue(Ne,"receiveShadow",Ht.receiveShadow)),ft.isMeshGouraudMaterial&&ft.envMap!==null&&(Vn.envMap.value=et,Vn.flipEnvMap.value=et.isCubeTexture&&et.isRenderTargetTexture===!1?-1:1),_i&&(Ni.setValue(Ne,"toneMappingExposure",_.toneMappingExposure),ln.needsLights&&er(Vn,ki),In&&ft.fog===!0&&Fe.refreshFogUniforms(Vn,In),Fe.refreshMaterialUniforms(Vn,ft,le,q,se),P0.upload(Ne,ln.uniformsList,Vn,Se)),ft.isShaderMaterial&&ft.uniformsNeedUpdate===!0&&(P0.upload(Ne,ln.uniformsList,Vn,Se),ft.uniformsNeedUpdate=!1),ft.isSpriteMaterial&&Ni.setValue(Ne,"center",Ht.center),Ni.setValue(Ne,"modelViewMatrix",Ht.modelViewMatrix),Ni.setValue(Ne,"normalMatrix",Ht.normalMatrix),Ni.setValue(Ne,"modelMatrix",Ht.matrixWorld),ft.isShaderMaterial||ft.isRawShaderMaterial){const Xn=ft.uniformsGroups;for(let wr=0,Vi=Xn.length;wr<Vi;wr++)if(St.isWebGL2){const Wi=Xn[wr];wt.update(Wi,di),wt.bind(Wi,di)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return di}function er(ze,at){ze.ambientLightColor.needsUpdate=at,ze.lightProbe.needsUpdate=at,ze.directionalLights.needsUpdate=at,ze.directionalLightShadows.needsUpdate=at,ze.pointLights.needsUpdate=at,ze.pointLightShadows.needsUpdate=at,ze.spotLights.needsUpdate=at,ze.spotLightShadows.needsUpdate=at,ze.rectAreaLights.needsUpdate=at,ze.hemisphereLights.needsUpdate=at}function is(ze){return ze.isMeshLambertMaterial||ze.isMeshToonMaterial||ze.isMeshPhongMaterial||ze.isMeshStandardMaterial||ze.isShadowMaterial||ze.isShaderMaterial&&ze.lights===!0}this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return S},this.getRenderTarget=function(){return T},this.setRenderTargetTextures=function(ze,at,Pt){sn.get(ze.texture).__webglTexture=at,sn.get(ze.depthTexture).__webglTexture=Pt;const ft=sn.get(ze);ft.__hasExternalTextures=!0,ft.__hasExternalTextures&&(ft.__autoAllocateDepthBuffer=Pt===void 0,ft.__autoAllocateDepthBuffer||Qe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ft.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ze,at){const Pt=sn.get(ze);Pt.__webglFramebuffer=at,Pt.__useDefaultFramebuffer=at===void 0},this.setRenderTarget=function(ze,at=0,Pt=0){T=ze,w=at,S=Pt;let ft=!0,Ht=null,In=!1,we=!1;if(ze){const et=sn.get(ze);et.__useDefaultFramebuffer!==void 0?(bt.bindFramebuffer(36160,null),ft=!1):et.__webglFramebuffer===void 0?Se.setupRenderTarget(ze):et.__hasExternalTextures&&Se.rebindTextures(ze,sn.get(ze.texture).__webglTexture,sn.get(ze.depthTexture).__webglTexture);const mt=ze.texture;(mt.isData3DTexture||mt.isDataArrayTexture||mt.isCompressedArrayTexture)&&(we=!0);const ot=sn.get(ze).__webglFramebuffer;ze.isWebGLCubeRenderTarget?(Ht=ot[at],In=!0):St.isWebGL2&&ze.samples>0&&Se.useMultisampledRTT(ze)===!1?Ht=sn.get(ze).__webglMultisampledFramebuffer:Ht=ot,I.copy(ze.viewport),N.copy(ze.scissor),B=ze.scissorTest}else I.copy(O).multiplyScalar(le).floor(),N.copy(k).multiplyScalar(le).floor(),B=z;if(bt.bindFramebuffer(36160,Ht)&&St.drawBuffers&&ft&&bt.drawBuffers(ze,Ht),bt.viewport(I),bt.scissor(N),bt.setScissorTest(B),In){const et=sn.get(ze.texture);Ne.framebufferTexture2D(36160,36064,34069+at,et.__webglTexture,Pt)}else if(we){const et=sn.get(ze.texture),mt=at||0;Ne.framebufferTextureLayer(36160,36064,et.__webglTexture,Pt||0,mt)}R=-1},this.readRenderTargetPixels=function(ze,at,Pt,ft,Ht,In,we){if(!(ze&&ze.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let We=sn.get(ze).__webglFramebuffer;if(ze.isWebGLCubeRenderTarget&&we!==void 0&&(We=We[we]),We){bt.bindFramebuffer(36160,We);try{const et=ze.texture,mt=et.format,ot=et.type;if(mt!==Yo&&ve.convert(mt)!==Ne.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Tt=ot===ym&&(Qe.has("EXT_color_buffer_half_float")||St.isWebGL2&&Qe.has("EXT_color_buffer_float"));if(ot!==Hu&&ve.convert(ot)!==Ne.getParameter(35738)&&!(ot===wu&&(St.isWebGL2||Qe.has("OES_texture_float")||Qe.has("WEBGL_color_buffer_float")))&&!Tt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}at>=0&&at<=ze.width-ft&&Pt>=0&&Pt<=ze.height-Ht&&Ne.readPixels(at,Pt,ft,Ht,ve.convert(mt),ve.convert(ot),In)}finally{const et=T!==null?sn.get(T).__webglFramebuffer:null;bt.bindFramebuffer(36160,et)}}},this.copyFramebufferToTexture=function(ze,at,Pt=0){const ft=Math.pow(2,-Pt),Ht=Math.floor(at.image.width*ft),In=Math.floor(at.image.height*ft);Se.setTexture2D(at,0),Ne.copyTexSubImage2D(3553,Pt,0,0,ze.x,ze.y,Ht,In),bt.unbindTexture()},this.copyTextureToTexture=function(ze,at,Pt,ft=0){const Ht=at.image.width,In=at.image.height,we=ve.convert(Pt.format),We=ve.convert(Pt.type);Se.setTexture2D(Pt,0),Ne.pixelStorei(37440,Pt.flipY),Ne.pixelStorei(37441,Pt.premultiplyAlpha),Ne.pixelStorei(3317,Pt.unpackAlignment),at.isDataTexture?Ne.texSubImage2D(3553,ft,ze.x,ze.y,Ht,In,we,We,at.image.data):at.isCompressedTexture?Ne.compressedTexSubImage2D(3553,ft,ze.x,ze.y,at.mipmaps[0].width,at.mipmaps[0].height,we,at.mipmaps[0].data):Ne.texSubImage2D(3553,ft,ze.x,ze.y,we,We,at.image),ft===0&&Pt.generateMipmaps&&Ne.generateMipmap(3553),bt.unbindTexture()},this.copyTextureToTexture3D=function(ze,at,Pt,ft,Ht=0){if(_.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const In=ze.max.x-ze.min.x+1,we=ze.max.y-ze.min.y+1,We=ze.max.z-ze.min.z+1,et=ve.convert(ft.format),mt=ve.convert(ft.type);let ot;if(ft.isData3DTexture)Se.setTexture3D(ft,0),ot=32879;else if(ft.isDataArrayTexture)Se.setTexture2DArray(ft,0),ot=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Ne.pixelStorei(37440,ft.flipY),Ne.pixelStorei(37441,ft.premultiplyAlpha),Ne.pixelStorei(3317,ft.unpackAlignment);const Tt=Ne.getParameter(3314),zt=Ne.getParameter(32878),un=Ne.getParameter(3316),tn=Ne.getParameter(3315),Bt=Ne.getParameter(32877),fn=Pt.isCompressedTexture?Pt.mipmaps[0]:Pt.image;Ne.pixelStorei(3314,fn.width),Ne.pixelStorei(32878,fn.height),Ne.pixelStorei(3316,ze.min.x),Ne.pixelStorei(3315,ze.min.y),Ne.pixelStorei(32877,ze.min.z),Pt.isDataTexture||Pt.isData3DTexture?Ne.texSubImage3D(ot,Ht,at.x,at.y,at.z,In,we,We,et,mt,fn.data):Pt.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ne.compressedTexSubImage3D(ot,Ht,at.x,at.y,at.z,In,we,We,et,fn.data)):Ne.texSubImage3D(ot,Ht,at.x,at.y,at.z,In,we,We,et,mt,fn),Ne.pixelStorei(3314,Tt),Ne.pixelStorei(32878,zt),Ne.pixelStorei(3316,un),Ne.pixelStorei(3315,tn),Ne.pixelStorei(32877,Bt),Ht===0&&ft.generateMipmaps&&Ne.generateMipmap(ot),bt.unbindTexture()},this.initTexture=function(ze){ze.isCubeTexture?Se.setTextureCube(ze,0):ze.isData3DTexture?Se.setTexture3D(ze,0):ze.isDataArrayTexture||ze.isCompressedArrayTexture?Se.setTexture2DArray(ze,0):Se.setTexture2D(ze,0),bt.unbindTexture()},this.resetState=function(){w=0,S=0,T=null,bt.reset(),Le.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class Wj extends EO{}Wj.prototype.isWebGL1Renderer=!0;class jj extends ls{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(n,i){return super.copy(n,i),n.background!==null&&(this.background=n.background.clone()),n.environment!==null&&(this.environment=n.environment.clone()),n.fog!==null&&(this.fog=n.fog.clone()),this.backgroundBlurriness=n.backgroundBlurriness,this.backgroundIntensity=n.backgroundIntensity,n.overrideMaterial!==null&&(this.overrideMaterial=n.overrideMaterial.clone()),this.matrixAutoUpdate=n.matrixAutoUpdate,this}toJSON(n){const i=super.toJSON(n);return this.fog!==null&&(i.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(i.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(i.backgroundIntensity=this.backgroundIntensity),i}get autoUpdate(){return console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate}set autoUpdate(n){console.warn("THREE.Scene: autoUpdate was renamed to matrixWorldAutoUpdate in r144."),this.matrixWorldAutoUpdate=n}}class AO extends uf{constructor(n){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Ji(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.linewidth=n.linewidth,this.linecap=n.linecap,this.linejoin=n.linejoin,this.fog=n.fog,this}}const k3=new it,N3=new it,F3=new Er,Zb=new Aw,Yv=new jy;class $j extends ls{constructor(n=new ho,i=new AO){super(),this.isLine=!0,this.type="Line",this.geometry=n,this.material=i,this.updateMorphTargets()}copy(n,i){return super.copy(n,i),this.material=n.material,this.geometry=n.geometry,this}computeLineDistances(){const n=this.geometry;if(n.index===null){const i=n.attributes.position,o=[0];for(let l=1,a=i.count;l<a;l++)k3.fromBufferAttribute(i,l-1),N3.fromBufferAttribute(i,l),o[l]=o[l-1],o[l]+=k3.distanceTo(N3);n.setAttribute("lineDistance",new $r(o,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(n,i){const o=this.geometry,l=this.matrixWorld,a=n.params.Line.threshold,u=o.drawRange;if(o.boundingSphere===null&&o.computeBoundingSphere(),Yv.copy(o.boundingSphere),Yv.applyMatrix4(l),Yv.radius+=a,n.ray.intersectsSphere(Yv)===!1)return;F3.copy(l).invert(),Zb.copy(n.ray).applyMatrix4(F3);const h=a/((this.scale.x+this.scale.y+this.scale.z)/3),f=h*h,d=new it,m=new it,g=new it,x=new it,v=this.isLineSegments?2:1,A=o.index,E=o.attributes.position;if(A!==null){const w=Math.max(0,u.start),S=Math.min(A.count,u.start+u.count);for(let T=w,R=S-1;T<R;T+=v){const L=A.getX(T),I=A.getX(T+1);if(d.fromBufferAttribute(E,L),m.fromBufferAttribute(E,I),Zb.distanceSqToSegment(d,m,x,g)>f)continue;x.applyMatrix4(this.matrixWorld);const B=n.ray.origin.distanceTo(x);B<n.near||B>n.far||i.push({distance:B,point:g.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}else{const w=Math.max(0,u.start),S=Math.min(E.count,u.start+u.count);for(let T=w,R=S-1;T<R;T+=v){if(d.fromBufferAttribute(E,T),m.fromBufferAttribute(E,T+1),Zb.distanceSqToSegment(d,m,x,g)>f)continue;x.applyMatrix4(this.matrixWorld);const I=n.ray.origin.distanceTo(x);I<n.near||I>n.far||i.push({distance:I,point:g.clone().applyMatrix4(this.matrixWorld),index:T,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const i=this.geometry.morphAttributes,o=Object.keys(i);if(o.length>0){const l=i[o[0]];if(l!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,u=l.length;a<u;a++){const h=l[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[h]=a}}}}}class Rl{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(n,i){const o=this.getUtoTmapping(n);return this.getPoint(o,i)}getPoints(n=5){const i=[];for(let o=0;o<=n;o++)i.push(this.getPoint(o/n));return i}getSpacedPoints(n=5){const i=[];for(let o=0;o<=n;o++)i.push(this.getPointAt(o/n));return i}getLength(){const n=this.getLengths();return n[n.length-1]}getLengths(n=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const i=[];let o,l=this.getPoint(0),a=0;i.push(0);for(let u=1;u<=n;u++)o=this.getPoint(u/n),a+=o.distanceTo(l),i.push(a),l=o;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(n,i){const o=this.getLengths();let l=0;const a=o.length;let u;i?u=i:u=n*o[a-1];let h=0,f=a-1,d;for(;h<=f;)if(l=Math.floor(h+(f-h)/2),d=o[l]-u,d<0)h=l+1;else if(d>0)f=l-1;else{f=l;break}if(l=f,o[l]===u)return l/(a-1);const m=o[l],x=o[l+1]-m,v=(u-m)/x;return(l+v)/(a-1)}getTangent(n,i){let l=n-1e-4,a=n+1e-4;l<0&&(l=0),a>1&&(a=1);const u=this.getPoint(l),h=this.getPoint(a),f=i||(u.isVector2?new Rn:new it);return f.copy(h).sub(u).normalize(),f}getTangentAt(n,i){const o=this.getUtoTmapping(n);return this.getTangent(o,i)}computeFrenetFrames(n,i){const o=new it,l=[],a=[],u=[],h=new it,f=new Er;for(let v=0;v<=n;v++){const A=v/n;l[v]=this.getTangentAt(A,new it)}a[0]=new it,u[0]=new it;let d=Number.MAX_VALUE;const m=Math.abs(l[0].x),g=Math.abs(l[0].y),x=Math.abs(l[0].z);m<=d&&(d=m,o.set(1,0,0)),g<=d&&(d=g,o.set(0,1,0)),x<=d&&o.set(0,0,1),h.crossVectors(l[0],o).normalize(),a[0].crossVectors(l[0],h),u[0].crossVectors(l[0],a[0]);for(let v=1;v<=n;v++){if(a[v]=a[v-1].clone(),u[v]=u[v-1].clone(),h.crossVectors(l[v-1],l[v]),h.length()>Number.EPSILON){h.normalize();const A=Math.acos(ys(l[v-1].dot(l[v]),-1,1));a[v].applyMatrix4(f.makeRotationAxis(h,A))}u[v].crossVectors(l[v],a[v])}if(i===!0){let v=Math.acos(ys(a[0].dot(a[n]),-1,1));v/=n,l[0].dot(h.crossVectors(a[0],a[n]))>0&&(v=-v);for(let A=1;A<=n;A++)a[A].applyMatrix4(f.makeRotationAxis(l[A],v*A)),u[A].crossVectors(l[A],a[A])}return{tangents:l,normals:a,binormals:u}}clone(){return new this.constructor().copy(this)}copy(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}toJSON(){const n={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return n.arcLengthDivisions=this.arcLengthDivisions,n.type=this.type,n}fromJSON(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}}class wO extends Rl{constructor(n=0,i=0,o=1,l=1,a=0,u=Math.PI*2,h=!1,f=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=n,this.aY=i,this.xRadius=o,this.yRadius=l,this.aStartAngle=a,this.aEndAngle=u,this.aClockwise=h,this.aRotation=f}getPoint(n,i){const o=i||new Rn,l=Math.PI*2;let a=this.aEndAngle-this.aStartAngle;const u=Math.abs(a)<Number.EPSILON;for(;a<0;)a+=l;for(;a>l;)a-=l;a<Number.EPSILON&&(u?a=0:a=l),this.aClockwise===!0&&!u&&(a===l?a=-l:a=a-l);const h=this.aStartAngle+n*a;let f=this.aX+this.xRadius*Math.cos(h),d=this.aY+this.yRadius*Math.sin(h);if(this.aRotation!==0){const m=Math.cos(this.aRotation),g=Math.sin(this.aRotation),x=f-this.aX,v=d-this.aY;f=x*m-v*g+this.aX,d=x*g+v*m+this.aY}return o.set(f,d)}copy(n){return super.copy(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}toJSON(){const n=super.toJSON();return n.aX=this.aX,n.aY=this.aY,n.xRadius=this.xRadius,n.yRadius=this.yRadius,n.aStartAngle=this.aStartAngle,n.aEndAngle=this.aEndAngle,n.aClockwise=this.aClockwise,n.aRotation=this.aRotation,n}fromJSON(n){return super.fromJSON(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}}class Xj extends wO{constructor(n,i,o,l,a,u){super(n,i,o,o,l,a,u),this.isArcCurve=!0,this.type="ArcCurve"}}function Lw(){let r=0,n=0,i=0,o=0;function l(a,u,h,f){r=a,n=h,i=-3*a+3*u-2*h-f,o=2*a-2*u+h+f}return{initCatmullRom:function(a,u,h,f,d){l(u,h,d*(h-a),d*(f-u))},initNonuniformCatmullRom:function(a,u,h,f,d,m,g){let x=(u-a)/d-(h-a)/(d+m)+(h-u)/m,v=(h-u)/m-(f-u)/(m+g)+(f-h)/g;x*=m,v*=m,l(u,h,x,v)},calc:function(a){const u=a*a,h=u*a;return r+n*a+i*u+o*h}}}const Kv=new it,Jb=new Lw,e1=new Lw,t1=new Lw;class qj extends Rl{constructor(n=[],i=!1,o="centripetal",l=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=n,this.closed=i,this.curveType=o,this.tension=l}getPoint(n,i=new it){const o=i,l=this.points,a=l.length,u=(a-(this.closed?0:1))*n;let h=Math.floor(u),f=u-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/a)+1)*a:f===0&&h===a-1&&(h=a-2,f=1);let d,m;this.closed||h>0?d=l[(h-1)%a]:(Kv.subVectors(l[0],l[1]).add(l[0]),d=Kv);const g=l[h%a],x=l[(h+1)%a];if(this.closed||h+2<a?m=l[(h+2)%a]:(Kv.subVectors(l[a-1],l[a-2]).add(l[a-1]),m=Kv),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let A=Math.pow(d.distanceToSquared(g),v),_=Math.pow(g.distanceToSquared(x),v),E=Math.pow(x.distanceToSquared(m),v);_<1e-4&&(_=1),A<1e-4&&(A=_),E<1e-4&&(E=_),Jb.initNonuniformCatmullRom(d.x,g.x,x.x,m.x,A,_,E),e1.initNonuniformCatmullRom(d.y,g.y,x.y,m.y,A,_,E),t1.initNonuniformCatmullRom(d.z,g.z,x.z,m.z,A,_,E)}else this.curveType==="catmullrom"&&(Jb.initCatmullRom(d.x,g.x,x.x,m.x,this.tension),e1.initCatmullRom(d.y,g.y,x.y,m.y,this.tension),t1.initCatmullRom(d.z,g.z,x.z,m.z,this.tension));return o.set(Jb.calc(f),e1.calc(f),t1.calc(f)),o}copy(n){super.copy(n),this.points=[];for(let i=0,o=n.points.length;i<o;i++){const l=n.points[i];this.points.push(l.clone())}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}toJSON(){const n=super.toJSON();n.points=[];for(let i=0,o=this.points.length;i<o;i++){const l=this.points[i];n.points.push(l.toArray())}return n.closed=this.closed,n.curveType=this.curveType,n.tension=this.tension,n}fromJSON(n){super.fromJSON(n),this.points=[];for(let i=0,o=n.points.length;i<o;i++){const l=n.points[i];this.points.push(new it().fromArray(l))}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}}function B3(r,n,i,o,l){const a=(o-n)*.5,u=(l-i)*.5,h=r*r,f=r*h;return(2*i-2*o+a+u)*f+(-3*i+3*o-2*a-u)*h+a*r+i}function Yj(r,n){const i=1-r;return i*i*n}function Kj(r,n){return 2*(1-r)*r*n}function Qj(r,n){return r*r*n}function $p(r,n,i,o){return Yj(r,n)+Kj(r,i)+Qj(r,o)}function Zj(r,n){const i=1-r;return i*i*i*n}function Jj(r,n){const i=1-r;return 3*i*i*r*n}function e$(r,n){return 3*(1-r)*r*r*n}function t$(r,n){return r*r*r*n}function Xp(r,n,i,o,l){return Zj(r,n)+Jj(r,i)+e$(r,o)+t$(r,l)}class n$ extends Rl{constructor(n=new Rn,i=new Rn,o=new Rn,l=new Rn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=n,this.v1=i,this.v2=o,this.v3=l}getPoint(n,i=new Rn){const o=i,l=this.v0,a=this.v1,u=this.v2,h=this.v3;return o.set(Xp(n,l.x,a.x,u.x,h.x),Xp(n,l.y,a.y,u.y,h.y)),o}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}class MO extends Rl{constructor(n=new it,i=new it,o=new it,l=new it){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=n,this.v1=i,this.v2=o,this.v3=l}getPoint(n,i=new it){const o=i,l=this.v0,a=this.v1,u=this.v2,h=this.v3;return o.set(Xp(n,l.x,a.x,u.x,h.x),Xp(n,l.y,a.y,u.y,h.y),Xp(n,l.z,a.z,u.z,h.z)),o}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}class i$ extends Rl{constructor(n=new Rn,i=new Rn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=n,this.v2=i}getPoint(n,i=new Rn){const o=i;return n===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(n).add(this.v1)),o}getPointAt(n,i){return this.getPoint(n,i)}getTangent(n,i){const o=i||new Rn;return o.copy(this.v2).sub(this.v1).normalize(),o}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class r$ extends Rl{constructor(n=new it,i=new it){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=n,this.v2=i}getPoint(n,i=new it){const o=i;return n===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(n).add(this.v1)),o}getPointAt(n,i){return this.getPoint(n,i)}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class s$ extends Rl{constructor(n=new Rn,i=new Rn,o=new Rn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=n,this.v1=i,this.v2=o}getPoint(n,i=new Rn){const o=i,l=this.v0,a=this.v1,u=this.v2;return o.set($p(n,l.x,a.x,u.x),$p(n,l.y,a.y,u.y)),o}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class Pw extends Rl{constructor(n=new it,i=new it,o=new it){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=n,this.v1=i,this.v2=o}getPoint(n,i=new it){const o=i,l=this.v0,a=this.v1,u=this.v2;return o.set($p(n,l.x,a.x,u.x),$p(n,l.y,a.y,u.y),$p(n,l.z,a.z,u.z)),o}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}class o$ extends Rl{constructor(n=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=n}getPoint(n,i=new Rn){const o=i,l=this.points,a=(l.length-1)*n,u=Math.floor(a),h=a-u,f=l[u===0?u:u-1],d=l[u],m=l[u>l.length-2?l.length-1:u+1],g=l[u>l.length-3?l.length-1:u+2];return o.set(B3(h,f.x,d.x,m.x,g.x),B3(h,f.y,d.y,m.y,g.y)),o}copy(n){super.copy(n),this.points=[];for(let i=0,o=n.points.length;i<o;i++){const l=n.points[i];this.points.push(l.clone())}return this}toJSON(){const n=super.toJSON();n.points=[];for(let i=0,o=this.points.length;i<o;i++){const l=this.points[i];n.points.push(l.toArray())}return n}fromJSON(n){super.fromJSON(n),this.points=[];for(let i=0,o=n.points.length;i<o;i++){const l=n.points[i];this.points.push(new Rn().fromArray(l))}return this}}var a$=Object.freeze({__proto__:null,ArcCurve:Xj,CatmullRomCurve3:qj,CubicBezierCurve:n$,CubicBezierCurve3:MO,EllipseCurve:wO,LineCurve:i$,LineCurve3:r$,QuadraticBezierCurve:s$,QuadraticBezierCurve3:Pw,SplineCurve:o$});class Xy extends ho{constructor(n=1,i=1,o=1,l=32,a=1,u=!1,h=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:n,radiusBottom:i,height:o,radialSegments:l,heightSegments:a,openEnded:u,thetaStart:h,thetaLength:f};const d=this;l=Math.floor(l),a=Math.floor(a);const m=[],g=[],x=[],v=[];let A=0;const _=[],E=o/2;let w=0;S(),u===!1&&(n>0&&T(!0),i>0&&T(!1)),this.setIndex(m),this.setAttribute("position",new $r(g,3)),this.setAttribute("normal",new $r(x,3)),this.setAttribute("uv",new $r(v,2));function S(){const R=new it,L=new it;let I=0;const N=(i-n)/o;for(let B=0;B<=a;B++){const H=[],q=B/a,le=q*(i-n)+n;for(let ne=0;ne<=l;ne++){const D=ne/l,O=D*f+h,k=Math.sin(O),z=Math.cos(O);L.x=le*k,L.y=-q*o+E,L.z=le*z,g.push(L.x,L.y,L.z),R.set(k,N,z).normalize(),x.push(R.x,R.y,R.z),v.push(D,1-q),H.push(A++)}_.push(H)}for(let B=0;B<l;B++)for(let H=0;H<a;H++){const q=_[H][B],le=_[H+1][B],ne=_[H+1][B+1],D=_[H][B+1];m.push(q,le,D),m.push(le,ne,D),I+=6}d.addGroup(w,I,0),w+=I}function T(R){const L=A,I=new Rn,N=new it;let B=0;const H=R===!0?n:i,q=R===!0?1:-1;for(let ne=1;ne<=l;ne++)g.push(0,E*q,0),x.push(0,q,0),v.push(.5,.5),A++;const le=A;for(let ne=0;ne<=l;ne++){const O=ne/l*f+h,k=Math.cos(O),z=Math.sin(O);N.x=H*z,N.y=E*q,N.z=H*k,g.push(N.x,N.y,N.z),x.push(0,q,0),I.x=k*.5+.5,I.y=z*.5*q+.5,v.push(I.x,I.y),A++}for(let ne=0;ne<l;ne++){const D=L+ne,O=le+ne;R===!0?m.push(O,O+1,D):m.push(O+1,O,D),B+=3}d.addGroup(w,B,R===!0?1:2),w+=B}}static fromJSON(n){return new Xy(n.radiusTop,n.radiusBottom,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}class Dw extends Xy{constructor(n=1,i=1,o=32,l=1,a=!1,u=0,h=Math.PI*2){super(0,n,i,o,l,a,u,h),this.type="ConeGeometry",this.parameters={radius:n,height:i,radialSegments:o,heightSegments:l,openEnded:a,thetaStart:u,thetaLength:h}}static fromJSON(n){return new Dw(n.radius,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}class qy extends ho{constructor(n=1,i=32,o=16,l=0,a=Math.PI*2,u=0,h=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:n,widthSegments:i,heightSegments:o,phiStart:l,phiLength:a,thetaStart:u,thetaLength:h},i=Math.max(3,Math.floor(i)),o=Math.max(2,Math.floor(o));const f=Math.min(u+h,Math.PI);let d=0;const m=[],g=new it,x=new it,v=[],A=[],_=[],E=[];for(let w=0;w<=o;w++){const S=[],T=w/o;let R=0;w==0&&u==0?R=.5/i:w==o&&f==Math.PI&&(R=-.5/i);for(let L=0;L<=i;L++){const I=L/i;g.x=-n*Math.cos(l+I*a)*Math.sin(u+T*h),g.y=n*Math.cos(u+T*h),g.z=n*Math.sin(l+I*a)*Math.sin(u+T*h),A.push(g.x,g.y,g.z),x.copy(g).normalize(),_.push(x.x,x.y,x.z),E.push(I+R,1-T),S.push(d++)}m.push(S)}for(let w=0;w<o;w++)for(let S=0;S<i;S++){const T=m[w][S+1],R=m[w][S],L=m[w+1][S],I=m[w+1][S+1];(w!==0||u>0)&&v.push(T,R,I),(w!==o-1||f<Math.PI)&&v.push(R,L,I)}this.setIndex(v),this.setAttribute("position",new $r(A,3)),this.setAttribute("normal",new $r(_,3)),this.setAttribute("uv",new $r(E,2))}static fromJSON(n){return new qy(n.radius,n.widthSegments,n.heightSegments,n.phiStart,n.phiLength,n.thetaStart,n.thetaLength)}}class Ow extends ho{constructor(n=new Pw(new it(-1,-1,0),new it(-1,1,0),new it(1,1,0)),i=64,o=1,l=8,a=!1){super(),this.type="TubeGeometry",this.parameters={path:n,tubularSegments:i,radius:o,radialSegments:l,closed:a};const u=n.computeFrenetFrames(i,a);this.tangents=u.tangents,this.normals=u.normals,this.binormals=u.binormals;const h=new it,f=new it,d=new Rn;let m=new it;const g=[],x=[],v=[],A=[];_(),this.setIndex(A),this.setAttribute("position",new $r(g,3)),this.setAttribute("normal",new $r(x,3)),this.setAttribute("uv",new $r(v,2));function _(){for(let T=0;T<i;T++)E(T);E(a===!1?i:0),S(),w()}function E(T){m=n.getPointAt(T/i,m);const R=u.normals[T],L=u.binormals[T];for(let I=0;I<=l;I++){const N=I/l*Math.PI*2,B=Math.sin(N),H=-Math.cos(N);f.x=H*R.x+B*L.x,f.y=H*R.y+B*L.y,f.z=H*R.z+B*L.z,f.normalize(),x.push(f.x,f.y,f.z),h.x=m.x+o*f.x,h.y=m.y+o*f.y,h.z=m.z+o*f.z,g.push(h.x,h.y,h.z)}}function w(){for(let T=1;T<=i;T++)for(let R=1;R<=l;R++){const L=(l+1)*(T-1)+(R-1),I=(l+1)*T+(R-1),N=(l+1)*T+R,B=(l+1)*(T-1)+R;A.push(L,I,B),A.push(I,N,B)}}function S(){for(let T=0;T<=i;T++)for(let R=0;R<=l;R++)d.x=T/i,d.y=R/l,v.push(d.x,d.y)}}toJSON(){const n=super.toJSON();return n.path=this.parameters.path.toJSON(),n}static fromJSON(n){return new Ow(new a$[n.path.type]().fromJSON(n.path),n.tubularSegments,n.radius,n.radialSegments,n.closed)}}class l$ extends uf{constructor(n){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Ji(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Ji(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=sO,this.normalScale=new Rn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Ew,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this.fog=n.fog,this}}const U3={enabled:!1,files:{},add:function(r,n){this.enabled!==!1&&(this.files[r]=n)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class c${constructor(n,i,o){const l=this;let a=!1,u=0,h=0,f;const d=[];this.onStart=void 0,this.onLoad=n,this.onProgress=i,this.onError=o,this.itemStart=function(m){h++,a===!1&&l.onStart!==void 0&&l.onStart(m,u,h),a=!0},this.itemEnd=function(m){u++,l.onProgress!==void 0&&l.onProgress(m,u,h),u===h&&(a=!1,l.onLoad!==void 0&&l.onLoad())},this.itemError=function(m){l.onError!==void 0&&l.onError(m)},this.resolveURL=function(m){return f?f(m):m},this.setURLModifier=function(m){return f=m,this},this.addHandler=function(m,g){return d.push(m,g),this},this.removeHandler=function(m){const g=d.indexOf(m);return g!==-1&&d.splice(g,2),this},this.getHandler=function(m){for(let g=0,x=d.length;g<x;g+=2){const v=d[g],A=d[g+1];if(v.global&&(v.lastIndex=0),v.test(m))return A}return null}}}const u$=new c$;class SO{constructor(n){this.manager=n!==void 0?n:u$,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(n,i){const o=this;return new Promise(function(l,a){o.load(n,l,i,a)})}parse(){}setCrossOrigin(n){return this.crossOrigin=n,this}setWithCredentials(n){return this.withCredentials=n,this}setPath(n){return this.path=n,this}setResourcePath(n){return this.resourcePath=n,this}setRequestHeader(n){return this.requestHeader=n,this}}class h$ extends SO{constructor(n){super(n)}load(n,i,o,l){this.path!==void 0&&(n=this.path+n),n=this.manager.resolveURL(n);const a=this,u=U3.get(n);if(u!==void 0)return a.manager.itemStart(n),setTimeout(function(){i&&i(u),a.manager.itemEnd(n)},0),u;const h=_m("img");function f(){m(),U3.add(n,this),i&&i(this),a.manager.itemEnd(n)}function d(g){m(),l&&l(g),a.manager.itemError(n),a.manager.itemEnd(n)}function m(){h.removeEventListener("load",f,!1),h.removeEventListener("error",d,!1)}return h.addEventListener("load",f,!1),h.addEventListener("error",d,!1),n.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(h.crossOrigin=this.crossOrigin),a.manager.itemStart(n),h.src=n,h}}class d$ extends SO{constructor(n){super(n)}load(n,i,o,l){const a=new Gs,u=new h$(this.manager);return u.setCrossOrigin(this.crossOrigin),u.setPath(this.path),u.load(n,function(h){a.image=h,a.needsUpdate=!0,i!==void 0&&i(a)},o,l),a}}class TO extends ls{constructor(n,i=1){super(),this.isLight=!0,this.type="Light",this.color=new Ji(n),this.intensity=i}dispose(){}copy(n,i){return super.copy(n,i),this.color.copy(n.color),this.intensity=n.intensity,this}toJSON(n){const i=super.toJSON(n);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,this.groundColor!==void 0&&(i.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(i.object.distance=this.distance),this.angle!==void 0&&(i.object.angle=this.angle),this.decay!==void 0&&(i.object.decay=this.decay),this.penumbra!==void 0&&(i.object.penumbra=this.penumbra),this.shadow!==void 0&&(i.object.shadow=this.shadow.toJSON()),i}}const n1=new Er,z3=new it,H3=new it;class f${constructor(n){this.camera=n,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Rn(512,512),this.map=null,this.mapPass=null,this.matrix=new Er,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Sw,this._frameExtents=new Rn(1,1),this._viewportCount=1,this._viewports=[new ts(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(n){const i=this.camera,o=this.matrix;z3.setFromMatrixPosition(n.matrixWorld),i.position.copy(z3),H3.setFromMatrixPosition(n.target.matrixWorld),i.lookAt(H3),i.updateMatrixWorld(),n1.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(n1),o.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),o.multiply(n1)}getViewport(n){return this._viewports[n]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(n){return this.camera=n.camera.clone(),this.bias=n.bias,this.radius=n.radius,this.mapSize.copy(n.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const n={};return this.bias!==0&&(n.bias=this.bias),this.normalBias!==0&&(n.normalBias=this.normalBias),this.radius!==1&&(n.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(n.mapSize=this.mapSize.toArray()),n.camera=this.camera.toJSON(!1).object,delete n.camera.matrix,n}}class p$ extends f${constructor(){super(new Cw(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class m$ extends TO{constructor(n,i){super(n,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(ls.DefaultUp),this.updateMatrix(),this.target=new ls,this.shadow=new p$}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}class g$ extends TO{constructor(n,i){super(n,i),this.isAmbientLight=!0,this.type="AmbientLight"}}class CO{constructor(n=!0){this.autoStart=n,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=G3(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let n=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const i=G3();n=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=n}return n}}function G3(){return(typeof performance>"u"?Date:performance).now()}class RO{constructor(n,i,o=0,l=1/0){this.ray=new Aw(n,i),this.near=o,this.far=l,this.camera=null,this.layers=new ww,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(n,i){this.ray.set(n,i)}setFromCamera(n,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(n.x,n.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(n.x,n.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}intersectObject(n,i=!0,o=[]){return GE(n,this,o,i),o.sort(V3),o}intersectObjects(n,i=!0,o=[]){for(let l=0,a=n.length;l<a;l++)GE(n[l],this,o,i);return o.sort(V3),o}}function V3(r,n){return r.distance-n.distance}function GE(r,n,i,o){if(r.layers.test(n.layers)&&r.raycast(n,i),o===!0){const l=r.children;for(let a=0,u=l.length;a<u;a++)GE(l[a],n,i,!0)}}class VE{constructor(n=1,i=0,o=0){return this.radius=n,this.phi=i,this.theta=o,this}set(n,i,o){return this.radius=n,this.phi=i,this.theta=o,this}copy(n){return this.radius=n.radius,this.phi=n.phi,this.theta=n.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(n){return this.setFromCartesianCoords(n.x,n.y,n.z)}setFromCartesianCoords(n,i,o){return this.radius=Math.sqrt(n*n+i*i+o*o),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(n,o),this.phi=Math.acos(ys(i/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:_w}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=_w);function LO(r,n,i){var o,l=1;r==null&&(r=0),n==null&&(n=0),i==null&&(i=0);function a(){var u,h=o.length,f,d=0,m=0,g=0;for(u=0;u<h;++u)f=o[u],d+=f.x||0,m+=f.y||0,g+=f.z||0;for(d=(d/h-r)*l,m=(m/h-n)*l,g=(g/h-i)*l,u=0;u<h;++u)f=o[u],d&&(f.x-=d),m&&(f.y-=m),g&&(f.z-=g)}return a.initialize=function(u){o=u},a.x=function(u){return arguments.length?(r=+u,a):r},a.y=function(u){return arguments.length?(n=+u,a):n},a.z=function(u){return arguments.length?(i=+u,a):i},a.strength=function(u){return arguments.length?(l=+u,a):l},a}function v$(r){var n=+this._x.call(null,r);return PO(this.cover(n),n,r)}function PO(r,n,i){if(isNaN(n))return r;var o,l=r._root,a={data:i},u=r._x0,h=r._x1,f,d,m,g,x;if(!l)return r._root=a,r;for(;l.length;)if((m=n>=(f=(u+h)/2))?u=f:h=f,o=l,!(l=l[g=+m]))return o[g]=a,r;if(d=+r._x.call(null,l.data),n===d)return a.next=l,o?o[g]=a:r._root=a,r;do o=o?o[g]=new Array(2):r._root=new Array(2),(m=n>=(f=(u+h)/2))?u=f:h=f;while((g=+m)==(x=+(d>=f)));return o[x]=l,o[g]=a,r}function y$(r){var n,i=r.length,o,l=new Array(i),a=1/0,u=-1/0;for(n=0;n<i;++n)isNaN(o=+this._x.call(null,r[n]))||(l[n]=o,o<a&&(a=o),o>u&&(u=o));if(a>u)return this;for(this.cover(a).cover(u),n=0;n<i;++n)PO(this,l[n],r[n]);return this}function x$(r){if(isNaN(r=+r))return this;var n=this._x0,i=this._x1;if(isNaN(n))i=(n=Math.floor(r))+1;else{for(var o=i-n||1,l=this._root,a,u;n>r||r>=i;)switch(u=+(r<n),a=new Array(2),a[u]=l,l=a,o*=2,u){case 0:i=n+o;break;case 1:n=i-o;break}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._x1=i,this}function _$(){var r=[];return this.visit(function(n){if(!n.length)do r.push(n.data);while(n=n.next)}),r}function b$(r){return arguments.length?this.cover(+r[0][0]).cover(+r[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function vl(r,n,i){this.node=r,this.x0=n,this.x1=i}function E$(r,n){var i,o=this._x0,l,a,u=this._x1,h=[],f=this._root,d,m;for(f&&h.push(new vl(f,o,u)),n==null?n=1/0:(o=r-n,u=r+n);d=h.pop();)if(!(!(f=d.node)||(l=d.x0)>u||(a=d.x1)<o))if(f.length){var g=(l+a)/2;h.push(new vl(f[1],g,a),new vl(f[0],l,g)),(m=+(r>=g))&&(d=h[h.length-1],h[h.length-1]=h[h.length-1-m],h[h.length-1-m]=d)}else{var x=Math.abs(r-+this._x.call(null,f.data));x<n&&(n=x,o=r-x,u=r+x,i=f.data)}return i}function A$(r){if(isNaN(f=+this._x.call(null,r)))return this;var n,i=this._root,o,l,a,u=this._x0,h=this._x1,f,d,m,g,x;if(!i)return this;if(i.length)for(;;){if((m=f>=(d=(u+h)/2))?u=d:h=d,n=i,!(i=i[g=+m]))return this;if(!i.length)break;n[g+1&1]&&(o=n,x=g)}for(;i.data!==r;)if(l=i,!(i=i.next))return this;return(a=i.next)&&delete i.next,l?(a?l.next=a:delete l.next,this):n?(a?n[g]=a:delete n[g],(i=n[0]||n[1])&&i===(n[1]||n[0])&&!i.length&&(o?o[x]=i:this._root=i),this):(this._root=a,this)}function w$(r){for(var n=0,i=r.length;n<i;++n)this.remove(r[n]);return this}function M$(){return this._root}function S$(){var r=0;return this.visit(function(n){if(!n.length)do++r;while(n=n.next)}),r}function T$(r){var n=[],i,o=this._root,l,a,u;for(o&&n.push(new vl(o,this._x0,this._x1));i=n.pop();)if(!r(o=i.node,a=i.x0,u=i.x1)&&o.length){var h=(a+u)/2;(l=o[1])&&n.push(new vl(l,h,u)),(l=o[0])&&n.push(new vl(l,a,h))}return this}function C$(r){var n=[],i=[],o;for(this._root&&n.push(new vl(this._root,this._x0,this._x1));o=n.pop();){var l=o.node;if(l.length){var a,u=o.x0,h=o.x1,f=(u+h)/2;(a=l[0])&&n.push(new vl(a,u,f)),(a=l[1])&&n.push(new vl(a,f,h))}i.push(o)}for(;o=i.pop();)r(o.node,o.x0,o.x1);return this}function R$(r){return r[0]}function L$(r){return arguments.length?(this._x=r,this):this._x}function DO(r,n){var i=new Iw(n==null?R$:n,NaN,NaN);return r==null?i:i.addAll(r)}function Iw(r,n,i){this._x=r,this._x0=n,this._x1=i,this._root=void 0}function W3(r){for(var n={data:r.data},i=n;r=r.next;)i=i.next={data:r.data};return n}var Vs=DO.prototype=Iw.prototype;Vs.copy=function(){var r=new Iw(this._x,this._x0,this._x1),n=this._root,i,o;if(!n)return r;if(!n.length)return r._root=W3(n),r;for(i=[{source:n,target:r._root=new Array(2)}];n=i.pop();)for(var l=0;l<2;++l)(o=n.source[l])&&(o.length?i.push({source:o,target:n.target[l]=new Array(2)}):n.target[l]=W3(o));return r};Vs.add=v$;Vs.addAll=y$;Vs.cover=x$;Vs.data=_$;Vs.extent=b$;Vs.find=E$;Vs.remove=A$;Vs.removeAll=w$;Vs.root=M$;Vs.size=S$;Vs.visit=T$;Vs.visitAfter=C$;Vs.x=L$;function P$(r){const n=+this._x.call(null,r),i=+this._y.call(null,r);return OO(this.cover(n,i),n,i,r)}function OO(r,n,i,o){if(isNaN(n)||isNaN(i))return r;var l,a=r._root,u={data:o},h=r._x0,f=r._y0,d=r._x1,m=r._y1,g,x,v,A,_,E,w,S;if(!a)return r._root=u,r;for(;a.length;)if((_=n>=(g=(h+d)/2))?h=g:d=g,(E=i>=(x=(f+m)/2))?f=x:m=x,l=a,!(a=a[w=E<<1|_]))return l[w]=u,r;if(v=+r._x.call(null,a.data),A=+r._y.call(null,a.data),n===v&&i===A)return u.next=a,l?l[w]=u:r._root=u,r;do l=l?l[w]=new Array(4):r._root=new Array(4),(_=n>=(g=(h+d)/2))?h=g:d=g,(E=i>=(x=(f+m)/2))?f=x:m=x;while((w=E<<1|_)===(S=(A>=x)<<1|v>=g));return l[S]=a,l[w]=u,r}function D$(r){var n,i,o=r.length,l,a,u=new Array(o),h=new Array(o),f=1/0,d=1/0,m=-1/0,g=-1/0;for(i=0;i<o;++i)isNaN(l=+this._x.call(null,n=r[i]))||isNaN(a=+this._y.call(null,n))||(u[i]=l,h[i]=a,l<f&&(f=l),l>m&&(m=l),a<d&&(d=a),a>g&&(g=a));if(f>m||d>g)return this;for(this.cover(f,d).cover(m,g),i=0;i<o;++i)OO(this,u[i],h[i],r[i]);return this}function O$(r,n){if(isNaN(r=+r)||isNaN(n=+n))return this;var i=this._x0,o=this._y0,l=this._x1,a=this._y1;if(isNaN(i))l=(i=Math.floor(r))+1,a=(o=Math.floor(n))+1;else{for(var u=l-i||1,h=this._root,f,d;i>r||r>=l||o>n||n>=a;)switch(d=(n<o)<<1|r<i,f=new Array(4),f[d]=h,h=f,u*=2,d){case 0:l=i+u,a=o+u;break;case 1:i=l-u,a=o+u;break;case 2:l=i+u,o=a-u;break;case 3:i=l-u,o=a-u;break}this._root&&this._root.length&&(this._root=h)}return this._x0=i,this._y0=o,this._x1=l,this._y1=a,this}function I$(){var r=[];return this.visit(function(n){if(!n.length)do r.push(n.data);while(n=n.next)}),r}function k$(r){return arguments.length?this.cover(+r[0][0],+r[0][1]).cover(+r[1][0],+r[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Ts(r,n,i,o,l){this.node=r,this.x0=n,this.y0=i,this.x1=o,this.y1=l}function N$(r,n,i){var o,l=this._x0,a=this._y0,u,h,f,d,m=this._x1,g=this._y1,x=[],v=this._root,A,_;for(v&&x.push(new Ts(v,l,a,m,g)),i==null?i=1/0:(l=r-i,a=n-i,m=r+i,g=n+i,i*=i);A=x.pop();)if(!(!(v=A.node)||(u=A.x0)>m||(h=A.y0)>g||(f=A.x1)<l||(d=A.y1)<a))if(v.length){var E=(u+f)/2,w=(h+d)/2;x.push(new Ts(v[3],E,w,f,d),new Ts(v[2],u,w,E,d),new Ts(v[1],E,h,f,w),new Ts(v[0],u,h,E,w)),(_=(n>=w)<<1|r>=E)&&(A=x[x.length-1],x[x.length-1]=x[x.length-1-_],x[x.length-1-_]=A)}else{var S=r-+this._x.call(null,v.data),T=n-+this._y.call(null,v.data),R=S*S+T*T;if(R<i){var L=Math.sqrt(i=R);l=r-L,a=n-L,m=r+L,g=n+L,o=v.data}}return o}function F$(r){if(isNaN(m=+this._x.call(null,r))||isNaN(g=+this._y.call(null,r)))return this;var n,i=this._root,o,l,a,u=this._x0,h=this._y0,f=this._x1,d=this._y1,m,g,x,v,A,_,E,w;if(!i)return this;if(i.length)for(;;){if((A=m>=(x=(u+f)/2))?u=x:f=x,(_=g>=(v=(h+d)/2))?h=v:d=v,n=i,!(i=i[E=_<<1|A]))return this;if(!i.length)break;(n[E+1&3]||n[E+2&3]||n[E+3&3])&&(o=n,w=E)}for(;i.data!==r;)if(l=i,!(i=i.next))return this;return(a=i.next)&&delete i.next,l?(a?l.next=a:delete l.next,this):n?(a?n[E]=a:delete n[E],(i=n[0]||n[1]||n[2]||n[3])&&i===(n[3]||n[2]||n[1]||n[0])&&!i.length&&(o?o[w]=i:this._root=i),this):(this._root=a,this)}function B$(r){for(var n=0,i=r.length;n<i;++n)this.remove(r[n]);return this}function U$(){return this._root}function z$(){var r=0;return this.visit(function(n){if(!n.length)do++r;while(n=n.next)}),r}function H$(r){var n=[],i,o=this._root,l,a,u,h,f;for(o&&n.push(new Ts(o,this._x0,this._y0,this._x1,this._y1));i=n.pop();)if(!r(o=i.node,a=i.x0,u=i.y0,h=i.x1,f=i.y1)&&o.length){var d=(a+h)/2,m=(u+f)/2;(l=o[3])&&n.push(new Ts(l,d,m,h,f)),(l=o[2])&&n.push(new Ts(l,a,m,d,f)),(l=o[1])&&n.push(new Ts(l,d,u,h,m)),(l=o[0])&&n.push(new Ts(l,a,u,d,m))}return this}function G$(r){var n=[],i=[],o;for(this._root&&n.push(new Ts(this._root,this._x0,this._y0,this._x1,this._y1));o=n.pop();){var l=o.node;if(l.length){var a,u=o.x0,h=o.y0,f=o.x1,d=o.y1,m=(u+f)/2,g=(h+d)/2;(a=l[0])&&n.push(new Ts(a,u,h,m,g)),(a=l[1])&&n.push(new Ts(a,m,h,f,g)),(a=l[2])&&n.push(new Ts(a,u,g,m,d)),(a=l[3])&&n.push(new Ts(a,m,g,f,d))}i.push(o)}for(;o=i.pop();)r(o.node,o.x0,o.y0,o.x1,o.y1);return this}function V$(r){return r[0]}function W$(r){return arguments.length?(this._x=r,this):this._x}function j$(r){return r[1]}function $$(r){return arguments.length?(this._y=r,this):this._y}function IO(r,n,i){var o=new kw(n==null?V$:n,i==null?j$:i,NaN,NaN,NaN,NaN);return r==null?o:o.addAll(r)}function kw(r,n,i,o,l,a){this._x=r,this._y=n,this._x0=i,this._y0=o,this._x1=l,this._y1=a,this._root=void 0}function j3(r){for(var n={data:r.data},i=n;r=r.next;)i=i.next={data:r.data};return n}var Os=IO.prototype=kw.prototype;Os.copy=function(){var r=new kw(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,i,o;if(!n)return r;if(!n.length)return r._root=j3(n),r;for(i=[{source:n,target:r._root=new Array(4)}];n=i.pop();)for(var l=0;l<4;++l)(o=n.source[l])&&(o.length?i.push({source:o,target:n.target[l]=new Array(4)}):n.target[l]=j3(o));return r};Os.add=P$;Os.addAll=D$;Os.cover=O$;Os.data=I$;Os.extent=k$;Os.find=N$;Os.remove=F$;Os.removeAll=B$;Os.root=U$;Os.size=z$;Os.visit=H$;Os.visitAfter=G$;Os.x=W$;Os.y=$$;function X$(r){var n=+this._x.call(null,r),i=+this._y.call(null,r),o=+this._z.call(null,r);return kO(this.cover(n,i,o),n,i,o,r)}function kO(r,n,i,o,l){if(isNaN(n)||isNaN(i)||isNaN(o))return r;var a,u=r._root,h={data:l},f=r._x0,d=r._y0,m=r._z0,g=r._x1,x=r._y1,v=r._z1,A,_,E,w,S,T,R,L,I,N,B;if(!u)return r._root=h,r;for(;u.length;)if((R=n>=(A=(f+g)/2))?f=A:g=A,(L=i>=(_=(d+x)/2))?d=_:x=_,(I=o>=(E=(m+v)/2))?m=E:v=E,a=u,!(u=u[N=I<<2|L<<1|R]))return a[N]=h,r;if(w=+r._x.call(null,u.data),S=+r._y.call(null,u.data),T=+r._z.call(null,u.data),n===w&&i===S&&o===T)return h.next=u,a?a[N]=h:r._root=h,r;do a=a?a[N]=new Array(8):r._root=new Array(8),(R=n>=(A=(f+g)/2))?f=A:g=A,(L=i>=(_=(d+x)/2))?d=_:x=_,(I=o>=(E=(m+v)/2))?m=E:v=E;while((N=I<<2|L<<1|R)===(B=(T>=E)<<2|(S>=_)<<1|w>=A));return a[B]=u,a[N]=h,r}function q$(r){var n,i,o=r.length,l,a,u,h=new Array(o),f=new Array(o),d=new Array(o),m=1/0,g=1/0,x=1/0,v=-1/0,A=-1/0,_=-1/0;for(i=0;i<o;++i)isNaN(l=+this._x.call(null,n=r[i]))||isNaN(a=+this._y.call(null,n))||isNaN(u=+this._z.call(null,n))||(h[i]=l,f[i]=a,d[i]=u,l<m&&(m=l),l>v&&(v=l),a<g&&(g=a),a>A&&(A=a),u<x&&(x=u),u>_&&(_=u));if(m>v||g>A||x>_)return this;for(this.cover(m,g,x).cover(v,A,_),i=0;i<o;++i)kO(this,h[i],f[i],d[i],r[i]);return this}function Y$(r,n,i){if(isNaN(r=+r)||isNaN(n=+n)||isNaN(i=+i))return this;var o=this._x0,l=this._y0,a=this._z0,u=this._x1,h=this._y1,f=this._z1;if(isNaN(o))u=(o=Math.floor(r))+1,h=(l=Math.floor(n))+1,f=(a=Math.floor(i))+1;else{for(var d=u-o||1,m=this._root,g,x;o>r||r>=u||l>n||n>=h||a>i||i>=f;)switch(x=(i<a)<<2|(n<l)<<1|r<o,g=new Array(8),g[x]=m,m=g,d*=2,x){case 0:u=o+d,h=l+d,f=a+d;break;case 1:o=u-d,h=l+d,f=a+d;break;case 2:u=o+d,l=h-d,f=a+d;break;case 3:o=u-d,l=h-d,f=a+d;break;case 4:u=o+d,h=l+d,a=f-d;break;case 5:o=u-d,h=l+d,a=f-d;break;case 6:u=o+d,l=h-d,a=f-d;break;case 7:o=u-d,l=h-d,a=f-d;break}this._root&&this._root.length&&(this._root=m)}return this._x0=o,this._y0=l,this._z0=a,this._x1=u,this._y1=h,this._z1=f,this}function K$(){var r=[];return this.visit(function(n){if(!n.length)do r.push(n.data);while(n=n.next)}),r}function Q$(r){return arguments.length?this.cover(+r[0][0],+r[0][1],+r[0][2]).cover(+r[1][0],+r[1][1],+r[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function or(r,n,i,o,l,a,u){this.node=r,this.x0=n,this.y0=i,this.z0=o,this.x1=l,this.y1=a,this.z1=u}function Z$(r,n,i,o){var l,a=this._x0,u=this._y0,h=this._z0,f,d,m,g,x,v,A=this._x1,_=this._y1,E=this._z1,w=[],S=this._root,T,R;for(S&&w.push(new or(S,a,u,h,A,_,E)),o==null?o=1/0:(a=r-o,u=n-o,h=i-o,A=r+o,_=n+o,E=i+o,o*=o);T=w.pop();)if(!(!(S=T.node)||(f=T.x0)>A||(d=T.y0)>_||(m=T.z0)>E||(g=T.x1)<a||(x=T.y1)<u||(v=T.z1)<h))if(S.length){var L=(f+g)/2,I=(d+x)/2,N=(m+v)/2;w.push(new or(S[7],L,I,N,g,x,v),new or(S[6],f,I,N,L,x,v),new or(S[5],L,d,N,g,I,v),new or(S[4],f,d,N,L,I,v),new or(S[3],L,I,m,g,x,N),new or(S[2],f,I,m,L,x,N),new or(S[1],L,d,m,g,I,N),new or(S[0],f,d,m,L,I,N)),(R=(i>=N)<<2|(n>=I)<<1|r>=L)&&(T=w[w.length-1],w[w.length-1]=w[w.length-1-R],w[w.length-1-R]=T)}else{var B=r-+this._x.call(null,S.data),H=n-+this._y.call(null,S.data),q=i-+this._z.call(null,S.data),le=B*B+H*H+q*q;if(le<o){var ne=Math.sqrt(o=le);a=r-ne,u=n-ne,h=i-ne,A=r+ne,_=n+ne,E=i+ne,l=S.data}}return l}function J$(r){if(isNaN(x=+this._x.call(null,r))||isNaN(v=+this._y.call(null,r))||isNaN(A=+this._z.call(null,r)))return this;var n,i=this._root,o,l,a,u=this._x0,h=this._y0,f=this._z0,d=this._x1,m=this._y1,g=this._z1,x,v,A,_,E,w,S,T,R,L,I;if(!i)return this;if(i.length)for(;;){if((S=x>=(_=(u+d)/2))?u=_:d=_,(T=v>=(E=(h+m)/2))?h=E:m=E,(R=A>=(w=(f+g)/2))?f=w:g=w,n=i,!(i=i[L=R<<2|T<<1|S]))return this;if(!i.length)break;(n[L+1&7]||n[L+2&7]||n[L+3&7]||n[L+4&7]||n[L+5&7]||n[L+6&7]||n[L+7&7])&&(o=n,I=L)}for(;i.data!==r;)if(l=i,!(i=i.next))return this;return(a=i.next)&&delete i.next,l?(a?l.next=a:delete l.next,this):n?(a?n[L]=a:delete n[L],(i=n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7])&&i===(n[7]||n[6]||n[5]||n[4]||n[3]||n[2]||n[1]||n[0])&&!i.length&&(o?o[I]=i:this._root=i),this):(this._root=a,this)}function eX(r){for(var n=0,i=r.length;n<i;++n)this.remove(r[n]);return this}function tX(){return this._root}function nX(){var r=0;return this.visit(function(n){if(!n.length)do++r;while(n=n.next)}),r}function iX(r){var n=[],i,o=this._root,l,a,u,h,f,d,m;for(o&&n.push(new or(o,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=n.pop();)if(!r(o=i.node,a=i.x0,u=i.y0,h=i.z0,f=i.x1,d=i.y1,m=i.z1)&&o.length){var g=(a+f)/2,x=(u+d)/2,v=(h+m)/2;(l=o[7])&&n.push(new or(l,g,x,v,f,d,m)),(l=o[6])&&n.push(new or(l,a,x,v,g,d,m)),(l=o[5])&&n.push(new or(l,g,u,v,f,x,m)),(l=o[4])&&n.push(new or(l,a,u,v,g,x,m)),(l=o[3])&&n.push(new or(l,g,x,h,f,d,v)),(l=o[2])&&n.push(new or(l,a,x,h,g,d,v)),(l=o[1])&&n.push(new or(l,g,u,h,f,x,v)),(l=o[0])&&n.push(new or(l,a,u,h,g,x,v))}return this}function rX(r){var n=[],i=[],o;for(this._root&&n.push(new or(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));o=n.pop();){var l=o.node;if(l.length){var a,u=o.x0,h=o.y0,f=o.z0,d=o.x1,m=o.y1,g=o.z1,x=(u+d)/2,v=(h+m)/2,A=(f+g)/2;(a=l[0])&&n.push(new or(a,u,h,f,x,v,A)),(a=l[1])&&n.push(new or(a,x,h,f,d,v,A)),(a=l[2])&&n.push(new or(a,u,v,f,x,m,A)),(a=l[3])&&n.push(new or(a,x,v,f,d,m,A)),(a=l[4])&&n.push(new or(a,u,h,A,x,v,g)),(a=l[5])&&n.push(new or(a,x,h,A,d,v,g)),(a=l[6])&&n.push(new or(a,u,v,A,x,m,g)),(a=l[7])&&n.push(new or(a,x,v,A,d,m,g))}i.push(o)}for(;o=i.pop();)r(o.node,o.x0,o.y0,o.z0,o.x1,o.y1,o.z1);return this}function sX(r){return r[0]}function oX(r){return arguments.length?(this._x=r,this):this._x}function aX(r){return r[1]}function lX(r){return arguments.length?(this._y=r,this):this._y}function cX(r){return r[2]}function uX(r){return arguments.length?(this._z=r,this):this._z}function NO(r,n,i,o){var l=new Nw(n==null?sX:n,i==null?aX:i,o==null?cX:o,NaN,NaN,NaN,NaN,NaN,NaN);return r==null?l:l.addAll(r)}function Nw(r,n,i,o,l,a,u,h,f){this._x=r,this._y=n,this._z=i,this._x0=o,this._y0=l,this._z0=a,this._x1=u,this._y1=h,this._z1=f,this._root=void 0}function $3(r){for(var n={data:r.data},i=n;r=r.next;)i=i.next={data:r.data};return n}var _s=NO.prototype=Nw.prototype;_s.copy=function(){var r=new Nw(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root,i,o;if(!n)return r;if(!n.length)return r._root=$3(n),r;for(i=[{source:n,target:r._root=new Array(8)}];n=i.pop();)for(var l=0;l<8;++l)(o=n.source[l])&&(o.length?i.push({source:o,target:n.target[l]=new Array(8)}):n.target[l]=$3(o));return r};_s.add=X$;_s.addAll=q$;_s.cover=Y$;_s.data=K$;_s.extent=Q$;_s.find=Z$;_s.remove=J$;_s.removeAll=eX;_s.root=tX;_s.size=nX;_s.visit=iX;_s.visitAfter=rX;_s.x=oX;_s.y=lX;_s.z=uX;function fl(r){return function(){return r}}function ll(r){return(r()-.5)*1e-6}function hX(r){return r.index}function X3(r,n){var i=r.get(n);if(!i)throw new Error("node not found: "+n);return i}function FO(r){var n=hX,i=x,o,l=fl(30),a,u,h,f,d,m,g=1;r==null&&(r=[]);function x(w){return 1/Math.min(f[w.source.index],f[w.target.index])}function v(w){for(var S=0,T=r.length;S<g;++S)for(var R=0,L,I,N,B=0,H=0,q=0,le,ne;R<T;++R)L=r[R],I=L.source,N=L.target,B=N.x+N.vx-I.x-I.vx||ll(m),h>1&&(H=N.y+N.vy-I.y-I.vy||ll(m)),h>2&&(q=N.z+N.vz-I.z-I.vz||ll(m)),le=Math.sqrt(B*B+H*H+q*q),le=(le-a[R])/le*w*o[R],B*=le,H*=le,q*=le,N.vx-=B*(ne=d[R]),h>1&&(N.vy-=H*ne),h>2&&(N.vz-=q*ne),I.vx+=B*(ne=1-ne),h>1&&(I.vy+=H*ne),h>2&&(I.vz+=q*ne)}function A(){if(!!u){var w,S=u.length,T=r.length,R=new Map(u.map((I,N)=>[n(I,N,u),I])),L;for(w=0,f=new Array(S);w<T;++w)L=r[w],L.index=w,typeof L.source!="object"&&(L.source=X3(R,L.source)),typeof L.target!="object"&&(L.target=X3(R,L.target)),f[L.source.index]=(f[L.source.index]||0)+1,f[L.target.index]=(f[L.target.index]||0)+1;for(w=0,d=new Array(T);w<T;++w)L=r[w],d[w]=f[L.source.index]/(f[L.source.index]+f[L.target.index]);o=new Array(T),_(),a=new Array(T),E()}}function _(){if(!!u)for(var w=0,S=r.length;w<S;++w)o[w]=+i(r[w],w,r)}function E(){if(!!u)for(var w=0,S=r.length;w<S;++w)a[w]=+l(r[w],w,r)}return v.initialize=function(w,...S){u=w,m=S.find(T=>typeof T=="function")||Math.random,h=S.find(T=>[1,2,3].includes(T))||2,A()},v.links=function(w){return arguments.length?(r=w,A(),v):r},v.id=function(w){return arguments.length?(n=w,v):n},v.iterations=function(w){return arguments.length?(g=+w,v):g},v.strength=function(w){return arguments.length?(i=typeof w=="function"?w:fl(+w),_(),v):i},v.distance=function(w){return arguments.length?(l=typeof w=="function"?w:fl(+w),E(),v):l},v}var dX={value:()=>{}};function Fm(){for(var r=0,n=arguments.length,i={},o;r<n;++r){if(!(o=arguments[r]+"")||o in i||/[\s.]/.test(o))throw new Error("illegal type: "+o);i[o]=[]}return new D0(i)}function D0(r){this._=r}function fX(r,n){return r.trim().split(/^|\s+/).map(function(i){var o="",l=i.indexOf(".");if(l>=0&&(o=i.slice(l+1),i=i.slice(0,l)),i&&!n.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:o}})}D0.prototype=Fm.prototype={constructor:D0,on:function(r,n){var i=this._,o=fX(r+"",i),l,a=-1,u=o.length;if(arguments.length<2){for(;++a<u;)if((l=(r=o[a]).type)&&(l=pX(i[l],r.name)))return l;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++a<u;)if(l=(r=o[a]).type)i[l]=q3(i[l],r.name,n);else if(n==null)for(l in i)i[l]=q3(i[l],r.name,null);return this},copy:function(){var r={},n=this._;for(var i in n)r[i]=n[i].slice();return new D0(r)},call:function(r,n){if((l=arguments.length-2)>0)for(var i=new Array(l),o=0,l,a;o<l;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(a=this._[r],o=0,l=a.length;o<l;++o)a[o].value.apply(n,i)},apply:function(r,n,i){if(!this._.hasOwnProperty(r))throw new Error("unknown type: "+r);for(var o=this._[r],l=0,a=o.length;l<a;++l)o[l].value.apply(n,i)}};function pX(r,n){for(var i=0,o=r.length,l;i<o;++i)if((l=r[i]).name===n)return l.value}function q3(r,n,i){for(var o=0,l=r.length;o<l;++o)if(r[o].name===n){r[o]=dX,r=r.slice(0,o).concat(r.slice(o+1));break}return i!=null&&r.push({name:n,value:i}),r}var Qd=0,Op=0,pp=0,BO=1e3,fy,Ip,py=0,Vu=0,Yy=0,bm=typeof performance=="object"&&performance.now?performance:Date,UO=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(r){setTimeout(r,17)};function Fw(){return Vu||(UO(mX),Vu=bm.now()+Yy)}function mX(){Vu=0}function my(){this._call=this._time=this._next=null}my.prototype=Bw.prototype={constructor:my,restart:function(r,n,i){if(typeof r!="function")throw new TypeError("callback is not a function");i=(i==null?Fw():+i)+(n==null?0:+n),!this._next&&Ip!==this&&(Ip?Ip._next=this:fy=this,Ip=this),this._call=r,this._time=i,WE()},stop:function(){this._call&&(this._call=null,this._time=1/0,WE())}};function Bw(r,n,i){var o=new my;return o.restart(r,n,i),o}function gX(){Fw(),++Qd;for(var r=fy,n;r;)(n=Vu-r._time)>=0&&r._call.call(void 0,n),r=r._next;--Qd}function Y3(){Vu=(py=bm.now())+Yy,Qd=Op=0;try{gX()}finally{Qd=0,yX(),Vu=0}}function vX(){var r=bm.now(),n=r-py;n>BO&&(Yy-=n,py=r)}function yX(){for(var r,n=fy,i,o=1/0;n;)n._call?(o>n._time&&(o=n._time),r=n,n=n._next):(i=n._next,n._next=null,n=r?r._next=i:fy=i);Ip=r,WE(o)}function WE(r){if(!Qd){Op&&(Op=clearTimeout(Op));var n=r-Vu;n>24?(r<1/0&&(Op=setTimeout(Y3,r-bm.now()-Yy)),pp&&(pp=clearInterval(pp))):(pp||(py=bm.now(),pp=setInterval(vX,BO)),Qd=1,UO(Y3))}}function K3(r,n,i){var o=new my;return n=n==null?0:+n,o.restart(l=>{o.stop(),r(l+n)},n,i),o}const xX=1664525,_X=1013904223,Q3=4294967296;function bX(){let r=1;return()=>(r=(xX*r+_X)%Q3)/Q3}var Z3=3;function i1(r){return r.x}function J3(r){return r.y}function EX(r){return r.z}var AX=10,wX=Math.PI*(3-Math.sqrt(5)),MX=Math.PI*20/(9+Math.sqrt(221));function zO(r,n){n=n||2;var i=Math.min(Z3,Math.max(1,Math.round(n))),o,l=1,a=.001,u=1-Math.pow(a,1/300),h=0,f=.6,d=new Map,m=Bw(v),g=Fm("tick","end"),x=bX();r==null&&(r=[]);function v(){A(),g.call("tick",o),l<a&&(m.stop(),g.call("end",o))}function A(w){var S,T=r.length,R;w===void 0&&(w=1);for(var L=0;L<w;++L)for(l+=(h-l)*u,d.forEach(function(I){I(l)}),S=0;S<T;++S)R=r[S],R.fx==null?R.x+=R.vx*=f:(R.x=R.fx,R.vx=0),i>1&&(R.fy==null?R.y+=R.vy*=f:(R.y=R.fy,R.vy=0)),i>2&&(R.fz==null?R.z+=R.vz*=f:(R.z=R.fz,R.vz=0));return o}function _(){for(var w=0,S=r.length,T;w<S;++w){if(T=r[w],T.index=w,T.fx!=null&&(T.x=T.fx),T.fy!=null&&(T.y=T.fy),T.fz!=null&&(T.z=T.fz),isNaN(T.x)||i>1&&isNaN(T.y)||i>2&&isNaN(T.z)){var R=AX*(i>2?Math.cbrt(.5+w):i>1?Math.sqrt(.5+w):w),L=w*wX,I=w*MX;i===1?T.x=R:i===2?(T.x=R*Math.cos(L),T.y=R*Math.sin(L)):(T.x=R*Math.sin(L)*Math.cos(I),T.y=R*Math.cos(L),T.z=R*Math.sin(L)*Math.sin(I))}(isNaN(T.vx)||i>1&&isNaN(T.vy)||i>2&&isNaN(T.vz))&&(T.vx=0,i>1&&(T.vy=0),i>2&&(T.vz=0))}}function E(w){return w.initialize&&w.initialize(r,x,i),w}return _(),o={tick:A,restart:function(){return m.restart(v),o},stop:function(){return m.stop(),o},numDimensions:function(w){return arguments.length?(i=Math.min(Z3,Math.max(1,Math.round(w))),d.forEach(E),o):i},nodes:function(w){return arguments.length?(r=w,_(),d.forEach(E),o):r},alpha:function(w){return arguments.length?(l=+w,o):l},alphaMin:function(w){return arguments.length?(a=+w,o):a},alphaDecay:function(w){return arguments.length?(u=+w,o):+u},alphaTarget:function(w){return arguments.length?(h=+w,o):h},velocityDecay:function(w){return arguments.length?(f=1-w,o):1-f},randomSource:function(w){return arguments.length?(x=w,d.forEach(E),o):x},force:function(w,S){return arguments.length>1?(S==null?d.delete(w):d.set(w,E(S)),o):d.get(w)},find:function(){var w=Array.prototype.slice.call(arguments),S=w.shift()||0,T=(i>1?w.shift():null)||0,R=(i>2?w.shift():null)||0,L=w.shift()||1/0,I=0,N=r.length,B,H,q,le,ne,D;for(L*=L,I=0;I<N;++I)ne=r[I],B=S-ne.x,H=T-(ne.y||0),q=R-(ne.z||0),le=B*B+H*H+q*q,le<L&&(D=ne,L=le);return D},on:function(w,S){return arguments.length>1?(g.on(w,S),o):g.on(w)}}}function HO(){var r,n,i,o,l,a=fl(-30),u,h=1,f=1/0,d=.81;function m(A){var _,E=r.length,w=(n===1?DO(r,i1):n===2?IO(r,i1,J3):n===3?NO(r,i1,J3,EX):null).visitAfter(x);for(l=A,_=0;_<E;++_)i=r[_],w.visit(v)}function g(){if(!!r){var A,_=r.length,E;for(u=new Array(_),A=0;A<_;++A)E=r[A],u[E.index]=+a(E,A,r)}}function x(A){var _=0,E,w,S=0,T,R,L,I,N=A.length;if(N){for(T=R=L=I=0;I<N;++I)(E=A[I])&&(w=Math.abs(E.value))&&(_+=E.value,S+=w,T+=w*(E.x||0),R+=w*(E.y||0),L+=w*(E.z||0));_*=Math.sqrt(4/N),A.x=T/S,n>1&&(A.y=R/S),n>2&&(A.z=L/S)}else{E=A,E.x=E.data.x,n>1&&(E.y=E.data.y),n>2&&(E.z=E.data.z);do _+=u[E.data.index];while(E=E.next)}A.value=_}function v(A,_,E,w,S){if(!A.value)return!0;var T=[E,w,S][n-1],R=A.x-i.x,L=n>1?A.y-i.y:0,I=n>2?A.z-i.z:0,N=T-_,B=R*R+L*L+I*I;if(N*N/d<B)return B<f&&(R===0&&(R=ll(o),B+=R*R),n>1&&L===0&&(L=ll(o),B+=L*L),n>2&&I===0&&(I=ll(o),B+=I*I),B<h&&(B=Math.sqrt(h*B)),i.vx+=R*A.value*l/B,n>1&&(i.vy+=L*A.value*l/B),n>2&&(i.vz+=I*A.value*l/B)),!0;if(A.length||B>=f)return;(A.data!==i||A.next)&&(R===0&&(R=ll(o),B+=R*R),n>1&&L===0&&(L=ll(o),B+=L*L),n>2&&I===0&&(I=ll(o),B+=I*I),B<h&&(B=Math.sqrt(h*B)));do A.data!==i&&(N=u[A.data.index]*l/B,i.vx+=R*N,n>1&&(i.vy+=L*N),n>2&&(i.vz+=I*N));while(A=A.next)}return m.initialize=function(A,..._){r=A,o=_.find(E=>typeof E=="function")||Math.random,n=_.find(E=>[1,2,3].includes(E))||2,g()},m.strength=function(A){return arguments.length?(a=typeof A=="function"?A:fl(+A),g(),m):a},m.distanceMin=function(A){return arguments.length?(h=A*A,m):Math.sqrt(h)},m.distanceMax=function(A){return arguments.length?(f=A*A,m):Math.sqrt(f)},m.theta=function(A){return arguments.length?(d=A*A,m):Math.sqrt(d)},m}function GO(r,n,i,o){var l,a,u=fl(.1),h,f;typeof r!="function"&&(r=fl(+r)),n==null&&(n=0),i==null&&(i=0),o==null&&(o=0);function d(g){for(var x=0,v=l.length;x<v;++x){var A=l[x],_=A.x-n||1e-6,E=(A.y||0)-i||1e-6,w=(A.z||0)-o||1e-6,S=Math.sqrt(_*_+E*E+w*w),T=(f[x]-S)*h[x]*g/S;A.vx+=_*T,a>1&&(A.vy+=E*T),a>2&&(A.vz+=w*T)}}function m(){if(!!l){var g,x=l.length;for(h=new Array(x),f=new Array(x),g=0;g<x;++g)f[g]=+r(l[g],g,l),h[g]=isNaN(f[g])?0:+u(l[g],g,l)}}return d.initialize=function(g,...x){l=g,a=x.find(v=>[1,2,3].includes(v))||2,m()},d.strength=function(g){return arguments.length?(u=typeof g=="function"?g:fl(+g),m(),d):u},d.radius=function(g){return arguments.length?(r=typeof g=="function"?g:fl(+g),m(),d):r},d.x=function(g){return arguments.length?(n=+g,d):n},d.y=function(g){return arguments.length?(i=+g,d):i},d.z=function(g){return arguments.length?(o=+g,d):o},d}var Uw=function(n){TX(n);var i=SX(n);return n.on=i.on,n.off=i.off,n.fire=i.fire,n};function SX(r){var n=Object.create(null);return{on:function(i,o,l){if(typeof o!="function")throw new Error("callback is expected to be a function");var a=n[i];return a||(a=n[i]=[]),a.push({callback:o,ctx:l}),r},off:function(i,o){var l=typeof i>"u";if(l)return n=Object.create(null),r;if(n[i]){var a=typeof o!="function";if(a)delete n[i];else for(var u=n[i],h=0;h<u.length;++h)u[h].callback===o&&u.splice(h,1)}return r},fire:function(i){var o=n[i];if(!o)return r;var l;arguments.length>1&&(l=Array.prototype.splice.call(arguments,1));for(var a=0;a<o.length;++a){var u=o[a];u.callback.apply(u.ctx,l)}return r}}}function TX(r){if(!r)throw new Error("Eventify cannot use falsy object as events subject");for(var n=["on","fire","off"],i=0;i<n.length;++i)if(r.hasOwnProperty(n[i]))throw new Error("Subject cannot be eventified, since it already has property '"+n[i]+"'")}var CX=LX,RX=Uw;function LX(r){if(r=r||{},"uniqueLinkId"in r&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),r.multigraph=r.uniqueLinkId),r.multigraph===void 0&&(r.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var n=new Map,i=new Map,o={},l=0,a=r.multigraph?R:T,u=[],h=z,f=z,d=z,m=z,g={version:20,addNode:_,addLink:S,removeLink:B,removeNode:w,getNode:E,getNodeCount:L,getLinkCount:I,getEdgeCount:I,getLinksCount:I,getNodesCount:L,getLinks:N,forEachNode:ie,forEachLinkedNode:D,forEachLink:ne,beginUpdate:d,endUpdate:m,clear:le,hasLink:q,hasNode:E,getLink:q};return RX(g),x(),g;function x(){var se=g.on;g.on=ue;function ue(){return g.beginUpdate=d=X,g.endUpdate=m=Z,h=v,f=A,g.on=se,se.apply(g,arguments)}}function v(se,ue){u.push({link:se,changeType:ue})}function A(se,ue){u.push({node:se,changeType:ue})}function _(se,ue){if(se===void 0)throw new Error("Invalid node identifier");d();var ye=E(se);return ye?(ye.data=ue,f(ye,"update")):(ye=new PX(se,ue),f(ye,"add")),n.set(se,ye),m(),ye}function E(se){return n.get(se)}function w(se){var ue=E(se);if(!ue)return!1;d();var ye=ue.links;return ye&&(ye.forEach(H),ue.links=null),n.delete(se),f(ue,"remove"),m(),!0}function S(se,ue,ye){d();var Ce=E(se)||_(se),ke=E(ue)||_(ue),Oe=a(se,ue,ye),Ne=i.has(Oe.id);return i.set(Oe.id,Oe),eR(Ce,Oe),se!==ue&&eR(ke,Oe),h(Oe,Ne?"update":"add"),m(),Oe}function T(se,ue,ye){var Ce=Qv(se,ue),ke=i.get(Ce);return ke?(ke.data=ye,ke):new tR(se,ue,ye,Ce)}function R(se,ue,ye){var Ce=Qv(se,ue),ke=o.hasOwnProperty(Ce);if(ke||q(se,ue)){ke||(o[Ce]=0);var Oe="@"+ ++o[Ce];Ce=Qv(se+Oe,ue+Oe)}return new tR(se,ue,ye,Ce)}function L(){return n.size}function I(){return i.size}function N(se){var ue=E(se);return ue?ue.links:null}function B(se,ue){return ue!==void 0&&(se=q(se,ue)),H(se)}function H(se){if(!se||!i.get(se.id))return!1;d(),i.delete(se.id);var ue=E(se.fromId),ye=E(se.toId);return ue&&ue.links.delete(se),ye&&ye.links.delete(se),h(se,"remove"),m(),!0}function q(se,ue){if(!(se===void 0||ue===void 0))return i.get(Qv(se,ue))}function le(){d(),ie(function(se){w(se.id)}),m()}function ne(se){if(typeof se=="function")for(var ue=i.values(),ye=ue.next();!ye.done;){if(se(ye.value))return!0;ye=ue.next()}}function D(se,ue,ye){var Ce=E(se);if(Ce&&Ce.links&&typeof ue=="function")return ye?k(Ce.links,se,ue):O(Ce.links,se,ue)}function O(se,ue,ye){for(var Ce,ke=se.values(),Oe=ke.next();!Oe.done;){var Ne=Oe.value,He=Ne.fromId===ue?Ne.toId:Ne.fromId;if(Ce=ye(n.get(He),Ne),Ce)return!0;Oe=ke.next()}}function k(se,ue,ye){for(var Ce,ke=se.values(),Oe=ke.next();!Oe.done;){var Ne=Oe.value;if(Ne.fromId===ue&&(Ce=ye(n.get(Ne.toId),Ne),Ce))return!0;Oe=ke.next()}}function z(){}function X(){l+=1}function Z(){l-=1,l===0&&u.length>0&&(g.fire("changed",u),u.length=0)}function ie(se){if(typeof se!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+se);for(var ue=n.values(),ye=ue.next();!ye.done;){if(se(ye.value))return!0;ye=ue.next()}}}function PX(r,n){this.id=r,this.links=null,this.data=n}function eR(r,n){r.links?r.links.add(n):r.links=new Set([n])}function tR(r,n,i,o){this.fromId=r,this.toId=n,this.data=i,this.id=o}function Qv(r,n){return r.toString()+"\u{1F449} "+n.toString()}var zw={exports:{}},Bm={exports:{}},VO=function(n){return n===0?"x":n===1?"y":n===2?"z":"c"+(n+1)};const DX=VO;var df=function(n){return i;function i(o,l){let a=l&&l.indent||0,u=l&&l.join!==void 0?l.join:`
`,h=Array(a+1).join(" "),f=[];for(let d=0;d<n;++d){let m=DX(d),g=d===0?"":h;f.push(g+o.replace(/{var}/g,m))}return f.join(u)}};const WO=df;Bm.exports=OX;Bm.exports.generateCreateBodyFunctionBody=jO;Bm.exports.getVectorCode=XO;Bm.exports.getBodyCode=$O;function OX(r,n){let i=jO(r,n),{Body:o}=new Function(i)();return o}function jO(r,n){return`
${XO(r,n)}
${$O(r)}
return {Body: Body, Vector: Vector};
`}function $O(r){let n=WO(r),i=n("{var}",{join:", "});return`
function Body(${i}) {
  this.isPinned = false;
  this.pos = new Vector(${i});
  this.force = new Vector();
  this.velocity = new Vector();
  this.mass = 1;

  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.reset = function() {
  this.force.reset();
  this.springCount = 0;
  this.springLength = 0;
}

Body.prototype.setPosition = function (${i}) {
  ${n("this.pos.{var} = {var} || 0;",{indent:2})}
};`}function XO(r,n){let i=WO(r),o="";return n&&(o=`${i(`
   var v{var};
Object.defineProperty(this, '{var}', {
  set: function(v) { 
    if (!Number.isFinite(v)) throw new Error('Cannot set non-numbers to {var}');
    v{var} = v; 
  },
  get: function() { return v{var}; }
});`)}`),`function Vector(${i("{var}",{join:", "})}) {
  ${o}
    if (typeof arguments[0] === 'object') {
      // could be another vector
      let v = arguments[0];
      ${i('if (!Number.isFinite(v.{var})) throw new Error("Expected value is not a finite number at Vector constructor ({var})");',{indent:4})}
      ${i("this.{var} = v.{var};",{indent:4})}
    } else {
      ${i('this.{var} = typeof {var} === "number" ? {var} : 0;',{indent:4})}
    }
  }
  
  Vector.prototype.reset = function () {
    ${i("this.{var} = ",{join:""})}0;
  };`}var Ic={exports:{}};const Hw=df,ec=VO;Ic.exports=IX;Ic.exports.generateQuadTreeFunctionBody=qO;Ic.exports.getInsertStackCode=JO;Ic.exports.getQuadNodeCode=ZO;Ic.exports.isSamePosition=YO;Ic.exports.getChildBodyCode=QO;Ic.exports.setChildBodyCode=KO;function IX(r){let n=qO(r);return new Function(n)()}function qO(r){let n=Hw(r),i=Math.pow(2,r);return`
${JO()}
${ZO(r)}
${YO(r)}
${QO(r)}
${KO(r)}

function createQuadTree(options, random) {
  options = options || {};
  options.gravity = typeof options.gravity === 'number' ? options.gravity : -1;
  options.theta = typeof options.theta === 'number' ? options.theta : 0.8;

  var gravity = options.gravity;
  var updateQueue = [];
  var insertStack = new InsertStack();
  var theta = options.theta;

  var nodesCache = [];
  var currentInCache = 0;
  var root = newNode();

  return {
    insertBodies: insertBodies,

    /**
     * Gets root node if it is present
     */
    getRoot: function() {
      return root;
    },

    updateBodyForce: update,

    options: function(newOptions) {
      if (newOptions) {
        if (typeof newOptions.gravity === 'number') {
          gravity = newOptions.gravity;
        }
        if (typeof newOptions.theta === 'number') {
          theta = newOptions.theta;
        }

        return this;
      }

      return {
        gravity: gravity,
        theta: theta
      };
    }
  };

  function newNode() {
    // To avoid pressure on GC we reuse nodes.
    var node = nodesCache[currentInCache];
    if (node) {
${u("      node.")}
      node.body = null;
      node.mass = ${n("node.mass_{var} = ",{join:""})}0;
      ${n("node.min_{var} = node.max_{var} = ",{join:""})}0;
    } else {
      node = new QuadNode();
      nodesCache[currentInCache] = node;
    }

    ++currentInCache;
    return node;
  }

  function update(sourceBody) {
    var queue = updateQueue;
    var v;
    ${n("var d{var};",{indent:4})}
    var r; 
    ${n("var f{var} = 0;",{indent:4})}
    var queueLength = 1;
    var shiftIdx = 0;
    var pushIdx = 1;

    queue[0] = root;

    while (queueLength) {
      var node = queue[shiftIdx];
      var body = node.body;

      queueLength -= 1;
      shiftIdx += 1;
      var differentBody = (body !== sourceBody);
      if (body && differentBody) {
        // If the current node is a leaf node (and it is not source body),
        // calculate the force exerted by the current node on body, and add this
        // amount to body's net force.
        ${n("d{var} = body.pos.{var} - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Poor man's protection against zero distance.
          ${n("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});
        }

        // This is standard gravitation force calculation but we divide
        // by r^3 to save two operations when normalizing force vector.
        v = gravity * body.mass * sourceBody.mass / (r * r * r);
        ${n("f{var} += v * d{var};",{indent:8})}
      } else if (differentBody) {
        // Otherwise, calculate the ratio s / r,  where s is the width of the region
        // represented by the internal node, and r is the distance between the body
        // and the node's center-of-mass
        ${n("d{var} = node.mass_{var} / node.mass - sourceBody.pos.{var};",{indent:8})}
        r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});

        if (r === 0) {
          // Sorry about code duplication. I don't want to create many functions
          // right away. Just want to see performance first.
          ${n("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:10})}
          r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});
        }
        // If s / r < \u03B8, treat this internal node as a single body, and calculate the
        // force it exerts on sourceBody, and add this amount to sourceBody's net force.
        if ((node.max_${ec(0)} - node.min_${ec(0)}) / r < theta) {
          // in the if statement above we consider node's width only
          // because the region was made into square during tree creation.
          // Thus there is no difference between using width or height.
          v = gravity * node.mass * sourceBody.mass / (r * r * r);
          ${n("f{var} += v * d{var};",{indent:10})}
        } else {
          // Otherwise, run the procedure recursively on each of the current node's children.

          // I intentionally unfolded this loop, to save several CPU cycles.
${a()}
        }
      }
    }

    ${n("sourceBody.force.{var} += f{var};",{indent:4})}
  }

  function insertBodies(bodies) {
    ${n("var {var}min = Number.MAX_VALUE;",{indent:4})}
    ${n("var {var}max = Number.MIN_VALUE;",{indent:4})}
    var i = bodies.length;

    // To reduce quad tree depth we are looking for exact bounding box of all particles.
    while (i--) {
      var pos = bodies[i].pos;
      ${n("if (pos.{var} < {var}min) {var}min = pos.{var};",{indent:6})}
      ${n("if (pos.{var} > {var}max) {var}max = pos.{var};",{indent:6})}
    }

    // Makes the bounds square.
    var maxSideLength = -Infinity;
    ${n("if ({var}max - {var}min > maxSideLength) maxSideLength = {var}max - {var}min ;",{indent:4})}

    currentInCache = 0;
    root = newNode();
    ${n("root.min_{var} = {var}min;",{indent:4})}
    ${n("root.max_{var} = {var}min + maxSideLength;",{indent:4})}

    i = bodies.length - 1;
    if (i >= 0) {
      root.body = bodies[i];
    }
    while (i--) {
      insert(bodies[i], root);
    }
  }

  function insert(newBody) {
    insertStack.reset();
    insertStack.push(root, newBody);

    while (!insertStack.isEmpty()) {
      var stackItem = insertStack.pop();
      var node = stackItem.node;
      var body = stackItem.body;

      if (!node.body) {
        // This is internal node. Update the total mass of the node and center-of-mass.
        ${n("var {var} = body.pos.{var};",{indent:8})}
        node.mass += body.mass;
        ${n("node.mass_{var} += body.mass * {var};",{indent:8})}

        // Recursively insert the body in the appropriate quadrant.
        // But first find the appropriate quadrant.
        var quadIdx = 0; // Assume we are in the 0's quad.
        ${n("var min_{var} = node.min_{var};",{indent:8})}
        ${n("var max_{var} = (min_{var} + node.max_{var}) / 2;",{indent:8})}

${l(8)}

        var child = getChild(node, quadIdx);

        if (!child) {
          // The node is internal but this quadrant is not taken. Add
          // subnode to it.
          child = newNode();
          ${n("child.min_{var} = min_{var};",{indent:10})}
          ${n("child.max_{var} = max_{var};",{indent:10})}
          child.body = body;

          setChild(node, quadIdx, child);
        } else {
          // continue searching in this quadrant.
          insertStack.push(child, body);
        }
      } else {
        // We are trying to add to the leaf node.
        // We have to convert current leaf into internal node
        // and continue adding two nodes.
        var oldBody = node.body;
        node.body = null; // internal nodes do not cary bodies

        if (isSamePosition(oldBody.pos, body.pos)) {
          // Prevent infinite subdivision by bumping one node
          // anywhere in this quadrant
          var retriesCount = 3;
          do {
            var offset = random.nextDouble();
            ${n("var d{var} = (node.max_{var} - node.min_{var}) * offset;",{indent:12})}

            ${n("oldBody.pos.{var} = node.min_{var} + d{var};",{indent:12})}
            retriesCount -= 1;
            // Make sure we don't bump it out of the box. If we do, next iteration should fix it
          } while (retriesCount > 0 && isSamePosition(oldBody.pos, body.pos));

          if (retriesCount === 0 && isSamePosition(oldBody.pos, body.pos)) {
            // This is very bad, we ran out of precision.
            // if we do not return from the method we'll get into
            // infinite loop here. So we sacrifice correctness of layout, and keep the app running
            // Next layout iteration should get larger bounding box in the first step and fix this
            return;
          }
        }
        // Next iteration should subdivide node further.
        insertStack.push(node, oldBody);
        insertStack.push(node, body);
      }
    }
  }
}
return createQuadTree;

`;function l(h){let f=[],d=Array(h+1).join(" ");for(let m=0;m<r;++m)f.push(d+`if (${ec(m)} > max_${ec(m)}) {`),f.push(d+`  quadIdx = quadIdx + ${Math.pow(2,m)};`),f.push(d+`  min_${ec(m)} = max_${ec(m)};`),f.push(d+`  max_${ec(m)} = node.max_${ec(m)};`),f.push(d+"}");return f.join(`
`)}function a(){let h=Array(11).join(" "),f=[];for(let d=0;d<i;++d)f.push(h+`if (node.quad${d}) {`),f.push(h+`  queue[pushIdx] = node.quad${d};`),f.push(h+"  queueLength += 1;"),f.push(h+"  pushIdx += 1;"),f.push(h+"}");return f.join(`
`)}function u(h){let f=[];for(let d=0;d<i;++d)f.push(`${h}quad${d} = null;`);return f.join(`
`)}}function YO(r){let n=Hw(r);return`
  function isSamePosition(point1, point2) {
    ${n("var d{var} = Math.abs(point1.{var} - point2.{var});",{indent:2})}
  
    return ${n("d{var} < 1e-8",{join:" && "})};
  }  
`}function KO(r){var n=Math.pow(2,r);return`
function setChild(node, idx, child) {
  ${i()}
}`;function i(){let o=[];for(let l=0;l<n;++l){let a=l===0?"  ":"  else ";o.push(`${a}if (idx === ${l}) node.quad${l} = child;`)}return o.join(`
`)}}function QO(r){return`function getChild(node, idx) {
${n()}
  return null;
}`;function n(){let i=[],o=Math.pow(2,r);for(let l=0;l<o;++l)i.push(`  if (idx === ${l}) return node.quad${l};`);return i.join(`
`)}}function ZO(r){let n=Hw(r),i=Math.pow(2,r);var o=`
function QuadNode() {
  // body stored inside this node. In quad tree only leaf nodes (by construction)
  // contain bodies:
  this.body = null;

  // Child nodes are stored in quads. Each quad is presented by number:
  // 0 | 1
  // -----
  // 2 | 3
${l("  this.")}

  // Total mass of current node
  this.mass = 0;

  // Center of mass coordinates
  ${n("this.mass_{var} = 0;",{indent:2})}

  // bounding box coordinates
  ${n("this.min_{var} = 0;",{indent:2})}
  ${n("this.max_{var} = 0;",{indent:2})}
}
`;return o;function l(a){let u=[];for(let h=0;h<i;++h)u.push(`${a}quad${h} = null;`);return u.join(`
`)}}function JO(){return`
/**
 * Our implementation of QuadTree is non-recursive to avoid GC hit
 * This data structure represent stack of elements
 * which we are trying to insert into quad tree.
 */
function InsertStack () {
    this.stack = [];
    this.popIdx = 0;
}

InsertStack.prototype = {
    isEmpty: function() {
        return this.popIdx === 0;
    },
    push: function (node, body) {
        var item = this.stack[this.popIdx];
        if (!item) {
            // we are trying to avoid memory pressure: create new element
            // only when absolutely necessary
            this.stack[this.popIdx] = new InsertStackElement(node, body);
        } else {
            item.node = node;
            item.body = body;
        }
        ++this.popIdx;
    },
    pop: function () {
        if (this.popIdx > 0) {
            return this.stack[--this.popIdx];
        }
    },
    reset: function () {
        this.popIdx = 0;
    }
};

function InsertStackElement(node, body) {
    this.node = node; // QuadTree node
    this.body = body; // physical body which needs to be inserted to node
}
`}var Gw={exports:{}};Gw.exports=NX;Gw.exports.generateFunctionBody=eI;const kX=df;function NX(r){let n=eI(r);return new Function("bodies","settings","random",n)}function eI(r){let n=kX(r);return`
  var boundingBox = {
    ${n("min_{var}: 0, max_{var}: 0,",{indent:4})}
  };

  return {
    box: boundingBox,

    update: updateBoundingBox,

    reset: resetBoundingBox,

    getBestNewPosition: function (neighbors) {
      var ${n("base_{var} = 0",{join:", "})};

      if (neighbors.length) {
        for (var i = 0; i < neighbors.length; ++i) {
          let neighborPos = neighbors[i].pos;
          ${n("base_{var} += neighborPos.{var};",{indent:10})}
        }

        ${n("base_{var} /= neighbors.length;",{indent:8})}
      } else {
        ${n("base_{var} = (boundingBox.min_{var} + boundingBox.max_{var}) / 2;",{indent:8})}
      }

      var springLength = settings.springLength;
      return {
        ${n("{var}: base_{var} + (random.nextDouble() - 0.5) * springLength,",{indent:8})}
      };
    }
  };

  function updateBoundingBox() {
    var i = bodies.length;
    if (i === 0) return; // No bodies - no borders.

    ${n("var max_{var} = -Infinity;",{indent:4})}
    ${n("var min_{var} = Infinity;",{indent:4})}

    while(i--) {
      // this is O(n), it could be done faster with quadtree, if we check the root node bounds
      var bodyPos = bodies[i].pos;
      ${n("if (bodyPos.{var} < min_{var}) min_{var} = bodyPos.{var};",{indent:6})}
      ${n("if (bodyPos.{var} > max_{var}) max_{var} = bodyPos.{var};",{indent:6})}
    }

    ${n("boundingBox.min_{var} = min_{var};",{indent:4})}
    ${n("boundingBox.max_{var} = max_{var};",{indent:4})}
  }

  function resetBoundingBox() {
    ${n("boundingBox.min_{var} = boundingBox.max_{var} = 0;",{indent:4})}
  }
`}var Vw={exports:{}};const FX=df;Vw.exports=BX;Vw.exports.generateCreateDragForceFunctionBody=tI;function BX(r){let n=tI(r);return new Function("options",n)}function tI(r){return`
  if (!Number.isFinite(options.dragCoefficient)) throw new Error('dragCoefficient is not a finite number');

  return {
    update: function(body) {
      ${FX(r)("body.force.{var} -= options.dragCoefficient * body.velocity.{var};",{indent:6})}
    }
  };
`}var Ww={exports:{}};const UX=df;Ww.exports=zX;Ww.exports.generateCreateSpringForceFunctionBody=nI;function zX(r){let n=nI(r);return new Function("options","random",n)}function nI(r){let n=UX(r);return`
  if (!Number.isFinite(options.springCoefficient)) throw new Error('Spring coefficient is not a number');
  if (!Number.isFinite(options.springLength)) throw new Error('Spring length is not a number');

  return {
    /**
     * Updates forces acting on a spring
     */
    update: function (spring) {
      var body1 = spring.from;
      var body2 = spring.to;
      var length = spring.length < 0 ? options.springLength : spring.length;
      ${n("var d{var} = body2.pos.{var} - body1.pos.{var};",{indent:6})}
      var r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});

      if (r === 0) {
        ${n("d{var} = (random.nextDouble() - 0.5) / 50;",{indent:8})}
        r = Math.sqrt(${n("d{var} * d{var}",{join:" + "})});
      }

      var d = r - length;
      var coefficient = ((spring.coefficient > 0) ? spring.coefficient : options.springCoefficient) * d / r;

      ${n("body1.force.{var} += coefficient * d{var}",{indent:6})};
      body1.springCount += 1;
      body1.springLength += r;

      ${n("body2.force.{var} -= coefficient * d{var}",{indent:6})};
      body2.springCount += 1;
      body2.springLength += r;
    }
  };
`}var jw={exports:{}};const HX=df;jw.exports=GX;jw.exports.generateIntegratorFunctionBody=iI;function GX(r){let n=iI(r);return new Function("bodies","timeStep","adaptiveTimeStepWeight",n)}function iI(r){let n=HX(r);return`
  var length = bodies.length;
  if (length === 0) return 0;

  ${n("var d{var} = 0, t{var} = 0;",{indent:2})}

  for (var i = 0; i < length; ++i) {
    var body = bodies[i];
    if (body.isPinned) continue;

    if (adaptiveTimeStepWeight && body.springCount) {
      timeStep = (adaptiveTimeStepWeight * body.springLength/body.springCount);
    }

    var coeff = timeStep / body.mass;

    ${n("body.velocity.{var} += coeff * body.force.{var};",{indent:4})}
    ${n("var v{var} = body.velocity.{var};",{indent:4})}
    var v = Math.sqrt(${n("v{var} * v{var}",{join:" + "})});

    if (v > 1) {
      // We normalize it so that we move within timeStep range. 
      // for the case when v <= 1 - we let velocity to fade out.
      ${n("body.velocity.{var} = v{var} / v;",{indent:6})}
    }

    ${n("d{var} = timeStep * body.velocity.{var};",{indent:4})}

    ${n("body.pos.{var} += d{var};",{indent:4})}

    ${n("t{var} += Math.abs(d{var});",{indent:4})}
  }

  return (${n("t{var} * t{var}",{join:" + "})})/length;
`}var r1,nR;function VX(){if(nR)return r1;nR=1,r1=r;function r(n,i,o,l){this.from=n,this.to=i,this.length=o,this.coefficient=l}return r1}var s1,iR;function WX(){if(iR)return s1;iR=1,s1=r;function r(n,i){var o;if(n||(n={}),i){for(o in i)if(i.hasOwnProperty(o)){var l=n.hasOwnProperty(o),a=typeof i[o],u=!l||typeof n[o]!==a;u?n[o]=i[o]:a==="object"&&(n[o]=r(n[o],i[o]))}}return n}return s1}var mp={exports:{}},rR;function jX(){if(rR)return mp.exports;rR=1,mp.exports=r,mp.exports.random=r,mp.exports.randomIterator=h;function r(f){var d=typeof f=="number"?f:+new Date;return new n(d)}function n(f){this.seed=f}n.prototype.next=u,n.prototype.nextDouble=a,n.prototype.uniform=a,n.prototype.gaussian=i;function i(){var f,d,m;do d=this.nextDouble()*2-1,m=this.nextDouble()*2-1,f=d*d+m*m;while(f>=1||f===0);return d*Math.sqrt(-2*Math.log(f)/f)}n.prototype.levy=o;function o(){var f=1.5,d=Math.pow(l(1+f)*Math.sin(Math.PI*f/2)/(l((1+f)/2)*f*Math.pow(2,(f-1)/2)),1/f);return this.gaussian()*d/Math.pow(Math.abs(this.gaussian()),1/f)}function l(f){return Math.sqrt(2*Math.PI/f)*Math.pow(1/Math.E*(f+1/(12*f-1/(10*f))),f)}function a(){var f=this.seed;return f=f+2127912214+(f<<12)&4294967295,f=(f^3345072700^f>>>19)&4294967295,f=f+374761393+(f<<5)&4294967295,f=(f+3550635116^f<<9)&4294967295,f=f+4251993797+(f<<3)&4294967295,f=(f^3042594569^f>>>16)&4294967295,this.seed=f,(f&268435455)/268435456}function u(f){return Math.floor(this.nextDouble()*f)}function h(f,d){var m=d||r();if(typeof m.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:x,shuffle:g};function g(){var v,A,_;for(v=f.length-1;v>0;--v)A=m.next(v+1),_=f[A],f[A]=f[v],f[v]=_;return f}function x(v){var A,_,E;for(A=f.length-1;A>0;--A)_=m.next(A+1),E=f[_],f[_]=f[A],f[A]=E,v(E);f.length&&v(f[0])}}return mp.exports}var rI=ZX,$X=Bm.exports,XX=Ic.exports,qX=Gw.exports,YX=Vw.exports,KX=Ww.exports,QX=jw.exports,sR={};function ZX(r){var n=VX(),i=WX(),o=Uw;if(r){if(r.springCoeff!==void 0)throw new Error("springCoeff was renamed to springCoefficient");if(r.dragCoeff!==void 0)throw new Error("dragCoeff was renamed to dragCoefficient")}r=i(r,{springLength:10,springCoefficient:.8,gravity:-12,theta:.8,dragCoefficient:.9,timeStep:.5,adaptiveTimeStepWeight:0,dimensions:2,debug:!1});var l=sR[r.dimensions];if(!l){var a=r.dimensions;l={Body:$X(a,r.debug),createQuadTree:XX(a),createBounds:qX(a),createDragForce:YX(a),createSpringForce:KX(a),integrate:QX(a)},sR[a]=l}var u=l.Body,h=l.createQuadTree,f=l.createBounds,d=l.createDragForce,m=l.createSpringForce,g=l.integrate,x=k=>new u(k),v=jX().random(42),A=[],_=[],E=h(r,v),w=f(A,r,v),S=m(r,v),T=d(r),R=0,L=[],I=new Map,N=0;q("nbody",D),q("spring",O);var B={bodies:A,quadTree:E,springs:_,settings:r,addForce:q,removeForce:le,getForces:ne,step:function(){for(var k=0;k<L.length;++k)L[k](N);var z=g(A,r.timeStep,r.adaptiveTimeStepWeight);return N+=1,z},addBody:function(k){if(!k)throw new Error("Body is required");return A.push(k),k},addBodyAt:function(k){if(!k)throw new Error("Body position is required");var z=x(k);return A.push(z),z},removeBody:function(k){if(!!k){var z=A.indexOf(k);if(!(z<0))return A.splice(z,1),A.length===0&&w.reset(),!0}},addSpring:function(k,z,X,Z){if(!k||!z)throw new Error("Cannot add null spring to force simulator");typeof X!="number"&&(X=-1);var ie=new n(k,z,X,Z>=0?Z:-1);return _.push(ie),ie},getTotalMovement:function(){return R},removeSpring:function(k){if(!!k){var z=_.indexOf(k);if(z>-1)return _.splice(z,1),!0}},getBestNewBodyPosition:function(k){return w.getBestNewPosition(k)},getBBox:H,getBoundingBox:H,invalidateBBox:function(){console.warn("invalidateBBox() is deprecated, bounds always recomputed on `getBBox()` call")},gravity:function(k){return k!==void 0?(r.gravity=k,E.options({gravity:k}),this):r.gravity},theta:function(k){return k!==void 0?(r.theta=k,E.options({theta:k}),this):r.theta},random:v};return JX(r,B),o(B),B;function H(){return w.update(),w.box}function q(k,z){if(I.has(k))throw new Error("Force "+k+" is already added");I.set(k,z),L.push(z)}function le(k){var z=L.indexOf(I.get(k));z<0||(L.splice(z,1),I.delete(k))}function ne(){return I}function D(){if(A.length!==0){E.insertBodies(A);for(var k=A.length;k--;){var z=A[k];z.isPinned||(z.reset(),E.updateBodyForce(z),T.update(z))}}}function O(){for(var k=_.length;k--;)S.update(_[k])}}function JX(r,n){for(var i in r)eq(r,n,i)}function eq(r,n,i){if(!!r.hasOwnProperty(i)&&typeof n[i]!="function"){var o=Number.isFinite(r[i]);o?n[i]=function(l){if(l!==void 0){if(!Number.isFinite(l))throw new Error("Value of "+i+" should be a valid number.");return r[i]=l,n}return r[i]}:n[i]=function(l){return l!==void 0?(r[i]=l,n):r[i]}}}zw.exports=nq;zw.exports.simulator=rI;var tq=Uw;function nq(r,n){if(!r)throw new Error("Graph structure cannot be undefined");var i=n&&n.createSimulator||rI,o=i(n);if(Array.isArray(n))throw new Error("Physics settings is expected to be an object");var l=r.version>19?D:ne;n&&typeof n.nodeMass=="function"&&(l=n.nodeMass);var a=new Map,u={},h=0,f=o.settings.springTransform||iq;T(),E();var d=!1,m={step:function(){if(h===0)return g(!0),!0;var O=o.step();m.lastMove=O,m.fire("step");var k=O/h,z=k<=.01;return g(z),z},getNodePosition:function(O){return le(O).pos},setNodePosition:function(O){var k=le(O);k.setPosition.apply(k,Array.prototype.slice.call(arguments,1))},getLinkPosition:function(O){var k=u[O];if(k)return{from:k.from.pos,to:k.to.pos}},getGraphRect:function(){return o.getBBox()},forEachBody:x,pinNode:function(O,k){var z=le(O.id);z.isPinned=!!k},isNodePinned:function(O){return le(O.id).isPinned},dispose:function(){r.off("changed",S),m.fire("disposed")},getBody:_,getSpring:A,getForceVectorLength:v,simulator:o,graph:r,lastMove:0};return tq(m),m;function g(O){d!==O&&(d=O,w(O))}function x(O){a.forEach(O)}function v(){var O=0,k=0;return x(function(z){O+=Math.abs(z.force.x),k+=Math.abs(z.force.y)}),Math.sqrt(O*O+k*k)}function A(O,k){var z;if(k===void 0)typeof O!="object"?z=O:z=O.id;else{var X=r.hasLink(O,k);if(!X)return;z=X.id}return u[z]}function _(O){return a.get(O)}function E(){r.on("changed",S)}function w(O){m.fire("stable",O)}function S(O){for(var k=0;k<O.length;++k){var z=O[k];z.changeType==="add"?(z.node&&R(z.node.id),z.link&&I(z.link)):z.changeType==="remove"&&(z.node&&L(z.node),z.link&&N(z.link))}h=r.getNodesCount()}function T(){h=0,r.forEachNode(function(O){R(O.id),h+=1}),r.forEachLink(I)}function R(O){var k=a.get(O);if(!k){var z=r.getNode(O);if(!z)throw new Error("initBody() was called with unknown node id");var X=z.position;if(!X){var Z=B(z);X=o.getBestNewBodyPosition(Z)}k=o.addBodyAt(X),k.id=O,a.set(O,k),H(O),q(z)&&(k.isPinned=!0)}}function L(O){var k=O.id,z=a.get(k);z&&(a.delete(k),o.removeBody(z))}function I(O){H(O.fromId),H(O.toId);var k=a.get(O.fromId),z=a.get(O.toId),X=o.addSpring(k,z,O.length);f(O,X),u[O.id]=X}function N(O){var k=u[O.id];if(k){var z=r.getNode(O.fromId),X=r.getNode(O.toId);z&&H(z.id),X&&H(X.id),delete u[O.id],o.removeSpring(k)}}function B(O){var k=[];if(!O.links)return k;for(var z=Math.min(O.links.length,2),X=0;X<z;++X){var Z=O.links[X],ie=Z.fromId!==O.id?a.get(Z.fromId):a.get(Z.toId);ie&&ie.pos&&k.push(ie)}return k}function H(O){var k=a.get(O);if(k.mass=l(O),Number.isNaN(k.mass))throw new Error("Node mass should be a number")}function q(O){return O&&(O.isPinned||O.data&&O.data.isPinned)}function le(O){var k=a.get(O);return k||(R(O),k=a.get(O)),k}function ne(O){var k=r.getLinks(O);return k?1+k.length/3:1}function D(O){var k=r.getLinks(O);return k?1+k.size/3:1}}function iq(){}function jE(r,n,i){var o,l,a,u,h;n==null&&(n=100);function f(){var m=Date.now()-u;m<n&&m>=0?o=setTimeout(f,n-m):(o=null,i||(h=r.apply(a,l),a=l=null))}var d=function(){a=this,l=arguments,u=Date.now();var m=i&&!o;return o||(o=setTimeout(f,n)),m&&(h=r.apply(a,l),a=l=null),h};return d.clear=function(){o&&(clearTimeout(o),o=null)},d.flush=function(){o&&(h=r.apply(a,l),a=l=null,clearTimeout(o),o=null)},d}jE.debounce=jE;var rq=jE;function sq(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function oR(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function oq(r,n,i){return n&&oR(r.prototype,n),i&&oR(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}function aq(r,n){return lq(r)||cq(r,n)||uq(r,n)||hq()}function lq(r){if(Array.isArray(r))return r}function cq(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function uq(r,n){if(!!r){if(typeof r=="string")return aR(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return aR(r,n)}}function aR(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function hq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dq=oq(function r(n,i){var o=i.default,l=o===void 0?null:o,a=i.triggerUpdate,u=a===void 0?!0:a,h=i.onChange,f=h===void 0?function(d,m){}:h;sq(this,r),this.name=n,this.defaultVal=l,this.triggerUpdate=u,this.onChange=f});function Yu(r){var n=r.stateInit,i=n===void 0?function(){return{}}:n,o=r.props,l=o===void 0?{}:o,a=r.methods,u=a===void 0?{}:a,h=r.aliases,f=h===void 0?{}:h,d=r.init,m=d===void 0?function(){}:d,g=r.update,x=g===void 0?function(){}:g,v=Object.keys(l).map(function(A){return new dq(A,l[A])});return function(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=Object.assign({},i instanceof Function?i(A):i,{initialised:!1}),E={};function w(R){return S(R,A),T(),w}var S=function(L,I){m.call(w,L,_,I),_.initialised=!0},T=rq(function(){!_.initialised||(x.call(w,_,E),E={})},1);return v.forEach(function(R){w[R.name]=L(R);function L(I){var N=I.name,B=I.triggerUpdate,H=B===void 0?!1:B,q=I.onChange,le=q===void 0?function(O,k){}:q,ne=I.defaultVal,D=ne===void 0?null:ne;return function(O){var k=_[N];if(!arguments.length)return k;var z=O===void 0?D:O;return _[N]=z,le.call(w,z,_,k),!E.hasOwnProperty(N)&&(E[N]=k),H&&T(),w}}}),Object.keys(u).forEach(function(R){w[R]=function(){for(var L,I=arguments.length,N=new Array(I),B=0;B<I;B++)N[B]=arguments[B];return(L=u[R]).call.apply(L,[w,_].concat(N))}}),Object.entries(f).forEach(function(R){var L=aq(R,2),I=L[0],N=L[1];return w[I]=w[N]}),w.resetProps=function(){return v.forEach(function(R){w[R.name](R.defaultVal)}),w},w.resetProps(),_._rerender=T,w}}class lR extends Map{constructor(n,i=mq){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),n!=null)for(const[o,l]of n)this.set(o,l)}get(n){return super.get(cR(this,n))}has(n){return super.has(cR(this,n))}set(n,i){return super.set(fq(this,n),i)}delete(n){return super.delete(pq(this,n))}}function cR({_intern:r,_key:n},i){const o=n(i);return r.has(o)?r.get(o):i}function fq({_intern:r,_key:n},i){const o=n(i);return r.has(o)?r.get(o):(r.set(o,i),i)}function pq({_intern:r,_key:n},i){const o=n(i);return r.has(o)&&(i=r.get(o),r.delete(o)),i}function mq(r){return r!==null&&typeof r=="object"?r.valueOf():r}function $E(r,n){let i;if(n===void 0)for(const o of r)o!=null&&(i<o||i===void 0&&o>=o)&&(i=o);else{let o=-1;for(let l of r)(l=n(l,++o,r))!=null&&(i<l||i===void 0&&l>=l)&&(i=l)}return i}function XE(r,n){let i;if(n===void 0)for(const o of r)o!=null&&(i>o||i===void 0&&o>=o)&&(i=o);else{let o=-1;for(let l of r)(l=n(l,++o,r))!=null&&(i>l||i===void 0&&l>=l)&&(i=l)}return i}function gq(r,n){if(r==null)return{};var i={},o=Object.keys(r),l,a;for(a=0;a<o.length;a++)l=o[a],!(n.indexOf(l)>=0)&&(i[l]=r[l]);return i}function vq(r,n){if(r==null)return{};var i=gq(r,n),o,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(l=0;l<a.length;l++)o=a[l],!(n.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(r,o)||(i[o]=r[o]))}return i}function yq(r,n){return bq(r)||Aq(r,n)||sI(r,n)||Mq()}function xq(r){return _q(r)||Eq(r)||sI(r)||wq()}function _q(r){if(Array.isArray(r))return qE(r)}function bq(r){if(Array.isArray(r))return r}function Eq(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Aq(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function sI(r,n){if(!!r){if(typeof r=="string")return qE(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return qE(r,n)}}function qE(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function wq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sq(r,n){if(typeof r!="object"||r===null)return r;var i=r[Symbol.toPrimitive];if(i!==void 0){var o=i.call(r,n||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(r)}function Tq(r){var n=Sq(r,"string");return typeof n=="symbol"?n:String(n)}var YE=function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,l=(n instanceof Array?n.length?n:[void 0]:[n]).map(function(h){return{keyAccessor:h,isProp:!(h instanceof Function)}}),a=r.reduce(function(h,f){var d=h,m=f;return l.forEach(function(g,x){var v=g.keyAccessor,A=g.isProp,_;if(A){var E=m,w=E[v],S=vq(E,[v].map(Tq));_=w,m=S}else _=v(m,x);x+1<l.length?(d.hasOwnProperty(_)||(d[_]={}),d=d[_]):i?(d.hasOwnProperty(_)||(d[_]=[]),d[_].push(m)):d[_]=m}),h},{});i instanceof Function&&function h(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;d===l.length?Object.keys(f).forEach(function(m){return f[m]=i(f[m])}):Object.values(f).forEach(function(m){return h(m,d+1)})}(a);var u=a;return o&&(u=[],function h(f){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];d.length===l.length?u.push({keys:d,vals:f}):Object.entries(f).forEach(function(m){var g=yq(m,2),x=g[0],v=g[1];return h(v,[].concat(xq(d),[x]))})}(a),n instanceof Array&&n.length===0&&u.length===1&&(u[0].keys=[])),u};function uR(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),i.push.apply(i,o)}return i}function Cq(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?uR(Object(i),!0).forEach(function(o){oI(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):uR(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function oI(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function Rq(r,n){if(r==null)return{};var i={},o=Object.keys(r),l,a;for(a=0;a<o.length;a++)l=o[a],!(n.indexOf(l)>=0)&&(i[l]=r[l]);return i}function Lq(r,n){if(r==null)return{};var i=Rq(r,n),o,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(l=0;l<a.length;l++)o=a[l],!(n.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(r,o)||(i[o]=r[o]))}return i}function aI(r,n){return Dq(r)||Iq(r,n)||lI(r,n)||Nq()}function gy(r){return Pq(r)||Oq(r)||lI(r)||kq()}function Pq(r){if(Array.isArray(r))return KE(r)}function Dq(r){if(Array.isArray(r))return r}function Oq(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Iq(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function lI(r,n){if(!!r){if(typeof r=="string")return KE(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return KE(r,n)}}function KE(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function kq(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nq(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Fq=["createObj","updateObj","exitObj","objBindAttr","dataBindAttr"];function Bq(r,n,i){var o={enter:[],update:[],exit:[]};if(i){var u=YE(r,i,!1),h=YE(n,i,!1),f=Object.assign({},u,h);Object.entries(f).forEach(function(d){var m=aI(d,2),g=m[0],x=m[1],v=u.hasOwnProperty(g)?h.hasOwnProperty(g)?"update":"exit":"enter";o[v].push(v==="update"?[u[g],h[g]]:x)})}else{var l=new Set(r),a=new Set(n);new Set([].concat(gy(l),gy(a))).forEach(function(d){var m=l.has(d)?a.has(d)?"update":"exit":"enter";o[m].push(m==="update"?[d,d]:d)})}return o}function Uq(r,n,i){var o=i.objBindAttr,l=o===void 0?"__obj":o,a=i.dataBindAttr,u=a===void 0?"__data":a,h=i.idAccessor,f=i.purge,d=f===void 0?!1:f,m=function(E){return E.hasOwnProperty(u)},g=n.filter(function(_){return!m(_)}),x=n.filter(m).map(function(_){return _[u]}),v=r,A=d?{enter:v,exit:x,update:[]}:Bq(x,v,h);return A.update=A.update.map(function(_){var E=aI(_,2),w=E[0],S=E[1];return w!==S&&(S[l]=w[l],S[l][u]=S),S}),A.exit=A.exit.concat(g.map(function(_){return oI({},l,_)})),A}function zq(r,n,i,o,l){var a=l.createObj,u=a===void 0?function(B){return{}}:a,h=l.updateObj,f=h===void 0?function(B,H){}:h,d=l.exitObj,m=d===void 0?function(B){}:d,g=l.objBindAttr,x=g===void 0?"__obj":g,v=l.dataBindAttr,A=v===void 0?"__data":v,_=Lq(l,Fq),E=Uq(r,n,Cq({objBindAttr:x,dataBindAttr:A},_)),w=E.enter,S=E.update,T=E.exit;T.forEach(function(B){var H=B[x];delete B[x],m(H),o(H)});var R=I(w),L=[].concat(gy(w),gy(S));N(L),R.forEach(i);function I(B){var H=[];return B.forEach(function(q){var le=u(q);le&&(le[A]=q,q[x]=le,H.push(le))}),H}function N(B){B.forEach(function(H){var q=H[x];q&&(q[A]=H,f(q,H))})}}function Hq(r,n){switch(arguments.length){case 0:break;case 1:this.range(r);break;default:this.range(n).domain(r);break}return this}const hR=Symbol("implicit");function $w(){var r=new lR,n=[],i=[],o=hR;function l(a){let u=r.get(a);if(u===void 0){if(o!==hR)return o;r.set(a,u=n.push(a)-1)}return i[u%i.length]}return l.domain=function(a){if(!arguments.length)return n.slice();n=[],r=new lR;for(const u of a)r.has(u)||r.set(u,n.push(u)-1);return l},l.range=function(a){return arguments.length?(i=Array.from(a),l):i.slice()},l.unknown=function(a){return arguments.length?(o=a,l):o},l.copy=function(){return $w(n,i).unknown(o)},Hq.apply(l,arguments),l}function Xw(r,n,i){r.prototype=n.prototype=i,i.constructor=r}function cI(r,n){var i=Object.create(r.prototype);for(var o in n)i[o]=n[o];return i}function Um(){}var Em=.7,vy=1/Em,Bd="\\s*([+-]?\\d+)\\s*",Am="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Gq=/^#([0-9a-f]{3,8})$/,Vq=new RegExp(`^rgb\\(${Bd},${Bd},${Bd}\\)$`),Wq=new RegExp(`^rgb\\(${Ca},${Ca},${Ca}\\)$`),jq=new RegExp(`^rgba\\(${Bd},${Bd},${Bd},${Am}\\)$`),$q=new RegExp(`^rgba\\(${Ca},${Ca},${Ca},${Am}\\)$`),Xq=new RegExp(`^hsl\\(${Am},${Ca},${Ca}\\)$`),qq=new RegExp(`^hsla\\(${Am},${Ca},${Ca},${Am}\\)$`),dR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xw(Um,wm,{copy(r){return Object.assign(new this.constructor,this,r)},displayable(){return this.rgb().displayable()},hex:fR,formatHex:fR,formatHex8:Yq,formatHsl:Kq,formatRgb:pR,toString:pR});function fR(){return this.rgb().formatHex()}function Yq(){return this.rgb().formatHex8()}function Kq(){return uI(this).formatHsl()}function pR(){return this.rgb().formatRgb()}function wm(r){var n,i;return r=(r+"").trim().toLowerCase(),(n=Gq.exec(r))?(i=n[1].length,n=parseInt(n[1],16),i===6?mR(n):i===3?new Bs(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):i===8?Zv(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):i===4?Zv(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Vq.exec(r))?new Bs(n[1],n[2],n[3],1):(n=Wq.exec(r))?new Bs(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=jq.exec(r))?Zv(n[1],n[2],n[3],n[4]):(n=$q.exec(r))?Zv(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Xq.exec(r))?yR(n[1],n[2]/100,n[3]/100,1):(n=qq.exec(r))?yR(n[1],n[2]/100,n[3]/100,n[4]):dR.hasOwnProperty(r)?mR(dR[r]):r==="transparent"?new Bs(NaN,NaN,NaN,0):null}function mR(r){return new Bs(r>>16&255,r>>8&255,r&255,1)}function Zv(r,n,i,o){return o<=0&&(r=n=i=NaN),new Bs(r,n,i,o)}function Qq(r){return r instanceof Um||(r=wm(r)),r?(r=r.rgb(),new Bs(r.r,r.g,r.b,r.opacity)):new Bs}function QE(r,n,i,o){return arguments.length===1?Qq(r):new Bs(r,n,i,o==null?1:o)}function Bs(r,n,i,o){this.r=+r,this.g=+n,this.b=+i,this.opacity=+o}Xw(Bs,QE,cI(Um,{brighter(r){return r=r==null?vy:Math.pow(vy,r),new Bs(this.r*r,this.g*r,this.b*r,this.opacity)},darker(r){return r=r==null?Em:Math.pow(Em,r),new Bs(this.r*r,this.g*r,this.b*r,this.opacity)},rgb(){return this},clamp(){return new Bs(Ou(this.r),Ou(this.g),Ou(this.b),yy(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gR,formatHex:gR,formatHex8:Zq,formatRgb:vR,toString:vR}));function gR(){return`#${Mu(this.r)}${Mu(this.g)}${Mu(this.b)}`}function Zq(){return`#${Mu(this.r)}${Mu(this.g)}${Mu(this.b)}${Mu((isNaN(this.opacity)?1:this.opacity)*255)}`}function vR(){const r=yy(this.opacity);return`${r===1?"rgb(":"rgba("}${Ou(this.r)}, ${Ou(this.g)}, ${Ou(this.b)}${r===1?")":`, ${r})`}`}function yy(r){return isNaN(r)?1:Math.max(0,Math.min(1,r))}function Ou(r){return Math.max(0,Math.min(255,Math.round(r)||0))}function Mu(r){return r=Ou(r),(r<16?"0":"")+r.toString(16)}function yR(r,n,i,o){return o<=0?r=n=i=NaN:i<=0||i>=1?r=n=NaN:n<=0&&(r=NaN),new Ko(r,n,i,o)}function uI(r){if(r instanceof Ko)return new Ko(r.h,r.s,r.l,r.opacity);if(r instanceof Um||(r=wm(r)),!r)return new Ko;if(r instanceof Ko)return r;r=r.rgb();var n=r.r/255,i=r.g/255,o=r.b/255,l=Math.min(n,i,o),a=Math.max(n,i,o),u=NaN,h=a-l,f=(a+l)/2;return h?(n===a?u=(i-o)/h+(i<o)*6:i===a?u=(o-n)/h+2:u=(n-i)/h+4,h/=f<.5?a+l:2-a-l,u*=60):h=f>0&&f<1?0:u,new Ko(u,h,f,r.opacity)}function Jq(r,n,i,o){return arguments.length===1?uI(r):new Ko(r,n,i,o==null?1:o)}function Ko(r,n,i,o){this.h=+r,this.s=+n,this.l=+i,this.opacity=+o}Xw(Ko,Jq,cI(Um,{brighter(r){return r=r==null?vy:Math.pow(vy,r),new Ko(this.h,this.s,this.l*r,this.opacity)},darker(r){return r=r==null?Em:Math.pow(Em,r),new Ko(this.h,this.s,this.l*r,this.opacity)},rgb(){var r=this.h%360+(this.h<0)*360,n=isNaN(r)||isNaN(this.s)?0:this.s,i=this.l,o=i+(i<.5?i:1-i)*n,l=2*i-o;return new Bs(o1(r>=240?r-240:r+120,l,o),o1(r,l,o),o1(r<120?r+240:r-120,l,o),this.opacity)},clamp(){return new Ko(xR(this.h),Jv(this.s),Jv(this.l),yy(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const r=yy(this.opacity);return`${r===1?"hsl(":"hsla("}${xR(this.h)}, ${Jv(this.s)*100}%, ${Jv(this.l)*100}%${r===1?")":`, ${r})`}`}}));function xR(r){return r=(r||0)%360,r<0?r+360:r}function Jv(r){return Math.max(0,Math.min(1,r||0))}function o1(r,n,i){return(r<60?n+(i-n)*r/60:r<180?i:r<240?n+(i-n)*(240-r)/60:n)*255}const hI=r=>()=>r;function eY(r,n){return function(i){return r+i*n}}function tY(r,n,i){return r=Math.pow(r,i),n=Math.pow(n,i)-r,i=1/i,function(o){return Math.pow(r+o*n,i)}}function nY(r){return(r=+r)==1?dI:function(n,i){return i-n?tY(n,i,r):hI(isNaN(n)?i:n)}}function dI(r,n){var i=n-r;return i?eY(r,i):hI(isNaN(r)?n:r)}const _R=function r(n){var i=nY(n);function o(l,a){var u=i((l=QE(l)).r,(a=QE(a)).r),h=i(l.g,a.g),f=i(l.b,a.b),d=dI(l.opacity,a.opacity);return function(m){return l.r=u(m),l.g=h(m),l.b=f(m),l.opacity=d(m),l+""}}return o.gamma=r,o}(1);function uc(r,n){return r=+r,n=+n,function(i){return r*(1-i)+n*i}}var ZE=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,a1=new RegExp(ZE.source,"g");function iY(r){return function(){return r}}function rY(r){return function(n){return r(n)+""}}function sY(r,n){var i=ZE.lastIndex=a1.lastIndex=0,o,l,a,u=-1,h=[],f=[];for(r=r+"",n=n+"";(o=ZE.exec(r))&&(l=a1.exec(n));)(a=l.index)>i&&(a=n.slice(i,a),h[u]?h[u]+=a:h[++u]=a),(o=o[0])===(l=l[0])?h[u]?h[u]+=l:h[++u]=l:(h[++u]=null,f.push({i:u,x:uc(o,l)})),i=a1.lastIndex;return i<n.length&&(a=n.slice(i),h[u]?h[u]+=a:h[++u]=a),h.length<2?f[0]?rY(f[0].x):iY(n):(n=f.length,function(d){for(var m=0,g;m<n;++m)h[(g=f[m]).i]=g.x(d);return h.join("")})}var bR=180/Math.PI,JE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function fI(r,n,i,o,l,a){var u,h,f;return(u=Math.sqrt(r*r+n*n))&&(r/=u,n/=u),(f=r*i+n*o)&&(i-=r*f,o-=n*f),(h=Math.sqrt(i*i+o*o))&&(i/=h,o/=h,f/=h),r*o<n*i&&(r=-r,n=-n,f=-f,u=-u),{translateX:l,translateY:a,rotate:Math.atan2(n,r)*bR,skewX:Math.atan(f)*bR,scaleX:u,scaleY:h}}var e0;function oY(r){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(r+"");return n.isIdentity?JE:fI(n.a,n.b,n.c,n.d,n.e,n.f)}function aY(r){return r==null||(e0||(e0=document.createElementNS("http://www.w3.org/2000/svg","g")),e0.setAttribute("transform",r),!(r=e0.transform.baseVal.consolidate()))?JE:(r=r.matrix,fI(r.a,r.b,r.c,r.d,r.e,r.f))}function pI(r,n,i,o){function l(d){return d.length?d.pop()+" ":""}function a(d,m,g,x,v,A){if(d!==g||m!==x){var _=v.push("translate(",null,n,null,i);A.push({i:_-4,x:uc(d,g)},{i:_-2,x:uc(m,x)})}else(g||x)&&v.push("translate("+g+n+x+i)}function u(d,m,g,x){d!==m?(d-m>180?m+=360:m-d>180&&(d+=360),x.push({i:g.push(l(g)+"rotate(",null,o)-2,x:uc(d,m)})):m&&g.push(l(g)+"rotate("+m+o)}function h(d,m,g,x){d!==m?x.push({i:g.push(l(g)+"skewX(",null,o)-2,x:uc(d,m)}):m&&g.push(l(g)+"skewX("+m+o)}function f(d,m,g,x,v,A){if(d!==g||m!==x){var _=v.push(l(v)+"scale(",null,",",null,")");A.push({i:_-4,x:uc(d,g)},{i:_-2,x:uc(m,x)})}else(g!==1||x!==1)&&v.push(l(v)+"scale("+g+","+x+")")}return function(d,m){var g=[],x=[];return d=r(d),m=r(m),a(d.translateX,d.translateY,m.translateX,m.translateY,g,x),u(d.rotate,m.rotate,g,x),h(d.skewX,m.skewX,g,x),f(d.scaleX,d.scaleY,m.scaleX,m.scaleY,g,x),d=m=null,function(v){for(var A=-1,_=x.length,E;++A<_;)g[(E=x[A]).i]=E.x(v);return g.join("")}}}var lY=pI(oY,"px, ","px)","deg)"),cY=pI(aY,", ",")",")"),uY=1e-12;function ER(r){return((r=Math.exp(r))+1/r)/2}function hY(r){return((r=Math.exp(r))-1/r)/2}function dY(r){return((r=Math.exp(2*r))-1)/(r+1)}const fY=function r(n,i,o){function l(a,u){var h=a[0],f=a[1],d=a[2],m=u[0],g=u[1],x=u[2],v=m-h,A=g-f,_=v*v+A*A,E,w;if(_<uY)w=Math.log(x/d)/n,E=function(N){return[h+N*v,f+N*A,d*Math.exp(n*N*w)]};else{var S=Math.sqrt(_),T=(x*x-d*d+o*_)/(2*d*i*S),R=(x*x-d*d-o*_)/(2*x*i*S),L=Math.log(Math.sqrt(T*T+1)-T),I=Math.log(Math.sqrt(R*R+1)-R);w=(I-L)/n,E=function(N){var B=N*w,H=ER(L),q=d/(i*S)*(H*dY(n*B+L)-hY(L));return[h+q*v,f+q*A,d*H/ER(n*B+L)]}}return E.duration=w*1e3*n/Math.SQRT2,E}return l.rho=function(a){var u=Math.max(.001,+a),h=u*u,f=h*h;return r(u,h,f)},l}(Math.SQRT2,2,4);function pY(r){for(var n=r.length/6|0,i=new Array(n),o=0;o<n;)i[o]="#"+r.slice(o*6,++o*6);return i}const mI=pY("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var gI={exports:{}};(function(r){(function(n){var i=/^\s+/,o=/\s+$/,l=0,a=n.round,u=n.min,h=n.max,f=n.random;function d(Se,qe){if(Se=Se||"",qe=qe||{},Se instanceof d)return Se;if(!(this instanceof d))return new d(Se,qe);var Ue=m(Se);this._originalInput=Se,this._r=Ue.r,this._g=Ue.g,this._b=Ue.b,this._a=Ue.a,this._roundA=a(100*this._a)/100,this._format=qe.format||Ue.format,this._gradientType=qe.gradientType,this._r<1&&(this._r=a(this._r)),this._g<1&&(this._g=a(this._g)),this._b<1&&(this._b=a(this._b)),this._ok=Ue.ok,this._tc_id=l++}d.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var Se=this.toRgb();return(Se.r*299+Se.g*587+Se.b*114)/1e3},getLuminance:function(){var Se=this.toRgb(),qe,Ue,At,tt,pe,ge;return qe=Se.r/255,Ue=Se.g/255,At=Se.b/255,qe<=.03928?tt=qe/12.92:tt=n.pow((qe+.055)/1.055,2.4),Ue<=.03928?pe=Ue/12.92:pe=n.pow((Ue+.055)/1.055,2.4),At<=.03928?ge=At/12.92:ge=n.pow((At+.055)/1.055,2.4),.2126*tt+.7152*pe+.0722*ge},setAlpha:function(Se){return this._a=ie(Se),this._roundA=a(100*this._a)/100,this},toHsv:function(){var Se=A(this._r,this._g,this._b);return{h:Se.h*360,s:Se.s,v:Se.v,a:this._a}},toHsvString:function(){var Se=A(this._r,this._g,this._b),qe=a(Se.h*360),Ue=a(Se.s*100),At=a(Se.v*100);return this._a==1?"hsv("+qe+", "+Ue+"%, "+At+"%)":"hsva("+qe+", "+Ue+"%, "+At+"%, "+this._roundA+")"},toHsl:function(){var Se=x(this._r,this._g,this._b);return{h:Se.h*360,s:Se.s,l:Se.l,a:this._a}},toHslString:function(){var Se=x(this._r,this._g,this._b),qe=a(Se.h*360),Ue=a(Se.s*100),At=a(Se.l*100);return this._a==1?"hsl("+qe+", "+Ue+"%, "+At+"%)":"hsla("+qe+", "+Ue+"%, "+At+"%, "+this._roundA+")"},toHex:function(Se){return E(this._r,this._g,this._b,Se)},toHexString:function(Se){return"#"+this.toHex(Se)},toHex8:function(Se){return w(this._r,this._g,this._b,this._a,Se)},toHex8String:function(Se){return"#"+this.toHex8(Se)},toRgb:function(){return{r:a(this._r),g:a(this._g),b:a(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+a(this._r)+", "+a(this._g)+", "+a(this._b)+")":"rgba("+a(this._r)+", "+a(this._g)+", "+a(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:a(se(this._r,255)*100)+"%",g:a(se(this._g,255)*100)+"%",b:a(se(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+a(se(this._r,255)*100)+"%, "+a(se(this._g,255)*100)+"%, "+a(se(this._b,255)*100)+"%)":"rgba("+a(se(this._r,255)*100)+"%, "+a(se(this._g,255)*100)+"%, "+a(se(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:X[E(this._r,this._g,this._b,!0)]||!1},toFilter:function(Se){var qe="#"+S(this._r,this._g,this._b,this._a),Ue=qe,At=this._gradientType?"GradientType = 1, ":"";if(Se){var tt=d(Se);Ue="#"+S(tt._r,tt._g,tt._b,tt._a)}return"progid:DXImageTransform.Microsoft.gradient("+At+"startColorstr="+qe+",endColorstr="+Ue+")"},toString:function(Se){var qe=!!Se;Se=Se||this._format;var Ue=!1,At=this._a<1&&this._a>=0,tt=!qe&&At&&(Se==="hex"||Se==="hex6"||Se==="hex3"||Se==="hex4"||Se==="hex8"||Se==="name");return tt?Se==="name"&&this._a===0?this.toName():this.toRgbString():(Se==="rgb"&&(Ue=this.toRgbString()),Se==="prgb"&&(Ue=this.toPercentageRgbString()),(Se==="hex"||Se==="hex6")&&(Ue=this.toHexString()),Se==="hex3"&&(Ue=this.toHexString(!0)),Se==="hex4"&&(Ue=this.toHex8String(!0)),Se==="hex8"&&(Ue=this.toHex8String()),Se==="name"&&(Ue=this.toName()),Se==="hsl"&&(Ue=this.toHslString()),Se==="hsv"&&(Ue=this.toHsvString()),Ue||this.toHexString())},clone:function(){return d(this.toString())},_applyModification:function(Se,qe){var Ue=Se.apply(null,[this].concat([].slice.call(qe)));return this._r=Ue._r,this._g=Ue._g,this._b=Ue._b,this.setAlpha(Ue._a),this},lighten:function(){return this._applyModification(I,arguments)},brighten:function(){return this._applyModification(N,arguments)},darken:function(){return this._applyModification(B,arguments)},desaturate:function(){return this._applyModification(T,arguments)},saturate:function(){return this._applyModification(R,arguments)},greyscale:function(){return this._applyModification(L,arguments)},spin:function(){return this._applyModification(H,arguments)},_applyCombination:function(Se,qe){return Se.apply(null,[this].concat([].slice.call(qe)))},analogous:function(){return this._applyCombination(O,arguments)},complement:function(){return this._applyCombination(q,arguments)},monochromatic:function(){return this._applyCombination(k,arguments)},splitcomplement:function(){return this._applyCombination(D,arguments)},triad:function(){return this._applyCombination(le,arguments)},tetrad:function(){return this._applyCombination(ne,arguments)}},d.fromRatio=function(Se,qe){if(typeof Se=="object"){var Ue={};for(var At in Se)Se.hasOwnProperty(At)&&(At==="a"?Ue[At]=Se[At]:Ue[At]=Ne(Se[At]));Se=Ue}return d(Se,qe)};function m(Se){var qe={r:0,g:0,b:0},Ue=1,At=null,tt=null,pe=null,ge=!1,Fe=!1;return typeof Se=="string"&&(Se=Jt(Se)),typeof Se=="object"&&(bt(Se.r)&&bt(Se.g)&&bt(Se.b)?(qe=g(Se.r,Se.g,Se.b),ge=!0,Fe=String(Se.r).substr(-1)==="%"?"prgb":"rgb"):bt(Se.h)&&bt(Se.s)&&bt(Se.v)?(At=Ne(Se.s),tt=Ne(Se.v),qe=_(Se.h,At,tt),ge=!0,Fe="hsv"):bt(Se.h)&&bt(Se.s)&&bt(Se.l)&&(At=Ne(Se.s),pe=Ne(Se.l),qe=v(Se.h,At,pe),ge=!0,Fe="hsl"),Se.hasOwnProperty("a")&&(Ue=Se.a)),Ue=ie(Ue),{ok:ge,format:Se.format||Fe,r:u(255,h(qe.r,0)),g:u(255,h(qe.g,0)),b:u(255,h(qe.b,0)),a:Ue}}function g(Se,qe,Ue){return{r:se(Se,255)*255,g:se(qe,255)*255,b:se(Ue,255)*255}}function x(Se,qe,Ue){Se=se(Se,255),qe=se(qe,255),Ue=se(Ue,255);var At=h(Se,qe,Ue),tt=u(Se,qe,Ue),pe,ge,Fe=(At+tt)/2;if(At==tt)pe=ge=0;else{var Re=At-tt;switch(ge=Fe>.5?Re/(2-At-tt):Re/(At+tt),At){case Se:pe=(qe-Ue)/Re+(qe<Ue?6:0);break;case qe:pe=(Ue-Se)/Re+2;break;case Ue:pe=(Se-qe)/Re+4;break}pe/=6}return{h:pe,s:ge,l:Fe}}function v(Se,qe,Ue){var At,tt,pe;Se=se(Se,360),qe=se(qe,100),Ue=se(Ue,100);function ge(ce,ae,J){return J<0&&(J+=1),J>1&&(J-=1),J<1/6?ce+(ae-ce)*6*J:J<1/2?ae:J<2/3?ce+(ae-ce)*(2/3-J)*6:ce}if(qe===0)At=tt=pe=Ue;else{var Fe=Ue<.5?Ue*(1+qe):Ue+qe-Ue*qe,Re=2*Ue-Fe;At=ge(Re,Fe,Se+1/3),tt=ge(Re,Fe,Se),pe=ge(Re,Fe,Se-1/3)}return{r:At*255,g:tt*255,b:pe*255}}function A(Se,qe,Ue){Se=se(Se,255),qe=se(qe,255),Ue=se(Ue,255);var At=h(Se,qe,Ue),tt=u(Se,qe,Ue),pe,ge,Fe=At,Re=At-tt;if(ge=At===0?0:Re/At,At==tt)pe=0;else{switch(At){case Se:pe=(qe-Ue)/Re+(qe<Ue?6:0);break;case qe:pe=(Ue-Se)/Re+2;break;case Ue:pe=(Se-qe)/Re+4;break}pe/=6}return{h:pe,s:ge,v:Fe}}function _(Se,qe,Ue){Se=se(Se,360)*6,qe=se(qe,100),Ue=se(Ue,100);var At=n.floor(Se),tt=Se-At,pe=Ue*(1-qe),ge=Ue*(1-tt*qe),Fe=Ue*(1-(1-tt)*qe),Re=At%6,ce=[Ue,ge,pe,pe,Fe,Ue][Re],ae=[Fe,Ue,Ue,ge,pe,pe][Re],J=[pe,pe,Fe,Ue,Ue,ge][Re];return{r:ce*255,g:ae*255,b:J*255}}function E(Se,qe,Ue,At){var tt=[Oe(a(Se).toString(16)),Oe(a(qe).toString(16)),Oe(a(Ue).toString(16))];return At&&tt[0].charAt(0)==tt[0].charAt(1)&&tt[1].charAt(0)==tt[1].charAt(1)&&tt[2].charAt(0)==tt[2].charAt(1)?tt[0].charAt(0)+tt[1].charAt(0)+tt[2].charAt(0):tt.join("")}function w(Se,qe,Ue,At,tt){var pe=[Oe(a(Se).toString(16)),Oe(a(qe).toString(16)),Oe(a(Ue).toString(16)),Oe(He(At))];return tt&&pe[0].charAt(0)==pe[0].charAt(1)&&pe[1].charAt(0)==pe[1].charAt(1)&&pe[2].charAt(0)==pe[2].charAt(1)&&pe[3].charAt(0)==pe[3].charAt(1)?pe[0].charAt(0)+pe[1].charAt(0)+pe[2].charAt(0)+pe[3].charAt(0):pe.join("")}function S(Se,qe,Ue,At){var tt=[Oe(He(At)),Oe(a(Se).toString(16)),Oe(a(qe).toString(16)),Oe(a(Ue).toString(16))];return tt.join("")}d.equals=function(Se,qe){return!Se||!qe?!1:d(Se).toRgbString()==d(qe).toRgbString()},d.random=function(){return d.fromRatio({r:f(),g:f(),b:f()})};function T(Se,qe){qe=qe===0?0:qe||10;var Ue=d(Se).toHsl();return Ue.s-=qe/100,Ue.s=ue(Ue.s),d(Ue)}function R(Se,qe){qe=qe===0?0:qe||10;var Ue=d(Se).toHsl();return Ue.s+=qe/100,Ue.s=ue(Ue.s),d(Ue)}function L(Se){return d(Se).desaturate(100)}function I(Se,qe){qe=qe===0?0:qe||10;var Ue=d(Se).toHsl();return Ue.l+=qe/100,Ue.l=ue(Ue.l),d(Ue)}function N(Se,qe){qe=qe===0?0:qe||10;var Ue=d(Se).toRgb();return Ue.r=h(0,u(255,Ue.r-a(255*-(qe/100)))),Ue.g=h(0,u(255,Ue.g-a(255*-(qe/100)))),Ue.b=h(0,u(255,Ue.b-a(255*-(qe/100)))),d(Ue)}function B(Se,qe){qe=qe===0?0:qe||10;var Ue=d(Se).toHsl();return Ue.l-=qe/100,Ue.l=ue(Ue.l),d(Ue)}function H(Se,qe){var Ue=d(Se).toHsl(),At=(Ue.h+qe)%360;return Ue.h=At<0?360+At:At,d(Ue)}function q(Se){var qe=d(Se).toHsl();return qe.h=(qe.h+180)%360,d(qe)}function le(Se){var qe=d(Se).toHsl(),Ue=qe.h;return[d(Se),d({h:(Ue+120)%360,s:qe.s,l:qe.l}),d({h:(Ue+240)%360,s:qe.s,l:qe.l})]}function ne(Se){var qe=d(Se).toHsl(),Ue=qe.h;return[d(Se),d({h:(Ue+90)%360,s:qe.s,l:qe.l}),d({h:(Ue+180)%360,s:qe.s,l:qe.l}),d({h:(Ue+270)%360,s:qe.s,l:qe.l})]}function D(Se){var qe=d(Se).toHsl(),Ue=qe.h;return[d(Se),d({h:(Ue+72)%360,s:qe.s,l:qe.l}),d({h:(Ue+216)%360,s:qe.s,l:qe.l})]}function O(Se,qe,Ue){qe=qe||6,Ue=Ue||30;var At=d(Se).toHsl(),tt=360/Ue,pe=[d(Se)];for(At.h=(At.h-(tt*qe>>1)+720)%360;--qe;)At.h=(At.h+tt)%360,pe.push(d(At));return pe}function k(Se,qe){qe=qe||6;for(var Ue=d(Se).toHsv(),At=Ue.h,tt=Ue.s,pe=Ue.v,ge=[],Fe=1/qe;qe--;)ge.push(d({h:At,s:tt,v:pe})),pe=(pe+Fe)%1;return ge}d.mix=function(Se,qe,Ue){Ue=Ue===0?0:Ue||50;var At=d(Se).toRgb(),tt=d(qe).toRgb(),pe=Ue/100,ge={r:(tt.r-At.r)*pe+At.r,g:(tt.g-At.g)*pe+At.g,b:(tt.b-At.b)*pe+At.b,a:(tt.a-At.a)*pe+At.a};return d(ge)},d.readability=function(Se,qe){var Ue=d(Se),At=d(qe);return(n.max(Ue.getLuminance(),At.getLuminance())+.05)/(n.min(Ue.getLuminance(),At.getLuminance())+.05)},d.isReadable=function(Se,qe,Ue){var At=d.readability(Se,qe),tt,pe;switch(pe=!1,tt=sn(Ue),tt.level+tt.size){case"AAsmall":case"AAAlarge":pe=At>=4.5;break;case"AAlarge":pe=At>=3;break;case"AAAsmall":pe=At>=7;break}return pe},d.mostReadable=function(Se,qe,Ue){var At=null,tt=0,pe,ge,Fe,Re;Ue=Ue||{},ge=Ue.includeFallbackColors,Fe=Ue.level,Re=Ue.size;for(var ce=0;ce<qe.length;ce++)pe=d.readability(Se,qe[ce]),pe>tt&&(tt=pe,At=d(qe[ce]));return d.isReadable(Se,At,{level:Fe,size:Re})||!ge?At:(Ue.includeFallbackColors=!1,d.mostReadable(Se,["#fff","#000"],Ue))};var z=d.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},X=d.hexNames=Z(z);function Z(Se){var qe={};for(var Ue in Se)Se.hasOwnProperty(Ue)&&(qe[Se[Ue]]=Ue);return qe}function ie(Se){return Se=parseFloat(Se),(isNaN(Se)||Se<0||Se>1)&&(Se=1),Se}function se(Se,qe){Ce(Se)&&(Se="100%");var Ue=ke(Se);return Se=u(qe,h(0,parseFloat(Se))),Ue&&(Se=parseInt(Se*qe,10)/100),n.abs(Se-qe)<1e-6?1:Se%qe/parseFloat(qe)}function ue(Se){return u(1,h(0,Se))}function ye(Se){return parseInt(Se,16)}function Ce(Se){return typeof Se=="string"&&Se.indexOf(".")!=-1&&parseFloat(Se)===1}function ke(Se){return typeof Se=="string"&&Se.indexOf("%")!=-1}function Oe(Se){return Se.length==1?"0"+Se:""+Se}function Ne(Se){return Se<=1&&(Se=Se*100+"%"),Se}function He(Se){return n.round(parseFloat(Se)*255).toString(16)}function Qe(Se){return ye(Se)/255}var St=function(){var Se="[-\\+]?\\d+%?",qe="[-\\+]?\\d*\\.\\d+%?",Ue="(?:"+qe+")|(?:"+Se+")",At="[\\s|\\(]+("+Ue+")[,|\\s]+("+Ue+")[,|\\s]+("+Ue+")\\s*\\)?",tt="[\\s|\\(]+("+Ue+")[,|\\s]+("+Ue+")[,|\\s]+("+Ue+")[,|\\s]+("+Ue+")\\s*\\)?";return{CSS_UNIT:new RegExp(Ue),rgb:new RegExp("rgb"+At),rgba:new RegExp("rgba"+tt),hsl:new RegExp("hsl"+At),hsla:new RegExp("hsla"+tt),hsv:new RegExp("hsv"+At),hsva:new RegExp("hsva"+tt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function bt(Se){return!!St.CSS_UNIT.exec(Se)}function Jt(Se){Se=Se.replace(i,"").replace(o,"").toLowerCase();var qe=!1;if(z[Se])Se=z[Se],qe=!0;else if(Se=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var Ue;return(Ue=St.rgb.exec(Se))?{r:Ue[1],g:Ue[2],b:Ue[3]}:(Ue=St.rgba.exec(Se))?{r:Ue[1],g:Ue[2],b:Ue[3],a:Ue[4]}:(Ue=St.hsl.exec(Se))?{h:Ue[1],s:Ue[2],l:Ue[3]}:(Ue=St.hsla.exec(Se))?{h:Ue[1],s:Ue[2],l:Ue[3],a:Ue[4]}:(Ue=St.hsv.exec(Se))?{h:Ue[1],s:Ue[2],v:Ue[3]}:(Ue=St.hsva.exec(Se))?{h:Ue[1],s:Ue[2],v:Ue[3],a:Ue[4]}:(Ue=St.hex8.exec(Se))?{r:ye(Ue[1]),g:ye(Ue[2]),b:ye(Ue[3]),a:Qe(Ue[4]),format:qe?"name":"hex8"}:(Ue=St.hex6.exec(Se))?{r:ye(Ue[1]),g:ye(Ue[2]),b:ye(Ue[3]),format:qe?"name":"hex"}:(Ue=St.hex4.exec(Se))?{r:ye(Ue[1]+""+Ue[1]),g:ye(Ue[2]+""+Ue[2]),b:ye(Ue[3]+""+Ue[3]),a:Qe(Ue[4]+""+Ue[4]),format:qe?"name":"hex8"}:(Ue=St.hex3.exec(Se))?{r:ye(Ue[1]+""+Ue[1]),g:ye(Ue[2]+""+Ue[2]),b:ye(Ue[3]+""+Ue[3]),format:qe?"name":"hex"}:!1}function sn(Se){var qe,Ue;return Se=Se||{level:"AA",size:"small"},qe=(Se.level||"AA").toUpperCase(),Ue=(Se.size||"small").toLowerCase(),qe!=="AA"&&qe!=="AAA"&&(qe="AA"),Ue!=="small"&&Ue!=="large"&&(Ue="small"),{level:qe,size:Ue}}r.exports?r.exports=d:window.tinycolor=d})(Math)})(gI);const qw=gI.exports;function AR(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),i.push.apply(i,o)}return i}function vI(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?AR(Object(i),!0).forEach(function(o){Yw(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):AR(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function eA(r){return eA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},eA(r)}function mY(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function wR(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function gY(r,n,i){return n&&wR(r.prototype,n),i&&wR(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}function Yw(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function vY(r,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(n&&n.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),n&&_y(r,n)}function xy(r){return xy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},xy(r)}function _y(r,n){return _y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},_y(r,n)}function yI(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function O0(r,n,i){return yI()?O0=Reflect.construct.bind():O0=function(l,a,u){var h=[null];h.push.apply(h,a);var f=Function.bind.apply(l,h),d=new f;return u&&_y(d,u.prototype),d},O0.apply(null,arguments)}function yY(r,n){if(r==null)return{};var i={},o=Object.keys(r),l,a;for(a=0;a<o.length;a++)l=o[a],!(n.indexOf(l)>=0)&&(i[l]=r[l]);return i}function xY(r,n){if(r==null)return{};var i=yY(r,n),o,l;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(r);for(l=0;l<a.length;l++)o=a[l],!(n.indexOf(o)>=0)&&(!Object.prototype.propertyIsEnumerable.call(r,o)||(i[o]=r[o]))}return i}function xI(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function _Y(r,n){if(n&&(typeof n=="object"||typeof n=="function"))return n;if(n!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xI(r)}function bY(r){var n=yI();return function(){var o=xy(r),l;if(n){var a=xy(this).constructor;l=Reflect.construct(o,arguments,a)}else l=o.apply(this,arguments);return _Y(this,l)}}function MR(r,n){return AY(r)||MY(r,n)||_I(r,n)||TY()}function $o(r){return EY(r)||wY(r)||_I(r)||SY()}function EY(r){if(Array.isArray(r))return tA(r)}function AY(r){if(Array.isArray(r))return r}function wY(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function MY(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function _I(r,n){if(!!r){if(typeof r=="string")return tA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return tA(r,n)}}function tA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function SY(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function TY(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var CY=function r(n){n instanceof Array?n.forEach(r):(n.map&&n.map.dispose(),n.dispose())},RY=function r(n){n.geometry&&n.geometry.dispose(),n.material&&CY(n.material),n.texture&&n.texture.dispose(),n.children&&n.children.forEach(r)},nA=function(n){for(;n.children.length;){var i=n.children[0];n.remove(i),RY(i)}},LY=["objFilter"];function gp(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=i.objFilter,l=o===void 0?function(){return!0}:o,a=xY(i,LY);return zq(r,n.children.filter(l),function(u){return n.add(u)},function(u){n.remove(u),nA(u)},vI({objBindAttr:"__threeObj"},a))}var t0=function(n){return isNaN(n)?parseInt(qw(n).toHex(),16):n},SR=function(n){return isNaN(n)?qw(n).getAlpha():1},PY=$w(mI);function TR(r,n,i){!n||typeof i!="string"||r.filter(function(o){return!o[i]}).forEach(function(o){o[i]=PY(n(o))})}function DY(r,n){var i=r.nodes,o=r.links,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=l.nodeFilter,u=a===void 0?function(){return!0}:a,h=l.onLoopError,f=h===void 0?function(v){throw"Invalid DAG structure! Found cycle in node path: ".concat(v.join(" -> "),".")}:h,d={};i.forEach(function(v){return d[n(v)]={data:v,out:[],depth:-1,skip:!u(v)}}),o.forEach(function(v){var A=v.source,_=v.target,E=R(A),w=R(_);if(!d.hasOwnProperty(E))throw"Missing source node with id: ".concat(E);if(!d.hasOwnProperty(w))throw"Missing target node with id: ".concat(w);var S=d[E],T=d[w];S.out.push(T);function R(L){return eA(L)==="object"?n(L):L}});var m=[];x(Object.values(d));var g=Object.assign.apply(Object,[{}].concat($o(Object.entries(d).filter(function(v){var A=MR(v,2),_=A[1];return!_.skip}).map(function(v){var A=MR(v,2),_=A[0],E=A[1];return Yw({},_,E.depth)}))));return g;function x(v){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,E=0,w=v.length;E<w;E++){var S=v[E];if(A.indexOf(S)!==-1){var T=function(){var R=[].concat($o(A.slice(A.indexOf(S))),[S]).map(function(L){return n(L.data)});return m.some(function(L){return L.length===R.length&&L.every(function(I,N){return I===R[N]})})||(m.push(R),f(R)),"continue"}();if(T==="continue")continue}_>S.depth&&(S.depth=_,x(S.out,[].concat($o(A),[S]),_+(S.skip?0:1)))}}}var ui=window.THREE?window.THREE:{Group:Sd,Mesh:Zo,MeshLambertMaterial:l$,Color:Ji,BufferGeometry:ho,BufferAttribute:ta,Matrix4:Er,Vector3:it,SphereGeometry:qy,CylinderGeometry:Xy,TubeGeometry:Ow,ConeGeometry:Dw,Line:$j,LineBasicMaterial:AO,QuadraticBezierCurve3:Pw,CubicBezierCurve3:MO,Box3:qu},CR={graph:CX,forcelayout:zw.exports},OY=2,RR=new ui.BufferGeometry().setAttribute?"setAttribute":"addAttribute",n0=new ui.BufferGeometry().applyMatrix4?"applyMatrix4":"applyMatrix",IY=Yu({props:{jsonUrl:{onChange:function(n,i){var o=this;n&&!i.fetchingJson&&(i.fetchingJson=!0,i.onLoading(),fetch(n).then(function(l){return l.json()}).then(function(l){i.fetchingJson=!1,i.onFinishLoading(l),o.graphData(l)}))},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,i){i.engineRunning=!1}},numDimensions:{default:3,onChange:function(n,i){var o=i.d3ForceLayout.force("charge");o&&o.strength(n>2?-60:-30),n<3&&l(i.graphData.nodes,"z"),n<2&&l(i.graphData.nodes,"y");function l(a,u){a.forEach(function(h){delete h[u],delete h["v".concat(u)]})}}},dagMode:{onChange:function(n,i){!n&&i.forceEngine==="d3"&&(i.graphData.nodes||[]).forEach(function(o){return o.fx=o.fy=o.fz=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeVisibility:{default:!0},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{},linkResolution:{default:6},linkCurvature:{default:0,triggerUpdate:!1},linkCurveRotation:{default:0,triggerUpdate:!1},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{triggerUpdate:!1},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,i){i.d3ForceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,i){i.d3ForceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,i){i.d3ForceLayout.velocityDecay(n)}},ngraphPhysics:{default:{timeStep:20,gravity:-1.2,theta:.8,springLength:30,springCoefficient:8e-4,dragCoefficient:.02}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onLoading:{default:function(){},triggerUpdate:!1},onFinishLoading:{default:function(){},triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1}},methods:{refresh:function(n){return n._flushObjects=!0,n._rerender(),this},d3Force:function(n,i,o){return o===void 0?n.d3ForceLayout.force(i):(n.d3ForceLayout.force(i,o),this)},d3ReheatSimulation:function(n){return n.d3ForceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},tickFrame:function(n){var i=n.forceEngine!=="ngraph";return n.engineRunning&&o(),l(),a(),this;function o(){++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||i&&n.d3AlphaMin>0&&n.d3ForceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.layout[i?"tick":"step"](),n.onEngineTick()),n.graphData.nodes.forEach(function(g){var x=g.__threeObj;if(!!x){var v=i?g:n.layout.getNodePosition(g[n.nodeId]);x.position.x=v.x,x.position.y=v.y||0,x.position.z=v.z||0}});var u=Wn(n.linkWidth),h=Wn(n.linkCurvature),f=Wn(n.linkCurveRotation),d=Wn(n.linkThreeObjectExtend);n.graphData.links.forEach(function(g){var x=g.__lineObj;if(!!x){var v=i?g:n.layout.getLinkPosition(n.layout.graph.getLink(g.source,g.target).id),A=v[i?"source":"from"],_=v[i?"target":"to"];if(!(!A||!_||!A.hasOwnProperty("x")||!_.hasOwnProperty("x"))){m(g);var E=d(g);if(!(n.linkPositionUpdate&&n.linkPositionUpdate(E?x.children[1]:x,{start:{x:A.x,y:A.y,z:A.z},end:{x:_.x,y:_.y,z:_.z}},g)&&!E)){var w=30,S=g.__curve,T=x.children.length?x.children[0]:x;if(T.type==="Line"){if(S)T.geometry.setFromPoints(S.getPoints(w));else{var R=T.geometry.getAttribute("position");(!R||!R.array||R.array.length!==6)&&T.geometry[RR]("position",R=new ui.BufferAttribute(new Float32Array(2*3),3)),R.array[0]=A.x,R.array[1]=A.y||0,R.array[2]=A.z||0,R.array[3]=_.x,R.array[4]=_.y||0,R.array[5]=_.z||0,R.needsUpdate=!0}T.geometry.computeBoundingSphere()}else if(T.type==="Mesh")if(S){T.geometry.type.match(/^Tube(Buffer)?Geometry$/)||(T.position.set(0,0,0),T.rotation.set(0,0,0),T.scale.set(1,1,1));var le=Math.ceil(u(g)*10)/10,ne=le/2,D=new ui.TubeGeometry(S,w,ne,n.linkResolution,!1);T.geometry.dispose(),T.geometry=D}else{if(!T.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)){var L=Math.ceil(u(g)*10)/10,I=L/2,N=new ui.CylinderGeometry(I,I,1,n.linkResolution,1,!1);N[n0](new ui.Matrix4().makeTranslation(0,1/2,0)),N[n0](new ui.Matrix4().makeRotationX(Math.PI/2)),T.geometry.dispose(),T.geometry=N}var B=new ui.Vector3(A.x,A.y||0,A.z||0),H=new ui.Vector3(_.x,_.y||0,_.z||0),q=B.distanceTo(H);T.position.x=B.x,T.position.y=B.y,T.position.z=B.z,T.scale.z=q,T.parent.localToWorld(H),T.lookAt(H)}}}}});function m(g){var x=i?g:n.layout.getLinkPosition(n.layout.graph.getLink(g.source,g.target).id),v=x[i?"source":"from"],A=x[i?"target":"to"];if(!(!v||!A||!v.hasOwnProperty("x")||!A.hasOwnProperty("x"))){var _=h(g);if(!_)g.__curve=null;else{var E=new ui.Vector3(v.x,v.y||0,v.z||0),w=new ui.Vector3(A.x,A.y||0,A.z||0),S=E.distanceTo(w),T,R=f(g);if(S>0){var L=A.x-v.x,I=A.y-v.y||0,N=new ui.Vector3().subVectors(w,E),B=N.clone().multiplyScalar(_).cross(L!==0||I!==0?new ui.Vector3(0,0,1):new ui.Vector3(0,1,0)).applyAxisAngle(N.normalize(),R).add(new ui.Vector3().addVectors(E,w).divideScalar(2));T=new ui.QuadraticBezierCurve3(E,B,w)}else{var H=_*70,q=-R,le=q+Math.PI/2;T=new ui.CubicBezierCurve3(E,new ui.Vector3(H*Math.cos(le),H*Math.sin(le),0).add(E),new ui.Vector3(H*Math.cos(q),H*Math.sin(q),0).add(E),w)}g.__curve=T}}}}function l(){var u=Wn(n.linkDirectionalArrowRelPos),h=Wn(n.linkDirectionalArrowLength),f=Wn(n.nodeVal);n.graphData.links.forEach(function(d){var m=d.__arrowObj;if(!!m){var g=i?d:n.layout.getLinkPosition(n.layout.graph.getLink(d.source,d.target).id),x=g[i?"source":"from"],v=g[i?"target":"to"];if(!(!x||!v||!x.hasOwnProperty("x")||!v.hasOwnProperty("x"))){var A=Math.cbrt(Math.max(0,f(x)||1))*n.nodeRelSize,_=Math.cbrt(Math.max(0,f(v)||1))*n.nodeRelSize,E=h(d),w=u(d),S=d.__curve?function(B){return d.__curve.getPoint(B)}:function(B){var H=function(le,ne,D,O){return ne[le]+(D[le]-ne[le])*O||0};return{x:H("x",x,v,B),y:H("y",x,v,B),z:H("z",x,v,B)}},T=d.__curve?d.__curve.getLength():Math.sqrt(["x","y","z"].map(function(B){return Math.pow((v[B]||0)-(x[B]||0),2)}).reduce(function(B,H){return B+H},0)),R=A+E+(T-A-_-E)*w,L=S(R/T),I=S((R-E)/T);["x","y","z"].forEach(function(B){return m.position[B]=I[B]});var N=O0(ui.Vector3,$o(["x","y","z"].map(function(B){return L[B]})));m.parent.localToWorld(N),m.lookAt(N)}}})}function a(){var u=Wn(n.linkDirectionalParticleSpeed);n.graphData.links.forEach(function(h){var f=h.__photonsObj&&h.__photonsObj.children,d=h.__singleHopPhotonsObj&&h.__singleHopPhotonsObj.children;if(!((!d||!d.length)&&(!f||!f.length))){var m=i?h:n.layout.getLinkPosition(n.layout.graph.getLink(h.source,h.target).id),g=m[i?"source":"from"],x=m[i?"target":"to"];if(!(!g||!x||!g.hasOwnProperty("x")||!x.hasOwnProperty("x"))){var v=u(h),A=h.__curve?function(E){return h.__curve.getPoint(E)}:function(E){var w=function(T,R,L,I){return R[T]+(L[T]-R[T])*I||0};return{x:w("x",g,x,E),y:w("y",g,x,E),z:w("z",g,x,E)}},_=[].concat($o(f||[]),$o(d||[]));_.forEach(function(E,w){var S=E.parent.__linkThreeObjType==="singleHopPhotons";if(E.hasOwnProperty("__progressRatio")||(E.__progressRatio=S?0:w/f.length),E.__progressRatio+=v,E.__progressRatio>=1)if(!S)E.__progressRatio=E.__progressRatio%1;else{E.parent.remove(E),nA(E);return}var T=E.__progressRatio,R=A(T);["x","y","z"].forEach(function(L){return E.position[L]=R[L]})})}}})}},emitParticle:function(n,i){if(i&&n.graphData.links.includes(i)){if(!i.__singleHopPhotonsObj){var o=new ui.Group;o.__linkThreeObjType="singleHopPhotons",i.__singleHopPhotonsObj=o,n.graphScene.add(o)}var l=Wn(n.linkDirectionalParticleWidth),a=Math.ceil(l(i)*10)/10/2,u=n.linkDirectionalParticleResolution,h=new ui.SphereGeometry(a,u,u),f=Wn(n.linkColor),d=Wn(n.linkDirectionalParticleColor),m=d(i)||f(i)||"#f0f0f0",g=new ui.Color(t0(m)),x=n.linkOpacity*3,v=new ui.MeshLambertMaterial({color:g,transparent:!0,opacity:x});i.__singleHopPhotonsObj.add(new ui.Mesh(h,v))}return this},getGraphBbox:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0};if(!n.initialised)return null;var o=function l(a){var u=[];if(a.geometry){a.geometry.computeBoundingBox();var h=new ui.Box3;h.copy(a.geometry.boundingBox).applyMatrix4(a.matrixWorld),u.push(h)}return u.concat.apply(u,$o((a.children||[]).filter(function(f){return!f.hasOwnProperty("__graphObjType")||f.__graphObjType==="node"&&i(f.__data)}).map(l)))}(n.graphScene);return o.length?Object.assign.apply(Object,$o(["x","y","z"].map(function(l){return Yw({},l,[XE(o,function(a){return a.min[l]}),$E(o,function(a){return a.max[l]})])}))):null}},stateInit:function(){return{d3ForceLayout:zO().force("link",FO()).force("charge",HO()).force("center",LO()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,i){i.graphScene=n},update:function(n,i){var o=function(Oe){return Oe.some(function(Ne){return i.hasOwnProperty(Ne)})};if(n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&o(["nodeAutoColorBy","graphData","nodeColor"])&&TR(n.graphData.nodes,Wn(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&o(["linkAutoColorBy","graphData","linkColor"])&&TR(n.graphData.links,Wn(n.linkAutoColorBy),n.linkColor),n._flushObjects||o(["graphData","nodeThreeObject","nodeThreeObjectExtend","nodeVal","nodeColor","nodeVisibility","nodeRelSize","nodeResolution","nodeOpacity"])){var l=Wn(n.nodeThreeObject),a=Wn(n.nodeThreeObjectExtend),u=Wn(n.nodeVal),h=Wn(n.nodeColor),f=Wn(n.nodeVisibility),d={},m={};gp(n.graphData.nodes.filter(f),n.graphScene,{purge:n._flushObjects||o(["nodeThreeObject","nodeThreeObjectExtend"]),objFilter:function(Oe){return Oe.__graphObjType==="node"},createObj:function(Oe){var Ne=l(Oe),He=a(Oe);Ne&&n.nodeThreeObject===Ne&&(Ne=Ne.clone());var Qe;return Ne&&!He?Qe=Ne:(Qe=new ui.Mesh,Qe.__graphDefaultObj=!0,Ne&&He&&Qe.add(Ne)),Qe.__graphObjType="node",Qe},updateObj:function(Oe,Ne){if(Oe.__graphDefaultObj){var He=u(Ne)||1,Qe=Math.cbrt(He)*n.nodeRelSize,St=n.nodeResolution;(!Oe.geometry.type.match(/^Sphere(Buffer)?Geometry$/)||Oe.geometry.parameters.radius!==Qe||Oe.geometry.parameters.widthSegments!==St)&&(d.hasOwnProperty(He)||(d[He]=new ui.SphereGeometry(Qe,St,St)),Oe.geometry.dispose(),Oe.geometry=d[He]);var bt=h(Ne),Jt=new ui.Color(t0(bt||"#ffffaa")),sn=n.nodeOpacity*SR(bt);(Oe.material.type!=="MeshLambertMaterial"||!Oe.material.color.equals(Jt)||Oe.material.opacity!==sn)&&(m.hasOwnProperty(bt)||(m[bt]=new ui.MeshLambertMaterial({color:Jt,transparent:!0,opacity:sn})),Oe.material.dispose(),Oe.material=m[bt])}}})}if(n._flushObjects||o(["graphData","linkThreeObject","linkThreeObjectExtend","linkMaterial","linkColor","linkWidth","linkVisibility","linkResolution","linkOpacity","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution"])){var g=Wn(n.linkThreeObject),x=Wn(n.linkThreeObjectExtend),v=Wn(n.linkMaterial),A=Wn(n.linkVisibility),_=Wn(n.linkColor),E=Wn(n.linkWidth),w={},S={},T={},R=n.graphData.links.filter(A);if(gp(R,n.graphScene,{objBindAttr:"__lineObj",purge:n._flushObjects||o(["linkThreeObject","linkThreeObjectExtend","linkWidth"]),objFilter:function(Oe){return Oe.__graphObjType==="link"},exitObj:function(Oe){var Ne=Oe.__data&&Oe.__data.__singleHopPhotonsObj;Ne&&(Ne.parent.remove(Ne),nA(Ne),delete Oe.__data.__singleHopPhotonsObj)},createObj:function(Oe){var Ne=g(Oe),He=x(Oe);Ne&&n.linkThreeObject===Ne&&(Ne=Ne.clone());var Qe;if(!Ne||He){var St=!!E(Oe);if(St)Qe=new ui.Mesh;else{var bt=new ui.BufferGeometry;bt[RR]("position",new ui.BufferAttribute(new Float32Array(2*3),3)),Qe=new ui.Line(bt)}}var Jt;return Ne?He?(Jt=new ui.Group,Jt.__graphDefaultObj=!0,Jt.add(Qe),Jt.add(Ne)):Jt=Ne:(Jt=Qe,Jt.__graphDefaultObj=!0),Jt.renderOrder=10,Jt.__graphObjType="link",Jt},updateObj:function(Oe,Ne){if(Oe.__graphDefaultObj){var He=Oe.children.length?Oe.children[0]:Oe,Qe=Math.ceil(E(Ne)*10)/10,St=!!Qe;if(St){var bt=Qe/2,Jt=n.linkResolution;if(!He.geometry.type.match(/^Cylinder(Buffer)?Geometry$/)||He.geometry.parameters.radiusTop!==bt||He.geometry.parameters.radialSegments!==Jt){if(!w.hasOwnProperty(Qe)){var sn=new ui.CylinderGeometry(bt,bt,1,Jt,1,!1);sn[n0](new ui.Matrix4().makeTranslation(0,1/2,0)),sn[n0](new ui.Matrix4().makeRotationX(Math.PI/2)),w[Qe]=sn}He.geometry.dispose(),He.geometry=w[Qe]}}var Se=v(Ne);if(Se)He.material=Se;else{var qe=_(Ne),Ue=new ui.Color(t0(qe||"#f0f0f0")),At=n.linkOpacity*SR(qe),tt=St?"MeshLambertMaterial":"LineBasicMaterial";if(He.material.type!==tt||!He.material.color.equals(Ue)||He.material.opacity!==At){var pe=St?S:T;pe.hasOwnProperty(qe)||(pe[qe]=new ui[tt]({color:Ue,transparent:At<1,opacity:At,depthWrite:At>=1})),He.material.dispose(),He.material=pe[qe]}}}}}),n.linkDirectionalArrowLength||i.hasOwnProperty("linkDirectionalArrowLength")){var L=Wn(n.linkDirectionalArrowLength),I=Wn(n.linkDirectionalArrowColor);gp(R.filter(L),n.graphScene,{objBindAttr:"__arrowObj",objFilter:function(Oe){return Oe.__linkThreeObjType==="arrow"},createObj:function(){var Oe=new ui.Mesh(void 0,new ui.MeshLambertMaterial({transparent:!0}));return Oe.__linkThreeObjType="arrow",Oe},updateObj:function(Oe,Ne){var He=L(Ne),Qe=n.linkDirectionalArrowResolution;if(!Oe.geometry.type.match(/^Cone(Buffer)?Geometry$/)||Oe.geometry.parameters.height!==He||Oe.geometry.parameters.radialSegments!==Qe){var St=new ui.ConeGeometry(He*.25,He,Qe);St.translate(0,He/2,0),St.rotateX(Math.PI/2),Oe.geometry.dispose(),Oe.geometry=St}Oe.material.color=new ui.Color(I(Ne)||_(Ne)||"#f0f0f0"),Oe.material.opacity=n.linkOpacity*3}})}if(n.linkDirectionalParticles||i.hasOwnProperty("linkDirectionalParticles")){var N=Wn(n.linkDirectionalParticles),B=Wn(n.linkDirectionalParticleWidth),H=Wn(n.linkDirectionalParticleColor),q={},le={};gp(R.filter(N),n.graphScene,{objBindAttr:"__photonsObj",objFilter:function(Oe){return Oe.__linkThreeObjType==="photons"},createObj:function(){var Oe=new ui.Group;return Oe.__linkThreeObjType="photons",Oe},updateObj:function(Oe,Ne){var He=Math.round(Math.abs(N(Ne))),Qe=!!Oe.children.length&&Oe.children[0],St=Math.ceil(B(Ne)*10)/10/2,bt=n.linkDirectionalParticleResolution,Jt;Qe&&Qe.geometry.parameters.radius===St&&Qe.geometry.parameters.widthSegments===bt?Jt=Qe.geometry:(le.hasOwnProperty(St)||(le[St]=new ui.SphereGeometry(St,bt,bt)),Jt=le[St],Qe&&Qe.geometry.dispose());var sn=H(Ne)||_(Ne)||"#f0f0f0",Se=new ui.Color(t0(sn)),qe=n.linkOpacity*3,Ue;Qe&&Qe.material.color.equals(Se)&&Qe.material.opacity===qe?Ue=Qe.material:(q.hasOwnProperty(sn)||(q[sn]=new ui.MeshLambertMaterial({color:Se,transparent:!0,opacity:qe})),Ue=q[sn],Qe&&Qe.material.dispose()),gp($o(new Array(He)).map(function(At,tt){return{idx:tt}}),Oe,{idAccessor:function(tt){return tt.idx},createObj:function(){return new ui.Mesh(Jt,Ue)},updateObj:function(tt){tt.geometry=Jt,tt.material=Ue}})}})}}if(n._flushObjects=!1,o(["graphData","nodeId","linkSource","linkTarget","numDimensions","forceEngine","dagMode","dagNodeFilter","dagLevelDistance"])){n.engineRunning=!1,n.graphData.links.forEach(function(ke){ke.source=ke[n.linkSource],ke.target=ke[n.linkTarget]});var ne=n.forceEngine!=="ngraph",D;if(ne){(D=n.d3ForceLayout).stop().alpha(1).numDimensions(n.numDimensions).nodes(n.graphData.nodes);var O=n.d3ForceLayout.force("link");O&&O.id(function(ke){return ke[n.nodeId]}).links(n.graphData.links);var k=n.dagMode&&DY(n.graphData,function(ke){return ke[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),z=Math.max.apply(Math,$o(Object.values(k||[]))),X=n.dagLevelDistance||n.graphData.nodes.length/(z||1)*OY*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(n.dagMode){var Z=function(Oe,Ne){return function(He){return Oe?(k[He[n.nodeId]]-z/2)*X*(Ne?-1:1):void 0}},ie=Z(["lr","rl"].indexOf(n.dagMode)!==-1,n.dagMode==="rl"),se=Z(["td","bu"].indexOf(n.dagMode)!==-1,n.dagMode==="td"),ue=Z(["zin","zout"].indexOf(n.dagMode)!==-1,n.dagMode==="zout");n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(ke){ke.fx=ie(ke),ke.fy=se(ke),ke.fz=ue(ke)})}n.d3ForceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?GO(function(ke){var Oe=k[ke[n.nodeId]]||-1;return(n.dagMode==="radialin"?z-Oe:Oe)*X}).strength(function(ke){return n.dagNodeFilter(ke)?1:0}):null)}else{var ye=CR.graph();n.graphData.nodes.forEach(function(ke){ye.addNode(ke[n.nodeId])}),n.graphData.links.forEach(function(ke){ye.addLink(ke.source,ke.target)}),D=CR.forcelayout(ye,vI({dimensions:n.numDimensions},n.ngraphPhysics)),D.graph=ye}for(var Ce=0;Ce<n.warmupTicks&&!(ne&&n.d3AlphaMin>0&&n.d3ForceLayout.alpha()<n.d3AlphaMin);Ce++)D[ne?"tick":"step"]();n.layout=D,this.resetCountdown()}n.engineRunning=!0,n.onFinishUpdate()}});function kY(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Object,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,o=function(l){vY(u,l);var a=bY(u);function u(){var h;mY(this,u);for(var f=arguments.length,d=new Array(f),m=0;m<f;m++)d[m]=arguments[m];return h=a.call.apply(a,[this].concat(d)),h.__kapsuleInstance=r().apply(void 0,[].concat($o(i?[xI(h)]:[]),d)),h}return gY(u)}(n);return Object.keys(r()).forEach(function(l){return o.prototype[l]=function(){var a,u=(a=this.__kapsuleInstance)[l].apply(a,arguments);return u===this.__kapsuleInstance?this:u}}),o}var NY=window.THREE?window.THREE:{Group:Sd},Kw=kY(IY,NY.Group,!0);const FY=Object.freeze(Object.defineProperty({__proto__:null,default:Kw},Symbol.toStringTag,{value:"Module"})),BY=MA(FY);if(typeof AFRAME>"u")throw new Error("Component attempted to register before AFRAME was available.");let l1=KH;"default"in l1&&(l1=l1.default);let Su=BY;"default"in Su&&(Su=Su.default);const c1=function(r){return typeof r=="string"?JSON.parse(r):r},Vo=function(r){if(typeof r=="function")return r;const n=eval;try{return n("("+r+")")}catch{}return null},Rr=function(r){return isNaN(parseFloat(r))?Vo(r)?Vo(r):r:parseFloat(r)};AFRAME.registerComponent("forcegraph",{schema:{jsonUrl:{type:"string",default:""},nodes:{parse:c1,default:[]},links:{parse:c1,default:[]},numDimensions:{type:"number",default:3},dagMode:{type:"string",default:""},dagLevelDistance:{type:"number",default:0},dagNodeFilter:{parse:Vo,default:function(){return!0}},onDagError:{parse:Vo,default:void 0},nodeRelSize:{type:"number",default:4},nodeId:{type:"string",default:"id"},nodeVal:{parse:Rr,default:"val"},nodeResolution:{type:"number",default:8},nodeVisibility:{parse:Rr,default:!0},nodeColor:{parse:Rr,default:"color"},nodeAutoColorBy:{parse:Rr,default:""},nodeOpacity:{type:"number",default:.75},nodeThreeObject:{parse:Rr,default:null},nodeThreeObjectExtend:{parse:Rr,default:!1},linkSource:{type:"string",default:"source"},linkTarget:{type:"string",default:"target"},linkVisibility:{parse:Rr,default:!0},linkColor:{parse:Rr,default:"color"},linkAutoColorBy:{parse:Rr,default:""},linkOpacity:{type:"number",default:.2},linkWidth:{parse:Rr,default:0},linkResolution:{type:"number",default:6},linkCurvature:{parse:Rr,default:0},linkCurveRotation:{parse:Rr,default:0},linkMaterial:{parse:Rr,default:null},linkThreeObject:{parse:Rr,default:null},linkThreeObjectExtend:{parse:Rr,default:!1},linkPositionUpdate:{parse:Vo,default:null},linkDirectionalArrowLength:{parse:Rr,default:0},linkDirectionalArrowColor:{parse:Rr,default:null},linkDirectionalArrowRelPos:{parse:Rr,default:.5},linkDirectionalArrowResolution:{type:"number",default:8},linkDirectionalParticles:{parse:Rr,default:0},linkDirectionalParticleSpeed:{parse:Rr,default:.01},linkDirectionalParticleWidth:{parse:Rr,default:.5},linkDirectionalParticleColor:{parse:Rr,default:null},linkDirectionalParticleResolution:{type:"number",default:4},onNodeHover:{parse:Vo,default:()=>{}},onLinkHover:{parse:Vo,default:()=>{}},onNodeClick:{parse:Vo,default:()=>{}},onLinkClick:{parse:Vo,default:()=>{}},forceEngine:{type:"string",default:"d3"},d3AlphaMin:{type:"number",default:0},d3AlphaDecay:{type:"number",default:.0228},d3VelocityDecay:{type:"number",default:.4},ngraphPhysics:{parse:c1,default:null},warmupTicks:{type:"int",default:0},cooldownTicks:{type:"int",default:1e18},cooldownTime:{type:"int",default:15e3},onEngineTick:{parse:Vo,default:function(){}},onEngineStop:{parse:Vo,default:function(){}}},getGraphBbox:function(){return this.forceGraph||(this.forceGraph=new Su),this.forceGraph.getGraphBbox()},emitParticle:function(){this.forceGraph||(this.forceGraph=new Su);const r=this.forceGraph,n=r.emitParticle.apply(r,arguments);return n===r?this:n},d3Force:function(){this.forceGraph||(this.forceGraph=new Su);const r=this.forceGraph,n=r.d3Force.apply(r,arguments);return n===r?this:n},d3ReheatSimulation:function(){return this.forceGraph&&this.forceGraph.d3ReheatSimulation(),this},refresh:function(){return this.forceGraph&&this.forceGraph.refresh(),this},init:function(){const r=this.state={};r.infoEl=document.createElement("a-text"),r.infoEl.setAttribute("position","0 -0.1 -1"),r.infoEl.setAttribute("width",1),r.infoEl.setAttribute("align","center"),r.infoEl.setAttribute("color","lavender");const n=document.querySelector("a-entity[camera], a-camera");n.appendChild(r.infoEl),r.cameraObj=n.object3D.children.filter(function(i){return i.type==="PerspectiveCamera"})[0],this.el.sceneEl.addEventListener("camera-set-active",function(i){r.cameraObj=i.detail.cameraEl.components.camera.camera}),this.forceGraph||(this.forceGraph=new Su),this.forceGraph.onFinishUpdate(()=>this.el.setObject3D("forcegraphGroup",this.forceGraph)).onLoading(()=>r.infoEl.setAttribute("value","Loading...")).onFinishLoading(()=>r.infoEl.setAttribute("value","")),this.el.addEventListener("raycaster-intersected",i=>r.hoverDetail=i.detail),this.el.addEventListener("raycaster-intersected-cleared",i=>r.hoverDetail=i.detail),this.el.addEventListener("click",()=>r.hoverObj&&this.data["on"+(r.hoverObj.__graphObjType==="node"?"Node":"Link")+"Click"](r.hoverObj.__data))},remove:function(){this.state.infoEl.remove(),this.el.removeObject3D("forcegraphGroup")},update:function(r){const n=this,i=this.data,o=AFRAME.utils.diff(i,r);["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].filter(function(a){return a in o}).forEach(function(a){n.forceGraph[a](i[a]!==""?i[a]:null)}),("nodes"in o||"links"in o)&&n.forceGraph.graphData({nodes:i.nodes,links:i.links})},tick:function(r,n){const i=this.state,o=this.data,l=i.hoverDetail?i.hoverDetail.getIntersection?i.hoverDetail.getIntersection(this.el):i.hoverDetail.intersection||void 0:void 0;let a=l?l.object:void 0;for(;a&&!a.hasOwnProperty("__graphObjType");)a=a.parent;if(a!==i.hoverObj){const u=i.hoverObj?i.hoverObj.__graphObjType:null,h=i.hoverObj?i.hoverObj.__data:null,f=a?a.__graphObjType:null,d=a?a.__data:null;u&&u!==f&&o["on"+(u==="node"?"Node":"Link")+"Hover"](null,h),f&&o["on"+(f==="node"?"Node":"Link")+"Hover"](d,u===f?h:null),i.hoverObj=a}this.forceGraph.tickFrame()}});function iA(){return iA=Object.assign?Object.assign.bind():function(r){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(r[o]=i[o])}return r},iA.apply(this,arguments)}function UY(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Mm(r,n){return Mm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},Mm(r,n)}function zY(r,n){r.prototype=Object.create(n.prototype),r.prototype.constructor=r,Mm(r,n)}function rA(r){return rA=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},rA(r)}function HY(r){return Function.toString.call(r).indexOf("[native code]")!==-1}function GY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function I0(r,n,i){return GY()?I0=Reflect.construct.bind():I0=function(l,a,u){var h=[null];h.push.apply(h,a);var f=Function.bind.apply(l,h),d=new f;return u&&Mm(d,u.prototype),d},I0.apply(null,arguments)}function sA(r){var n=typeof Map=="function"?new Map:void 0;return sA=function(o){if(o===null||!HY(o))return o;if(typeof o!="function")throw new TypeError("Super expression must either be null or a function");if(typeof n<"u"){if(n.has(o))return n.get(o);n.set(o,l)}function l(){return I0(o,arguments,rA(this).constructor)}return l.prototype=Object.create(o.prototype,{constructor:{value:l,enumerable:!1,writable:!0,configurable:!0}}),Mm(l,o)},sA(r)}var Td=function(r){zY(n,r);function n(i){var o;return o=r.call(this,"An error occurred. See https://github.com/styled-components/polished/blob/main/src/internalHelpers/errors.md#"+i+" for more information.")||this,UY(o)}return n}(sA(Error));function u1(r){return Math.round(r*255)}function VY(r,n,i){return u1(r)+","+u1(n)+","+u1(i)}function LR(r,n,i,o){if(o===void 0&&(o=VY),n===0)return o(i,i,i);var l=(r%360+360)%360/60,a=(1-Math.abs(2*i-1))*n,u=a*(1-Math.abs(l%2-1)),h=0,f=0,d=0;l>=0&&l<1?(h=a,f=u):l>=1&&l<2?(h=u,f=a):l>=2&&l<3?(f=a,d=u):l>=3&&l<4?(f=u,d=a):l>=4&&l<5?(h=u,d=a):l>=5&&l<6&&(h=a,d=u);var m=i-a/2,g=h+m,x=f+m,v=d+m;return o(g,x,v)}var PR={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"639",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"};function WY(r){if(typeof r!="string")return r;var n=r.toLowerCase();return PR[n]?"#"+PR[n]:r}var jY=/^#[a-fA-F0-9]{6}$/,$Y=/^#[a-fA-F0-9]{8}$/,XY=/^#[a-fA-F0-9]{3}$/,qY=/^#[a-fA-F0-9]{4}$/,h1=/^rgb\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*\)$/i,YY=/^rgb(?:a)?\(\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,)?\s*(\d{1,3})\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i,KY=/^hsl\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*\)$/i,QY=/^hsl(?:a)?\(\s*(\d{0,3}[.]?[0-9]+(?:deg)?)\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,)?\s*(\d{1,3}[.]?[0-9]?)%\s*(?:,|\/)\s*([-+]?\d*[.]?\d+[%]?)\s*\)$/i;function Ky(r){if(typeof r!="string")throw new Td(3);var n=WY(r);if(n.match(jY))return{red:parseInt(""+n[1]+n[2],16),green:parseInt(""+n[3]+n[4],16),blue:parseInt(""+n[5]+n[6],16)};if(n.match($Y)){var i=parseFloat((parseInt(""+n[7]+n[8],16)/255).toFixed(2));return{red:parseInt(""+n[1]+n[2],16),green:parseInt(""+n[3]+n[4],16),blue:parseInt(""+n[5]+n[6],16),alpha:i}}if(n.match(XY))return{red:parseInt(""+n[1]+n[1],16),green:parseInt(""+n[2]+n[2],16),blue:parseInt(""+n[3]+n[3],16)};if(n.match(qY)){var o=parseFloat((parseInt(""+n[4]+n[4],16)/255).toFixed(2));return{red:parseInt(""+n[1]+n[1],16),green:parseInt(""+n[2]+n[2],16),blue:parseInt(""+n[3]+n[3],16),alpha:o}}var l=h1.exec(n);if(l)return{red:parseInt(""+l[1],10),green:parseInt(""+l[2],10),blue:parseInt(""+l[3],10)};var a=YY.exec(n.substring(0,50));if(a)return{red:parseInt(""+a[1],10),green:parseInt(""+a[2],10),blue:parseInt(""+a[3],10),alpha:parseFloat(""+a[4])>1?parseFloat(""+a[4])/100:parseFloat(""+a[4])};var u=KY.exec(n);if(u){var h=parseInt(""+u[1],10),f=parseInt(""+u[2],10)/100,d=parseInt(""+u[3],10)/100,m="rgb("+LR(h,f,d)+")",g=h1.exec(m);if(!g)throw new Td(4,n,m);return{red:parseInt(""+g[1],10),green:parseInt(""+g[2],10),blue:parseInt(""+g[3],10)}}var x=QY.exec(n.substring(0,50));if(x){var v=parseInt(""+x[1],10),A=parseInt(""+x[2],10)/100,_=parseInt(""+x[3],10)/100,E="rgb("+LR(v,A,_)+")",w=h1.exec(E);if(!w)throw new Td(4,n,E);return{red:parseInt(""+w[1],10),green:parseInt(""+w[2],10),blue:parseInt(""+w[3],10),alpha:parseFloat(""+x[4])>1?parseFloat(""+x[4])/100:parseFloat(""+x[4])}}throw new Td(5)}var ZY=function(n){return n.length===7&&n[1]===n[2]&&n[3]===n[4]&&n[5]===n[6]?"#"+n[1]+n[3]+n[5]:n},DR=ZY;function id(r){var n=r.toString(16);return n.length===1?"0"+n:n}function OR(r,n,i){if(typeof r=="number"&&typeof n=="number"&&typeof i=="number")return DR("#"+id(r)+id(n)+id(i));if(typeof r=="object"&&n===void 0&&i===void 0)return DR("#"+id(r.red)+id(r.green)+id(r.blue));throw new Td(6)}function JY(r,n,i,o){if(typeof r=="string"&&typeof n=="number"){var l=Ky(r);return"rgba("+l.red+","+l.green+","+l.blue+","+n+")"}else{if(typeof r=="number"&&typeof n=="number"&&typeof i=="number"&&typeof o=="number")return o>=1?OR(r,n,i):"rgba("+r+","+n+","+i+","+o+")";if(typeof r=="object"&&n===void 0&&i===void 0&&o===void 0)return r.alpha>=1?OR(r.red,r.green,r.blue):"rgba("+r.red+","+r.green+","+r.blue+","+r.alpha+")"}throw new Td(7)}function bI(r,n,i){return function(){var l=i.concat(Array.prototype.slice.call(arguments));return l.length>=n?r.apply(this,l):bI(r,n,l)}}function eK(r){return bI(r,r.length,[])}function tK(r,n,i){return Math.max(r,Math.min(n,i))}function nK(r,n){if(n==="transparent")return n;var i=Ky(n),o=typeof i.alpha=="number"?i.alpha:1,l=iA({},i,{alpha:tK(0,1,(o*100+parseFloat(r)*100)/100)});return JY(l)}var iK=eK(nK),EI=iK;function rK(r,n){n===void 0&&(n={});var i=n.insertAt;if(!(!r||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",i==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=r:l.appendChild(document.createTextNode(r))}}var sK=`.graph-nav-info {
  position: absolute;
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
  font-family: Sans-serif;
  z-index: 1000;
}`;rK(sK);function IR(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),i.push.apply(i,o)}return i}function kR(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?IR(Object(i),!0).forEach(function(o){kp(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):IR(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function kp(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function d1(r,n){return aK(r)||cK(r,n)||AI(r,n)||hK()}function i0(r){return oK(r)||lK(r)||AI(r)||uK()}function oK(r){if(Array.isArray(r))return oA(r)}function aK(r){if(Array.isArray(r))return r}function lK(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function cK(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function AI(r,n){if(!!r){if(typeof r=="string")return oA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return oA(r,n)}}function oA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function uK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var dK=Yu({props:{width:{default:window.innerWidth,triggerUpdate:!1,onChange:function(n,i){i.container&&(i.container.style.width="".concat(n,"px"))}},height:{default:window.innerHeight,triggerUpdate:!1,onChange:function(n,i){i.container&&(i.container.style.height="".concat(n,"px"))}},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},backgroundColor:{default:"#002"},showNavInfo:{default:!0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeLabel:{default:"name"},nodeDesc:{default:"desc"},onNodeHover:{},onNodeClick:{},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkLabel:{default:"name"},linkDesc:{default:"desc"},onLinkHover:{},onLinkClick:{},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:kR(kR({},Object.assign.apply(Object,[{}].concat(i0(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(r){return kp({},r,function(n){for(var i=n.forcegraph.components.forcegraph,o=arguments.length,l=new Array(o>1?o-1:0),a=1;a<o;a++)l[a-1]=arguments[a];var u=i[r].apply(i,l);return u===i?this:u})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(n,i){n.innerHTML="",i.container=document.createElement("div"),n.appendChild(i.container),i.container.style.position="relative",i.container.style.width="".concat(i.width,"px"),i.container.style.height="".concat(i.height,"px"),i.container.appendChild(i.navInfo=document.createElement("div")),i.navInfo.className="graph-nav-info",i.navInfo.textContent="Mouse drag: look, gamepad/arrow/wasd keys: move";var o=document.createElement("a-scene");o.setAttribute("embedded",""),o.appendChild(i.sky=document.createElement("a-sky")),i.sky.setAttribute("radius",3e3);var l;o.appendChild(l=document.createElement("a-entity")),l.setAttribute("position","0 0 300"),l.setAttribute("movement-controls","fly: true; speed: 7");var a;l.appendChild(a=document.createElement("a-entity")),a.setAttribute("camera",""),a.setAttribute("position","0 0 0"),a.setAttribute("look-controls","reverseMouseDrag: false; pointerLockEnabled: false");var u;a.appendChild(u=document.createElement("a-text")),u.setAttribute("position","0 -0.3 -1"),u.setAttribute("width",2),u.setAttribute("align","center"),u.setAttribute("color","lavender"),u.setAttribute("value","");var h;a.appendChild(h=document.createElement("a-text")),h.setAttribute("position","0 -0.4 -1"),h.setAttribute("width",1.3),h.setAttribute("align","center"),h.setAttribute("color","lavender"),h.setAttribute("value",""),i.raycasterEls=[];var f;o.appendChild(f=document.createElement("a-entity")),f.setAttribute("cursor","rayOrigin: mouse; mouseCursorStylesEnabled: true"),f.setAttribute("raycaster","objects: [forcegraph]; interval: 100"),i.raycasterEls.push(f),["left","right"].forEach(function(d){var m;l.appendChild(m=document.createElement("a-entity")),m.setAttribute("laser-controls","hand: ".concat(d)),m.setAttribute("raycaster","objects: [forcegraph]; interval: 100; lineColor: steelblue; lineOpacity: 0.85"),i.raycasterEls.push(m)}),o.appendChild(i.forcegraph=document.createElement("a-entity")),i.forcegraph.setAttribute("forcegraph",null),i.container.appendChild(o),i.forcegraph.setAttribute("forcegraph",Object.assign.apply(Object,i0(["node","link"].map(function(d){var m={node:"Node",link:"Link"}[d];return kp({},"on".concat(m,"Hover"),function(x,v){var A=x&&Wn(i["".concat(d,"Label")])(x)||"",_=x&&Wn(i["".concat(d,"Desc")])(x)||"";u.setAttribute("value",A),h.setAttribute("value",_),i["on".concat(m,"Hover")]&&i["on".concat(m,"Hover")](x,v)})}))))},update:function(n,i){if(i.hasOwnProperty("backgroundColor")){var o=Ky(n.backgroundColor).alpha;o===void 0&&(o=1),n.sky.setAttribute("color",EI(1,n.backgroundColor)),n.sky.setAttribute("opacity",o)}i.hasOwnProperty("showNavInfo")&&(n.navInfo.style.display=n.showNavInfo?null:"none");var l=["onNodeHover","onLinkHover","onNodeClick","onLinkClick"].some(function(h){return n[h]})||["nodeLabel","linkLabel"].some(function(h){return n[h]!=="name"})||["nodeDesc","linkDesc"].some(function(h){return n[h]!=="desc"});n.raycasterEls.forEach(function(h){return h.setAttribute("raycaster",l?"objects: [forcegraph]; interval: 100":"objects: __none__")});var a=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","onNodeClick","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","onLinkClick","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],u=Object.assign.apply(Object,[{}].concat(i0(Object.entries(n).filter(function(h){var f=d1(h,2),d=f[0],m=f[1];return i.hasOwnProperty(d)&&a.indexOf(d)!==-1&&m!==void 0&&m!==null}).map(function(h){var f=d1(h,2),d=f[0],m=f[1];return kp({},d,m)})),i0(Object.entries(n.graphData).map(function(h){var f=d1(h,2),d=f[0],m=f[1];return kp({},d,m)}))));n.forcegraph.setAttribute("forcegraph",u)}}),dt={exports:{}},fK="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",pK=fK,mK=pK;function wI(){}function MI(){}MI.resetWarningCache=wI;var gK=function(){function r(o,l,a,u,h,f){if(f!==mK){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}r.isRequired=r;function n(){return r}var i={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:n,element:r,elementType:r,instanceOf:n,node:r,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:MI,resetWarningCache:wI};return i.PropTypes=i,i};dt.exports=gK();function NR(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),i.push.apply(i,o)}return i}function FR(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?NR(Object(i),!0).forEach(function(o){k0(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):NR(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function k0(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function r0(r,n){return yK(r)||_K(r,n)||SI(r,n)||EK()}function s0(r){return vK(r)||xK(r)||SI(r)||bK()}function vK(r){if(Array.isArray(r))return aA(r)}function yK(r){if(Array.isArray(r))return r}function xK(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function _K(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function SI(r,n){if(!!r){if(typeof r=="string")return aA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return aA(r,n)}}function aA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function bK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var AK=Yu({props:{width:{},height:{},yOffset:{default:1.5},glScale:{default:200},jsonUrl:{},graphData:{default:{nodes:[],links:[]}},numDimensions:{default:3},dagMode:{},dagLevelDistance:{},dagNodeFilter:{default:function(){return!0}},onDagError:{default:void 0},nodeRelSize:{default:4},nodeId:{default:"id"},nodeVal:{default:"val"},nodeResolution:{default:8},nodeVisibility:{default:!0},nodeColor:{default:"color"},nodeAutoColorBy:{},nodeOpacity:{default:.75},nodeThreeObject:{},nodeThreeObjectExtend:{default:!1},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0},linkColor:{default:"color"},linkAutoColorBy:{},linkOpacity:{default:.2},linkWidth:{default:0},linkResolution:{default:6},linkCurvature:{default:0},linkCurveRotation:{default:0},linkMaterial:{},linkThreeObject:{},linkThreeObjectExtend:{default:!1},linkPositionUpdate:{},linkDirectionalArrowLength:{default:0},linkDirectionalArrowColor:{},linkDirectionalArrowRelPos:{default:.5},linkDirectionalArrowResolution:{default:8},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01},linkDirectionalParticleWidth:{default:.5},linkDirectionalParticleColor:{},linkDirectionalParticleResolution:{default:4},onNodeHover:{},onNodeClick:{},onLinkHover:{},onLinkClick:{},forceEngine:{default:"d3"},d3AlphaMin:{default:0},d3AlphaDecay:{default:.0228},d3VelocityDecay:{default:.4},ngraphPhysics:{},warmupTicks:{default:0},cooldownTicks:{},cooldownTime:{default:15e3},onEngineTick:{},onEngineStop:{}},methods:FR(FR({},Object.assign.apply(Object,[{}].concat(s0(["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"].map(function(r){return k0({},r,function(n){for(var i=n.forcegraph.components.forcegraph,o=arguments.length,l=new Array(o>1?o-1:0),a=1;a<o;a++)l[a-1]=arguments[a];var u=i[r].apply(i,l);return u===i?this:u})}))))),{},{_destructor:function(){this.graphData({nodes:[],links:[]})}}),init:function(n,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=o.markerAttrs,a=l===void 0?{preset:"hiro"}:l;n.innerHTML="",i.container=document.createElement("div"),n.appendChild(i.container);var u=document.createElement("a-scene");u.setAttribute("embedded",""),u.setAttribute("arjs","debugUIEnabled: false;");var h=document.createElement("a-marker");Object.entries(a).forEach(function(m){var g=r0(m,2),x=g[0],v=g[1];return h.setAttribute(x,v)}),u.appendChild(h);var f;u.appendChild(f=document.createElement("a-entity")),f.setAttribute("cursor"),f.setAttribute("raycaster","objects: [forcegraph]"),i.forcegraph=document.createElement("a-entity"),i.forcegraph.setAttribute("forcegraph",null),h.appendChild(i.forcegraph);var d=document.createElement("a-entity");d.setAttribute("camera",""),u.appendChild(d),i.container.appendChild(u)},update:function(n,i){i.hasOwnProperty("width")&&n.width&&(n.container.style.width="".concat(n.width,"px")),i.hasOwnProperty("height")&&n.height&&(n.container.style.height="".concat(n.height,"px")),i.hasOwnProperty("glScale")&&n.forcegraph.setAttribute("scale",s0(new Array(3)).map(function(){return 1/n.glScale}).join(" ")),i.hasOwnProperty("yOffset")&&n.forcegraph.setAttribute("position","0 ".concat(n.yOffset," 0"));var o=["jsonUrl","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeVisibility","nodeColor","nodeAutoColorBy","nodeOpacity","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","onNodeHover","onNodeClick","onLinkHover","onLinkClick","forceEngine","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"],l=Object.assign.apply(Object,[{}].concat(s0(Object.entries(n).filter(function(a){var u=r0(a,2),h=u[0],f=u[1];return i.hasOwnProperty(h)&&o.indexOf(h)!==-1&&f!==void 0&&f!==null}).map(function(a){var u=r0(a,2),h=u[0],f=u[1];return k0({},h,f)})),s0(Object.entries(n.graphData).map(function(a){var u=r0(a,2),h=u[0],f=u[1];return k0({},h,f)}))));n.forcegraph.setAttribute("forcegraph",l)}});const rd=new cc,tc=new RO,vp=new Rn,BR=new it,o0=new it,f1=new it,UR=new Er;class wK extends ra{constructor(n,i,o){super(),o.style.touchAction="none";let l=null,a=null;const u=[],h=this;function f(){o.addEventListener("pointermove",v),o.addEventListener("pointerdown",A),o.addEventListener("pointerup",_),o.addEventListener("pointerleave",_)}function d(){o.removeEventListener("pointermove",v),o.removeEventListener("pointerdown",A),o.removeEventListener("pointerup",_),o.removeEventListener("pointerleave",_),o.style.cursor=""}function m(){d()}function g(){return n}function x(){return tc}function v(w){if(h.enabled!==!1){if(E(w),tc.setFromCamera(vp,i),l){tc.ray.intersectPlane(rd,o0)&&l.position.copy(o0.sub(BR).applyMatrix4(UR)),h.dispatchEvent({type:"drag",object:l});return}if(w.pointerType==="mouse"||w.pointerType==="pen")if(u.length=0,tc.setFromCamera(vp,i),tc.intersectObjects(n,!0,u),u.length>0){const S=u[0].object;rd.setFromNormalAndCoplanarPoint(i.getWorldDirection(rd.normal),f1.setFromMatrixPosition(S.matrixWorld)),a!==S&&a!==null&&(h.dispatchEvent({type:"hoveroff",object:a}),o.style.cursor="auto",a=null),a!==S&&(h.dispatchEvent({type:"hoveron",object:S}),o.style.cursor="pointer",a=S)}else a!==null&&(h.dispatchEvent({type:"hoveroff",object:a}),o.style.cursor="auto",a=null)}}function A(w){h.enabled!==!1&&(E(w),u.length=0,tc.setFromCamera(vp,i),tc.intersectObjects(n,!0,u),u.length>0&&(l=h.transformGroup===!0?n[0]:u[0].object,rd.setFromNormalAndCoplanarPoint(i.getWorldDirection(rd.normal),f1.setFromMatrixPosition(l.matrixWorld)),tc.ray.intersectPlane(rd,o0)&&(UR.copy(l.parent.matrixWorld).invert(),BR.copy(o0).sub(f1.setFromMatrixPosition(l.matrixWorld))),o.style.cursor="move",h.dispatchEvent({type:"dragstart",object:l})))}function _(){h.enabled!==!1&&(l&&(h.dispatchEvent({type:"dragend",object:l}),l=null),o.style.cursor=a?"pointer":"auto")}function E(w){const S=o.getBoundingClientRect();vp.x=(w.clientX-S.left)/S.width*2-1,vp.y=-(w.clientY-S.top)/S.height*2+1}f(),this.enabled=!0,this.transformGroup=!1,this.activate=f,this.deactivate=d,this.dispose=m,this.getObjects=g,this.getRaycaster=x}}const p1={type:"change"},m1={type:"start"},g1={type:"end"};class MK extends ra{constructor(n,i){super();const o=this,l={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=n,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Aa.ROTATE,MIDDLE:Aa.DOLLY,RIGHT:Aa.PAN},this.target=new it;const a=1e-6,u=new it;let h=1,f=l.NONE,d=l.NONE,m=0,g=0,x=0;const v=new it,A=new Rn,_=new Rn,E=new it,w=new Rn,S=new Rn,T=new Rn,R=new Rn,L=[],I={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const He=o.domElement.getBoundingClientRect(),Qe=o.domElement.ownerDocument.documentElement;o.screen.left=He.left+window.pageXOffset-Qe.clientLeft,o.screen.top=He.top+window.pageYOffset-Qe.clientTop,o.screen.width=He.width,o.screen.height=He.height};const N=function(){const He=new Rn;return function(St,bt){return He.set((St-o.screen.left)/o.screen.width,(bt-o.screen.top)/o.screen.height),He}}(),B=function(){const He=new Rn;return function(St,bt){return He.set((St-o.screen.width*.5-o.screen.left)/(o.screen.width*.5),(o.screen.height+2*(o.screen.top-bt))/o.screen.width),He}}();this.rotateCamera=function(){const He=new it,Qe=new ia,St=new it,bt=new it,Jt=new it,sn=new it;return function(){sn.set(_.x-A.x,_.y-A.y,0);let qe=sn.length();qe?(v.copy(o.object.position).sub(o.target),St.copy(v).normalize(),bt.copy(o.object.up).normalize(),Jt.crossVectors(bt,St).normalize(),bt.setLength(_.y-A.y),Jt.setLength(_.x-A.x),sn.copy(bt.add(Jt)),He.crossVectors(sn,v).normalize(),qe*=o.rotateSpeed,Qe.setFromAxisAngle(He,qe),v.applyQuaternion(Qe),o.object.up.applyQuaternion(Qe),E.copy(He),x=qe):!o.staticMoving&&x&&(x*=Math.sqrt(1-o.dynamicDampingFactor),v.copy(o.object.position).sub(o.target),Qe.setFromAxisAngle(E,x),v.applyQuaternion(Qe),o.object.up.applyQuaternion(Qe)),A.copy(_)}}(),this.zoomCamera=function(){let He;f===l.TOUCH_ZOOM_PAN?(He=m/g,m=g,o.object.isPerspectiveCamera?v.multiplyScalar(He):o.object.isOrthographicCamera?(o.object.zoom/=He,o.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(He=1+(S.y-w.y)*o.zoomSpeed,He!==1&&He>0&&(o.object.isPerspectiveCamera?v.multiplyScalar(He):o.object.isOrthographicCamera?(o.object.zoom/=He,o.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),o.staticMoving?w.copy(S):w.y+=(S.y-w.y)*this.dynamicDampingFactor)},this.panCamera=function(){const He=new Rn,Qe=new it,St=new it;return function(){if(He.copy(R).sub(T),He.lengthSq()){if(o.object.isOrthographicCamera){const Jt=(o.object.right-o.object.left)/o.object.zoom/o.domElement.clientWidth,sn=(o.object.top-o.object.bottom)/o.object.zoom/o.domElement.clientWidth;He.x*=Jt,He.y*=sn}He.multiplyScalar(v.length()*o.panSpeed),St.copy(v).cross(o.object.up).setLength(He.x),St.add(Qe.copy(o.object.up).setLength(He.y)),o.object.position.add(St),o.target.add(St),o.staticMoving?T.copy(R):T.add(He.subVectors(R,T).multiplyScalar(o.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!o.noZoom||!o.noPan)&&(v.lengthSq()>o.maxDistance*o.maxDistance&&(o.object.position.addVectors(o.target,v.setLength(o.maxDistance)),w.copy(S)),v.lengthSq()<o.minDistance*o.minDistance&&(o.object.position.addVectors(o.target,v.setLength(o.minDistance)),w.copy(S)))},this.update=function(){v.subVectors(o.object.position,o.target),o.noRotate||o.rotateCamera(),o.noZoom||o.zoomCamera(),o.noPan||o.panCamera(),o.object.position.addVectors(o.target,v),o.object.isPerspectiveCamera?(o.checkDistances(),o.object.lookAt(o.target),u.distanceToSquared(o.object.position)>a&&(o.dispatchEvent(p1),u.copy(o.object.position))):o.object.isOrthographicCamera?(o.object.lookAt(o.target),(u.distanceToSquared(o.object.position)>a||h!==o.object.zoom)&&(o.dispatchEvent(p1),u.copy(o.object.position),h=o.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){f=l.NONE,d=l.NONE,o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.up.copy(o.up0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),v.subVectors(o.object.position,o.target),o.object.lookAt(o.target),o.dispatchEvent(p1),u.copy(o.object.position),h=o.object.zoom};function H(He){o.enabled!==!1&&(L.length===0&&(o.domElement.setPointerCapture(He.pointerId),o.domElement.addEventListener("pointermove",q),o.domElement.addEventListener("pointerup",le)),Ce(He),He.pointerType==="touch"?ie(He):k(He))}function q(He){o.enabled!==!1&&(He.pointerType==="touch"?se(He):z(He))}function le(He){o.enabled!==!1&&(He.pointerType==="touch"?ue(He):X(),ke(He),L.length===0&&(o.domElement.releasePointerCapture(He.pointerId),o.domElement.removeEventListener("pointermove",q),o.domElement.removeEventListener("pointerup",le)))}function ne(He){ke(He)}function D(He){o.enabled!==!1&&(window.removeEventListener("keydown",D),d===l.NONE&&(He.code===o.keys[l.ROTATE]&&!o.noRotate?d=l.ROTATE:He.code===o.keys[l.ZOOM]&&!o.noZoom?d=l.ZOOM:He.code===o.keys[l.PAN]&&!o.noPan&&(d=l.PAN)))}function O(){o.enabled!==!1&&(d=l.NONE,window.addEventListener("keydown",D))}function k(He){if(f===l.NONE)switch(He.button){case o.mouseButtons.LEFT:f=l.ROTATE;break;case o.mouseButtons.MIDDLE:f=l.ZOOM;break;case o.mouseButtons.RIGHT:f=l.PAN;break}const Qe=d!==l.NONE?d:f;Qe===l.ROTATE&&!o.noRotate?(_.copy(B(He.pageX,He.pageY)),A.copy(_)):Qe===l.ZOOM&&!o.noZoom?(w.copy(N(He.pageX,He.pageY)),S.copy(w)):Qe===l.PAN&&!o.noPan&&(T.copy(N(He.pageX,He.pageY)),R.copy(T)),o.dispatchEvent(m1)}function z(He){const Qe=d!==l.NONE?d:f;Qe===l.ROTATE&&!o.noRotate?(A.copy(_),_.copy(B(He.pageX,He.pageY))):Qe===l.ZOOM&&!o.noZoom?S.copy(N(He.pageX,He.pageY)):Qe===l.PAN&&!o.noPan&&R.copy(N(He.pageX,He.pageY))}function X(){f=l.NONE,o.dispatchEvent(g1)}function Z(He){if(o.enabled!==!1&&o.noZoom!==!0){switch(He.preventDefault(),He.deltaMode){case 2:w.y-=He.deltaY*.025;break;case 1:w.y-=He.deltaY*.01;break;default:w.y-=He.deltaY*25e-5;break}o.dispatchEvent(m1),o.dispatchEvent(g1)}}function ie(He){switch(Oe(He),L.length){case 1:f=l.TOUCH_ROTATE,_.copy(B(L[0].pageX,L[0].pageY)),A.copy(_);break;default:f=l.TOUCH_ZOOM_PAN;const Qe=L[0].pageX-L[1].pageX,St=L[0].pageY-L[1].pageY;g=m=Math.sqrt(Qe*Qe+St*St);const bt=(L[0].pageX+L[1].pageX)/2,Jt=(L[0].pageY+L[1].pageY)/2;T.copy(N(bt,Jt)),R.copy(T);break}o.dispatchEvent(m1)}function se(He){switch(Oe(He),L.length){case 1:A.copy(_),_.copy(B(He.pageX,He.pageY));break;default:const Qe=Ne(He),St=He.pageX-Qe.x,bt=He.pageY-Qe.y;g=Math.sqrt(St*St+bt*bt);const Jt=(He.pageX+Qe.x)/2,sn=(He.pageY+Qe.y)/2;R.copy(N(Jt,sn));break}}function ue(He){switch(L.length){case 0:f=l.NONE;break;case 1:f=l.TOUCH_ROTATE,_.copy(B(He.pageX,He.pageY)),A.copy(_);break;case 2:f=l.TOUCH_ZOOM_PAN;for(let Qe=0;Qe<L.length;Qe++)if(L[Qe].pointerId!==He.pointerId){const St=I[L[Qe].pointerId];_.copy(B(St.x,St.y)),A.copy(_);break}break}o.dispatchEvent(g1)}function ye(He){o.enabled!==!1&&He.preventDefault()}function Ce(He){L.push(He)}function ke(He){delete I[He.pointerId];for(let Qe=0;Qe<L.length;Qe++)if(L[Qe].pointerId==He.pointerId){L.splice(Qe,1);return}}function Oe(He){let Qe=I[He.pointerId];Qe===void 0&&(Qe=new Rn,I[He.pointerId]=Qe),Qe.set(He.pageX,He.pageY)}function Ne(He){const Qe=He.pointerId===L[0].pointerId?L[1]:L[0];return I[Qe.pointerId]}this.dispose=function(){o.domElement.removeEventListener("contextmenu",ye),o.domElement.removeEventListener("pointerdown",H),o.domElement.removeEventListener("pointercancel",ne),o.domElement.removeEventListener("wheel",Z),o.domElement.removeEventListener("pointermove",q),o.domElement.removeEventListener("pointerup",le),window.removeEventListener("keydown",D),window.removeEventListener("keyup",O)},this.domElement.addEventListener("contextmenu",ye),this.domElement.addEventListener("pointerdown",H),this.domElement.addEventListener("pointercancel",ne),this.domElement.addEventListener("wheel",Z,{passive:!1}),window.addEventListener("keydown",D),window.addEventListener("keyup",O),this.handleResize(),this.update()}}const zR={type:"change"},v1={type:"start"},HR={type:"end"};class SK extends ra{constructor(n,i){super(),this.object=n,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new it,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Aa.ROTATE,MIDDLE:Aa.DOLLY,RIGHT:Aa.PAN},this.touches={ONE:Gh.ROTATE,TWO:Gh.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return h.phi},this.getAzimuthalAngle=function(){return h.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(ve){ve.addEventListener("keydown",Re),this._domElementKeyEvents=ve},this.saveState=function(){o.target0.copy(o.target),o.position0.copy(o.object.position),o.zoom0=o.object.zoom},this.reset=function(){o.target.copy(o.target0),o.object.position.copy(o.position0),o.object.zoom=o.zoom0,o.object.updateProjectionMatrix(),o.dispatchEvent(zR),o.update(),a=l.NONE},this.update=function(){const ve=new it,Le=new ia().setFromUnitVectors(n.up,new it(0,1,0)),wt=Le.clone().invert(),Ot=new it,_t=new ia,Ut=2*Math.PI;return function(){const dn=o.object.position;ve.copy(dn).sub(o.target),ve.applyQuaternion(Le),h.setFromVector3(ve),o.autoRotate&&a===l.NONE&&H(N()),o.enableDamping?(h.theta+=f.theta*o.dampingFactor,h.phi+=f.phi*o.dampingFactor):(h.theta+=f.theta,h.phi+=f.phi);let Un=o.minAzimuthAngle,$n=o.maxAzimuthAngle;return isFinite(Un)&&isFinite($n)&&(Un<-Math.PI?Un+=Ut:Un>Math.PI&&(Un-=Ut),$n<-Math.PI?$n+=Ut:$n>Math.PI&&($n-=Ut),Un<=$n?h.theta=Math.max(Un,Math.min($n,h.theta)):h.theta=h.theta>(Un+$n)/2?Math.max(Un,h.theta):Math.min($n,h.theta)),h.phi=Math.max(o.minPolarAngle,Math.min(o.maxPolarAngle,h.phi)),h.makeSafe(),h.radius*=d,h.radius=Math.max(o.minDistance,Math.min(o.maxDistance,h.radius)),o.enableDamping===!0?o.target.addScaledVector(m,o.dampingFactor):o.target.add(m),ve.setFromSpherical(h),ve.applyQuaternion(wt),dn.copy(o.target).add(ve),o.object.lookAt(o.target),o.enableDamping===!0?(f.theta*=1-o.dampingFactor,f.phi*=1-o.dampingFactor,m.multiplyScalar(1-o.dampingFactor)):(f.set(0,0,0),m.set(0,0,0)),d=1,g||Ot.distanceToSquared(o.object.position)>u||8*(1-_t.dot(o.object.quaternion))>u?(o.dispatchEvent(zR),Ot.copy(o.object.position),_t.copy(o.object.quaternion),g=!1,!0):!1}}(),this.dispose=function(){o.domElement.removeEventListener("contextmenu",J),o.domElement.removeEventListener("pointerdown",qe),o.domElement.removeEventListener("pointercancel",tt),o.domElement.removeEventListener("wheel",Fe),o.domElement.removeEventListener("pointermove",Ue),o.domElement.removeEventListener("pointerup",At),o._domElementKeyEvents!==null&&o._domElementKeyEvents.removeEventListener("keydown",Re)};const o=this,l={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let a=l.NONE;const u=1e-6,h=new VE,f=new VE;let d=1;const m=new it;let g=!1;const x=new Rn,v=new Rn,A=new Rn,_=new Rn,E=new Rn,w=new Rn,S=new Rn,T=new Rn,R=new Rn,L=[],I={};function N(){return 2*Math.PI/60/60*o.autoRotateSpeed}function B(){return Math.pow(.95,o.zoomSpeed)}function H(ve){f.theta-=ve}function q(ve){f.phi-=ve}const le=function(){const ve=new it;return function(wt,Ot){ve.setFromMatrixColumn(Ot,0),ve.multiplyScalar(-wt),m.add(ve)}}(),ne=function(){const ve=new it;return function(wt,Ot){o.screenSpacePanning===!0?ve.setFromMatrixColumn(Ot,1):(ve.setFromMatrixColumn(Ot,0),ve.crossVectors(o.object.up,ve)),ve.multiplyScalar(wt),m.add(ve)}}(),D=function(){const ve=new it;return function(wt,Ot){const _t=o.domElement;if(o.object.isPerspectiveCamera){const Ut=o.object.position;ve.copy(Ut).sub(o.target);let It=ve.length();It*=Math.tan(o.object.fov/2*Math.PI/180),le(2*wt*It/_t.clientHeight,o.object.matrix),ne(2*Ot*It/_t.clientHeight,o.object.matrix)}else o.object.isOrthographicCamera?(le(wt*(o.object.right-o.object.left)/o.object.zoom/_t.clientWidth,o.object.matrix),ne(Ot*(o.object.top-o.object.bottom)/o.object.zoom/_t.clientHeight,o.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),o.enablePan=!1)}}();function O(ve){o.object.isPerspectiveCamera?d/=ve:o.object.isOrthographicCamera?(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom*ve)),o.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function k(ve){o.object.isPerspectiveCamera?d*=ve:o.object.isOrthographicCamera?(o.object.zoom=Math.max(o.minZoom,Math.min(o.maxZoom,o.object.zoom/ve)),o.object.updateProjectionMatrix(),g=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),o.enableZoom=!1)}function z(ve){x.set(ve.clientX,ve.clientY)}function X(ve){S.set(ve.clientX,ve.clientY)}function Z(ve){_.set(ve.clientX,ve.clientY)}function ie(ve){v.set(ve.clientX,ve.clientY),A.subVectors(v,x).multiplyScalar(o.rotateSpeed);const Le=o.domElement;H(2*Math.PI*A.x/Le.clientHeight),q(2*Math.PI*A.y/Le.clientHeight),x.copy(v),o.update()}function se(ve){T.set(ve.clientX,ve.clientY),R.subVectors(T,S),R.y>0?O(B()):R.y<0&&k(B()),S.copy(T),o.update()}function ue(ve){E.set(ve.clientX,ve.clientY),w.subVectors(E,_).multiplyScalar(o.panSpeed),D(w.x,w.y),_.copy(E),o.update()}function ye(ve){ve.deltaY<0?k(B()):ve.deltaY>0&&O(B()),o.update()}function Ce(ve){let Le=!1;switch(ve.code){case o.keys.UP:ve.ctrlKey||ve.metaKey||ve.shiftKey?q(2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):D(0,o.keyPanSpeed),Le=!0;break;case o.keys.BOTTOM:ve.ctrlKey||ve.metaKey||ve.shiftKey?q(-2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):D(0,-o.keyPanSpeed),Le=!0;break;case o.keys.LEFT:ve.ctrlKey||ve.metaKey||ve.shiftKey?H(2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):D(o.keyPanSpeed,0),Le=!0;break;case o.keys.RIGHT:ve.ctrlKey||ve.metaKey||ve.shiftKey?H(-2*Math.PI*o.rotateSpeed/o.domElement.clientHeight):D(-o.keyPanSpeed,0),Le=!0;break}Le&&(ve.preventDefault(),o.update())}function ke(){if(L.length===1)x.set(L[0].pageX,L[0].pageY);else{const ve=.5*(L[0].pageX+L[1].pageX),Le=.5*(L[0].pageY+L[1].pageY);x.set(ve,Le)}}function Oe(){if(L.length===1)_.set(L[0].pageX,L[0].pageY);else{const ve=.5*(L[0].pageX+L[1].pageX),Le=.5*(L[0].pageY+L[1].pageY);_.set(ve,Le)}}function Ne(){const ve=L[0].pageX-L[1].pageX,Le=L[0].pageY-L[1].pageY,wt=Math.sqrt(ve*ve+Le*Le);S.set(0,wt)}function He(){o.enableZoom&&Ne(),o.enablePan&&Oe()}function Qe(){o.enableZoom&&Ne(),o.enableRotate&&ke()}function St(ve){if(L.length==1)v.set(ve.pageX,ve.pageY);else{const wt=Pe(ve),Ot=.5*(ve.pageX+wt.x),_t=.5*(ve.pageY+wt.y);v.set(Ot,_t)}A.subVectors(v,x).multiplyScalar(o.rotateSpeed);const Le=o.domElement;H(2*Math.PI*A.x/Le.clientHeight),q(2*Math.PI*A.y/Le.clientHeight),x.copy(v)}function bt(ve){if(L.length===1)E.set(ve.pageX,ve.pageY);else{const Le=Pe(ve),wt=.5*(ve.pageX+Le.x),Ot=.5*(ve.pageY+Le.y);E.set(wt,Ot)}w.subVectors(E,_).multiplyScalar(o.panSpeed),D(w.x,w.y),_.copy(E)}function Jt(ve){const Le=Pe(ve),wt=ve.pageX-Le.x,Ot=ve.pageY-Le.y,_t=Math.sqrt(wt*wt+Ot*Ot);T.set(0,_t),R.set(0,Math.pow(T.y/S.y,o.zoomSpeed)),O(R.y),S.copy(T)}function sn(ve){o.enableZoom&&Jt(ve),o.enablePan&&bt(ve)}function Se(ve){o.enableZoom&&Jt(ve),o.enableRotate&&St(ve)}function qe(ve){o.enabled!==!1&&(L.length===0&&(o.domElement.setPointerCapture(ve.pointerId),o.domElement.addEventListener("pointermove",Ue),o.domElement.addEventListener("pointerup",At)),G(ve),ve.pointerType==="touch"?ce(ve):pe(ve))}function Ue(ve){o.enabled!==!1&&(ve.pointerType==="touch"?ae(ve):ge(ve))}function At(ve){$(ve),L.length===0&&(o.domElement.releasePointerCapture(ve.pointerId),o.domElement.removeEventListener("pointermove",Ue),o.domElement.removeEventListener("pointerup",At)),o.dispatchEvent(HR),a=l.NONE}function tt(ve){$(ve)}function pe(ve){let Le;switch(ve.button){case 0:Le=o.mouseButtons.LEFT;break;case 1:Le=o.mouseButtons.MIDDLE;break;case 2:Le=o.mouseButtons.RIGHT;break;default:Le=-1}switch(Le){case Aa.DOLLY:if(o.enableZoom===!1)return;X(ve),a=l.DOLLY;break;case Aa.ROTATE:if(ve.ctrlKey||ve.metaKey||ve.shiftKey){if(o.enablePan===!1)return;Z(ve),a=l.PAN}else{if(o.enableRotate===!1)return;z(ve),a=l.ROTATE}break;case Aa.PAN:if(ve.ctrlKey||ve.metaKey||ve.shiftKey){if(o.enableRotate===!1)return;z(ve),a=l.ROTATE}else{if(o.enablePan===!1)return;Z(ve),a=l.PAN}break;default:a=l.NONE}a!==l.NONE&&o.dispatchEvent(v1)}function ge(ve){switch(a){case l.ROTATE:if(o.enableRotate===!1)return;ie(ve);break;case l.DOLLY:if(o.enableZoom===!1)return;se(ve);break;case l.PAN:if(o.enablePan===!1)return;ue(ve);break}}function Fe(ve){o.enabled===!1||o.enableZoom===!1||a!==l.NONE||(ve.preventDefault(),o.dispatchEvent(v1),ye(ve),o.dispatchEvent(HR))}function Re(ve){o.enabled===!1||o.enablePan===!1||Ce(ve)}function ce(ve){switch(me(ve),L.length){case 1:switch(o.touches.ONE){case Gh.ROTATE:if(o.enableRotate===!1)return;ke(),a=l.TOUCH_ROTATE;break;case Gh.PAN:if(o.enablePan===!1)return;Oe(),a=l.TOUCH_PAN;break;default:a=l.NONE}break;case 2:switch(o.touches.TWO){case Gh.DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;He(),a=l.TOUCH_DOLLY_PAN;break;case Gh.DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;Qe(),a=l.TOUCH_DOLLY_ROTATE;break;default:a=l.NONE}break;default:a=l.NONE}a!==l.NONE&&o.dispatchEvent(v1)}function ae(ve){switch(me(ve),a){case l.TOUCH_ROTATE:if(o.enableRotate===!1)return;St(ve),o.update();break;case l.TOUCH_PAN:if(o.enablePan===!1)return;bt(ve),o.update();break;case l.TOUCH_DOLLY_PAN:if(o.enableZoom===!1&&o.enablePan===!1)return;sn(ve),o.update();break;case l.TOUCH_DOLLY_ROTATE:if(o.enableZoom===!1&&o.enableRotate===!1)return;Se(ve),o.update();break;default:a=l.NONE}}function J(ve){o.enabled!==!1&&ve.preventDefault()}function G(ve){L.push(ve)}function $(ve){delete I[ve.pointerId];for(let Le=0;Le<L.length;Le++)if(L[Le].pointerId==ve.pointerId){L.splice(Le,1);return}}function me(ve){let Le=I[ve.pointerId];Le===void 0&&(Le=new Rn,I[ve.pointerId]=Le),Le.set(ve.pageX,ve.pageY)}function Pe(ve){const Le=ve.pointerId===L[0].pointerId?L[1]:L[0];return I[Le.pointerId]}o.domElement.addEventListener("contextmenu",J),o.domElement.addEventListener("pointerdown",qe),o.domElement.addEventListener("pointercancel",tt),o.domElement.addEventListener("wheel",Fe,{passive:!1}),this.update()}}const TK={type:"change"};class CK extends ra{constructor(n,i){super(),this.object=n,this.domElement=i,this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1;const o=this,l=1e-6,a=new ia,u=new it;this.tmpQuaternion=new ia,this.status=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new it(0,0,0),this.rotationVector=new it(0,0,0),this.keydown=function(x){if(!x.altKey){switch(x.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=.1;break;case"KeyW":this.moveState.forward=1;break;case"KeyS":this.moveState.back=1;break;case"KeyA":this.moveState.left=1;break;case"KeyD":this.moveState.right=1;break;case"KeyR":this.moveState.up=1;break;case"KeyF":this.moveState.down=1;break;case"ArrowUp":this.moveState.pitchUp=1;break;case"ArrowDown":this.moveState.pitchDown=1;break;case"ArrowLeft":this.moveState.yawLeft=1;break;case"ArrowRight":this.moveState.yawRight=1;break;case"KeyQ":this.moveState.rollLeft=1;break;case"KeyE":this.moveState.rollRight=1;break}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(x){switch(x.code){case"ShiftLeft":case"ShiftRight":this.movementSpeedMultiplier=1;break;case"KeyW":this.moveState.forward=0;break;case"KeyS":this.moveState.back=0;break;case"KeyA":this.moveState.left=0;break;case"KeyD":this.moveState.right=0;break;case"KeyR":this.moveState.up=0;break;case"KeyF":this.moveState.down=0;break;case"ArrowUp":this.moveState.pitchUp=0;break;case"ArrowDown":this.moveState.pitchDown=0;break;case"ArrowLeft":this.moveState.yawLeft=0;break;case"ArrowRight":this.moveState.yawRight=0;break;case"KeyQ":this.moveState.rollLeft=0;break;case"KeyE":this.moveState.rollRight=0;break}this.updateMovementVector(),this.updateRotationVector()},this.pointerdown=function(x){if(this.dragToLook)this.status++;else{switch(x.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1;break}this.updateMovementVector()}},this.pointermove=function(x){if(!this.dragToLook||this.status>0){const v=this.getContainerDimensions(),A=v.size[0]/2,_=v.size[1]/2;this.moveState.yawLeft=-(x.pageX-v.offset[0]-A)/A,this.moveState.pitchDown=(x.pageY-v.offset[1]-_)/_,this.updateRotationVector()}},this.pointerup=function(x){if(this.dragToLook)this.status--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(x.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0;break}this.updateMovementVector()}this.updateRotationVector()},this.update=function(x){const v=x*o.movementSpeed,A=x*o.rollSpeed;o.object.translateX(o.moveVector.x*v),o.object.translateY(o.moveVector.y*v),o.object.translateZ(o.moveVector.z*v),o.tmpQuaternion.set(o.rotationVector.x*A,o.rotationVector.y*A,o.rotationVector.z*A,1).normalize(),o.object.quaternion.multiply(o.tmpQuaternion),(u.distanceToSquared(o.object.position)>l||8*(1-a.dot(o.object.quaternion))>l)&&(o.dispatchEvent(TK),a.copy(o.object.quaternion),u.copy(o.object.position))},this.updateMovementVector=function(){const x=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-x+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",GR),this.domElement.removeEventListener("pointerdown",f),this.domElement.removeEventListener("pointermove",h),this.domElement.removeEventListener("pointerup",d),window.removeEventListener("keydown",m),window.removeEventListener("keyup",g)};const h=this.pointermove.bind(this),f=this.pointerdown.bind(this),d=this.pointerup.bind(this),m=this.keydown.bind(this),g=this.keyup.bind(this);this.domElement.addEventListener("contextmenu",GR),this.domElement.addEventListener("pointerdown",f),this.domElement.addEventListener("pointermove",h),this.domElement.addEventListener("pointerup",d),window.addEventListener("keydown",m),window.addEventListener("keyup",g),this.updateMovementVector(),this.updateRotationVector()}}function GR(r){r.preventDefault()}const RK={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`

		varying vec2 vUv;

		void main() {

			vUv = uv;
			gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );

		}`,fragmentShader:`

		uniform float opacity;

		uniform sampler2D tDiffuse;

		varying vec2 vUv;

		void main() {

			gl_FragColor = texture2D( tDiffuse, vUv );
			gl_FragColor.a *= opacity;


		}`};class Qy{constructor(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const LK=new Cw(-1,1,1,-1,0,1),Qw=new ho;Qw.setAttribute("position",new $r([-1,3,0,-1,-1,0,3,-1,0],3));Qw.setAttribute("uv",new $r([0,2,0,0,2,0],2));class PK{constructor(n){this._mesh=new Zo(Qw,n)}dispose(){this._mesh.geometry.dispose()}render(n){n.render(this._mesh,LK)}get material(){return this._mesh.material}set material(n){this._mesh.material=n}}class DK extends Qy{constructor(n,i){super(),this.textureID=i!==void 0?i:"tDiffuse",n instanceof Ml?(this.uniforms=n.uniforms,this.material=n):n&&(this.uniforms=pO.clone(n.uniforms),this.material=new Ml({defines:Object.assign({},n.defines),uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader})),this.fsQuad=new PK(this.material)}render(n,i,o){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=o.texture),this.fsQuad.material=this.material,this.renderToScreen?(n.setRenderTarget(null),this.fsQuad.render(n)):(n.setRenderTarget(i),this.clear&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),this.fsQuad.render(n))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class VR extends Qy{constructor(n,i){super(),this.scene=n,this.camera=i,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(n,i,o){const l=n.getContext(),a=n.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0);let u,h;this.inverse?(u=0,h=1):(u=1,h=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(l.REPLACE,l.REPLACE,l.REPLACE),a.buffers.stencil.setFunc(l.ALWAYS,u,4294967295),a.buffers.stencil.setClear(h),a.buffers.stencil.setLocked(!0),n.setRenderTarget(o),this.clear&&n.clear(),n.render(this.scene,this.camera),n.setRenderTarget(i),this.clear&&n.clear(),n.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(l.EQUAL,1,4294967295),a.buffers.stencil.setOp(l.KEEP,l.KEEP,l.KEEP),a.buffers.stencil.setLocked(!0)}}class OK extends Qy{constructor(){super(),this.needsSwap=!1}render(n){n.state.buffers.stencil.setLocked(!1),n.state.buffers.stencil.setTest(!1)}}class IK{constructor(n,i){if(this.renderer=n,i===void 0){const o=n.getSize(new Rn);this._pixelRatio=n.getPixelRatio(),this._width=o.width,this._height=o.height,i=new Tc(this._width*this._pixelRatio,this._height*this._pixelRatio),i.texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=i.width,this._height=i.height;this.renderTarget1=i,this.renderTarget2=i.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new DK(RK),this.clock=new CO}swapBuffers(){const n=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=n}addPass(n){this.passes.push(n),n.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(n,i){this.passes.splice(i,0,n),n.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(n){const i=this.passes.indexOf(n);i!==-1&&this.passes.splice(i,1)}isLastEnabledPass(n){for(let i=n+1;i<this.passes.length;i++)if(this.passes[i].enabled)return!1;return!0}render(n){n===void 0&&(n=this.clock.getDelta());const i=this.renderer.getRenderTarget();let o=!1;for(let l=0,a=this.passes.length;l<a;l++){const u=this.passes[l];if(u.enabled!==!1){if(u.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(l),u.render(this.renderer,this.writeBuffer,this.readBuffer,n,o),u.needsSwap){if(o){const h=this.renderer.getContext(),f=this.renderer.state.buffers.stencil;f.setFunc(h.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,n),f.setFunc(h.EQUAL,1,4294967295)}this.swapBuffers()}VR!==void 0&&(u instanceof VR?o=!0:u instanceof OK&&(o=!1))}}this.renderer.setRenderTarget(i)}reset(n){if(n===void 0){const i=this.renderer.getSize(new Rn);this._pixelRatio=this.renderer.getPixelRatio(),this._width=i.width,this._height=i.height,n=this.renderTarget1.clone(),n.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=n,this.renderTarget2=n.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(n,i){this._width=n,this._height=i;const o=this._width*this._pixelRatio,l=this._height*this._pixelRatio;this.renderTarget1.setSize(o,l),this.renderTarget2.setSize(o,l);for(let a=0;a<this.passes.length;a++)this.passes[a].setSize(o,l)}setPixelRatio(n){this._pixelRatio=n,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class kK extends Qy{constructor(n,i,o,l,a){super(),this.scene=n,this.camera=i,this.overrideMaterial=o,this.clearColor=l,this.clearAlpha=a!==void 0?a:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Ji}render(n,i,o){const l=n.autoClear;n.autoClear=!1;let a,u;this.overrideMaterial!==void 0&&(u=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(n.getClearColor(this._oldClearColor),a=n.getClearAlpha(),n.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&n.clearDepth(),n.setRenderTarget(this.renderToScreen?null:o),this.clear&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),n.render(this.scene,this.camera),this.clearColor&&n.setClearColor(this._oldClearColor,a),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=u),n.autoClear=l}}var qp={Linear:{None:function(r){return r}},Quadratic:{In:function(r){return r*r},Out:function(r){return r*(2-r)},InOut:function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)}},Cubic:{In:function(r){return r*r*r},Out:function(r){return--r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)}},Quartic:{In:function(r){return r*r*r*r},Out:function(r){return 1- --r*r*r*r},InOut:function(r){return(r*=2)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2)}},Quintic:{In:function(r){return r*r*r*r*r},Out:function(r){return--r*r*r*r*r+1},InOut:function(r){return(r*=2)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2)}},Sinusoidal:{In:function(r){return 1-Math.cos(r*Math.PI/2)},Out:function(r){return Math.sin(r*Math.PI/2)},InOut:function(r){return .5*(1-Math.cos(Math.PI*r))}},Exponential:{In:function(r){return r===0?0:Math.pow(1024,r-1)},Out:function(r){return r===1?1:1-Math.pow(2,-10*r)},InOut:function(r){return r===0?0:r===1?1:(r*=2)<1?.5*Math.pow(1024,r-1):.5*(-Math.pow(2,-10*(r-1))+2)}},Circular:{In:function(r){return 1-Math.sqrt(1-r*r)},Out:function(r){return Math.sqrt(1- --r*r)},InOut:function(r){return(r*=2)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1)}},Elastic:{In:function(r){return r===0?0:r===1?1:-Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI)},Out:function(r){return r===0?0:r===1?1:Math.pow(2,-10*r)*Math.sin((r-.1)*5*Math.PI)+1},InOut:function(r){return r===0?0:r===1?1:(r*=2,r<1?-.5*Math.pow(2,10*(r-1))*Math.sin((r-1.1)*5*Math.PI):.5*Math.pow(2,-10*(r-1))*Math.sin((r-1.1)*5*Math.PI)+1)}},Back:{In:function(r){var n=1.70158;return r*r*((n+1)*r-n)},Out:function(r){var n=1.70158;return--r*r*((n+1)*r+n)+1},InOut:function(r){var n=2.5949095;return(r*=2)<1?.5*(r*r*((n+1)*r-n)):.5*((r-=2)*r*((n+1)*r+n)+2)}},Bounce:{In:function(r){return 1-qp.Bounce.Out(1-r)},Out:function(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},InOut:function(r){return r<.5?qp.Bounce.In(r*2)*.5:qp.Bounce.Out(r*2-1)*.5+.5}}},Np;typeof self>"u"&&typeof process<"u"&&process.hrtime?Np=function(){var r=process.hrtime();return r[0]*1e3+r[1]/1e6}:typeof self<"u"&&self.performance!==void 0&&self.performance.now!==void 0?Np=self.performance.now.bind(self.performance):Date.now!==void 0?Np=Date.now:Np=function(){return new Date().getTime()};var xu=Np,TI=function(){function r(){this._tweens={},this._tweensAddedDuringUpdate={}}return r.prototype.getAll=function(){var n=this;return Object.keys(this._tweens).map(function(i){return n._tweens[i]})},r.prototype.removeAll=function(){this._tweens={}},r.prototype.add=function(n){this._tweens[n.getId()]=n,this._tweensAddedDuringUpdate[n.getId()]=n},r.prototype.remove=function(n){delete this._tweens[n.getId()],delete this._tweensAddedDuringUpdate[n.getId()]},r.prototype.update=function(n,i){n===void 0&&(n=xu()),i===void 0&&(i=!1);var o=Object.keys(this._tweens);if(o.length===0)return!1;for(;o.length>0;){this._tweensAddedDuringUpdate={};for(var l=0;l<o.length;l++){var a=this._tweens[o[l]],u=!i;a&&a.update(n,u)===!1&&!i&&delete this._tweens[o[l]]}o=Object.keys(this._tweensAddedDuringUpdate)}return!0},r}(),Cd={Linear:function(r,n){var i=r.length-1,o=i*n,l=Math.floor(o),a=Cd.Utils.Linear;return n<0?a(r[0],r[1],o):n>1?a(r[i],r[i-1],i-o):a(r[l],r[l+1>i?i:l+1],o-l)},Bezier:function(r,n){for(var i=0,o=r.length-1,l=Math.pow,a=Cd.Utils.Bernstein,u=0;u<=o;u++)i+=l(1-n,o-u)*l(n,u)*r[u]*a(o,u);return i},CatmullRom:function(r,n){var i=r.length-1,o=i*n,l=Math.floor(o),a=Cd.Utils.CatmullRom;return r[0]===r[i]?(n<0&&(l=Math.floor(o=i*(1+n))),a(r[(l-1+i)%i],r[l],r[(l+1)%i],r[(l+2)%i],o-l)):n<0?r[0]-(a(r[0],r[0],r[1],r[1],-o)-r[0]):n>1?r[i]-(a(r[i],r[i],r[i-1],r[i-1],o-i)-r[i]):a(r[l?l-1:0],r[l],r[i<l+1?i:l+1],r[i<l+2?i:l+2],o-l)},Utils:{Linear:function(r,n,i){return(n-r)*i+r},Bernstein:function(r,n){var i=Cd.Utils.Factorial;return i(r)/i(n)/i(r-n)},Factorial:function(){var r=[1];return function(n){var i=1;if(r[n])return r[n];for(var o=n;o>1;o--)i*=o;return r[n]=i,i}}(),CatmullRom:function(r,n,i,o,l){var a=(i-r)*.5,u=(o-n)*.5,h=l*l,f=l*h;return(2*n-2*i+a+u)*f+(-3*n+3*i-2*a-u)*h+a*l+n}}},Zw=function(){function r(){}return r.nextId=function(){return r._nextId++},r._nextId=0,r}(),CI=new TI,NK=function(){function r(n,i){i===void 0&&(i=CI),this._object=n,this._group=i,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=qp.Linear.None,this._interpolationFunction=Cd.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=Zw.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return r.prototype.getId=function(){return this._id},r.prototype.isPlaying=function(){return this._isPlaying},r.prototype.isPaused=function(){return this._isPaused},r.prototype.to=function(n,i){return this._valuesEnd=Object.create(n),i!==void 0&&(this._duration=i),this},r.prototype.duration=function(n){return this._duration=n,this},r.prototype.start=function(n){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var i in this._valuesStartRepeat)this._swapEndStartRepeatValues(i),this._valuesStart[i]=this._valuesStartRepeat[i]}return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=n!==void 0?typeof n=="string"?xu()+parseFloat(n):n:xu(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},r.prototype._setupProperties=function(n,i,o,l){for(var a in o){var u=n[a],h=Array.isArray(u),f=h?"array":typeof u,d=!h&&Array.isArray(o[a]);if(!(f==="undefined"||f==="function")){if(d){var m=o[a];if(m.length===0)continue;m=m.map(this._handleRelativeValue.bind(this,u)),o[a]=[u].concat(m)}if((f==="object"||h)&&u&&!d){i[a]=h?[]:{};for(var g in u)i[a][g]=u[g];l[a]=h?[]:{},this._setupProperties(u,i[a],o[a],l[a])}else typeof i[a]>"u"&&(i[a]=u),h||(i[a]*=1),d?l[a]=o[a].slice().reverse():l[a]=i[a]||0}}},r.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},r.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},r.prototype.pause=function(n){return n===void 0&&(n=xu()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=n,this._group&&this._group.remove(this),this)},r.prototype.resume=function(n){return n===void 0&&(n=xu()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=n-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},r.prototype.stopChainedTweens=function(){for(var n=0,i=this._chainedTweens.length;n<i;n++)this._chainedTweens[n].stop();return this},r.prototype.group=function(n){return this._group=n,this},r.prototype.delay=function(n){return this._delayTime=n,this},r.prototype.repeat=function(n){return this._initialRepeat=n,this._repeat=n,this},r.prototype.repeatDelay=function(n){return this._repeatDelayTime=n,this},r.prototype.yoyo=function(n){return this._yoyo=n,this},r.prototype.easing=function(n){return this._easingFunction=n,this},r.prototype.interpolation=function(n){return this._interpolationFunction=n,this},r.prototype.chain=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return this._chainedTweens=n,this},r.prototype.onStart=function(n){return this._onStartCallback=n,this},r.prototype.onUpdate=function(n){return this._onUpdateCallback=n,this},r.prototype.onRepeat=function(n){return this._onRepeatCallback=n,this},r.prototype.onComplete=function(n){return this._onCompleteCallback=n,this},r.prototype.onStop=function(n){return this._onStopCallback=n,this},r.prototype.update=function(n,i){if(n===void 0&&(n=xu()),i===void 0&&(i=!0),this._isPaused)return!0;var o,l,a=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(n>a)return!1;i&&this.start(n)}if(this._goToEnd=!1,n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),l=(n-this._startTime)/this._duration,l=this._duration===0||l>1?1:l;var u=this._easingFunction(l);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,u),this._onUpdateCallback&&this._onUpdateCallback(this._object,l),l===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=n+this._repeatDelayTime:this._startTime=n+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var h=0,f=this._chainedTweens.length;h<f;h++)this._chainedTweens[h].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},r.prototype._updateProperties=function(n,i,o,l){for(var a in o)if(i[a]!==void 0){var u=i[a]||0,h=o[a],f=Array.isArray(n[a]),d=Array.isArray(h),m=!f&&d;m?n[a]=this._interpolationFunction(h,l):typeof h=="object"&&h?this._updateProperties(n[a],u,h,l):(h=this._handleRelativeValue(u,h),typeof h=="number"&&(n[a]=u+(h-u)*l))}},r.prototype._handleRelativeValue=function(n,i){return typeof i!="string"?i:i.charAt(0)==="+"||i.charAt(0)==="-"?n+parseFloat(i):parseFloat(i)},r.prototype._swapEndStartRepeatValues=function(n){var i=this._valuesStartRepeat[n],o=this._valuesEnd[n];typeof o=="string"?this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(o):this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=i},r}(),FK="18.6.4",BK=Zw.nextId,Pa=CI,UK=Pa.getAll.bind(Pa),zK=Pa.removeAll.bind(Pa),HK=Pa.add.bind(Pa),GK=Pa.remove.bind(Pa),VK=Pa.update.bind(Pa),Eo={Easing:qp,Group:TI,Interpolation:Cd,now:xu,Sequence:Zw,nextId:BK,Tween:NK,VERSION:FK,getAll:UK,removeAll:zK,add:HK,remove:GK,update:VK};function WK(r,n){n===void 0&&(n={});var i=n.insertAt;if(!(!r||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",i==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=r:l.appendChild(document.createTextNode(r))}}var jK=`.scene-nav-info {
  bottom: 5px;
  width: 100%;
  text-align: center;
  color: slategrey;
  opacity: 0.7;
  font-size: 10px;
}

.scene-tooltip {
  top: 0;
  color: lavender;
  font-size: 15px;
}

.scene-nav-info, .scene-tooltip {
  position: absolute;
  font-family: sans-serif;
  pointer-events: none;
}

.scene-container canvas:focus {
  outline: none;
}`;WK(jK);function $K(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function XK(r,n){return YK(r)||QK(r,n)||RI(r,n)||JK()}function yp(r){return qK(r)||KK(r)||RI(r)||ZK()}function qK(r){if(Array.isArray(r))return lA(r)}function YK(r){if(Array.isArray(r))return r}function KK(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function QK(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function RI(r,n){if(!!r){if(typeof r=="string")return lA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return lA(r,n)}}function lA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function ZK(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function JK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var xr=window.THREE?window.THREE:{WebGLRenderer:EO,Scene:jj,PerspectiveCamera:_o,Raycaster:RO,TextureLoader:d$,Vector2:Rn,Vector3:it,Box3:qu,Color:Ji,Mesh:Zo,SphereGeometry:qy,MeshBasicMaterial:Mw,BackSide:ro,EventDispatcher:ra,MOUSE:Aa,Quaternion:ia,Spherical:VE,Clock:CO},LI=Yu({props:{width:{default:window.innerWidth,onChange:function(n,i,o){isNaN(n)&&(i.width=o)}},height:{default:window.innerHeight,onChange:function(n,i,o){isNaN(n)&&(i.height=o)}},backgroundColor:{default:"#000011"},backgroundImageUrl:{},onBackgroundImageLoaded:{},showNavInfo:{default:!0},skyRadius:{default:5e4},objects:{default:[]},enablePointerInteraction:{default:!0,onChange:function(n,i){i.hoverObj=null,i.toolTipElem&&(i.toolTipElem.innerHTML="")},triggerUpdate:!1},lineHoverPrecision:{default:1,triggerUpdate:!1},hoverOrderComparator:{default:function(){return-1},triggerUpdate:!1},hoverFilter:{default:function(){return!0},triggerUpdate:!1},tooltipContent:{triggerUpdate:!1},hoverDuringDrag:{default:!1,triggerUpdate:!1},clickAfterDrag:{default:!1,triggerUpdate:!1},onHover:{default:function(){},triggerUpdate:!1},onClick:{default:function(){},triggerUpdate:!1},onRightClick:{triggerUpdate:!1}},methods:{tick:function(n){if(n.initialised){if(n.controls.update&&n.controls.update(n.clock.getDelta()),n.postProcessingComposer?n.postProcessingComposer.render():n.renderer.render(n.scene,n.camera),n.extraRenderers.forEach(function(a){return a.render(n.scene,n.camera)}),n.enablePointerInteraction){var i=null;if(n.hoverDuringDrag||!n.isPointerDragging){var o=this.intersectingObjects(n.pointerPos.x,n.pointerPos.y).filter(function(a){return n.hoverFilter(a.object)}).sort(function(a,u){return n.hoverOrderComparator(a.object,u.object)}),l=o.length?o[0]:null;i=l?l.object:null,n.intersectionPoint=l?l.point:null}i!==n.hoverObj&&(n.onHover(i,n.hoverObj),n.toolTipElem.innerHTML=i&&Wn(n.tooltipContent)(i)||"",n.hoverObj=i)}Eo.update()}return this},getPointerPos:function(n){var i=n.pointerPos,o=i.x,l=i.y;return{x:o,y:l}},cameraPosition:function(n,i,o,l){var a=n.camera;if(i&&n.initialised){var u=i,h=o||{x:0,y:0,z:0};if(!l)m(u),g(h);else{var f=Object.assign({},a.position),d=x();new Eo.Tween(f).to(u,l).easing(Eo.Easing.Quadratic.Out).onUpdate(m).start(),new Eo.Tween(d).to(h,l/3).easing(Eo.Easing.Quadratic.Out).onUpdate(g).start()}return this}return Object.assign({},a.position,{lookAt:x()});function m(v){var A=v.x,_=v.y,E=v.z;A!==void 0&&(a.position.x=A),_!==void 0&&(a.position.y=_),E!==void 0&&(a.position.z=E)}function g(v){var A=new xr.Vector3(v.x,v.y,v.z);n.controls.target?n.controls.target=A:a.lookAt(A)}function x(){return Object.assign(new xr.Vector3(0,0,-1e3).applyQuaternion(a.quaternion).add(a.position))}},zoomToFit:function(n){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];return this.fitToBbox(this.getBbox.apply(this,a),i,o)},fitToBbox:function(n,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:10,a=n.camera;if(i){var u=new xr.Vector3(0,0,0),h=Math.max.apply(Math,yp(Object.entries(i).map(function(v){var A=XK(v,2),_=A[0],E=A[1];return Math.max.apply(Math,yp(E.map(function(w){return Math.abs(u[_]-w)})))})))*2,f=(1-l*2/n.height)*a.fov,d=h/Math.atan(f*Math.PI/180),m=d/a.aspect,g=Math.max(d,m);if(g>0){var x=u.clone().sub(a.position).normalize().multiplyScalar(-g);this.cameraPosition(x,u,o)}}return this},getBbox:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},o=new xr.Box3(new xr.Vector3(0,0,0),new xr.Vector3(0,0,0)),l=n.objects.filter(i);return l.length?(l.forEach(function(a){return o.expandByObject(a)}),Object.assign.apply(Object,yp(["x","y","z"].map(function(a){return $K({},a,[o.min[a],o.max[a]])})))):null},getScreenCoords:function(n,i,o,l){var a=new xr.Vector3(i,o,l);return a.project(this.camera()),{x:(a.x+1)*n.width/2,y:-(a.y-1)*n.height/2}},getSceneCoords:function(n,i,o){var l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,a=new xr.Vector2(i/n.width*2-1,-(o/n.height)*2+1),u=new xr.Raycaster;return u.setFromCamera(a,n.camera),Object.assign({},u.ray.at(l,new xr.Vector3))},intersectingObjects:function(n,i,o){var l=new xr.Vector2(i/n.width*2-1,-(o/n.height)*2+1),a=new xr.Raycaster;return a.params.Line.threshold=n.lineHoverPrecision,a.setFromCamera(l,n.camera),a.intersectObjects(n.objects,!0)},renderer:function(n){return n.renderer},scene:function(n){return n.scene},camera:function(n){return n.camera},postProcessingComposer:function(n){return n.postProcessingComposer},controls:function(n){return n.controls},tbControls:function(n){return n.controls}},stateInit:function(){return{scene:new xr.Scene,camera:new xr.PerspectiveCamera,clock:new xr.Clock}},init:function(n,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},l=o.controlType,a=l===void 0?"trackball":l,u=o.rendererConfig,h=u===void 0?{}:u,f=o.extraRenderers,d=f===void 0?[]:f,m=o.waitForLoadComplete,g=m===void 0?!0:m;n.innerHTML="",n.appendChild(i.container=document.createElement("div")),i.container.className="scene-container",i.container.style.position="relative",i.container.appendChild(i.navInfo=document.createElement("div")),i.navInfo.className="scene-nav-info",i.navInfo.textContent={orbit:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",trackball:"Left-click: rotate, Mouse-wheel/middle-click: zoom, Right-click: pan",fly:"WASD: move, R|F: up | down, Q|E: roll, up|down: pitch, left|right: yaw"}[a]||"",i.navInfo.style.display=i.showNavInfo?null:"none",i.toolTipElem=document.createElement("div"),i.toolTipElem.classList.add("scene-tooltip"),i.container.appendChild(i.toolTipElem),i.pointerPos=new xr.Vector2,i.pointerPos.x=-2,i.pointerPos.y=-2,["pointermove","pointerdown"].forEach(function(x){return i.container.addEventListener(x,function(v){if(x==="pointerdown"&&(i.isPointerPressed=!0),!i.isPointerDragging&&v.type==="pointermove"&&(v.pressure>0||i.isPointerPressed)&&(v.pointerType!=="touch"||v.movementX===void 0||[v.movementX,v.movementY].some(function(E){return Math.abs(E)>1}))&&(i.isPointerDragging=!0),i.enablePointerInteraction){var A=_(i.container);i.pointerPos.x=v.pageX-A.left,i.pointerPos.y=v.pageY-A.top,i.toolTipElem.style.top="".concat(i.pointerPos.y,"px"),i.toolTipElem.style.left="".concat(i.pointerPos.x,"px"),i.toolTipElem.style.transform="translate(-".concat(i.pointerPos.x/i.width*100,"%, ").concat(i.height-i.pointerPos.y<100?"calc(-100% - 8px)":"21px",")")}function _(E){var w=E.getBoundingClientRect(),S=window.pageXOffset||document.documentElement.scrollLeft,T=window.pageYOffset||document.documentElement.scrollTop;return{top:w.top+T,left:w.left+S}}},{passive:!0})}),i.container.addEventListener("pointerup",function(x){i.isPointerPressed=!1,!(i.isPointerDragging&&(i.isPointerDragging=!1,!i.clickAfterDrag))&&requestAnimationFrame(function(){x.button===0&&i.onClick(i.hoverObj||null,x,i.intersectionPoint),x.button===2&&i.onRightClick&&i.onRightClick(i.hoverObj||null,x,i.intersectionPoint)})},{passive:!0,capture:!0}),i.container.addEventListener("contextmenu",function(x){i.onRightClick&&x.preventDefault()}),i.renderer=new xr.WebGLRenderer(Object.assign({antialias:!0,alpha:!0},h)),i.renderer.setPixelRatio(Math.min(2,window.devicePixelRatio)),i.container.appendChild(i.renderer.domElement),i.extraRenderers=d,i.extraRenderers.forEach(function(x){x.domElement.style.position="absolute",x.domElement.style.top="0px",x.domElement.style.pointerEvents="none",i.container.appendChild(x.domElement)}),i.postProcessingComposer=new IK(i.renderer),i.postProcessingComposer.addPass(new kK(i.scene,i.camera)),i.controls=new{trackball:MK,orbit:SK,fly:CK}[a](i.camera,i.renderer.domElement),a==="fly"&&(i.controls.movementSpeed=300,i.controls.rollSpeed=Math.PI/6,i.controls.dragToLook=!0),(a==="trackball"||a==="orbit")&&(i.controls.minDistance=.1,i.controls.maxDistance=i.skyRadius,i.controls.addEventListener("start",function(){i.controlsEngaged=!0}),i.controls.addEventListener("change",function(){i.controlsEngaged&&(i.controlsDragging=!0)}),i.controls.addEventListener("end",function(){i.controlsEngaged=!1,i.controlsDragging=!1})),[i.renderer,i.postProcessingComposer].concat(yp(i.extraRenderers)).forEach(function(x){return x.setSize(i.width,i.height)}),i.camera.aspect=i.width/i.height,i.camera.updateProjectionMatrix(),i.camera.position.z=1e3,i.scene.add(i.skysphere=new xr.Mesh),i.skysphere.visible=!1,i.loadComplete=i.scene.visible=!g,window.scene=i.scene},update:function(n,i){if(n.width&&n.height&&(i.hasOwnProperty("width")||i.hasOwnProperty("height"))&&(n.container.style.width="".concat(n.width,"px"),n.container.style.height="".concat(n.height,"px"),[n.renderer,n.postProcessingComposer].concat(yp(n.extraRenderers)).forEach(function(a){return a.setSize(n.width,n.height)}),n.camera.aspect=n.width/n.height,n.camera.updateProjectionMatrix()),i.hasOwnProperty("skyRadius")&&n.skyRadius&&(n.controls.hasOwnProperty("maxDistance")&&i.skyRadius&&(n.controls.maxDistance=Math.min(n.controls.maxDistance,n.skyRadius)),n.camera.far=n.skyRadius*2.5,n.camera.updateProjectionMatrix(),n.skysphere.geometry=new xr.SphereGeometry(n.skyRadius)),i.hasOwnProperty("backgroundColor")){var o=Ky(n.backgroundColor).alpha;o===void 0&&(o=1),n.renderer.setClearColor(new xr.Color(EI(1,n.backgroundColor)),o)}i.hasOwnProperty("backgroundImageUrl")&&(n.backgroundImageUrl?new xr.TextureLoader().load(n.backgroundImageUrl,function(a){n.skysphere.material=new xr.MeshBasicMaterial({map:a,side:xr.BackSide}),n.skysphere.visible=!0,n.onBackgroundImageLoaded&&setTimeout(n.onBackgroundImageLoaded),!n.loadComplete&&l()}):(n.skysphere.visible=!1,n.skysphere.material.map=null,!n.loadComplete&&l())),i.hasOwnProperty("showNavInfo")&&(n.navInfo.style.display=n.showNavInfo?null:"none"),i.hasOwnProperty("objects")&&((i.objects||[]).forEach(function(a){return n.scene.remove(a)}),n.objects.forEach(function(a){return n.scene.add(a)}));function l(){n.loadComplete=n.scene.visible=!0}}});function eQ(r,n){n===void 0&&(n={});var i=n.insertAt;if(!(!r||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",i==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=r:l.appendChild(document.createTextNode(r))}}var tQ=`.graph-info-msg {
  top: 50%;
  width: 100%;
  text-align: center;
  color: lavender;
  opacity: 0.7;
  font-size: 22px;
  position: absolute;
  font-family: Sans-serif;
}

.scene-container .clickable {
  cursor: pointer;
}

.scene-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.scene-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}`;eQ(tQ);function WR(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),i.push.apply(i,o)}return i}function a0(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?WR(Object(i),!0).forEach(function(o){zm(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):WR(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function zm(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function Zy(r){return nQ(r)||iQ(r)||rQ(r)||sQ()}function nQ(r){if(Array.isArray(r))return cA(r)}function iQ(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function rQ(r,n){if(!!r){if(typeof r=="string")return cA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return cA(r,n)}}function cA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function sQ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PI(r,n){var i=new n;return{linkProp:function(l){return{default:i[l](),onChange:function(u,h){h[r][l](u)},triggerUpdate:!1}},linkMethod:function(l){return function(a){for(var u=a[r],h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];var m=u[l].apply(u,f);return m===u?this:m}}}}var jR=window.THREE?window.THREE:{AmbientLight:g$,DirectionalLight:m$,Vector3:it},oQ=170,DI=PI("forceGraph",Kw),aQ=Object.assign.apply(Object,Zy(["jsonUrl","graphData","numDimensions","dagMode","dagLevelDistance","dagNodeFilter","onDagError","nodeRelSize","nodeId","nodeVal","nodeResolution","nodeColor","nodeAutoColorBy","nodeOpacity","nodeVisibility","nodeThreeObject","nodeThreeObjectExtend","linkSource","linkTarget","linkVisibility","linkColor","linkAutoColorBy","linkOpacity","linkWidth","linkResolution","linkCurvature","linkCurveRotation","linkMaterial","linkThreeObject","linkThreeObjectExtend","linkPositionUpdate","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalArrowResolution","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleResolution","forceEngine","d3AlphaDecay","d3VelocityDecay","d3AlphaMin","ngraphPhysics","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return zm({},r,DI.linkProp(r))}))),lQ=Object.assign.apply(Object,Zy(["refresh","getGraphBbox","d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return zm({},r,DI.linkMethod(r))}))),N0=PI("renderObjs",LI),cQ=Object.assign.apply(Object,Zy(["width","height","backgroundColor","showNavInfo","enablePointerInteraction"].map(function(r){return zm({},r,N0.linkProp(r))}))),uQ=Object.assign.apply(Object,Zy(["cameraPosition","postProcessingComposer"].map(function(r){return zm({},r,N0.linkMethod(r))})).concat([{graph2ScreenCoords:N0.linkMethod("getScreenCoords"),screen2GraphCoords:N0.linkMethod("getSceneCoords")}])),hQ=Yu({props:a0(a0({nodeLabel:{default:"name",triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:1,onChange:function(n,i){return i.renderObjs.lineHoverPrecision(n)},triggerUpdate:!1},enableNavigationControls:{default:!0,onChange:function(n,i){var o=i.renderObjs.controls();o&&(o.enabled=n)},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1}},aQ),cQ),methods:a0(a0({zoomToFit:function(n,i,o){for(var l,a=arguments.length,u=new Array(a>3?a-3:0),h=3;h<a;h++)u[h-3]=arguments[h];return n.renderObjs.fitToBbox((l=n.forceGraph).getGraphBbox.apply(l,u),i,o),this},pauseAnimation:function(n){return n.animationFrameRequestId!==null&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId===null&&this._animationCycle(),this},_animationCycle:function(n){n.enablePointerInteraction&&(this.renderer().domElement.style.cursor=null),n.forceGraph.tickFrame(),n.renderObjs.tick(),n.animationFrameRequestId=requestAnimationFrame(this._animationCycle)},scene:function(n){return n.renderObjs.scene()},camera:function(n){return n.renderObjs.camera()},renderer:function(n){return n.renderObjs.renderer()},controls:function(n){return n.renderObjs.controls()},tbControls:function(n){return n.renderObjs.tbControls()},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},lQ),uQ),stateInit:function(n){var i=n.controlType,o=n.rendererConfig,l=n.extraRenderers;return{forceGraph:new Kw,renderObjs:LI({controlType:i,rendererConfig:o,extraRenderers:l})}},init:function(n,i){n.innerHTML="",n.appendChild(i.container=document.createElement("div")),i.container.style.position="relative";var o=document.createElement("div");i.container.appendChild(o),i.renderObjs(o);var l=i.renderObjs.camera(),a=i.renderObjs.renderer(),u=i.renderObjs.controls();u.enabled=!!i.enableNavigationControls,i.lastSetCameraZ=l.position.z;var h;i.container.appendChild(h=document.createElement("div")),h.className="graph-info-msg",h.textContent="",i.forceGraph.onLoading(function(){h.textContent="Loading..."}).onFinishLoading(function(){h.textContent=""}).onUpdate(function(){i.graphData=i.forceGraph.graphData(),l.position.x===0&&l.position.y===0&&l.position.z===i.lastSetCameraZ&&i.graphData.nodes.length&&(l.lookAt(i.forceGraph.position),i.lastSetCameraZ=l.position.z=Math.cbrt(i.graphData.nodes.length)*oQ)}).onFinishUpdate(function(){if(i._dragControls){var f=i.graphData.nodes.find(function(m){return m.__initialFixedPos&&!m.__disposeControlsAfterDrag});f?f.__disposeControlsAfterDrag=!0:i._dragControls.dispose(),i._dragControls=void 0}if(i.enableNodeDrag&&i.enablePointerInteraction&&i.forceEngine==="d3"){var d=i._dragControls=new wK(i.graphData.nodes.map(function(m){return m.__threeObj}).filter(function(m){return m}),l,a.domElement);d.addEventListener("dragstart",function(m){u.enabled=!1,m.object.__initialPos=m.object.position.clone(),m.object.__prevPos=m.object.position.clone();var g=nl(m.object).__data;!g.__initialFixedPos&&(g.__initialFixedPos={fx:g.fx,fy:g.fy,fz:g.fz}),!g.__initialPos&&(g.__initialPos={x:g.x,y:g.y,z:g.z}),["x","y","z"].forEach(function(x){return g["f".concat(x)]=g[x]}),a.domElement.classList.add("grabbable")}),d.addEventListener("drag",function(m){var g=nl(m.object);if(!m.object.hasOwnProperty("__graphObjType")){var x=m.object.__initialPos,v=m.object.__prevPos,A=m.object.position;g.position.add(A.clone().sub(v)),v.copy(A),A.copy(x)}var _=g.__data,E=g.position,w={x:E.x-_.x,y:E.y-_.y,z:E.z-_.z};["x","y","z"].forEach(function(S){return _["f".concat(S)]=_[S]=E[S]}),i.forceGraph.d3AlphaTarget(.3).resetCountdown(),_.__dragged=!0,i.onNodeDrag(_,w)}),d.addEventListener("dragend",function(m){delete m.object.__initialPos,delete m.object.__prevPos;var g=nl(m.object).__data;g.__disposeControlsAfterDrag&&(d.dispose(),delete g.__disposeControlsAfterDrag);var x=g.__initialFixedPos,v=g.__initialPos,A={x:v.x-g.x,y:v.y-g.y,z:v.z-g.z};x&&(["x","y","z"].forEach(function(_){var E="f".concat(_);x[E]===void 0&&delete g[E]}),delete g.__initialFixedPos,delete g.__initialPos,g.__dragged&&(delete g.__dragged,i.onNodeDragEnd(g,A))),i.forceGraph.d3AlphaTarget(0).resetCountdown(),i.enableNavigationControls&&(u.enabled=!0,u.domElement&&u.domElement.ownerDocument&&u.domElement.ownerDocument.dispatchEvent(new PointerEvent("pointerup",{pointerType:"touch"}))),a.domElement.classList.remove("grabbable")})}}),i.renderObjs.objects([new jR.AmbientLight(12303291),new jR.DirectionalLight(16777215,.6),i.forceGraph]).hoverOrderComparator(function(f,d){var m=nl(f);if(!m)return 1;var g=nl(d);if(!g)return-1;var x=function(A){return A.__graphObjType==="node"};return x(g)-x(m)}).tooltipContent(function(f){var d=nl(f);return d&&Wn(i["".concat(d.__graphObjType,"Label")])(d.__data)||""}).hoverDuringDrag(!1).onHover(function(f){var d=nl(f);if(d!==i.hoverObj){var m=i.hoverObj?i.hoverObj.__graphObjType:null,g=i.hoverObj?i.hoverObj.__data:null,x=d?d.__graphObjType:null,v=d?d.__data:null;if(m&&m!==x){var A=i["on".concat(m==="node"?"Node":"Link","Hover")];A&&A(null,g)}if(x){var _=i["on".concat(x==="node"?"Node":"Link","Hover")];_&&_(v,m===x?g:null)}a.domElement.classList[d&&i["on".concat(x==="node"?"Node":"Link","Click")]||!d&&i.onBackgroundClick?"add":"remove"]("clickable"),i.hoverObj=d}}).clickAfterDrag(!1).onClick(function(f,d){var m=nl(f);if(m){var g=i["on".concat(m.__graphObjType==="node"?"Node":"Link","Click")];g&&g(m.__data,d)}else i.onBackgroundClick&&i.onBackgroundClick(d)}).onRightClick(function(f,d){var m=nl(f);if(m){var g=i["on".concat(m.__graphObjType==="node"?"Node":"Link","RightClick")];g&&g(m.__data,d)}else i.onBackgroundRightClick&&i.onBackgroundRightClick(d)}),this._animationCycle()}});function nl(r){for(var n=r;n&&!n.hasOwnProperty("__graphObjType");)n=n.parent;return n}var uA="http://www.w3.org/1999/xhtml";const $R={svg:"http://www.w3.org/2000/svg",xhtml:uA,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Jy(r){var n=r+="",i=n.indexOf(":");return i>=0&&(n=r.slice(0,i))!=="xmlns"&&(r=r.slice(i+1)),$R.hasOwnProperty(n)?{space:$R[n],local:r}:r}function dQ(r){return function(){var n=this.ownerDocument,i=this.namespaceURI;return i===uA&&n.documentElement.namespaceURI===uA?n.createElement(r):n.createElementNS(i,r)}}function fQ(r){return function(){return this.ownerDocument.createElementNS(r.space,r.local)}}function OI(r){var n=Jy(r);return(n.local?fQ:dQ)(n)}function pQ(){}function Jw(r){return r==null?pQ:function(){return this.querySelector(r)}}function mQ(r){typeof r!="function"&&(r=Jw(r));for(var n=this._groups,i=n.length,o=new Array(i),l=0;l<i;++l)for(var a=n[l],u=a.length,h=o[l]=new Array(u),f,d,m=0;m<u;++m)(f=a[m])&&(d=r.call(f,f.__data__,m,a))&&("__data__"in f&&(d.__data__=f.__data__),h[m]=d);return new oo(o,this._parents)}function gQ(r){return r==null?[]:Array.isArray(r)?r:Array.from(r)}function vQ(){return[]}function II(r){return r==null?vQ:function(){return this.querySelectorAll(r)}}function yQ(r){return function(){return gQ(r.apply(this,arguments))}}function xQ(r){typeof r=="function"?r=yQ(r):r=II(r);for(var n=this._groups,i=n.length,o=[],l=[],a=0;a<i;++a)for(var u=n[a],h=u.length,f,d=0;d<h;++d)(f=u[d])&&(o.push(r.call(f,f.__data__,d,u)),l.push(f));return new oo(o,l)}function kI(r){return function(){return this.matches(r)}}function NI(r){return function(n){return n.matches(r)}}var _Q=Array.prototype.find;function bQ(r){return function(){return _Q.call(this.children,r)}}function EQ(){return this.firstElementChild}function AQ(r){return this.select(r==null?EQ:bQ(typeof r=="function"?r:NI(r)))}var wQ=Array.prototype.filter;function MQ(){return Array.from(this.children)}function SQ(r){return function(){return wQ.call(this.children,r)}}function TQ(r){return this.selectAll(r==null?MQ:SQ(typeof r=="function"?r:NI(r)))}function CQ(r){typeof r!="function"&&(r=kI(r));for(var n=this._groups,i=n.length,o=new Array(i),l=0;l<i;++l)for(var a=n[l],u=a.length,h=o[l]=[],f,d=0;d<u;++d)(f=a[d])&&r.call(f,f.__data__,d,a)&&h.push(f);return new oo(o,this._parents)}function FI(r){return new Array(r.length)}function RQ(){return new oo(this._enter||this._groups.map(FI),this._parents)}function by(r,n){this.ownerDocument=r.ownerDocument,this.namespaceURI=r.namespaceURI,this._next=null,this._parent=r,this.__data__=n}by.prototype={constructor:by,appendChild:function(r){return this._parent.insertBefore(r,this._next)},insertBefore:function(r,n){return this._parent.insertBefore(r,n)},querySelector:function(r){return this._parent.querySelector(r)},querySelectorAll:function(r){return this._parent.querySelectorAll(r)}};function LQ(r){return function(){return r}}function PQ(r,n,i,o,l,a){for(var u=0,h,f=n.length,d=a.length;u<d;++u)(h=n[u])?(h.__data__=a[u],o[u]=h):i[u]=new by(r,a[u]);for(;u<f;++u)(h=n[u])&&(l[u]=h)}function DQ(r,n,i,o,l,a,u){var h,f,d=new Map,m=n.length,g=a.length,x=new Array(m),v;for(h=0;h<m;++h)(f=n[h])&&(x[h]=v=u.call(f,f.__data__,h,n)+"",d.has(v)?l[h]=f:d.set(v,f));for(h=0;h<g;++h)v=u.call(r,a[h],h,a)+"",(f=d.get(v))?(o[h]=f,f.__data__=a[h],d.delete(v)):i[h]=new by(r,a[h]);for(h=0;h<m;++h)(f=n[h])&&d.get(x[h])===f&&(l[h]=f)}function OQ(r){return r.__data__}function IQ(r,n){if(!arguments.length)return Array.from(this,OQ);var i=n?DQ:PQ,o=this._parents,l=this._groups;typeof r!="function"&&(r=LQ(r));for(var a=l.length,u=new Array(a),h=new Array(a),f=new Array(a),d=0;d<a;++d){var m=o[d],g=l[d],x=g.length,v=kQ(r.call(m,m&&m.__data__,d,o)),A=v.length,_=h[d]=new Array(A),E=u[d]=new Array(A),w=f[d]=new Array(x);i(m,g,_,E,w,v,n);for(var S=0,T=0,R,L;S<A;++S)if(R=_[S]){for(S>=T&&(T=S+1);!(L=E[T])&&++T<A;);R._next=L||null}}return u=new oo(u,o),u._enter=h,u._exit=f,u}function kQ(r){return typeof r=="object"&&"length"in r?r:Array.from(r)}function NQ(){return new oo(this._exit||this._groups.map(FI),this._parents)}function FQ(r,n,i){var o=this.enter(),l=this,a=this.exit();return typeof r=="function"?(o=r(o),o&&(o=o.selection())):o=o.append(r+""),n!=null&&(l=n(l),l&&(l=l.selection())),i==null?a.remove():i(a),o&&l?o.merge(l).order():l}function BQ(r){for(var n=r.selection?r.selection():r,i=this._groups,o=n._groups,l=i.length,a=o.length,u=Math.min(l,a),h=new Array(l),f=0;f<u;++f)for(var d=i[f],m=o[f],g=d.length,x=h[f]=new Array(g),v,A=0;A<g;++A)(v=d[A]||m[A])&&(x[A]=v);for(;f<l;++f)h[f]=i[f];return new oo(h,this._parents)}function UQ(){for(var r=this._groups,n=-1,i=r.length;++n<i;)for(var o=r[n],l=o.length-1,a=o[l],u;--l>=0;)(u=o[l])&&(a&&u.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(u,a),a=u);return this}function zQ(r){r||(r=HQ);function n(g,x){return g&&x?r(g.__data__,x.__data__):!g-!x}for(var i=this._groups,o=i.length,l=new Array(o),a=0;a<o;++a){for(var u=i[a],h=u.length,f=l[a]=new Array(h),d,m=0;m<h;++m)(d=u[m])&&(f[m]=d);f.sort(n)}return new oo(l,this._parents).order()}function HQ(r,n){return r<n?-1:r>n?1:r>=n?0:NaN}function GQ(){var r=arguments[0];return arguments[0]=this,r.apply(null,arguments),this}function VQ(){return Array.from(this)}function WQ(){for(var r=this._groups,n=0,i=r.length;n<i;++n)for(var o=r[n],l=0,a=o.length;l<a;++l){var u=o[l];if(u)return u}return null}function jQ(){let r=0;for(const n of this)++r;return r}function $Q(){return!this.node()}function XQ(r){for(var n=this._groups,i=0,o=n.length;i<o;++i)for(var l=n[i],a=0,u=l.length,h;a<u;++a)(h=l[a])&&r.call(h,h.__data__,a,l);return this}function qQ(r){return function(){this.removeAttribute(r)}}function YQ(r){return function(){this.removeAttributeNS(r.space,r.local)}}function KQ(r,n){return function(){this.setAttribute(r,n)}}function QQ(r,n){return function(){this.setAttributeNS(r.space,r.local,n)}}function ZQ(r,n){return function(){var i=n.apply(this,arguments);i==null?this.removeAttribute(r):this.setAttribute(r,i)}}function JQ(r,n){return function(){var i=n.apply(this,arguments);i==null?this.removeAttributeNS(r.space,r.local):this.setAttributeNS(r.space,r.local,i)}}function eZ(r,n){var i=Jy(r);if(arguments.length<2){var o=this.node();return i.local?o.getAttributeNS(i.space,i.local):o.getAttribute(i)}return this.each((n==null?i.local?YQ:qQ:typeof n=="function"?i.local?JQ:ZQ:i.local?QQ:KQ)(i,n))}function BI(r){return r.ownerDocument&&r.ownerDocument.defaultView||r.document&&r||r.defaultView}function tZ(r){return function(){this.style.removeProperty(r)}}function nZ(r,n,i){return function(){this.style.setProperty(r,n,i)}}function iZ(r,n,i){return function(){var o=n.apply(this,arguments);o==null?this.style.removeProperty(r):this.style.setProperty(r,o,i)}}function rZ(r,n,i){return arguments.length>1?this.each((n==null?tZ:typeof n=="function"?iZ:nZ)(r,n,i==null?"":i)):Zd(this.node(),r)}function Zd(r,n){return r.style.getPropertyValue(n)||BI(r).getComputedStyle(r,null).getPropertyValue(n)}function sZ(r){return function(){delete this[r]}}function oZ(r,n){return function(){this[r]=n}}function aZ(r,n){return function(){var i=n.apply(this,arguments);i==null?delete this[r]:this[r]=i}}function lZ(r,n){return arguments.length>1?this.each((n==null?sZ:typeof n=="function"?aZ:oZ)(r,n)):this.node()[r]}function UI(r){return r.trim().split(/^|\s+/)}function eM(r){return r.classList||new zI(r)}function zI(r){this._node=r,this._names=UI(r.getAttribute("class")||"")}zI.prototype={add:function(r){var n=this._names.indexOf(r);n<0&&(this._names.push(r),this._node.setAttribute("class",this._names.join(" ")))},remove:function(r){var n=this._names.indexOf(r);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(r){return this._names.indexOf(r)>=0}};function HI(r,n){for(var i=eM(r),o=-1,l=n.length;++o<l;)i.add(n[o])}function GI(r,n){for(var i=eM(r),o=-1,l=n.length;++o<l;)i.remove(n[o])}function cZ(r){return function(){HI(this,r)}}function uZ(r){return function(){GI(this,r)}}function hZ(r,n){return function(){(n.apply(this,arguments)?HI:GI)(this,r)}}function dZ(r,n){var i=UI(r+"");if(arguments.length<2){for(var o=eM(this.node()),l=-1,a=i.length;++l<a;)if(!o.contains(i[l]))return!1;return!0}return this.each((typeof n=="function"?hZ:n?cZ:uZ)(i,n))}function fZ(){this.textContent=""}function pZ(r){return function(){this.textContent=r}}function mZ(r){return function(){var n=r.apply(this,arguments);this.textContent=n==null?"":n}}function gZ(r){return arguments.length?this.each(r==null?fZ:(typeof r=="function"?mZ:pZ)(r)):this.node().textContent}function vZ(){this.innerHTML=""}function yZ(r){return function(){this.innerHTML=r}}function xZ(r){return function(){var n=r.apply(this,arguments);this.innerHTML=n==null?"":n}}function _Z(r){return arguments.length?this.each(r==null?vZ:(typeof r=="function"?xZ:yZ)(r)):this.node().innerHTML}function bZ(){this.nextSibling&&this.parentNode.appendChild(this)}function EZ(){return this.each(bZ)}function AZ(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wZ(){return this.each(AZ)}function MZ(r){var n=typeof r=="function"?r:OI(r);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function SZ(){return null}function TZ(r,n){var i=typeof r=="function"?r:OI(r),o=n==null?SZ:typeof n=="function"?n:Jw(n);return this.select(function(){return this.insertBefore(i.apply(this,arguments),o.apply(this,arguments)||null)})}function CZ(){var r=this.parentNode;r&&r.removeChild(this)}function RZ(){return this.each(CZ)}function LZ(){var r=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(r,this.nextSibling):r}function PZ(){var r=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(r,this.nextSibling):r}function DZ(r){return this.select(r?PZ:LZ)}function OZ(r){return arguments.length?this.property("__data__",r):this.node().__data__}function IZ(r){return function(n){r.call(this,n,this.__data__)}}function kZ(r){return r.trim().split(/^|\s+/).map(function(n){var i="",o=n.indexOf(".");return o>=0&&(i=n.slice(o+1),n=n.slice(0,o)),{type:n,name:i}})}function NZ(r){return function(){var n=this.__on;if(!!n){for(var i=0,o=-1,l=n.length,a;i<l;++i)a=n[i],(!r.type||a.type===r.type)&&a.name===r.name?this.removeEventListener(a.type,a.listener,a.options):n[++o]=a;++o?n.length=o:delete this.__on}}}function FZ(r,n,i){return function(){var o=this.__on,l,a=IZ(n);if(o){for(var u=0,h=o.length;u<h;++u)if((l=o[u]).type===r.type&&l.name===r.name){this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=a,l.options=i),l.value=n;return}}this.addEventListener(r.type,a,i),l={type:r.type,name:r.name,value:n,listener:a,options:i},o?o.push(l):this.__on=[l]}}function BZ(r,n,i){var o=kZ(r+""),l,a=o.length,u;if(arguments.length<2){var h=this.node().__on;if(h){for(var f=0,d=h.length,m;f<d;++f)for(l=0,m=h[f];l<a;++l)if((u=o[l]).type===m.type&&u.name===m.name)return m.value}return}for(h=n?FZ:NZ,l=0;l<a;++l)this.each(h(o[l],n,i));return this}function VI(r,n,i){var o=BI(r),l=o.CustomEvent;typeof l=="function"?l=new l(n,i):(l=o.document.createEvent("Event"),i?(l.initEvent(n,i.bubbles,i.cancelable),l.detail=i.detail):l.initEvent(n,!1,!1)),r.dispatchEvent(l)}function UZ(r,n){return function(){return VI(this,r,n)}}function zZ(r,n){return function(){return VI(this,r,n.apply(this,arguments))}}function HZ(r,n){return this.each((typeof n=="function"?zZ:UZ)(r,n))}function*GZ(){for(var r=this._groups,n=0,i=r.length;n<i;++n)for(var o=r[n],l=0,a=o.length,u;l<a;++l)(u=o[l])&&(yield u)}var WI=[null];function oo(r,n){this._groups=r,this._parents=n}function Hm(){return new oo([[document.documentElement]],WI)}function VZ(){return this}oo.prototype=Hm.prototype={constructor:oo,select:mQ,selectAll:xQ,selectChild:AQ,selectChildren:TQ,filter:CQ,data:IQ,enter:RQ,exit:NQ,join:FQ,merge:BQ,selection:VZ,order:UQ,sort:zQ,call:GQ,nodes:VQ,node:WQ,size:jQ,empty:$Q,each:XQ,attr:eZ,style:rZ,property:lZ,classed:dZ,text:gZ,html:_Z,raise:EZ,lower:wZ,append:MZ,insert:TZ,remove:RZ,clone:DZ,datum:OZ,on:BZ,dispatch:HZ,[Symbol.iterator]:GZ};function Qo(r){return typeof r=="string"?new oo([[document.querySelector(r)]],[document.documentElement]):new oo([[r]],WI)}function WZ(r){let n;for(;n=r.sourceEvent;)r=n;return r}function ol(r,n){if(r=WZ(r),n===void 0&&(n=r.currentTarget),n){var i=n.ownerSVGElement||n;if(i.createSVGPoint){var o=i.createSVGPoint();return o.x=r.clientX,o.y=r.clientY,o=o.matrixTransform(n.getScreenCTM().inverse()),[o.x,o.y]}if(n.getBoundingClientRect){var l=n.getBoundingClientRect();return[r.clientX-l.left-n.clientLeft,r.clientY-l.top-n.clientTop]}}return[r.pageX,r.pageY]}const jZ={passive:!1},Sm={capture:!0,passive:!1};function y1(r){r.stopImmediatePropagation()}function Ud(r){r.preventDefault(),r.stopImmediatePropagation()}function jI(r){var n=r.document.documentElement,i=Qo(r).on("dragstart.drag",Ud,Sm);"onselectstart"in n?i.on("selectstart.drag",Ud,Sm):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function $I(r,n){var i=r.document.documentElement,o=Qo(r).on("dragstart.drag",null);n&&(o.on("click.drag",Ud,Sm),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in i?o.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}const l0=r=>()=>r;function hA(r,{sourceEvent:n,subject:i,target:o,identifier:l,active:a,x:u,y:h,dx:f,dy:d,dispatch:m}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:l,enumerable:!0,configurable:!0},active:{value:a,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:h,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:m}})}hA.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function $Z(r){return!r.ctrlKey&&!r.button}function XZ(){return this.parentNode}function qZ(r,n){return n==null?{x:r.x,y:r.y}:n}function YZ(){return navigator.maxTouchPoints||"ontouchstart"in this}function KZ(){var r=$Z,n=XZ,i=qZ,o=YZ,l={},a=Fm("start","drag","end"),u=0,h,f,d,m,g=0;function x(R){R.on("mousedown.drag",v).filter(o).on("touchstart.drag",E).on("touchmove.drag",w,jZ).on("touchend.drag touchcancel.drag",S).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function v(R,L){if(!(m||!r.call(this,R,L))){var I=T(this,n.call(this,R,L),R,L,"mouse");!I||(Qo(R.view).on("mousemove.drag",A,Sm).on("mouseup.drag",_,Sm),jI(R.view),y1(R),d=!1,h=R.clientX,f=R.clientY,I("start",R))}}function A(R){if(Ud(R),!d){var L=R.clientX-h,I=R.clientY-f;d=L*L+I*I>g}l.mouse("drag",R)}function _(R){Qo(R.view).on("mousemove.drag mouseup.drag",null),$I(R.view,d),Ud(R),l.mouse("end",R)}function E(R,L){if(!!r.call(this,R,L)){var I=R.changedTouches,N=n.call(this,R,L),B=I.length,H,q;for(H=0;H<B;++H)(q=T(this,N,R,L,I[H].identifier,I[H]))&&(y1(R),q("start",R,I[H]))}}function w(R){var L=R.changedTouches,I=L.length,N,B;for(N=0;N<I;++N)(B=l[L[N].identifier])&&(Ud(R),B("drag",R,L[N]))}function S(R){var L=R.changedTouches,I=L.length,N,B;for(m&&clearTimeout(m),m=setTimeout(function(){m=null},500),N=0;N<I;++N)(B=l[L[N].identifier])&&(y1(R),B("end",R,L[N]))}function T(R,L,I,N,B,H){var q=a.copy(),le=ol(H||I,L),ne,D,O;if((O=i.call(R,new hA("beforestart",{sourceEvent:I,target:x,identifier:B,active:u,x:le[0],y:le[1],dx:0,dy:0,dispatch:q}),N))!=null)return ne=O.x-le[0]||0,D=O.y-le[1]||0,function k(z,X,Z){var ie=le,se;switch(z){case"start":l[B]=k,se=u++;break;case"end":delete l[B],--u;case"drag":le=ol(Z||X,L),se=u;break}q.call(z,R,new hA(z,{sourceEvent:X,subject:O,target:x,identifier:B,active:se,x:le[0]+ne,y:le[1]+D,dx:le[0]-ie[0],dy:le[1]-ie[1],dispatch:q}),N)}}return x.filter=function(R){return arguments.length?(r=typeof R=="function"?R:l0(!!R),x):r},x.container=function(R){return arguments.length?(n=typeof R=="function"?R:l0(R),x):n},x.subject=function(R){return arguments.length?(i=typeof R=="function"?R:l0(R),x):i},x.touchable=function(R){return arguments.length?(o=typeof R=="function"?R:l0(!!R),x):o},x.on=function(){var R=a.on.apply(a,arguments);return R===a?x:R},x.clickDistance=function(R){return arguments.length?(g=(R=+R)*R,x):Math.sqrt(g)},x}var QZ=Fm("start","end","cancel","interrupt"),ZZ=[],XI=0,XR=1,dA=2,F0=3,qR=4,fA=5,B0=6;function ex(r,n,i,o,l,a){var u=r.__transition;if(!u)r.__transition={};else if(i in u)return;JZ(r,i,{name:n,index:o,group:l,on:QZ,tween:ZZ,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:XI})}function tM(r,n){var i=sa(r,n);if(i.state>XI)throw new Error("too late; already scheduled");return i}function Oa(r,n){var i=sa(r,n);if(i.state>F0)throw new Error("too late; already running");return i}function sa(r,n){var i=r.__transition;if(!i||!(i=i[n]))throw new Error("transition not found");return i}function JZ(r,n,i){var o=r.__transition,l;o[n]=i,i.timer=Bw(a,0,i.time);function a(d){i.state=XR,i.timer.restart(u,i.delay,i.time),i.delay<=d&&u(d-i.delay)}function u(d){var m,g,x,v;if(i.state!==XR)return f();for(m in o)if(v=o[m],v.name===i.name){if(v.state===F0)return K3(u);v.state===qR?(v.state=B0,v.timer.stop(),v.on.call("interrupt",r,r.__data__,v.index,v.group),delete o[m]):+m<n&&(v.state=B0,v.timer.stop(),v.on.call("cancel",r,r.__data__,v.index,v.group),delete o[m])}if(K3(function(){i.state===F0&&(i.state=qR,i.timer.restart(h,i.delay,i.time),h(d))}),i.state=dA,i.on.call("start",r,r.__data__,i.index,i.group),i.state===dA){for(i.state=F0,l=new Array(x=i.tween.length),m=0,g=-1;m<x;++m)(v=i.tween[m].value.call(r,r.__data__,i.index,i.group))&&(l[++g]=v);l.length=g+1}}function h(d){for(var m=d<i.duration?i.ease.call(null,d/i.duration):(i.timer.restart(f),i.state=fA,1),g=-1,x=l.length;++g<x;)l[g].call(r,m);i.state===fA&&(i.on.call("end",r,r.__data__,i.index,i.group),f())}function f(){i.state=B0,i.timer.stop(),delete o[n];for(var d in o)return;delete r.__transition}}function U0(r,n){var i=r.__transition,o,l,a=!0,u;if(!!i){n=n==null?null:n+"";for(u in i){if((o=i[u]).name!==n){a=!1;continue}l=o.state>dA&&o.state<fA,o.state=B0,o.timer.stop(),o.on.call(l?"interrupt":"cancel",r,r.__data__,o.index,o.group),delete i[u]}a&&delete r.__transition}}function eJ(r){return this.each(function(){U0(this,r)})}function tJ(r,n){var i,o;return function(){var l=Oa(this,r),a=l.tween;if(a!==i){o=i=a;for(var u=0,h=o.length;u<h;++u)if(o[u].name===n){o=o.slice(),o.splice(u,1);break}}l.tween=o}}function nJ(r,n,i){var o,l;if(typeof i!="function")throw new Error;return function(){var a=Oa(this,r),u=a.tween;if(u!==o){l=(o=u).slice();for(var h={name:n,value:i},f=0,d=l.length;f<d;++f)if(l[f].name===n){l[f]=h;break}f===d&&l.push(h)}a.tween=l}}function iJ(r,n){var i=this._id;if(r+="",arguments.length<2){for(var o=sa(this.node(),i).tween,l=0,a=o.length,u;l<a;++l)if((u=o[l]).name===r)return u.value;return null}return this.each((n==null?tJ:nJ)(i,r,n))}function nM(r,n,i){var o=r._id;return r.each(function(){var l=Oa(this,o);(l.value||(l.value={}))[n]=i.apply(this,arguments)}),function(l){return sa(l,o).value[n]}}function qI(r,n){var i;return(typeof n=="number"?uc:n instanceof wm?_R:(i=wm(n))?(n=i,_R):sY)(r,n)}function rJ(r){return function(){this.removeAttribute(r)}}function sJ(r){return function(){this.removeAttributeNS(r.space,r.local)}}function oJ(r,n,i){var o,l=i+"",a;return function(){var u=this.getAttribute(r);return u===l?null:u===o?a:a=n(o=u,i)}}function aJ(r,n,i){var o,l=i+"",a;return function(){var u=this.getAttributeNS(r.space,r.local);return u===l?null:u===o?a:a=n(o=u,i)}}function lJ(r,n,i){var o,l,a;return function(){var u,h=i(this),f;return h==null?void this.removeAttribute(r):(u=this.getAttribute(r),f=h+"",u===f?null:u===o&&f===l?a:(l=f,a=n(o=u,h)))}}function cJ(r,n,i){var o,l,a;return function(){var u,h=i(this),f;return h==null?void this.removeAttributeNS(r.space,r.local):(u=this.getAttributeNS(r.space,r.local),f=h+"",u===f?null:u===o&&f===l?a:(l=f,a=n(o=u,h)))}}function uJ(r,n){var i=Jy(r),o=i==="transform"?cY:qI;return this.attrTween(r,typeof n=="function"?(i.local?cJ:lJ)(i,o,nM(this,"attr."+r,n)):n==null?(i.local?sJ:rJ)(i):(i.local?aJ:oJ)(i,o,n))}function hJ(r,n){return function(i){this.setAttribute(r,n.call(this,i))}}function dJ(r,n){return function(i){this.setAttributeNS(r.space,r.local,n.call(this,i))}}function fJ(r,n){var i,o;function l(){var a=n.apply(this,arguments);return a!==o&&(i=(o=a)&&dJ(r,a)),i}return l._value=n,l}function pJ(r,n){var i,o;function l(){var a=n.apply(this,arguments);return a!==o&&(i=(o=a)&&hJ(r,a)),i}return l._value=n,l}function mJ(r,n){var i="attr."+r;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;var o=Jy(r);return this.tween(i,(o.local?fJ:pJ)(o,n))}function gJ(r,n){return function(){tM(this,r).delay=+n.apply(this,arguments)}}function vJ(r,n){return n=+n,function(){tM(this,r).delay=n}}function yJ(r){var n=this._id;return arguments.length?this.each((typeof r=="function"?gJ:vJ)(n,r)):sa(this.node(),n).delay}function xJ(r,n){return function(){Oa(this,r).duration=+n.apply(this,arguments)}}function _J(r,n){return n=+n,function(){Oa(this,r).duration=n}}function bJ(r){var n=this._id;return arguments.length?this.each((typeof r=="function"?xJ:_J)(n,r)):sa(this.node(),n).duration}function EJ(r,n){if(typeof n!="function")throw new Error;return function(){Oa(this,r).ease=n}}function AJ(r){var n=this._id;return arguments.length?this.each(EJ(n,r)):sa(this.node(),n).ease}function wJ(r,n){return function(){var i=n.apply(this,arguments);if(typeof i!="function")throw new Error;Oa(this,r).ease=i}}function MJ(r){if(typeof r!="function")throw new Error;return this.each(wJ(this._id,r))}function SJ(r){typeof r!="function"&&(r=kI(r));for(var n=this._groups,i=n.length,o=new Array(i),l=0;l<i;++l)for(var a=n[l],u=a.length,h=o[l]=[],f,d=0;d<u;++d)(f=a[d])&&r.call(f,f.__data__,d,a)&&h.push(f);return new Sl(o,this._parents,this._name,this._id)}function TJ(r){if(r._id!==this._id)throw new Error;for(var n=this._groups,i=r._groups,o=n.length,l=i.length,a=Math.min(o,l),u=new Array(o),h=0;h<a;++h)for(var f=n[h],d=i[h],m=f.length,g=u[h]=new Array(m),x,v=0;v<m;++v)(x=f[v]||d[v])&&(g[v]=x);for(;h<o;++h)u[h]=n[h];return new Sl(u,this._parents,this._name,this._id)}function CJ(r){return(r+"").trim().split(/^|\s+/).every(function(n){var i=n.indexOf(".");return i>=0&&(n=n.slice(0,i)),!n||n==="start"})}function RJ(r,n,i){var o,l,a=CJ(n)?tM:Oa;return function(){var u=a(this,r),h=u.on;h!==o&&(l=(o=h).copy()).on(n,i),u.on=l}}function LJ(r,n){var i=this._id;return arguments.length<2?sa(this.node(),i).on.on(r):this.each(RJ(i,r,n))}function PJ(r){return function(){var n=this.parentNode;for(var i in this.__transition)if(+i!==r)return;n&&n.removeChild(this)}}function DJ(){return this.on("end.remove",PJ(this._id))}function OJ(r){var n=this._name,i=this._id;typeof r!="function"&&(r=Jw(r));for(var o=this._groups,l=o.length,a=new Array(l),u=0;u<l;++u)for(var h=o[u],f=h.length,d=a[u]=new Array(f),m,g,x=0;x<f;++x)(m=h[x])&&(g=r.call(m,m.__data__,x,h))&&("__data__"in m&&(g.__data__=m.__data__),d[x]=g,ex(d[x],n,i,x,d,sa(m,i)));return new Sl(a,this._parents,n,i)}function IJ(r){var n=this._name,i=this._id;typeof r!="function"&&(r=II(r));for(var o=this._groups,l=o.length,a=[],u=[],h=0;h<l;++h)for(var f=o[h],d=f.length,m,g=0;g<d;++g)if(m=f[g]){for(var x=r.call(m,m.__data__,g,f),v,A=sa(m,i),_=0,E=x.length;_<E;++_)(v=x[_])&&ex(v,n,i,_,x,A);a.push(x),u.push(m)}return new Sl(a,u,n,i)}var kJ=Hm.prototype.constructor;function NJ(){return new kJ(this._groups,this._parents)}function FJ(r,n){var i,o,l;return function(){var a=Zd(this,r),u=(this.style.removeProperty(r),Zd(this,r));return a===u?null:a===i&&u===o?l:l=n(i=a,o=u)}}function YI(r){return function(){this.style.removeProperty(r)}}function BJ(r,n,i){var o,l=i+"",a;return function(){var u=Zd(this,r);return u===l?null:u===o?a:a=n(o=u,i)}}function UJ(r,n,i){var o,l,a;return function(){var u=Zd(this,r),h=i(this),f=h+"";return h==null&&(f=h=(this.style.removeProperty(r),Zd(this,r))),u===f?null:u===o&&f===l?a:(l=f,a=n(o=u,h))}}function zJ(r,n){var i,o,l,a="style."+n,u="end."+a,h;return function(){var f=Oa(this,r),d=f.on,m=f.value[a]==null?h||(h=YI(n)):void 0;(d!==i||l!==m)&&(o=(i=d).copy()).on(u,l=m),f.on=o}}function HJ(r,n,i){var o=(r+="")=="transform"?lY:qI;return n==null?this.styleTween(r,FJ(r,o)).on("end.style."+r,YI(r)):typeof n=="function"?this.styleTween(r,UJ(r,o,nM(this,"style."+r,n))).each(zJ(this._id,r)):this.styleTween(r,BJ(r,o,n),i).on("end.style."+r,null)}function GJ(r,n,i){return function(o){this.style.setProperty(r,n.call(this,o),i)}}function VJ(r,n,i){var o,l;function a(){var u=n.apply(this,arguments);return u!==l&&(o=(l=u)&&GJ(r,u,i)),o}return a._value=n,a}function WJ(r,n,i){var o="style."+(r+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(n==null)return this.tween(o,null);if(typeof n!="function")throw new Error;return this.tween(o,VJ(r,n,i==null?"":i))}function jJ(r){return function(){this.textContent=r}}function $J(r){return function(){var n=r(this);this.textContent=n==null?"":n}}function XJ(r){return this.tween("text",typeof r=="function"?$J(nM(this,"text",r)):jJ(r==null?"":r+""))}function qJ(r){return function(n){this.textContent=r.call(this,n)}}function YJ(r){var n,i;function o(){var l=r.apply(this,arguments);return l!==i&&(n=(i=l)&&qJ(l)),n}return o._value=r,o}function KJ(r){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(r==null)return this.tween(n,null);if(typeof r!="function")throw new Error;return this.tween(n,YJ(r))}function QJ(){for(var r=this._name,n=this._id,i=KI(),o=this._groups,l=o.length,a=0;a<l;++a)for(var u=o[a],h=u.length,f,d=0;d<h;++d)if(f=u[d]){var m=sa(f,n);ex(f,r,i,d,u,{time:m.time+m.delay+m.duration,delay:0,duration:m.duration,ease:m.ease})}return new Sl(o,this._parents,r,i)}function ZJ(){var r,n,i=this,o=i._id,l=i.size();return new Promise(function(a,u){var h={value:u},f={value:function(){--l===0&&a()}};i.each(function(){var d=Oa(this,o),m=d.on;m!==r&&(n=(r=m).copy(),n._.cancel.push(h),n._.interrupt.push(h),n._.end.push(f)),d.on=n}),l===0&&a()})}var JJ=0;function Sl(r,n,i,o){this._groups=r,this._parents=n,this._name=i,this._id=o}function KI(){return++JJ}var il=Hm.prototype;Sl.prototype={constructor:Sl,select:OJ,selectAll:IJ,selectChild:il.selectChild,selectChildren:il.selectChildren,filter:SJ,merge:TJ,selection:NJ,transition:QJ,call:il.call,nodes:il.nodes,node:il.node,size:il.size,empty:il.empty,each:il.each,on:LJ,attr:uJ,attrTween:mJ,style:HJ,styleTween:WJ,text:XJ,textTween:KJ,remove:DJ,tween:iJ,delay:yJ,duration:bJ,ease:AJ,easeVarying:MJ,end:ZJ,[Symbol.iterator]:il[Symbol.iterator]};function eee(r){return((r*=2)<=1?r*r*r:(r-=2)*r*r+2)/2}var tee={time:null,delay:0,duration:250,ease:eee};function nee(r,n){for(var i;!(i=r.__transition)||!(i=i[n]);)if(!(r=r.parentNode))throw new Error(`transition ${n} not found`);return i}function iee(r){var n,i;r instanceof Sl?(n=r._id,r=r._name):(n=KI(),(i=tee).time=Fw(),r=r==null?null:r+"");for(var o=this._groups,l=o.length,a=0;a<l;++a)for(var u=o[a],h=u.length,f,d=0;d<h;++d)(f=u[d])&&ex(f,r,n,d,u,i||nee(f,n));return new Sl(o,this._parents,r,n)}Hm.prototype.interrupt=eJ;Hm.prototype.transition=iee;const c0=r=>()=>r;function ree(r,{sourceEvent:n,target:i,transform:o,dispatch:l}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:l}})}function pl(r,n,i){this.k=r,this.x=n,this.y=i}pl.prototype={constructor:pl,scale:function(r){return r===1?this:new pl(this.k*r,this.x,this.y)},translate:function(r,n){return r===0&n===0?this:new pl(this.k,this.x+this.k*r,this.y+this.k*n)},apply:function(r){return[r[0]*this.k+this.x,r[1]*this.k+this.y]},applyX:function(r){return r*this.k+this.x},applyY:function(r){return r*this.k+this.y},invert:function(r){return[(r[0]-this.x)/this.k,(r[1]-this.y)/this.k]},invertX:function(r){return(r-this.x)/this.k},invertY:function(r){return(r-this.y)/this.k},rescaleX:function(r){return r.copy().domain(r.range().map(this.invertX,this).map(r.invert,r))},rescaleY:function(r){return r.copy().domain(r.range().map(this.invertY,this).map(r.invert,r))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var iM=new pl(1,0,0);ba.prototype=pl.prototype;function ba(r){for(;!r.__zoom;)if(!(r=r.parentNode))return iM;return r.__zoom}function x1(r){r.stopImmediatePropagation()}function xp(r){r.preventDefault(),r.stopImmediatePropagation()}function see(r){return(!r.ctrlKey||r.type==="wheel")&&!r.button}function oee(){var r=this;return r instanceof SVGElement?(r=r.ownerSVGElement||r,r.hasAttribute("viewBox")?(r=r.viewBox.baseVal,[[r.x,r.y],[r.x+r.width,r.y+r.height]]):[[0,0],[r.width.baseVal.value,r.height.baseVal.value]]):[[0,0],[r.clientWidth,r.clientHeight]]}function YR(){return this.__zoom||iM}function aee(r){return-r.deltaY*(r.deltaMode===1?.05:r.deltaMode?1:.002)*(r.ctrlKey?10:1)}function lee(){return navigator.maxTouchPoints||"ontouchstart"in this}function cee(r,n,i){var o=r.invertX(n[0][0])-i[0][0],l=r.invertX(n[1][0])-i[1][0],a=r.invertY(n[0][1])-i[0][1],u=r.invertY(n[1][1])-i[1][1];return r.translate(l>o?(o+l)/2:Math.min(0,o)||Math.max(0,l),u>a?(a+u)/2:Math.min(0,a)||Math.max(0,u))}function uee(){var r=see,n=oee,i=cee,o=aee,l=lee,a=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],h=250,f=fY,d=Fm("start","zoom","end"),m,g,x,v=500,A=150,_=0,E=10;function w(O){O.property("__zoom",YR).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",H).on("dblclick.zoom",q).filter(l).on("touchstart.zoom",le).on("touchmove.zoom",ne).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(O,k,z,X){var Z=O.selection?O.selection():O;Z.property("__zoom",YR),O!==Z?L(O,k,z,X):Z.interrupt().each(function(){I(this,arguments).event(X).start().zoom(null,typeof k=="function"?k.apply(this,arguments):k).end()})},w.scaleBy=function(O,k,z,X){w.scaleTo(O,function(){var Z=this.__zoom.k,ie=typeof k=="function"?k.apply(this,arguments):k;return Z*ie},z,X)},w.scaleTo=function(O,k,z,X){w.transform(O,function(){var Z=n.apply(this,arguments),ie=this.__zoom,se=z==null?R(Z):typeof z=="function"?z.apply(this,arguments):z,ue=ie.invert(se),ye=typeof k=="function"?k.apply(this,arguments):k;return i(T(S(ie,ye),se,ue),Z,u)},z,X)},w.translateBy=function(O,k,z,X){w.transform(O,function(){return i(this.__zoom.translate(typeof k=="function"?k.apply(this,arguments):k,typeof z=="function"?z.apply(this,arguments):z),n.apply(this,arguments),u)},null,X)},w.translateTo=function(O,k,z,X,Z){w.transform(O,function(){var ie=n.apply(this,arguments),se=this.__zoom,ue=X==null?R(ie):typeof X=="function"?X.apply(this,arguments):X;return i(iM.translate(ue[0],ue[1]).scale(se.k).translate(typeof k=="function"?-k.apply(this,arguments):-k,typeof z=="function"?-z.apply(this,arguments):-z),ie,u)},X,Z)};function S(O,k){return k=Math.max(a[0],Math.min(a[1],k)),k===O.k?O:new pl(k,O.x,O.y)}function T(O,k,z){var X=k[0]-z[0]*O.k,Z=k[1]-z[1]*O.k;return X===O.x&&Z===O.y?O:new pl(O.k,X,Z)}function R(O){return[(+O[0][0]+ +O[1][0])/2,(+O[0][1]+ +O[1][1])/2]}function L(O,k,z,X){O.on("start.zoom",function(){I(this,arguments).event(X).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(X).end()}).tween("zoom",function(){var Z=this,ie=arguments,se=I(Z,ie).event(X),ue=n.apply(Z,ie),ye=z==null?R(ue):typeof z=="function"?z.apply(Z,ie):z,Ce=Math.max(ue[1][0]-ue[0][0],ue[1][1]-ue[0][1]),ke=Z.__zoom,Oe=typeof k=="function"?k.apply(Z,ie):k,Ne=f(ke.invert(ye).concat(Ce/ke.k),Oe.invert(ye).concat(Ce/Oe.k));return function(He){if(He===1)He=Oe;else{var Qe=Ne(He),St=Ce/Qe[2];He=new pl(St,ye[0]-Qe[0]*St,ye[1]-Qe[1]*St)}se.zoom(null,He)}})}function I(O,k,z){return!z&&O.__zooming||new N(O,k)}function N(O,k){this.that=O,this.args=k,this.active=0,this.sourceEvent=null,this.extent=n.apply(O,k),this.taps=0}N.prototype={event:function(O){return O&&(this.sourceEvent=O),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(O,k){return this.mouse&&O!=="mouse"&&(this.mouse[1]=k.invert(this.mouse[0])),this.touch0&&O!=="touch"&&(this.touch0[1]=k.invert(this.touch0[0])),this.touch1&&O!=="touch"&&(this.touch1[1]=k.invert(this.touch1[0])),this.that.__zoom=k,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(O){var k=Qo(this.that).datum();d.call(O,this.that,new ree(O,{sourceEvent:this.sourceEvent,target:w,type:O,transform:this.that.__zoom,dispatch:d}),k)}};function B(O,...k){if(!r.apply(this,arguments))return;var z=I(this,k).event(O),X=this.__zoom,Z=Math.max(a[0],Math.min(a[1],X.k*Math.pow(2,o.apply(this,arguments)))),ie=ol(O);if(z.wheel)(z.mouse[0][0]!==ie[0]||z.mouse[0][1]!==ie[1])&&(z.mouse[1]=X.invert(z.mouse[0]=ie)),clearTimeout(z.wheel);else{if(X.k===Z)return;z.mouse=[ie,X.invert(ie)],U0(this),z.start()}xp(O),z.wheel=setTimeout(se,A),z.zoom("mouse",i(T(S(X,Z),z.mouse[0],z.mouse[1]),z.extent,u));function se(){z.wheel=null,z.end()}}function H(O,...k){if(x||!r.apply(this,arguments))return;var z=O.currentTarget,X=I(this,k,!0).event(O),Z=Qo(O.view).on("mousemove.zoom",ye,!0).on("mouseup.zoom",Ce,!0),ie=ol(O,z),se=O.clientX,ue=O.clientY;jI(O.view),x1(O),X.mouse=[ie,this.__zoom.invert(ie)],U0(this),X.start();function ye(ke){if(xp(ke),!X.moved){var Oe=ke.clientX-se,Ne=ke.clientY-ue;X.moved=Oe*Oe+Ne*Ne>_}X.event(ke).zoom("mouse",i(T(X.that.__zoom,X.mouse[0]=ol(ke,z),X.mouse[1]),X.extent,u))}function Ce(ke){Z.on("mousemove.zoom mouseup.zoom",null),$I(ke.view,X.moved),xp(ke),X.event(ke).end()}}function q(O,...k){if(!!r.apply(this,arguments)){var z=this.__zoom,X=ol(O.changedTouches?O.changedTouches[0]:O,this),Z=z.invert(X),ie=z.k*(O.shiftKey?.5:2),se=i(T(S(z,ie),X,Z),n.apply(this,k),u);xp(O),h>0?Qo(this).transition().duration(h).call(L,se,X,O):Qo(this).call(w.transform,se,X,O)}}function le(O,...k){if(!!r.apply(this,arguments)){var z=O.touches,X=z.length,Z=I(this,k,O.changedTouches.length===X).event(O),ie,se,ue,ye;for(x1(O),se=0;se<X;++se)ue=z[se],ye=ol(ue,this),ye=[ye,this.__zoom.invert(ye),ue.identifier],Z.touch0?!Z.touch1&&Z.touch0[2]!==ye[2]&&(Z.touch1=ye,Z.taps=0):(Z.touch0=ye,ie=!0,Z.taps=1+!!m);m&&(m=clearTimeout(m)),ie&&(Z.taps<2&&(g=ye[0],m=setTimeout(function(){m=null},v)),U0(this),Z.start())}}function ne(O,...k){if(!!this.__zooming){var z=I(this,k).event(O),X=O.changedTouches,Z=X.length,ie,se,ue,ye;for(xp(O),ie=0;ie<Z;++ie)se=X[ie],ue=ol(se,this),z.touch0&&z.touch0[2]===se.identifier?z.touch0[0]=ue:z.touch1&&z.touch1[2]===se.identifier&&(z.touch1[0]=ue);if(se=z.that.__zoom,z.touch1){var Ce=z.touch0[0],ke=z.touch0[1],Oe=z.touch1[0],Ne=z.touch1[1],He=(He=Oe[0]-Ce[0])*He+(He=Oe[1]-Ce[1])*He,Qe=(Qe=Ne[0]-ke[0])*Qe+(Qe=Ne[1]-ke[1])*Qe;se=S(se,Math.sqrt(He/Qe)),ue=[(Ce[0]+Oe[0])/2,(Ce[1]+Oe[1])/2],ye=[(ke[0]+Ne[0])/2,(ke[1]+Ne[1])/2]}else if(z.touch0)ue=z.touch0[0],ye=z.touch0[1];else return;z.zoom("touch",i(T(se,ue,ye),z.extent,u))}}function D(O,...k){if(!!this.__zooming){var z=I(this,k).event(O),X=O.changedTouches,Z=X.length,ie,se;for(x1(O),x&&clearTimeout(x),x=setTimeout(function(){x=null},v),ie=0;ie<Z;++ie)se=X[ie],z.touch0&&z.touch0[2]===se.identifier?delete z.touch0:z.touch1&&z.touch1[2]===se.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(se=ol(se,this),Math.hypot(g[0]-se[0],g[1]-se[1])<E)){var ue=Qo(this).on("dblclick.zoom");ue&&ue.apply(this,arguments)}}}return w.wheelDelta=function(O){return arguments.length?(o=typeof O=="function"?O:c0(+O),w):o},w.filter=function(O){return arguments.length?(r=typeof O=="function"?O:c0(!!O),w):r},w.touchable=function(O){return arguments.length?(l=typeof O=="function"?O:c0(!!O),w):l},w.extent=function(O){return arguments.length?(n=typeof O=="function"?O:c0([[+O[0][0],+O[0][1]],[+O[1][0],+O[1][1]]]),w):n},w.scaleExtent=function(O){return arguments.length?(a[0]=+O[0],a[1]=+O[1],w):[a[0],a[1]]},w.translateExtent=function(O){return arguments.length?(u[0][0]=+O[0][0],u[1][0]=+O[1][0],u[0][1]=+O[0][1],u[1][1]=+O[1][1],w):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},w.constrain=function(O){return arguments.length?(i=O,w):i},w.duration=function(O){return arguments.length?(h=+O,w):h},w.interpolate=function(O){return arguments.length?(f=O,w):f},w.on=function(){var O=d.on.apply(d,arguments);return O===d?w:O},w.clickDistance=function(O){return arguments.length?(_=(O=+O)*O,w):Math.sqrt(_)},w.tapDistance=function(O){return arguments.length?(E=+O,w):E},w}var QI="Expected a function",KR=0/0,hee="[object Symbol]",dee=/^\s+|\s+$/g,fee=/^[-+]0x[0-9a-f]+$/i,pee=/^0b[01]+$/i,mee=/^0o[0-7]+$/i,gee=parseInt,vee=typeof ks=="object"&&ks&&ks.Object===Object&&ks,yee=typeof self=="object"&&self&&self.Object===Object&&self,xee=vee||yee||Function("return this")(),_ee=Object.prototype,bee=_ee.toString,Eee=Math.max,Aee=Math.min,_1=function(){return xee.Date.now()};function wee(r,n,i){var o,l,a,u,h,f,d=0,m=!1,g=!1,x=!0;if(typeof r!="function")throw new TypeError(QI);n=QR(n)||0,Ey(i)&&(m=!!i.leading,g="maxWait"in i,a=g?Eee(QR(i.maxWait)||0,n):a,x="trailing"in i?!!i.trailing:x);function v(I){var N=o,B=l;return o=l=void 0,d=I,u=r.apply(B,N),u}function A(I){return d=I,h=setTimeout(w,n),m?v(I):u}function _(I){var N=I-f,B=I-d,H=n-N;return g?Aee(H,a-B):H}function E(I){var N=I-f,B=I-d;return f===void 0||N>=n||N<0||g&&B>=a}function w(){var I=_1();if(E(I))return S(I);h=setTimeout(w,_(I))}function S(I){return h=void 0,x&&o?v(I):(o=l=void 0,u)}function T(){h!==void 0&&clearTimeout(h),d=0,o=f=l=h=void 0}function R(){return h===void 0?u:S(_1())}function L(){var I=_1(),N=E(I);if(o=arguments,l=this,f=I,N){if(h===void 0)return A(f);if(g)return h=setTimeout(w,n),v(f)}return h===void 0&&(h=setTimeout(w,n)),u}return L.cancel=T,L.flush=R,L}function Mee(r,n,i){var o=!0,l=!0;if(typeof r!="function")throw new TypeError(QI);return Ey(i)&&(o="leading"in i?!!i.leading:o,l="trailing"in i?!!i.trailing:l),wee(r,n,{leading:o,maxWait:n,trailing:l})}function Ey(r){var n=typeof r;return!!r&&(n=="object"||n=="function")}function See(r){return!!r&&typeof r=="object"}function Tee(r){return typeof r=="symbol"||See(r)&&bee.call(r)==hee}function QR(r){if(typeof r=="number")return r;if(Tee(r))return KR;if(Ey(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=Ey(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=r.replace(dee,"");var i=pee.test(r);return i||mee.test(r)?gee(r.slice(2),i?2:8):fee.test(r)?KR:+r}var Cee=Mee;function Ree(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}function ZR(r,n){for(var i=0;i<n.length;i++){var o=n[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(r,o.key,o)}}function Lee(r,n,i){return n&&ZR(r.prototype,n),i&&ZR(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}function Pee(r){return Dee(r)||Oee(r)||Iee(r)||kee()}function Dee(r){if(Array.isArray(r))return pA(r)}function Oee(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Iee(r,n){if(!!r){if(typeof r=="string")return pA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return pA(r,n)}}function pA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function kee(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Nee=123,Fee=function(n){return"#".concat(Math.min(n,Math.pow(2,24)).toString(16).padStart(6,"0"))},ZI=function(n,i,o){return(n<<16)+(i<<8)+o},Bee=function(n){var i=qw(n).toRgb(),o=i.r,l=i.g,a=i.b;return ZI(o,l,a)},JR=function(n,i){return n*Nee%Math.pow(2,i)},Uee=function(){function r(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;Ree(this,r),this.csBits=n,this.registry=["__reserved for background__"]}return Lee(r,[{key:"register",value:function(i){if(this.registry.length>=Math.pow(2,24-this.csBits))return null;var o=this.registry.length,l=JR(o,this.csBits),a=Fee(o+(l<<24-this.csBits));return this.registry.push(i),a}},{key:"lookup",value:function(i){var o=typeof i=="string"?Bee(i):ZI.apply(void 0,Pee(i));if(!o)return null;var l=o&Math.pow(2,24-this.csBits)-1,a=o>>24-this.csBits&Math.pow(2,this.csBits)-1;return JR(l,this.csBits)!==a||l>=this.registry.length?null:this.registry[l]}}]),r}();const{abs:_p,cos:rl,sin:sd,acos:zee,atan2:bp,sqrt:nc,pow:go}=Math;function Ep(r){return r<0?-go(-r,1/3):go(r,1/3)}const JI=Math.PI,u0=2*JI,ic=JI/2,Hee=1e-6,b1=Number.MAX_SAFE_INTEGER||9007199254740991,E1=Number.MIN_SAFE_INTEGER||-9007199254740991,Gee={x:0,y:0,z:0},cn={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(r,n){const i=n(r);let o=i.x*i.x+i.y*i.y;return typeof i.z<"u"&&(o+=i.z*i.z),nc(o)},compute:function(r,n,i){if(r===0)return n[0].t=0,n[0];const o=n.length-1;if(r===1)return n[o].t=1,n[o];const l=1-r;let a=n;if(o===0)return n[0].t=r,n[0];if(o===1){const h={x:l*a[0].x+r*a[1].x,y:l*a[0].y+r*a[1].y,t:r};return i&&(h.z=l*a[0].z+r*a[1].z),h}if(o<4){let h=l*l,f=r*r,d,m,g,x=0;o===2?(a=[a[0],a[1],a[2],Gee],d=h,m=l*r*2,g=f):o===3&&(d=h*l,m=h*r*3,g=l*f*3,x=r*f);const v={x:d*a[0].x+m*a[1].x+g*a[2].x+x*a[3].x,y:d*a[0].y+m*a[1].y+g*a[2].y+x*a[3].y,t:r};return i&&(v.z=d*a[0].z+m*a[1].z+g*a[2].z+x*a[3].z),v}const u=JSON.parse(JSON.stringify(n));for(;u.length>1;){for(let h=0;h<u.length-1;h++)u[h]={x:u[h].x+(u[h+1].x-u[h].x)*r,y:u[h].y+(u[h+1].y-u[h].y)*r},typeof u[h].z<"u"&&(u[h]=u[h].z+(u[h+1].z-u[h].z)*r);u.splice(u.length-1,1)}return u[0].t=r,u[0]},computeWithRatios:function(r,n,i,o){const l=1-r,a=i,u=n;let h=a[0],f=a[1],d=a[2],m=a[3],g;if(h*=l,f*=r,u.length===2)return g=h+f,{x:(h*u[0].x+f*u[1].x)/g,y:(h*u[0].y+f*u[1].y)/g,z:o?(h*u[0].z+f*u[1].z)/g:!1,t:r};if(h*=l,f*=2*l,d*=r*r,u.length===3)return g=h+f+d,{x:(h*u[0].x+f*u[1].x+d*u[2].x)/g,y:(h*u[0].y+f*u[1].y+d*u[2].y)/g,z:o?(h*u[0].z+f*u[1].z+d*u[2].z)/g:!1,t:r};if(h*=l,f*=1.5*l,d*=3*l,m*=r*r*r,u.length===4)return g=h+f+d+m,{x:(h*u[0].x+f*u[1].x+d*u[2].x+m*u[3].x)/g,y:(h*u[0].y+f*u[1].y+d*u[2].y+m*u[3].y)/g,z:o?(h*u[0].z+f*u[1].z+d*u[2].z+m*u[3].z)/g:!1,t:r}},derive:function(r,n){const i=[];for(let o=r,l=o.length,a=l-1;l>1;l--,a--){const u=[];for(let h=0,f;h<a;h++)f={x:a*(o[h+1].x-o[h].x),y:a*(o[h+1].y-o[h].y)},n&&(f.z=a*(o[h+1].z-o[h].z)),u.push(f);i.push(u),o=u}return i},between:function(r,n,i){return n<=r&&r<=i||cn.approximately(r,n)||cn.approximately(r,i)},approximately:function(r,n,i){return _p(r-n)<=(i||Hee)},length:function(r){const i=cn.Tvalues.length;let o=0;for(let l=0,a;l<i;l++)a=.5*cn.Tvalues[l]+.5,o+=cn.Cvalues[l]*cn.arcfn(a,r);return .5*o},map:function(r,n,i,o,l){const a=i-n,u=l-o,h=r-n,f=h/a;return o+u*f},lerp:function(r,n,i){const o={x:n.x+r*(i.x-n.x),y:n.y+r*(i.y-n.y)};return n.z!==void 0&&i.z!==void 0&&(o.z=n.z+r*(i.z-n.z)),o},pointToString:function(r){let n=r.x+"/"+r.y;return typeof r.z<"u"&&(n+="/"+r.z),n},pointsToString:function(r){return"["+r.map(cn.pointToString).join(", ")+"]"},copy:function(r){return JSON.parse(JSON.stringify(r))},angle:function(r,n,i){const o=n.x-r.x,l=n.y-r.y,a=i.x-r.x,u=i.y-r.y,h=o*u-l*a,f=o*a+l*u;return bp(h,f)},round:function(r,n){const i=""+r,o=i.indexOf(".");return parseFloat(i.substring(0,o+1+n))},dist:function(r,n){const i=r.x-n.x,o=r.y-n.y;return nc(i*i+o*o)},closest:function(r,n){let i=go(2,63),o,l;return r.forEach(function(a,u){l=cn.dist(n,a),l<i&&(i=l,o=u)}),{mdist:i,mpos:o}},abcratio:function(r,n){if(n!==2&&n!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const i=go(r,n)+go(1-r,n),o=i-1;return _p(o/i)},projectionratio:function(r,n){if(n!==2&&n!==3)return!1;if(typeof r>"u")r=.5;else if(r===0||r===1)return r;const i=go(1-r,n),o=go(r,n)+i;return i/o},lli8:function(r,n,i,o,l,a,u,h){const f=(r*o-n*i)*(l-u)-(r-i)*(l*h-a*u),d=(r*o-n*i)*(a-h)-(n-o)*(l*h-a*u),m=(r-i)*(a-h)-(n-o)*(l-u);return m==0?!1:{x:f/m,y:d/m}},lli4:function(r,n,i,o){const l=r.x,a=r.y,u=n.x,h=n.y,f=i.x,d=i.y,m=o.x,g=o.y;return cn.lli8(l,a,u,h,f,d,m,g)},lli:function(r,n){return cn.lli4(r,r.c,n,n.c)},makeline:function(r,n){return new fr(r.x,r.y,(r.x+n.x)/2,(r.y+n.y)/2,n.x,n.y)},findbbox:function(r){let n=b1,i=b1,o=E1,l=E1;return r.forEach(function(a){const u=a.bbox();n>u.x.min&&(n=u.x.min),i>u.y.min&&(i=u.y.min),o<u.x.max&&(o=u.x.max),l<u.y.max&&(l=u.y.max)}),{x:{min:n,mid:(n+o)/2,max:o,size:o-n},y:{min:i,mid:(i+l)/2,max:l,size:l-i}}},shapeintersections:function(r,n,i,o,l){if(!cn.bboxoverlap(n,o))return[];const a=[],u=[r.startcap,r.forward,r.back,r.endcap],h=[i.startcap,i.forward,i.back,i.endcap];return u.forEach(function(f){f.virtual||h.forEach(function(d){if(d.virtual)return;const m=f.intersects(d,l);m.length>0&&(m.c1=f,m.c2=d,m.s1=r,m.s2=i,a.push(m))})}),a},makeshape:function(r,n,i){const o=n.points.length,l=r.points.length,a=cn.makeline(n.points[o-1],r.points[0]),u=cn.makeline(r.points[l-1],n.points[0]),h={startcap:a,forward:r,back:n,endcap:u,bbox:cn.findbbox([a,r,n,u])};return h.intersections=function(f){return cn.shapeintersections(h,h.bbox,f,f.bbox,i)},h},getminmax:function(r,n,i){if(!i)return{min:0,max:0};let o=b1,l=E1,a,u;i.indexOf(0)===-1&&(i=[0].concat(i)),i.indexOf(1)===-1&&i.push(1);for(let h=0,f=i.length;h<f;h++)a=i[h],u=r.get(a),u[n]<o&&(o=u[n]),u[n]>l&&(l=u[n]);return{min:o,mid:(o+l)/2,max:l,size:l-o}},align:function(r,n){const i=n.p1.x,o=n.p1.y,l=-bp(n.p2.y-o,n.p2.x-i),a=function(u){return{x:(u.x-i)*rl(l)-(u.y-o)*sd(l),y:(u.x-i)*sd(l)+(u.y-o)*rl(l)}};return r.map(a)},roots:function(r,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const i=r.length-1,o=cn.align(r,n),l=function(N){return 0<=N&&N<=1};if(i===2){const N=o[0].y,B=o[1].y,H=o[2].y,q=N-2*B+H;if(q!==0){const le=-nc(B*B-N*H),ne=-N+B,D=-(le+ne)/q,O=-(-le+ne)/q;return[D,O].filter(l)}else if(B!==H&&q===0)return[(2*B-H)/(2*B-2*H)].filter(l);return[]}const a=o[0].y,u=o[1].y,h=o[2].y,f=o[3].y;let d=-a+3*u-3*h+f,m=3*a-6*u+3*h,g=-3*a+3*u,x=a;if(cn.approximately(d,0)){if(cn.approximately(m,0))return cn.approximately(g,0)?[]:[-x/g].filter(l);const N=nc(g*g-4*m*x),B=2*m;return[(N-g)/B,(-g-N)/B].filter(l)}m/=d,g/=d,x/=d;const v=(3*g-m*m)/3,A=v/3,_=(2*m*m*m-9*m*g+27*x)/27,E=_/2,w=E*E+A*A*A;let S,T,R,L,I;if(w<0){const N=-v/3,B=N*N*N,H=nc(B),q=-_/(2*H),le=q<-1?-1:q>1?1:q,ne=zee(le),D=Ep(H),O=2*D;return R=O*rl(ne/3)-m/3,L=O*rl((ne+u0)/3)-m/3,I=O*rl((ne+2*u0)/3)-m/3,[R,L,I].filter(l)}else{if(w===0)return S=E<0?Ep(-E):-Ep(E),R=2*S-m/3,L=-S-m/3,[R,L].filter(l);{const N=nc(w);return S=Ep(-E+N),T=Ep(E+N),[S-T-m/3].filter(l)}}},droots:function(r){if(r.length===3){const n=r[0],i=r[1],o=r[2],l=n-2*i+o;if(l!==0){const a=-nc(i*i-n*o),u=-n+i,h=-(a+u)/l,f=-(-a+u)/l;return[h,f]}else if(i!==o&&l===0)return[(2*i-o)/(2*(i-o))];return[]}if(r.length===2){const n=r[0],i=r[1];return n!==i?[n/(n-i)]:[]}return[]},curvature:function(r,n,i,o,l){let a,u,h,f,d=0,m=0;const g=cn.compute(r,n),x=cn.compute(r,i),v=g.x*g.x+g.y*g.y;if(o?(a=nc(go(g.y*x.z-x.y*g.z,2)+go(g.z*x.x-x.z*g.x,2)+go(g.x*x.y-x.x*g.y,2)),u=go(v+g.z*g.z,3/2)):(a=g.x*x.y-g.y*x.x,u=go(v,3/2)),a===0||u===0)return{k:0,r:0};if(d=a/u,m=u/a,!l){const A=cn.curvature(r-.001,n,i,o,!0).k,_=cn.curvature(r+.001,n,i,o,!0).k;f=(_-d+(d-A))/2,h=(_p(_-d)+_p(d-A))/2}return{k:d,r:m,dk:f,adk:h}},inflections:function(r){if(r.length<4)return[];const n=cn.align(r,{p1:r[0],p2:r.slice(-1)[0]}),i=n[2].x*n[1].y,o=n[3].x*n[1].y,l=n[1].x*n[2].y,a=n[3].x*n[2].y,u=18*(-3*i+2*o+3*l-a),h=18*(3*i-o-3*l),f=18*(l-i);if(cn.approximately(u,0)){if(!cn.approximately(h,0)){let x=-f/h;if(0<=x&&x<=1)return[x]}return[]}const d=2*u;if(cn.approximately(d,0))return[];const m=h*h-4*u*f;if(m<0)return[];const g=Math.sqrt(m);return[(g-h)/d,-(h+g)/d].filter(function(x){return 0<=x&&x<=1})},bboxoverlap:function(r,n){const i=["x","y"],o=i.length;for(let l=0,a,u,h,f;l<o;l++)if(a=i[l],u=r[a].mid,h=n[a].mid,f=(r[a].size+n[a].size)/2,_p(u-h)>=f)return!1;return!0},expandbox:function(r,n){n.x.min<r.x.min&&(r.x.min=n.x.min),n.y.min<r.y.min&&(r.y.min=n.y.min),n.z&&n.z.min<r.z.min&&(r.z.min=n.z.min),n.x.max>r.x.max&&(r.x.max=n.x.max),n.y.max>r.y.max&&(r.y.max=n.y.max),n.z&&n.z.max>r.z.max&&(r.z.max=n.z.max),r.x.mid=(r.x.min+r.x.max)/2,r.y.mid=(r.y.min+r.y.max)/2,r.z&&(r.z.mid=(r.z.min+r.z.max)/2),r.x.size=r.x.max-r.x.min,r.y.size=r.y.max-r.y.min,r.z&&(r.z.size=r.z.max-r.z.min)},pairiteration:function(r,n,i){const o=r.bbox(),l=n.bbox(),a=1e5,u=i||.5;if(o.x.size+o.y.size<u&&l.x.size+l.y.size<u)return[(a*(r._t1+r._t2)/2|0)/a+"/"+(a*(n._t1+n._t2)/2|0)/a];let h=r.split(.5),f=n.split(.5),d=[{left:h.left,right:f.left},{left:h.left,right:f.right},{left:h.right,right:f.right},{left:h.right,right:f.left}];d=d.filter(function(g){return cn.bboxoverlap(g.left.bbox(),g.right.bbox())});let m=[];return d.length===0||(d.forEach(function(g){m=m.concat(cn.pairiteration(g.left,g.right,u))}),m=m.filter(function(g,x){return m.indexOf(g)===x})),m},getccenter:function(r,n,i){const o=n.x-r.x,l=n.y-r.y,a=i.x-n.x,u=i.y-n.y,h=o*rl(ic)-l*sd(ic),f=o*sd(ic)+l*rl(ic),d=a*rl(ic)-u*sd(ic),m=a*sd(ic)+u*rl(ic),g=(r.x+n.x)/2,x=(r.y+n.y)/2,v=(n.x+i.x)/2,A=(n.y+i.y)/2,_=g+h,E=x+f,w=v+d,S=A+m,T=cn.lli8(g,x,_,E,v,A,w,S),R=cn.dist(T,r);let L=bp(r.y-T.y,r.x-T.x),I=bp(n.y-T.y,n.x-T.x),N=bp(i.y-T.y,i.x-T.x),B;return L<N?((L>I||I>N)&&(L+=u0),L>N&&(B=N,N=L,L=B)):N<I&&I<L?(B=N,N=L,L=B):N+=u0,T.s=L,T.e=N,T.r=R,T},numberSort:function(r,n){return r-n}};class Yp{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return cn.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,i){return n+i})}curve(n){return this.curves[n]}bbox(){const n=this.curves;for(var i=n[0].bbox(),o=1;o<n.length;o++)cn.expandbox(i,n[o].bbox());return i}offset(n){const i=[];return this.curves.forEach(function(o){i.push(...o.offset(n))}),new Yp(i)}}const{abs:Ap,min:eL,max:tL,cos:Vee,sin:Wee,acos:jee,sqrt:wp}=Math,$ee=Math.PI;class fr{constructor(n){let i=n&&n.forEach?n:Array.from(arguments).slice(),o=!1;if(typeof i[0]=="object"){o=i.length;const v=[];i.forEach(function(A){["x","y","z"].forEach(function(_){typeof A[_]<"u"&&v.push(A[_])})}),i=v}let l=!1;const a=i.length;if(o){if(o>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");l=!0}}else if(a!==6&&a!==8&&a!==9&&a!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const u=this._3d=!l&&(a===9||a===12)||n&&n[0]&&typeof n[0].z<"u",h=this.points=[];for(let v=0,A=u?3:2;v<a;v+=A){var f={x:i[v],y:i[v+1]};u&&(f.z=i[v+2]),h.push(f)}const d=this.order=h.length-1,m=this.dims=["x","y"];u&&m.push("z"),this.dimlen=m.length;const g=cn.align(h,{p1:h[0],p2:h[d]}),x=cn.dist(h[0],h[d]);this._linear=g.reduce((v,A)=>v+Ap(A.y),0)<x/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,i,o,l){if(typeof l>"u"&&(l=.5),l===0)return new fr(i,i,o);if(l===1)return new fr(n,i,i);const a=fr.getABC(2,n,i,o,l);return new fr(n,a.A,o)}static cubicFromPoints(n,i,o,l,a){typeof l>"u"&&(l=.5);const u=fr.getABC(3,n,i,o,l);typeof a>"u"&&(a=cn.dist(i,u.C));const h=a*(1-l)/l,f=cn.dist(n,o),d=(o.x-n.x)/f,m=(o.y-n.y)/f,g=a*d,x=a*m,v=h*d,A=h*m,_={x:i.x-g,y:i.y-x},E={x:i.x+v,y:i.y+A},w=u.A,S={x:w.x+(_.x-w.x)/(1-l),y:w.y+(_.y-w.y)/(1-l)},T={x:w.x+(E.x-w.x)/l,y:w.y+(E.y-w.y)/l},R={x:n.x+(S.x-n.x)/l,y:n.y+(S.y-n.y)/l},L={x:o.x+(T.x-o.x)/(1-l),y:o.y+(T.y-o.y)/(1-l)};return new fr(n,R,L,o)}static getUtils(){return cn}getUtils(){return fr.getUtils()}static get PolyBezier(){return Yp}valueOf(){return this.toString()}toString(){return cn.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const n=this.points,i=n[0].x,o=n[0].y,l=["M",i,o,this.order===2?"Q":"C"];for(let a=1,u=n.length;a<u;a++)l.push(n[a].x),l.push(n[a].y);return l.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){const n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,i){return""+i+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=cn.derive(this.points,this._3d),this.computedirection()}computedirection(){const n=this.points,i=cn.angle(n[0],n[this.order],n[1]);this.clockwise=i>0}length(){return cn.length(this.derivative.bind(this))}static getABC(n=2,i,o,l,a=.5){const u=cn.projectionratio(a,n),h=1-u,f={x:u*i.x+h*l.x,y:u*i.y+h*l.y},d=cn.abcratio(a,n);return{A:{x:o.x+(o.x-f.x)/d,y:o.y+(o.y-f.y)/d},B:o,C:f,S:i,E:l}}getABC(n,i){i=i||this.get(n);let o=this.points[0],l=this.points[this.order];return fr.getABC(this.order,o,i,l,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n)return this._lut;this._lut=[],n++,this._lut=[];for(let i=0,o,l;i<n;i++)l=i/(n-1),o=this.compute(l),o.t=l,this._lut.push(o);return this._lut}on(n,i){i=i||5;const o=this.getLUT(),l=[];for(let a=0,u,h=0;a<o.length;a++)u=o[a],cn.dist(u,n)<i&&(l.push(u),h+=a/o.length);return l.length?t/=l.length:!1}project(n){const i=this.getLUT(),o=i.length-1,l=cn.closest(i,n),a=l.mpos,u=(a-1)/o,h=(a+1)/o,f=.1/o;let d=l.mdist,m=u,g=m,x;d+=1;for(let v;m<h+f;m+=f)x=this.compute(m),v=cn.dist(n,x),v<d&&(d=v,g=m);return g=g<0?0:g>1?1:g,x=this.compute(g),x.t=g,x.d=d,x}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?cn.computeWithRatios(n,this.points,this.ratios,this._3d):cn.compute(n,this.points,this._3d,this.ratios)}raise(){const n=this.points,i=[n[0]],o=n.length;for(let l=1,a,u;l<o;l++)a=n[l],u=n[l-1],i[l]={x:(o-l)/o*a.x+l/o*u.x,y:(o-l)/o*a.y+l/o*u.y};return i[o]=n[o-1],new fr(i)}derivative(n){return cn.compute(n,this.dpoints[0],this._3d)}dderivative(n){return cn.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new fr(cn.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return cn.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return cn.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){const i=this.derivative(n),o=wp(i.x*i.x+i.y*i.y);return{t:n,x:-i.y/o,y:i.x/o}}__normal3(n){const i=this.derivative(n),o=this.derivative(n+.01),l=wp(i.x*i.x+i.y*i.y+i.z*i.z),a=wp(o.x*o.x+o.y*o.y+o.z*o.z);i.x/=l,i.y/=l,i.z/=l,o.x/=a,o.y/=a,o.z/=a;const u={x:o.y*i.z-o.z*i.y,y:o.z*i.x-o.x*i.z,z:o.x*i.y-o.y*i.x},h=wp(u.x*u.x+u.y*u.y+u.z*u.z);u.x/=h,u.y/=h,u.z/=h;const f=[u.x*u.x,u.x*u.y-u.z,u.x*u.z+u.y,u.x*u.y+u.z,u.y*u.y,u.y*u.z-u.x,u.x*u.z-u.y,u.y*u.z+u.x,u.z*u.z];return{t:n,x:f[0]*i.x+f[1]*i.y+f[2]*i.z,y:f[3]*i.x+f[4]*i.y+f[5]*i.z,z:f[6]*i.x+f[7]*i.y+f[8]*i.z}}hull(n){let i=this.points,o=[],l=[],a=0;for(l[a++]=i[0],l[a++]=i[1],l[a++]=i[2],this.order===3&&(l[a++]=i[3]);i.length>1;){o=[];for(let u=0,h,f=i.length-1;u<f;u++)h=cn.lerp(n,i[u],i[u+1]),l[a++]=h,o.push(h);i=o}return l}split(n,i){if(n===0&&!!i)return this.split(i).left;if(i===1)return this.split(n).right;const o=this.hull(n),l={left:this.order===2?new fr([o[0],o[3],o[5]]):new fr([o[0],o[4],o[7],o[9]]),right:this.order===2?new fr([o[5],o[4],o[2]]):new fr([o[9],o[8],o[6],o[3]]),span:o};return l.left._t1=cn.map(0,0,1,this._t1,this._t2),l.left._t2=cn.map(n,0,1,this._t1,this._t2),l.right._t1=cn.map(n,0,1,this._t1,this._t2),l.right._t2=cn.map(1,0,1,this._t1,this._t2),i?(i=cn.map(i,n,1,0,1),l.right.split(i).left):l}extrema(){const n={};let i=[];return this.dims.forEach(function(o){let l=function(u){return u[o]},a=this.dpoints[0].map(l);n[o]=cn.droots(a),this.order===3&&(a=this.dpoints[1].map(l),n[o]=n[o].concat(cn.droots(a))),n[o]=n[o].filter(function(u){return u>=0&&u<=1}),i=i.concat(n[o].sort(cn.numberSort))}.bind(this)),n.values=i.sort(cn.numberSort).filter(function(o,l){return i.indexOf(o)===l}),n}bbox(){const n=this.extrema(),i={};return this.dims.forEach(function(o){i[o]=cn.getminmax(this,o,n[o])}.bind(this)),i}overlaps(n){const i=this.bbox(),o=n.bbox();return cn.bboxoverlap(i,o)}offset(n,i){if(typeof i<"u"){const o=this.get(n),l=this.normal(n),a={c:o,n:l,x:o.x+l.x*i,y:o.y+l.y*i};return this._3d&&(a.z=o.z+l.z*i),a}if(this._linear){const o=this.normal(0),l=this.points.map(function(a){const u={x:a.x+n*o.x,y:a.y+n*o.y};return a.z&&o.z&&(u.z=a.z+n*o.z),u});return[new fr(l)]}return this.reduce().map(function(o){return o._linear?o.offset(n)[0]:o.scale(n)})}simple(){if(this.order===3){const l=cn.angle(this.points[0],this.points[3],this.points[1]),a=cn.angle(this.points[0],this.points[3],this.points[2]);if(l>0&&a<0||l<0&&a>0)return!1}const n=this.normal(0),i=this.normal(1);let o=n.x*i.x+n.y*i.y;return this._3d&&(o+=n.z*i.z),Ap(jee(o))<$ee/3}reduce(){let n,i=0,o=0,l=.01,a,u=[],h=[],f=this.extrema().values;for(f.indexOf(0)===-1&&(f=[0].concat(f)),f.indexOf(1)===-1&&f.push(1),i=f[0],n=1;n<f.length;n++)o=f[n],a=this.split(i,o),a._t1=i,a._t2=o,u.push(a),i=o;return u.forEach(function(d){for(i=0,o=0;o<=1;)for(o=i+l;o<=1+l;o+=l)if(a=d.split(i,o),!a.simple()){if(o-=l,Ap(i-o)<l)return[];a=d.split(i,o),a._t1=cn.map(i,0,1,d._t1,d._t2),a._t2=cn.map(o,0,1,d._t1,d._t2),h.push(a),i=o;break}i<1&&(a=d.split(i,1),a._t1=cn.map(i,0,1,d._t1,d._t2),a._t2=d._t2,h.push(a))}),h}translate(n,i,o){o=typeof o=="number"?o:i;const l=this.order;let a=this.points.map((u,h)=>(1-h/l)*i+h/l*o);return new fr(this.points.map((u,h)=>({x:u.x+n.x*a[h],y:u.y+n.y*a[h]})))}scale(n){const i=this.order;let o=!1;if(typeof n=="function"&&(o=n),o&&i===2)return this.raise().scale(o);const l=this.clockwise,a=this.points;if(this._linear)return this.translate(this.normal(0),o?o(0):n,o?o(1):n);const u=o?o(0):n,h=o?o(1):n,f=[this.offset(0,10),this.offset(1,10)],d=[],m=cn.lli4(f[0],f[0].c,f[1],f[1].c);if(!m)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(g){const x=d[g*i]=cn.copy(a[g*i]);x.x+=(g?h:u)*f[g].n.x,x.y+=(g?h:u)*f[g].n.y}),o?([0,1].forEach(function(g){if(!(i===2&&!!g)){var x=a[g+1],v={x:x.x-m.x,y:x.y-m.y},A=o?o((g+1)/i):n;o&&!l&&(A=-A);var _=wp(v.x*v.x+v.y*v.y);v.x/=_,v.y/=_,d[g+1]={x:x.x+A*v.x,y:x.y+A*v.y}}}),new fr(d)):([0,1].forEach(g=>{if(i===2&&!!g)return;const x=d[g*i],v=this.derivative(g),A={x:x.x+v.x,y:x.y+v.y};d[g+1]=cn.lli4(x,A,m,a[g+1])}),new fr(d))}outline(n,i,o,l){if(i=i===void 0?n:i,this._linear){const L=this.normal(0),I=this.points[0],N=this.points[this.points.length-1];let B,H,q;o===void 0&&(o=n,l=i),B={x:I.x+L.x*n,y:I.y+L.y*n},q={x:N.x+L.x*o,y:N.y+L.y*o},H={x:(B.x+q.x)/2,y:(B.y+q.y)/2};const le=[B,H,q];B={x:I.x-L.x*i,y:I.y-L.y*i},q={x:N.x-L.x*l,y:N.y-L.y*l},H={x:(B.x+q.x)/2,y:(B.y+q.y)/2};const ne=[q,H,B],D=cn.makeline(ne[2],le[0]),O=cn.makeline(le[2],ne[0]),k=[D,new fr(le),O,new fr(ne)];return new Yp(k)}const a=this.reduce(),u=a.length,h=[];let f=[],d,m=0,g=this.length();const x=typeof o<"u"&&typeof l<"u";function v(L,I,N,B,H){return function(q){const le=B/N,ne=(B+H)/N,D=I-L;return cn.map(q,0,1,L+le*D,L+ne*D)}}a.forEach(function(L){const I=L.length();x?(h.push(L.scale(v(n,o,g,m,I))),f.push(L.scale(v(-i,-l,g,m,I)))):(h.push(L.scale(n)),f.push(L.scale(-i))),m+=I}),f=f.map(function(L){return d=L.points,d[3]?L.points=[d[3],d[2],d[1],d[0]]:L.points=[d[2],d[1],d[0]],L}).reverse();const A=h[0].points[0],_=h[u-1].points[h[u-1].points.length-1],E=f[u-1].points[f[u-1].points.length-1],w=f[0].points[0],S=cn.makeline(E,A),T=cn.makeline(_,w),R=[S].concat(h).concat([T]).concat(f);return new Yp(R)}outlineshapes(n,i,o){i=i||n;const l=this.outline(n,i).curves,a=[];for(let u=1,h=l.length;u<h/2;u++){const f=cn.makeshape(l[u],l[h-u],o);f.startcap.virtual=u>1,f.endcap.virtual=u<h/2-1,a.push(f)}return a}intersects(n,i){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof fr&&(n=n.reduce()),this.curveintersects(this.reduce(),n,i)):this.selfintersects(i)}lineIntersects(n){const i=eL(n.p1.x,n.p2.x),o=eL(n.p1.y,n.p2.y),l=tL(n.p1.x,n.p2.x),a=tL(n.p1.y,n.p2.y);return cn.roots(this.points,n).filter(u=>{var h=this.get(u);return cn.between(h.x,i,l)&&cn.between(h.y,o,a)})}selfintersects(n){const i=this.reduce(),o=i.length-2,l=[];for(let a=0,u,h,f;a<o;a++)h=i.slice(a,a+1),f=i.slice(a+2),u=this.curveintersects(h,f,n),l.push(...u);return l}curveintersects(n,i,o){const l=[];n.forEach(function(u){i.forEach(function(h){u.overlaps(h)&&l.push({left:u,right:h})})});let a=[];return l.forEach(function(u){const h=cn.pairiteration(u.left,u.right,o);h.length>0&&(a=a.concat(h))}),a}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,i,o,l){const a=(l-o)/4,u=this.get(o+a),h=this.get(l-a),f=cn.dist(n,i),d=cn.dist(n,u),m=cn.dist(n,h);return Ap(d-f)+Ap(m-f)}_iterate(n,i){let o=0,l=1,a;do{a=0,l=1;let u=this.get(o),h,f,d,m,g=!1,x=!1,v,A=l,_=1;do if(x=g,m=d,A=(o+l)/2,h=this.get(A),f=this.get(l),d=cn.getccenter(u,h,f),d.interval={start:o,end:l},g=this._error(d,u,o,l)<=n,v=x&&!g,v||(_=l),g){if(l>=1){if(d.interval.end=_=1,m=d,l>1){let w={x:d.x+d.r*Vee(d.e),y:d.y+d.r*Wee(d.e)};d.e+=cn.angle({x:d.x,y:d.y},w,this.get(1))}break}l=l+(l-o)/2}else l=A;while(!v&&a++<100);if(a>=100)break;m=m||d,i.push(m),o=_}while(l<1);return i}}function Xee(r,n){n===void 0&&(n={});var i=n.insertAt;if(!(!r||typeof document>"u")){var o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",i==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=r:l.appendChild(document.createTextNode(r))}}var qee=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .graph-tooltip {
  position: absolute;
  top: 0;
  font-family: sans-serif;
  font-size: 16px;
  padding: 4px;
  border-radius: 3px;
  color: #eee;
  background: rgba(0,0,0,0.65);
  visibility: hidden; /* by default */
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;Xee(qee);function nL(r,n){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(r);n&&(o=o.filter(function(l){return Object.getOwnPropertyDescriptor(r,l).enumerable})),i.push.apply(i,o)}return i}function od(r){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?nL(Object(i),!0).forEach(function(o){Tm(r,o,i[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):nL(Object(i)).forEach(function(o){Object.defineProperty(r,o,Object.getOwnPropertyDescriptor(i,o))})}return r}function mA(r){return mA=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},mA(r)}function Tm(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}function gA(r,n){return gA=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,l){return o.__proto__=l,o},gA(r,n)}function Yee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Kp(r,n,i){return Yee()?Kp=Reflect.construct.bind():Kp=function(l,a,u){var h=[null];h.push.apply(h,a);var f=Function.bind.apply(l,h),d=new f;return u&&gA(d,u.prototype),d},Kp.apply(null,arguments)}function Qp(r,n){return Qee(r)||Jee(r,n)||ek(r,n)||tte()}function bo(r){return Kee(r)||Zee(r)||ek(r)||ete()}function Kee(r){if(Array.isArray(r))return vA(r)}function Qee(r){if(Array.isArray(r))return r}function Zee(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function Jee(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var o=[],l=!0,a=!1,u,h;try{for(i=i.call(r);!(l=(u=i.next()).done)&&(o.push(u.value),!(n&&o.length===n));l=!0);}catch(f){a=!0,h=f}finally{try{!l&&i.return!=null&&i.return()}finally{if(a)throw h}}return o}}function ek(r,n){if(!!r){if(typeof r=="string")return vA(r,n);var i=Object.prototype.toString.call(r).slice(8,-1);if(i==="Object"&&r.constructor&&(i=r.constructor.name),i==="Map"||i==="Set")return Array.from(r);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return vA(r,n)}}function vA(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,o=new Array(n);i<n;i++)o[i]=r[i];return o}function ete(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var nte=$w(mI);function iL(r,n,i){!n||typeof i!="string"||r.filter(function(o){return!o[i]}).forEach(function(o){o[i]=nte(n(o))})}function ite(r,n){var i=r.nodes,o=r.links,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=l.nodeFilter,u=a===void 0?function(){return!0}:a,h=l.onLoopError,f=h===void 0?function(v){throw"Invalid DAG structure! Found cycle in node path: ".concat(v.join(" -> "),".")}:h,d={};i.forEach(function(v){return d[n(v)]={data:v,out:[],depth:-1,skip:!u(v)}}),o.forEach(function(v){var A=v.source,_=v.target,E=R(A),w=R(_);if(!d.hasOwnProperty(E))throw"Missing source node with id: ".concat(E);if(!d.hasOwnProperty(w))throw"Missing target node with id: ".concat(w);var S=d[E],T=d[w];S.out.push(T);function R(L){return mA(L)==="object"?n(L):L}});var m=[];x(Object.values(d));var g=Object.assign.apply(Object,[{}].concat(bo(Object.entries(d).filter(function(v){var A=Qp(v,2),_=A[1];return!_.skip}).map(function(v){var A=Qp(v,2),_=A[0],E=A[1];return Tm({},_,E.depth)}))));return g;function x(v){for(var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],_=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,E=0,w=v.length;E<w;E++){var S=v[E];if(A.indexOf(S)!==-1){var T=function(){var R=[].concat(bo(A.slice(A.indexOf(S))),[S]).map(function(L){return n(L.data)});return m.some(function(L){return L.length===R.length&&L.every(function(I,N){return I===R[N]})})||(m.push(R),f(R)),"continue"}();if(T==="continue")continue}_>S.depth&&(S.depth=_,x(S.out,[].concat(bo(A),[S]),_+(S.skip?0:1)))}}}var rte=2,gs=function(n,i){return i.onNeedsRedraw&&i.onNeedsRedraw()},Ay=Yu({props:{graphData:{default:{nodes:[],links:[]},onChange:function(n,i){i.engineRunning=!1}},dagMode:{onChange:function(n,i){!n&&(i.graphData.nodes||[]).forEach(function(o){return o.fx=o.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:gs},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:gs},nodeColor:{default:"color",triggerUpdate:!1,onChange:gs},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:gs},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:gs},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:gs},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:gs},linkColor:{default:"color",triggerUpdate:!1,onChange:gs},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:gs},linkWidth:{default:1,triggerUpdate:!1,onChange:gs},linkCurvature:{default:0,triggerUpdate:!1,onChange:gs},linkCanvasObject:{triggerUpdate:!1,onChange:gs},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:gs},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:gs},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:gs},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:gs},linkDirectionalParticles:{default:0},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,i){i.forceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,i){i.forceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,i){i.forceLayout.velocityDecay(n)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(n,i,o){return o===void 0?n.forceLayout.force(i):(n.forceLayout.force(i,o),this)},d3ReheatSimulation:function(n){return n.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},isEngineRunning:function(n){return!!n.engineRunning},tickFrame:function(n){return!n.isShadow&&i(),l(),!n.isShadow&&a(),!n.isShadow&&u(),o(),this;function i(){n.engineRunning&&(++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.forceLayout.tick(),n.onEngineTick()))}function o(){var h=Wn(n.nodeVisibility),f=Wn(n.nodeVal),d=Wn(n.nodeColor),m=Wn(n.nodeCanvasObjectMode),g=n.ctx,x=n.isShadow/n.globalScale,v=n.graphData.nodes.filter(h);g.save(),v.forEach(function(A){var _=m(A);if(n.nodeCanvasObject&&(_==="before"||_==="replace")&&(n.nodeCanvasObject(A,g,n.globalScale),_==="replace")){g.restore();return}var E=Math.sqrt(Math.max(0,f(A)||1))*n.nodeRelSize+x;g.beginPath(),g.arc(A.x,A.y,E,0,2*Math.PI,!1),g.fillStyle=d(A)||"rgba(31, 120, 180, 0.92)",g.fill(),n.nodeCanvasObject&&_==="after"&&n.nodeCanvasObject(A,n.ctx,n.globalScale)}),g.restore()}function l(){var h=Wn(n.linkVisibility),f=Wn(n.linkColor),d=Wn(n.linkWidth),m=Wn(n.linkLineDash),g=Wn(n.linkCurvature),x=Wn(n.linkCanvasObjectMode),v=n.ctx,A=n.isShadow*2,_=n.graphData.links.filter(h);_.forEach(I);var E=[],w=[],S=_;if(n.linkCanvasObject){var T=[],R=[];_.forEach(function(N){return({before:E,after:w,replace:T}[x(N)]||R).push(N)}),S=[].concat(bo(E),w,R),E=E.concat(T)}v.save(),E.forEach(function(N){return n.linkCanvasObject(N,v,n.globalScale)}),v.restore();var L=YE(S,[f,d,m]);v.save(),Object.entries(L).forEach(function(N){var B=Qp(N,2),H=B[0],q=B[1],le=!H||H==="undefined"?"rgba(0,0,0,0.15)":H;Object.entries(q).forEach(function(ne){var D=Qp(ne,2),O=D[0],k=D[1],z=(O||1)/n.globalScale+A;Object.entries(k).forEach(function(X){var Z=Qp(X,2);Z[0];var ie=Z[1],se=m(ie[0]);v.beginPath(),ie.forEach(function(ue){var ye=ue.source,Ce=ue.target;if(!(!ye||!Ce||!ye.hasOwnProperty("x")||!Ce.hasOwnProperty("x"))){v.moveTo(ye.x,ye.y);var ke=ue.__controlPoints;ke?v[ke.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(v,bo(ke).concat([Ce.x,Ce.y])):v.lineTo(Ce.x,Ce.y)}}),v.strokeStyle=le,v.lineWidth=z,v.setLineDash(se||[]),v.stroke()})})}),v.restore(),v.save(),w.forEach(function(N){return n.linkCanvasObject(N,v,n.globalScale)}),v.restore();function I(N){var B=g(N);if(!B){N.__controlPoints=null;return}var H=N.source,q=N.target;if(!(!H||!q||!H.hasOwnProperty("x")||!q.hasOwnProperty("x"))){var le=Math.sqrt(Math.pow(q.x-H.x,2)+Math.pow(q.y-H.y,2));if(le>0){var ne=Math.atan2(q.y-H.y,q.x-H.x),D=le*B,O={x:(H.x+q.x)/2+D*Math.cos(ne-Math.PI/2),y:(H.y+q.y)/2+D*Math.sin(ne-Math.PI/2)};N.__controlPoints=[O.x,O.y]}else{var k=B*70;N.__controlPoints=[q.x,q.y-k,q.x+k,q.y]}}}}function a(){var h=1.6,f=.2,d=Wn(n.linkDirectionalArrowLength),m=Wn(n.linkDirectionalArrowRelPos),g=Wn(n.linkVisibility),x=Wn(n.linkDirectionalArrowColor||n.linkColor),v=Wn(n.nodeVal),A=n.ctx;A.save(),n.graphData.links.filter(g).forEach(function(_){var E=d(_);if(!(!E||E<0)){var w=_.source,S=_.target;if(!(!w||!S||!w.hasOwnProperty("x")||!S.hasOwnProperty("x"))){var T=Math.sqrt(Math.max(0,v(w)||1))*n.nodeRelSize,R=Math.sqrt(Math.max(0,v(S)||1))*n.nodeRelSize,L=Math.min(1,Math.max(0,m(_))),I=x(_)||"rgba(0,0,0,0.28)",N=E/h/2,B=_.__controlPoints&&Kp(fr,[w.x,w.y].concat(bo(_.__controlPoints),[S.x,S.y])),H=B?function(z){return B.get(z)}:function(z){return{x:w.x+(S.x-w.x)*z||0,y:w.y+(S.y-w.y)*z||0}},q=B?B.length():Math.sqrt(Math.pow(S.x-w.x,2)+Math.pow(S.y-w.y,2)),le=T+E+(q-T-R-E)*L,ne=H(le/q),D=H((le-E)/q),O=H((le-E*(1-f))/q),k=Math.atan2(ne.y-D.y,ne.x-D.x)-Math.PI/2;A.beginPath(),A.moveTo(ne.x,ne.y),A.lineTo(D.x+N*Math.cos(k),D.y+N*Math.sin(k)),A.lineTo(O.x,O.y),A.lineTo(D.x-N*Math.cos(k),D.y-N*Math.sin(k)),A.fillStyle=I,A.fill()}}}),A.restore()}function u(){var h=Wn(n.linkDirectionalParticles),f=Wn(n.linkDirectionalParticleSpeed),d=Wn(n.linkDirectionalParticleWidth),m=Wn(n.linkVisibility),g=Wn(n.linkDirectionalParticleColor||n.linkColor),x=n.ctx;x.save(),n.graphData.links.filter(m).forEach(function(v){var A=h(v);if(!(!v.hasOwnProperty("__photons")||!v.__photons.length)){var _=v.source,E=v.target;if(!(!_||!E||!_.hasOwnProperty("x")||!E.hasOwnProperty("x"))){var w=f(v),S=v.__photons||[],T=Math.max(0,d(v)/2)/Math.sqrt(n.globalScale),R=g(v)||"rgba(0,0,0,0.28)";x.fillStyle=R;var L=v.__controlPoints?Kp(fr,[_.x,_.y].concat(bo(v.__controlPoints),[E.x,E.y])):null,I=0,N=!1;S.forEach(function(B){var H=!!B.__singleHop;if(B.hasOwnProperty("__progressRatio")||(B.__progressRatio=H?0:I/A),!H&&I++,B.__progressRatio+=w,B.__progressRatio>=1)if(!H)B.__progressRatio=B.__progressRatio%1;else{N=!0;return}var q=B.__progressRatio,le=L?L.get(q):{x:_.x+(E.x-_.x)*q||0,y:_.y+(E.y-_.y)*q||0};x.beginPath(),x.arc(le.x,le.y,T,0,2*Math.PI,!1),x.fill()}),N&&(v.__photons=v.__photons.filter(function(B){return!B.__singleHop||B.__progressRatio<=1}))}}}),x.restore()}},emitParticle:function(n,i){return i&&(!i.__photons&&(i.__photons=[]),i.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:zO().force("link",FO()).force("charge",HO()).force("center",LO()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,i){i.ctx=n},update:function(n){if(n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&iL(n.graphData.nodes,Wn(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&iL(n.graphData.links,Wn(n.linkAutoColorBy),n.linkColor),n.graphData.links.forEach(function(g){g.source=g[n.linkSource],g.target=g[n.linkTarget]}),!n.isShadow){var i=Wn(n.linkDirectionalParticles);n.graphData.links.forEach(function(g){var x=Math.round(Math.abs(i(g)));x?g.__photons=bo(Array(x)).map(function(){return{}}):delete g.__photons})}n.forceLayout.stop().alpha(1).nodes(n.graphData.nodes);var o=n.forceLayout.force("link");o&&o.id(function(g){return g[n.nodeId]}).links(n.graphData.links);var l=n.dagMode&&ite(n.graphData,function(g){return g[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),a=Math.max.apply(Math,bo(Object.values(l||[]))),u=n.dagLevelDistance||n.graphData.nodes.length/(a||1)*rte*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(n.dagMode){var h=function(x,v){return function(A){return x?(l[A[n.nodeId]]-a/2)*u*(v?-1:1):void 0}},f=h(["lr","rl"].indexOf(n.dagMode)!==-1,n.dagMode==="rl"),d=h(["td","bu"].indexOf(n.dagMode)!==-1,n.dagMode==="bu");n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(g){g.fx=f(g),g.fy=d(g)})}n.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?GO(function(g){var x=l[g[n.nodeId]]||-1;return(n.dagMode==="radialin"?a-x:x)*u}).strength(function(g){return n.dagNodeFilter(g)?1:0}):null);for(var m=0;m<n.warmupTicks&&!(n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin);m++)n.forceLayout.tick();this.resetCountdown(),n.onFinishUpdate()}});function tk(r,n){var i=r instanceof Array?r:[r],o=new n;return{linkProp:function(a){return{default:o[a](),onChange:function(h,f){i.forEach(function(d){return f[d][a](h)})},triggerUpdate:!1}},linkMethod:function(a){return function(u){for(var h=arguments.length,f=new Array(h>1?h-1:0),d=1;d<h;d++)f[d-1]=arguments[d];var m=[];return i.forEach(function(g){var x=u[g],v=x[a].apply(x,f);v!==x&&m.push(v)}),m.length?m[0]:this}}}}var ste=800,ote=4,nk=tk("forceGraph",Ay),ate=tk(["forceGraph","shadowGraph"],Ay),lte=Object.assign.apply(Object,bo(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleWidth","linkDirectionalParticleColor","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(r){return Tm({},r,nk.linkProp(r))})).concat(bo(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(r){return Tm({},r,ate.linkProp(r))})))),cte=Object.assign.apply(Object,bo(["d3Force","d3ReheatSimulation","emitParticle"].map(function(r){return Tm({},r,nk.linkMethod(r))})));function A1(r){if(r.canvas){var n=r.canvas.width,i=r.canvas.height;n===300&&i===150&&(n=i=0);var o=window.devicePixelRatio;n/=o,i/=o,[r.canvas,r.shadowCanvas].forEach(function(a){a.style.width="".concat(r.width,"px"),a.style.height="".concat(r.height,"px"),a.width=r.width*o,a.height=r.height*o,!n&&!i&&a.getContext("2d").scale(o,o)});var l=ba(r.canvas).k;r.zoom.translateBy(r.zoom.__baseElem,(r.width-n)/2/l,(r.height-i)/2/l),r.needsRedraw=!0}}function ik(r){var n=window.devicePixelRatio;r.setTransform(n,0,0,n,0,0)}function rL(r,n,i){r.save(),ik(r),r.clearRect(0,0,n,i),r.restore()}var ute=Yu({props:od({width:{default:window.innerWidth,onChange:function(n,i){return A1(i)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(n,i){return A1(i)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,i){[{type:"Node",objs:n.nodes},{type:"Link",objs:n.links}].forEach(o),i.forceGraph.graphData(n),i.shadowGraph.graphData(n);function o(l){var a=l.type,u=l.objs;u.filter(function(h){if(!h.hasOwnProperty("__indexColor"))return!0;var f=i.colorTracker.lookup(h.__indexColor);return!f||!f.hasOwnProperty("d")||f.d!==h}).forEach(function(h){h.__indexColor=i.colorTracker.register({type:a,d:h})})}},triggerUpdate:!1},backgroundColor:{onChange:function(n,i){i.canvas&&n&&(i.canvas.style.background=n)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(n,i){i.shadowGraph.nodeCanvasObject(n?function(o,l,a){return n(o,o.__indexColor,l,a)}:null),i.flushShadowCanvas&&i.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(n,i){i.shadowGraph.linkCanvasObject(n?function(o,l,a){return n(o,o.__indexColor,l,a)}:null),i.flushShadowCanvas&&i.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(n,i){i.zoom.scaleExtent([n,i.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(n,i){i.zoom.scaleExtent([i.zoom.scaleExtent()[0],n])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(n,i){i.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},lte),aliases:{stopAnimation:"pauseAnimation"},methods:od({graph2ScreenCoords:function(n,i,o){var l=ba(n.canvas);return{x:i*l.k+l.x,y:o*l.k+l.y}},screen2GraphCoords:function(n,i,o){var l=ba(n.canvas);return{x:(i-l.x)/l.k,y:(o-l.y)/l.k}},centerAt:function(n,i,o,l){if(!n.canvas)return null;if(i!==void 0||o!==void 0){var a=Object.assign({},i!==void 0?{x:i}:{},o!==void 0?{y:o}:{});return l?new Eo.Tween(u()).to(a,l).easing(Eo.Easing.Quadratic.Out).onUpdate(h).start():h(a),this}return u();function u(){var f=ba(n.canvas);return{x:(n.width/2-f.x)/f.k,y:(n.height/2-f.y)/f.k}}function h(f){var d=f.x,m=f.y;n.zoom.translateTo(n.zoom.__baseElem,d===void 0?u().x:d,m===void 0?u().y:m),n.needsRedraw=!0}},zoom:function(n,i,o){if(!n.canvas)return null;if(i!==void 0)return o?new Eo.Tween({k:l()}).to({k:i},o).easing(Eo.Easing.Quadratic.Out).onUpdate(function(u){var h=u.k;return a(h)}).start():a(i),this;return l();function l(){return ba(n.canvas).k}function a(u){n.zoom.scaleTo(n.zoom.__baseElem,u),n.needsRedraw=!0}},zoomToFit:function(n){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,l=arguments.length,a=new Array(l>3?l-3:0),u=3;u<l;u++)a[u-3]=arguments[u];var h=this.getGraphBbox.apply(this,a);if(h){var f={x:(h.x[0]+h.x[1])/2,y:(h.y[0]+h.y[1])/2},d=Math.max(1e-12,Math.min(1e12,(n.width-o*2)/(h.x[1]-h.x[0]),(n.height-o*2)/(h.y[1]-h.y[0])));this.centerAt(f.x,f.y,i),this.zoom(d,i)}return this},getGraphBbox:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},o=Wn(n.nodeVal),l=function(h){return Math.sqrt(Math.max(0,o(h)||1))*n.nodeRelSize},a=n.graphData.nodes.filter(i).map(function(u){return{x:u.x,y:u.y,r:l(u)}});return a.length?{x:[XE(a,function(u){return u.x-u.r}),$E(a,function(u){return u.x+u.r})],y:[XE(a,function(u){return u.y-u.r}),$E(a,function(u){return u.y+u.r})]}:null},pauseAnimation:function(n){return n.animationFrameRequestId&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},cte),stateInit:function(){return{lastSetZoom:1,zoom:uee(),forceGraph:new Ay,shadowGraph:new Ay().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new Uee}},init:function(n,i){var o=this;n.innerHTML="";var l=document.createElement("div");l.classList.add("force-graph-container"),l.style.position="relative",n.appendChild(l),i.canvas=document.createElement("canvas"),i.backgroundColor&&(i.canvas.style.background=i.backgroundColor),l.appendChild(i.canvas),i.shadowCanvas=document.createElement("canvas");var a=i.canvas.getContext("2d"),u=i.shadowCanvas.getContext("2d"),h={x:-1e12,y:-1e12},f=function(){var x=null,v=window.devicePixelRatio,A=h.x>0&&h.y>0?u.getImageData(h.x*v,h.y*v,1,1):null;return A&&(x=i.colorTracker.lookup(A.data)),x};Qo(i.canvas).call(KZ().subject(function(){if(!i.enableNodeDrag)return null;var g=f();return g&&g.type==="Node"?g.d:null}).on("start",function(g){var x=g.subject;x.__initialDragPos={x:x.x,y:x.y,fx:x.fx,fy:x.fy},g.active||(x.fx=x.x,x.fy=x.y),i.canvas.classList.add("grabbable")}).on("drag",function(g){var x=g.subject,v=x.__initialDragPos,A=g,_=ba(i.canvas).k,E={x:v.x+(A.x-v.x)/_-x.x,y:v.y+(A.y-v.y)/_-x.y};["x","y"].forEach(function(w){return x["f".concat(w)]=x[w]=v[w]+(A[w]-v[w])/_}),i.forceGraph.d3AlphaTarget(.3).resetCountdown(),i.isPointerDragging=!0,x.__dragged=!0,i.onNodeDrag(x,E)}).on("end",function(g){var x=g.subject,v=x.__initialDragPos,A={x:x.x-v.x,y:x.y-v.y};v.fx===void 0&&(x.fx=void 0),v.fy===void 0&&(x.fy=void 0),delete x.__initialDragPos,i.forceGraph.d3AlphaTarget()&&i.forceGraph.d3AlphaTarget(0).resetCountdown(),i.canvas.classList.remove("grabbable"),i.isPointerDragging=!1,x.__dragged&&(delete x.__dragged,i.onNodeDragEnd(x,A))})),i.zoom(i.zoom.__baseElem=Qo(i.canvas)),i.zoom.__baseElem.on("dblclick.zoom",null),i.zoom.filter(function(g){return!g.button&&i.enableZoomPanInteraction&&(i.enableZoomInteraction||g.type!=="wheel")&&(i.enablePanInteraction||g.type==="wheel")}).on("zoom",function(g){var x=g.transform;[a,u].forEach(function(v){ik(v),v.translate(x.x,x.y),v.scale(x.k,x.k)}),i.onZoom&&i.onZoom(od(od({},x),o.centerAt())),i.needsRedraw=!0}).on("end",function(g){return i.onZoomEnd&&i.onZoomEnd(od(od({},g.transform),o.centerAt()))}),A1(i),i.forceGraph.onNeedsRedraw(function(){return i.needsRedraw=!0}).onFinishUpdate(function(){ba(i.canvas).k===i.lastSetZoom&&i.graphData.nodes.length&&(i.zoom.scaleTo(i.zoom.__baseElem,i.lastSetZoom=ote/Math.cbrt(i.graphData.nodes.length)),i.needsRedraw=!0)});var d=document.createElement("div");d.classList.add("graph-tooltip"),l.appendChild(d),["pointermove","pointerdown"].forEach(function(g){return l.addEventListener(g,function(x){g==="pointerdown"&&(i.isPointerPressed=!0,i.pointerDownEvent=x),!i.isPointerDragging&&x.type==="pointermove"&&i.onBackgroundClick&&(x.pressure>0||i.isPointerPressed)&&(x.pointerType!=="touch"||x.movementX===void 0||[x.movementX,x.movementY].some(function(_){return Math.abs(_)>1}))&&(i.isPointerDragging=!0);var v=A(l);h.x=x.pageX-v.left,h.y=x.pageY-v.top,d.style.top="".concat(h.y,"px"),d.style.left="".concat(h.x,"px"),d.style.transform="translate(-".concat(h.x/i.width*100,"%, ").concat(i.height-h.y<100?"calc(-100% - 8px)":"21px",")");function A(_){var E=_.getBoundingClientRect(),w=window.pageXOffset||document.documentElement.scrollLeft,S=window.pageYOffset||document.documentElement.scrollTop;return{top:E.top+S,left:E.left+w}}},{passive:!0})}),l.addEventListener("pointerup",function(g){if(i.isPointerPressed=!1,i.isPointerDragging){i.isPointerDragging=!1;return}var x=[g,i.pointerDownEvent];requestAnimationFrame(function(){if(g.button===0)if(i.hoverObj){var v=i["on".concat(i.hoverObj.type,"Click")];v&&v.apply(void 0,[i.hoverObj.d].concat(x))}else i.onBackgroundClick&&i.onBackgroundClick.apply(i,x);if(g.button===2)if(i.hoverObj){var A=i["on".concat(i.hoverObj.type,"RightClick")];A&&A.apply(void 0,[i.hoverObj.d].concat(x))}else i.onBackgroundRightClick&&i.onBackgroundRightClick.apply(i,x)})},{passive:!0}),l.addEventListener("contextmenu",function(g){return!i.onBackgroundRightClick&&!i.onNodeRightClick&&!i.onLinkRightClick?!0:(g.preventDefault(),!1)}),i.forceGraph(a),i.shadowGraph(u);var m=Cee(function(){rL(u,i.width,i.height),i.shadowGraph.linkWidth(function(x){return Wn(i.linkWidth)(x)+i.linkHoverPrecision});var g=ba(i.canvas);i.shadowGraph.globalScale(g.k).tickFrame()},ste);i.flushShadowCanvas=m.flush,(this._animationCycle=function g(){var x=!i.autoPauseRedraw||!!i.needsRedraw||i.forceGraph.isEngineRunning()||i.graphData.links.some(function(L){return L.__photons&&L.__photons.length});if(i.needsRedraw=!1,i.enablePointerInteraction){var v=i.isPointerDragging?null:f();if(v!==i.hoverObj){var A=i.hoverObj,_=A?A.type:null,E=v?v.type:null;if(_&&_!==E){var w=i["on".concat(_,"Hover")];w&&w(null,A.d)}if(E){var S=i["on".concat(E,"Hover")];S&&S(v.d,_===E?A.d:null)}var T=v&&Wn(i["".concat(v.type.toLowerCase(),"Label")])(v.d)||"";d.style.visibility=T?"visible":"hidden",d.innerHTML=T,i.canvas.classList[v&&i["on".concat(E,"Click")]||!v&&i.onBackgroundClick?"add":"remove"]("clickable"),i.hoverObj=v}x&&m()}if(x){rL(a,i.width,i.height);var R=ba(i.canvas).k;i.onRenderFramePre&&i.onRenderFramePre(a,R),i.forceGraph.globalScale(R).tickFrame(),i.onRenderFramePost&&i.onRenderFramePost(a,R)}Eo.update(),i.animationFrameRequestId=requestAnimationFrame(g)})()},update:function(n){}}),tx={width:dt.exports.number,height:dt.exports.number,graphData:dt.exports.shape({nodes:dt.exports.arrayOf(dt.exports.object).isRequired,links:dt.exports.arrayOf(dt.exports.object).isRequired}),backgroundColor:dt.exports.string,nodeRelSize:dt.exports.number,nodeId:dt.exports.string,nodeLabel:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),nodeVal:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),nodeVisibility:dt.exports.oneOfType([dt.exports.bool,dt.exports.string,dt.exports.func]),nodeColor:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),nodeAutoColorBy:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),onNodeHover:dt.exports.func,onNodeClick:dt.exports.func,linkSource:dt.exports.string,linkTarget:dt.exports.string,linkLabel:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),linkVisibility:dt.exports.oneOfType([dt.exports.bool,dt.exports.string,dt.exports.func]),linkColor:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),linkAutoColorBy:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),linkWidth:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkCurvature:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkDirectionalArrowLength:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkDirectionalArrowColor:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),linkDirectionalArrowRelPos:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkDirectionalParticles:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkDirectionalParticleSpeed:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkDirectionalParticleWidth:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkDirectionalParticleColor:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),onLinkHover:dt.exports.func,onLinkClick:dt.exports.func,dagMode:dt.exports.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:dt.exports.number,dagNodeFilter:dt.exports.func,onDagError:dt.exports.func,d3AlphaMin:dt.exports.number,d3AlphaDecay:dt.exports.number,d3VelocityDecay:dt.exports.number,warmupTicks:dt.exports.number,cooldownTicks:dt.exports.number,cooldownTime:dt.exports.number,onEngineTick:dt.exports.func,onEngineStop:dt.exports.func,getGraphBbox:dt.exports.func},rk={zoomToFit:dt.exports.func,onNodeRightClick:dt.exports.func,onNodeDrag:dt.exports.func,onNodeDragEnd:dt.exports.func,onLinkRightClick:dt.exports.func,linkHoverPrecision:dt.exports.number,onBackgroundClick:dt.exports.func,onBackgroundRightClick:dt.exports.func,enablePointerInteraction:dt.exports.bool,enableNodeDrag:dt.exports.bool},rM={showNavInfo:dt.exports.bool,nodeOpacity:dt.exports.number,nodeResolution:dt.exports.number,nodeThreeObject:dt.exports.oneOfType([dt.exports.object,dt.exports.string,dt.exports.func]),nodeThreeObjectExtend:dt.exports.oneOfType([dt.exports.bool,dt.exports.string,dt.exports.func]),linkOpacity:dt.exports.number,linkResolution:dt.exports.number,linkCurveRotation:dt.exports.oneOfType([dt.exports.number,dt.exports.string,dt.exports.func]),linkMaterial:dt.exports.oneOfType([dt.exports.object,dt.exports.string,dt.exports.func]),linkThreeObject:dt.exports.oneOfType([dt.exports.object,dt.exports.string,dt.exports.func]),linkThreeObjectExtend:dt.exports.oneOfType([dt.exports.bool,dt.exports.string,dt.exports.func]),linkPositionUpdate:dt.exports.func,linkDirectionalArrowResolution:dt.exports.number,linkDirectionalParticleResolution:dt.exports.number,forceEngine:dt.exports.oneOf(["d3","ngraph"]),ngraphPhysics:dt.exports.object,numDimensions:dt.exports.oneOf([1,2,3])},hte=Object.assign({},tx,rk,{linkLineDash:dt.exports.oneOfType([dt.exports.arrayOf(dt.exports.number),dt.exports.string,dt.exports.func]),nodeCanvasObjectMode:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),nodeCanvasObject:dt.exports.func,nodePointerAreaPaint:dt.exports.func,linkCanvasObjectMode:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),linkCanvasObject:dt.exports.func,linkPointerAreaPaint:dt.exports.func,autoPauseRedraw:dt.exports.bool,minZoom:dt.exports.number,maxZoom:dt.exports.number,enableZoomInteraction:dt.exports.bool,enablePanInteraction:dt.exports.bool,onZoom:dt.exports.func,onZoomEnd:dt.exports.func,onRenderFramePre:dt.exports.func,onRenderFramePost:dt.exports.func}),dte=Object.assign({},tx,rk,rM,{enableNavigationControls:dt.exports.bool,controlType:dt.exports.oneOf(["trackball","orbit","fly"]),rendererConfig:dt.exports.object,extraRenderers:dt.exports.arrayOf(dt.exports.shape({render:dt.exports.func.isRequired}))}),fte=Object.assign({},tx,rM,{nodeDesc:dt.exports.oneOfType([dt.exports.string,dt.exports.func]),linkDesc:dt.exports.oneOfType([dt.exports.string,dt.exports.func])}),pte=Object.assign({},tx,rM,{markerAttrs:dt.exports.object,yOffset:dt.exports.number,glScale:dt.exports.number});const sk=Vy(dK,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"]});sk.displayName="ForceGraphVR";sk.propTypes=fte;const ok=Vy(AK,{methodNames:["getGraphBbox","emitParticle","d3Force","d3ReheatSimulation","refresh"],initPropNames:["markerAttrs"]});ok.displayName="ForceGraphAR";ok.propTypes=pte;const ak=Vy(hQ,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","cameraPosition","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords","postProcessingComposer","scene","camera","renderer","controls","refresh"],initPropNames:["controlType","rendererConfig","extraRenderers"]});ak.displayName="ForceGraph3D";ak.propTypes=dte;const sM=Vy(ute,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});sM.displayName="ForceGraph2D";sM.propTypes=hte;var nx={exports:{}},ix={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mte=ar.exports,gte=Symbol.for("react.element"),vte=Symbol.for("react.fragment"),yte=Object.prototype.hasOwnProperty,xte=mte.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,_te={key:!0,ref:!0,__self:!0,__source:!0};function lk(r,n,i){var o,l={},a=null,u=null;i!==void 0&&(a=""+i),n.key!==void 0&&(a=""+n.key),n.ref!==void 0&&(u=n.ref);for(o in n)yte.call(n,o)&&!_te.hasOwnProperty(o)&&(l[o]=n[o]);if(r&&r.defaultProps)for(o in n=r.defaultProps,n)l[o]===void 0&&(l[o]=n[o]);return{$$typeof:gte,type:r,key:a,ref:u,props:l,_owner:xte.current}}ix.Fragment=vte;ix.jsx=lk;ix.jsxs=lk;(function(r){r.exports=ix})(nx);const rx=nx.exports.Fragment,zi=nx.exports.jsx,mc=nx.exports.jsxs,bte={I:"#A56DF0",D:"#3689D1",R:"#EE8B8B",L:"#DAC968"},Ete=()=>{const{graphData:r,graphType:n,chamber:i,focusedMember:o}=ar.exports.useContext(sx);return ar.exports.useEffect(()=>{console.log(`\u2705 UseEffect detected new focused member: ${o}`)},[o]),zi(rx,{children:r===null?zi("div",{className:"loading",children:"Loading data..."}):zi("div",{style:{position:"relative"},children:zi(sM,{...((a,u)=>{if(!a||!u)return null;const h=a.nodes.filter(d=>d.chamber===u),f=a.links.filter(d=>d.chamber===u);return{graphData:{nodes:h,links:f},nodeId:"_id",linkVisibility:!1,backgroundColor:"#eaeaea",nodeColor:d=>bte[d.party]||"#BBBBBB",nodeLabel:d=>`${d.firstName} ${d.lastName}`,nodeVisibility:d=>d.chamber===u,showNavInfo:!1,linkOpacity:.1}})(r,i)})})})},Ate=async(r,n)=>[],wte=[112,113,114,115,116].sort(),Mte=()=>{const{congressNumber:r,setCongressNumber:n}=ar.exports.useContext(sx),[i,o]=ar.exports.useState(null),[l,a]=ar.exports.useState(!1);return zi(rx,{children:mc("div",{className:"search-container",children:[mc("div",{className:"input-group",children:[zi("div",{className:"input-group-prepend",children:zi("button",{className:"btn btn-primary",style:{borderTopRightRadius:0,borderBottomRightRadius:0},children:l?zi("div",{className:"spinner-border spinner-border-sm text-light",role:"status",children:zi("span",{className:"sr-only"})}):zi("i",{className:"bi bi-search"})})}),zi("input",{type:"text",className:"form-control",placeholder:"Search members",style:{borderTopLeftRadius:0,borderBottomLeftRadius:0},onChange:async h=>{if(h.currentTarget.value===""){o(null);return}a(!0);const d=await Ate();o(d),a(!1)},onBlur:()=>{o(null)}}),zi("div",{className:"input-group-append",children:zi("select",{className:"form-select",style:{borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:0},value:r,onChange:h=>{h.preventDefault(),n(h.currentTarget.value)},children:wte.map(h=>zi("option",{value:h,children:h},h))})})]}),i&&zi("div",{className:"search-results-container",children:zi("div",{className:"search-results",children:i.length===0?zi("div",{className:"no-results",children:zi("i",{children:"No results \u{1F641}"})}):i.map(h=>mc("div",{className:"search-result",children:[zi("div",{children:`${h.firstName} ${h.lastName}`}),zi("div",{children:h.party})]},h._id))})})]})})},Ste=()=>{const[r,n]=ar.exports.useState(!1),{chamber:i,setChamber:o,graphType:l,setGraphType:a}=ar.exports.useContext(sx);return mc(rx,{children:[zi("div",{className:"control-center",onClick:()=>{n(u=>!u)},children:zi("i",{className:"bi bi-list"})}),r&&mc("div",{className:"control-panel",children:[zi("div",{className:"lead",style:{alignSelf:"center"},children:"Chamber"}),mc("div",{className:"btn-group",role:"group",children:[zi("button",{type:"button",className:i==="house"?"btn btn-primary":"btn btn-outline-primary",onClick:()=>o("house"),children:"House"}),zi("button",{type:"button",className:i==="senate"?"btn btn-primary":"btn btn-outline-primary",onClick:()=>o("senate"),children:"Senate"})]}),zi("div",{className:"lead",style:{alignSelf:"center"},children:"Graph Type"}),mc("div",{className:"btn-group",children:[zi("button",{type:"button",className:l==="2D"?"btn btn-primary":"btn btn-outline-primary",onClick:()=>a("2D"),children:"2D"}),zi("button",{type:"button",className:l==="3D"?"btn btn-primary":"btn btn-outline-primary",onClick:()=>a("3D"),children:"3D"}),zi("button",{type:"button",className:l==="VR"?"btn btn-primary":"btn btn-outline-primary",onClick:()=>a("VR"),children:"VR"}),zi("button",{type:"button",className:l==="AR"?"btn btn-primary":"btn btn-outline-primary",onClick:()=>a("AR"),children:"AR"})]})]})]})},sx=XL.createContext({}),Tte=()=>{const[r,n]=ar.exports.useState(null),[i,o]=ar.exports.useState("2D"),[l,a]=ar.exports.useState("house"),[u,h]=ar.exports.useState(115),[f,d]=ar.exports.useState(null);return ar.exports.useEffect(()=>{console.log(`\u2705 UseEffect detected updated congress number: ${u}`),(async()=>{console.log("loading data..."),n(null);const{nodes:m,links:g}=await nH(u);n({nodes:m,links:g})})()},[u]),zi(sx.Provider,{value:{congressNumber:u,setCongressNumber:h,graphData:r,setGraphData:n,graphType:i,setGraphType:o,chamber:l,setChamber:a,focusedMember:f,setFocusedMember:d},children:mc(rx,{children:[zi(Mte,{}),zi(Ste,{}),zi(Ete,{})]})})};var Rs="top",ao="bottom",lo="right",Ls="left",ox="auto",ff=[Rs,ao,lo,Ls],Wu="start",Jd="end",ck="clippingParents",oM="viewport",ud="popper",uk="reference",yA=ff.reduce(function(r,n){return r.concat([n+"-"+Wu,n+"-"+Jd])},[]),aM=[].concat(ff,[ox]).reduce(function(r,n){return r.concat([n,n+"-"+Wu,n+"-"+Jd])},[]),hk="beforeRead",dk="read",fk="afterRead",pk="beforeMain",mk="main",gk="afterMain",vk="beforeWrite",yk="write",xk="afterWrite",_k=[hk,dk,fk,pk,mk,gk,vk,yk,xk];function Da(r){return r?(r.nodeName||"").toLowerCase():null}function Ro(r){if(r==null)return window;if(r.toString()!=="[object Window]"){var n=r.ownerDocument;return n&&n.defaultView||window}return r}function ju(r){var n=Ro(r).Element;return r instanceof n||r instanceof Element}function Mo(r){var n=Ro(r).HTMLElement;return r instanceof n||r instanceof HTMLElement}function lM(r){if(typeof ShadowRoot>"u")return!1;var n=Ro(r).ShadowRoot;return r instanceof n||r instanceof ShadowRoot}function Cte(r){var n=r.state;Object.keys(n.elements).forEach(function(i){var o=n.styles[i]||{},l=n.attributes[i]||{},a=n.elements[i];!Mo(a)||!Da(a)||(Object.assign(a.style,o),Object.keys(l).forEach(function(u){var h=l[u];h===!1?a.removeAttribute(u):a.setAttribute(u,h===!0?"":h)}))})}function Rte(r){var n=r.state,i={popper:{position:n.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(n.elements.popper.style,i.popper),n.styles=i,n.elements.arrow&&Object.assign(n.elements.arrow.style,i.arrow),function(){Object.keys(n.elements).forEach(function(o){var l=n.elements[o],a=n.attributes[o]||{},u=Object.keys(n.styles.hasOwnProperty(o)?n.styles[o]:i[o]),h=u.reduce(function(f,d){return f[d]="",f},{});!Mo(l)||!Da(l)||(Object.assign(l.style,h),Object.keys(a).forEach(function(f){l.removeAttribute(f)}))})}}const cM={name:"applyStyles",enabled:!0,phase:"write",fn:Cte,effect:Rte,requires:["computeStyles"]};function Ra(r){return r.split("-")[0]}var Iu=Math.max,wy=Math.min,ef=Math.round;function xA(){var r=navigator.userAgentData;return r!=null&&r.brands?r.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function bk(){return!/^((?!chrome|android).)*safari/i.test(xA())}function tf(r,n,i){n===void 0&&(n=!1),i===void 0&&(i=!1);var o=r.getBoundingClientRect(),l=1,a=1;n&&Mo(r)&&(l=r.offsetWidth>0&&ef(o.width)/r.offsetWidth||1,a=r.offsetHeight>0&&ef(o.height)/r.offsetHeight||1);var u=ju(r)?Ro(r):window,h=u.visualViewport,f=!bk()&&i,d=(o.left+(f&&h?h.offsetLeft:0))/l,m=(o.top+(f&&h?h.offsetTop:0))/a,g=o.width/l,x=o.height/a;return{width:g,height:x,top:m,right:d+g,bottom:m+x,left:d,x:d,y:m}}function uM(r){var n=tf(r),i=r.offsetWidth,o=r.offsetHeight;return Math.abs(n.width-i)<=1&&(i=n.width),Math.abs(n.height-o)<=1&&(o=n.height),{x:r.offsetLeft,y:r.offsetTop,width:i,height:o}}function Ek(r,n){var i=n.getRootNode&&n.getRootNode();if(r.contains(n))return!0;if(i&&lM(i)){var o=n;do{if(o&&r.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Tl(r){return Ro(r).getComputedStyle(r)}function Lte(r){return["table","td","th"].indexOf(Da(r))>=0}function kc(r){return((ju(r)?r.ownerDocument:r.document)||window.document).documentElement}function ax(r){return Da(r)==="html"?r:r.assignedSlot||r.parentNode||(lM(r)?r.host:null)||kc(r)}function sL(r){return!Mo(r)||Tl(r).position==="fixed"?null:r.offsetParent}function Pte(r){var n=/firefox/i.test(xA()),i=/Trident/i.test(xA());if(i&&Mo(r)){var o=Tl(r);if(o.position==="fixed")return null}var l=ax(r);for(lM(l)&&(l=l.host);Mo(l)&&["html","body"].indexOf(Da(l))<0;){var a=Tl(l);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||n&&a.willChange==="filter"||n&&a.filter&&a.filter!=="none")return l;l=l.parentNode}return null}function Gm(r){for(var n=Ro(r),i=sL(r);i&&Lte(i)&&Tl(i).position==="static";)i=sL(i);return i&&(Da(i)==="html"||Da(i)==="body"&&Tl(i).position==="static")?n:i||Pte(r)||n}function hM(r){return["top","bottom"].indexOf(r)>=0?"x":"y"}function Zp(r,n,i){return Iu(r,wy(n,i))}function Dte(r,n,i){var o=Zp(r,n,i);return o>i?i:o}function Ak(){return{top:0,right:0,bottom:0,left:0}}function wk(r){return Object.assign({},Ak(),r)}function Mk(r,n){return n.reduce(function(i,o){return i[o]=r,i},{})}var Ote=function(n,i){return n=typeof n=="function"?n(Object.assign({},i.rects,{placement:i.placement})):n,wk(typeof n!="number"?n:Mk(n,ff))};function Ite(r){var n,i=r.state,o=r.name,l=r.options,a=i.elements.arrow,u=i.modifiersData.popperOffsets,h=Ra(i.placement),f=hM(h),d=[Ls,lo].indexOf(h)>=0,m=d?"height":"width";if(!(!a||!u)){var g=Ote(l.padding,i),x=uM(a),v=f==="y"?Rs:Ls,A=f==="y"?ao:lo,_=i.rects.reference[m]+i.rects.reference[f]-u[f]-i.rects.popper[m],E=u[f]-i.rects.reference[f],w=Gm(a),S=w?f==="y"?w.clientHeight||0:w.clientWidth||0:0,T=_/2-E/2,R=g[v],L=S-x[m]-g[A],I=S/2-x[m]/2+T,N=Zp(R,I,L),B=f;i.modifiersData[o]=(n={},n[B]=N,n.centerOffset=N-I,n)}}function kte(r){var n=r.state,i=r.options,o=i.element,l=o===void 0?"[data-popper-arrow]":o;l!=null&&(typeof l=="string"&&(l=n.elements.popper.querySelector(l),!l)||!Ek(n.elements.popper,l)||(n.elements.arrow=l))}const Sk={name:"arrow",enabled:!0,phase:"main",fn:Ite,effect:kte,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function nf(r){return r.split("-")[1]}var Nte={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Fte(r){var n=r.x,i=r.y,o=window,l=o.devicePixelRatio||1;return{x:ef(n*l)/l||0,y:ef(i*l)/l||0}}function oL(r){var n,i=r.popper,o=r.popperRect,l=r.placement,a=r.variation,u=r.offsets,h=r.position,f=r.gpuAcceleration,d=r.adaptive,m=r.roundOffsets,g=r.isFixed,x=u.x,v=x===void 0?0:x,A=u.y,_=A===void 0?0:A,E=typeof m=="function"?m({x:v,y:_}):{x:v,y:_};v=E.x,_=E.y;var w=u.hasOwnProperty("x"),S=u.hasOwnProperty("y"),T=Ls,R=Rs,L=window;if(d){var I=Gm(i),N="clientHeight",B="clientWidth";if(I===Ro(i)&&(I=kc(i),Tl(I).position!=="static"&&h==="absolute"&&(N="scrollHeight",B="scrollWidth")),I=I,l===Rs||(l===Ls||l===lo)&&a===Jd){R=ao;var H=g&&I===L&&L.visualViewport?L.visualViewport.height:I[N];_-=H-o.height,_*=f?1:-1}if(l===Ls||(l===Rs||l===ao)&&a===Jd){T=lo;var q=g&&I===L&&L.visualViewport?L.visualViewport.width:I[B];v-=q-o.width,v*=f?1:-1}}var le=Object.assign({position:h},d&&Nte),ne=m===!0?Fte({x:v,y:_}):{x:v,y:_};if(v=ne.x,_=ne.y,f){var D;return Object.assign({},le,(D={},D[R]=S?"0":"",D[T]=w?"0":"",D.transform=(L.devicePixelRatio||1)<=1?"translate("+v+"px, "+_+"px)":"translate3d("+v+"px, "+_+"px, 0)",D))}return Object.assign({},le,(n={},n[R]=S?_+"px":"",n[T]=w?v+"px":"",n.transform="",n))}function Bte(r){var n=r.state,i=r.options,o=i.gpuAcceleration,l=o===void 0?!0:o,a=i.adaptive,u=a===void 0?!0:a,h=i.roundOffsets,f=h===void 0?!0:h,d={placement:Ra(n.placement),variation:nf(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:l,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,oL(Object.assign({},d,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:u,roundOffsets:f})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,oL(Object.assign({},d,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:f})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const dM={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Bte,data:{}};var h0={passive:!0};function Ute(r){var n=r.state,i=r.instance,o=r.options,l=o.scroll,a=l===void 0?!0:l,u=o.resize,h=u===void 0?!0:u,f=Ro(n.elements.popper),d=[].concat(n.scrollParents.reference,n.scrollParents.popper);return a&&d.forEach(function(m){m.addEventListener("scroll",i.update,h0)}),h&&f.addEventListener("resize",i.update,h0),function(){a&&d.forEach(function(m){m.removeEventListener("scroll",i.update,h0)}),h&&f.removeEventListener("resize",i.update,h0)}}const fM={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Ute,data:{}};var zte={left:"right",right:"left",bottom:"top",top:"bottom"};function z0(r){return r.replace(/left|right|bottom|top/g,function(n){return zte[n]})}var Hte={start:"end",end:"start"};function aL(r){return r.replace(/start|end/g,function(n){return Hte[n]})}function pM(r){var n=Ro(r),i=n.pageXOffset,o=n.pageYOffset;return{scrollLeft:i,scrollTop:o}}function mM(r){return tf(kc(r)).left+pM(r).scrollLeft}function Gte(r,n){var i=Ro(r),o=kc(r),l=i.visualViewport,a=o.clientWidth,u=o.clientHeight,h=0,f=0;if(l){a=l.width,u=l.height;var d=bk();(d||!d&&n==="fixed")&&(h=l.offsetLeft,f=l.offsetTop)}return{width:a,height:u,x:h+mM(r),y:f}}function Vte(r){var n,i=kc(r),o=pM(r),l=(n=r.ownerDocument)==null?void 0:n.body,a=Iu(i.scrollWidth,i.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),u=Iu(i.scrollHeight,i.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),h=-o.scrollLeft+mM(r),f=-o.scrollTop;return Tl(l||i).direction==="rtl"&&(h+=Iu(i.clientWidth,l?l.clientWidth:0)-a),{width:a,height:u,x:h,y:f}}function gM(r){var n=Tl(r),i=n.overflow,o=n.overflowX,l=n.overflowY;return/auto|scroll|overlay|hidden/.test(i+l+o)}function Tk(r){return["html","body","#document"].indexOf(Da(r))>=0?r.ownerDocument.body:Mo(r)&&gM(r)?r:Tk(ax(r))}function Jp(r,n){var i;n===void 0&&(n=[]);var o=Tk(r),l=o===((i=r.ownerDocument)==null?void 0:i.body),a=Ro(o),u=l?[a].concat(a.visualViewport||[],gM(o)?o:[]):o,h=n.concat(u);return l?h:h.concat(Jp(ax(u)))}function _A(r){return Object.assign({},r,{left:r.x,top:r.y,right:r.x+r.width,bottom:r.y+r.height})}function Wte(r,n){var i=tf(r,!1,n==="fixed");return i.top=i.top+r.clientTop,i.left=i.left+r.clientLeft,i.bottom=i.top+r.clientHeight,i.right=i.left+r.clientWidth,i.width=r.clientWidth,i.height=r.clientHeight,i.x=i.left,i.y=i.top,i}function lL(r,n,i){return n===oM?_A(Gte(r,i)):ju(n)?Wte(n,i):_A(Vte(kc(r)))}function jte(r){var n=Jp(ax(r)),i=["absolute","fixed"].indexOf(Tl(r).position)>=0,o=i&&Mo(r)?Gm(r):r;return ju(o)?n.filter(function(l){return ju(l)&&Ek(l,o)&&Da(l)!=="body"}):[]}function $te(r,n,i,o){var l=n==="clippingParents"?jte(r):[].concat(n),a=[].concat(l,[i]),u=a[0],h=a.reduce(function(f,d){var m=lL(r,d,o);return f.top=Iu(m.top,f.top),f.right=wy(m.right,f.right),f.bottom=wy(m.bottom,f.bottom),f.left=Iu(m.left,f.left),f},lL(r,u,o));return h.width=h.right-h.left,h.height=h.bottom-h.top,h.x=h.left,h.y=h.top,h}function Ck(r){var n=r.reference,i=r.element,o=r.placement,l=o?Ra(o):null,a=o?nf(o):null,u=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,f;switch(l){case Rs:f={x:u,y:n.y-i.height};break;case ao:f={x:u,y:n.y+n.height};break;case lo:f={x:n.x+n.width,y:h};break;case Ls:f={x:n.x-i.width,y:h};break;default:f={x:n.x,y:n.y}}var d=l?hM(l):null;if(d!=null){var m=d==="y"?"height":"width";switch(a){case Wu:f[d]=f[d]-(n[m]/2-i[m]/2);break;case Jd:f[d]=f[d]+(n[m]/2-i[m]/2);break}}return f}function rf(r,n){n===void 0&&(n={});var i=n,o=i.placement,l=o===void 0?r.placement:o,a=i.strategy,u=a===void 0?r.strategy:a,h=i.boundary,f=h===void 0?ck:h,d=i.rootBoundary,m=d===void 0?oM:d,g=i.elementContext,x=g===void 0?ud:g,v=i.altBoundary,A=v===void 0?!1:v,_=i.padding,E=_===void 0?0:_,w=wk(typeof E!="number"?E:Mk(E,ff)),S=x===ud?uk:ud,T=r.rects.popper,R=r.elements[A?S:x],L=$te(ju(R)?R:R.contextElement||kc(r.elements.popper),f,m,u),I=tf(r.elements.reference),N=Ck({reference:I,element:T,strategy:"absolute",placement:l}),B=_A(Object.assign({},T,N)),H=x===ud?B:I,q={top:L.top-H.top+w.top,bottom:H.bottom-L.bottom+w.bottom,left:L.left-H.left+w.left,right:H.right-L.right+w.right},le=r.modifiersData.offset;if(x===ud&&le){var ne=le[l];Object.keys(q).forEach(function(D){var O=[lo,ao].indexOf(D)>=0?1:-1,k=[Rs,ao].indexOf(D)>=0?"y":"x";q[D]+=ne[k]*O})}return q}function Xte(r,n){n===void 0&&(n={});var i=n,o=i.placement,l=i.boundary,a=i.rootBoundary,u=i.padding,h=i.flipVariations,f=i.allowedAutoPlacements,d=f===void 0?aM:f,m=nf(o),g=m?h?yA:yA.filter(function(A){return nf(A)===m}):ff,x=g.filter(function(A){return d.indexOf(A)>=0});x.length===0&&(x=g);var v=x.reduce(function(A,_){return A[_]=rf(r,{placement:_,boundary:l,rootBoundary:a,padding:u})[Ra(_)],A},{});return Object.keys(v).sort(function(A,_){return v[A]-v[_]})}function qte(r){if(Ra(r)===ox)return[];var n=z0(r);return[aL(r),n,aL(n)]}function Yte(r){var n=r.state,i=r.options,o=r.name;if(!n.modifiersData[o]._skip){for(var l=i.mainAxis,a=l===void 0?!0:l,u=i.altAxis,h=u===void 0?!0:u,f=i.fallbackPlacements,d=i.padding,m=i.boundary,g=i.rootBoundary,x=i.altBoundary,v=i.flipVariations,A=v===void 0?!0:v,_=i.allowedAutoPlacements,E=n.options.placement,w=Ra(E),S=w===E,T=f||(S||!A?[z0(E)]:qte(E)),R=[E].concat(T).reduce(function(ke,Oe){return ke.concat(Ra(Oe)===ox?Xte(n,{placement:Oe,boundary:m,rootBoundary:g,padding:d,flipVariations:A,allowedAutoPlacements:_}):Oe)},[]),L=n.rects.reference,I=n.rects.popper,N=new Map,B=!0,H=R[0],q=0;q<R.length;q++){var le=R[q],ne=Ra(le),D=nf(le)===Wu,O=[Rs,ao].indexOf(ne)>=0,k=O?"width":"height",z=rf(n,{placement:le,boundary:m,rootBoundary:g,altBoundary:x,padding:d}),X=O?D?lo:Ls:D?ao:Rs;L[k]>I[k]&&(X=z0(X));var Z=z0(X),ie=[];if(a&&ie.push(z[ne]<=0),h&&ie.push(z[X]<=0,z[Z]<=0),ie.every(function(ke){return ke})){H=le,B=!1;break}N.set(le,ie)}if(B)for(var se=A?3:1,ue=function(Oe){var Ne=R.find(function(He){var Qe=N.get(He);if(Qe)return Qe.slice(0,Oe).every(function(St){return St})});if(Ne)return H=Ne,"break"},ye=se;ye>0;ye--){var Ce=ue(ye);if(Ce==="break")break}n.placement!==H&&(n.modifiersData[o]._skip=!0,n.placement=H,n.reset=!0)}}const Rk={name:"flip",enabled:!0,phase:"main",fn:Yte,requiresIfExists:["offset"],data:{_skip:!1}};function cL(r,n,i){return i===void 0&&(i={x:0,y:0}),{top:r.top-n.height-i.y,right:r.right-n.width+i.x,bottom:r.bottom-n.height+i.y,left:r.left-n.width-i.x}}function uL(r){return[Rs,lo,ao,Ls].some(function(n){return r[n]>=0})}function Kte(r){var n=r.state,i=r.name,o=n.rects.reference,l=n.rects.popper,a=n.modifiersData.preventOverflow,u=rf(n,{elementContext:"reference"}),h=rf(n,{altBoundary:!0}),f=cL(u,o),d=cL(h,l,a),m=uL(f),g=uL(d);n.modifiersData[i]={referenceClippingOffsets:f,popperEscapeOffsets:d,isReferenceHidden:m,hasPopperEscaped:g},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":g})}const Lk={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:Kte};function Qte(r,n,i){var o=Ra(r),l=[Ls,Rs].indexOf(o)>=0?-1:1,a=typeof i=="function"?i(Object.assign({},n,{placement:r})):i,u=a[0],h=a[1];return u=u||0,h=(h||0)*l,[Ls,lo].indexOf(o)>=0?{x:h,y:u}:{x:u,y:h}}function Zte(r){var n=r.state,i=r.options,o=r.name,l=i.offset,a=l===void 0?[0,0]:l,u=aM.reduce(function(m,g){return m[g]=Qte(g,n.rects,a),m},{}),h=u[n.placement],f=h.x,d=h.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=f,n.modifiersData.popperOffsets.y+=d),n.modifiersData[o]=u}const Pk={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:Zte};function Jte(r){var n=r.state,i=r.name;n.modifiersData[i]=Ck({reference:n.rects.reference,element:n.rects.popper,strategy:"absolute",placement:n.placement})}const vM={name:"popperOffsets",enabled:!0,phase:"read",fn:Jte,data:{}};function ene(r){return r==="x"?"y":"x"}function tne(r){var n=r.state,i=r.options,o=r.name,l=i.mainAxis,a=l===void 0?!0:l,u=i.altAxis,h=u===void 0?!1:u,f=i.boundary,d=i.rootBoundary,m=i.altBoundary,g=i.padding,x=i.tether,v=x===void 0?!0:x,A=i.tetherOffset,_=A===void 0?0:A,E=rf(n,{boundary:f,rootBoundary:d,padding:g,altBoundary:m}),w=Ra(n.placement),S=nf(n.placement),T=!S,R=hM(w),L=ene(R),I=n.modifiersData.popperOffsets,N=n.rects.reference,B=n.rects.popper,H=typeof _=="function"?_(Object.assign({},n.rects,{placement:n.placement})):_,q=typeof H=="number"?{mainAxis:H,altAxis:H}:Object.assign({mainAxis:0,altAxis:0},H),le=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,ne={x:0,y:0};if(!!I){if(a){var D,O=R==="y"?Rs:Ls,k=R==="y"?ao:lo,z=R==="y"?"height":"width",X=I[R],Z=X+E[O],ie=X-E[k],se=v?-B[z]/2:0,ue=S===Wu?N[z]:B[z],ye=S===Wu?-B[z]:-N[z],Ce=n.elements.arrow,ke=v&&Ce?uM(Ce):{width:0,height:0},Oe=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:Ak(),Ne=Oe[O],He=Oe[k],Qe=Zp(0,N[z],ke[z]),St=T?N[z]/2-se-Qe-Ne-q.mainAxis:ue-Qe-Ne-q.mainAxis,bt=T?-N[z]/2+se+Qe+He+q.mainAxis:ye+Qe+He+q.mainAxis,Jt=n.elements.arrow&&Gm(n.elements.arrow),sn=Jt?R==="y"?Jt.clientTop||0:Jt.clientLeft||0:0,Se=(D=le==null?void 0:le[R])!=null?D:0,qe=X+St-Se-sn,Ue=X+bt-Se,At=Zp(v?wy(Z,qe):Z,X,v?Iu(ie,Ue):ie);I[R]=At,ne[R]=At-X}if(h){var tt,pe=R==="x"?Rs:Ls,ge=R==="x"?ao:lo,Fe=I[L],Re=L==="y"?"height":"width",ce=Fe+E[pe],ae=Fe-E[ge],J=[Rs,Ls].indexOf(w)!==-1,G=(tt=le==null?void 0:le[L])!=null?tt:0,$=J?ce:Fe-N[Re]-B[Re]-G+q.altAxis,me=J?Fe+N[Re]+B[Re]-G-q.altAxis:ae,Pe=v&&J?Dte($,Fe,me):Zp(v?$:ce,Fe,v?me:ae);I[L]=Pe,ne[L]=Pe-Fe}n.modifiersData[o]=ne}}const Dk={name:"preventOverflow",enabled:!0,phase:"main",fn:tne,requiresIfExists:["offset"]};function nne(r){return{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}}function ine(r){return r===Ro(r)||!Mo(r)?pM(r):nne(r)}function rne(r){var n=r.getBoundingClientRect(),i=ef(n.width)/r.offsetWidth||1,o=ef(n.height)/r.offsetHeight||1;return i!==1||o!==1}function sne(r,n,i){i===void 0&&(i=!1);var o=Mo(n),l=Mo(n)&&rne(n),a=kc(n),u=tf(r,l,i),h={scrollLeft:0,scrollTop:0},f={x:0,y:0};return(o||!o&&!i)&&((Da(n)!=="body"||gM(a))&&(h=ine(n)),Mo(n)?(f=tf(n,!0),f.x+=n.clientLeft,f.y+=n.clientTop):a&&(f.x=mM(a))),{x:u.left+h.scrollLeft-f.x,y:u.top+h.scrollTop-f.y,width:u.width,height:u.height}}function one(r){var n=new Map,i=new Set,o=[];r.forEach(function(a){n.set(a.name,a)});function l(a){i.add(a.name);var u=[].concat(a.requires||[],a.requiresIfExists||[]);u.forEach(function(h){if(!i.has(h)){var f=n.get(h);f&&l(f)}}),o.push(a)}return r.forEach(function(a){i.has(a.name)||l(a)}),o}function ane(r){var n=one(r);return _k.reduce(function(i,o){return i.concat(n.filter(function(l){return l.phase===o}))},[])}function lne(r){var n;return function(){return n||(n=new Promise(function(i){Promise.resolve().then(function(){n=void 0,i(r())})})),n}}function cne(r){var n=r.reduce(function(i,o){var l=i[o.name];return i[o.name]=l?Object.assign({},l,o,{options:Object.assign({},l.options,o.options),data:Object.assign({},l.data,o.data)}):o,i},{});return Object.keys(n).map(function(i){return n[i]})}var hL={placement:"bottom",modifiers:[],strategy:"absolute"};function dL(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return!n.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function lx(r){r===void 0&&(r={});var n=r,i=n.defaultModifiers,o=i===void 0?[]:i,l=n.defaultOptions,a=l===void 0?hL:l;return function(h,f,d){d===void 0&&(d=a);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},hL,a),modifiersData:{},elements:{reference:h,popper:f},attributes:{},styles:{}},g=[],x=!1,v={state:m,setOptions:function(w){var S=typeof w=="function"?w(m.options):w;_(),m.options=Object.assign({},a,m.options,S),m.scrollParents={reference:ju(h)?Jp(h):h.contextElement?Jp(h.contextElement):[],popper:Jp(f)};var T=ane(cne([].concat(o,m.options.modifiers)));return m.orderedModifiers=T.filter(function(R){return R.enabled}),A(),v.update()},forceUpdate:function(){if(!x){var w=m.elements,S=w.reference,T=w.popper;if(!!dL(S,T)){m.rects={reference:sne(S,Gm(T),m.options.strategy==="fixed"),popper:uM(T)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(q){return m.modifiersData[q.name]=Object.assign({},q.data)});for(var R=0;R<m.orderedModifiers.length;R++){if(m.reset===!0){m.reset=!1,R=-1;continue}var L=m.orderedModifiers[R],I=L.fn,N=L.options,B=N===void 0?{}:N,H=L.name;typeof I=="function"&&(m=I({state:m,options:B,name:H,instance:v})||m)}}}},update:lne(function(){return new Promise(function(E){v.forceUpdate(),E(m)})}),destroy:function(){_(),x=!0}};if(!dL(h,f))return v;v.setOptions(d).then(function(E){!x&&d.onFirstUpdate&&d.onFirstUpdate(E)});function A(){m.orderedModifiers.forEach(function(E){var w=E.name,S=E.options,T=S===void 0?{}:S,R=E.effect;if(typeof R=="function"){var L=R({state:m,name:w,instance:v,options:T}),I=function(){};g.push(L||I)}})}function _(){g.forEach(function(E){return E()}),g=[]}return v}}var une=lx(),hne=[fM,vM,dM,cM],dne=lx({defaultModifiers:hne}),fne=[fM,vM,dM,cM,Pk,Rk,Dk,Sk,Lk],yM=lx({defaultModifiers:fne});const Ok=Object.freeze(Object.defineProperty({__proto__:null,popperGenerator:lx,detectOverflow:rf,createPopperBase:une,createPopper:yM,createPopperLite:dne,top:Rs,bottom:ao,right:lo,left:Ls,auto:ox,basePlacements:ff,start:Wu,end:Jd,clippingParents:ck,viewport:oM,popper:ud,reference:uk,variationPlacements:yA,placements:aM,beforeRead:hk,read:dk,afterRead:fk,beforeMain:pk,main:mk,afterMain:gk,beforeWrite:vk,write:yk,afterWrite:xk,modifierPhases:_k,applyStyles:cM,arrow:Sk,computeStyles:dM,eventListeners:fM,flip:Rk,hide:Lk,offset:Pk,popperOffsets:vM,preventOverflow:Dk},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.2.3 (https://getbootstrap.com/)
  * Copyright 2011-2022 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const pne=1e6,mne=1e3,bA="transitionend",gne=r=>r==null?`${r}`:Object.prototype.toString.call(r).match(/\s([a-z]+)/i)[1].toLowerCase(),vne=r=>{do r+=Math.floor(Math.random()*pne);while(document.getElementById(r));return r},Ik=r=>{let n=r.getAttribute("data-bs-target");if(!n||n==="#"){let i=r.getAttribute("href");if(!i||!i.includes("#")&&!i.startsWith("."))return null;i.includes("#")&&!i.startsWith("#")&&(i=`#${i.split("#")[1]}`),n=i&&i!=="#"?i.trim():null}return n},kk=r=>{const n=Ik(r);return n&&document.querySelector(n)?n:null},yl=r=>{const n=Ik(r);return n?document.querySelector(n):null},yne=r=>{if(!r)return 0;let{transitionDuration:n,transitionDelay:i}=window.getComputedStyle(r);const o=Number.parseFloat(n),l=Number.parseFloat(i);return!o&&!l?0:(n=n.split(",")[0],i=i.split(",")[0],(Number.parseFloat(n)+Number.parseFloat(i))*mne)},Nk=r=>{r.dispatchEvent(new Event(bA))},xl=r=>!r||typeof r!="object"?!1:(typeof r.jquery<"u"&&(r=r[0]),typeof r.nodeType<"u"),Cc=r=>xl(r)?r.jquery?r[0]:r:typeof r=="string"&&r.length>0?document.querySelector(r):null,pf=r=>{if(!xl(r)||r.getClientRects().length===0)return!1;const n=getComputedStyle(r).getPropertyValue("visibility")==="visible",i=r.closest("details:not([open])");if(!i)return n;if(i!==r){const o=r.closest("summary");if(o&&o.parentNode!==i||o===null)return!1}return n},Rc=r=>!r||r.nodeType!==Node.ELEMENT_NODE||r.classList.contains("disabled")?!0:typeof r.disabled<"u"?r.disabled:r.hasAttribute("disabled")&&r.getAttribute("disabled")!=="false",Fk=r=>{if(!document.documentElement.attachShadow)return null;if(typeof r.getRootNode=="function"){const n=r.getRootNode();return n instanceof ShadowRoot?n:null}return r instanceof ShadowRoot?r:r.parentNode?Fk(r.parentNode):null},My=()=>{},Vm=r=>{r.offsetHeight},Bk=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,w1=[],xne=r=>{document.readyState==="loading"?(w1.length||document.addEventListener("DOMContentLoaded",()=>{for(const n of w1)n()}),w1.push(r)):r()},Co=()=>document.documentElement.dir==="rtl",Lo=r=>{xne(()=>{const n=Bk();if(n){const i=r.NAME,o=n.fn[i];n.fn[i]=r.jQueryInterface,n.fn[i].Constructor=r,n.fn[i].noConflict=()=>(n.fn[i]=o,r.jQueryInterface)}})},ul=r=>{typeof r=="function"&&r()},Uk=(r,n,i=!0)=>{if(!i){ul(r);return}const o=5,l=yne(n)+o;let a=!1;const u=({target:h})=>{h===n&&(a=!0,n.removeEventListener(bA,u),ul(r))};n.addEventListener(bA,u),setTimeout(()=>{a||Nk(n)},l)},xM=(r,n,i,o)=>{const l=r.length;let a=r.indexOf(n);return a===-1?!i&&o?r[l-1]:r[0]:(a+=i?1:-1,o&&(a=(a+l)%l),r[Math.max(0,Math.min(a,l-1))])},_ne=/[^.]*(?=\..*)\.|.*/,bne=/\..*/,Ene=/::\d+$/,M1={};let fL=1;const zk={mouseenter:"mouseover",mouseleave:"mouseout"},Ane=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function Hk(r,n){return n&&`${n}::${fL++}`||r.uidEvent||fL++}function Gk(r){const n=Hk(r);return r.uidEvent=n,M1[n]=M1[n]||{},M1[n]}function wne(r,n){return function i(o){return _M(o,{delegateTarget:r}),i.oneOff&&nn.off(r,o.type,n),n.apply(r,[o])}}function Mne(r,n,i){return function o(l){const a=r.querySelectorAll(n);for(let{target:u}=l;u&&u!==this;u=u.parentNode)for(const h of a)if(h===u)return _M(l,{delegateTarget:u}),o.oneOff&&nn.off(r,l.type,n,i),i.apply(u,[l])}}function Vk(r,n,i=null){return Object.values(r).find(o=>o.callable===n&&o.delegationSelector===i)}function Wk(r,n,i){const o=typeof n=="string",l=o?i:n||i;let a=jk(r);return Ane.has(a)||(a=r),[o,l,a]}function pL(r,n,i,o,l){if(typeof n!="string"||!r)return;let[a,u,h]=Wk(n,i,o);n in zk&&(u=(A=>function(_){if(!_.relatedTarget||_.relatedTarget!==_.delegateTarget&&!_.delegateTarget.contains(_.relatedTarget))return A.call(this,_)})(u));const f=Gk(r),d=f[h]||(f[h]={}),m=Vk(d,u,a?i:null);if(m){m.oneOff=m.oneOff&&l;return}const g=Hk(u,n.replace(_ne,"")),x=a?Mne(r,i,u):wne(r,u);x.delegationSelector=a?i:null,x.callable=u,x.oneOff=l,x.uidEvent=g,d[g]=x,r.addEventListener(h,x,a)}function EA(r,n,i,o,l){const a=Vk(n[i],o,l);!a||(r.removeEventListener(i,a,Boolean(l)),delete n[i][a.uidEvent])}function Sne(r,n,i,o){const l=n[i]||{};for(const a of Object.keys(l))if(a.includes(o)){const u=l[a];EA(r,n,i,u.callable,u.delegationSelector)}}function jk(r){return r=r.replace(bne,""),zk[r]||r}const nn={on(r,n,i,o){pL(r,n,i,o,!1)},one(r,n,i,o){pL(r,n,i,o,!0)},off(r,n,i,o){if(typeof n!="string"||!r)return;const[l,a,u]=Wk(n,i,o),h=u!==n,f=Gk(r),d=f[u]||{},m=n.startsWith(".");if(typeof a<"u"){if(!Object.keys(d).length)return;EA(r,f,u,a,l?i:null);return}if(m)for(const g of Object.keys(f))Sne(r,f,g,n.slice(1));for(const g of Object.keys(d)){const x=g.replace(Ene,"");if(!h||n.includes(x)){const v=d[g];EA(r,f,u,v.callable,v.delegationSelector)}}},trigger(r,n,i){if(typeof n!="string"||!r)return null;const o=Bk(),l=jk(n),a=n!==l;let u=null,h=!0,f=!0,d=!1;a&&o&&(u=o.Event(n,i),o(r).trigger(u),h=!u.isPropagationStopped(),f=!u.isImmediatePropagationStopped(),d=u.isDefaultPrevented());let m=new Event(n,{bubbles:h,cancelable:!0});return m=_M(m,i),d&&m.preventDefault(),f&&r.dispatchEvent(m),m.defaultPrevented&&u&&u.preventDefault(),m}};function _M(r,n){for(const[i,o]of Object.entries(n||{}))try{r[i]=o}catch{Object.defineProperty(r,i,{configurable:!0,get(){return o}})}return r}const rc=new Map,S1={set(r,n,i){rc.has(r)||rc.set(r,new Map);const o=rc.get(r);if(!o.has(n)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(n,i)},get(r,n){return rc.has(r)&&rc.get(r).get(n)||null},remove(r,n){if(!rc.has(r))return;const i=rc.get(r);i.delete(n),i.size===0&&rc.delete(r)}};function mL(r){if(r==="true")return!0;if(r==="false")return!1;if(r===Number(r).toString())return Number(r);if(r===""||r==="null")return null;if(typeof r!="string")return r;try{return JSON.parse(decodeURIComponent(r))}catch{return r}}function T1(r){return r.replace(/[A-Z]/g,n=>`-${n.toLowerCase()}`)}const _l={setDataAttribute(r,n,i){r.setAttribute(`data-bs-${T1(n)}`,i)},removeDataAttribute(r,n){r.removeAttribute(`data-bs-${T1(n)}`)},getDataAttributes(r){if(!r)return{};const n={},i=Object.keys(r.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of i){let l=o.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1,l.length),n[l]=mL(r.dataset[o])}return n},getDataAttribute(r,n){return mL(r.getAttribute(`data-bs-${T1(n)}`))}};class Wm{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(n){return n=this._mergeConfigObj(n),n=this._configAfterMerge(n),this._typeCheckConfig(n),n}_configAfterMerge(n){return n}_mergeConfigObj(n,i){const o=xl(i)?_l.getDataAttribute(i,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...xl(i)?_l.getDataAttributes(i):{},...typeof n=="object"?n:{}}}_typeCheckConfig(n,i=this.constructor.DefaultType){for(const o of Object.keys(i)){const l=i[o],a=n[o],u=xl(a)?"element":gne(a);if(!new RegExp(l).test(u))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${u}" but expected type "${l}".`)}}}const Tne="5.2.3";class oa extends Wm{constructor(n,i){super(),n=Cc(n),n&&(this._element=n,this._config=this._getConfig(i),S1.set(this._element,this.constructor.DATA_KEY,this))}dispose(){S1.remove(this._element,this.constructor.DATA_KEY),nn.off(this._element,this.constructor.EVENT_KEY);for(const n of Object.getOwnPropertyNames(this))this[n]=null}_queueCallback(n,i,o=!0){Uk(n,i,o)}_getConfig(n){return n=this._mergeConfigObj(n,this._element),n=this._configAfterMerge(n),this._typeCheckConfig(n),n}static getInstance(n){return S1.get(Cc(n),this.DATA_KEY)}static getOrCreateInstance(n,i={}){return this.getInstance(n)||new this(n,typeof i=="object"?i:null)}static get VERSION(){return Tne}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(n){return`${n}${this.EVENT_KEY}`}}const cx=(r,n="hide")=>{const i=`click.dismiss${r.EVENT_KEY}`,o=r.NAME;nn.on(document,i,`[data-bs-dismiss="${o}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),Rc(this))return;const a=yl(this)||this.closest(`.${o}`);r.getOrCreateInstance(a)[n]()})},Cne="alert",Rne="bs.alert",$k=`.${Rne}`,Lne=`close${$k}`,Pne=`closed${$k}`,Dne="fade",One="show";class ux extends oa{static get NAME(){return Cne}close(){if(nn.trigger(this._element,Lne).defaultPrevented)return;this._element.classList.remove(One);const i=this._element.classList.contains(Dne);this._queueCallback(()=>this._destroyElement(),this._element,i)}_destroyElement(){this._element.remove(),nn.trigger(this._element,Pne),this.dispose()}static jQueryInterface(n){return this.each(function(){const i=ux.getOrCreateInstance(this);if(typeof n=="string"){if(i[n]===void 0||n.startsWith("_")||n==="constructor")throw new TypeError(`No method named "${n}"`);i[n](this)}})}}cx(ux,"close");Lo(ux);const Ine="button",kne="bs.button",Nne=`.${kne}`,Fne=".data-api",Bne="active",gL='[data-bs-toggle="button"]',Une=`click${Nne}${Fne}`;class hx extends oa{static get NAME(){return Ine}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(Bne))}static jQueryInterface(n){return this.each(function(){const i=hx.getOrCreateInstance(this);n==="toggle"&&i[n]()})}}nn.on(document,Une,gL,r=>{r.preventDefault();const n=r.target.closest(gL);hx.getOrCreateInstance(n).toggle()});Lo(hx);const Ci={find(r,n=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(n,r))},findOne(r,n=document.documentElement){return Element.prototype.querySelector.call(n,r)},children(r,n){return[].concat(...r.children).filter(i=>i.matches(n))},parents(r,n){const i=[];let o=r.parentNode.closest(n);for(;o;)i.push(o),o=o.parentNode.closest(n);return i},prev(r,n){let i=r.previousElementSibling;for(;i;){if(i.matches(n))return[i];i=i.previousElementSibling}return[]},next(r,n){let i=r.nextElementSibling;for(;i;){if(i.matches(n))return[i];i=i.nextElementSibling}return[]},focusableChildren(r){const n=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(i=>`${i}:not([tabindex^="-"])`).join(",");return this.find(n,r).filter(i=>!Rc(i)&&pf(i))}},zne="swipe",mf=".bs.swipe",Hne=`touchstart${mf}`,Gne=`touchmove${mf}`,Vne=`touchend${mf}`,Wne=`pointerdown${mf}`,jne=`pointerup${mf}`,$ne="touch",Xne="pen",qne="pointer-event",Yne=40,Kne={endCallback:null,leftCallback:null,rightCallback:null},Qne={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Sy extends Wm{constructor(n,i){super(),this._element=n,!(!n||!Sy.isSupported())&&(this._config=this._getConfig(i),this._deltaX=0,this._supportPointerEvents=Boolean(window.PointerEvent),this._initEvents())}static get Default(){return Kne}static get DefaultType(){return Qne}static get NAME(){return zne}dispose(){nn.off(this._element,mf)}_start(n){if(!this._supportPointerEvents){this._deltaX=n.touches[0].clientX;return}this._eventIsPointerPenTouch(n)&&(this._deltaX=n.clientX)}_end(n){this._eventIsPointerPenTouch(n)&&(this._deltaX=n.clientX-this._deltaX),this._handleSwipe(),ul(this._config.endCallback)}_move(n){this._deltaX=n.touches&&n.touches.length>1?0:n.touches[0].clientX-this._deltaX}_handleSwipe(){const n=Math.abs(this._deltaX);if(n<=Yne)return;const i=n/this._deltaX;this._deltaX=0,i&&ul(i>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(nn.on(this._element,Wne,n=>this._start(n)),nn.on(this._element,jne,n=>this._end(n)),this._element.classList.add(qne)):(nn.on(this._element,Hne,n=>this._start(n)),nn.on(this._element,Gne,n=>this._move(n)),nn.on(this._element,Vne,n=>this._end(n)))}_eventIsPointerPenTouch(n){return this._supportPointerEvents&&(n.pointerType===Xne||n.pointerType===$ne)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const Zne="carousel",Jne="bs.carousel",Nc=`.${Jne}`,Xk=".data-api",eie="ArrowLeft",tie="ArrowRight",nie=500,Mp="next",ad="prev",hd="left",H0="right",iie=`slide${Nc}`,C1=`slid${Nc}`,rie=`keydown${Nc}`,sie=`mouseenter${Nc}`,oie=`mouseleave${Nc}`,aie=`dragstart${Nc}`,lie=`load${Nc}${Xk}`,cie=`click${Nc}${Xk}`,qk="carousel",d0="active",uie="slide",hie="carousel-item-end",die="carousel-item-start",fie="carousel-item-next",pie="carousel-item-prev",Yk=".active",Kk=".carousel-item",mie=Yk+Kk,gie=".carousel-item img",vie=".carousel-indicators",yie="[data-bs-slide], [data-bs-slide-to]",xie='[data-bs-ride="carousel"]',_ie={[eie]:H0,[tie]:hd},bie={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Eie={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class jm extends oa{constructor(n,i){super(n,i),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Ci.findOne(vie,this._element),this._addEventListeners(),this._config.ride===qk&&this.cycle()}static get Default(){return bie}static get DefaultType(){return Eie}static get NAME(){return Zne}next(){this._slide(Mp)}nextWhenVisible(){!document.hidden&&pf(this._element)&&this.next()}prev(){this._slide(ad)}pause(){this._isSliding&&Nk(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(!!this._config.ride){if(this._isSliding){nn.one(this._element,C1,()=>this.cycle());return}this.cycle()}}to(n){const i=this._getItems();if(n>i.length-1||n<0)return;if(this._isSliding){nn.one(this._element,C1,()=>this.to(n));return}const o=this._getItemIndex(this._getActive());if(o===n)return;const l=n>o?Mp:ad;this._slide(l,i[n])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(n){return n.defaultInterval=n.interval,n}_addEventListeners(){this._config.keyboard&&nn.on(this._element,rie,n=>this._keydown(n)),this._config.pause==="hover"&&(nn.on(this._element,sie,()=>this.pause()),nn.on(this._element,oie,()=>this._maybeEnableCycle())),this._config.touch&&Sy.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of Ci.find(gie,this._element))nn.on(o,aie,l=>l.preventDefault());const i={leftCallback:()=>this._slide(this._directionToOrder(hd)),rightCallback:()=>this._slide(this._directionToOrder(H0)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),nie+this._config.interval))}};this._swipeHelper=new Sy(this._element,i)}_keydown(n){if(/input|textarea/i.test(n.target.tagName))return;const i=_ie[n.key];i&&(n.preventDefault(),this._slide(this._directionToOrder(i)))}_getItemIndex(n){return this._getItems().indexOf(n)}_setActiveIndicatorElement(n){if(!this._indicatorsElement)return;const i=Ci.findOne(Yk,this._indicatorsElement);i.classList.remove(d0),i.removeAttribute("aria-current");const o=Ci.findOne(`[data-bs-slide-to="${n}"]`,this._indicatorsElement);o&&(o.classList.add(d0),o.setAttribute("aria-current","true"))}_updateInterval(){const n=this._activeElement||this._getActive();if(!n)return;const i=Number.parseInt(n.getAttribute("data-bs-interval"),10);this._config.interval=i||this._config.defaultInterval}_slide(n,i=null){if(this._isSliding)return;const o=this._getActive(),l=n===Mp,a=i||xM(this._getItems(),o,l,this._config.wrap);if(a===o)return;const u=this._getItemIndex(a),h=v=>nn.trigger(this._element,v,{relatedTarget:a,direction:this._orderToDirection(n),from:this._getItemIndex(o),to:u});if(h(iie).defaultPrevented||!o||!a)return;const d=Boolean(this._interval);this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(u),this._activeElement=a;const m=l?die:hie,g=l?fie:pie;a.classList.add(g),Vm(a),o.classList.add(m),a.classList.add(m);const x=()=>{a.classList.remove(m,g),a.classList.add(d0),o.classList.remove(d0,g,m),this._isSliding=!1,h(C1)};this._queueCallback(x,o,this._isAnimated()),d&&this.cycle()}_isAnimated(){return this._element.classList.contains(uie)}_getActive(){return Ci.findOne(mie,this._element)}_getItems(){return Ci.find(Kk,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(n){return Co()?n===hd?ad:Mp:n===hd?Mp:ad}_orderToDirection(n){return Co()?n===ad?hd:H0:n===ad?H0:hd}static jQueryInterface(n){return this.each(function(){const i=jm.getOrCreateInstance(this,n);if(typeof n=="number"){i.to(n);return}if(typeof n=="string"){if(i[n]===void 0||n.startsWith("_")||n==="constructor")throw new TypeError(`No method named "${n}"`);i[n]()}})}}nn.on(document,cie,yie,function(r){const n=yl(this);if(!n||!n.classList.contains(qk))return;r.preventDefault();const i=jm.getOrCreateInstance(n),o=this.getAttribute("data-bs-slide-to");if(o){i.to(o),i._maybeEnableCycle();return}if(_l.getDataAttribute(this,"slide")==="next"){i.next(),i._maybeEnableCycle();return}i.prev(),i._maybeEnableCycle()});nn.on(window,lie,()=>{const r=Ci.find(xie);for(const n of r)jm.getOrCreateInstance(n)});Lo(jm);const Aie="collapse",wie="bs.collapse",$m=`.${wie}`,Mie=".data-api",Sie=`show${$m}`,Tie=`shown${$m}`,Cie=`hide${$m}`,Rie=`hidden${$m}`,Lie=`click${$m}${Mie}`,R1="show",Rd="collapse",f0="collapsing",Pie="collapsed",Die=`:scope .${Rd} .${Rd}`,Oie="collapse-horizontal",Iie="width",kie="height",Nie=".collapse.show, .collapse.collapsing",AA='[data-bs-toggle="collapse"]',Fie={parent:null,toggle:!0},Bie={parent:"(null|element)",toggle:"boolean"};class Cm extends oa{constructor(n,i){super(n,i),this._isTransitioning=!1,this._triggerArray=[];const o=Ci.find(AA);for(const l of o){const a=kk(l),u=Ci.find(a).filter(h=>h===this._element);a!==null&&u.length&&this._triggerArray.push(l)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return Fie}static get DefaultType(){return Bie}static get NAME(){return Aie}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let n=[];if(this._config.parent&&(n=this._getFirstLevelChildren(Nie).filter(h=>h!==this._element).map(h=>Cm.getOrCreateInstance(h,{toggle:!1}))),n.length&&n[0]._isTransitioning||nn.trigger(this._element,Sie).defaultPrevented)return;for(const h of n)h.hide();const o=this._getDimension();this._element.classList.remove(Rd),this._element.classList.add(f0),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(f0),this._element.classList.add(Rd,R1),this._element.style[o]="",nn.trigger(this._element,Tie)},u=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(l,this._element,!0),this._element.style[o]=`${this._element[u]}px`}hide(){if(this._isTransitioning||!this._isShown()||nn.trigger(this._element,Cie).defaultPrevented)return;const i=this._getDimension();this._element.style[i]=`${this._element.getBoundingClientRect()[i]}px`,Vm(this._element),this._element.classList.add(f0),this._element.classList.remove(Rd,R1);for(const l of this._triggerArray){const a=yl(l);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([l],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(f0),this._element.classList.add(Rd),nn.trigger(this._element,Rie)};this._element.style[i]="",this._queueCallback(o,this._element,!0)}_isShown(n=this._element){return n.classList.contains(R1)}_configAfterMerge(n){return n.toggle=Boolean(n.toggle),n.parent=Cc(n.parent),n}_getDimension(){return this._element.classList.contains(Oie)?Iie:kie}_initializeChildren(){if(!this._config.parent)return;const n=this._getFirstLevelChildren(AA);for(const i of n){const o=yl(i);o&&this._addAriaAndCollapsedClass([i],this._isShown(o))}}_getFirstLevelChildren(n){const i=Ci.find(Die,this._config.parent);return Ci.find(n,this._config.parent).filter(o=>!i.includes(o))}_addAriaAndCollapsedClass(n,i){if(!!n.length)for(const o of n)o.classList.toggle(Pie,!i),o.setAttribute("aria-expanded",i)}static jQueryInterface(n){const i={};return typeof n=="string"&&/show|hide/.test(n)&&(i.toggle=!1),this.each(function(){const o=Cm.getOrCreateInstance(this,i);if(typeof n=="string"){if(typeof o[n]>"u")throw new TypeError(`No method named "${n}"`);o[n]()}})}}nn.on(document,Lie,AA,function(r){(r.target.tagName==="A"||r.delegateTarget&&r.delegateTarget.tagName==="A")&&r.preventDefault();const n=kk(this),i=Ci.find(n);for(const o of i)Cm.getOrCreateInstance(o,{toggle:!1}).toggle()});Lo(Cm);const vL="dropdown",Uie="bs.dropdown",Ku=`.${Uie}`,bM=".data-api",zie="Escape",yL="Tab",Hie="ArrowUp",xL="ArrowDown",Gie=2,Vie=`hide${Ku}`,Wie=`hidden${Ku}`,jie=`show${Ku}`,$ie=`shown${Ku}`,Qk=`click${Ku}${bM}`,Zk=`keydown${Ku}${bM}`,Xie=`keyup${Ku}${bM}`,dd="show",qie="dropup",Yie="dropend",Kie="dropstart",Qie="dropup-center",Zie="dropdown-center",Tu='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Jie=`${Tu}.${dd}`,G0=".dropdown-menu",ere=".navbar",tre=".navbar-nav",nre=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",ire=Co()?"top-end":"top-start",rre=Co()?"top-start":"top-end",sre=Co()?"bottom-end":"bottom-start",ore=Co()?"bottom-start":"bottom-end",are=Co()?"left-start":"right-start",lre=Co()?"right-start":"left-start",cre="top",ure="bottom",hre={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},dre={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class La extends oa{constructor(n,i){super(n,i),this._popper=null,this._parent=this._element.parentNode,this._menu=Ci.next(this._element,G0)[0]||Ci.prev(this._element,G0)[0]||Ci.findOne(G0,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return hre}static get DefaultType(){return dre}static get NAME(){return vL}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Rc(this._element)||this._isShown())return;const n={relatedTarget:this._element};if(!nn.trigger(this._element,jie,n).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(tre))for(const o of[].concat(...document.body.children))nn.on(o,"mouseover",My);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(dd),this._element.classList.add(dd),nn.trigger(this._element,$ie,n)}}hide(){if(Rc(this._element)||!this._isShown())return;const n={relatedTarget:this._element};this._completeHide(n)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(n){if(!nn.trigger(this._element,Vie,n).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))nn.off(o,"mouseover",My);this._popper&&this._popper.destroy(),this._menu.classList.remove(dd),this._element.classList.remove(dd),this._element.setAttribute("aria-expanded","false"),_l.removeDataAttribute(this._menu,"popper"),nn.trigger(this._element,Wie,n)}}_getConfig(n){if(n=super._getConfig(n),typeof n.reference=="object"&&!xl(n.reference)&&typeof n.reference.getBoundingClientRect!="function")throw new TypeError(`${vL.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return n}_createPopper(){if(typeof Ok>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let n=this._element;this._config.reference==="parent"?n=this._parent:xl(this._config.reference)?n=Cc(this._config.reference):typeof this._config.reference=="object"&&(n=this._config.reference);const i=this._getPopperConfig();this._popper=yM(n,this._menu,i)}_isShown(){return this._menu.classList.contains(dd)}_getPlacement(){const n=this._parent;if(n.classList.contains(Yie))return are;if(n.classList.contains(Kie))return lre;if(n.classList.contains(Qie))return cre;if(n.classList.contains(Zie))return ure;const i=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return n.classList.contains(qie)?i?rre:ire:i?ore:sre}_detectNavbar(){return this._element.closest(ere)!==null}_getOffset(){const{offset:n}=this._config;return typeof n=="string"?n.split(",").map(i=>Number.parseInt(i,10)):typeof n=="function"?i=>n(i,this._element):n}_getPopperConfig(){const n={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(_l.setDataAttribute(this._menu,"popper","static"),n.modifiers=[{name:"applyStyles",enabled:!1}]),{...n,...typeof this._config.popperConfig=="function"?this._config.popperConfig(n):this._config.popperConfig}}_selectMenuItem({key:n,target:i}){const o=Ci.find(nre,this._menu).filter(l=>pf(l));!o.length||xM(o,i,n===xL,!o.includes(i)).focus()}static jQueryInterface(n){return this.each(function(){const i=La.getOrCreateInstance(this,n);if(typeof n=="string"){if(typeof i[n]>"u")throw new TypeError(`No method named "${n}"`);i[n]()}})}static clearMenus(n){if(n.button===Gie||n.type==="keyup"&&n.key!==yL)return;const i=Ci.find(Jie);for(const o of i){const l=La.getInstance(o);if(!l||l._config.autoClose===!1)continue;const a=n.composedPath(),u=a.includes(l._menu);if(a.includes(l._element)||l._config.autoClose==="inside"&&!u||l._config.autoClose==="outside"&&u||l._menu.contains(n.target)&&(n.type==="keyup"&&n.key===yL||/input|select|option|textarea|form/i.test(n.target.tagName)))continue;const h={relatedTarget:l._element};n.type==="click"&&(h.clickEvent=n),l._completeHide(h)}}static dataApiKeydownHandler(n){const i=/input|textarea/i.test(n.target.tagName),o=n.key===zie,l=[Hie,xL].includes(n.key);if(!l&&!o||i&&!o)return;n.preventDefault();const a=this.matches(Tu)?this:Ci.prev(this,Tu)[0]||Ci.next(this,Tu)[0]||Ci.findOne(Tu,n.delegateTarget.parentNode),u=La.getOrCreateInstance(a);if(l){n.stopPropagation(),u.show(),u._selectMenuItem(n);return}u._isShown()&&(n.stopPropagation(),u.hide(),a.focus())}}nn.on(document,Zk,Tu,La.dataApiKeydownHandler);nn.on(document,Zk,G0,La.dataApiKeydownHandler);nn.on(document,Qk,La.clearMenus);nn.on(document,Xie,La.clearMenus);nn.on(document,Qk,Tu,function(r){r.preventDefault(),La.getOrCreateInstance(this).toggle()});Lo(La);const _L=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",bL=".sticky-top",p0="padding-right",EL="margin-right";class wA{constructor(){this._element=document.body}getWidth(){const n=document.documentElement.clientWidth;return Math.abs(window.innerWidth-n)}hide(){const n=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,p0,i=>i+n),this._setElementAttributes(_L,p0,i=>i+n),this._setElementAttributes(bL,EL,i=>i-n)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,p0),this._resetElementAttributes(_L,p0),this._resetElementAttributes(bL,EL)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(n,i,o){const l=this.getWidth(),a=u=>{if(u!==this._element&&window.innerWidth>u.clientWidth+l)return;this._saveInitialAttribute(u,i);const h=window.getComputedStyle(u).getPropertyValue(i);u.style.setProperty(i,`${o(Number.parseFloat(h))}px`)};this._applyManipulationCallback(n,a)}_saveInitialAttribute(n,i){const o=n.style.getPropertyValue(i);o&&_l.setDataAttribute(n,i,o)}_resetElementAttributes(n,i){const o=l=>{const a=_l.getDataAttribute(l,i);if(a===null){l.style.removeProperty(i);return}_l.removeDataAttribute(l,i),l.style.setProperty(i,a)};this._applyManipulationCallback(n,o)}_applyManipulationCallback(n,i){if(xl(n)){i(n);return}for(const o of Ci.find(n,this._element))i(o)}}const Jk="backdrop",fre="fade",AL="show",wL=`mousedown.bs.${Jk}`,pre={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},mre={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class eN extends Wm{constructor(n){super(),this._config=this._getConfig(n),this._isAppended=!1,this._element=null}static get Default(){return pre}static get DefaultType(){return mre}static get NAME(){return Jk}show(n){if(!this._config.isVisible){ul(n);return}this._append();const i=this._getElement();this._config.isAnimated&&Vm(i),i.classList.add(AL),this._emulateAnimation(()=>{ul(n)})}hide(n){if(!this._config.isVisible){ul(n);return}this._getElement().classList.remove(AL),this._emulateAnimation(()=>{this.dispose(),ul(n)})}dispose(){!this._isAppended||(nn.off(this._element,wL),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const n=document.createElement("div");n.className=this._config.className,this._config.isAnimated&&n.classList.add(fre),this._element=n}return this._element}_configAfterMerge(n){return n.rootElement=Cc(n.rootElement),n}_append(){if(this._isAppended)return;const n=this._getElement();this._config.rootElement.append(n),nn.on(n,wL,()=>{ul(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(n){Uk(n,this._getElement(),this._config.isAnimated)}}const gre="focustrap",vre="bs.focustrap",Ty=`.${vre}`,yre=`focusin${Ty}`,xre=`keydown.tab${Ty}`,_re="Tab",bre="forward",ML="backward",Ere={autofocus:!0,trapElement:null},Are={autofocus:"boolean",trapElement:"element"};class tN extends Wm{constructor(n){super(),this._config=this._getConfig(n),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Ere}static get DefaultType(){return Are}static get NAME(){return gre}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),nn.off(document,Ty),nn.on(document,yre,n=>this._handleFocusin(n)),nn.on(document,xre,n=>this._handleKeydown(n)),this._isActive=!0)}deactivate(){!this._isActive||(this._isActive=!1,nn.off(document,Ty))}_handleFocusin(n){const{trapElement:i}=this._config;if(n.target===document||n.target===i||i.contains(n.target))return;const o=Ci.focusableChildren(i);o.length===0?i.focus():this._lastTabNavDirection===ML?o[o.length-1].focus():o[0].focus()}_handleKeydown(n){n.key===_re&&(this._lastTabNavDirection=n.shiftKey?ML:bre)}}const wre="modal",Mre="bs.modal",aa=`.${Mre}`,Sre=".data-api",Tre="Escape",Cre=`hide${aa}`,Rre=`hidePrevented${aa}`,nN=`hidden${aa}`,iN=`show${aa}`,Lre=`shown${aa}`,Pre=`resize${aa}`,Dre=`click.dismiss${aa}`,Ore=`mousedown.dismiss${aa}`,Ire=`keydown.dismiss${aa}`,kre=`click${aa}${Sre}`,SL="modal-open",Nre="fade",TL="show",L1="modal-static",Fre=".modal.show",Bre=".modal-dialog",Ure=".modal-body",zre='[data-bs-toggle="modal"]',Hre={backdrop:!0,focus:!0,keyboard:!0},Gre={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class sf extends oa{constructor(n,i){super(n,i),this._dialog=Ci.findOne(Bre,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new wA,this._addEventListeners()}static get Default(){return Hre}static get DefaultType(){return Gre}static get NAME(){return wre}toggle(n){return this._isShown?this.hide():this.show(n)}show(n){this._isShown||this._isTransitioning||nn.trigger(this._element,iN,{relatedTarget:n}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(SL),this._adjustDialog(),this._backdrop.show(()=>this._showElement(n)))}hide(){!this._isShown||this._isTransitioning||nn.trigger(this._element,Cre).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(TL),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){for(const n of[window,this._dialog])nn.off(n,aa);this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new eN({isVisible:Boolean(this._config.backdrop),isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new tN({trapElement:this._element})}_showElement(n){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const i=Ci.findOne(Ure,this._dialog);i&&(i.scrollTop=0),Vm(this._element),this._element.classList.add(TL);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,nn.trigger(this._element,Lre,{relatedTarget:n})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){nn.on(this._element,Ire,n=>{if(n.key===Tre){if(this._config.keyboard){n.preventDefault(),this.hide();return}this._triggerBackdropTransition()}}),nn.on(window,Pre,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),nn.on(this._element,Ore,n=>{nn.one(this._element,Dre,i=>{if(!(this._element!==n.target||this._element!==i.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(SL),this._resetAdjustments(),this._scrollBar.reset(),nn.trigger(this._element,nN)})}_isAnimated(){return this._element.classList.contains(Nre)}_triggerBackdropTransition(){if(nn.trigger(this._element,Rre).defaultPrevented)return;const i=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(L1)||(i||(this._element.style.overflowY="hidden"),this._element.classList.add(L1),this._queueCallback(()=>{this._element.classList.remove(L1),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const n=this._element.scrollHeight>document.documentElement.clientHeight,i=this._scrollBar.getWidth(),o=i>0;if(o&&!n){const l=Co()?"paddingLeft":"paddingRight";this._element.style[l]=`${i}px`}if(!o&&n){const l=Co()?"paddingRight":"paddingLeft";this._element.style[l]=`${i}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(n,i){return this.each(function(){const o=sf.getOrCreateInstance(this,n);if(typeof n=="string"){if(typeof o[n]>"u")throw new TypeError(`No method named "${n}"`);o[n](i)}})}}nn.on(document,kre,zre,function(r){const n=yl(this);["A","AREA"].includes(this.tagName)&&r.preventDefault(),nn.one(n,iN,l=>{l.defaultPrevented||nn.one(n,nN,()=>{pf(this)&&this.focus()})});const i=Ci.findOne(Fre);i&&sf.getInstance(i).hide(),sf.getOrCreateInstance(n).toggle(this)});cx(sf);Lo(sf);const Vre="offcanvas",Wre="bs.offcanvas",Ll=`.${Wre}`,rN=".data-api",jre=`load${Ll}${rN}`,$re="Escape",CL="show",RL="showing",LL="hiding",Xre="offcanvas-backdrop",sN=".offcanvas.show",qre=`show${Ll}`,Yre=`shown${Ll}`,Kre=`hide${Ll}`,PL=`hidePrevented${Ll}`,oN=`hidden${Ll}`,Qre=`resize${Ll}`,Zre=`click${Ll}${rN}`,Jre=`keydown.dismiss${Ll}`,ese='[data-bs-toggle="offcanvas"]',tse={backdrop:!0,keyboard:!0,scroll:!1},nse={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class Lc extends oa{constructor(n,i){super(n,i),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return tse}static get DefaultType(){return nse}static get NAME(){return Vre}toggle(n){return this._isShown?this.hide():this.show(n)}show(n){if(this._isShown||nn.trigger(this._element,qre,{relatedTarget:n}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new wA().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(RL);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(CL),this._element.classList.remove(RL),nn.trigger(this._element,Yre,{relatedTarget:n})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||nn.trigger(this._element,Kre).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(LL),this._backdrop.hide();const i=()=>{this._element.classList.remove(CL,LL),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new wA().reset(),nn.trigger(this._element,oN)};this._queueCallback(i,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const n=()=>{if(this._config.backdrop==="static"){nn.trigger(this._element,PL);return}this.hide()},i=Boolean(this._config.backdrop);return new eN({className:Xre,isVisible:i,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:i?n:null})}_initializeFocusTrap(){return new tN({trapElement:this._element})}_addEventListeners(){nn.on(this._element,Jre,n=>{if(n.key===$re){if(!this._config.keyboard){nn.trigger(this._element,PL);return}this.hide()}})}static jQueryInterface(n){return this.each(function(){const i=Lc.getOrCreateInstance(this,n);if(typeof n=="string"){if(i[n]===void 0||n.startsWith("_")||n==="constructor")throw new TypeError(`No method named "${n}"`);i[n](this)}})}}nn.on(document,Zre,ese,function(r){const n=yl(this);if(["A","AREA"].includes(this.tagName)&&r.preventDefault(),Rc(this))return;nn.one(n,oN,()=>{pf(this)&&this.focus()});const i=Ci.findOne(sN);i&&i!==n&&Lc.getInstance(i).hide(),Lc.getOrCreateInstance(n).toggle(this)});nn.on(window,jre,()=>{for(const r of Ci.find(sN))Lc.getOrCreateInstance(r).show()});nn.on(window,Qre,()=>{for(const r of Ci.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(r).position!=="fixed"&&Lc.getOrCreateInstance(r).hide()});cx(Lc);Lo(Lc);const ise=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),rse=/^aria-[\w-]*$/i,sse=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^#&/:?]*(?:[#/?]|$))/i,ose=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i,ase=(r,n)=>{const i=r.nodeName.toLowerCase();return n.includes(i)?ise.has(i)?Boolean(sse.test(r.nodeValue)||ose.test(r.nodeValue)):!0:n.filter(o=>o instanceof RegExp).some(o=>o.test(i))},aN={"*":["class","dir","id","lang","role",rse],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]};function lse(r,n,i){if(!r.length)return r;if(i&&typeof i=="function")return i(r);const l=new window.DOMParser().parseFromString(r,"text/html"),a=[].concat(...l.body.querySelectorAll("*"));for(const u of a){const h=u.nodeName.toLowerCase();if(!Object.keys(n).includes(h)){u.remove();continue}const f=[].concat(...u.attributes),d=[].concat(n["*"]||[],n[h]||[]);for(const m of f)ase(m,d)||u.removeAttribute(m.nodeName)}return l.body.innerHTML}const cse="TemplateFactory",use={allowList:aN,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},hse={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},dse={entry:"(string|element|function|null)",selector:"(string|element)"};class fse extends Wm{constructor(n){super(),this._config=this._getConfig(n)}static get Default(){return use}static get DefaultType(){return hse}static get NAME(){return cse}getContent(){return Object.values(this._config.content).map(n=>this._resolvePossibleFunction(n)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(n){return this._checkContent(n),this._config.content={...this._config.content,...n},this}toHtml(){const n=document.createElement("div");n.innerHTML=this._maybeSanitize(this._config.template);for(const[l,a]of Object.entries(this._config.content))this._setContent(n,a,l);const i=n.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&i.classList.add(...o.split(" ")),i}_typeCheckConfig(n){super._typeCheckConfig(n),this._checkContent(n.content)}_checkContent(n){for(const[i,o]of Object.entries(n))super._typeCheckConfig({selector:i,entry:o},dse)}_setContent(n,i,o){const l=Ci.findOne(o,n);if(!!l){if(i=this._resolvePossibleFunction(i),!i){l.remove();return}if(xl(i)){this._putElementInTemplate(Cc(i),l);return}if(this._config.html){l.innerHTML=this._maybeSanitize(i);return}l.textContent=i}}_maybeSanitize(n){return this._config.sanitize?lse(n,this._config.allowList,this._config.sanitizeFn):n}_resolvePossibleFunction(n){return typeof n=="function"?n(this):n}_putElementInTemplate(n,i){if(this._config.html){i.innerHTML="",i.append(n);return}i.textContent=n.textContent}}const pse="tooltip",mse=new Set(["sanitize","allowList","sanitizeFn"]),P1="fade",gse="modal",m0="show",vse=".tooltip-inner",DL=`.${gse}`,OL="hide.bs.modal",Sp="hover",D1="focus",yse="click",xse="manual",_se="hide",bse="hidden",Ese="show",Ase="shown",wse="inserted",Mse="click",Sse="focusin",Tse="focusout",Cse="mouseenter",Rse="mouseleave",Lse={AUTO:"auto",TOP:"top",RIGHT:Co()?"left":"right",BOTTOM:"bottom",LEFT:Co()?"right":"left"},Pse={allowList:aN,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,0],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},Dse={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class gf extends oa{constructor(n,i){if(typeof Ok>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(n,i),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Pse}static get DefaultType(){return Dse}static get NAME(){return pse}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(!!this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),nn.off(this._element.closest(DL),OL,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const n=nn.trigger(this._element,this.constructor.eventName(Ese)),o=(Fk(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(n.defaultPrevented||!o)return;this._disposePopper();const l=this._getTipElement();this._element.setAttribute("aria-describedby",l.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(l),nn.trigger(this._element,this.constructor.eventName(wse))),this._popper=this._createPopper(l),l.classList.add(m0),"ontouchstart"in document.documentElement)for(const h of[].concat(...document.body.children))nn.on(h,"mouseover",My);const u=()=>{nn.trigger(this._element,this.constructor.eventName(Ase)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(u,this.tip,this._isAnimated())}hide(){if(!this._isShown()||nn.trigger(this._element,this.constructor.eventName(_se)).defaultPrevented)return;if(this._getTipElement().classList.remove(m0),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))nn.off(l,"mouseover",My);this._activeTrigger[yse]=!1,this._activeTrigger[D1]=!1,this._activeTrigger[Sp]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),nn.trigger(this._element,this.constructor.eventName(bse)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return Boolean(this._getTitle())}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(n){const i=this._getTemplateFactory(n).toHtml();if(!i)return null;i.classList.remove(P1,m0),i.classList.add(`bs-${this.constructor.NAME}-auto`);const o=vne(this.constructor.NAME).toString();return i.setAttribute("id",o),this._isAnimated()&&i.classList.add(P1),i}setContent(n){this._newContent=n,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(n){return this._templateFactory?this._templateFactory.changeContent(n):this._templateFactory=new fse({...this._config,content:n,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[vse]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(n){return this.constructor.getOrCreateInstance(n.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(P1)}_isShown(){return this.tip&&this.tip.classList.contains(m0)}_createPopper(n){const i=typeof this._config.placement=="function"?this._config.placement.call(this,n,this._element):this._config.placement,o=Lse[i.toUpperCase()];return yM(this._element,n,this._getPopperConfig(o))}_getOffset(){const{offset:n}=this._config;return typeof n=="string"?n.split(",").map(i=>Number.parseInt(i,10)):typeof n=="function"?i=>n(i,this._element):n}_resolvePossibleFunction(n){return typeof n=="function"?n.call(this._element):n}_getPopperConfig(n){const i={placement:n,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...i,...typeof this._config.popperConfig=="function"?this._config.popperConfig(i):this._config.popperConfig}}_setListeners(){const n=this._config.trigger.split(" ");for(const i of n)if(i==="click")nn.on(this._element,this.constructor.eventName(Mse),this._config.selector,o=>{this._initializeOnDelegatedTarget(o).toggle()});else if(i!==xse){const o=i===Sp?this.constructor.eventName(Cse):this.constructor.eventName(Sse),l=i===Sp?this.constructor.eventName(Rse):this.constructor.eventName(Tse);nn.on(this._element,o,this._config.selector,a=>{const u=this._initializeOnDelegatedTarget(a);u._activeTrigger[a.type==="focusin"?D1:Sp]=!0,u._enter()}),nn.on(this._element,l,this._config.selector,a=>{const u=this._initializeOnDelegatedTarget(a);u._activeTrigger[a.type==="focusout"?D1:Sp]=u._element.contains(a.relatedTarget),u._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},nn.on(this._element.closest(DL),OL,this._hideModalHandler)}_fixTitle(){const n=this._element.getAttribute("title");!n||(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",n),this._element.setAttribute("data-bs-original-title",n),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(n,i){clearTimeout(this._timeout),this._timeout=setTimeout(n,i)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(n){const i=_l.getDataAttributes(this._element);for(const o of Object.keys(i))mse.has(o)&&delete i[o];return n={...i,...typeof n=="object"&&n?n:{}},n=this._mergeConfigObj(n),n=this._configAfterMerge(n),this._typeCheckConfig(n),n}_configAfterMerge(n){return n.container=n.container===!1?document.body:Cc(n.container),typeof n.delay=="number"&&(n.delay={show:n.delay,hide:n.delay}),typeof n.title=="number"&&(n.title=n.title.toString()),typeof n.content=="number"&&(n.content=n.content.toString()),n}_getDelegateConfig(){const n={};for(const i in this._config)this.constructor.Default[i]!==this._config[i]&&(n[i]=this._config[i]);return n.selector=!1,n.trigger="manual",n}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(n){return this.each(function(){const i=gf.getOrCreateInstance(this,n);if(typeof n=="string"){if(typeof i[n]>"u")throw new TypeError(`No method named "${n}"`);i[n]()}})}}Lo(gf);const Ose="popover",Ise=".popover-header",kse=".popover-body",Nse={...gf.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},Fse={...gf.DefaultType,content:"(null|string|element|function)"};class EM extends gf{static get Default(){return Nse}static get DefaultType(){return Fse}static get NAME(){return Ose}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[Ise]:this._getTitle(),[kse]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(n){return this.each(function(){const i=EM.getOrCreateInstance(this,n);if(typeof n=="string"){if(typeof i[n]>"u")throw new TypeError(`No method named "${n}"`);i[n]()}})}}Lo(EM);const Bse="scrollspy",Use="bs.scrollspy",AM=`.${Use}`,zse=".data-api",Hse=`activate${AM}`,IL=`click${AM}`,Gse=`load${AM}${zse}`,Vse="dropdown-item",ld="active",Wse='[data-bs-spy="scroll"]',O1="[href]",jse=".nav, .list-group",kL=".nav-link",$se=".nav-item",Xse=".list-group-item",qse=`${kL}, ${$se} > ${kL}, ${Xse}`,Yse=".dropdown",Kse=".dropdown-toggle",Qse={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},Zse={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class dx extends oa{constructor(n,i){super(n,i),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return Qse}static get DefaultType(){return Zse}static get NAME(){return Bse}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const n of this._observableSections.values())this._observer.observe(n)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(n){return n.target=Cc(n.target)||document.body,n.rootMargin=n.offset?`${n.offset}px 0px -30%`:n.rootMargin,typeof n.threshold=="string"&&(n.threshold=n.threshold.split(",").map(i=>Number.parseFloat(i))),n}_maybeEnableSmoothScroll(){!this._config.smoothScroll||(nn.off(this._config.target,IL),nn.on(this._config.target,IL,O1,n=>{const i=this._observableSections.get(n.target.hash);if(i){n.preventDefault();const o=this._rootElement||window,l=i.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:l,behavior:"smooth"});return}o.scrollTop=l}}))}_getNewObserver(){const n={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(i=>this._observerCallback(i),n)}_observerCallback(n){const i=u=>this._targetLinks.get(`#${u.target.id}`),o=u=>{this._previousScrollData.visibleEntryTop=u.target.offsetTop,this._process(i(u))},l=(this._rootElement||document.documentElement).scrollTop,a=l>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=l;for(const u of n){if(!u.isIntersecting){this._activeTarget=null,this._clearActiveClass(i(u));continue}const h=u.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&h){if(o(u),!l)return;continue}!a&&!h&&o(u)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const n=Ci.find(O1,this._config.target);for(const i of n){if(!i.hash||Rc(i))continue;const o=Ci.findOne(i.hash,this._element);pf(o)&&(this._targetLinks.set(i.hash,i),this._observableSections.set(i.hash,o))}}_process(n){this._activeTarget!==n&&(this._clearActiveClass(this._config.target),this._activeTarget=n,n.classList.add(ld),this._activateParents(n),nn.trigger(this._element,Hse,{relatedTarget:n}))}_activateParents(n){if(n.classList.contains(Vse)){Ci.findOne(Kse,n.closest(Yse)).classList.add(ld);return}for(const i of Ci.parents(n,jse))for(const o of Ci.prev(i,qse))o.classList.add(ld)}_clearActiveClass(n){n.classList.remove(ld);const i=Ci.find(`${O1}.${ld}`,n);for(const o of i)o.classList.remove(ld)}static jQueryInterface(n){return this.each(function(){const i=dx.getOrCreateInstance(this,n);if(typeof n=="string"){if(i[n]===void 0||n.startsWith("_")||n==="constructor")throw new TypeError(`No method named "${n}"`);i[n]()}})}}nn.on(window,Gse,()=>{for(const r of Ci.find(Wse))dx.getOrCreateInstance(r)});Lo(dx);const Jse="tab",eoe="bs.tab",Qu=`.${eoe}`,toe=`hide${Qu}`,noe=`hidden${Qu}`,ioe=`show${Qu}`,roe=`shown${Qu}`,soe=`click${Qu}`,ooe=`keydown${Qu}`,aoe=`load${Qu}`,loe="ArrowLeft",NL="ArrowRight",coe="ArrowUp",FL="ArrowDown",Cu="active",BL="fade",I1="show",uoe="dropdown",hoe=".dropdown-toggle",doe=".dropdown-menu",k1=":not(.dropdown-toggle)",foe='.list-group, .nav, [role="tablist"]',poe=".nav-item, .list-group-item",moe=`.nav-link${k1}, .list-group-item${k1}, [role="tab"]${k1}`,lN='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',N1=`${moe}, ${lN}`,goe=`.${Cu}[data-bs-toggle="tab"], .${Cu}[data-bs-toggle="pill"], .${Cu}[data-bs-toggle="list"]`;class of extends oa{constructor(n){super(n),this._parent=this._element.closest(foe),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),nn.on(this._element,ooe,i=>this._keydown(i)))}static get NAME(){return Jse}show(){const n=this._element;if(this._elemIsActive(n))return;const i=this._getActiveElem(),o=i?nn.trigger(i,toe,{relatedTarget:n}):null;nn.trigger(n,ioe,{relatedTarget:i}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(i,n),this._activate(n,i))}_activate(n,i){if(!n)return;n.classList.add(Cu),this._activate(yl(n));const o=()=>{if(n.getAttribute("role")!=="tab"){n.classList.add(I1);return}n.removeAttribute("tabindex"),n.setAttribute("aria-selected",!0),this._toggleDropDown(n,!0),nn.trigger(n,roe,{relatedTarget:i})};this._queueCallback(o,n,n.classList.contains(BL))}_deactivate(n,i){if(!n)return;n.classList.remove(Cu),n.blur(),this._deactivate(yl(n));const o=()=>{if(n.getAttribute("role")!=="tab"){n.classList.remove(I1);return}n.setAttribute("aria-selected",!1),n.setAttribute("tabindex","-1"),this._toggleDropDown(n,!1),nn.trigger(n,noe,{relatedTarget:i})};this._queueCallback(o,n,n.classList.contains(BL))}_keydown(n){if(![loe,NL,coe,FL].includes(n.key))return;n.stopPropagation(),n.preventDefault();const i=[NL,FL].includes(n.key),o=xM(this._getChildren().filter(l=>!Rc(l)),n.target,i,!0);o&&(o.focus({preventScroll:!0}),of.getOrCreateInstance(o).show())}_getChildren(){return Ci.find(N1,this._parent)}_getActiveElem(){return this._getChildren().find(n=>this._elemIsActive(n))||null}_setInitialAttributes(n,i){this._setAttributeIfNotExists(n,"role","tablist");for(const o of i)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(n){n=this._getInnerElement(n);const i=this._elemIsActive(n),o=this._getOuterElement(n);n.setAttribute("aria-selected",i),o!==n&&this._setAttributeIfNotExists(o,"role","presentation"),i||n.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(n,"role","tab"),this._setInitialAttributesOnTargetPanel(n)}_setInitialAttributesOnTargetPanel(n){const i=yl(n);!i||(this._setAttributeIfNotExists(i,"role","tabpanel"),n.id&&this._setAttributeIfNotExists(i,"aria-labelledby",`#${n.id}`))}_toggleDropDown(n,i){const o=this._getOuterElement(n);if(!o.classList.contains(uoe))return;const l=(a,u)=>{const h=Ci.findOne(a,o);h&&h.classList.toggle(u,i)};l(hoe,Cu),l(doe,I1),o.setAttribute("aria-expanded",i)}_setAttributeIfNotExists(n,i,o){n.hasAttribute(i)||n.setAttribute(i,o)}_elemIsActive(n){return n.classList.contains(Cu)}_getInnerElement(n){return n.matches(N1)?n:Ci.findOne(N1,n)}_getOuterElement(n){return n.closest(poe)||n}static jQueryInterface(n){return this.each(function(){const i=of.getOrCreateInstance(this);if(typeof n=="string"){if(i[n]===void 0||n.startsWith("_")||n==="constructor")throw new TypeError(`No method named "${n}"`);i[n]()}})}}nn.on(document,soe,lN,function(r){["A","AREA"].includes(this.tagName)&&r.preventDefault(),!Rc(this)&&of.getOrCreateInstance(this).show()});nn.on(window,aoe,()=>{for(const r of Ci.find(goe))of.getOrCreateInstance(r)});Lo(of);const voe="toast",yoe="bs.toast",Fc=`.${yoe}`,xoe=`mouseover${Fc}`,_oe=`mouseout${Fc}`,boe=`focusin${Fc}`,Eoe=`focusout${Fc}`,Aoe=`hide${Fc}`,woe=`hidden${Fc}`,Moe=`show${Fc}`,Soe=`shown${Fc}`,Toe="fade",UL="hide",g0="show",v0="showing",Coe={animation:"boolean",autohide:"boolean",delay:"number"},Roe={animation:!0,autohide:!0,delay:5e3};class fx extends oa{constructor(n,i){super(n,i),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Roe}static get DefaultType(){return Coe}static get NAME(){return voe}show(){if(nn.trigger(this._element,Moe).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Toe);const i=()=>{this._element.classList.remove(v0),nn.trigger(this._element,Soe),this._maybeScheduleHide()};this._element.classList.remove(UL),Vm(this._element),this._element.classList.add(g0,v0),this._queueCallback(i,this._element,this._config.animation)}hide(){if(!this.isShown()||nn.trigger(this._element,Aoe).defaultPrevented)return;const i=()=>{this._element.classList.add(UL),this._element.classList.remove(v0,g0),nn.trigger(this._element,woe)};this._element.classList.add(v0),this._queueCallback(i,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(g0),super.dispose()}isShown(){return this._element.classList.contains(g0)}_maybeScheduleHide(){!this._config.autohide||this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay))}_onInteraction(n,i){switch(n.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=i;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=i;break}}if(i){this._clearTimeout();return}const o=n.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){nn.on(this._element,xoe,n=>this._onInteraction(n,!0)),nn.on(this._element,_oe,n=>this._onInteraction(n,!1)),nn.on(this._element,boe,n=>this._onInteraction(n,!0)),nn.on(this._element,Eoe,n=>this._onInteraction(n,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(n){return this.each(function(){const i=fx.getOrCreateInstance(this,n);if(typeof n=="string"){if(typeof i[n]>"u")throw new TypeError(`No method named "${n}"`);i[n](this)}})}}cx(fx);Lo(fx);F1.createRoot(document.getElementById("root")).render(zi(Tte,{}))});export default Loe();
